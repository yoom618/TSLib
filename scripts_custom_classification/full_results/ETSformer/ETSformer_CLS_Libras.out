Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.483771324157715
Epoch: 1, Steps: 12 | Train Loss: 2.599 Vali Loss: 1.910 Vali Acc: 0.456 Test Loss: 1.910 Test Acc: 0.456
Validation loss decreased (inf --> -0.455536).  Saving model ...
Epoch: 2 cost time: 1.253481149673462
Epoch: 2, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.175 Vali Acc: 0.694 Test Loss: 1.175 Test Acc: 0.694
Validation loss decreased (-0.455536 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.277996301651001
Epoch: 3, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.3662593364715576
Epoch: 4, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
Validation loss decreased (-0.716658 --> -0.783326).  Saving model ...
Epoch: 5 cost time: 1.262528896331787
Epoch: 5, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.743 Vali Acc: 0.811 Test Loss: 0.743 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 6 cost time: 1.4113776683807373
Epoch: 6, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.693 Vali Acc: 0.817 Test Loss: 0.693 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 1.4169292449951172
Epoch: 7, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.2360045909881592
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.2048544883728027
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.654 Vali Acc: 0.839 Test Loss: 0.654 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 10 cost time: 1.4376780986785889
Epoch: 10, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.805 Vali Acc: 0.811 Test Loss: 0.805 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.481349229812622
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 12 cost time: 1.647385597229004
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866659).  Saving model ...
Epoch: 13 cost time: 1.2919318675994873
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 1.3932819366455078
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.777 Vali Acc: 0.867 Test Loss: 0.777 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2961151599884033
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.735 Vali Acc: 0.844 Test Loss: 0.735 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2022607326507568
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.886 Vali Acc: 0.883 Test Loss: 0.886 Test Acc: 0.883
Validation loss decreased (-0.866659 --> -0.883324).  Saving model ...
Epoch: 17 cost time: 1.3837175369262695
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.778 Vali Acc: 0.856 Test Loss: 0.778 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2203736305236816
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.088 Vali Acc: 0.822 Test Loss: 1.088 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.300762414932251
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.020 Vali Acc: 0.839 Test Loss: 1.020 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2345154285430908
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.949 Vali Acc: 0.828 Test Loss: 0.949 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3115196228027344
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.908 Vali Acc: 0.867 Test Loss: 0.908 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.330202341079712
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.947 Vali Acc: 0.861 Test Loss: 0.947 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6216022968292236
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.920 Vali Acc: 0.861 Test Loss: 0.920 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4658493995666504
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.035 Vali Acc: 0.856 Test Loss: 1.035 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.372711420059204
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.987 Vali Acc: 0.861 Test Loss: 0.987 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.454700231552124
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.996 Vali Acc: 0.844 Test Loss: 0.996 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 5605951
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.264037609100342
Epoch: 1, Steps: 12 | Train Loss: 2.606 Vali Loss: 1.899 Vali Acc: 0.472 Test Loss: 1.899 Test Acc: 0.472
Validation loss decreased (inf --> -0.472203).  Saving model ...
Epoch: 2 cost time: 1.6062757968902588
Epoch: 2, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.175 Vali Acc: 0.678 Test Loss: 1.175 Test Acc: 0.678
Validation loss decreased (-0.472203 --> -0.677766).  Saving model ...
Epoch: 3 cost time: 1.622361183166504
Epoch: 3, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.919 Vali Acc: 0.711 Test Loss: 0.919 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711102).  Saving model ...
Epoch: 4 cost time: 1.4536097049713135
Epoch: 4, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
Validation loss decreased (-0.711102 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.71940279006958
Epoch: 5, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 6 cost time: 1.6724348068237305
Epoch: 6, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5976018905639648
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.4301221370697021
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3306057453155518
Epoch: 9, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3919768333435059
Epoch: 10, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2349717617034912
Epoch: 11, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.443871259689331
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
Validation loss decreased (-0.849993 --> -0.877771).  Saving model ...
Epoch: 13 cost time: 1.218193769454956
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.733 Vali Acc: 0.856 Test Loss: 0.733 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5761041641235352
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.790 Vali Acc: 0.839 Test Loss: 0.790 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6371939182281494
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.812 Vali Acc: 0.817 Test Loss: 0.812 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.455589771270752
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.934 Vali Acc: 0.861 Test Loss: 0.934 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5103051662445068
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.861 Vali Acc: 0.828 Test Loss: 0.861 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6676456928253174
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.861 Vali Acc: 0.839 Test Loss: 0.861 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3264226913452148
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.954 Vali Acc: 0.844 Test Loss: 0.954 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5219550132751465
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.025 Vali Acc: 0.800 Test Loss: 1.025 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4408609867095947
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.167 Vali Acc: 0.850 Test Loss: 1.167 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4423773288726807
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.994 Vali Acc: 0.844 Test Loss: 0.994 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 5605951
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6161386966705322
Epoch: 1, Steps: 12 | Train Loss: 2.613 Vali Loss: 1.891 Vali Acc: 0.494 Test Loss: 1.891 Test Acc: 0.494
Validation loss decreased (inf --> -0.494426).  Saving model ...
Epoch: 2 cost time: 1.462592363357544
Epoch: 2, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.165 Vali Acc: 0.678 Test Loss: 1.165 Test Acc: 0.678
Validation loss decreased (-0.494426 --> -0.677766).  Saving model ...
Epoch: 3 cost time: 1.6249568462371826
Epoch: 3, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.440934419631958
Epoch: 4, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
Validation loss decreased (-0.699991 --> -0.761103).  Saving model ...
Epoch: 5 cost time: 1.5530872344970703
Epoch: 5, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
Validation loss decreased (-0.761103 --> -0.816660).  Saving model ...
Epoch: 6 cost time: 1.337425708770752
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.486539363861084
Epoch: 7, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 1.4619314670562744
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.8699321746826172
Epoch: 9, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 10 cost time: 1.7410378456115723
Epoch: 10, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.729 Vali Acc: 0.828 Test Loss: 0.729 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6028106212615967
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 1.4976348876953125
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6738770008087158
Epoch: 13, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 14 cost time: 1.59159255027771
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4041638374328613
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.802 Vali Acc: 0.828 Test Loss: 0.802 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6918482780456543
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.055 Vali Acc: 0.856 Test Loss: 1.055 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.525169849395752
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.787 Vali Acc: 0.844 Test Loss: 0.787 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.574291467666626
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.850 Vali Acc: 0.856 Test Loss: 0.850 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4507472515106201
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.824 Vali Acc: 0.883 Test Loss: 0.824 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883325).  Saving model ...
Epoch: 20 cost time: 1.5317177772521973
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5066125392913818
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.938 Vali Acc: 0.850 Test Loss: 0.938 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.429185152053833
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.882 Vali Acc: 0.872 Test Loss: 0.882 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4193508625030518
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.831 Vali Acc: 0.861 Test Loss: 0.831 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.498788595199585
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5485892295837402
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.856 Test Loss: 0.817 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5560882091522217
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.850 Test Loss: 0.829 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6627988815307617
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.872 Test Loss: 0.850 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6349594593048096
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.470534086227417
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.860 Vali Acc: 0.861 Test Loss: 0.860 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 5605951
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4278056621551514
Epoch: 1, Steps: 12 | Train Loss: 2.602 Vali Loss: 1.890 Vali Acc: 0.461 Test Loss: 1.890 Test Acc: 0.461
Validation loss decreased (inf --> -0.461092).  Saving model ...
Epoch: 2 cost time: 1.6469151973724365
Epoch: 2, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.177 Vali Acc: 0.672 Test Loss: 1.177 Test Acc: 0.672
Validation loss decreased (-0.461092 --> -0.672210).  Saving model ...
Epoch: 3 cost time: 1.3230650424957275
Epoch: 3, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.924 Vali Acc: 0.711 Test Loss: 0.924 Test Acc: 0.711
Validation loss decreased (-0.672210 --> -0.711102).  Saving model ...
Epoch: 4 cost time: 1.4463865756988525
Epoch: 4, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
Validation loss decreased (-0.711102 --> -0.788881).  Saving model ...
Epoch: 5 cost time: 1.439065933227539
Epoch: 5, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816660).  Saving model ...
Epoch: 6 cost time: 1.4974620342254639
Epoch: 6, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4243643283843994
Epoch: 7, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.5331926345825195
Epoch: 8, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 1.3496308326721191
Epoch: 9, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.694 Vali Acc: 0.856 Test Loss: 0.694 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.475165605545044
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4740147590637207
Epoch: 11, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 12 cost time: 1.3556857109069824
Epoch: 12, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.718 Vali Acc: 0.856 Test Loss: 0.718 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3815250396728516
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 14 cost time: 1.3362665176391602
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.747 Vali Acc: 0.856 Test Loss: 0.747 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5668830871582031
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6153271198272705
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.833 Vali Acc: 0.844 Test Loss: 0.833 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.487421989440918
Epoch: 17, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.736 Vali Acc: 0.872 Test Loss: 0.736 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 18 cost time: 1.569138526916504
Epoch: 18, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.753 Vali Acc: 0.867 Test Loss: 0.753 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6223859786987305
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.789 Vali Acc: 0.867 Test Loss: 0.789 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.61726975440979
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.867 Test Loss: 0.771 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6490747928619385
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.867 Test Loss: 0.763 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4140808582305908
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.824 Vali Acc: 0.861 Test Loss: 0.824 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4368233680725098
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.842 Vali Acc: 0.856 Test Loss: 0.842 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6288928985595703
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.872 Test Loss: 0.823 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5984289646148682
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.872 Test Loss: 0.828 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.393932580947876
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.820 Vali Acc: 0.872 Test Loss: 0.820 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5768070220947266
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.867 Test Loss: 0.841 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 5605951
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3383147716522217
Epoch: 1, Steps: 12 | Train Loss: 2.641 Vali Loss: 1.842 Vali Acc: 0.478 Test Loss: 1.842 Test Acc: 0.478
Validation loss decreased (inf --> -0.477759).  Saving model ...
Epoch: 2 cost time: 1.526703119277954
Epoch: 2, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.227 Vali Acc: 0.644 Test Loss: 1.227 Test Acc: 0.644
Validation loss decreased (-0.477759 --> -0.644432).  Saving model ...
Epoch: 3 cost time: 1.447218418121338
Epoch: 3, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.945 Vali Acc: 0.683 Test Loss: 0.945 Test Acc: 0.683
Validation loss decreased (-0.644432 --> -0.683324).  Saving model ...
Epoch: 4 cost time: 1.2496182918548584
Epoch: 4, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
Validation loss decreased (-0.683324 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.399611234664917
Epoch: 5, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.803 Vali Acc: 0.794 Test Loss: 0.803 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2937390804290771
Epoch: 6, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.3421730995178223
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 1.2913708686828613
Epoch: 8, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 1.3458409309387207
Epoch: 9, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.595958948135376
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4179179668426514
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.772 Vali Acc: 0.822 Test Loss: 0.772 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.437295913696289
Epoch: 12, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.518148422241211
Epoch: 13, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.613961935043335
Epoch: 14, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.807 Vali Acc: 0.861 Test Loss: 0.807 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861103).  Saving model ...
Epoch: 15 cost time: 1.8665924072265625
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
Validation loss decreased (-0.861103 --> -0.872214).  Saving model ...
Epoch: 16 cost time: 1.683265209197998
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.476600170135498
Epoch: 17, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6577949523925781
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.855 Vali Acc: 0.833 Test Loss: 0.855 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5886142253875732
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.860 Vali Acc: 0.850 Test Loss: 0.860 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.182936191558838
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.733 Vali Acc: 0.861 Test Loss: 0.733 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.585541009902954
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.900 Vali Acc: 0.856 Test Loss: 0.900 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0495190620422363
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.764603853225708
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.977 Vali Acc: 0.850 Test Loss: 0.977 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1410882472991943
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7692954540252686
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.166 Vali Acc: 0.839 Test Loss: 1.166 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 3508799
model size : 23.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6970298290252686
Epoch: 1, Steps: 12 | Train Loss: 2.632 Vali Loss: 1.839 Vali Acc: 0.456 Test Loss: 1.839 Test Acc: 0.456
Validation loss decreased (inf --> -0.455537).  Saving model ...
Epoch: 2 cost time: 1.7467191219329834
Epoch: 2, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.455537 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 1.4572417736053467
Epoch: 3, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.5565459728240967
Epoch: 4, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.839 Vali Acc: 0.789 Test Loss: 0.839 Test Acc: 0.789
Validation loss decreased (-0.677768 --> -0.788881).  Saving model ...
Epoch: 5 cost time: 1.7579729557037354
Epoch: 5, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.799 Vali Acc: 0.806 Test Loss: 0.799 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 1.9902234077453613
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.8154356479644775
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.5276377201080322
Epoch: 8, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6236989498138428
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.747 Vali Acc: 0.794 Test Loss: 0.747 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7816922664642334
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.737 Vali Acc: 0.839 Test Loss: 0.737 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 11 cost time: 2.111726760864258
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.745 Vali Acc: 0.828 Test Loss: 0.745 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5152783393859863
Epoch: 12, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 2.3657779693603516
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.771 Vali Acc: 0.839 Test Loss: 0.771 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8171541690826416
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7606451511383057
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.817 Vali Acc: 0.850 Test Loss: 0.817 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0127830505371094
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.833 Vali Acc: 0.856 Test Loss: 0.833 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.509592056274414
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.929 Vali Acc: 0.844 Test Loss: 0.929 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3957231044769287
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.901 Vali Acc: 0.822 Test Loss: 0.901 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9006190299987793
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.908 Vali Acc: 0.856 Test Loss: 0.908 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.848198652267456
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.818 Vali Acc: 0.833 Test Loss: 0.818 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6701445579528809
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.235 Vali Acc: 0.850 Test Loss: 1.235 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9816021919250488
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.884 Vali Acc: 0.844 Test Loss: 0.884 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 3508799
model size : 23.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.655672550201416
Epoch: 1, Steps: 12 | Train Loss: 2.601 Vali Loss: 1.839 Vali Acc: 0.439 Test Loss: 1.839 Test Acc: 0.439
Validation loss decreased (inf --> -0.438871).  Saving model ...
Epoch: 2 cost time: 1.9176583290100098
Epoch: 2, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.212 Vali Acc: 0.672 Test Loss: 1.212 Test Acc: 0.672
Validation loss decreased (-0.438871 --> -0.672210).  Saving model ...
Epoch: 3 cost time: 1.7685987949371338
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.4945549964904785
Epoch: 4, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.849 Vali Acc: 0.778 Test Loss: 0.849 Test Acc: 0.778
Validation loss decreased (-0.699991 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 1.676767349243164
Epoch: 5, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.815 Vali Acc: 0.806 Test Loss: 0.815 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 1.9014832973480225
Epoch: 6, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.702 Vali Acc: 0.806 Test Loss: 0.702 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.8863673210144043
Epoch: 7, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
Validation loss decreased (-0.805549 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 1.4882235527038574
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.687 Vali Acc: 0.817 Test Loss: 0.687 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6485230922698975
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.680 Vali Acc: 0.811 Test Loss: 0.680 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3914248943328857
Epoch: 10, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.680 Vali Acc: 0.833 Test Loss: 0.680 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3328931331634521
Epoch: 11, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3750488758087158
Epoch: 12, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 1.3831665515899658
Epoch: 13, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.781 Vali Acc: 0.844 Test Loss: 0.781 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2955186367034912
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.074368953704834
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.817 Vali Acc: 0.872 Test Loss: 0.817 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872214).  Saving model ...
Epoch: 16 cost time: 1.3004560470581055
Epoch: 16, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.763 Vali Acc: 0.861 Test Loss: 0.763 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1752569675445557
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.764 Vali Acc: 0.861 Test Loss: 0.764 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8028268814086914
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.785 Vali Acc: 0.856 Test Loss: 0.785 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6629250049591064
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.869 Vali Acc: 0.867 Test Loss: 0.869 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9479646682739258
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.762 Vali Acc: 0.861 Test Loss: 0.762 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.936248540878296
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.162 Vali Acc: 0.850 Test Loss: 1.162 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6342661380767822
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.939 Vali Acc: 0.828 Test Loss: 0.939 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6493439674377441
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.083 Vali Acc: 0.867 Test Loss: 1.083 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5437557697296143
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.060 Vali Acc: 0.850 Test Loss: 1.060 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.738945484161377
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.100 Vali Acc: 0.844 Test Loss: 1.100 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 3508799
model size : 23.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.835341691970825
Epoch: 1, Steps: 12 | Train Loss: 2.597 Vali Loss: 1.825 Vali Acc: 0.456 Test Loss: 1.825 Test Acc: 0.456
Validation loss decreased (inf --> -0.455537).  Saving model ...
Epoch: 2 cost time: 1.6890130043029785
Epoch: 2, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.209 Vali Acc: 0.628 Test Loss: 1.209 Test Acc: 0.628
Validation loss decreased (-0.455537 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 1.7852089405059814
Epoch: 3, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.939 Vali Acc: 0.689 Test Loss: 0.939 Test Acc: 0.689
Validation loss decreased (-0.627766 --> -0.688880).  Saving model ...
Epoch: 4 cost time: 2.1013708114624023
Epoch: 4, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.849 Vali Acc: 0.772 Test Loss: 0.849 Test Acc: 0.772
Validation loss decreased (-0.688880 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.6541647911071777
Epoch: 5, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.780 Vali Acc: 0.800 Test Loss: 0.780 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 2.037107467651367
Epoch: 6, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822216).  Saving model ...
Epoch: 7 cost time: 2.038266658782959
Epoch: 7, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.751511812210083
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 1.704972267150879
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7032175064086914
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9663050174713135
Epoch: 11, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 12 cost time: 2.126671314239502
Epoch: 12, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7836976051330566
Epoch: 13, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.774418592453003
Epoch: 14, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.766 Vali Acc: 0.878 Test Loss: 0.766 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 2.0533502101898193
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.804 Vali Acc: 0.839 Test Loss: 0.804 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6358683109283447
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 17 cost time: 1.6287891864776611
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.84950590133667
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6186659336090088
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.859 Vali Acc: 0.850 Test Loss: 0.859 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5398523807525635
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4800176620483398
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.941 Vali Acc: 0.878 Test Loss: 0.941 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6842353343963623
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7353746891021729
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.087 Vali Acc: 0.872 Test Loss: 1.087 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6268856525421143
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.882 Vali Acc: 0.856 Test Loss: 0.882 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.610522985458374
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.126 Vali Acc: 0.861 Test Loss: 1.126 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.734680414199829
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.951 Vali Acc: 0.856 Test Loss: 0.951 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3508799
model size : 23.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9066216945648193
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 1.984 Vali Acc: 0.383 Test Loss: 1.984 Test Acc: 0.383
Validation loss decreased (inf --> -0.383313).  Saving model ...
Epoch: 2 cost time: 1.5634915828704834
Epoch: 2, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.213 Vali Acc: 0.689 Test Loss: 1.213 Test Acc: 0.689
Validation loss decreased (-0.383313 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.8760361671447754
Epoch: 3, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
Validation loss decreased (-0.688877 --> -0.744435).  Saving model ...
Epoch: 4 cost time: 1.694014549255371
Epoch: 4, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.873 Vali Acc: 0.794 Test Loss: 0.873 Test Acc: 0.794
Validation loss decreased (-0.744435 --> -0.794436).  Saving model ...
Epoch: 5 cost time: 1.8452949523925781
Epoch: 5, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
Validation loss decreased (-0.794436 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.6838419437408447
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8740484714508057
Epoch: 7, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7819538116455078
Epoch: 8, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.719 Vali Acc: 0.828 Test Loss: 0.719 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.6285531520843506
Epoch: 9, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.827771 --> -0.866661).  Saving model ...
Epoch: 10 cost time: 1.5471510887145996
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.657 Vali Acc: 0.867 Test Loss: 0.657 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7253084182739258
Epoch: 11, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.707 Vali Acc: 0.844 Test Loss: 0.707 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4325542449951172
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7722227573394775
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8650002479553223
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.736 Vali Acc: 0.839 Test Loss: 0.736 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.624030351638794
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9179208278656006
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7902779579162598
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.796 Vali Acc: 0.833 Test Loss: 0.796 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.745781421661377
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.858 Vali Acc: 0.856 Test Loss: 0.858 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7386665344238281
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.985 Vali Acc: 0.850 Test Loss: 0.985 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2460223
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8563127517700195
Epoch: 1, Steps: 12 | Train Loss: 2.673 Vali Loss: 1.971 Vali Acc: 0.406 Test Loss: 1.971 Test Acc: 0.406
Validation loss decreased (inf --> -0.405536).  Saving model ...
Epoch: 2 cost time: 1.8562471866607666
Epoch: 2, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.199 Vali Acc: 0.683 Test Loss: 1.199 Test Acc: 0.683
Validation loss decreased (-0.405536 --> -0.683321).  Saving model ...
Epoch: 3 cost time: 1.7793407440185547
Epoch: 3, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.942 Vali Acc: 0.744 Test Loss: 0.942 Test Acc: 0.744
Validation loss decreased (-0.683321 --> -0.744435).  Saving model ...
Epoch: 4 cost time: 1.3339145183563232
Epoch: 4, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.871 Vali Acc: 0.789 Test Loss: 0.871 Test Acc: 0.789
Validation loss decreased (-0.744435 --> -0.788880).  Saving model ...
Epoch: 5 cost time: 1.8668248653411865
Epoch: 5, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
Validation loss decreased (-0.788880 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.4235894680023193
Epoch: 6, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.753 Vali Acc: 0.778 Test Loss: 0.753 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3683104515075684
Epoch: 7, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.725 Vali Acc: 0.778 Test Loss: 0.725 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4367682933807373
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.3030340671539307
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
Validation loss decreased (-0.838882 --> -0.872216).  Saving model ...
Epoch: 10 cost time: 1.6442468166351318
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4288406372070312
Epoch: 11, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7959725856781006
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6752867698669434
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.742 Vali Acc: 0.811 Test Loss: 0.742 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7113840579986572
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9308969974517822
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.745 Vali Acc: 0.844 Test Loss: 0.745 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8073017597198486
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.845 Vali Acc: 0.839 Test Loss: 0.845 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6110715866088867
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.771 Vali Acc: 0.844 Test Loss: 0.771 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5273346900939941
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.858 Vali Acc: 0.872 Test Loss: 0.858 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4210624694824219
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.907 Vali Acc: 0.867 Test Loss: 0.907 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2460223
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8985700607299805
Epoch: 1, Steps: 12 | Train Loss: 2.642 Vali Loss: 1.978 Vali Acc: 0.456 Test Loss: 1.978 Test Acc: 0.456
Validation loss decreased (inf --> -0.455536).  Saving model ...
Epoch: 2 cost time: 1.8326239585876465
Epoch: 2, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.206 Vali Acc: 0.689 Test Loss: 1.206 Test Acc: 0.689
Validation loss decreased (-0.455536 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.6570496559143066
Epoch: 3, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.688877 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.2476160526275635
Epoch: 4, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.875 Vali Acc: 0.772 Test Loss: 0.875 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772213).  Saving model ...
Epoch: 5 cost time: 1.5686326026916504
Epoch: 5, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
Validation loss decreased (-0.772213 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.8088765144348145
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5867433547973633
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7638506889343262
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 2.112534284591675
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 1.7058217525482178
Epoch: 10, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 11 cost time: 1.8092927932739258
Epoch: 11, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6486148834228516
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.764 Vali Acc: 0.839 Test Loss: 0.764 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4324829578399658
Epoch: 13, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6655800342559814
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.776 Vali Acc: 0.828 Test Loss: 0.776 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4117240905761719
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.788 Vali Acc: 0.839 Test Loss: 0.788 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5589628219604492
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.917135238647461
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5462310314178467
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.760 Vali Acc: 0.872 Test Loss: 0.760 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 19 cost time: 1.7392849922180176
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.898 Vali Acc: 0.867 Test Loss: 0.898 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8145110607147217
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.504241704940796
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.997 Vali Acc: 0.856 Test Loss: 0.997 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8168256282806396
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.944 Vali Acc: 0.844 Test Loss: 0.944 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8414013385772705
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.055 Vali Acc: 0.828 Test Loss: 1.055 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.646054983139038
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6549537181854248
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.971 Vali Acc: 0.856 Test Loss: 0.971 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8297951221466064
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6306068897247314
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.019 Vali Acc: 0.844 Test Loss: 1.019 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6184742450714111
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.034 Vali Acc: 0.867 Test Loss: 1.034 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2460223
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9406747817993164
Epoch: 1, Steps: 12 | Train Loss: 2.595 Vali Loss: 1.953 Vali Acc: 0.494 Test Loss: 1.953 Test Acc: 0.494
Validation loss decreased (inf --> -0.494425).  Saving model ...
Epoch: 2 cost time: 1.2660901546478271
Epoch: 2, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.222 Vali Acc: 0.689 Test Loss: 1.222 Test Acc: 0.689
Validation loss decreased (-0.494425 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.4920310974121094
Epoch: 3, Steps: 12 | Train Loss: 0.944 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
Validation loss decreased (-0.688877 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.6982519626617432
Epoch: 4, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.863 Vali Acc: 0.783 Test Loss: 0.863 Test Acc: 0.783
Validation loss decreased (-0.722213 --> -0.783325).  Saving model ...
Epoch: 5 cost time: 1.4743983745574951
Epoch: 5, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.699 Vali Acc: 0.806 Test Loss: 0.699 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805549).  Saving model ...
Epoch: 6 cost time: 1.8004121780395508
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8867249488830566
Epoch: 7, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9282033443450928
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.7666091918945312
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.7251603603363037
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6217467784881592
Epoch: 11, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 1.7630722522735596
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8205797672271729
Epoch: 13, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.737 Vali Acc: 0.833 Test Loss: 0.737 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4597487449645996
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6204814910888672
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.740 Vali Acc: 0.867 Test Loss: 0.740 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 16 cost time: 1.5329279899597168
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.395049810409546
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4738008975982666
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.689 Vali Acc: 0.872 Test Loss: 0.689 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 19 cost time: 1.710179090499878
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.729 Vali Acc: 0.861 Test Loss: 0.729 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5204670429229736
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.838 Vali Acc: 0.867 Test Loss: 0.838 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8885188102722168
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.765 Vali Acc: 0.861 Test Loss: 0.765 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9399213790893555
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.849 Vali Acc: 0.856 Test Loss: 0.849 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7128801345825195
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.823 Vali Acc: 0.850 Test Loss: 0.823 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6775012016296387
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.720 Vali Acc: 0.883 Test Loss: 0.720 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883326).  Saving model ...
Epoch: 25 cost time: 1.620333194732666
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.831 Vali Acc: 0.844 Test Loss: 0.831 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.595590353012085
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.810 Vali Acc: 0.867 Test Loss: 0.810 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.446159839630127
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.921 Vali Acc: 0.839 Test Loss: 0.921 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5208089351654053
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.867 Test Loss: 0.976 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7628161907196045
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.900 Vali Acc: 0.867 Test Loss: 0.900 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7952020168304443
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.003 Vali Acc: 0.856 Test Loss: 1.003 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9585521221160889
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.952 Vali Acc: 0.861 Test Loss: 0.952 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0044190883636475
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.867 Test Loss: 0.951 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9224607944488525
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.005 Vali Acc: 0.861 Test Loss: 1.005 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.829352617263794
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.997 Vali Acc: 0.861 Test Loss: 0.997 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2460223
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6560475826263428
Epoch: 1, Steps: 12 | Train Loss: 2.591 Vali Loss: 1.847 Vali Acc: 0.511 Test Loss: 1.847 Test Acc: 0.511
Validation loss decreased (inf --> -0.511093).  Saving model ...
Epoch: 2 cost time: 1.5403285026550293
Epoch: 2, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.511093 --> -0.733322).  Saving model ...
Epoch: 3 cost time: 1.6306445598602295
Epoch: 3, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7189671993255615
Epoch: 4, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.753 Vali Acc: 0.800 Test Loss: 0.753 Test Acc: 0.800
Validation loss decreased (-0.733322 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.6761479377746582
Epoch: 5, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.741 Vali Acc: 0.817 Test Loss: 0.741 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 6 cost time: 1.4851129055023193
Epoch: 6, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.437598705291748
Epoch: 7, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.4837126731872559
Epoch: 8, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.6325912475585938
Epoch: 9, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.871 Vali Acc: 0.811 Test Loss: 0.871 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6349551677703857
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 11 cost time: 1.8648605346679688
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.152 Vali Acc: 0.806 Test Loss: 1.152 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.636031150817871
Epoch: 12, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7067859172821045
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.853 Vali Acc: 0.844 Test Loss: 0.853 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5578322410583496
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4564008712768555
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6012601852416992
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.824 Vali Acc: 0.878 Test Loss: 0.824 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877770).  Saving model ...
Epoch: 17 cost time: 1.8975958824157715
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.808 Vali Acc: 0.856 Test Loss: 0.808 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6882405281066895
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.540268898010254
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.954 Vali Acc: 0.867 Test Loss: 0.954 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7244279384613037
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.817 Vali Acc: 0.867 Test Loss: 0.817 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0082249641418457
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.922 Vali Acc: 0.850 Test Loss: 0.922 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0056419372558594
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.866 Vali Acc: 0.861 Test Loss: 0.866 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7700343132019043
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.021 Vali Acc: 0.850 Test Loss: 1.021 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4711873531341553
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.896 Vali Acc: 0.856 Test Loss: 0.896 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.520106554031372
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.895 Vali Acc: 0.867 Test Loss: 0.895 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.573819875717163
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.216 Vali Acc: 0.844 Test Loss: 1.216 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1935935
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6769092082977295
Epoch: 1, Steps: 12 | Train Loss: 2.585 Vali Loss: 1.845 Vali Acc: 0.517 Test Loss: 1.845 Test Acc: 0.517
Validation loss decreased (inf --> -0.516648).  Saving model ...
Epoch: 2 cost time: 1.7779326438903809
Epoch: 2, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.083 Vali Acc: 0.717 Test Loss: 1.083 Test Acc: 0.717
Validation loss decreased (-0.516648 --> -0.716656).  Saving model ...
Epoch: 3 cost time: 1.548931360244751
Epoch: 3, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.6872029304504395
Epoch: 4, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.722213 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.7312531471252441
Epoch: 5, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 6 cost time: 1.504345178604126
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.006782054901123
Epoch: 7, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 1.6582098007202148
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.7337913513183594
Epoch: 9, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.872 Vali Acc: 0.811 Test Loss: 0.872 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9577913284301758
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 11 cost time: 1.5921680927276611
Epoch: 11, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.164 Vali Acc: 0.806 Test Loss: 1.164 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9429683685302734
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.7936739921569824
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.870 Vali Acc: 0.839 Test Loss: 0.870 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5554378032684326
Epoch: 14, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6661725044250488
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.818 Vali Acc: 0.839 Test Loss: 0.818 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0021262168884277
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.868 Vali Acc: 0.828 Test Loss: 0.868 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.774839162826538
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.794 Vali Acc: 0.867 Test Loss: 0.794 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866659).  Saving model ...
Epoch: 18 cost time: 1.770942211151123
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.890505075454712
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.930 Vali Acc: 0.839 Test Loss: 0.930 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5662243366241455
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.927 Vali Acc: 0.861 Test Loss: 0.927 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6218769550323486
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.901 Vali Acc: 0.839 Test Loss: 0.901 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5613749027252197
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.938 Vali Acc: 0.856 Test Loss: 0.938 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4843628406524658
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.952 Vali Acc: 0.861 Test Loss: 0.952 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9739322662353516
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.977 Vali Acc: 0.833 Test Loss: 0.977 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4806253910064697
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.898 Vali Acc: 0.872 Test Loss: 0.898 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872213).  Saving model ...
Epoch: 26 cost time: 1.7124297618865967
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.096 Vali Acc: 0.844 Test Loss: 1.096 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7277746200561523
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.013 Vali Acc: 0.856 Test Loss: 1.013 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6039724349975586
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.123 Vali Acc: 0.850 Test Loss: 1.123 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8777365684509277
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.309 Vali Acc: 0.817 Test Loss: 1.309 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9063637256622314
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.155 Vali Acc: 0.844 Test Loss: 1.155 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7266130447387695
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.298 Vali Acc: 0.822 Test Loss: 1.298 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.662893533706665
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.178 Vali Acc: 0.861 Test Loss: 1.178 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7857670783996582
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.422 Vali Acc: 0.817 Test Loss: 1.422 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8458857536315918
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.219 Vali Acc: 0.839 Test Loss: 1.219 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5747368335723877
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.363 Vali Acc: 0.861 Test Loss: 1.363 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1935935
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.172648191452026
Epoch: 1, Steps: 12 | Train Loss: 2.590 Vali Loss: 1.853 Vali Acc: 0.522 Test Loss: 1.853 Test Acc: 0.522
Validation loss decreased (inf --> -0.522204).  Saving model ...
Epoch: 2 cost time: 1.6224842071533203
Epoch: 2, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.092 Vali Acc: 0.733 Test Loss: 1.092 Test Acc: 0.733
Validation loss decreased (-0.522204 --> -0.733322).  Saving model ...
Epoch: 3 cost time: 1.4443213939666748
Epoch: 3, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.897 Vali Acc: 0.744 Test Loss: 0.897 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744435).  Saving model ...
Epoch: 4 cost time: 2.092094898223877
Epoch: 4, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.763 Vali Acc: 0.794 Test Loss: 0.763 Test Acc: 0.794
Validation loss decreased (-0.744435 --> -0.794437).  Saving model ...
Epoch: 5 cost time: 1.5727217197418213
Epoch: 5, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.7249102592468262
Epoch: 6, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.603722095489502
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 8 cost time: 1.4546833038330078
Epoch: 8, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 2.0643458366394043
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.877 Vali Acc: 0.806 Test Loss: 0.877 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.030790090560913
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.640 Vali Acc: 0.844 Test Loss: 0.640 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 11 cost time: 1.930616855621338
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.072 Vali Acc: 0.822 Test Loss: 1.072 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4931998252868652
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.728 Vali Acc: 0.861 Test Loss: 0.728 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 13 cost time: 1.6529433727264404
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.784 Vali Acc: 0.844 Test Loss: 0.784 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.651623249053955
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.822 Vali Acc: 0.833 Test Loss: 0.822 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1132872104644775
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.741 Vali Acc: 0.861 Test Loss: 0.741 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7897846698760986
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9661870002746582
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.761 Vali Acc: 0.839 Test Loss: 0.761 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9678564071655273
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.708 Vali Acc: 0.861 Test Loss: 0.708 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 2.064237117767334
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.780 Vali Acc: 0.861 Test Loss: 0.780 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8269352912902832
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.853 Vali Acc: 0.861 Test Loss: 0.853 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9166195392608643
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0586729049682617
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
Validation loss decreased (-0.861104 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 2.0844533443450928
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.936 Vali Acc: 0.856 Test Loss: 0.936 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8906505107879639
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.840 Vali Acc: 0.867 Test Loss: 0.840 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2076258659362793
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.906 Vali Acc: 0.839 Test Loss: 0.906 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.116224765777588
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.021 Vali Acc: 0.844 Test Loss: 1.021 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9722259044647217
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.886 Vali Acc: 0.861 Test Loss: 0.886 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.102203369140625
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.937 Vali Acc: 0.844 Test Loss: 0.937 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.427220582962036
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.108 Vali Acc: 0.833 Test Loss: 1.108 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3572661876678467
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.063 Vali Acc: 0.839 Test Loss: 1.063 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2552249431610107
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.844 Test Loss: 0.953 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.168893814086914
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.850 Test Loss: 1.013 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1935935
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2032976150512695
Epoch: 1, Steps: 12 | Train Loss: 2.604 Vali Loss: 1.885 Vali Acc: 0.489 Test Loss: 1.885 Test Acc: 0.489
Validation loss decreased (inf --> -0.488870).  Saving model ...
Epoch: 2 cost time: 1.6479535102844238
Epoch: 2, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.124 Vali Acc: 0.717 Test Loss: 1.124 Test Acc: 0.717
Validation loss decreased (-0.488870 --> -0.716655).  Saving model ...
Epoch: 3 cost time: 2.1110262870788574
Epoch: 3, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.903 Vali Acc: 0.722 Test Loss: 0.903 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 2.0022692680358887
Epoch: 4, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
Validation loss decreased (-0.722213 --> -0.783326).  Saving model ...
Epoch: 5 cost time: 1.9159867763519287
Epoch: 5, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.775 Vali Acc: 0.789 Test Loss: 0.775 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 2.2061946392059326
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.735 Vali Acc: 0.778 Test Loss: 0.735 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.097524642944336
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.8957433700561523
Epoch: 8, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.8535504341125488
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9950926303863525
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8741207122802734
Epoch: 11, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.009 Vali Acc: 0.822 Test Loss: 1.009 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0152230262756348
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.796 Vali Acc: 0.817 Test Loss: 0.796 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9940383434295654
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 2.0890913009643555
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.914 Vali Acc: 0.833 Test Loss: 0.914 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9717411994934082
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.9813854694366455
Epoch: 16, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.846 Vali Acc: 0.883 Test Loss: 0.846 Test Acc: 0.883
Validation loss decreased (-0.855549 --> -0.883325).  Saving model ...
Epoch: 17 cost time: 2.2196574211120605
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.860485553741455
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.054981231689453
Epoch: 19, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.947 Vali Acc: 0.872 Test Loss: 0.947 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0168368816375732
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.860 Vali Acc: 0.861 Test Loss: 0.860 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.730299472808838
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.869 Vali Acc: 0.861 Test Loss: 0.869 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9813125133514404
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.880 Vali Acc: 0.861 Test Loss: 0.880 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1092090606689453
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.847 Vali Acc: 0.850 Test Loss: 0.847 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.068405866622925
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.923 Vali Acc: 0.867 Test Loss: 0.923 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8385531902313232
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.906 Vali Acc: 0.861 Test Loss: 0.906 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.403747320175171
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.964 Vali Acc: 0.856 Test Loss: 0.964 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1935935
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.320892810821533
Epoch: 1, Steps: 12 | Train Loss: 2.551 Vali Loss: 1.823 Vali Acc: 0.511 Test Loss: 1.823 Test Acc: 0.511
Validation loss decreased (inf --> -0.511093).  Saving model ...
Epoch: 2 cost time: 2.0500988960266113
Epoch: 2, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.162 Vali Acc: 0.694 Test Loss: 1.162 Test Acc: 0.694
Validation loss decreased (-0.511093 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.7617063522338867
Epoch: 3, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 4 cost time: 2.141003131866455
Epoch: 4, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.779 Vali Acc: 0.783 Test Loss: 0.779 Test Acc: 0.783
Validation loss decreased (-0.716657 --> -0.783326).  Saving model ...
Epoch: 5 cost time: 2.2373125553131104
Epoch: 5, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0170514583587646
Epoch: 6, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.704 Vali Acc: 0.817 Test Loss: 0.704 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 2.07306170463562
Epoch: 7, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.726 Vali Acc: 0.806 Test Loss: 0.726 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.313002586364746
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.761 Vali Acc: 0.817 Test Loss: 0.761 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8997058868408203
Epoch: 9, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.816660 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 1.9835658073425293
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.733 Vali Acc: 0.861 Test Loss: 0.733 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9799349308013916
Epoch: 11, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.789 Vali Acc: 0.839 Test Loss: 0.789 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.325803518295288
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3772640228271484
Epoch: 13, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 2.1078903675079346
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.817 Vali Acc: 0.833 Test Loss: 0.817 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3021981716156006
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.254180431365967
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0345680713653564
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.812 Vali Acc: 0.856 Test Loss: 0.812 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.175936222076416
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.950 Vali Acc: 0.828 Test Loss: 0.950 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.121377944946289
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.876 Vali Acc: 0.839 Test Loss: 0.876 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9872615337371826
Epoch: 20, Steps: 12 | Train Loss: 0.267 Vali Loss: 1.094 Vali Acc: 0.833 Test Loss: 1.094 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9184508323669434
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.966 Vali Acc: 0.839 Test Loss: 0.966 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4533839225769043
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.846 Vali Acc: 0.856 Test Loss: 0.846 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.127053737640381
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.253 Vali Acc: 0.822 Test Loss: 1.253 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1673791
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.195475816726685
Epoch: 1, Steps: 12 | Train Loss: 2.548 Vali Loss: 1.829 Vali Acc: 0.506 Test Loss: 1.829 Test Acc: 0.506
Validation loss decreased (inf --> -0.505537).  Saving model ...
Epoch: 2 cost time: 2.0166256427764893
Epoch: 2, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.155 Vali Acc: 0.711 Test Loss: 1.155 Test Acc: 0.711
Validation loss decreased (-0.505537 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 2.083977699279785
Epoch: 3, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.929 Vali Acc: 0.717 Test Loss: 0.929 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716657).  Saving model ...
Epoch: 4 cost time: 1.995283842086792
Epoch: 4, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.769 Vali Acc: 0.794 Test Loss: 0.769 Test Acc: 0.794
Validation loss decreased (-0.716657 --> -0.794437).  Saving model ...
Epoch: 5 cost time: 2.2272276878356934
Epoch: 5, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.803 Vali Acc: 0.778 Test Loss: 0.803 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.000922679901123
Epoch: 6, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.9253978729248047
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.843252420425415
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.744 Vali Acc: 0.811 Test Loss: 0.744 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.839043140411377
Epoch: 9, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 2.005723476409912
Epoch: 10, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866659).  Saving model ...
Epoch: 11 cost time: 2.097057580947876
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.059081792831421
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.040842294692993
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9379277229309082
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.900 Vali Acc: 0.817 Test Loss: 0.900 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0683772563934326
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.955524206161499
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.865 Vali Acc: 0.839 Test Loss: 0.865 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8566701412200928
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9710044860839844
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.078 Vali Acc: 0.800 Test Loss: 1.078 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2341880798339844
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1287875175476074
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.074 Vali Acc: 0.833 Test Loss: 1.074 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1673791
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.792247772216797
Epoch: 1, Steps: 12 | Train Loss: 2.547 Vali Loss: 1.824 Vali Acc: 0.539 Test Loss: 1.824 Test Acc: 0.539
Validation loss decreased (inf --> -0.538871).  Saving model ...
Epoch: 2 cost time: 1.907705307006836
Epoch: 2, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.150 Vali Acc: 0.711 Test Loss: 1.150 Test Acc: 0.711
Validation loss decreased (-0.538871 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 2.1375269889831543
Epoch: 3, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.8179271221160889
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
Validation loss decreased (-0.722213 --> -0.783325).  Saving model ...
Epoch: 5 cost time: 1.9603745937347412
Epoch: 5, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.796 Vali Acc: 0.772 Test Loss: 0.796 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0016961097717285
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.703 Vali Acc: 0.811 Test Loss: 0.703 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 2.02987003326416
Epoch: 7, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.730 Vali Acc: 0.822 Test Loss: 0.730 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 2.0781848430633545
Epoch: 8, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8730013370513916
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.822215 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 2.329916000366211
Epoch: 10, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 11 cost time: 2.0718743801116943
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.774 Vali Acc: 0.828 Test Loss: 0.774 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9888103008270264
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.84031343460083
Epoch: 13, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8445377349853516
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.782 Vali Acc: 0.856 Test Loss: 0.782 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1051371097564697
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.01629376411438
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.050776958465576
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3038551807403564
Epoch: 18, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.946 Vali Acc: 0.839 Test Loss: 0.946 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1537396907806396
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.825 Vali Acc: 0.856 Test Loss: 0.825 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8297903537750244
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.024 Vali Acc: 0.844 Test Loss: 1.024 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1673791
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.232287645339966
Epoch: 1, Steps: 12 | Train Loss: 2.526 Vali Loss: 1.825 Vali Acc: 0.511 Test Loss: 1.825 Test Acc: 0.511
Validation loss decreased (inf --> -0.511093).  Saving model ...
Epoch: 2 cost time: 2.1392507553100586
Epoch: 2, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.149 Vali Acc: 0.694 Test Loss: 1.149 Test Acc: 0.694
Validation loss decreased (-0.511093 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 2.273805618286133
Epoch: 3, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.925 Vali Acc: 0.706 Test Loss: 0.925 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705546).  Saving model ...
Epoch: 4 cost time: 2.0899572372436523
Epoch: 4, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.800 Vali Acc: 0.794 Test Loss: 0.800 Test Acc: 0.794
Validation loss decreased (-0.705546 --> -0.794436).  Saving model ...
Epoch: 5 cost time: 1.9316716194152832
Epoch: 5, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.785 Vali Acc: 0.778 Test Loss: 0.785 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.211888074874878
Epoch: 6, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.680 Vali Acc: 0.811 Test Loss: 0.680 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 2.068737030029297
Epoch: 7, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.724 Vali Acc: 0.822 Test Loss: 0.724 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 2.313196897506714
Epoch: 8, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.260894536972046
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.9740781784057617
Epoch: 10, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 11 cost time: 2.152798891067505
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.741 Vali Acc: 0.856 Test Loss: 0.741 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855548).  Saving model ...
Epoch: 12 cost time: 1.729856014251709
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.698 Vali Acc: 0.839 Test Loss: 0.698 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.981034278869629
Epoch: 13, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.04634428024292
Epoch: 14, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.895 Vali Acc: 0.839 Test Loss: 0.895 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5832619667053223
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.030177354812622
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.881 Vali Acc: 0.850 Test Loss: 0.881 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.121199607849121
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0358726978302
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.893 Vali Acc: 0.878 Test Loss: 0.893 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877769).  Saving model ...
Epoch: 19 cost time: 2.0804033279418945
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.827 Vali Acc: 0.839 Test Loss: 0.827 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1181042194366455
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.000 Vali Acc: 0.872 Test Loss: 1.000 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6055850982666016
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.777 Vali Acc: 0.872 Test Loss: 0.777 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.000877857208252
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.870 Vali Acc: 0.867 Test Loss: 0.870 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.028730869293213
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2637574672698975
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.045 Vali Acc: 0.856 Test Loss: 1.045 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8286783695220947
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.016 Vali Acc: 0.878 Test Loss: 1.016 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2158899307250977
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.861 Test Loss: 0.968 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.223935842514038
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.015 Vali Acc: 0.850 Test Loss: 1.015 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.165036201477051
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.018 Vali Acc: 0.872 Test Loss: 1.018 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1673791
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.423617124557495
Epoch: 1, Steps: 12 | Train Loss: 2.500 Vali Loss: 1.865 Vali Acc: 0.533 Test Loss: 1.865 Test Acc: 0.533
Validation loss decreased (inf --> -0.533315).  Saving model ...
Epoch: 2 cost time: 1.873901128768921
Epoch: 2, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.183 Vali Acc: 0.689 Test Loss: 1.183 Test Acc: 0.689
Validation loss decreased (-0.533315 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.6853094100952148
Epoch: 3, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.857 Vali Acc: 0.733 Test Loss: 0.857 Test Acc: 0.733
Validation loss decreased (-0.688877 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 1.954930067062378
Epoch: 4, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 5 cost time: 2.1289498805999756
Epoch: 5, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.761103 --> -0.816660).  Saving model ...
Epoch: 6 cost time: 2.0899386405944824
Epoch: 6, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.194535493850708
Epoch: 7, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.814 Vali Acc: 0.783 Test Loss: 0.814 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4131853580474854
Epoch: 8, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 2.064724922180176
Epoch: 9, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.247239589691162
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.836 Vali Acc: 0.783 Test Loss: 0.836 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9287745952606201
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.820 Vali Acc: 0.811 Test Loss: 0.820 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.022428035736084
Epoch: 12, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.779 Vali Acc: 0.811 Test Loss: 0.779 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9587574005126953
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 14 cost time: 2.0504238605499268
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 2.1878957748413086
Epoch: 15, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866659).  Saving model ...
Epoch: 16 cost time: 1.7986736297607422
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.792 Vali Acc: 0.828 Test Loss: 0.792 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.121523857116699
Epoch: 17, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.015 Vali Acc: 0.806 Test Loss: 1.015 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8826189041137695
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.752 Vali Acc: 0.822 Test Loss: 0.752 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9983017444610596
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.015 Vali Acc: 0.822 Test Loss: 1.015 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9630756378173828
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.950 Vali Acc: 0.789 Test Loss: 0.950 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1414287090301514
Epoch: 21, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.945 Vali Acc: 0.844 Test Loss: 0.945 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9384818077087402
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.934 Vali Acc: 0.844 Test Loss: 0.934 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8933618068695068
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.913 Vali Acc: 0.839 Test Loss: 0.913 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1538689136505127
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.077 Vali Acc: 0.839 Test Loss: 1.077 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7124335765838623
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.058 Vali Acc: 0.844 Test Loss: 1.058 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1542719
model size : 15.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.50172233581543
Epoch: 1, Steps: 12 | Train Loss: 2.509 Vali Loss: 1.859 Vali Acc: 0.550 Test Loss: 1.859 Test Acc: 0.550
Validation loss decreased (inf --> -0.549981).  Saving model ...
Epoch: 2 cost time: 1.9530131816864014
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.183 Vali Acc: 0.694 Test Loss: 1.183 Test Acc: 0.694
Validation loss decreased (-0.549981 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 2.1167619228363037
Epoch: 3, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.854 Vali Acc: 0.739 Test Loss: 0.854 Test Acc: 0.739
Validation loss decreased (-0.694433 --> -0.738880).  Saving model ...
Epoch: 4 cost time: 2.0338966846466064
Epoch: 4, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.768 Vali Acc: 0.756 Test Loss: 0.768 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 1.9766807556152344
Epoch: 5, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.755548 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.6304216384887695
Epoch: 6, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.772 Vali Acc: 0.778 Test Loss: 0.772 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0155036449432373
Epoch: 7, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.780 Vali Acc: 0.794 Test Loss: 0.780 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8558104038238525
Epoch: 8, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.718 Vali Acc: 0.833 Test Loss: 0.718 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 1.9598500728607178
Epoch: 9, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.046156406402588
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.852 Vali Acc: 0.794 Test Loss: 0.852 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9161381721496582
Epoch: 11, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.810 Vali Acc: 0.811 Test Loss: 0.810 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9195821285247803
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.822 Vali Acc: 0.811 Test Loss: 0.822 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.918410062789917
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.980902910232544
Epoch: 14, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.686 Vali Acc: 0.856 Test Loss: 0.686 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2939088344573975
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.796 Vali Acc: 0.833 Test Loss: 0.796 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0024232864379883
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.305093288421631
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.959 Vali Acc: 0.867 Test Loss: 0.959 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 2.176985502243042
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.793 Vali Acc: 0.817 Test Loss: 0.793 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.088315010070801
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.920 Vali Acc: 0.867 Test Loss: 0.920 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 20 cost time: 1.9788246154785156
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.936 Vali Acc: 0.839 Test Loss: 0.936 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.042510986328125
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.877 Vali Acc: 0.856 Test Loss: 0.877 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8122153282165527
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.137 Vali Acc: 0.839 Test Loss: 1.137 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.997558832168579
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.979 Vali Acc: 0.850 Test Loss: 0.979 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9052236080169678
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.010 Vali Acc: 0.850 Test Loss: 1.010 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0497167110443115
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.085 Vali Acc: 0.828 Test Loss: 1.085 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.001264810562134
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.073 Vali Acc: 0.850 Test Loss: 1.073 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8381824493408203
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9205706119537354
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.043 Vali Acc: 0.850 Test Loss: 1.043 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9155089855194092
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.149 Vali Acc: 0.844 Test Loss: 1.149 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1542719
model size : 15.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.083591461181641
Epoch: 1, Steps: 12 | Train Loss: 2.499 Vali Loss: 1.856 Vali Acc: 0.533 Test Loss: 1.856 Test Acc: 0.533
Validation loss decreased (inf --> -0.533315).  Saving model ...
Epoch: 2 cost time: 2.506361722946167
Epoch: 2, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.176 Vali Acc: 0.706 Test Loss: 1.176 Test Acc: 0.706
Validation loss decreased (-0.533315 --> -0.705544).  Saving model ...
Epoch: 3 cost time: 2.227106809616089
Epoch: 3, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.855 Vali Acc: 0.761 Test Loss: 0.855 Test Acc: 0.761
Validation loss decreased (-0.705544 --> -0.761103).  Saving model ...
Epoch: 4 cost time: 2.294151782989502
Epoch: 4, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 5 cost time: 2.618030548095703
Epoch: 5, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
Validation loss decreased (-0.777770 --> -0.827771).  Saving model ...
Epoch: 6 cost time: 2.3562533855438232
Epoch: 6, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.779 Vali Acc: 0.778 Test Loss: 0.779 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3785643577575684
Epoch: 7, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5084378719329834
Epoch: 8, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 2.241460084915161
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1940791606903076
Epoch: 10, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.858 Vali Acc: 0.789 Test Loss: 0.858 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1418745517730713
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.808 Vali Acc: 0.822 Test Loss: 0.808 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.321626663208008
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.848 Vali Acc: 0.833 Test Loss: 0.848 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2171666622161865
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 2.283005952835083
Epoch: 14, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.378638505935669
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1975789070129395
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.708 Vali Acc: 0.839 Test Loss: 0.708 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4046754837036133
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.148 Vali Acc: 0.839 Test Loss: 1.148 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3149545192718506
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 2.405385732650757
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.810 Vali Acc: 0.856 Test Loss: 0.810 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2345354557037354
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.796 Vali Acc: 0.867 Test Loss: 0.796 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2175257205963135
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.858 Vali Acc: 0.850 Test Loss: 0.858 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3561081886291504
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.917 Vali Acc: 0.856 Test Loss: 0.917 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.954885721206665
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.838 Vali Acc: 0.856 Test Loss: 0.838 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.940948247909546
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2015979290008545
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.919 Vali Acc: 0.867 Test Loss: 0.919 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1196718215942383
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.867 Test Loss: 0.967 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3814520835876465
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.854 Vali Acc: 0.861 Test Loss: 0.854 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9969990253448486
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.976 Vali Acc: 0.844 Test Loss: 0.976 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1542719
model size : 15.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.621469736099243
Epoch: 1, Steps: 12 | Train Loss: 2.527 Vali Loss: 1.864 Vali Acc: 0.522 Test Loss: 1.864 Test Acc: 0.522
Validation loss decreased (inf --> -0.522204).  Saving model ...
Epoch: 2 cost time: 1.943490982055664
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.209 Vali Acc: 0.656 Test Loss: 1.209 Test Acc: 0.656
Validation loss decreased (-0.522204 --> -0.655543).  Saving model ...
Epoch: 3 cost time: 1.973102331161499
Epoch: 3, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.882 Vali Acc: 0.733 Test Loss: 0.882 Test Acc: 0.733
Validation loss decreased (-0.655543 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 2.1998369693756104
Epoch: 4, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.797 Vali Acc: 0.739 Test Loss: 0.797 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 1.9406793117523193
Epoch: 5, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.738881 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.8399677276611328
Epoch: 6, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0660247802734375
Epoch: 7, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.014171600341797
Epoch: 8, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827770).  Saving model ...
Epoch: 9 cost time: 1.878040075302124
Epoch: 9, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.747 Vali Acc: 0.806 Test Loss: 0.747 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8967845439910889
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.882 Vali Acc: 0.789 Test Loss: 0.882 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7797389030456543
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.798 Vali Acc: 0.811 Test Loss: 0.798 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7150123119354248
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.948 Vali Acc: 0.806 Test Loss: 0.948 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7169945240020752
Epoch: 13, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
Validation loss decreased (-0.827770 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.9168915748596191
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.700 Vali Acc: 0.867 Test Loss: 0.700 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 2.182345151901245
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.685 Vali Acc: 0.872 Test Loss: 0.685 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 16 cost time: 2.0254831314086914
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4091362953186035
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.887 Vali Acc: 0.817 Test Loss: 0.887 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.123441219329834
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9239556789398193
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.883 Vali Acc: 0.883 Test Loss: 0.883 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883325).  Saving model ...
Epoch: 20 cost time: 2.27732253074646
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.840 Vali Acc: 0.850 Test Loss: 0.840 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3629164695739746
Epoch: 21, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.885 Vali Acc: 0.861 Test Loss: 0.885 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4061057567596436
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3930375576019287
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.849 Vali Acc: 0.872 Test Loss: 0.849 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.686791181564331
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.799 Vali Acc: 0.861 Test Loss: 0.799 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.666985273361206
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.038 Vali Acc: 0.872 Test Loss: 1.038 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.382453203201294
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.878 Test Loss: 0.833 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3325085639953613
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.814 Vali Acc: 0.867 Test Loss: 0.814 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.451408863067627
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.867 Test Loss: 0.947 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4858174324035645
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.032 Vali Acc: 0.867 Test Loss: 1.032 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1542719
model size : 15.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.017218351364136
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.184 Vali Acc: 0.411 Test Loss: 2.184 Test Acc: 0.411
Validation loss decreased (inf --> -0.411089).  Saving model ...
Epoch: 2 cost time: 1.9279365539550781
Epoch: 2, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.470 Vali Acc: 0.594 Test Loss: 1.470 Test Acc: 0.594
Validation loss decreased (-0.411089 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 1.9421217441558838
Epoch: 3, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.144 Vali Acc: 0.717 Test Loss: 1.144 Test Acc: 0.717
Validation loss decreased (-0.594430 --> -0.716655).  Saving model ...
Epoch: 4 cost time: 1.70884108543396
Epoch: 4, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.954 Vali Acc: 0.711 Test Loss: 0.954 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8840019702911377
Epoch: 5, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.848 Vali Acc: 0.761 Test Loss: 0.848 Test Acc: 0.761
Validation loss decreased (-0.716655 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 1.8103222846984863
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 2.155555009841919
Epoch: 7, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 2.2749135494232178
Epoch: 8, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0709428787231445
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 2.0748038291931152
Epoch: 10, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.082143783569336
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 12 cost time: 2.025191307067871
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.663 Vali Acc: 0.856 Test Loss: 0.663 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6978332996368408
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9680027961730957
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.719 Vali Acc: 0.833 Test Loss: 0.719 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.993534803390503
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.679 Vali Acc: 0.839 Test Loss: 0.679 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.385455846786499
Epoch: 16, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.176239013671875
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.729 Vali Acc: 0.828 Test Loss: 0.729 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.122530698776245
Epoch: 18, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.815 Vali Acc: 0.811 Test Loss: 0.815 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.182608127593994
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.711 Vali Acc: 0.844 Test Loss: 0.711 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9027435779571533
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7274432182312012
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2540863
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3014280796051025
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.176 Vali Acc: 0.444 Test Loss: 2.176 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 1.7766623497009277
Epoch: 2, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.462 Vali Acc: 0.606 Test Loss: 1.462 Test Acc: 0.606
Validation loss decreased (-0.444423 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 2.0788092613220215
Epoch: 3, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.140 Vali Acc: 0.717 Test Loss: 1.140 Test Acc: 0.717
Validation loss decreased (-0.605541 --> -0.716655).  Saving model ...
Epoch: 4 cost time: 1.7921257019042969
Epoch: 4, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.953 Vali Acc: 0.706 Test Loss: 0.953 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.045591354370117
Epoch: 5, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.844 Vali Acc: 0.772 Test Loss: 0.844 Test Acc: 0.772
Validation loss decreased (-0.716655 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.691230297088623
Epoch: 6, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.726 Vali Acc: 0.811 Test Loss: 0.726 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.645228624343872
Epoch: 7, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5866682529449463
Epoch: 8, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 9 cost time: 1.7894811630249023
Epoch: 9, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 1.5731432437896729
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5252654552459717
Epoch: 11, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6997265815734863
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.5980916023254395
Epoch: 13, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9228434562683105
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7260217666625977
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8198137283325195
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 17 cost time: 1.9262433052062988
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.740 Vali Acc: 0.822 Test Loss: 0.740 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9326319694519043
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8165435791015625
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.727 Vali Acc: 0.828 Test Loss: 0.727 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.661564588546753
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.750 Vali Acc: 0.822 Test Loss: 0.750 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7975025177001953
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.751 Vali Acc: 0.839 Test Loss: 0.751 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.145721435546875
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.802 Vali Acc: 0.833 Test Loss: 0.802 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6727485656738281
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.789 Vali Acc: 0.856 Test Loss: 0.789 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9170641899108887
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6987648010253906
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.786116600036621
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.850 Vali Acc: 0.844 Test Loss: 0.850 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2540863
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.883862733840942
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.170 Vali Acc: 0.444 Test Loss: 2.170 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 2.0823984146118164
Epoch: 2, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.455 Vali Acc: 0.611 Test Loss: 1.455 Test Acc: 0.611
Validation loss decreased (-0.444423 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 1.9253888130187988
Epoch: 3, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.137 Vali Acc: 0.722 Test Loss: 1.137 Test Acc: 0.722
Validation loss decreased (-0.611097 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 2.001452684402466
Epoch: 4, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9819300174713135
Epoch: 5, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.846 Vali Acc: 0.783 Test Loss: 0.846 Test Acc: 0.783
Validation loss decreased (-0.722211 --> -0.783325).  Saving model ...
Epoch: 6 cost time: 1.9821083545684814
Epoch: 6, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.783325 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 1.8861348628997803
Epoch: 7, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 1.9256339073181152
Epoch: 8, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.686 Vali Acc: 0.817 Test Loss: 0.686 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7963249683380127
Epoch: 9, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 1.720243215560913
Epoch: 10, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7814874649047852
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.851987600326538
Epoch: 12, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 1.7380571365356445
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.717620611190796
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8641035556793213
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8752334117889404
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877771).  Saving model ...
Epoch: 17 cost time: 1.8798942565917969
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8889105319976807
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.759 Vali Acc: 0.856 Test Loss: 0.759 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1495308876037598
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.963050365447998
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.849 Vali Acc: 0.867 Test Loss: 0.849 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.930030107498169
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8967976570129395
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.802 Vali Acc: 0.861 Test Loss: 0.802 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1371140480041504
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7521157264709473
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8024444580078125
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.709 Vali Acc: 0.867 Test Loss: 0.709 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7166328430175781
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2540863
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.290642261505127
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.170 Vali Acc: 0.367 Test Loss: 2.170 Test Acc: 0.367
Validation loss decreased (inf --> -0.366645).  Saving model ...
Epoch: 2 cost time: 1.6713330745697021
Epoch: 2, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.446 Vali Acc: 0.639 Test Loss: 1.446 Test Acc: 0.639
Validation loss decreased (-0.366645 --> -0.638874).  Saving model ...
Epoch: 3 cost time: 1.9292511940002441
Epoch: 3, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.128 Vali Acc: 0.722 Test Loss: 1.128 Test Acc: 0.722
Validation loss decreased (-0.638874 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 1.497192621231079
Epoch: 4, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.997267246246338
Epoch: 5, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.829 Vali Acc: 0.806 Test Loss: 0.829 Test Acc: 0.806
Validation loss decreased (-0.733324 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 2.0274107456207275
Epoch: 6, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.698 Vali Acc: 0.806 Test Loss: 0.698 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 2.017885684967041
Epoch: 7, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.645 Vali Acc: 0.817 Test Loss: 0.645 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 1.814288854598999
Epoch: 8, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 2.1551551818847656
Epoch: 9, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9781742095947266
Epoch: 10, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.9120643138885498
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 2.26147198677063
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.133683443069458
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9817633628845215
Epoch: 14, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.135965585708618
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.087800979614258
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0366690158843994
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1838972568511963
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.074488878250122
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 2.424798011779785
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2930750846862793
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.32800030708313
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.109086036682129
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9804582595825195
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9666728973388672
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0000269412994385
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9613888263702393
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.018822431564331
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9438056945800781
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2540863
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.189007759094238
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.258 Vali Acc: 0.344 Test Loss: 2.258 Test Acc: 0.344
Validation loss decreased (inf --> -0.344422).  Saving model ...
Epoch: 2 cost time: 1.9273548126220703
Epoch: 2, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.525 Vali Acc: 0.600 Test Loss: 1.525 Test Acc: 0.600
Validation loss decreased (-0.344422 --> -0.599985).  Saving model ...
Epoch: 3 cost time: 1.999917984008789
Epoch: 3, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.128 Vali Acc: 0.689 Test Loss: 1.128 Test Acc: 0.689
Validation loss decreased (-0.599985 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.7997772693634033
Epoch: 4, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738879).  Saving model ...
Epoch: 5 cost time: 2.037409543991089
Epoch: 5, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.839 Vali Acc: 0.772 Test Loss: 0.839 Test Acc: 0.772
Validation loss decreased (-0.738879 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.7806508541107178
Epoch: 6, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.731 Vali Acc: 0.806 Test Loss: 0.731 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.9021897315979004
Epoch: 7, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 1.980412244796753
Epoch: 8, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 2.023944616317749
Epoch: 9, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.770082950592041
Epoch: 10, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1742844581604004
Epoch: 11, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.8347787857055664
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8856768608093262
Epoch: 13, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 14 cost time: 1.8397727012634277
Epoch: 14, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7769885063171387
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.695 Vali Acc: 0.839 Test Loss: 0.695 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8932299613952637
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.116346836090088
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.010525941848755
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8316962718963623
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.152867555618286
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8287935256958008
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1689951419830322
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2972629070281982
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.790 Vali Acc: 0.856 Test Loss: 0.790 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1492287
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.49229097366333
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.250 Vali Acc: 0.383 Test Loss: 2.250 Test Acc: 0.383
Validation loss decreased (inf --> -0.383311).  Saving model ...
Epoch: 2 cost time: 1.9498703479766846
Epoch: 2, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.516 Vali Acc: 0.589 Test Loss: 1.516 Test Acc: 0.589
Validation loss decreased (-0.383311 --> -0.588874).  Saving model ...
Epoch: 3 cost time: 1.6954071521759033
Epoch: 3, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.123 Vali Acc: 0.706 Test Loss: 1.123 Test Acc: 0.706
Validation loss decreased (-0.588874 --> -0.705544).  Saving model ...
Epoch: 4 cost time: 1.7996323108673096
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.6746392250061035
Epoch: 5, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.844 Vali Acc: 0.772 Test Loss: 0.844 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.788086175918579
Epoch: 6, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.8642070293426514
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 1.8150551319122314
Epoch: 8, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.8686890602111816
Epoch: 9, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.9931235313415527
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8142659664154053
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.91255784034729
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.8189120292663574
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.992084264755249
Epoch: 14, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9926233291625977
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6599643230438232
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.659583568572998
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 18 cost time: 1.746584415435791
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.716 Vali Acc: 0.844 Test Loss: 0.716 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6022584438323975
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.727529525756836
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.767 Vali Acc: 0.856 Test Loss: 0.767 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4535717964172363
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0379562377929688
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7646257877349854
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7959511280059814
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8433332443237305
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.806 Vali Acc: 0.839 Test Loss: 0.806 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.62001371383667
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.903 Vali Acc: 0.850 Test Loss: 0.903 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.857884407043457
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.816 Vali Acc: 0.861 Test Loss: 0.816 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1492287
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.086884021759033
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.245 Vali Acc: 0.400 Test Loss: 2.245 Test Acc: 0.400
Validation loss decreased (inf --> -0.399978).  Saving model ...
Epoch: 2 cost time: 1.4449741840362549
Epoch: 2, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.499 Vali Acc: 0.600 Test Loss: 1.499 Test Acc: 0.600
Validation loss decreased (-0.399978 --> -0.599985).  Saving model ...
Epoch: 3 cost time: 1.7852520942687988
Epoch: 3, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.109 Vali Acc: 0.689 Test Loss: 1.109 Test Acc: 0.689
Validation loss decreased (-0.599985 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.9230871200561523
Epoch: 4, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
Validation loss decreased (-0.688878 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.8499140739440918
Epoch: 5, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.835 Vali Acc: 0.778 Test Loss: 0.835 Test Acc: 0.778
Validation loss decreased (-0.733324 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 1.8727333545684814
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.8714890480041504
Epoch: 7, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 1.6728971004486084
Epoch: 8, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 1.7378523349761963
Epoch: 9, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.8570761680603027
Epoch: 10, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6823399066925049
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0040218830108643
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1783409118652344
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.008312225341797
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9375977516174316
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9691987037658691
Epoch: 16, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 2.152559518814087
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0085322856903076
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.813 Vali Acc: 0.822 Test Loss: 0.813 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.837890386581421
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.689 Vali Acc: 0.839 Test Loss: 0.689 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.004192352294922
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.739 Vali Acc: 0.839 Test Loss: 0.739 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9259400367736816
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.665 Vali Acc: 0.867 Test Loss: 0.665 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 1.6392781734466553
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8870210647583008
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7956743240356445
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7628397941589355
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.899057388305664
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8149099349975586
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.765 Vali Acc: 0.867 Test Loss: 0.765 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8814234733581543
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.787 Vali Acc: 0.861 Test Loss: 0.787 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0379486083984375
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.804 Vali Acc: 0.856 Test Loss: 0.804 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.033339262008667
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.812 Vali Acc: 0.861 Test Loss: 0.812 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9663450717926025
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.813 Vali Acc: 0.861 Test Loss: 0.813 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1492287
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.059407711029053
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.240 Vali Acc: 0.422 Test Loss: 2.240 Test Acc: 0.422
Validation loss decreased (inf --> -0.422200).  Saving model ...
Epoch: 2 cost time: 1.7497782707214355
Epoch: 2, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.495 Vali Acc: 0.622 Test Loss: 1.495 Test Acc: 0.622
Validation loss decreased (-0.422200 --> -0.622207).  Saving model ...
Epoch: 3 cost time: 1.7191829681396484
Epoch: 3, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.112 Vali Acc: 0.700 Test Loss: 1.112 Test Acc: 0.700
Validation loss decreased (-0.622207 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.603590488433838
Epoch: 4, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.939 Vali Acc: 0.728 Test Loss: 0.939 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.5483946800231934
Epoch: 5, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
Validation loss decreased (-0.727768 --> -0.783325).  Saving model ...
Epoch: 6 cost time: 1.6351127624511719
Epoch: 6, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 1.8675200939178467
Epoch: 7, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.6955251693725586
Epoch: 8, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 1.6630046367645264
Epoch: 9, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 1.7154109477996826
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 1.6597609519958496
Epoch: 11, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866661).  Saving model ...
Epoch: 12 cost time: 1.6197528839111328
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9752581119537354
Epoch: 13, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8624839782714844
Epoch: 14, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 15 cost time: 1.9538676738739014
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9166371822357178
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.686 Vali Acc: 0.872 Test Loss: 0.686 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7445287704467773
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9222333431243896
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9566066265106201
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.110560417175293
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.146925449371338
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.126640796661377
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9712812900543213
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4219770431518555
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1492287
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.7279369831085205
Epoch: 1, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.241 Vali Acc: 0.389 Test Loss: 2.241 Test Acc: 0.389
Validation loss decreased (inf --> -0.388866).  Saving model ...
Epoch: 2 cost time: 1.9651424884796143
Epoch: 2, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.486 Vali Acc: 0.611 Test Loss: 1.486 Test Acc: 0.611
Validation loss decreased (-0.388866 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.8501567840576172
Epoch: 3, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.123 Vali Acc: 0.706 Test Loss: 1.123 Test Acc: 0.706
Validation loss decreased (-0.611096 --> -0.705544).  Saving model ...
Epoch: 4 cost time: 1.7978906631469727
Epoch: 4, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 1.9096627235412598
Epoch: 5, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.793 Vali Acc: 0.778 Test Loss: 0.793 Test Acc: 0.778
Validation loss decreased (-0.711101 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 2.01841139793396
Epoch: 6, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.752 Vali Acc: 0.811 Test Loss: 0.752 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 2.032543659210205
Epoch: 7, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.811104 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 1.9846246242523193
Epoch: 8, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.074092388153076
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.8312454223632812
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0479326248168945
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8917648792266846
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.881439447402954
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 14 cost time: 1.8851969242095947
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.975097894668579
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.617 Vali Acc: 0.839 Test Loss: 0.617 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0619864463806152
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0167245864868164
Epoch: 17, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8630802631378174
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.843492031097412
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0245988368988037
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9217605590820312
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.786757469177246
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.731 Vali Acc: 0.867 Test Loss: 0.731 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 1.7836380004882812
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8206868171691895
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.85740065574646
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.871 Vali Acc: 0.867 Test Loss: 0.871 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.681969165802002
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.835 Vali Acc: 0.861 Test Loss: 0.835 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8554887771606445
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6533188819885254
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.917 Vali Acc: 0.833 Test Loss: 0.917 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6055855751037598
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.977 Vali Acc: 0.839 Test Loss: 0.977 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.770176649093628
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.073 Vali Acc: 0.839 Test Loss: 1.073 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8456919193267822
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.998 Vali Acc: 0.839 Test Loss: 0.998 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7577946186065674
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.039 Vali Acc: 0.861 Test Loss: 1.039 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 967999
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.152331113815308
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.246 Vali Acc: 0.400 Test Loss: 2.246 Test Acc: 0.400
Validation loss decreased (inf --> -0.399978).  Saving model ...
Epoch: 2 cost time: 2.0117201805114746
Epoch: 2, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.486 Vali Acc: 0.611 Test Loss: 1.486 Test Acc: 0.611
Validation loss decreased (-0.399978 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.9429633617401123
Epoch: 3, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.123 Vali Acc: 0.711 Test Loss: 1.123 Test Acc: 0.711
Validation loss decreased (-0.611096 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 1.8342294692993164
Epoch: 4, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8468387126922607
Epoch: 5, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.711100 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 1.884725570678711
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.747 Vali Acc: 0.817 Test Loss: 0.747 Test Acc: 0.817
Validation loss decreased (-0.749992 --> -0.816659).  Saving model ...
Epoch: 7 cost time: 1.7348523139953613
Epoch: 7, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.9214673042297363
Epoch: 8, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.051971912384033
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 2.0136425495147705
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1115875244140625
Epoch: 11, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0632896423339844
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9085326194763184
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0867857933044434
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7771353721618652
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9035654067993164
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8075933456420898
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8547477722167969
Epoch: 18, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6756834983825684
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 967999
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8337442874908447
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.272 Vali Acc: 0.406 Test Loss: 2.272 Test Acc: 0.406
Validation loss decreased (inf --> -0.405533).  Saving model ...
Epoch: 2 cost time: 2.051543712615967
Epoch: 2, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.503 Vali Acc: 0.622 Test Loss: 1.503 Test Acc: 0.622
Validation loss decreased (-0.405533 --> -0.622207).  Saving model ...
Epoch: 3 cost time: 1.9845852851867676
Epoch: 3, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.139 Vali Acc: 0.711 Test Loss: 1.139 Test Acc: 0.711
Validation loss decreased (-0.622207 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 2.057852029800415
Epoch: 4, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.975 Vali Acc: 0.711 Test Loss: 0.975 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 1.9974889755249023
Epoch: 5, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 1.9336514472961426
Epoch: 6, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.758 Vali Acc: 0.811 Test Loss: 0.758 Test Acc: 0.811
Validation loss decreased (-0.744436 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.9604735374450684
Epoch: 7, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 1.9894258975982666
Epoch: 8, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6603026390075684
Epoch: 9, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 10 cost time: 1.877880573272705
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6826815605163574
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.641650915145874
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9809799194335938
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7647857666015625
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7809886932373047
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.611 Vali Acc: 0.817 Test Loss: 0.611 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9981954097747803
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8434369564056396
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.646921157836914
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8627681732177734
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 967999
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.424124002456665
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.267 Vali Acc: 0.378 Test Loss: 2.267 Test Acc: 0.378
Validation loss decreased (inf --> -0.377755).  Saving model ...
Epoch: 2 cost time: 1.841029167175293
Epoch: 2, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.501 Vali Acc: 0.606 Test Loss: 1.501 Test Acc: 0.606
Validation loss decreased (-0.377755 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.9166886806488037
Epoch: 3, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.143 Vali Acc: 0.689 Test Loss: 1.143 Test Acc: 0.689
Validation loss decreased (-0.605541 --> -0.688877).  Saving model ...
Epoch: 4 cost time: 1.7882425785064697
Epoch: 4, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 1.7734792232513428
Epoch: 5, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 1.7307007312774658
Epoch: 6, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.750 Vali Acc: 0.806 Test Loss: 0.750 Test Acc: 0.806
Validation loss decreased (-0.749992 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.9119987487792969
Epoch: 7, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 1.7155256271362305
Epoch: 8, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.6586410999298096
Epoch: 9, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8505587577819824
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 1.889425277709961
Epoch: 11, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.915912389755249
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.995227575302124
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.000781774520874
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7654039859771729
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9987492561340332
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7234735488891602
Epoch: 17, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6998891830444336
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.913813829421997
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.035752773284912
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 967999
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9590506553649902
Epoch: 1, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.058 Vali Acc: 0.461 Test Loss: 2.058 Test Acc: 0.461
Validation loss decreased (inf --> -0.461091).  Saving model ...
Epoch: 2 cost time: 1.7417986392974854
Epoch: 2, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.417 Vali Acc: 0.656 Test Loss: 1.417 Test Acc: 0.656
Validation loss decreased (-0.461091 --> -0.655541).  Saving model ...
Epoch: 3 cost time: 1.771303653717041
Epoch: 3, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.101 Vali Acc: 0.722 Test Loss: 1.101 Test Acc: 0.722
Validation loss decreased (-0.655541 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 1.80902099609375
Epoch: 4, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
Validation loss decreased (-0.722211 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 1.8698863983154297
Epoch: 5, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.805 Vali Acc: 0.767 Test Loss: 0.805 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766659).  Saving model ...
Epoch: 6 cost time: 2.0112712383270264
Epoch: 6, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.829 Vali Acc: 0.778 Test Loss: 0.829 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777769).  Saving model ...
Epoch: 7 cost time: 1.9980309009552002
Epoch: 7, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.691 Vali Acc: 0.817 Test Loss: 0.691 Test Acc: 0.817
Validation loss decreased (-0.777769 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 2.012681245803833
Epoch: 8, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.668 Vali Acc: 0.822 Test Loss: 0.668 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 9 cost time: 2.1720094680786133
Epoch: 9, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.9007985591888428
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.004704713821411
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.9124622344970703
Epoch: 12, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7846431732177734
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.010787010192871
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.803 Vali Acc: 0.817 Test Loss: 0.803 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.027935266494751
Epoch: 15, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0511670112609863
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 2.0016167163848877
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.713 Vali Acc: 0.828 Test Loss: 0.713 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0357072353363037
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.187363624572754
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.740 Vali Acc: 0.811 Test Loss: 0.740 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.327240228652954
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1304187774658203
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2386274337768555
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.09914231300354
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1429989337921143
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.787 Vali Acc: 0.856 Test Loss: 0.787 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2553555965423584
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.734 Vali Acc: 0.856 Test Loss: 0.734 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.393585681915283
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 705855
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.140541076660156
Epoch: 1, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.057 Vali Acc: 0.444 Test Loss: 2.057 Test Acc: 0.444
Validation loss decreased (inf --> -0.444424).  Saving model ...
Epoch: 2 cost time: 1.6570227146148682
Epoch: 2, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.417 Vali Acc: 0.639 Test Loss: 1.417 Test Acc: 0.639
Validation loss decreased (-0.444424 --> -0.638875).  Saving model ...
Epoch: 3 cost time: 1.9951603412628174
Epoch: 3, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.105 Vali Acc: 0.728 Test Loss: 1.105 Test Acc: 0.728
Validation loss decreased (-0.638875 --> -0.727767).  Saving model ...
Epoch: 4 cost time: 1.9016222953796387
Epoch: 4, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.903 Vali Acc: 0.744 Test Loss: 0.903 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 1.856414794921875
Epoch: 5, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.803 Vali Acc: 0.778 Test Loss: 0.803 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 1.7667515277862549
Epoch: 6, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 1.9855351448059082
Epoch: 7, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.688 Vali Acc: 0.817 Test Loss: 0.688 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 2.069039821624756
Epoch: 8, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.611330270767212
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.908339500427246
Epoch: 10, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8273217678070068
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8666608333587646
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8982000350952148
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7201809883117676
Epoch: 14, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.783 Vali Acc: 0.822 Test Loss: 0.783 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7876169681549072
Epoch: 15, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.658 Vali Acc: 0.817 Test Loss: 0.658 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7924232482910156
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7807393074035645
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7057013511657715
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7292211055755615
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 705855
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.239388704299927
Epoch: 1, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.047 Vali Acc: 0.428 Test Loss: 2.047 Test Acc: 0.428
Validation loss decreased (inf --> -0.427757).  Saving model ...
Epoch: 2 cost time: 1.7647006511688232
Epoch: 2, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.404 Vali Acc: 0.633 Test Loss: 1.404 Test Acc: 0.633
Validation loss decreased (-0.427757 --> -0.633319).  Saving model ...
Epoch: 3 cost time: 1.7926740646362305
Epoch: 3, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.104 Vali Acc: 0.717 Test Loss: 1.104 Test Acc: 0.717
Validation loss decreased (-0.633319 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 1.866201639175415
Epoch: 4, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.901 Vali Acc: 0.739 Test Loss: 0.901 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738880).  Saving model ...
Epoch: 5 cost time: 1.6566214561462402
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.799 Vali Acc: 0.767 Test Loss: 0.799 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 6 cost time: 1.9490132331848145
Epoch: 6, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 1.723505973815918
Epoch: 7, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.783325 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.8597452640533447
Epoch: 8, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.883805751800537
Epoch: 9, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.8323979377746582
Epoch: 10, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9945664405822754
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 2.08487606048584
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.100919723510742
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.8530542850494385
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.805 Vali Acc: 0.822 Test Loss: 0.805 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.982602596282959
Epoch: 15, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9978399276733398
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.8896243572235107
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.715 Vali Acc: 0.833 Test Loss: 0.715 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.67582106590271
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.7995314598083496
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8568344116210938
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 1.835017442703247
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7635407447814941
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.918010950088501
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.008622646331787
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.126268148422241
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.734 Vali Acc: 0.856 Test Loss: 0.734 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0593228340148926
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9257771968841553
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7479760646820068
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.914 Vali Acc: 0.850 Test Loss: 0.914 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8544907569885254
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.837 Vali Acc: 0.844 Test Loss: 0.837 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7661263942718506
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 705855
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8509504795074463
Epoch: 1, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.056 Vali Acc: 0.450 Test Loss: 2.056 Test Acc: 0.450
Validation loss decreased (inf --> -0.449979).  Saving model ...
Epoch: 2 cost time: 1.4830873012542725
Epoch: 2, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.406 Vali Acc: 0.611 Test Loss: 1.406 Test Acc: 0.611
Validation loss decreased (-0.449979 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 1.4273431301116943
Epoch: 3, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
Validation loss decreased (-0.611097 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 1.4886083602905273
Epoch: 4, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711102).  Saving model ...
Epoch: 5 cost time: 1.7993769645690918
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 1.8449745178222656
Epoch: 6, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.777 Vali Acc: 0.789 Test Loss: 0.777 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 1.719059705734253
Epoch: 7, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.788881 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.8077154159545898
Epoch: 8, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.914412021636963
Epoch: 9, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.7609851360321045
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7054436206817627
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0129780769348145
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 1.8347673416137695
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.88771390914917
Epoch: 14, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6645140647888184
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.820695161819458
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883327).  Saving model ...
Epoch: 17 cost time: 1.64925217628479
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5984556674957275
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6158595085144043
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5980076789855957
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.513655662536621
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.727 Vali Acc: 0.867 Test Loss: 0.727 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6387217044830322
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.671 Vali Acc: 0.839 Test Loss: 0.671 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7563581466674805
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.798 Vali Acc: 0.861 Test Loss: 0.798 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6883997917175293
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7740857601165771
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7560713291168213
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 705855
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.003373384475708
Epoch: 1, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.205 Vali Acc: 0.461 Test Loss: 2.205 Test Acc: 0.461
Validation loss decreased (inf --> -0.461089).  Saving model ...
Epoch: 2 cost time: 1.5901076793670654
Epoch: 2, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.461 Vali Acc: 0.600 Test Loss: 1.461 Test Acc: 0.600
Validation loss decreased (-0.461089 --> -0.599985).  Saving model ...
Epoch: 3 cost time: 1.5986874103546143
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.124 Vali Acc: 0.733 Test Loss: 1.124 Test Acc: 0.733
Validation loss decreased (-0.599985 --> -0.733322).  Saving model ...
Epoch: 4 cost time: 1.6864714622497559
Epoch: 4, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.991 Vali Acc: 0.739 Test Loss: 0.991 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738879).  Saving model ...
Epoch: 5 cost time: 1.6351275444030762
Epoch: 5, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.867 Vali Acc: 0.761 Test Loss: 0.867 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 1.6770825386047363
Epoch: 6, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
Validation loss decreased (-0.761102 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 1.51336669921875
Epoch: 7, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.437136173248291
Epoch: 8, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.7549762725830078
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.7400414943695068
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 11 cost time: 1.8599631786346436
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.660 Vali Acc: 0.817 Test Loss: 0.660 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7910401821136475
Epoch: 12, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8388450145721436
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6831765174865723
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 15 cost time: 1.7401483058929443
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.742861270904541
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.729 Vali Acc: 0.833 Test Loss: 0.729 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7260830402374268
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5982162952423096
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5819141864776611
Epoch: 19, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.664280652999878
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.768 Vali Acc: 0.856 Test Loss: 0.768 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.726048231124878
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.708 Vali Acc: 0.861 Test Loss: 0.708 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7253024578094482
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.659757375717163
Epoch: 23, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.798783540725708
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 574783
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.444612264633179
Epoch: 1, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.199 Vali Acc: 0.411 Test Loss: 2.199 Test Acc: 0.411
Validation loss decreased (inf --> -0.411089).  Saving model ...
Epoch: 2 cost time: 1.6937308311462402
Epoch: 2, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.458 Vali Acc: 0.606 Test Loss: 1.458 Test Acc: 0.606
Validation loss decreased (-0.411089 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.6757917404174805
Epoch: 3, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.121 Vali Acc: 0.728 Test Loss: 1.121 Test Acc: 0.728
Validation loss decreased (-0.605541 --> -0.727767).  Saving model ...
Epoch: 4 cost time: 1.5226664543151855
Epoch: 4, Steps: 12 | Train Loss: 0.928 Vali Loss: 0.994 Vali Acc: 0.756 Test Loss: 0.994 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755546).  Saving model ...
Epoch: 5 cost time: 1.5699994564056396
Epoch: 5, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5655810832977295
Epoch: 6, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.715 Vali Acc: 0.828 Test Loss: 0.715 Test Acc: 0.828
Validation loss decreased (-0.755546 --> -0.827771).  Saving model ...
Epoch: 7 cost time: 1.5615777969360352
Epoch: 7, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5819759368896484
Epoch: 8, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.5351369380950928
Epoch: 9, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 10 cost time: 1.6105372905731201
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.575857162475586
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4722774028778076
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5969860553741455
Epoch: 13, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.581078052520752
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.5674827098846436
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6727547645568848
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7153751850128174
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7870335578918457
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7636198997497559
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5365207195281982
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.736 Vali Acc: 0.856 Test Loss: 0.736 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7490007877349854
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5308067798614502
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.738 Vali Acc: 0.844 Test Loss: 0.738 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7273192405700684
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5311031341552734
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.772 Vali Acc: 0.861 Test Loss: 0.772 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 574783
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.597670316696167
Epoch: 1, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.193 Vali Acc: 0.417 Test Loss: 2.193 Test Acc: 0.417
Validation loss decreased (inf --> -0.416645).  Saving model ...
Epoch: 2 cost time: 1.829355001449585
Epoch: 2, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.454 Vali Acc: 0.594 Test Loss: 1.454 Test Acc: 0.594
Validation loss decreased (-0.416645 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 1.7561676502227783
Epoch: 3, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.116 Vali Acc: 0.722 Test Loss: 1.116 Test Acc: 0.722
Validation loss decreased (-0.594430 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 1.6157076358795166
Epoch: 4, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.991 Vali Acc: 0.739 Test Loss: 0.991 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738879).  Saving model ...
Epoch: 5 cost time: 1.659430742263794
Epoch: 5, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.7130727767944336
Epoch: 6, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.755547 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.6873998641967773
Epoch: 7, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.715 Vali Acc: 0.806 Test Loss: 0.715 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6084094047546387
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.857407808303833
Epoch: 9, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.9732329845428467
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 1.822357416152954
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6885356903076172
Epoch: 12, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.972428560256958
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.747072458267212
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 1.7018883228302002
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7723357677459717
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.705 Vali Acc: 0.839 Test Loss: 0.705 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.667360544204712
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7046613693237305
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8633694648742676
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7629504203796387
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4027349948883057
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.473109245300293
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.711 Vali Acc: 0.844 Test Loss: 0.711 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5749380588531494
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.735 Vali Acc: 0.861 Test Loss: 0.735 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.903456687927246
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 574783
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.174033164978027
Epoch: 1, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.197 Vali Acc: 0.400 Test Loss: 2.197 Test Acc: 0.400
Validation loss decreased (inf --> -0.399978).  Saving model ...
Epoch: 2 cost time: 1.8660614490509033
Epoch: 2, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.458 Vali Acc: 0.606 Test Loss: 1.458 Test Acc: 0.606
Validation loss decreased (-0.399978 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.9157426357269287
Epoch: 3, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.132 Vali Acc: 0.694 Test Loss: 1.132 Test Acc: 0.694
Validation loss decreased (-0.605541 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 1.8401930332183838
Epoch: 4, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.017 Vali Acc: 0.711 Test Loss: 1.017 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 1.6350395679473877
Epoch: 5, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.875 Vali Acc: 0.744 Test Loss: 0.875 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 1.9143497943878174
Epoch: 6, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.703 Vali Acc: 0.811 Test Loss: 0.703 Test Acc: 0.811
Validation loss decreased (-0.744436 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.6777794361114502
Epoch: 7, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.765120267868042
Epoch: 8, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.629 Vali Acc: 0.828 Test Loss: 0.629 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.6167807579040527
Epoch: 9, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.821657419204712
Epoch: 10, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.787825584411621
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8914868831634521
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 13 cost time: 1.7785913944244385
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.833935022354126
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.883 Test Loss: 0.551 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 15 cost time: 1.9864513874053955
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8065087795257568
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.620004415512085
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.584 Vali Acc: 0.883 Test Loss: 0.584 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5239968299865723
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8782517910003662
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6064493656158447
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6541523933410645
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.510866403579712
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6162776947021484
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6169803142547607
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.658 Vali Acc: 0.861 Test Loss: 0.658 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 574783
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9921727180480957
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.225 Vali Acc: 0.272 Test Loss: 2.225 Test Acc: 0.272
Validation loss decreased (inf --> -0.272200).  Saving model ...
Epoch: 2 cost time: 1.9023997783660889
Epoch: 2, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.499 Vali Acc: 0.550 Test Loss: 1.499 Test Acc: 0.550
Validation loss decreased (-0.272200 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 1.7251646518707275
Epoch: 3, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.143 Vali Acc: 0.700 Test Loss: 1.143 Test Acc: 0.700
Validation loss decreased (-0.549985 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.8174433708190918
Epoch: 4, Steps: 12 | Train Loss: 0.928 Vali Loss: 0.986 Vali Acc: 0.728 Test Loss: 0.986 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.675330400466919
Epoch: 5, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.6138556003570557
Epoch: 6, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.642169713973999
Epoch: 7, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.706 Vali Acc: 0.806 Test Loss: 0.706 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 8 cost time: 1.6434884071350098
Epoch: 8, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 1.7054774761199951
Epoch: 9, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.642 Vali Acc: 0.817 Test Loss: 0.642 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 10 cost time: 1.564823865890503
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 1.6766955852508545
Epoch: 11, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 12 cost time: 1.698908805847168
Epoch: 12, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.680516242980957
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.629615306854248
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4912104606628418
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 16 cost time: 1.9278039932250977
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6417701244354248
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.658 Vali Acc: 0.861 Test Loss: 0.658 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.8010663986206055
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.746 Vali Acc: 0.839 Test Loss: 0.746 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.96742582321167
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.807896614074707
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.759800910949707
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.698 Vali Acc: 0.844 Test Loss: 0.698 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6431748867034912
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.799 Vali Acc: 0.844 Test Loss: 0.799 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7843835353851318
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 24 cost time: 1.7201776504516602
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.791 Vali Acc: 0.861 Test Loss: 0.791 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.799283742904663
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.796 Vali Acc: 0.861 Test Loss: 0.796 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7068827152252197
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.928 Vali Acc: 0.861 Test Loss: 0.928 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7235772609710693
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.831 Vali Acc: 0.861 Test Loss: 0.831 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7963173389434814
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.915 Vali Acc: 0.850 Test Loss: 0.915 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7812881469726562
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.036 Vali Acc: 0.839 Test Loss: 1.036 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6783843040466309
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.998 Vali Acc: 0.839 Test Loss: 0.998 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7153403759002686
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.932 Vali Acc: 0.839 Test Loss: 0.932 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.74885892868042
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.940 Vali Acc: 0.839 Test Loss: 0.940 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8170599937438965
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.046 Vali Acc: 0.839 Test Loss: 1.046 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 509247
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8152523040771484
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.227 Vali Acc: 0.272 Test Loss: 2.227 Test Acc: 0.272
Validation loss decreased (inf --> -0.272200).  Saving model ...
Epoch: 2 cost time: 1.6882514953613281
Epoch: 2, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.272200 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 1.7168054580688477
Epoch: 3, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.136 Vali Acc: 0.683 Test Loss: 1.136 Test Acc: 0.683
Validation loss decreased (-0.522207 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 1.563328742980957
Epoch: 4, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.4019012451171875
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.593393087387085
Epoch: 6, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.761 Vali Acc: 0.794 Test Loss: 0.761 Test Acc: 0.794
Validation loss decreased (-0.755547 --> -0.794437).  Saving model ...
Epoch: 7 cost time: 1.6565320491790771
Epoch: 7, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 1.6300630569458008
Epoch: 8, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.674 Vali Acc: 0.817 Test Loss: 0.674 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 1.4303698539733887
Epoch: 9, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.637 Vali Acc: 0.839 Test Loss: 0.637 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 10 cost time: 1.6696488857269287
Epoch: 10, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7379488945007324
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 12 cost time: 1.8641383647918701
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.735870361328125
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.8937022686004639
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.6493091583251953
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 1.7086138725280762
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.733205795288086
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7912719249725342
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.751 Vali Acc: 0.828 Test Loss: 0.751 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7988381385803223
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6357123851776123
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.712 Vali Acc: 0.839 Test Loss: 0.712 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8750014305114746
Epoch: 21, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8138530254364014
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855548).  Saving model ...
Epoch: 23 cost time: 1.759774923324585
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6985046863555908
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7961928844451904
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.790 Vali Acc: 0.861 Test Loss: 0.790 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 26 cost time: 1.761232852935791
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.933 Vali Acc: 0.844 Test Loss: 0.933 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.869774580001831
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7721424102783203
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.895 Vali Acc: 0.850 Test Loss: 0.895 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7907438278198242
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.001 Vali Acc: 0.839 Test Loss: 1.001 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8654448986053467
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.947 Vali Acc: 0.828 Test Loss: 0.947 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8911161422729492
Epoch: 31, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.909 Vali Acc: 0.861 Test Loss: 0.909 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7506403923034668
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.868 Vali Acc: 0.844 Test Loss: 0.868 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.765857219696045
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.058 Vali Acc: 0.844 Test Loss: 1.058 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7238428592681885
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.956 Vali Acc: 0.856 Test Loss: 0.956 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6331870555877686
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.058 Vali Acc: 0.856 Test Loss: 1.058 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 509247
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.466114282608032
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.230 Vali Acc: 0.278 Test Loss: 2.230 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 1.8542108535766602
Epoch: 2, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.494 Vali Acc: 0.533 Test Loss: 1.494 Test Acc: 0.533
Validation loss decreased (-0.277755 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 1.9438323974609375
Epoch: 3, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.134 Vali Acc: 0.694 Test Loss: 1.134 Test Acc: 0.694
Validation loss decreased (-0.533318 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 2.008514881134033
Epoch: 4, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.6149864196777344
Epoch: 5, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 1.7336702346801758
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.744436 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.7636096477508545
Epoch: 7, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 1.8772404193878174
Epoch: 8, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.759514331817627
Epoch: 9, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.7543702125549316
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 11 cost time: 1.7487170696258545
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 12 cost time: 1.7200891971588135
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.699852466583252
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7422990798950195
Epoch: 14, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6866066455841064
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.772812843322754
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7988779544830322
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 18 cost time: 1.7791798114776611
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8522324562072754
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.132596015930176
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.714 Vali Acc: 0.839 Test Loss: 0.714 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7880675792694092
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6051850318908691
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.657867431640625
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8683831691741943
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.751 Vali Acc: 0.867 Test Loss: 0.751 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 25 cost time: 1.760810136795044
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6455061435699463
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.850 Vali Acc: 0.861 Test Loss: 0.850 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.834125280380249
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8424782752990723
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.872 Vali Acc: 0.861 Test Loss: 0.872 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9397859573364258
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.800 Vali Acc: 0.861 Test Loss: 0.800 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9025912284851074
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.865 Vali Acc: 0.856 Test Loss: 0.865 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8903236389160156
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.847 Vali Acc: 0.867 Test Loss: 0.847 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9898436069488525
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.832 Vali Acc: 0.861 Test Loss: 0.832 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9730584621429443
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.897 Vali Acc: 0.861 Test Loss: 0.897 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.167759418487549
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.964 Vali Acc: 0.861 Test Loss: 0.964 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 509247
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.650362968444824
Epoch: 1, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.229 Vali Acc: 0.294 Test Loss: 2.229 Test Acc: 0.294
Validation loss decreased (inf --> -0.294422).  Saving model ...
Epoch: 2 cost time: 2.0961503982543945
Epoch: 2, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.502 Vali Acc: 0.528 Test Loss: 1.502 Test Acc: 0.528
Validation loss decreased (-0.294422 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 1.9969916343688965
Epoch: 3, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.143 Vali Acc: 0.689 Test Loss: 1.143 Test Acc: 0.689
Validation loss decreased (-0.527763 --> -0.688877).  Saving model ...
Epoch: 4 cost time: 1.8958001136779785
Epoch: 4, Steps: 12 | Train Loss: 0.925 Vali Loss: 0.987 Vali Acc: 0.694 Test Loss: 0.987 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694435).  Saving model ...
Epoch: 5 cost time: 1.887932300567627
Epoch: 5, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
Validation loss decreased (-0.694435 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.7333099842071533
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 1.8590328693389893
Epoch: 7, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
Validation loss decreased (-0.783326 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 2.0076982975006104
Epoch: 8, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.9295384883880615
Epoch: 9, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 1.745121717453003
Epoch: 10, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 2.1079978942871094
Epoch: 11, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.775681734085083
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.8655409812927246
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.622 Vali Acc: 0.828 Test Loss: 0.622 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9439313411712646
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8136112689971924
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 1.5877962112426758
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.754486083984375
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.019139051437378
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7859430313110352
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.683 Vali Acc: 0.828 Test Loss: 0.683 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7741880416870117
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.657 Vali Acc: 0.867 Test Loss: 0.657 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.953155279159546
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 1.7043750286102295
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6859045028686523
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7165987491607666
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.657 Vali Acc: 0.872 Test Loss: 0.657 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7741303443908691
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8220345973968506
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.709 Vali Acc: 0.861 Test Loss: 0.709 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7326724529266357
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8424465656280518
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7955052852630615
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9113624095916748
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.720 Vali Acc: 0.861 Test Loss: 0.720 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7834303379058838
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.752 Vali Acc: 0.856 Test Loss: 0.752 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 509247
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.022577524185181
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.458 Vali Acc: 0.294 Test Loss: 2.458 Test Acc: 0.294
Validation loss decreased (inf --> -0.294420).  Saving model ...
Epoch: 2 cost time: 1.6132819652557373
Epoch: 2, Steps: 12 | Train Loss: 2.200 Vali Loss: 1.850 Vali Acc: 0.594 Test Loss: 1.850 Test Acc: 0.594
Validation loss decreased (-0.294420 --> -0.594426).  Saving model ...
Epoch: 3 cost time: 1.7836170196533203
Epoch: 3, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.469 Vali Acc: 0.661 Test Loss: 1.469 Test Acc: 0.661
Validation loss decreased (-0.594426 --> -0.661096).  Saving model ...
Epoch: 4 cost time: 1.6830518245697021
Epoch: 4, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.229 Vali Acc: 0.711 Test Loss: 1.229 Test Acc: 0.711
Validation loss decreased (-0.661096 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 1.6396026611328125
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.071 Vali Acc: 0.756 Test Loss: 1.071 Test Acc: 0.756
Validation loss decreased (-0.711099 --> -0.755545).  Saving model ...
Epoch: 6 cost time: 1.6806838512420654
Epoch: 6, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.960 Vali Acc: 0.739 Test Loss: 0.960 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7743680477142334
Epoch: 7, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.877 Vali Acc: 0.789 Test Loss: 0.877 Test Acc: 0.789
Validation loss decreased (-0.755545 --> -0.788880).  Saving model ...
Epoch: 8 cost time: 1.4538724422454834
Epoch: 8, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.799 Vali Acc: 0.822 Test Loss: 0.799 Test Acc: 0.822
Validation loss decreased (-0.788880 --> -0.822214).  Saving model ...
Epoch: 9 cost time: 1.5474817752838135
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.773 Vali Acc: 0.822 Test Loss: 0.773 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 10 cost time: 1.736011266708374
Epoch: 10, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7172691822052002
Epoch: 11, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 12 cost time: 1.8298900127410889
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.7091290950775146
Epoch: 13, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.6537177562713623
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6842255592346191
Epoch: 15, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 1.5730421543121338
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.640 Vali Acc: 0.867 Test Loss: 0.640 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5606181621551514
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5146405696868896
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7537715435028076
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.704101800918579
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6748402118682861
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8869729042053223
Epoch: 22, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8783388137817383
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7843124866485596
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.444049596786499
Epoch: 25, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1204927
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.706778049468994
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.464 Vali Acc: 0.283 Test Loss: 2.464 Test Acc: 0.283
Validation loss decreased (inf --> -0.283309).  Saving model ...
Epoch: 2 cost time: 1.6557297706604004
Epoch: 2, Steps: 12 | Train Loss: 2.219 Vali Loss: 1.853 Vali Acc: 0.589 Test Loss: 1.853 Test Acc: 0.589
Validation loss decreased (-0.283309 --> -0.588870).  Saving model ...
Epoch: 3 cost time: 1.6689412593841553
Epoch: 3, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.465 Vali Acc: 0.644 Test Loss: 1.465 Test Acc: 0.644
Validation loss decreased (-0.588870 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 1.727745532989502
Epoch: 4, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.225 Vali Acc: 0.689 Test Loss: 1.225 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688877).  Saving model ...
Epoch: 5 cost time: 1.7814395427703857
Epoch: 5, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.066 Vali Acc: 0.756 Test Loss: 1.066 Test Acc: 0.756
Validation loss decreased (-0.688877 --> -0.755545).  Saving model ...
Epoch: 6 cost time: 1.7684905529022217
Epoch: 6, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.640843391418457
Epoch: 7, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.878 Vali Acc: 0.794 Test Loss: 0.878 Test Acc: 0.794
Validation loss decreased (-0.755545 --> -0.794436).  Saving model ...
Epoch: 8 cost time: 1.6676044464111328
Epoch: 8, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 9 cost time: 1.5166819095611572
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.772 Vali Acc: 0.828 Test Loss: 0.772 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827770).  Saving model ...
Epoch: 10 cost time: 1.6892659664154053
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5594961643218994
Epoch: 11, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.5046775341033936
Epoch: 12, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.5022962093353271
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.5485095977783203
Epoch: 14, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.623704195022583
Epoch: 15, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 1.584106206893921
Epoch: 16, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6077609062194824
Epoch: 17, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7160100936889648
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7135043144226074
Epoch: 19, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7191646099090576
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8259716033935547
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7409937381744385
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7886855602264404
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6485002040863037
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.642 Vali Acc: 0.861 Test Loss: 0.642 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7103509902954102
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1204927
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6292102336883545
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.460 Vali Acc: 0.278 Test Loss: 2.460 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 1.5151968002319336
Epoch: 2, Steps: 12 | Train Loss: 2.196 Vali Loss: 1.846 Vali Acc: 0.578 Test Loss: 1.846 Test Acc: 0.578
Validation loss decreased (-0.277753 --> -0.577759).  Saving model ...
Epoch: 3 cost time: 1.638967752456665
Epoch: 3, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.454 Vali Acc: 0.667 Test Loss: 1.454 Test Acc: 0.667
Validation loss decreased (-0.577759 --> -0.666652).  Saving model ...
Epoch: 4 cost time: 1.6550109386444092
Epoch: 4, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.220 Vali Acc: 0.717 Test Loss: 1.220 Test Acc: 0.717
Validation loss decreased (-0.666652 --> -0.716654).  Saving model ...
Epoch: 5 cost time: 1.858518362045288
Epoch: 5, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
Validation loss decreased (-0.716654 --> -0.755545).  Saving model ...
Epoch: 6 cost time: 1.837763786315918
Epoch: 6, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5732057094573975
Epoch: 7, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
Validation loss decreased (-0.755545 --> -0.788880).  Saving model ...
Epoch: 8 cost time: 1.7354261875152588
Epoch: 8, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.796 Vali Acc: 0.811 Test Loss: 0.796 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 9 cost time: 1.6536204814910889
Epoch: 9, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827770).  Saving model ...
Epoch: 10 cost time: 1.6684415340423584
Epoch: 10, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 1.8386917114257812
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8290581703186035
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.9487254619598389
Epoch: 13, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.6326823234558105
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6465637683868408
Epoch: 15, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 16 cost time: 1.870020866394043
Epoch: 16, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6314125061035156
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.717808723449707
Epoch: 18, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9510939121246338
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.596 Vali Acc: 0.883 Test Loss: 0.596 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883327).  Saving model ...
Epoch: 20 cost time: 1.7766978740692139
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7005836963653564
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6731607913970947
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.575 Vali Acc: 0.883 Test Loss: 0.575 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883328).  Saving model ...
Epoch: 23 cost time: 1.6563539505004883
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5983707904815674
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 1.692833423614502
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7829010486602783
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6968834400177002
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7144160270690918
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.667 Vali Acc: 0.872 Test Loss: 0.667 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7284090518951416
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6812920570373535
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.636 Vali Acc: 0.883 Test Loss: 0.636 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5346643924713135
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.687371015548706
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.726 Vali Acc: 0.872 Test Loss: 0.726 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6051278114318848
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6683716773986816
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1204927
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8142449855804443
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.462 Vali Acc: 0.228 Test Loss: 2.462 Test Acc: 0.228
Validation loss decreased (inf --> -0.227753).  Saving model ...
Epoch: 2 cost time: 1.5451686382293701
Epoch: 2, Steps: 12 | Train Loss: 2.150 Vali Loss: 1.849 Vali Acc: 0.606 Test Loss: 1.849 Test Acc: 0.606
Validation loss decreased (-0.227753 --> -0.605537).  Saving model ...
Epoch: 3 cost time: 1.6278908252716064
Epoch: 3, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.447 Vali Acc: 0.683 Test Loss: 1.447 Test Acc: 0.683
Validation loss decreased (-0.605537 --> -0.683319).  Saving model ...
Epoch: 4 cost time: 1.6557114124298096
Epoch: 4, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.204 Vali Acc: 0.706 Test Loss: 1.204 Test Acc: 0.706
Validation loss decreased (-0.683319 --> -0.705544).  Saving model ...
Epoch: 5 cost time: 1.6838760375976562
Epoch: 5, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.044 Vali Acc: 0.722 Test Loss: 1.044 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.5621955394744873
Epoch: 6, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.925 Vali Acc: 0.744 Test Loss: 0.925 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.50156569480896
Epoch: 7, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783325).  Saving model ...
Epoch: 8 cost time: 1.4602394104003906
Epoch: 8, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.758 Vali Acc: 0.794 Test Loss: 0.758 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 1.5109748840332031
Epoch: 9, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.5073423385620117
Epoch: 10, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.7262492179870605
Epoch: 11, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.609 Vali Acc: 0.811 Test Loss: 0.609 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6221506595611572
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 1.4388208389282227
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 1.604339361190796
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.7211289405822754
Epoch: 15, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 16 cost time: 1.4663708209991455
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4035112857818604
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5379047393798828
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5887701511383057
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7645139694213867
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.4572484493255615
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.685847282409668
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.5647783279418945
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.5681931972503662
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.65822172164917
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8492393493652344
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8049156665802002
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.845306634902954
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7433311939239502
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.740283727645874
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5771539211273193
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5464298725128174
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5101041793823242
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1204927
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9484660625457764
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.561 Vali Acc: 0.194 Test Loss: 2.561 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 1.467843770980835
Epoch: 2, Steps: 12 | Train Loss: 2.262 Vali Loss: 1.961 Vali Acc: 0.472 Test Loss: 1.961 Test Acc: 0.472
Validation loss decreased (-0.194419 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 1.6195223331451416
Epoch: 3, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.549 Vali Acc: 0.633 Test Loss: 1.549 Test Acc: 0.633
Validation loss decreased (-0.472203 --> -0.633318).  Saving model ...
Epoch: 4 cost time: 1.7200093269348145
Epoch: 4, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.279 Vali Acc: 0.683 Test Loss: 1.279 Test Acc: 0.683
Validation loss decreased (-0.633318 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.6846506595611572
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.082 Vali Acc: 0.750 Test Loss: 1.082 Test Acc: 0.750
Validation loss decreased (-0.683321 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 1.6669790744781494
Epoch: 6, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8700926303863525
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.952 Vali Acc: 0.756 Test Loss: 0.952 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.688286542892456
Epoch: 8, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.705420732498169
Epoch: 9, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.840 Vali Acc: 0.794 Test Loss: 0.840 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794436).  Saving model ...
Epoch: 10 cost time: 1.6396965980529785
Epoch: 10, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.6979947090148926
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.6578407287597656
Epoch: 12, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.6179556846618652
Epoch: 13, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.500401258468628
Epoch: 14, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.54024076461792
Epoch: 15, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.4453842639923096
Epoch: 16, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.520362377166748
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.5051755905151367
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.6447880268096924
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.7475581169128418
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6372804641723633
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5786621570587158
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7326164245605469
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6857550144195557
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.622 Vali Acc: 0.878 Test Loss: 0.622 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.6408088207244873
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7532861232757568
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.683 Vali Acc: 0.867 Test Loss: 0.683 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8221700191497803
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.631 Vali Acc: 0.878 Test Loss: 0.631 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5870532989501953
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6645450592041016
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.599236249923706
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.667 Vali Acc: 0.856 Test Loss: 0.667 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7089028358459473
Epoch: 31, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6686930656433105
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5032846927642822
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8345568180084229
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.701 Vali Acc: 0.861 Test Loss: 0.701 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 680639
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.125406980514526
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.554 Vali Acc: 0.183 Test Loss: 2.554 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 1.8438749313354492
Epoch: 2, Steps: 12 | Train Loss: 2.265 Vali Loss: 1.959 Vali Acc: 0.483 Test Loss: 1.959 Test Acc: 0.483
Validation loss decreased (-0.183308 --> -0.483314).  Saving model ...
Epoch: 3 cost time: 1.8411259651184082
Epoch: 3, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.548 Vali Acc: 0.606 Test Loss: 1.548 Test Acc: 0.606
Validation loss decreased (-0.483314 --> -0.605540).  Saving model ...
Epoch: 4 cost time: 2.0265140533447266
Epoch: 4, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.275 Vali Acc: 0.694 Test Loss: 1.275 Test Acc: 0.694
Validation loss decreased (-0.605540 --> -0.694432).  Saving model ...
Epoch: 5 cost time: 1.8301630020141602
Epoch: 5, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.077 Vali Acc: 0.739 Test Loss: 1.077 Test Acc: 0.739
Validation loss decreased (-0.694432 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 1.8923044204711914
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.981 Vali Acc: 0.756 Test Loss: 0.981 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 7 cost time: 1.7485835552215576
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8551571369171143
Epoch: 8, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.7707133293151855
Epoch: 9, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.9553513526916504
Epoch: 10, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.935711145401001
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.871537208557129
Epoch: 12, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.794548511505127
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 14 cost time: 1.6058204174041748
Epoch: 14, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.706554889678955
Epoch: 15, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.8175649642944336
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.7541143894195557
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.622558355331421
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 1.599254846572876
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.5557091236114502
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.789945363998413
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9238276481628418
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.8726952075958252
Epoch: 23, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.857729434967041
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7893977165222168
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7755489349365234
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.671 Vali Acc: 0.878 Test Loss: 0.671 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 27 cost time: 1.6584181785583496
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.7649097442626953
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.651756763458252
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5695712566375732
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6327214241027832
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6481506824493408
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6861867904663086
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.687 Vali Acc: 0.872 Test Loss: 0.687 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7474236488342285
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6710162162780762
Epoch: 35, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.65397310256958
Epoch: 36, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.691 Vali Acc: 0.878 Test Loss: 0.691 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6668157577514648
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.755 Vali Acc: 0.867 Test Loss: 0.755 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 680639
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8642706871032715
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.539 Vali Acc: 0.156 Test Loss: 2.539 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 1.5973901748657227
Epoch: 2, Steps: 12 | Train Loss: 2.267 Vali Loss: 1.942 Vali Acc: 0.489 Test Loss: 1.942 Test Acc: 0.489
Validation loss decreased (-0.155530 --> -0.488869).  Saving model ...
Epoch: 3 cost time: 1.6282167434692383
Epoch: 3, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.530 Vali Acc: 0.617 Test Loss: 1.530 Test Acc: 0.617
Validation loss decreased (-0.488869 --> -0.616651).  Saving model ...
Epoch: 4 cost time: 1.6260368824005127
Epoch: 4, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.261 Vali Acc: 0.683 Test Loss: 1.261 Test Acc: 0.683
Validation loss decreased (-0.616651 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.6327283382415771
Epoch: 5, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.061 Vali Acc: 0.733 Test Loss: 1.061 Test Acc: 0.733
Validation loss decreased (-0.683321 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.5806877613067627
Epoch: 6, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.4448034763336182
Epoch: 7, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.918 Vali Acc: 0.756 Test Loss: 0.918 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.5207767486572266
Epoch: 8, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.809 Vali Acc: 0.772 Test Loss: 0.809 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 1.5155084133148193
Epoch: 9, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.821 Vali Acc: 0.794 Test Loss: 0.821 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794436).  Saving model ...
Epoch: 10 cost time: 1.578829288482666
Epoch: 10, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.736 Vali Acc: 0.817 Test Loss: 0.736 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.7044906616210938
Epoch: 11, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.6947901248931885
Epoch: 12, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.895918846130371
Epoch: 13, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.8406016826629639
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.9703712463378906
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.6151142120361328
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.8137531280517578
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7001855373382568
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.9560520648956299
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.832287311553955
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 2.009845018386841
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 1.9969203472137451
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.8943042755126953
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.994136095046997
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8941428661346436
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.00917649269104
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.625 Vali Acc: 0.883 Test Loss: 0.625 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 27 cost time: 1.7217295169830322
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8189382553100586
Epoch: 28, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.076308250427246
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.910341739654541
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.672264575958252
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6465108394622803
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.644 Vali Acc: 0.878 Test Loss: 0.644 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5672047138214111
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.781872034072876
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5147230625152588
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.568213939666748
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 680639
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7700445652008057
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.548 Vali Acc: 0.211 Test Loss: 2.548 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 1.6214203834533691
Epoch: 2, Steps: 12 | Train Loss: 2.260 Vali Loss: 1.947 Vali Acc: 0.461 Test Loss: 1.947 Test Acc: 0.461
Validation loss decreased (-0.211086 --> -0.461092).  Saving model ...
Epoch: 3 cost time: 1.418853759765625
Epoch: 3, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.525 Vali Acc: 0.661 Test Loss: 1.525 Test Acc: 0.661
Validation loss decreased (-0.461092 --> -0.661096).  Saving model ...
Epoch: 4 cost time: 1.5064663887023926
Epoch: 4, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.262 Vali Acc: 0.661 Test Loss: 1.262 Test Acc: 0.661
Validation loss decreased (-0.661096 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 1.7801525592803955
Epoch: 5, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.6552643775939941
Epoch: 6, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.962 Vali Acc: 0.694 Test Loss: 0.962 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4344570636749268
Epoch: 7, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.902 Vali Acc: 0.739 Test Loss: 0.902 Test Acc: 0.739
Validation loss decreased (-0.699989 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 1.5587499141693115
Epoch: 8, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 1.538527250289917
Epoch: 9, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.790 Vali Acc: 0.811 Test Loss: 0.790 Test Acc: 0.811
Validation loss decreased (-0.755548 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.3988089561462402
Epoch: 10, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5430958271026611
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.7334840297698975
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.5697031021118164
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5543456077575684
Epoch: 14, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.779606580734253
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4991869926452637
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.5861012935638428
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5897414684295654
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4778852462768555
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.528409481048584
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.5654385089874268
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5950002670288086
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6800074577331543
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 1.7263758182525635
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 1.3900971412658691
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5078089237213135
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.527658462524414
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4765193462371826
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7394495010375977
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7972660064697266
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8056361675262451
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.637 Vali Acc: 0.839 Test Loss: 0.637 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5212650299072266
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.654 Vali Acc: 0.839 Test Loss: 0.654 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4694054126739502
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4933505058288574
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.687 Vali Acc: 0.872 Test Loss: 0.687 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 35 cost time: 1.6818435192108154
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.699 Vali Acc: 0.839 Test Loss: 0.699 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6377546787261963
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7266578674316406
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4197204113006592
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5298078060150146
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5491235256195068
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.838 Vali Acc: 0.867 Test Loss: 0.838 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5731737613677979
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6996634006500244
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4768657684326172
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.793 Vali Acc: 0.867 Test Loss: 0.793 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4164211750030518
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.844 Test Loss: 0.696 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 680639
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.243026494979858
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.489 Vali Acc: 0.167 Test Loss: 2.489 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.6896660327911377
Epoch: 2, Steps: 12 | Train Loss: 2.262 Vali Loss: 1.904 Vali Acc: 0.444 Test Loss: 1.904 Test Acc: 0.444
Validation loss decreased (-0.166642 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 1.5640370845794678
Epoch: 3, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.501 Vali Acc: 0.628 Test Loss: 1.501 Test Acc: 0.628
Validation loss decreased (-0.444425 --> -0.627763).  Saving model ...
Epoch: 4 cost time: 1.4762673377990723
Epoch: 4, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.229 Vali Acc: 0.728 Test Loss: 1.229 Test Acc: 0.728
Validation loss decreased (-0.627763 --> -0.727765).  Saving model ...
Epoch: 5 cost time: 1.488481044769287
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.061 Vali Acc: 0.739 Test Loss: 1.061 Test Acc: 0.739
Validation loss decreased (-0.727765 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 1.590721845626831
Epoch: 6, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 1.5188384056091309
Epoch: 7, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.910 Vali Acc: 0.778 Test Loss: 0.910 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.6739604473114014
Epoch: 8, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.829 Vali Acc: 0.794 Test Loss: 0.829 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.6649909019470215
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.801 Vali Acc: 0.794 Test Loss: 0.801 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794436).  Saving model ...
Epoch: 10 cost time: 1.5418808460235596
Epoch: 10, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.5175414085388184
Epoch: 11, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.659928798675537
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 1.465831995010376
Epoch: 13, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6472759246826172
Epoch: 14, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.5935108661651611
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 1.6096997261047363
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.6019761562347412
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 1.752734661102295
Epoch: 18, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6708598136901855
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.647517442703247
Epoch: 20, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6267359256744385
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7283210754394531
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5594782829284668
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7099089622497559
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6550216674804688
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4973742961883545
Epoch: 26, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.595155954360962
Epoch: 27, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5216774940490723
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5845284461975098
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 418495
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.735790729522705
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.492 Vali Acc: 0.139 Test Loss: 2.492 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.5322918891906738
Epoch: 2, Steps: 12 | Train Loss: 2.258 Vali Loss: 1.906 Vali Acc: 0.444 Test Loss: 1.906 Test Acc: 0.444
Validation loss decreased (-0.138864 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 1.6276094913482666
Epoch: 3, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.501 Vali Acc: 0.617 Test Loss: 1.501 Test Acc: 0.617
Validation loss decreased (-0.444425 --> -0.616652).  Saving model ...
Epoch: 4 cost time: 1.6791672706604004
Epoch: 4, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.227 Vali Acc: 0.700 Test Loss: 1.227 Test Acc: 0.700
Validation loss decreased (-0.616652 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.5717313289642334
Epoch: 5, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.057 Vali Acc: 0.733 Test Loss: 1.057 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 2.0051796436309814
Epoch: 6, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.595146894454956
Epoch: 7, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.912 Vali Acc: 0.756 Test Loss: 0.912 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.7216651439666748
Epoch: 8, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.826 Vali Acc: 0.794 Test Loss: 0.826 Test Acc: 0.794
Validation loss decreased (-0.755546 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.6821117401123047
Epoch: 9, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.8431310653686523
Epoch: 10, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 1.6960334777832031
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.695 Vali Acc: 0.828 Test Loss: 0.695 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.6812312602996826
Epoch: 12, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.723768949508667
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5334653854370117
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6613762378692627
Epoch: 15, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6830294132232666
Epoch: 16, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.5997402667999268
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866660).  Saving model ...
Epoch: 18 cost time: 1.8161735534667969
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9233832359313965
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.7760536670684814
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9115197658538818
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7879104614257812
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8217833042144775
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6291191577911377
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6412558555603027
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 1.6128239631652832
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5518016815185547
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6099903583526611
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.642310619354248
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5351803302764893
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.696 Vali Acc: 0.844 Test Loss: 0.696 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7304911613464355
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.655 Vali Acc: 0.856 Test Loss: 0.655 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7008213996887207
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.766427755355835
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8504722118377686
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.725841760635376
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 418495
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7960877418518066
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.482 Vali Acc: 0.189 Test Loss: 2.482 Test Acc: 0.189
Validation loss decreased (inf --> -0.188864).  Saving model ...
Epoch: 2 cost time: 1.4695985317230225
Epoch: 2, Steps: 12 | Train Loss: 2.246 Vali Loss: 1.897 Vali Acc: 0.428 Test Loss: 1.897 Test Acc: 0.428
Validation loss decreased (-0.188864 --> -0.427759).  Saving model ...
Epoch: 3 cost time: 1.6870830059051514
Epoch: 3, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.490 Vali Acc: 0.644 Test Loss: 1.490 Test Acc: 0.644
Validation loss decreased (-0.427759 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 1.735163688659668
Epoch: 4, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.219 Vali Acc: 0.711 Test Loss: 1.219 Test Acc: 0.711
Validation loss decreased (-0.644430 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 1.7543585300445557
Epoch: 5, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.054 Vali Acc: 0.728 Test Loss: 1.054 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 2.0315940380096436
Epoch: 6, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.962 Vali Acc: 0.739 Test Loss: 0.962 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 1.8104808330535889
Epoch: 7, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.916 Vali Acc: 0.756 Test Loss: 0.916 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.5248699188232422
Epoch: 8, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.826 Vali Acc: 0.794 Test Loss: 0.826 Test Acc: 0.794
Validation loss decreased (-0.755546 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.6753323078155518
Epoch: 9, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.790 Vali Acc: 0.817 Test Loss: 0.790 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.7586798667907715
Epoch: 10, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.7737059593200684
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 12 cost time: 1.8162765502929688
Epoch: 12, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.9021344184875488
Epoch: 13, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.682 Vali Acc: 0.817 Test Loss: 0.682 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8336923122406006
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0964112281799316
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 1.95566987991333
Epoch: 16, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.8753862380981445
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.9108591079711914
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9542315006256104
Epoch: 19, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.928764820098877
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8989386558532715
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8656435012817383
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.041691303253174
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.8550236225128174
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.589 Vali Acc: 0.883 Test Loss: 0.589 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883327).  Saving model ...
Epoch: 25 cost time: 1.924077033996582
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.926253318786621
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.74863862991333
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9219722747802734
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8972892761230469
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9479217529296875
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7048509120941162
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5976464748382568
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8990614414215088
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9607491493225098
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.667 Vali Acc: 0.878 Test Loss: 0.667 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 418495
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.01901650428772
Epoch: 1, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.477 Vali Acc: 0.194 Test Loss: 2.477 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.6378750801086426
Epoch: 2, Steps: 12 | Train Loss: 2.241 Vali Loss: 1.895 Vali Acc: 0.450 Test Loss: 1.895 Test Acc: 0.450
Validation loss decreased (-0.194420 --> -0.449981).  Saving model ...
Epoch: 3 cost time: 1.4699313640594482
Epoch: 3, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.484 Vali Acc: 0.650 Test Loss: 1.484 Test Acc: 0.650
Validation loss decreased (-0.449981 --> -0.649985).  Saving model ...
Epoch: 4 cost time: 1.5705366134643555
Epoch: 4, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.225 Vali Acc: 0.706 Test Loss: 1.225 Test Acc: 0.706
Validation loss decreased (-0.649985 --> -0.705543).  Saving model ...
Epoch: 5 cost time: 1.5582423210144043
Epoch: 5, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.059 Vali Acc: 0.711 Test Loss: 1.059 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 1.4567177295684814
Epoch: 6, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 1.5661835670471191
Epoch: 7, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.920 Vali Acc: 0.756 Test Loss: 0.920 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.5484404563903809
Epoch: 8, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.6435327529907227
Epoch: 9, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.769 Vali Acc: 0.811 Test Loss: 0.769 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.6639256477355957
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.723 Vali Acc: 0.811 Test Loss: 0.723 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 1.4923241138458252
Epoch: 11, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.5371527671813965
Epoch: 12, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.645859956741333
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6414039134979248
Epoch: 14, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6996138095855713
Epoch: 15, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.7245261669158936
Epoch: 16, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 1.7120192050933838
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.5411362648010254
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5102300643920898
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.5244629383087158
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.483912467956543
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.54705810546875
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.5318634510040283
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6384191513061523
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.591 Vali Acc: 0.889 Test Loss: 0.591 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 1.4757802486419678
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5908536911010742
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4987075328826904
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5894854068756104
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8327562808990479
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6922857761383057
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.667536735534668
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6061866283416748
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.547630786895752
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6087281703948975
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 418495
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9846620559692383
Epoch: 1, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.406 Vali Acc: 0.239 Test Loss: 2.406 Test Acc: 0.239
Validation loss decreased (inf --> -0.238865).  Saving model ...
Epoch: 2 cost time: 1.540985107421875
Epoch: 2, Steps: 12 | Train Loss: 2.110 Vali Loss: 1.847 Vali Acc: 0.506 Test Loss: 1.847 Test Acc: 0.506
Validation loss decreased (-0.238865 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 1.8318428993225098
Epoch: 3, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.471 Vali Acc: 0.622 Test Loss: 1.471 Test Acc: 0.622
Validation loss decreased (-0.505537 --> -0.622208).  Saving model ...
Epoch: 4 cost time: 1.6663093566894531
Epoch: 4, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.255 Vali Acc: 0.678 Test Loss: 1.255 Test Acc: 0.678
Validation loss decreased (-0.622208 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 1.6292390823364258
Epoch: 5, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.079 Vali Acc: 0.694 Test Loss: 1.079 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 1.559232473373413
Epoch: 6, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.967 Vali Acc: 0.728 Test Loss: 0.967 Test Acc: 0.728
Validation loss decreased (-0.694434 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 1.479858636856079
Epoch: 7, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.895 Vali Acc: 0.772 Test Loss: 0.895 Test Acc: 0.772
Validation loss decreased (-0.727768 --> -0.772213).  Saving model ...
Epoch: 8 cost time: 1.4449267387390137
Epoch: 8, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.5844669342041016
Epoch: 9, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.5466103553771973
Epoch: 10, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.5652151107788086
Epoch: 11, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 12 cost time: 1.5865354537963867
Epoch: 12, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.9007551670074463
Epoch: 13, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.743 Vali Acc: 0.794 Test Loss: 0.743 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8453266620635986
Epoch: 14, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.6775732040405273
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9408073425292969
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.7663702964782715
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.7946345806121826
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 19 cost time: 1.7948172092437744
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.630300521850586
Epoch: 20, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6121244430541992
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6067917346954346
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5845630168914795
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6419219970703125
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7186708450317383
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5784246921539307
Epoch: 26, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5371277332305908
Epoch: 27, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4999630451202393
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.661 Vali Acc: 0.867 Test Loss: 0.661 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 287423
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9503705501556396
Epoch: 1, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.401 Vali Acc: 0.256 Test Loss: 2.401 Test Acc: 0.256
Validation loss decreased (inf --> -0.255532).  Saving model ...
Epoch: 2 cost time: 1.5553309917449951
Epoch: 2, Steps: 12 | Train Loss: 2.114 Vali Loss: 1.845 Vali Acc: 0.517 Test Loss: 1.845 Test Acc: 0.517
Validation loss decreased (-0.255532 --> -0.516648).  Saving model ...
Epoch: 3 cost time: 1.500178575515747
Epoch: 3, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.468 Vali Acc: 0.650 Test Loss: 1.468 Test Acc: 0.650
Validation loss decreased (-0.516648 --> -0.649985).  Saving model ...
Epoch: 4 cost time: 1.617415428161621
Epoch: 4, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.250 Vali Acc: 0.683 Test Loss: 1.250 Test Acc: 0.683
Validation loss decreased (-0.649985 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.6149380207061768
Epoch: 5, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.593881607055664
Epoch: 6, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.963 Vali Acc: 0.717 Test Loss: 0.963 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 1.5813696384429932
Epoch: 7, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.894 Vali Acc: 0.772 Test Loss: 0.894 Test Acc: 0.772
Validation loss decreased (-0.716657 --> -0.772213).  Saving model ...
Epoch: 8 cost time: 1.6356751918792725
Epoch: 8, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 9 cost time: 1.6404359340667725
Epoch: 9, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.761 Vali Acc: 0.806 Test Loss: 0.761 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.6807048320770264
Epoch: 10, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3109002113342285
Epoch: 11, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 12 cost time: 1.4701507091522217
Epoch: 12, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.5498325824737549
Epoch: 13, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.720 Vali Acc: 0.811 Test Loss: 0.720 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6233775615692139
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.4733293056488037
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5500857830047607
Epoch: 16, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.4666974544525146
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.548034429550171
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 19 cost time: 1.6967203617095947
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6019446849822998
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.60011625289917
Epoch: 21, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5644729137420654
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6564319133758545
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6089322566986084
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6840193271636963
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7515745162963867
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6137759685516357
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.667 Vali Acc: 0.856 Test Loss: 0.667 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7802820205688477
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.686 Vali Acc: 0.856 Test Loss: 0.686 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 287423
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.434501647949219
Epoch: 1, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.389 Vali Acc: 0.272 Test Loss: 2.389 Test Acc: 0.272
Validation loss decreased (inf --> -0.272198).  Saving model ...
Epoch: 2 cost time: 1.8497259616851807
Epoch: 2, Steps: 12 | Train Loss: 2.123 Vali Loss: 1.834 Vali Acc: 0.533 Test Loss: 1.834 Test Acc: 0.533
Validation loss decreased (-0.272198 --> -0.533315).  Saving model ...
Epoch: 3 cost time: 1.6599164009094238
Epoch: 3, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.462 Vali Acc: 0.644 Test Loss: 1.462 Test Acc: 0.644
Validation loss decreased (-0.533315 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 1.8103713989257812
Epoch: 4, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.251 Vali Acc: 0.689 Test Loss: 1.251 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688876).  Saving model ...
Epoch: 5 cost time: 1.7766938209533691
Epoch: 5, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.077 Vali Acc: 0.689 Test Loss: 1.077 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 1.5646798610687256
Epoch: 6, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 1.587831974029541
Epoch: 7, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761102).  Saving model ...
Epoch: 8 cost time: 1.6608314514160156
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.837 Vali Acc: 0.778 Test Loss: 0.837 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777769).  Saving model ...
Epoch: 9 cost time: 1.8784348964691162
Epoch: 9, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.772 Vali Acc: 0.806 Test Loss: 0.772 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.649815320968628
Epoch: 10, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.888808012008667
Epoch: 11, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 12 cost time: 1.6856789588928223
Epoch: 12, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.7174756526947021
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7539429664611816
Epoch: 14, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.7840912342071533
Epoch: 15, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.7219860553741455
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.4484708309173584
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.5779552459716797
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.697862148284912
Epoch: 19, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5994229316711426
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.608508586883545
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6078615188598633
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.580 Vali Acc: 0.883 Test Loss: 0.580 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 23 cost time: 1.6149070262908936
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6046850681304932
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7694120407104492
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.657888412475586
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4830098152160645
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.630 Vali Acc: 0.883 Test Loss: 0.630 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6177208423614502
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6451420783996582
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5963215827941895
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6785237789154053
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5629065036773682
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 287423
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.672797203063965
Epoch: 1, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.401 Vali Acc: 0.211 Test Loss: 2.401 Test Acc: 0.211
Validation loss decreased (inf --> -0.211087).  Saving model ...
Epoch: 2 cost time: 1.5442078113555908
Epoch: 2, Steps: 12 | Train Loss: 2.136 Vali Loss: 1.843 Vali Acc: 0.500 Test Loss: 1.843 Test Acc: 0.500
Validation loss decreased (-0.211087 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.776318073272705
Epoch: 3, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.469 Vali Acc: 0.633 Test Loss: 1.469 Test Acc: 0.633
Validation loss decreased (-0.499982 --> -0.633319).  Saving model ...
Epoch: 4 cost time: 1.5450878143310547
Epoch: 4, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.267 Vali Acc: 0.694 Test Loss: 1.267 Test Acc: 0.694
Validation loss decreased (-0.633319 --> -0.694432).  Saving model ...
Epoch: 5 cost time: 1.5332272052764893
Epoch: 5, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.095 Vali Acc: 0.694 Test Loss: 1.095 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.5517780780792236
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 1.6455776691436768
Epoch: 7, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.897 Vali Acc: 0.767 Test Loss: 0.897 Test Acc: 0.767
Validation loss decreased (-0.699990 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.5613646507263184
Epoch: 8, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.839 Vali Acc: 0.772 Test Loss: 0.839 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 1.5728707313537598
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.6688101291656494
Epoch: 10, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.7952179908752441
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.763136625289917
Epoch: 12, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7348859310150146
Epoch: 13, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.6592223644256592
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.608 Vali Acc: 0.839 Test Loss: 0.608 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.515566110610962
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.5550076961517334
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 1.666093349456787
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.5239434242248535
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.6858177185058594
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6753737926483154
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5428340435028076
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6643245220184326
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.5764989852905273
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6615755558013916
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6598374843597412
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6392462253570557
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6320924758911133
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.655 Vali Acc: 0.867 Test Loss: 0.655 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4160733222961426
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5057618618011475
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.655 Vali Acc: 0.861 Test Loss: 0.655 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.632129430770874
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.580298900604248
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.565229892730713
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 287423
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.799116373062134
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.456 Vali Acc: 0.250 Test Loss: 2.456 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 1.7429141998291016
Epoch: 2, Steps: 12 | Train Loss: 2.267 Vali Loss: 1.874 Vali Acc: 0.489 Test Loss: 1.874 Test Acc: 0.489
Validation loss decreased (-0.249975 --> -0.488870).  Saving model ...
Epoch: 3 cost time: 1.7024314403533936
Epoch: 3, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.500 Vali Acc: 0.656 Test Loss: 1.500 Test Acc: 0.656
Validation loss decreased (-0.488870 --> -0.655541).  Saving model ...
Epoch: 4 cost time: 1.676152229309082
Epoch: 4, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.243 Vali Acc: 0.672 Test Loss: 1.243 Test Acc: 0.672
Validation loss decreased (-0.655541 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.6169767379760742
Epoch: 5, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.107 Vali Acc: 0.694 Test Loss: 1.107 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.53656005859375
Epoch: 6, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 1.4850122928619385
Epoch: 7, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.885 Vali Acc: 0.767 Test Loss: 0.885 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.618340253829956
Epoch: 8, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.674088716506958
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6474099159240723
Epoch: 10, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.756 Vali Acc: 0.822 Test Loss: 0.756 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 1.5851988792419434
Epoch: 11, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6752476692199707
Epoch: 12, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 1.6276769638061523
Epoch: 13, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.6674904823303223
Epoch: 14, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.5280981063842773
Epoch: 15, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 16 cost time: 1.5630853176116943
Epoch: 16, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 1.6140599250793457
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.650148868560791
Epoch: 18, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 19 cost time: 1.7968416213989258
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6610691547393799
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.666849136352539
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6165571212768555
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.5617725849151611
Epoch: 23, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6487431526184082
Epoch: 24, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.612884759902954
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.529064655303955
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.570084810256958
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6828835010528564
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6103360652923584
Epoch: 29, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.656564474105835
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.662 Vali Acc: 0.878 Test Loss: 0.662 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5397093296051025
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6031365394592285
Epoch: 32, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 221887
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.23625922203064
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.452 Vali Acc: 0.244 Test Loss: 2.452 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 1.929295301437378
Epoch: 2, Steps: 12 | Train Loss: 2.268 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
Validation loss decreased (-0.244420 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.930720329284668
Epoch: 3, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.492 Vali Acc: 0.661 Test Loss: 1.492 Test Acc: 0.661
Validation loss decreased (-0.499981 --> -0.661096).  Saving model ...
Epoch: 4 cost time: 1.7219576835632324
Epoch: 4, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.237 Vali Acc: 0.667 Test Loss: 1.237 Test Acc: 0.667
Validation loss decreased (-0.661096 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 1.6932942867279053
Epoch: 5, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.6424870491027832
Epoch: 6, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.976 Vali Acc: 0.761 Test Loss: 0.976 Test Acc: 0.761
Validation loss decreased (-0.699989 --> -0.761101).  Saving model ...
Epoch: 7 cost time: 1.6268095970153809
Epoch: 7, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.689765214920044
Epoch: 8, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.761101 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.822321891784668
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.811 Vali Acc: 0.811 Test Loss: 0.811 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.9390413761138916
Epoch: 10, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.8448333740234375
Epoch: 11, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.724 Vali Acc: 0.811 Test Loss: 0.724 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8552675247192383
Epoch: 12, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.9236199855804443
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.7829208374023438
Epoch: 14, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.7036943435668945
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 16 cost time: 1.8999338150024414
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7234182357788086
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 18 cost time: 1.6725804805755615
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.7430946826934814
Epoch: 19, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.8118443489074707
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.691561222076416
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1743316650390625
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.714451789855957
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9736049175262451
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8583829402923584
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9856154918670654
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.864372730255127
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6182923316955566
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7646703720092773
Epoch: 29, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.640 Vali Acc: 0.861 Test Loss: 0.640 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6602535247802734
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.663 Vali Acc: 0.867 Test Loss: 0.663 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5681416988372803
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7551109790802002
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 221887
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.073714256286621
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.473 Vali Acc: 0.244 Test Loss: 2.473 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 1.5685648918151855
Epoch: 2, Steps: 12 | Train Loss: 2.270 Vali Loss: 1.882 Vali Acc: 0.506 Test Loss: 1.882 Test Acc: 0.506
Validation loss decreased (-0.244420 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 1.7650480270385742
Epoch: 3, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.500 Vali Acc: 0.633 Test Loss: 1.500 Test Acc: 0.633
Validation loss decreased (-0.505537 --> -0.633318).  Saving model ...
Epoch: 4 cost time: 1.565631628036499
Epoch: 4, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.248 Vali Acc: 0.656 Test Loss: 1.248 Test Acc: 0.656
Validation loss decreased (-0.633318 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.6198952198028564
Epoch: 5, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.104 Vali Acc: 0.706 Test Loss: 1.104 Test Acc: 0.706
Validation loss decreased (-0.655543 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.8020272254943848
Epoch: 6, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.986 Vali Acc: 0.744 Test Loss: 0.986 Test Acc: 0.744
Validation loss decreased (-0.705545 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.7090237140655518
Epoch: 7, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.895 Vali Acc: 0.767 Test Loss: 0.895 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.6673486232757568
Epoch: 8, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.870 Vali Acc: 0.794 Test Loss: 0.870 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.7147059440612793
Epoch: 9, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.8874995708465576
Epoch: 10, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.7346527576446533
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.6351113319396973
Epoch: 12, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.7526118755340576
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.6559991836547852
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.655 Vali Acc: 0.856 Test Loss: 0.655 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.6303515434265137
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.605621576309204
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.6161065101623535
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7442626953125
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7190394401550293
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.8281550407409668
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6449553966522217
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.726909875869751
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7049500942230225
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.821197748184204
Epoch: 24, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6035053730010986
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5792858600616455
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.639078140258789
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4693875312805176
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4534835815429688
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.645 Vali Acc: 0.872 Test Loss: 0.645 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 1.3995888233184814
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.634 Vali Acc: 0.878 Test Loss: 0.634 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 31 cost time: 1.5491642951965332
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4945173263549805
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6499879360198975
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6823570728302002
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8049347400665283
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.671 Vali Acc: 0.878 Test Loss: 0.671 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5428693294525146
Epoch: 36, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.773 Vali Acc: 0.867 Test Loss: 0.773 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6534359455108643
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.964176893234253
Epoch: 38, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.726 Vali Acc: 0.872 Test Loss: 0.726 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7143123149871826
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9538054466247559
Epoch: 40, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.719 Vali Acc: 0.867 Test Loss: 0.719 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 221887
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7845981121063232
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.478 Vali Acc: 0.206 Test Loss: 2.478 Test Acc: 0.206
Validation loss decreased (inf --> -0.205531).  Saving model ...
Epoch: 2 cost time: 1.5487298965454102
Epoch: 2, Steps: 12 | Train Loss: 2.258 Vali Loss: 1.877 Vali Acc: 0.556 Test Loss: 1.877 Test Acc: 0.556
Validation loss decreased (-0.205531 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.4557747840881348
Epoch: 3, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.494 Vali Acc: 0.622 Test Loss: 1.494 Test Acc: 0.622
Validation loss decreased (-0.555537 --> -0.622207).  Saving model ...
Epoch: 4 cost time: 1.5445377826690674
Epoch: 4, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.245 Vali Acc: 0.656 Test Loss: 1.245 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.708704948425293
Epoch: 5, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.104 Vali Acc: 0.694 Test Loss: 1.104 Test Acc: 0.694
Validation loss decreased (-0.655543 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.5378308296203613
Epoch: 6, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.985 Vali Acc: 0.706 Test Loss: 0.985 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 1.6330311298370361
Epoch: 7, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.893 Vali Acc: 0.717 Test Loss: 0.893 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
Epoch: 8 cost time: 1.650909185409546
Epoch: 8, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.861 Vali Acc: 0.761 Test Loss: 0.861 Test Acc: 0.761
Validation loss decreased (-0.716658 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.6433980464935303
Epoch: 9, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.805 Vali Acc: 0.806 Test Loss: 0.805 Test Acc: 0.806
Validation loss decreased (-0.761103 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.6726994514465332
Epoch: 10, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8236262798309326
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6234242916107178
Epoch: 12, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 1.7007362842559814
Epoch: 13, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.7101540565490723
Epoch: 14, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6681182384490967
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 1.6505093574523926
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9307138919830322
Epoch: 17, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7700703144073486
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6897907257080078
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.6616690158843994
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5818862915039062
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6075904369354248
Epoch: 22, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.7371160984039307
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5823938846588135
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6332099437713623
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6581475734710693
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8438246250152588
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5454819202423096
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.653 Vali Acc: 0.878 Test Loss: 0.653 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9424293041229248
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6291849613189697
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6728591918945312
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.547062635421753
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 221887
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6592323780059814
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.463 Vali Acc: 0.178 Test Loss: 2.463 Test Acc: 0.178
Validation loss decreased (inf --> -0.177753).  Saving model ...
Epoch: 2 cost time: 1.6200616359710693
Epoch: 2, Steps: 12 | Train Loss: 2.202 Vali Loss: 1.891 Vali Acc: 0.444 Test Loss: 1.891 Test Acc: 0.444
Validation loss decreased (-0.177753 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 1.846228837966919
Epoch: 3, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.481 Vali Acc: 0.594 Test Loss: 1.481 Test Acc: 0.594
Validation loss decreased (-0.444426 --> -0.594430).  Saving model ...
Epoch: 4 cost time: 1.5950045585632324
Epoch: 4, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.274 Vali Acc: 0.672 Test Loss: 1.274 Test Acc: 0.672
Validation loss decreased (-0.594430 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.4591782093048096
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.082 Vali Acc: 0.711 Test Loss: 1.082 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 1.4435436725616455
Epoch: 6, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
Validation loss decreased (-0.711100 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 1.3772525787353516
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.913 Vali Acc: 0.756 Test Loss: 0.913 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.5441672801971436
Epoch: 8, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
Validation loss decreased (-0.755546 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 1.4947855472564697
Epoch: 9, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.780 Vali Acc: 0.811 Test Loss: 0.780 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.6777417659759521
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6442623138427734
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.479957103729248
Epoch: 12, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.704 Vali Acc: 0.811 Test Loss: 0.704 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 1.594379186630249
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
Validation loss decreased (-0.811104 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.5407264232635498
Epoch: 14, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6462578773498535
Epoch: 15, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 1.6767892837524414
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.58363938331604
Epoch: 17, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.6524972915649414
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6160807609558105
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7258000373840332
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5904035568237305
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7564113140106201
Epoch: 22, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.612 Vali Acc: 0.878 Test Loss: 0.612 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.7646427154541016
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.753819465637207
Epoch: 24, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7098596096038818
Epoch: 25, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7998619079589844
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.704 Vali Acc: 0.839 Test Loss: 0.704 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6690242290496826
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8613991737365723
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7766437530517578
Epoch: 29, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7003190517425537
Epoch: 30, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.674 Vali Acc: 0.856 Test Loss: 0.674 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.825507402420044
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6713817119598389
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.712 Vali Acc: 0.856 Test Loss: 0.712 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 189119
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5444302558898926
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.457 Vali Acc: 0.178 Test Loss: 2.457 Test Acc: 0.178
Validation loss decreased (inf --> -0.177753).  Saving model ...
Epoch: 2 cost time: 1.5585498809814453
Epoch: 2, Steps: 12 | Train Loss: 2.189 Vali Loss: 1.887 Vali Acc: 0.444 Test Loss: 1.887 Test Acc: 0.444
Validation loss decreased (-0.177753 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 1.5919122695922852
Epoch: 3, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.477 Vali Acc: 0.606 Test Loss: 1.477 Test Acc: 0.606
Validation loss decreased (-0.444426 --> -0.605541).  Saving model ...
Epoch: 4 cost time: 1.637115240097046
Epoch: 4, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.270 Vali Acc: 0.667 Test Loss: 1.270 Test Acc: 0.667
Validation loss decreased (-0.605541 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 1.7370636463165283
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.082 Vali Acc: 0.717 Test Loss: 1.082 Test Acc: 0.717
Validation loss decreased (-0.666654 --> -0.716656).  Saving model ...
Epoch: 6 cost time: 1.713829517364502
Epoch: 6, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.988 Vali Acc: 0.756 Test Loss: 0.988 Test Acc: 0.756
Validation loss decreased (-0.716656 --> -0.755546).  Saving model ...
Epoch: 7 cost time: 1.7082374095916748
Epoch: 7, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.906 Vali Acc: 0.744 Test Loss: 0.906 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5565333366394043
Epoch: 8, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.6108238697052002
Epoch: 9, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.6155447959899902
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.742 Vali Acc: 0.806 Test Loss: 0.742 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.6053085327148438
Epoch: 11, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.7090284824371338
Epoch: 12, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 1.8007564544677734
Epoch: 13, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
Validation loss decreased (-0.811104 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.593449354171753
Epoch: 14, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6230170726776123
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.6716487407684326
Epoch: 16, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4403696060180664
Epoch: 17, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 1.7119653224945068
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6363019943237305
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6675584316253662
Epoch: 20, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6955771446228027
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.749321460723877
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.6169872283935547
Epoch: 23, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4704701900482178
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6119439601898193
Epoch: 25, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8058435916900635
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.627697467803955
Epoch: 27, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6165387630462646
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.692 Vali Acc: 0.839 Test Loss: 0.692 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6103873252868652
Epoch: 29, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7220439910888672
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7484123706817627
Epoch: 31, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.672 Vali Acc: 0.883 Test Loss: 0.672 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 32 cost time: 1.5881497859954834
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5268995761871338
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.673 Vali Acc: 0.867 Test Loss: 0.673 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8572697639465332
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.702 Vali Acc: 0.861 Test Loss: 0.702 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8766307830810547
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.705 Vali Acc: 0.856 Test Loss: 0.705 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9262115955352783
Epoch: 36, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7293670177459717
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.780 Vali Acc: 0.844 Test Loss: 0.780 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.036898136138916
Epoch: 38, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9247591495513916
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8756418228149414
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.789 Vali Acc: 0.867 Test Loss: 0.789 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7362253665924072
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.856 Vali Acc: 0.856 Test Loss: 0.856 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 189119
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.214454650878906
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.455 Vali Acc: 0.206 Test Loss: 2.455 Test Acc: 0.206
Validation loss decreased (inf --> -0.205531).  Saving model ...
Epoch: 2 cost time: 1.9658632278442383
Epoch: 2, Steps: 12 | Train Loss: 2.171 Vali Loss: 1.883 Vali Acc: 0.439 Test Loss: 1.883 Test Acc: 0.439
Validation loss decreased (-0.205531 --> -0.438870).  Saving model ...
Epoch: 3 cost time: 2.022512435913086
Epoch: 3, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.473 Vali Acc: 0.606 Test Loss: 1.473 Test Acc: 0.606
Validation loss decreased (-0.438870 --> -0.605541).  Saving model ...
Epoch: 4 cost time: 2.000079870223999
Epoch: 4, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.275 Vali Acc: 0.683 Test Loss: 1.275 Test Acc: 0.683
Validation loss decreased (-0.605541 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.8464429378509521
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.090 Vali Acc: 0.711 Test Loss: 1.090 Test Acc: 0.711
Validation loss decreased (-0.683321 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 1.5737347602844238
Epoch: 6, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.991 Vali Acc: 0.744 Test Loss: 0.991 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.7627787590026855
Epoch: 7, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 1.6479973793029785
Epoch: 8, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.824 Vali Acc: 0.778 Test Loss: 0.824 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.5265123844146729
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.784 Vali Acc: 0.811 Test Loss: 0.784 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.8113336563110352
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6326165199279785
Epoch: 11, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.738 Vali Acc: 0.817 Test Loss: 0.738 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 1.5750138759613037
Epoch: 12, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7349891662597656
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
Validation loss decreased (-0.816659 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.6162216663360596
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.692155361175537
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 1.6916019916534424
Epoch: 16, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9757752418518066
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9378533363342285
Epoch: 18, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 1.8113939762115479
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 20 cost time: 1.8008182048797607
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7379448413848877
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7600529193878174
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.78663969039917
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6861090660095215
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8148829936981201
Epoch: 25, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.819368839263916
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.635298252105713
Epoch: 27, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6481618881225586
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6160976886749268
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 189119
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7236390113830566
Epoch: 1, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.472 Vali Acc: 0.178 Test Loss: 2.472 Test Acc: 0.178
Validation loss decreased (inf --> -0.177753).  Saving model ...
Epoch: 2 cost time: 1.5235493183135986
Epoch: 2, Steps: 12 | Train Loss: 2.173 Vali Loss: 1.896 Vali Acc: 0.461 Test Loss: 1.896 Test Acc: 0.461
Validation loss decreased (-0.177753 --> -0.461092).  Saving model ...
Epoch: 3 cost time: 1.5202722549438477
Epoch: 3, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.479 Vali Acc: 0.628 Test Loss: 1.479 Test Acc: 0.628
Validation loss decreased (-0.461092 --> -0.627763).  Saving model ...
Epoch: 4 cost time: 1.6582958698272705
Epoch: 4, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.274 Vali Acc: 0.672 Test Loss: 1.274 Test Acc: 0.672
Validation loss decreased (-0.627763 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.4576375484466553
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.096 Vali Acc: 0.678 Test Loss: 1.096 Test Acc: 0.678
Validation loss decreased (-0.672209 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.5706462860107422
Epoch: 6, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 1.6603355407714844
Epoch: 7, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 1.5580670833587646
Epoch: 8, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.6925475597381592
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.782 Vali Acc: 0.817 Test Loss: 0.782 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.5280327796936035
Epoch: 10, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6748056411743164
Epoch: 11, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5787379741668701
Epoch: 12, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8096439838409424
Epoch: 13, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.623 Vali Acc: 0.817 Test Loss: 0.623 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 14 cost time: 1.5750651359558105
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.5030224323272705
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.5480377674102783
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.4602031707763672
Epoch: 17, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.5892736911773682
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.556833028793335
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.781301736831665
Epoch: 20, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8874127864837646
Epoch: 21, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.67386794090271
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.642284870147705
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.534853458404541
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.5804169178009033
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.702709436416626
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5903327465057373
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.773378610610962
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.643 Vali Acc: 0.867 Test Loss: 0.643 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7838990688323975
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7249383926391602
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5501141548156738
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.655 Vali Acc: 0.867 Test Loss: 0.655 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8486523628234863
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7696661949157715
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7333924770355225
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 189119
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.241353750228882
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.696 Vali Acc: 0.100 Test Loss: 2.696 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.8891124725341797
Epoch: 2, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.286 Vali Acc: 0.328 Test Loss: 2.286 Test Acc: 0.328
Validation loss decreased (-0.099973 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 1.4224674701690674
Epoch: 3, Steps: 12 | Train Loss: 2.108 Vali Loss: 1.894 Vali Acc: 0.472 Test Loss: 1.894 Test Acc: 0.472
Validation loss decreased (-0.327755 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 1.4672050476074219
Epoch: 4, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.603 Vali Acc: 0.561 Test Loss: 1.603 Test Acc: 0.561
Validation loss decreased (-0.472203 --> -0.561095).  Saving model ...
Epoch: 5 cost time: 1.4851067066192627
Epoch: 5, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.392 Vali Acc: 0.661 Test Loss: 1.392 Test Acc: 0.661
Validation loss decreased (-0.561095 --> -0.661097).  Saving model ...
Epoch: 6 cost time: 1.1978371143341064
Epoch: 6, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.264 Vali Acc: 0.678 Test Loss: 1.264 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 1.7822291851043701
Epoch: 7, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.127 Vali Acc: 0.694 Test Loss: 1.127 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694433).  Saving model ...
Epoch: 8 cost time: 1.3770062923431396
Epoch: 8, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.043 Vali Acc: 0.733 Test Loss: 1.043 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.5978326797485352
Epoch: 9, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.7047324180603027
Epoch: 10, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.913 Vali Acc: 0.783 Test Loss: 0.913 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783324).  Saving model ...
Epoch: 11 cost time: 1.4563279151916504
Epoch: 11, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.840 Vali Acc: 0.794 Test Loss: 0.840 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.7257354259490967
Epoch: 12, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.792 Vali Acc: 0.811 Test Loss: 0.792 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.460906744003296
Epoch: 13, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.773 Vali Acc: 0.811 Test Loss: 0.773 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 14 cost time: 1.6484405994415283
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.5030231475830078
Epoch: 15, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.2832810878753662
Epoch: 16, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.4744188785552979
Epoch: 17, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.3558096885681152
Epoch: 18, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2346832752227783
Epoch: 19, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.374870777130127
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 21 cost time: 1.448404312133789
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5531349182128906
Epoch: 22, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2943744659423828
Epoch: 23, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.8779253959655762
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.839339256286621
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6345903873443604
Epoch: 26, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5302910804748535
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7959370613098145
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.586 Vali Acc: 0.883 Test Loss: 0.586 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 29 cost time: 1.6785976886749268
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.802119493484497
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6703507900238037
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8866233825683594
Epoch: 32, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.768143653869629
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6057624816894531
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5882906913757324
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.89473295211792
Epoch: 36, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.612870693206787
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.5123894214630127
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 586111
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8515701293945312
Epoch: 1, Steps: 12 | Train Loss: 2.852 Vali Loss: 2.689 Vali Acc: 0.100 Test Loss: 2.689 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.5531985759735107
Epoch: 2, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.278 Vali Acc: 0.333 Test Loss: 2.278 Test Acc: 0.333
Validation loss decreased (-0.099973 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 1.9778141975402832
Epoch: 3, Steps: 12 | Train Loss: 2.118 Vali Loss: 1.888 Vali Acc: 0.439 Test Loss: 1.888 Test Acc: 0.439
Validation loss decreased (-0.333311 --> -0.438870).  Saving model ...
Epoch: 4 cost time: 1.8531007766723633
Epoch: 4, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.597 Vali Acc: 0.567 Test Loss: 1.597 Test Acc: 0.567
Validation loss decreased (-0.438870 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 1.5681631565093994
Epoch: 5, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.384 Vali Acc: 0.672 Test Loss: 1.384 Test Acc: 0.672
Validation loss decreased (-0.566651 --> -0.672208).  Saving model ...
Epoch: 6 cost time: 1.7315044403076172
Epoch: 6, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.255 Vali Acc: 0.672 Test Loss: 1.255 Test Acc: 0.672
Validation loss decreased (-0.672208 --> -0.672210).  Saving model ...
Epoch: 7 cost time: 1.440871000289917
Epoch: 7, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.121 Vali Acc: 0.694 Test Loss: 1.121 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694433).  Saving model ...
Epoch: 8 cost time: 1.594709873199463
Epoch: 8, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.040 Vali Acc: 0.733 Test Loss: 1.040 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.540797472000122
Epoch: 9, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.8093221187591553
Epoch: 10, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783324).  Saving model ...
Epoch: 11 cost time: 1.7163166999816895
Epoch: 11, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.836 Vali Acc: 0.794 Test Loss: 0.836 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.4160680770874023
Epoch: 12, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.792 Vali Acc: 0.806 Test Loss: 0.792 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.3421893119812012
Epoch: 13, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 1.5474333763122559
Epoch: 14, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.4744727611541748
Epoch: 15, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7020237445831299
Epoch: 16, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.696 Vali Acc: 0.828 Test Loss: 0.696 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.6422302722930908
Epoch: 17, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.4283640384674072
Epoch: 18, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.657801866531372
Epoch: 19, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4706239700317383
Epoch: 20, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.4699649810791016
Epoch: 21, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4777815341949463
Epoch: 22, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4295365810394287
Epoch: 23, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.422722578048706
Epoch: 24, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5721807479858398
Epoch: 25, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.650160789489746
Epoch: 26, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3772497177124023
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.48848557472229
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.4435369968414307
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.667264699935913
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3924360275268555
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.706498384475708
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.626 Vali Acc: 0.856 Test Loss: 0.626 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.543626070022583
Epoch: 33, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5379149913787842
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 35 cost time: 1.5597691535949707
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.621840238571167
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5570673942565918
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6688141822814941
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.537839651107788
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.510096549987793
Epoch: 40, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6909775733947754
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.294487714767456
Epoch: 42, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.323584794998169
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4710893630981445
Epoch: 44, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 586111
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.893690586090088
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.690 Vali Acc: 0.094 Test Loss: 2.690 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.5286424160003662
Epoch: 2, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.282 Vali Acc: 0.278 Test Loss: 2.282 Test Acc: 0.278
Validation loss decreased (-0.094418 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 1.3819098472595215
Epoch: 3, Steps: 12 | Train Loss: 2.117 Vali Loss: 1.892 Vali Acc: 0.472 Test Loss: 1.892 Test Acc: 0.472
Validation loss decreased (-0.277755 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 1.5344247817993164
Epoch: 4, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.600 Vali Acc: 0.583 Test Loss: 1.600 Test Acc: 0.583
Validation loss decreased (-0.472203 --> -0.583317).  Saving model ...
Epoch: 5 cost time: 1.4626710414886475
Epoch: 5, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.384 Vali Acc: 0.656 Test Loss: 1.384 Test Acc: 0.656
Validation loss decreased (-0.583317 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 1.6233446598052979
Epoch: 6, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.258 Vali Acc: 0.672 Test Loss: 1.258 Test Acc: 0.672
Validation loss decreased (-0.655542 --> -0.672210).  Saving model ...
Epoch: 7 cost time: 1.545851469039917
Epoch: 7, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.121 Vali Acc: 0.717 Test Loss: 1.121 Test Acc: 0.717
Validation loss decreased (-0.672210 --> -0.716655).  Saving model ...
Epoch: 8 cost time: 1.4042434692382812
Epoch: 8, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.038 Vali Acc: 0.722 Test Loss: 1.038 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 1.3851900100708008
Epoch: 9, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.955 Vali Acc: 0.761 Test Loss: 0.955 Test Acc: 0.761
Validation loss decreased (-0.722212 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.4329650402069092
Epoch: 10, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.899 Vali Acc: 0.778 Test Loss: 0.899 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.3685157299041748
Epoch: 11, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 12 cost time: 1.3777287006378174
Epoch: 12, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.779 Vali Acc: 0.811 Test Loss: 0.779 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.3715994358062744
Epoch: 13, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2787456512451172
Epoch: 14, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.2462794780731201
Epoch: 15, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.3250923156738281
Epoch: 16, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 1.369138240814209
Epoch: 17, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.5382773876190186
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 1.5958456993103027
Epoch: 19, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3826727867126465
Epoch: 20, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 1.4682857990264893
Epoch: 21, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6418473720550537
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.5717449188232422
Epoch: 23, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 24 cost time: 1.6365697383880615
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.544 Vali Acc: 0.883 Test Loss: 0.544 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 25 cost time: 1.3709487915039062
Epoch: 25, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.532 Vali Acc: 0.878 Test Loss: 0.532 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.546339750289917
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3350350856781006
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.570387363433838
Epoch: 28, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5423007011413574
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 30 cost time: 1.338301658630371
Epoch: 30, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.411644697189331
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 1.6453120708465576
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3599212169647217
Epoch: 33, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4954187870025635
Epoch: 34, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.455303430557251
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.543 Vali Acc: 0.883 Test Loss: 0.543 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5568177700042725
Epoch: 36, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6207990646362305
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.566277027130127
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4076719284057617
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2999484539031982
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.279453992843628
Epoch: 41, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.659 Vali Acc: 0.872 Test Loss: 0.659 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 586111
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3167099952697754
Epoch: 1, Steps: 12 | Train Loss: 2.848 Vali Loss: 2.668 Vali Acc: 0.083 Test Loss: 2.668 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.5929992198944092
Epoch: 2, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.266 Vali Acc: 0.261 Test Loss: 2.266 Test Acc: 0.261
Validation loss decreased (-0.083307 --> -0.261088).  Saving model ...
Epoch: 3 cost time: 1.5759303569793701
Epoch: 3, Steps: 12 | Train Loss: 2.072 Vali Loss: 1.878 Vali Acc: 0.428 Test Loss: 1.878 Test Acc: 0.428
Validation loss decreased (-0.261088 --> -0.427759).  Saving model ...
Epoch: 4 cost time: 1.3965497016906738
Epoch: 4, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.583 Vali Acc: 0.567 Test Loss: 1.583 Test Acc: 0.567
Validation loss decreased (-0.427759 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 1.2524213790893555
Epoch: 5, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.365 Vali Acc: 0.683 Test Loss: 1.365 Test Acc: 0.683
Validation loss decreased (-0.566651 --> -0.683320).  Saving model ...
Epoch: 6 cost time: 1.215055227279663
Epoch: 6, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.232 Vali Acc: 0.678 Test Loss: 1.232 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5222852230072021
Epoch: 7, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.683320 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.3832690715789795
Epoch: 8, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.017 Vali Acc: 0.711 Test Loss: 1.017 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 1.3600802421569824
Epoch: 9, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.917 Vali Acc: 0.728 Test Loss: 0.917 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 1.311866283416748
Epoch: 10, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
Validation loss decreased (-0.727769 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.4323327541351318
Epoch: 11, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.774 Vali Acc: 0.778 Test Loss: 0.774 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 12 cost time: 1.3484392166137695
Epoch: 12, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.737 Vali Acc: 0.806 Test Loss: 0.737 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.5122556686401367
Epoch: 13, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 1.3165929317474365
Epoch: 14, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.3659274578094482
Epoch: 15, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.7751672267913818
Epoch: 16, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.183976173400879
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.3627760410308838
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 1.4251823425292969
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.6173808574676514
Epoch: 20, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.3878483772277832
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2066304683685303
Epoch: 22, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.4239068031311035
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.5011351108551025
Epoch: 24, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2391901016235352
Epoch: 25, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.380746841430664
Epoch: 26, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2918100357055664
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.635246992111206
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3689157962799072
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.452026605606079
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 1.3034462928771973
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.166654348373413
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3581578731536865
Epoch: 33, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2852845191955566
Epoch: 34, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2740111351013184
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4129037857055664
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3765828609466553
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4294142723083496
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2683594226837158
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2462010383605957
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4667847156524658
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883327).  Saving model ...
Epoch: 42 cost time: 1.2469024658203125
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4725899696350098
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3454699516296387
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.402189016342163
Epoch: 45, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3407495021820068
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4849131107330322
Epoch: 47, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.4115417003631592
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4993157386779785
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3124756813049316
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.5253589153289795
Epoch: 51, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 586111
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4885404109954834
Epoch: 1, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.453 Vali Acc: 0.256 Test Loss: 2.453 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 1.3224120140075684
Epoch: 2, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.097 Vali Acc: 0.472 Test Loss: 2.097 Test Acc: 0.472
Validation loss decreased (-0.255531 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 1.250326156616211
Epoch: 3, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.765 Vali Acc: 0.522 Test Loss: 1.765 Test Acc: 0.522
Validation loss decreased (-0.472201 --> -0.522205).  Saving model ...
Epoch: 4 cost time: 1.2750535011291504
Epoch: 4, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.510 Vali Acc: 0.639 Test Loss: 1.510 Test Acc: 0.639
Validation loss decreased (-0.522205 --> -0.638874).  Saving model ...
Epoch: 5 cost time: 1.5460288524627686
Epoch: 5, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.345 Vali Acc: 0.672 Test Loss: 1.345 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672209).  Saving model ...
Epoch: 6 cost time: 1.2754130363464355
Epoch: 6, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.172 Vali Acc: 0.722 Test Loss: 1.172 Test Acc: 0.722
Validation loss decreased (-0.672209 --> -0.722211).  Saving model ...
Epoch: 7 cost time: 1.7552108764648438
Epoch: 7, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.078 Vali Acc: 0.756 Test Loss: 1.078 Test Acc: 0.756
Validation loss decreased (-0.722211 --> -0.755545).  Saving model ...
Epoch: 8 cost time: 1.2264366149902344
Epoch: 8, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.014 Vali Acc: 0.744 Test Loss: 1.014 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.719998836517334
Epoch: 9, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.529129981994629
Epoch: 10, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.863 Vali Acc: 0.789 Test Loss: 0.863 Test Acc: 0.789
Validation loss decreased (-0.755545 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 1.6375985145568848
Epoch: 11, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.826 Vali Acc: 0.817 Test Loss: 0.826 Test Acc: 0.817
Validation loss decreased (-0.788880 --> -0.816658).  Saving model ...
Epoch: 12 cost time: 1.6295976638793945
Epoch: 12, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.770 Vali Acc: 0.817 Test Loss: 0.770 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.8315720558166504
Epoch: 13, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.732 Vali Acc: 0.817 Test Loss: 0.732 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.5711898803710938
Epoch: 14, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4416003227233887
Epoch: 15, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.702 Vali Acc: 0.811 Test Loss: 0.702 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3905482292175293
Epoch: 16, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.4331543445587158
Epoch: 17, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 1.3444292545318604
Epoch: 18, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.2294244766235352
Epoch: 19, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3464746475219727
Epoch: 20, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 1.3454418182373047
Epoch: 21, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.623 Vali Acc: 0.872 Test Loss: 0.623 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4621915817260742
Epoch: 22, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.53529953956604
Epoch: 23, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.492323875427246
Epoch: 24, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5004003047943115
Epoch: 25, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6541852951049805
Epoch: 26, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9058175086975098
Epoch: 27, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.8566105365753174
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8700637817382812
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.7535407543182373
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.57962965965271
Epoch: 31, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0069468021392822
Epoch: 32, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7540712356567383
Epoch: 33, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8382554054260254
Epoch: 34, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8881535530090332
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4655051231384277
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6680395603179932
Epoch: 37, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.626 Vali Acc: 0.872 Test Loss: 0.626 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6280155181884766
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9999451637268066
Epoch: 39, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.603 Vali Acc: 0.883 Test Loss: 0.603 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 40 cost time: 1.7841534614562988
Epoch: 40, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9437541961669922
Epoch: 41, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.640 Vali Acc: 0.861 Test Loss: 0.640 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8316426277160645
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6600401401519775
Epoch: 43, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0157012939453125
Epoch: 44, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.724574089050293
Epoch: 45, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.746448278427124
Epoch: 46, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6920855045318604
Epoch: 47, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.5495226383209229
Epoch: 48, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.7764689922332764
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.680 Vali Acc: 0.878 Test Loss: 0.680 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 323967
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3869292736053467
Epoch: 1, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.447 Vali Acc: 0.289 Test Loss: 2.447 Test Acc: 0.289
Validation loss decreased (inf --> -0.288864).  Saving model ...
Epoch: 2 cost time: 1.6103487014770508
Epoch: 2, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.093 Vali Acc: 0.467 Test Loss: 2.093 Test Acc: 0.467
Validation loss decreased (-0.288864 --> -0.466646).  Saving model ...
Epoch: 3 cost time: 1.7545888423919678
Epoch: 3, Steps: 12 | Train Loss: 2.008 Vali Loss: 1.758 Vali Acc: 0.500 Test Loss: 1.758 Test Acc: 0.500
Validation loss decreased (-0.466646 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.5564556121826172
Epoch: 4, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.503 Vali Acc: 0.622 Test Loss: 1.503 Test Acc: 0.622
Validation loss decreased (-0.499982 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.5210893154144287
Epoch: 5, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.340 Vali Acc: 0.678 Test Loss: 1.340 Test Acc: 0.678
Validation loss decreased (-0.622207 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 1.6543362140655518
Epoch: 6, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.168 Vali Acc: 0.711 Test Loss: 1.168 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.5520353317260742
Epoch: 7, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.076 Vali Acc: 0.750 Test Loss: 1.076 Test Acc: 0.750
Validation loss decreased (-0.711099 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 1.5476160049438477
Epoch: 8, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.6008999347686768
Epoch: 9, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.937 Vali Acc: 0.761 Test Loss: 0.937 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.7923908233642578
Epoch: 10, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.857 Vali Acc: 0.783 Test Loss: 0.857 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 1.7150137424468994
Epoch: 11, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.818 Vali Acc: 0.817 Test Loss: 0.818 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816658).  Saving model ...
Epoch: 12 cost time: 1.6068041324615479
Epoch: 12, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.767 Vali Acc: 0.817 Test Loss: 0.767 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.455583095550537
Epoch: 13, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 1.4687213897705078
Epoch: 14, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.457984447479248
Epoch: 15, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.581352949142456
Epoch: 16, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 1.50162672996521
Epoch: 17, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 1.6219110488891602
Epoch: 18, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.6312236785888672
Epoch: 19, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.84244966506958
Epoch: 20, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.7041904926300049
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7059094905853271
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6765594482421875
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.6092653274536133
Epoch: 24, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7973122596740723
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.702512264251709
Epoch: 26, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5752906799316406
Epoch: 27, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.595 Vali Acc: 0.878 Test Loss: 0.595 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.3728506565093994
Epoch: 28, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.521594762802124
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5959882736206055
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.5657343864440918
Epoch: 31, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7939529418945312
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4836053848266602
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5714685916900635
Epoch: 34, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 35 cost time: 1.4867265224456787
Epoch: 35, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2936718463897705
Epoch: 36, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.470418930053711
Epoch: 37, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.452202320098877
Epoch: 38, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3384130001068115
Epoch: 39, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.612 Vali Acc: 0.878 Test Loss: 0.612 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4933500289916992
Epoch: 40, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5297746658325195
Epoch: 41, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.646 Vali Acc: 0.878 Test Loss: 0.646 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.4211254119873047
Epoch: 42, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.683 Vali Acc: 0.861 Test Loss: 0.683 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2634499073028564
Epoch: 43, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3113269805908203
Epoch: 44, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 323967
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7880537509918213
Epoch: 1, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.457 Vali Acc: 0.267 Test Loss: 2.457 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 1.5672681331634521
Epoch: 2, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.102 Vali Acc: 0.461 Test Loss: 2.102 Test Acc: 0.461
Validation loss decreased (-0.266642 --> -0.461090).  Saving model ...
Epoch: 3 cost time: 1.3994941711425781
Epoch: 3, Steps: 12 | Train Loss: 1.989 Vali Loss: 1.765 Vali Acc: 0.517 Test Loss: 1.765 Test Acc: 0.517
Validation loss decreased (-0.461090 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 1.6462078094482422
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.512 Vali Acc: 0.600 Test Loss: 1.512 Test Acc: 0.600
Validation loss decreased (-0.516649 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 1.4294698238372803
Epoch: 5, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.346 Vali Acc: 0.661 Test Loss: 1.346 Test Acc: 0.661
Validation loss decreased (-0.599985 --> -0.661098).  Saving model ...
Epoch: 6 cost time: 1.3834564685821533
Epoch: 6, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.168 Vali Acc: 0.717 Test Loss: 1.168 Test Acc: 0.717
Validation loss decreased (-0.661098 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 1.52439546585083
Epoch: 7, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.073 Vali Acc: 0.733 Test Loss: 1.073 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 1.7289299964904785
Epoch: 8, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.3475348949432373
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.3582141399383545
Epoch: 10, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.862 Vali Acc: 0.767 Test Loss: 0.862 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.2855629920959473
Epoch: 11, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.3454904556274414
Epoch: 12, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.770 Vali Acc: 0.806 Test Loss: 0.770 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.1370725631713867
Epoch: 13, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 1.4530115127563477
Epoch: 14, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.707 Vali Acc: 0.817 Test Loss: 0.707 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.5567188262939453
Epoch: 15, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.709 Vali Acc: 0.817 Test Loss: 0.709 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3803863525390625
Epoch: 16, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.4486465454101562
Epoch: 17, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.5556809902191162
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.5180158615112305
Epoch: 19, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6550145149230957
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.5545034408569336
Epoch: 21, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4472777843475342
Epoch: 22, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5270674228668213
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4021251201629639
Epoch: 24, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 1.374840497970581
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3902359008789062
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 1.636772632598877
Epoch: 27, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.4272336959838867
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 29 cost time: 1.3951818943023682
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.357743501663208
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4810614585876465
Epoch: 31, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5223267078399658
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.443514108657837
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2484889030456543
Epoch: 34, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3703439235687256
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3406877517700195
Epoch: 36, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.595 Vali Acc: 0.878 Test Loss: 0.595 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3839387893676758
Epoch: 37, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.559178352355957
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3782544136047363
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 323967
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.105093240737915
Epoch: 1, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.428 Vali Acc: 0.361 Test Loss: 2.428 Test Acc: 0.361
Validation loss decreased (inf --> -0.361087).  Saving model ...
Epoch: 2 cost time: 1.0921180248260498
Epoch: 2, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
Validation loss decreased (-0.361087 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 1.7036235332489014
Epoch: 3, Steps: 12 | Train Loss: 1.979 Vali Loss: 1.743 Vali Acc: 0.572 Test Loss: 1.743 Test Acc: 0.572
Validation loss decreased (-0.499979 --> -0.572205).  Saving model ...
Epoch: 4 cost time: 1.4251246452331543
Epoch: 4, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.490 Vali Acc: 0.622 Test Loss: 1.490 Test Acc: 0.622
Validation loss decreased (-0.572205 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.5501091480255127
Epoch: 5, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.331 Vali Acc: 0.683 Test Loss: 1.331 Test Acc: 0.683
Validation loss decreased (-0.622207 --> -0.683320).  Saving model ...
Epoch: 6 cost time: 1.4235901832580566
Epoch: 6, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.161 Vali Acc: 0.717 Test Loss: 1.161 Test Acc: 0.717
Validation loss decreased (-0.683320 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 1.6085045337677002
Epoch: 7, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.065 Vali Acc: 0.733 Test Loss: 1.065 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 1.5420711040496826
Epoch: 8, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.5414938926696777
Epoch: 9, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.917 Vali Acc: 0.772 Test Loss: 0.917 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 10 cost time: 1.272301435470581
Epoch: 10, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.843 Vali Acc: 0.778 Test Loss: 0.843 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.570500373840332
Epoch: 11, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.6151056289672852
Epoch: 12, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827770).  Saving model ...
Epoch: 13 cost time: 1.3582749366760254
Epoch: 13, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.689 Vali Acc: 0.817 Test Loss: 0.689 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.440518856048584
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.2614037990570068
Epoch: 15, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4325785636901855
Epoch: 16, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.4525408744812012
Epoch: 17, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.367602825164795
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.3301975727081299
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.359492301940918
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.320509910583496
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4479362964630127
Epoch: 22, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.5145695209503174
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 1.5437994003295898
Epoch: 24, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2289984226226807
Epoch: 25, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.503687858581543
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4522583484649658
Epoch: 27, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.4258198738098145
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 1.6446456909179688
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5112736225128174
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.259547472000122
Epoch: 31, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5670030117034912
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7442824840545654
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.454718828201294
Epoch: 34, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3921303749084473
Epoch: 35, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4423565864562988
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5062580108642578
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.4719619750976562
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 323967
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8068478107452393
Epoch: 1, Steps: 12 | Train Loss: 2.916 Vali Loss: 2.675 Vali Acc: 0.150 Test Loss: 2.675 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.5806360244750977
Epoch: 2, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.243 Vali Acc: 0.394 Test Loss: 2.243 Test Acc: 0.394
Validation loss decreased (-0.149973 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 1.2826485633850098
Epoch: 3, Steps: 12 | Train Loss: 2.024 Vali Loss: 1.834 Vali Acc: 0.611 Test Loss: 1.834 Test Acc: 0.611
Validation loss decreased (-0.394422 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 1.4404680728912354
Epoch: 4, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.532 Vali Acc: 0.694 Test Loss: 1.532 Test Acc: 0.694
Validation loss decreased (-0.611093 --> -0.694429).  Saving model ...
Epoch: 5 cost time: 1.5366506576538086
Epoch: 5, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.326 Vali Acc: 0.728 Test Loss: 1.326 Test Acc: 0.728
Validation loss decreased (-0.694429 --> -0.727765).  Saving model ...
Epoch: 6 cost time: 1.4668986797332764
Epoch: 6, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.198 Vali Acc: 0.744 Test Loss: 1.198 Test Acc: 0.744
Validation loss decreased (-0.727765 --> -0.744432).  Saving model ...
Epoch: 7 cost time: 1.5999491214752197
Epoch: 7, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.100 Vali Acc: 0.728 Test Loss: 1.100 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5704741477966309
Epoch: 8, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
Validation loss decreased (-0.744432 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.471459150314331
Epoch: 9, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.949 Vali Acc: 0.756 Test Loss: 0.949 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.5793921947479248
Epoch: 10, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.914 Vali Acc: 0.761 Test Loss: 0.914 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 1.5063867568969727
Epoch: 11, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.832 Vali Acc: 0.789 Test Loss: 0.832 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.7582921981811523
Epoch: 12, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.782 Vali Acc: 0.811 Test Loss: 0.782 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.6162827014923096
Epoch: 13, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.753 Vali Acc: 0.817 Test Loss: 0.753 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.4730334281921387
Epoch: 14, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.588944673538208
Epoch: 15, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 1.500398874282837
Epoch: 16, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.872100591659546
Epoch: 17, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.565948486328125
Epoch: 18, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6581578254699707
Epoch: 19, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.673750400543213
Epoch: 20, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4298572540283203
Epoch: 21, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6085667610168457
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6044933795928955
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.482590913772583
Epoch: 24, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4275171756744385
Epoch: 25, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5302343368530273
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4215950965881348
Epoch: 27, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5408177375793457
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.349440336227417
Epoch: 29, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 30 cost time: 1.5918960571289062
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8817458152770996
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.593 Vali Acc: 0.883 Test Loss: 0.593 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883327).  Saving model ...
Epoch: 32 cost time: 1.5746920108795166
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9183619022369385
Epoch: 33, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.678253412246704
Epoch: 34, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.65189790725708
Epoch: 35, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5256626605987549
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.387913703918457
Epoch: 37, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5605509281158447
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7024714946746826
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5840096473693848
Epoch: 40, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6645259857177734
Epoch: 41, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 192895
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.991260051727295
Epoch: 1, Steps: 12 | Train Loss: 2.914 Vali Loss: 2.699 Vali Acc: 0.106 Test Loss: 2.699 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.602388858795166
Epoch: 2, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.264 Vali Acc: 0.406 Test Loss: 2.264 Test Acc: 0.406
Validation loss decreased (-0.105529 --> -0.405533).  Saving model ...
Epoch: 3 cost time: 1.611154317855835
Epoch: 3, Steps: 12 | Train Loss: 2.038 Vali Loss: 1.851 Vali Acc: 0.544 Test Loss: 1.851 Test Acc: 0.544
Validation loss decreased (-0.405533 --> -0.544426).  Saving model ...
Epoch: 4 cost time: 1.6262869834899902
Epoch: 4, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.546 Vali Acc: 0.678 Test Loss: 1.546 Test Acc: 0.678
Validation loss decreased (-0.544426 --> -0.677762).  Saving model ...
Epoch: 5 cost time: 1.7166171073913574
Epoch: 5, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.339 Vali Acc: 0.722 Test Loss: 1.339 Test Acc: 0.722
Validation loss decreased (-0.677762 --> -0.722209).  Saving model ...
Epoch: 6 cost time: 1.4465839862823486
Epoch: 6, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.211 Vali Acc: 0.750 Test Loss: 1.211 Test Acc: 0.750
Validation loss decreased (-0.722209 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 1.3533124923706055
Epoch: 7, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.110 Vali Acc: 0.733 Test Loss: 1.110 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.575117826461792
Epoch: 8, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
Validation loss decreased (-0.749988 --> -0.761101).  Saving model ...
Epoch: 9 cost time: 1.419713020324707
Epoch: 9, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.951 Vali Acc: 0.761 Test Loss: 0.951 Test Acc: 0.761
Validation loss decreased (-0.761101 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.6445858478546143
Epoch: 10, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.920 Vali Acc: 0.756 Test Loss: 0.920 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5171964168548584
Epoch: 11, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.843 Vali Acc: 0.794 Test Loss: 0.843 Test Acc: 0.794
Validation loss decreased (-0.761102 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.4441587924957275
Epoch: 12, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.795 Vali Acc: 0.811 Test Loss: 0.795 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.4771554470062256
Epoch: 13, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5841188430786133
Epoch: 14, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.5387589931488037
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 1.534127950668335
Epoch: 16, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7004098892211914
Epoch: 17, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.7677156925201416
Epoch: 18, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.528228998184204
Epoch: 19, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 1.5844299793243408
Epoch: 20, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3657424449920654
Epoch: 21, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.5140652656555176
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4061493873596191
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.6604762077331543
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.796929121017456
Epoch: 25, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 1.4712393283843994
Epoch: 26, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.629 Vali Acc: 0.872 Test Loss: 0.629 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.48689603805542
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5276813507080078
Epoch: 28, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.428621768951416
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.411242961883545
Epoch: 30, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.5723519325256348
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4834952354431152
Epoch: 32, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.496729850769043
Epoch: 33, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5805964469909668
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5664734840393066
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7246527671813965
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6338820457458496
Epoch: 37, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.690544843673706
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.448523759841919
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.590078353881836
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 192895
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9954659938812256
Epoch: 1, Steps: 12 | Train Loss: 2.901 Vali Loss: 2.671 Vali Acc: 0.100 Test Loss: 2.671 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.6229193210601807
Epoch: 2, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.238 Vali Acc: 0.433 Test Loss: 2.238 Test Acc: 0.433
Validation loss decreased (-0.099973 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 1.513822317123413
Epoch: 3, Steps: 12 | Train Loss: 2.047 Vali Loss: 1.826 Vali Acc: 0.583 Test Loss: 1.826 Test Acc: 0.583
Validation loss decreased (-0.433311 --> -0.583315).  Saving model ...
Epoch: 4 cost time: 1.3412911891937256
Epoch: 4, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.524 Vali Acc: 0.689 Test Loss: 1.524 Test Acc: 0.689
Validation loss decreased (-0.583315 --> -0.688874).  Saving model ...
Epoch: 5 cost time: 1.4493577480316162
Epoch: 5, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.317 Vali Acc: 0.739 Test Loss: 1.317 Test Acc: 0.739
Validation loss decreased (-0.688874 --> -0.738876).  Saving model ...
Epoch: 6 cost time: 1.442410945892334
Epoch: 6, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.184 Vali Acc: 0.750 Test Loss: 1.184 Test Acc: 0.750
Validation loss decreased (-0.738876 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 1.5827202796936035
Epoch: 7, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.086 Vali Acc: 0.750 Test Loss: 1.086 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 1.308527946472168
Epoch: 8, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761101).  Saving model ...
Epoch: 9 cost time: 1.23976469039917
Epoch: 9, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.935 Vali Acc: 0.767 Test Loss: 0.935 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.3368737697601318
Epoch: 10, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.897 Vali Acc: 0.767 Test Loss: 0.897 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.221585750579834
Epoch: 11, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.821 Vali Acc: 0.789 Test Loss: 0.821 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.2610509395599365
Epoch: 12, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.785 Vali Acc: 0.811 Test Loss: 0.785 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.3764050006866455
Epoch: 13, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.749 Vali Acc: 0.817 Test Loss: 0.749 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.2964303493499756
Epoch: 14, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.392988681793213
Epoch: 15, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.4075467586517334
Epoch: 16, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3800501823425293
Epoch: 17, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.5306940078735352
Epoch: 18, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2839221954345703
Epoch: 19, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.4335854053497314
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4681169986724854
Epoch: 21, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.5688836574554443
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6251509189605713
Epoch: 23, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.3970060348510742
Epoch: 24, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3259551525115967
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.34218168258667
Epoch: 26, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 1.287168025970459
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2876336574554443
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 29 cost time: 1.1957321166992188
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3393092155456543
Epoch: 30, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 1.3088183403015137
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5126829147338867
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.419389247894287
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 34 cost time: 1.291696310043335
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 1.3445334434509277
Epoch: 35, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5045688152313232
Epoch: 36, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5024454593658447
Epoch: 37, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4844470024108887
Epoch: 38, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4430735111236572
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3793010711669922
Epoch: 40, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4171032905578613
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.4235265254974365
Epoch: 42, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.394120454788208
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3448445796966553
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 192895
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.597487211227417
Epoch: 1, Steps: 12 | Train Loss: 2.880 Vali Loss: 2.682 Vali Acc: 0.094 Test Loss: 2.682 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.2557117938995361
Epoch: 2, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.259 Vali Acc: 0.372 Test Loss: 2.259 Test Acc: 0.372
Validation loss decreased (-0.094418 --> -0.372200).  Saving model ...
Epoch: 3 cost time: 1.45084810256958
Epoch: 3, Steps: 12 | Train Loss: 2.030 Vali Loss: 1.847 Vali Acc: 0.567 Test Loss: 1.847 Test Acc: 0.567
Validation loss decreased (-0.372200 --> -0.566648).  Saving model ...
Epoch: 4 cost time: 1.4025294780731201
Epoch: 4, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.539 Vali Acc: 0.683 Test Loss: 1.539 Test Acc: 0.683
Validation loss decreased (-0.566648 --> -0.683318).  Saving model ...
Epoch: 5 cost time: 1.5469613075256348
Epoch: 5, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.333 Vali Acc: 0.711 Test Loss: 1.333 Test Acc: 0.711
Validation loss decreased (-0.683318 --> -0.711098).  Saving model ...
Epoch: 6 cost time: 1.2649645805358887
Epoch: 6, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.201 Vali Acc: 0.739 Test Loss: 1.201 Test Acc: 0.739
Validation loss decreased (-0.711098 --> -0.738877).  Saving model ...
Epoch: 7 cost time: 1.4340894222259521
Epoch: 7, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.093 Vali Acc: 0.739 Test Loss: 1.093 Test Acc: 0.739
Validation loss decreased (-0.738877 --> -0.738878).  Saving model ...
Epoch: 8 cost time: 1.4467689990997314
Epoch: 8, Steps: 12 | Train Loss: 0.946 Vali Loss: 0.994 Vali Acc: 0.728 Test Loss: 0.994 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4571468830108643
Epoch: 9, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
Validation loss decreased (-0.738878 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.553053617477417
Epoch: 10, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.895 Vali Acc: 0.767 Test Loss: 0.895 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.3674712181091309
Epoch: 11, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.816 Vali Acc: 0.789 Test Loss: 0.816 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.419471025466919
Epoch: 12, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.768 Vali Acc: 0.806 Test Loss: 0.768 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.2920935153961182
Epoch: 13, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3323054313659668
Epoch: 14, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.4035727977752686
Epoch: 15, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.243807315826416
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.637 Vali Acc: 0.839 Test Loss: 0.637 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.3006675243377686
Epoch: 17, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.0594482421875
Epoch: 18, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.3320789337158203
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 1.3151798248291016
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.2556853294372559
Epoch: 21, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.398360013961792
Epoch: 22, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3796072006225586
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 1.4035401344299316
Epoch: 24, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.361675500869751
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.4102346897125244
Epoch: 26, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4052820205688477
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.365286111831665
Epoch: 28, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 29 cost time: 1.2775304317474365
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.437737226486206
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 1.353417158126831
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2936606407165527
Epoch: 32, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4814164638519287
Epoch: 33, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2794215679168701
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4767484664916992
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4337847232818604
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2591016292572021
Epoch: 37, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888883).  Saving model ...
Epoch: 38 cost time: 1.3574318885803223
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4030735492706299
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.299677848815918
Epoch: 40, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.422529935836792
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.577 Vali Acc: 0.883 Test Loss: 0.577 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3869574069976807
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.580 Vali Acc: 0.878 Test Loss: 0.580 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.382136583328247
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.6705307960510254
Epoch: 44, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2794828414916992
Epoch: 45, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.5036828517913818
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.25844144821167
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 192895
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1223297119140625
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.604 Vali Acc: 0.117 Test Loss: 2.604 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 1.3365654945373535
Epoch: 2, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.222 Vali Acc: 0.372 Test Loss: 2.222 Test Acc: 0.372
Validation loss decreased (-0.116641 --> -0.372200).  Saving model ...
Epoch: 3 cost time: 1.467566967010498
Epoch: 3, Steps: 12 | Train Loss: 1.996 Vali Loss: 1.864 Vali Acc: 0.522 Test Loss: 1.864 Test Acc: 0.522
Validation loss decreased (-0.372200 --> -0.522204).  Saving model ...
Epoch: 4 cost time: 1.3951029777526855
Epoch: 4, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.576 Vali Acc: 0.656 Test Loss: 1.576 Test Acc: 0.656
Validation loss decreased (-0.522204 --> -0.655540).  Saving model ...
Epoch: 5 cost time: 1.4144952297210693
Epoch: 5, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.365 Vali Acc: 0.700 Test Loss: 1.365 Test Acc: 0.700
Validation loss decreased (-0.655540 --> -0.699986).  Saving model ...
Epoch: 6 cost time: 1.6427154541015625
Epoch: 6, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.225 Vali Acc: 0.711 Test Loss: 1.225 Test Acc: 0.711
Validation loss decreased (-0.699986 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.5848312377929688
Epoch: 7, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.106 Vali Acc: 0.711 Test Loss: 1.106 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 1.5548081398010254
Epoch: 8, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.019 Vali Acc: 0.722 Test Loss: 1.019 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 1.632606029510498
Epoch: 9, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.935 Vali Acc: 0.739 Test Loss: 0.935 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 1.3284740447998047
Epoch: 10, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 1.327111005783081
Epoch: 11, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.836 Vali Acc: 0.772 Test Loss: 0.836 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 12 cost time: 1.2514405250549316
Epoch: 12, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.772 Vali Acc: 0.817 Test Loss: 0.772 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.2811846733093262
Epoch: 13, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.758 Vali Acc: 0.811 Test Loss: 0.758 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5747981071472168
Epoch: 14, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.3442740440368652
Epoch: 15, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.756 Vali Acc: 0.817 Test Loss: 0.756 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5103843212127686
Epoch: 16, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.822215 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.490192174911499
Epoch: 17, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4360411167144775
Epoch: 18, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4235832691192627
Epoch: 19, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.374016523361206
Epoch: 20, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.632063627243042
Epoch: 21, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.1396491527557373
Epoch: 22, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4049136638641357
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5213572978973389
Epoch: 24, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3572134971618652
Epoch: 25, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4450972080230713
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.475125789642334
Epoch: 27, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5445160865783691
Epoch: 28, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.390645980834961
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 1.4222774505615234
Epoch: 30, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.3299560546875
Epoch: 31, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.366441249847412
Epoch: 32, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2819480895996094
Epoch: 33, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3900320529937744
Epoch: 34, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.219658613204956
Epoch: 35, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2777378559112549
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 37 cost time: 1.2289903163909912
Epoch: 37, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3397138118743896
Epoch: 38, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2568507194519043
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3043029308319092
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.322831153869629
Epoch: 41, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 42 cost time: 1.5171151161193848
Epoch: 42, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2552895545959473
Epoch: 43, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.250197410583496
Epoch: 44, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3771250247955322
Epoch: 45, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3243341445922852
Epoch: 46, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.250258445739746
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3182041645050049
Epoch: 48, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5414083003997803
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4093692302703857
Epoch: 50, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.646 Vali Acc: 0.878 Test Loss: 0.646 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4054365158081055
Epoch: 51, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.655 Vali Acc: 0.867 Test Loss: 0.655 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 127359
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8508665561676025
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.598 Vali Acc: 0.111 Test Loss: 2.598 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 1.4085946083068848
Epoch: 2, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.219 Vali Acc: 0.367 Test Loss: 2.219 Test Acc: 0.367
Validation loss decreased (-0.111085 --> -0.366644).  Saving model ...
Epoch: 3 cost time: 1.4071552753448486
Epoch: 3, Steps: 12 | Train Loss: 1.978 Vali Loss: 1.859 Vali Acc: 0.522 Test Loss: 1.859 Test Acc: 0.522
Validation loss decreased (-0.366644 --> -0.522204).  Saving model ...
Epoch: 4 cost time: 1.4206461906433105
Epoch: 4, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.569 Vali Acc: 0.639 Test Loss: 1.569 Test Acc: 0.639
Validation loss decreased (-0.522204 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 1.454817771911621
Epoch: 5, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.356 Vali Acc: 0.694 Test Loss: 1.356 Test Acc: 0.694
Validation loss decreased (-0.638873 --> -0.694431).  Saving model ...
Epoch: 6 cost time: 1.437129259109497
Epoch: 6, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.216 Vali Acc: 0.706 Test Loss: 1.216 Test Acc: 0.706
Validation loss decreased (-0.694431 --> -0.705543).  Saving model ...
Epoch: 7 cost time: 1.3728597164154053
Epoch: 7, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.103 Vali Acc: 0.706 Test Loss: 1.103 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705545).  Saving model ...
Epoch: 8 cost time: 1.3330612182617188
Epoch: 8, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.013 Vali Acc: 0.728 Test Loss: 1.013 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 9 cost time: 1.4600064754486084
Epoch: 9, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.3736543655395508
Epoch: 10, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.898 Vali Acc: 0.756 Test Loss: 0.898 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.521083116531372
Epoch: 11, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 12 cost time: 1.5511932373046875
Epoch: 12, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.767 Vali Acc: 0.817 Test Loss: 0.767 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.5986695289611816
Epoch: 13, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.0974302291870117
Epoch: 14, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.720 Vali Acc: 0.817 Test Loss: 0.720 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 1.3456900119781494
Epoch: 15, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2576069831848145
Epoch: 16, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.1839613914489746
Epoch: 17, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.1968843936920166
Epoch: 18, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4239373207092285
Epoch: 19, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4938228130340576
Epoch: 20, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3356568813323975
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.3497676849365234
Epoch: 22, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.366102695465088
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5227720737457275
Epoch: 24, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7116827964782715
Epoch: 25, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5906338691711426
Epoch: 26, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6618714332580566
Epoch: 27, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6765458583831787
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5592858791351318
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4647102355957031
Epoch: 30, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.525707721710205
Epoch: 31, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 127359
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.012869596481323
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.624 Vali Acc: 0.122 Test Loss: 2.624 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.2253434658050537
Epoch: 2, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.238 Vali Acc: 0.372 Test Loss: 2.238 Test Acc: 0.372
Validation loss decreased (-0.122196 --> -0.372200).  Saving model ...
Epoch: 3 cost time: 1.4556326866149902
Epoch: 3, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
Validation loss decreased (-0.372200 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.3845703601837158
Epoch: 4, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.578 Vali Acc: 0.617 Test Loss: 1.578 Test Acc: 0.617
Validation loss decreased (-0.499981 --> -0.616651).  Saving model ...
Epoch: 5 cost time: 1.3390939235687256
Epoch: 5, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.364 Vali Acc: 0.683 Test Loss: 1.364 Test Acc: 0.683
Validation loss decreased (-0.616651 --> -0.683320).  Saving model ...
Epoch: 6 cost time: 1.625223159790039
Epoch: 6, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.222 Vali Acc: 0.694 Test Loss: 1.222 Test Acc: 0.694
Validation loss decreased (-0.683320 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 1.2872133255004883
Epoch: 7, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.110 Vali Acc: 0.711 Test Loss: 1.110 Test Acc: 0.711
Validation loss decreased (-0.694432 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 1.4887304306030273
Epoch: 8, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.026 Vali Acc: 0.733 Test Loss: 1.026 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.5392069816589355
Epoch: 9, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.938 Vali Acc: 0.756 Test Loss: 0.938 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.511282205581665
Epoch: 10, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.904 Vali Acc: 0.761 Test Loss: 0.904 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 1.4848377704620361
Epoch: 11, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.839 Vali Acc: 0.767 Test Loss: 0.839 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 1.4235708713531494
Epoch: 12, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.779 Vali Acc: 0.822 Test Loss: 0.779 Test Acc: 0.822
Validation loss decreased (-0.766658 --> -0.822214).  Saving model ...
Epoch: 13 cost time: 1.5129601955413818
Epoch: 13, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.774 Vali Acc: 0.806 Test Loss: 0.774 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4739477634429932
Epoch: 14, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.727 Vali Acc: 0.822 Test Loss: 0.727 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.3216190338134766
Epoch: 15, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.760 Vali Acc: 0.817 Test Loss: 0.760 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4256794452667236
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.399315595626831
Epoch: 17, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 1.2217390537261963
Epoch: 18, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3320927619934082
Epoch: 19, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.4433648586273193
Epoch: 20, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4510741233825684
Epoch: 21, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 1.324822187423706
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5616118907928467
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3329424858093262
Epoch: 24, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4406251907348633
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4384832382202148
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4832804203033447
Epoch: 27, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.676300048828125
Epoch: 28, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 1.4302127361297607
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3477058410644531
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5218102931976318
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 1.6290843486785889
Epoch: 32, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.420210599899292
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.497591257095337
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0942285060882568
Epoch: 35, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1896581649780273
Epoch: 36, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3129534721374512
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4611279964447021
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3499178886413574
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4325041770935059
Epoch: 40, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4056785106658936
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 127359
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9571590423583984
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.614 Vali Acc: 0.117 Test Loss: 2.614 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 1.3944199085235596
Epoch: 2, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.232 Vali Acc: 0.356 Test Loss: 2.232 Test Acc: 0.356
Validation loss decreased (-0.116641 --> -0.355533).  Saving model ...
Epoch: 3 cost time: 1.281059741973877
Epoch: 3, Steps: 12 | Train Loss: 1.998 Vali Loss: 1.867 Vali Acc: 0.494 Test Loss: 1.867 Test Acc: 0.494
Validation loss decreased (-0.355533 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 1.405271291732788
Epoch: 4, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.576 Vali Acc: 0.617 Test Loss: 1.576 Test Acc: 0.617
Validation loss decreased (-0.494426 --> -0.616651).  Saving model ...
Epoch: 5 cost time: 1.3203182220458984
Epoch: 5, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.369 Vali Acc: 0.672 Test Loss: 1.369 Test Acc: 0.672
Validation loss decreased (-0.616651 --> -0.672209).  Saving model ...
Epoch: 6 cost time: 1.3663294315338135
Epoch: 6, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.233 Vali Acc: 0.683 Test Loss: 1.233 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 1.2981946468353271
Epoch: 7, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 1.2595970630645752
Epoch: 8, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.036 Vali Acc: 0.706 Test Loss: 1.036 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 1.4788451194763184
Epoch: 9, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 1.433802843093872
Epoch: 10, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.901 Vali Acc: 0.756 Test Loss: 0.901 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 1.2129418849945068
Epoch: 11, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4685368537902832
Epoch: 12, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.4279024600982666
Epoch: 13, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.763 Vali Acc: 0.794 Test Loss: 0.763 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2512681484222412
Epoch: 14, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 15 cost time: 1.4373352527618408
Epoch: 15, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.729 Vali Acc: 0.817 Test Loss: 0.729 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 16 cost time: 1.3313393592834473
Epoch: 16, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.2000503540039062
Epoch: 17, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.5376696586608887
Epoch: 18, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.360255479812622
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.341784954071045
Epoch: 20, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5263512134552002
Epoch: 21, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.502223014831543
Epoch: 22, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4386117458343506
Epoch: 23, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4823670387268066
Epoch: 24, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.3020944595336914
Epoch: 25, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.364069938659668
Epoch: 26, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3195388317108154
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 1.215597152709961
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.1847083568572998
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2789533138275146
Epoch: 30, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3680925369262695
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.4220619201660156
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.2537167072296143
Epoch: 33, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.3679990768432617
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 35 cost time: 1.4343175888061523
Epoch: 35, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3030824661254883
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5156748294830322
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.421717882156372
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.571890115737915
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5785448551177979
Epoch: 40, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5702311992645264
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.4728326797485352
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4577274322509766
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 44 cost time: 1.3362417221069336
Epoch: 44, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.542 Vali Acc: 0.878 Test Loss: 0.542 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 45 cost time: 1.393928050994873
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.457456111907959
Epoch: 46, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.470099687576294
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5220272541046143
Epoch: 48, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3556735515594482
Epoch: 49, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5639429092407227
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3443162441253662
Epoch: 51, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4271626472473145
Epoch: 52, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3103513717651367
Epoch: 53, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2300353050231934
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 127359
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6851656436920166
Epoch: 1, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.509 Vali Acc: 0.211 Test Loss: 2.509 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 1.5522782802581787
Epoch: 2, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.110 Vali Acc: 0.383 Test Loss: 2.110 Test Acc: 0.383
Validation loss decreased (-0.211086 --> -0.383312).  Saving model ...
Epoch: 3 cost time: 1.514601707458496
Epoch: 3, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.786 Vali Acc: 0.461 Test Loss: 1.786 Test Acc: 0.461
Validation loss decreased (-0.383312 --> -0.461093).  Saving model ...
Epoch: 4 cost time: 1.3825619220733643
Epoch: 4, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.535 Vali Acc: 0.633 Test Loss: 1.535 Test Acc: 0.633
Validation loss decreased (-0.461093 --> -0.633318).  Saving model ...
Epoch: 5 cost time: 1.4732568264007568
Epoch: 5, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.369 Vali Acc: 0.694 Test Loss: 1.369 Test Acc: 0.694
Validation loss decreased (-0.633318 --> -0.694431).  Saving model ...
Epoch: 6 cost time: 1.314819574356079
Epoch: 6, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.202 Vali Acc: 0.717 Test Loss: 1.202 Test Acc: 0.717
Validation loss decreased (-0.694431 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 1.2070436477661133
Epoch: 7, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.124 Vali Acc: 0.717 Test Loss: 1.124 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716655).  Saving model ...
Epoch: 8 cost time: 1.5422542095184326
Epoch: 8, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.3761308193206787
Epoch: 9, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.953 Vali Acc: 0.744 Test Loss: 0.953 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 10 cost time: 1.4973533153533936
Epoch: 10, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.895 Vali Acc: 0.778 Test Loss: 0.895 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.4135265350341797
Epoch: 11, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.844 Vali Acc: 0.789 Test Loss: 0.844 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 1.4678924083709717
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.828 Vali Acc: 0.800 Test Loss: 0.828 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.563516616821289
Epoch: 13, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.786 Vali Acc: 0.828 Test Loss: 0.786 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827770).  Saving model ...
Epoch: 14 cost time: 1.6616244316101074
Epoch: 14, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.578155517578125
Epoch: 15, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.786668062210083
Epoch: 16, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.685 Vali Acc: 0.839 Test Loss: 0.685 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 1.6336727142333984
Epoch: 17, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6113808155059814
Epoch: 18, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 1.5048456192016602
Epoch: 19, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.685 Vali Acc: 0.839 Test Loss: 0.685 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3416273593902588
Epoch: 20, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.3867557048797607
Epoch: 21, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3601512908935547
Epoch: 22, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4835004806518555
Epoch: 23, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.358959436416626
Epoch: 24, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4106488227844238
Epoch: 25, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 1.5375351905822754
Epoch: 26, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 1.3041582107543945
Epoch: 27, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.6244285106658936
Epoch: 28, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5238020420074463
Epoch: 29, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4526362419128418
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.585758924484253
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3946595191955566
Epoch: 32, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6088106632232666
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5069055557250977
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.605 Vali Acc: 0.883 Test Loss: 0.605 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 35 cost time: 1.4973039627075195
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4520695209503174
Epoch: 36, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.606 Vali Acc: 0.883 Test Loss: 0.606 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4916255474090576
Epoch: 37, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4937055110931396
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3073408603668213
Epoch: 39, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4544494152069092
Epoch: 40, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3573901653289795
Epoch: 41, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.480564832687378
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4391205310821533
Epoch: 43, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.448387622833252
Epoch: 44, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 94591
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8767926692962646
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.513 Vali Acc: 0.200 Test Loss: 2.513 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 1.3408372402191162
Epoch: 2, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.113 Vali Acc: 0.400 Test Loss: 2.113 Test Acc: 0.400
Validation loss decreased (-0.199975 --> -0.399979).  Saving model ...
Epoch: 3 cost time: 1.476233720779419
Epoch: 3, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.787 Vali Acc: 0.456 Test Loss: 1.787 Test Acc: 0.456
Validation loss decreased (-0.399979 --> -0.455538).  Saving model ...
Epoch: 4 cost time: 1.6021418571472168
Epoch: 4, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.533 Vali Acc: 0.639 Test Loss: 1.533 Test Acc: 0.639
Validation loss decreased (-0.455538 --> -0.638874).  Saving model ...
Epoch: 5 cost time: 1.6866934299468994
Epoch: 5, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.363 Vali Acc: 0.689 Test Loss: 1.363 Test Acc: 0.689
Validation loss decreased (-0.638874 --> -0.688875).  Saving model ...
Epoch: 6 cost time: 1.4559602737426758
Epoch: 6, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.198 Vali Acc: 0.711 Test Loss: 1.198 Test Acc: 0.711
Validation loss decreased (-0.688875 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.380506992340088
Epoch: 7, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.122 Vali Acc: 0.711 Test Loss: 1.122 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 1.194840669631958
Epoch: 8, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.2554748058319092
Epoch: 9, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.946 Vali Acc: 0.761 Test Loss: 0.946 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.5101370811462402
Epoch: 10, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.892 Vali Acc: 0.761 Test Loss: 0.892 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 1.3619091510772705
Epoch: 11, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.839 Vali Acc: 0.772 Test Loss: 0.839 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 12 cost time: 1.5263376235961914
Epoch: 12, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.826 Vali Acc: 0.794 Test Loss: 0.826 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794436).  Saving model ...
Epoch: 13 cost time: 1.4890174865722656
Epoch: 13, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
Validation loss decreased (-0.794436 --> -0.822214).  Saving model ...
Epoch: 14 cost time: 1.3683199882507324
Epoch: 14, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.733 Vali Acc: 0.811 Test Loss: 0.733 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.328101396560669
Epoch: 15, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.4660768508911133
Epoch: 16, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 1.2882909774780273
Epoch: 17, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 1.2630119323730469
Epoch: 18, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.529231309890747
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3251919746398926
Epoch: 20, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.4832417964935303
Epoch: 21, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6687893867492676
Epoch: 22, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.277634620666504
Epoch: 23, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.636 Vali Acc: 0.861 Test Loss: 0.636 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2818920612335205
Epoch: 24, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.328840970993042
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 1.3872590065002441
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.304786205291748
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.5743780136108398
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4638733863830566
Epoch: 29, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.447234869003296
Epoch: 30, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6161110401153564
Epoch: 31, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5654373168945312
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.460944414138794
Epoch: 33, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2654547691345215
Epoch: 34, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2083144187927246
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3774869441986084
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2602529525756836
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 94591
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5037901401519775
Epoch: 1, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.518 Vali Acc: 0.206 Test Loss: 2.518 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 1.3919353485107422
Epoch: 2, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.120 Vali Acc: 0.428 Test Loss: 2.120 Test Acc: 0.428
Validation loss decreased (-0.205530 --> -0.427757).  Saving model ...
Epoch: 3 cost time: 1.518376350402832
Epoch: 3, Steps: 12 | Train Loss: 2.007 Vali Loss: 1.792 Vali Acc: 0.456 Test Loss: 1.792 Test Acc: 0.456
Validation loss decreased (-0.427757 --> -0.455538).  Saving model ...
Epoch: 4 cost time: 1.4682080745697021
Epoch: 4, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.533 Vali Acc: 0.633 Test Loss: 1.533 Test Acc: 0.633
Validation loss decreased (-0.455538 --> -0.633318).  Saving model ...
Epoch: 5 cost time: 1.549299955368042
Epoch: 5, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.360 Vali Acc: 0.700 Test Loss: 1.360 Test Acc: 0.700
Validation loss decreased (-0.633318 --> -0.699986).  Saving model ...
Epoch: 6 cost time: 1.4760572910308838
Epoch: 6, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.203 Vali Acc: 0.700 Test Loss: 1.203 Test Acc: 0.700
Validation loss decreased (-0.699986 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 1.2807691097259521
Epoch: 7, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.122 Vali Acc: 0.700 Test Loss: 1.122 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.360774278640747
Epoch: 8, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.019 Vali Acc: 0.733 Test Loss: 1.019 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.3127446174621582
Epoch: 9, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.940 Vali Acc: 0.756 Test Loss: 0.940 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.3053722381591797
Epoch: 10, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.894 Vali Acc: 0.756 Test Loss: 0.894 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 1.3180549144744873
Epoch: 11, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 1.2262787818908691
Epoch: 12, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.820 Vali Acc: 0.783 Test Loss: 0.820 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 1.3462274074554443
Epoch: 13, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.782 Vali Acc: 0.822 Test Loss: 0.782 Test Acc: 0.822
Validation loss decreased (-0.783325 --> -0.822214).  Saving model ...
Epoch: 14 cost time: 1.2891185283660889
Epoch: 14, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.725 Vali Acc: 0.806 Test Loss: 0.725 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4476432800292969
Epoch: 15, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.5066494941711426
Epoch: 16, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.488797664642334
Epoch: 17, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.455737590789795
Epoch: 18, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.659 Vali Acc: 0.828 Test Loss: 0.659 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4477126598358154
Epoch: 19, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4584026336669922
Epoch: 20, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.3640151023864746
Epoch: 21, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4252314567565918
Epoch: 22, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.41737961769104
Epoch: 23, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 1.4186241626739502
Epoch: 24, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6894917488098145
Epoch: 25, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5313236713409424
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 1.4196393489837646
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.4899263381958008
Epoch: 28, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4778468608856201
Epoch: 29, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4105103015899658
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3847434520721436
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3617815971374512
Epoch: 32, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3091094493865967
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3051280975341797
Epoch: 34, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3912599086761475
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4305362701416016
Epoch: 36, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2885992527008057
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 94591
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.722368001937866
Epoch: 1, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.522 Vali Acc: 0.194 Test Loss: 2.522 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 1.5197553634643555
Epoch: 2, Steps: 12 | Train Loss: 2.412 Vali Loss: 2.134 Vali Acc: 0.422 Test Loss: 2.134 Test Acc: 0.422
Validation loss decreased (-0.194419 --> -0.422201).  Saving model ...
Epoch: 3 cost time: 1.2900092601776123
Epoch: 3, Steps: 12 | Train Loss: 2.023 Vali Loss: 1.807 Vali Acc: 0.467 Test Loss: 1.807 Test Acc: 0.467
Validation loss decreased (-0.422201 --> -0.466649).  Saving model ...
Epoch: 4 cost time: 1.3697216510772705
Epoch: 4, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.546 Vali Acc: 0.600 Test Loss: 1.546 Test Acc: 0.600
Validation loss decreased (-0.466649 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 1.2005658149719238
Epoch: 5, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.376 Vali Acc: 0.678 Test Loss: 1.376 Test Acc: 0.678
Validation loss decreased (-0.599985 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 1.5706257820129395
Epoch: 6, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.225 Vali Acc: 0.706 Test Loss: 1.225 Test Acc: 0.706
Validation loss decreased (-0.677764 --> -0.705543).  Saving model ...
Epoch: 7 cost time: 1.2698454856872559
Epoch: 7, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.149 Vali Acc: 0.689 Test Loss: 1.149 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3063831329345703
Epoch: 8, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.041 Vali Acc: 0.706 Test Loss: 1.041 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 1.3530983924865723
Epoch: 9, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.705545 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.367063045501709
Epoch: 10, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.916 Vali Acc: 0.739 Test Loss: 0.916 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3826789855957031
Epoch: 11, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 1.3933055400848389
Epoch: 12, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 1.4266331195831299
Epoch: 13, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.391390085220337
Epoch: 14, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 15 cost time: 1.284665584564209
Epoch: 15, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.1509249210357666
Epoch: 16, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.3737859725952148
Epoch: 17, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.4925460815429688
Epoch: 18, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.330573558807373
Epoch: 19, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3408362865447998
Epoch: 20, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.378612756729126
Epoch: 21, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 22 cost time: 1.3087108135223389
Epoch: 22, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4216454029083252
Epoch: 23, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 1.358809232711792
Epoch: 24, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.410963535308838
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4248237609863281
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 1.370471477508545
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.2670528888702393
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3626487255096436
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.374518871307373
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2741007804870605
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3297197818756104
Epoch: 32, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2851383686065674
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5761868953704834
Epoch: 34, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1427929401397705
Epoch: 35, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1361658573150635
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1904256343841553
Epoch: 37, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 94591
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.380384683609009
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.649 Vali Acc: 0.178 Test Loss: 2.649 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 1.566129446029663
Epoch: 2, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.250 Vali Acc: 0.300 Test Loss: 2.250 Test Acc: 0.300
Validation loss decreased (-0.177751 --> -0.299977).  Saving model ...
Epoch: 3 cost time: 1.5023951530456543
Epoch: 3, Steps: 12 | Train Loss: 2.091 Vali Loss: 1.879 Vali Acc: 0.483 Test Loss: 1.879 Test Acc: 0.483
Validation loss decreased (-0.299977 --> -0.483315).  Saving model ...
Epoch: 4 cost time: 1.3389110565185547
Epoch: 4, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.601 Vali Acc: 0.578 Test Loss: 1.601 Test Acc: 0.578
Validation loss decreased (-0.483315 --> -0.577762).  Saving model ...
Epoch: 5 cost time: 1.4279565811157227
Epoch: 5, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.392 Vali Acc: 0.678 Test Loss: 1.392 Test Acc: 0.678
Validation loss decreased (-0.577762 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 1.7273380756378174
Epoch: 6, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.243 Vali Acc: 0.711 Test Loss: 1.243 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.5977277755737305
Epoch: 7, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.138 Vali Acc: 0.711 Test Loss: 1.138 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 1.251718282699585
Epoch: 8, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3489913940429688
Epoch: 9, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.945 Vali Acc: 0.756 Test Loss: 0.945 Test Acc: 0.756
Validation loss decreased (-0.711100 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.3333137035369873
Epoch: 10, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.906 Vali Acc: 0.778 Test Loss: 0.906 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.4180922508239746
Epoch: 11, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.871 Vali Acc: 0.789 Test Loss: 0.871 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 1.4248716831207275
Epoch: 12, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.823 Vali Acc: 0.794 Test Loss: 0.823 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 13 cost time: 1.4108476638793945
Epoch: 13, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.777 Vali Acc: 0.817 Test Loss: 0.777 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.3083789348602295
Epoch: 14, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.766 Vali Acc: 0.822 Test Loss: 0.766 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.2727508544921875
Epoch: 15, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.726 Vali Acc: 0.828 Test Loss: 0.726 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.408172369003296
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.696 Vali Acc: 0.828 Test Loss: 0.696 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.2769687175750732
Epoch: 17, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4006011486053467
Epoch: 18, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 1.3620846271514893
Epoch: 19, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3579416275024414
Epoch: 20, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.405747890472412
Epoch: 21, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 1.5459175109863281
Epoch: 22, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4231324195861816
Epoch: 23, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 1.4651849269866943
Epoch: 24, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.427229642868042
Epoch: 25, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 26 cost time: 1.4349186420440674
Epoch: 26, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3607807159423828
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3495032787322998
Epoch: 28, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 1.3394951820373535
Epoch: 29, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.614 Vali Acc: 0.878 Test Loss: 0.614 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.464583396911621
Epoch: 30, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4009346961975098
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.594 Vali Acc: 0.883 Test Loss: 0.594 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3788156509399414
Epoch: 32, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.379523754119873
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4171092510223389
Epoch: 34, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3131334781646729
Epoch: 35, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4962358474731445
Epoch: 36, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3549160957336426
Epoch: 37, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.641 Vali Acc: 0.878 Test Loss: 0.641 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.4208018779754639
Epoch: 38, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 78207
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.494683027267456
Epoch: 1, Steps: 12 | Train Loss: 2.841 Vali Loss: 2.646 Vali Acc: 0.178 Test Loss: 2.646 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 1.4229183197021484
Epoch: 2, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.250 Vali Acc: 0.328 Test Loss: 2.250 Test Acc: 0.328
Validation loss decreased (-0.177751 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 1.3297936916351318
Epoch: 3, Steps: 12 | Train Loss: 2.081 Vali Loss: 1.878 Vali Acc: 0.472 Test Loss: 1.878 Test Acc: 0.472
Validation loss decreased (-0.327755 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 1.2965977191925049
Epoch: 4, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.598 Vali Acc: 0.567 Test Loss: 1.598 Test Acc: 0.567
Validation loss decreased (-0.472203 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 1.4507668018341064
Epoch: 5, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.388 Vali Acc: 0.644 Test Loss: 1.388 Test Acc: 0.644
Validation loss decreased (-0.566651 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 1.3465023040771484
Epoch: 6, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.238 Vali Acc: 0.711 Test Loss: 1.238 Test Acc: 0.711
Validation loss decreased (-0.644431 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.3128912448883057
Epoch: 7, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.135 Vali Acc: 0.700 Test Loss: 1.135 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.616382122039795
Epoch: 8, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.060 Vali Acc: 0.711 Test Loss: 1.060 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 1.4340176582336426
Epoch: 9, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.711101 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.3128583431243896
Epoch: 10, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.901 Vali Acc: 0.778 Test Loss: 0.901 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.388793706893921
Epoch: 11, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 1.239861249923706
Epoch: 12, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 1.377791404724121
Epoch: 13, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.773 Vali Acc: 0.817 Test Loss: 0.773 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.1812283992767334
Epoch: 14, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3168785572052002
Epoch: 15, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5341815948486328
Epoch: 16, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.1997458934783936
Epoch: 17, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.685 Vali Acc: 0.817 Test Loss: 0.685 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5240066051483154
Epoch: 18, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 1.4141442775726318
Epoch: 19, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3365373611450195
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.2666666507720947
Epoch: 21, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5100584030151367
Epoch: 22, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.2771170139312744
Epoch: 23, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 1.4361660480499268
Epoch: 24, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5585432052612305
Epoch: 25, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.1779589653015137
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4723315238952637
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.244182825088501
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.2003111839294434
Epoch: 29, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.333486557006836
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2434780597686768
Epoch: 31, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1572628021240234
Epoch: 32, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4772186279296875
Epoch: 33, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5847203731536865
Epoch: 34, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3785901069641113
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5062201023101807
Epoch: 36, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4838840961456299
Epoch: 37, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6125307083129883
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 78207
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.773831605911255
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.643 Vali Acc: 0.178 Test Loss: 2.643 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 1.429015874862671
Epoch: 2, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.249 Vali Acc: 0.306 Test Loss: 2.249 Test Acc: 0.306
Validation loss decreased (-0.177751 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 1.3620884418487549
Epoch: 3, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.876 Vali Acc: 0.467 Test Loss: 1.876 Test Acc: 0.467
Validation loss decreased (-0.305533 --> -0.466648).  Saving model ...
Epoch: 4 cost time: 1.349463939666748
Epoch: 4, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.595 Vali Acc: 0.583 Test Loss: 1.595 Test Acc: 0.583
Validation loss decreased (-0.466648 --> -0.583317).  Saving model ...
Epoch: 5 cost time: 1.235605001449585
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.387 Vali Acc: 0.661 Test Loss: 1.387 Test Acc: 0.661
Validation loss decreased (-0.583317 --> -0.661097).  Saving model ...
Epoch: 6 cost time: 1.4390876293182373
Epoch: 6, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (-0.661097 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 1.3683385848999023
Epoch: 7, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.3648059368133545
Epoch: 8, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 1.4645001888275146
Epoch: 9, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.943 Vali Acc: 0.744 Test Loss: 0.943 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 10 cost time: 1.3358633518218994
Epoch: 10, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.897 Vali Acc: 0.778 Test Loss: 0.897 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.275841236114502
Epoch: 11, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.869 Vali Acc: 0.778 Test Loss: 0.869 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 1.2753784656524658
Epoch: 12, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.820 Vali Acc: 0.783 Test Loss: 0.820 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 1.3128108978271484
Epoch: 13, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
Validation loss decreased (-0.783325 --> -0.822214).  Saving model ...
Epoch: 14 cost time: 1.449580430984497
Epoch: 14, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3552374839782715
Epoch: 15, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.723 Vali Acc: 0.817 Test Loss: 0.723 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3392746448516846
Epoch: 16, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.3680636882781982
Epoch: 17, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3841636180877686
Epoch: 18, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.3836719989776611
Epoch: 19, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3343369960784912
Epoch: 20, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.318523645401001
Epoch: 21, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3553638458251953
Epoch: 22, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.4025554656982422
Epoch: 23, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4639196395874023
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 1.3960249423980713
Epoch: 25, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3204238414764404
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3906724452972412
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3720784187316895
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.474766731262207
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3988432884216309
Epoch: 30, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.479050636291504
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2679800987243652
Epoch: 32, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4356889724731445
Epoch: 33, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3405992984771729
Epoch: 34, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5106241703033447
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5509312152862549
Epoch: 36, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3490793704986572
Epoch: 37, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2742981910705566
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5111429691314697
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3482835292816162
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 78207
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9840569496154785
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.614 Vali Acc: 0.178 Test Loss: 2.614 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.3864693641662598
Epoch: 2, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.230 Vali Acc: 0.300 Test Loss: 2.230 Test Acc: 0.300
Validation loss decreased (-0.177752 --> -0.299978).  Saving model ...
Epoch: 3 cost time: 1.4113013744354248
Epoch: 3, Steps: 12 | Train Loss: 2.076 Vali Loss: 1.867 Vali Acc: 0.439 Test Loss: 1.867 Test Acc: 0.439
Validation loss decreased (-0.299978 --> -0.438870).  Saving model ...
Epoch: 4 cost time: 1.4555323123931885
Epoch: 4, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.593 Vali Acc: 0.567 Test Loss: 1.593 Test Acc: 0.567
Validation loss decreased (-0.438870 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 1.3347103595733643
Epoch: 5, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.390 Vali Acc: 0.644 Test Loss: 1.390 Test Acc: 0.644
Validation loss decreased (-0.566651 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 1.3113059997558594
Epoch: 6, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.242 Vali Acc: 0.678 Test Loss: 1.242 Test Acc: 0.678
Validation loss decreased (-0.644431 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 1.2606205940246582
Epoch: 7, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.144 Vali Acc: 0.672 Test Loss: 1.144 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2681872844696045
Epoch: 8, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.070 Vali Acc: 0.694 Test Loss: 1.070 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 1.3106884956359863
Epoch: 9, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.694434 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.4007647037506104
Epoch: 10, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.904 Vali Acc: 0.744 Test Loss: 0.904 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.463224172592163
Epoch: 11, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.2271826267242432
Epoch: 12, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.822 Vali Acc: 0.778 Test Loss: 0.822 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 1.412532091140747
Epoch: 13, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.506253957748413
Epoch: 14, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.42988920211792
Epoch: 15, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4653944969177246
Epoch: 16, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.4631807804107666
Epoch: 17, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.496511459350586
Epoch: 18, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.4108407497406006
Epoch: 19, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3862144947052002
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 1.4124464988708496
Epoch: 21, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.246084451675415
Epoch: 22, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.43558669090271
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2506771087646484
Epoch: 24, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.2976627349853516
Epoch: 25, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3388755321502686
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 1.241046667098999
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.377192735671997
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4855821132659912
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.388657569885254
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3026857376098633
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.345027208328247
Epoch: 32, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4300782680511475
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.409210443496704
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3746073246002197
Epoch: 35, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.532 Vali Acc: 0.894 Test Loss: 0.532 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894439).  Saving model ...
Epoch: 36 cost time: 1.3279426097869873
Epoch: 36, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3534941673278809
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.409116506576538
Epoch: 38, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.513 Vali Acc: 0.894 Test Loss: 0.513 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 39 cost time: 1.2840964794158936
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2444148063659668
Epoch: 40, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2904999256134033
Epoch: 41, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3579216003417969
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2851922512054443
Epoch: 43, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2825191020965576
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.356199026107788
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5001239776611328
Epoch: 46, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.878 Test Loss: 0.542 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3453643321990967
Epoch: 47, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3502774238586426
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 78207
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.144140958786011
Epoch: 1, Steps: 12 | Train Loss: 2.866 Vali Loss: 2.776 Vali Acc: 0.072 Test Loss: 2.776 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.222151279449463
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.554 Vali Acc: 0.167 Test Loss: 2.554 Test Acc: 0.167
Validation loss decreased (-0.072194 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 1.3394968509674072
Epoch: 3, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.293 Vali Acc: 0.328 Test Loss: 2.293 Test Acc: 0.328
Validation loss decreased (-0.166641 --> -0.327755).  Saving model ...
Epoch: 4 cost time: 1.453183889389038
Epoch: 4, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.046 Vali Acc: 0.439 Test Loss: 2.046 Test Acc: 0.439
Validation loss decreased (-0.327755 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.3763582706451416
Epoch: 5, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.824 Vali Acc: 0.561 Test Loss: 1.824 Test Acc: 0.561
Validation loss decreased (-0.438868 --> -0.561093).  Saving model ...
Epoch: 6 cost time: 1.3312575817108154
Epoch: 6, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.642 Vali Acc: 0.611 Test Loss: 1.642 Test Acc: 0.611
Validation loss decreased (-0.561093 --> -0.611095).  Saving model ...
Epoch: 7 cost time: 1.4464218616485596
Epoch: 7, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.480 Vali Acc: 0.678 Test Loss: 1.480 Test Acc: 0.678
Validation loss decreased (-0.611095 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 1.2938923835754395
Epoch: 8, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.353 Vali Acc: 0.672 Test Loss: 1.353 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2555956840515137
Epoch: 9, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.263 Vali Acc: 0.683 Test Loss: 1.263 Test Acc: 0.683
Validation loss decreased (-0.677763 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.369523525238037
Epoch: 10, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.187 Vali Acc: 0.694 Test Loss: 1.187 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 1.183912754058838
Epoch: 11, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.111 Vali Acc: 0.683 Test Loss: 1.111 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4704256057739258
Epoch: 12, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.030 Vali Acc: 0.722 Test Loss: 1.030 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722212).  Saving model ...
Epoch: 13 cost time: 1.438410997390747
Epoch: 13, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 1.3469362258911133
Epoch: 14, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.933 Vali Acc: 0.739 Test Loss: 0.933 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 15 cost time: 1.3650124073028564
Epoch: 15, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761102).  Saving model ...
Epoch: 16 cost time: 1.1142218112945557
Epoch: 16, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.856 Vali Acc: 0.783 Test Loss: 0.856 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.321343183517456
Epoch: 17, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.3802311420440674
Epoch: 18, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.804 Vali Acc: 0.811 Test Loss: 0.804 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.371178388595581
Epoch: 19, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.3789072036743164
Epoch: 20, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.740 Vali Acc: 0.811 Test Loss: 0.740 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 1.5153262615203857
Epoch: 21, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.713 Vali Acc: 0.806 Test Loss: 0.713 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3925306797027588
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.328256607055664
Epoch: 23, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.678 Vali Acc: 0.811 Test Loss: 0.678 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.489091157913208
Epoch: 24, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.501296043395996
Epoch: 25, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 1.335474967956543
Epoch: 26, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.2689406871795654
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.638 Vali Acc: 0.828 Test Loss: 0.638 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3293182849884033
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.624 Vali Acc: 0.839 Test Loss: 0.624 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 1.3280153274536133
Epoch: 29, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 1.4801504611968994
Epoch: 30, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.2486181259155273
Epoch: 31, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3682560920715332
Epoch: 32, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.2832226753234863
Epoch: 33, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3828613758087158
Epoch: 34, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4810914993286133
Epoch: 35, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 1.2847251892089844
Epoch: 36, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2620158195495605
Epoch: 37, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2954964637756348
Epoch: 38, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3618128299713135
Epoch: 39, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1132009029388428
Epoch: 40, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3184893131256104
Epoch: 41, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3529839515686035
Epoch: 42, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.524200677871704
Epoch: 43, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.5811643600463867
Epoch: 44, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.307344913482666
Epoch: 45, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 288991
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1815929412841797
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.779 Vali Acc: 0.067 Test Loss: 2.779 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.3723220825195312
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.554 Vali Acc: 0.156 Test Loss: 2.554 Test Acc: 0.156
Validation loss decreased (-0.066639 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.338350534439087
Epoch: 3, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.290 Vali Acc: 0.317 Test Loss: 2.290 Test Acc: 0.317
Validation loss decreased (-0.155530 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 1.389655351638794
Epoch: 4, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.040 Vali Acc: 0.456 Test Loss: 2.040 Test Acc: 0.456
Validation loss decreased (-0.316644 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 1.3160977363586426
Epoch: 5, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.815 Vali Acc: 0.600 Test Loss: 1.815 Test Acc: 0.600
Validation loss decreased (-0.455535 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 1.4586374759674072
Epoch: 6, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.632 Vali Acc: 0.633 Test Loss: 1.632 Test Acc: 0.633
Validation loss decreased (-0.599982 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.4562630653381348
Epoch: 7, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.468 Vali Acc: 0.667 Test Loss: 1.468 Test Acc: 0.667
Validation loss decreased (-0.633317 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.335784673690796
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.342 Vali Acc: 0.667 Test Loss: 1.342 Test Acc: 0.667
Validation loss decreased (-0.666652 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 1.3068444728851318
Epoch: 9, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.251 Vali Acc: 0.683 Test Loss: 1.251 Test Acc: 0.683
Validation loss decreased (-0.666653 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.242673397064209
Epoch: 10, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.175 Vali Acc: 0.694 Test Loss: 1.175 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 1.2422029972076416
Epoch: 11, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.100 Vali Acc: 0.694 Test Loss: 1.100 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 1.3274242877960205
Epoch: 12, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.018 Vali Acc: 0.711 Test Loss: 1.018 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 1.2756752967834473
Epoch: 13, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 1.2278470993041992
Epoch: 14, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.924 Vali Acc: 0.733 Test Loss: 0.924 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 1.371992826461792
Epoch: 15, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.888 Vali Acc: 0.756 Test Loss: 0.888 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.2826175689697266
Epoch: 16, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.847 Vali Acc: 0.783 Test Loss: 0.847 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.4040086269378662
Epoch: 17, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.822 Vali Acc: 0.806 Test Loss: 0.822 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.4506664276123047
Epoch: 18, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.791 Vali Acc: 0.806 Test Loss: 0.791 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.3441741466522217
Epoch: 19, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.761 Vali Acc: 0.811 Test Loss: 0.761 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.246626853942871
Epoch: 20, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.731 Vali Acc: 0.817 Test Loss: 0.731 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 1.4456324577331543
Epoch: 21, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3260464668273926
Epoch: 22, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.4905531406402588
Epoch: 23, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.671 Vali Acc: 0.817 Test Loss: 0.671 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 1.3593592643737793
Epoch: 24, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 1.3975837230682373
Epoch: 25, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 1.3387751579284668
Epoch: 26, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.3052892684936523
Epoch: 27, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3070685863494873
Epoch: 28, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 1.2195944786071777
Epoch: 29, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.4875991344451904
Epoch: 30, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.365342140197754
Epoch: 31, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3393549919128418
Epoch: 32, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.3636269569396973
Epoch: 33, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2813518047332764
Epoch: 34, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3194785118103027
Epoch: 35, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 1.3047089576721191
Epoch: 36, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.295795202255249
Epoch: 37, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.2793219089508057
Epoch: 38, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4232745170593262
Epoch: 39, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 1.3787410259246826
Epoch: 40, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4108808040618896
Epoch: 41, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3415064811706543
Epoch: 42, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5654103755950928
Epoch: 43, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 44 cost time: 1.3422539234161377
Epoch: 44, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4243249893188477
Epoch: 45, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3054800033569336
Epoch: 46, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3959038257598877
Epoch: 47, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.404716968536377
Epoch: 48, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3783471584320068
Epoch: 49, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3210482597351074
Epoch: 50, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2287583351135254
Epoch: 51, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.346179485321045
Epoch: 52, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.3606674671173096
Epoch: 53, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 288991
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6130480766296387
Epoch: 1, Steps: 12 | Train Loss: 2.866 Vali Loss: 2.795 Vali Acc: 0.061 Test Loss: 2.795 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.383962631225586
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.570 Vali Acc: 0.161 Test Loss: 2.570 Test Acc: 0.161
Validation loss decreased (-0.061083 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 1.4096455574035645
Epoch: 3, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.302 Vali Acc: 0.306 Test Loss: 2.302 Test Acc: 0.306
Validation loss decreased (-0.161085 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 1.4499638080596924
Epoch: 4, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.044 Vali Acc: 0.450 Test Loss: 2.044 Test Acc: 0.450
Validation loss decreased (-0.305533 --> -0.449980).  Saving model ...
Epoch: 5 cost time: 1.383453130722046
Epoch: 5, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.814 Vali Acc: 0.600 Test Loss: 1.814 Test Acc: 0.600
Validation loss decreased (-0.449980 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 1.384889841079712
Epoch: 6, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.634 Vali Acc: 0.656 Test Loss: 1.634 Test Acc: 0.656
Validation loss decreased (-0.599982 --> -0.655539).  Saving model ...
Epoch: 7 cost time: 1.2795753479003906
Epoch: 7, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.472 Vali Acc: 0.667 Test Loss: 1.472 Test Acc: 0.667
Validation loss decreased (-0.655539 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.2651572227478027
Epoch: 8, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.345 Vali Acc: 0.678 Test Loss: 1.345 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 1.2117576599121094
Epoch: 9, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.254 Vali Acc: 0.683 Test Loss: 1.254 Test Acc: 0.683
Validation loss decreased (-0.677764 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.4358470439910889
Epoch: 10, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.177 Vali Acc: 0.694 Test Loss: 1.177 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 1.2964401245117188
Epoch: 11, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.099 Vali Acc: 0.722 Test Loss: 1.099 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722211).  Saving model ...
Epoch: 12 cost time: 1.229494333267212
Epoch: 12, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 1.4027457237243652
Epoch: 13, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3746280670166016
Epoch: 14, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.930 Vali Acc: 0.744 Test Loss: 0.930 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.3724071979522705
Epoch: 15, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.897 Vali Acc: 0.767 Test Loss: 0.897 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 16 cost time: 1.3592371940612793
Epoch: 16, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.854 Vali Acc: 0.789 Test Loss: 0.854 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 1.3413045406341553
Epoch: 17, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 1.3306143283843994
Epoch: 18, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.4016127586364746
Epoch: 19, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.486173152923584
Epoch: 20, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.417135238647461
Epoch: 21, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 1.345520257949829
Epoch: 22, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.4236345291137695
Epoch: 23, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.3286247253417969
Epoch: 24, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.437706708908081
Epoch: 25, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.633 Vali Acc: 0.828 Test Loss: 0.633 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 1.203287124633789
Epoch: 26, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.2635083198547363
Epoch: 27, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.2753782272338867
Epoch: 28, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.227313756942749
Epoch: 29, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 1.3148715496063232
Epoch: 30, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3914880752563477
Epoch: 31, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3035337924957275
Epoch: 32, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.2496654987335205
Epoch: 33, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 1.3436636924743652
Epoch: 34, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 1.328094244003296
Epoch: 35, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.531412124633789
Epoch: 36, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3669183254241943
Epoch: 37, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.344024658203125
Epoch: 38, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 39 cost time: 1.362544059753418
Epoch: 39, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.507 Vali Acc: 0.883 Test Loss: 0.507 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 40 cost time: 1.5328805446624756
Epoch: 40, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.498 Vali Acc: 0.883 Test Loss: 0.498 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 1.5116400718688965
Epoch: 41, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.441650152206421
Epoch: 42, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5008268356323242
Epoch: 43, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4907538890838623
Epoch: 44, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4009907245635986
Epoch: 45, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3977675437927246
Epoch: 46, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2940278053283691
Epoch: 47, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4299211502075195
Epoch: 48, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.36189603805542
Epoch: 49, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.507399320602417
Epoch: 50, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 288991
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5122501850128174
Epoch: 1, Steps: 12 | Train Loss: 2.859 Vali Loss: 2.754 Vali Acc: 0.089 Test Loss: 2.754 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.434464931488037
Epoch: 2, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.531 Vali Acc: 0.156 Test Loss: 2.531 Test Acc: 0.156
Validation loss decreased (-0.088861 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.37961745262146
Epoch: 3, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.259 Vali Acc: 0.356 Test Loss: 2.259 Test Acc: 0.356
Validation loss decreased (-0.155530 --> -0.355533).  Saving model ...
Epoch: 4 cost time: 1.3855624198913574
Epoch: 4, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.004 Vali Acc: 0.511 Test Loss: 2.004 Test Acc: 0.511
Validation loss decreased (-0.355533 --> -0.511091).  Saving model ...
Epoch: 5 cost time: 1.430532693862915
Epoch: 5, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.778 Vali Acc: 0.572 Test Loss: 1.778 Test Acc: 0.572
Validation loss decreased (-0.511091 --> -0.572204).  Saving model ...
Epoch: 6 cost time: 1.4326601028442383
Epoch: 6, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.596 Vali Acc: 0.633 Test Loss: 1.596 Test Acc: 0.633
Validation loss decreased (-0.572204 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.536207675933838
Epoch: 7, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.439 Vali Acc: 0.683 Test Loss: 1.439 Test Acc: 0.683
Validation loss decreased (-0.633317 --> -0.683319).  Saving model ...
Epoch: 8 cost time: 1.3224921226501465
Epoch: 8, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.315 Vali Acc: 0.689 Test Loss: 1.315 Test Acc: 0.689
Validation loss decreased (-0.683319 --> -0.688876).  Saving model ...
Epoch: 9 cost time: 1.4146842956542969
Epoch: 9, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.229 Vali Acc: 0.683 Test Loss: 1.229 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3072104454040527
Epoch: 10, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.147 Vali Acc: 0.700 Test Loss: 1.147 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 1.2397241592407227
Epoch: 11, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.073 Vali Acc: 0.711 Test Loss: 1.073 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 1.2715497016906738
Epoch: 12, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.711100 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.224839687347412
Epoch: 13, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.932 Vali Acc: 0.744 Test Loss: 0.932 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.352506399154663
Epoch: 14, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.880 Vali Acc: 0.772 Test Loss: 0.880 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 1.411417007446289
Epoch: 15, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.3171436786651611
Epoch: 16, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.802 Vali Acc: 0.811 Test Loss: 0.802 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 1.2210681438446045
Epoch: 17, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.774 Vali Acc: 0.806 Test Loss: 0.774 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2813663482666016
Epoch: 18, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.4719648361206055
Epoch: 19, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.5093965530395508
Epoch: 20, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.4084997177124023
Epoch: 21, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.4147367477416992
Epoch: 22, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.2101550102233887
Epoch: 23, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.358236312866211
Epoch: 24, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.579 Vali Acc: 0.817 Test Loss: 0.579 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.266998291015625
Epoch: 25, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 1.1617705821990967
Epoch: 26, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2217047214508057
Epoch: 27, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.1607890129089355
Epoch: 28, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 1.279764175415039
Epoch: 29, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3194468021392822
Epoch: 30, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.399040937423706
Epoch: 31, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 1.2759389877319336
Epoch: 32, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.2595503330230713
Epoch: 33, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4116339683532715
Epoch: 34, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4393377304077148
Epoch: 35, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4820144176483154
Epoch: 36, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4140410423278809
Epoch: 37, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 38 cost time: 1.5043718814849854
Epoch: 38, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4007046222686768
Epoch: 39, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.331606149673462
Epoch: 40, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3421471118927002
Epoch: 41, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 42 cost time: 1.281118631362915
Epoch: 42, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1936168670654297
Epoch: 43, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0709617137908936
Epoch: 44, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1048932075500488
Epoch: 45, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.187976360321045
Epoch: 46, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1880958080291748
Epoch: 47, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3354077339172363
Epoch: 48, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2826175689697266
Epoch: 49, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3738844394683838
Epoch: 50, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3121709823608398
Epoch: 51, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 288991
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7024803161621094
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.638 Vali Acc: 0.061 Test Loss: 2.638 Test Acc: 0.061
Validation loss decreased (inf --> -0.061085).  Saving model ...
Epoch: 2 cost time: 1.5435829162597656
Epoch: 2, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.439 Vali Acc: 0.194 Test Loss: 2.439 Test Acc: 0.194
Validation loss decreased (-0.061085 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 1.4087255001068115
Epoch: 3, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.210 Vali Acc: 0.422 Test Loss: 2.210 Test Acc: 0.422
Validation loss decreased (-0.194420 --> -0.422200).  Saving model ...
Epoch: 4 cost time: 1.3520197868347168
Epoch: 4, Steps: 12 | Train Loss: 2.120 Vali Loss: 1.989 Vali Acc: 0.511 Test Loss: 1.989 Test Acc: 0.511
Validation loss decreased (-0.422200 --> -0.511091).  Saving model ...
Epoch: 5 cost time: 1.458195686340332
Epoch: 5, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.788 Vali Acc: 0.589 Test Loss: 1.788 Test Acc: 0.589
Validation loss decreased (-0.511091 --> -0.588871).  Saving model ...
Epoch: 6 cost time: 1.3296310901641846
Epoch: 6, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.618 Vali Acc: 0.639 Test Loss: 1.618 Test Acc: 0.639
Validation loss decreased (-0.588871 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 1.3934121131896973
Epoch: 7, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.478 Vali Acc: 0.694 Test Loss: 1.478 Test Acc: 0.694
Validation loss decreased (-0.638873 --> -0.694430).  Saving model ...
Epoch: 8 cost time: 1.5202736854553223
Epoch: 8, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.365 Vali Acc: 0.706 Test Loss: 1.365 Test Acc: 0.706
Validation loss decreased (-0.694430 --> -0.705542).  Saving model ...
Epoch: 9 cost time: 1.3482568264007568
Epoch: 9, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.236 Vali Acc: 0.722 Test Loss: 1.236 Test Acc: 0.722
Validation loss decreased (-0.705542 --> -0.722210).  Saving model ...
Epoch: 10 cost time: 1.4254374504089355
Epoch: 10, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.157 Vali Acc: 0.733 Test Loss: 1.157 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.3703908920288086
Epoch: 11, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.085 Vali Acc: 0.744 Test Loss: 1.085 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.4654688835144043
Epoch: 12, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.029 Vali Acc: 0.739 Test Loss: 1.029 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2748541831970215
Epoch: 13, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.978 Vali Acc: 0.756 Test Loss: 0.978 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.3888685703277588
Epoch: 14, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.936 Vali Acc: 0.756 Test Loss: 0.936 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 1.4193713665008545
Epoch: 15, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.877 Vali Acc: 0.767 Test Loss: 0.877 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 16 cost time: 1.515165090560913
Epoch: 16, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.833 Vali Acc: 0.783 Test Loss: 0.833 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.3493719100952148
Epoch: 17, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.822 Vali Acc: 0.794 Test Loss: 0.822 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 1.5224823951721191
Epoch: 18, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.785 Vali Acc: 0.806 Test Loss: 0.785 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.4402685165405273
Epoch: 19, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.756 Vali Acc: 0.817 Test Loss: 0.756 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.5305063724517822
Epoch: 20, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1854074001312256
Epoch: 21, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.8169400691986084
Epoch: 22, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.441359043121338
Epoch: 23, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.5459129810333252
Epoch: 24, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 1.5406734943389893
Epoch: 25, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5888948440551758
Epoch: 26, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.2834978103637695
Epoch: 27, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4033498764038086
Epoch: 28, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 1.5533998012542725
Epoch: 29, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.3529059886932373
Epoch: 30, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4311299324035645
Epoch: 31, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3575987815856934
Epoch: 32, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4516308307647705
Epoch: 33, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8006055355072021
Epoch: 34, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3303906917572021
Epoch: 35, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2241449356079102
Epoch: 36, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 1.2849442958831787
Epoch: 37, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4530665874481201
Epoch: 38, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4667396545410156
Epoch: 39, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6171839237213135
Epoch: 40, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4555566310882568
Epoch: 41, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5938730239868164
Epoch: 42, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 43 cost time: 1.497730016708374
Epoch: 43, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5096302032470703
Epoch: 44, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4763195514678955
Epoch: 45, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4638354778289795
Epoch: 46, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5666048526763916
Epoch: 47, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.7017841339111328
Epoch: 48, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.6945624351501465
Epoch: 49, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3965060710906982
Epoch: 50, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.4377050399780273
Epoch: 51, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.498823642730713
Epoch: 52, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 157919
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.485280752182007
Epoch: 1, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.634 Vali Acc: 0.078 Test Loss: 2.634 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.3793020248413086
Epoch: 2, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.435 Vali Acc: 0.178 Test Loss: 2.435 Test Acc: 0.178
Validation loss decreased (-0.077751 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 1.3754727840423584
Epoch: 3, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.209 Vali Acc: 0.411 Test Loss: 2.209 Test Acc: 0.411
Validation loss decreased (-0.177753 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 1.4258942604064941
Epoch: 4, Steps: 12 | Train Loss: 2.131 Vali Loss: 1.991 Vali Acc: 0.483 Test Loss: 1.991 Test Acc: 0.483
Validation loss decreased (-0.411089 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 1.4101693630218506
Epoch: 5, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.791 Vali Acc: 0.589 Test Loss: 1.791 Test Acc: 0.589
Validation loss decreased (-0.483313 --> -0.588871).  Saving model ...
Epoch: 6 cost time: 1.3957338333129883
Epoch: 6, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.624 Vali Acc: 0.622 Test Loss: 1.624 Test Acc: 0.622
Validation loss decreased (-0.588871 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 1.486863374710083
Epoch: 7, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.482 Vali Acc: 0.672 Test Loss: 1.482 Test Acc: 0.672
Validation loss decreased (-0.622206 --> -0.672207).  Saving model ...
Epoch: 8 cost time: 1.2513720989227295
Epoch: 8, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.365 Vali Acc: 0.672 Test Loss: 1.365 Test Acc: 0.672
Validation loss decreased (-0.672207 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 1.315605640411377
Epoch: 9, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.235 Vali Acc: 0.722 Test Loss: 1.235 Test Acc: 0.722
Validation loss decreased (-0.672209 --> -0.722210).  Saving model ...
Epoch: 10 cost time: 1.3000187873840332
Epoch: 10, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.156 Vali Acc: 0.728 Test Loss: 1.156 Test Acc: 0.728
Validation loss decreased (-0.722210 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.2139949798583984
Epoch: 11, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 1.2940707206726074
Epoch: 12, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.029 Vali Acc: 0.733 Test Loss: 1.029 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 1.2828283309936523
Epoch: 13, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.978 Vali Acc: 0.767 Test Loss: 0.978 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 1.1234097480773926
Epoch: 14, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5448696613311768
Epoch: 15, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
Validation loss decreased (-0.766657 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.4065375328063965
Epoch: 16, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.835 Vali Acc: 0.794 Test Loss: 0.835 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 17 cost time: 1.360337734222412
Epoch: 17, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.826 Vali Acc: 0.794 Test Loss: 0.826 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 1.3137662410736084
Epoch: 18, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.789 Vali Acc: 0.806 Test Loss: 0.789 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.498115062713623
Epoch: 19, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.758 Vali Acc: 0.817 Test Loss: 0.758 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.4323089122772217
Epoch: 20, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.723 Vali Acc: 0.817 Test Loss: 0.723 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 1.4507255554199219
Epoch: 21, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.731 Vali Acc: 0.822 Test Loss: 0.731 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.4357070922851562
Epoch: 22, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.4531776905059814
Epoch: 23, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5834062099456787
Epoch: 24, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.53102445602417
Epoch: 25, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 1.3313989639282227
Epoch: 26, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4111933708190918
Epoch: 27, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4393491744995117
Epoch: 28, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 1.4648468494415283
Epoch: 29, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 1.3300838470458984
Epoch: 30, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4922378063201904
Epoch: 31, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4557578563690186
Epoch: 32, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 1.3790416717529297
Epoch: 33, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 34 cost time: 1.200230360031128
Epoch: 34, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3419122695922852
Epoch: 35, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 1.362642526626587
Epoch: 36, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.491117000579834
Epoch: 37, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4384260177612305
Epoch: 38, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4810199737548828
Epoch: 39, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4094231128692627
Epoch: 40, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.345670223236084
Epoch: 41, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2860357761383057
Epoch: 42, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 43 cost time: 1.3055038452148438
Epoch: 43, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 1.2804605960845947
Epoch: 44, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2637848854064941
Epoch: 45, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4132027626037598
Epoch: 46, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 47 cost time: 1.3224711418151855
Epoch: 47, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3577392101287842
Epoch: 48, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4182398319244385
Epoch: 49, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2318580150604248
Epoch: 50, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.3821215629577637
Epoch: 51, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.393615484237671
Epoch: 52, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3298017978668213
Epoch: 53, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2413177490234375
Epoch: 54, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2823376655578613
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.3473434448242188
Epoch: 56, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 157919
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4789962768554688
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.648 Vali Acc: 0.050 Test Loss: 2.648 Test Acc: 0.050
Validation loss decreased (inf --> -0.049974).  Saving model ...
Epoch: 2 cost time: 1.2462868690490723
Epoch: 2, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.450 Vali Acc: 0.183 Test Loss: 2.450 Test Acc: 0.183
Validation loss decreased (-0.049974 --> -0.183309).  Saving model ...
Epoch: 3 cost time: 1.3385117053985596
Epoch: 3, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.222 Vali Acc: 0.383 Test Loss: 2.222 Test Acc: 0.383
Validation loss decreased (-0.183309 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 1.2671093940734863
Epoch: 4, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.001 Vali Acc: 0.500 Test Loss: 2.001 Test Acc: 0.500
Validation loss decreased (-0.383311 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 1.1888532638549805
Epoch: 5, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.799 Vali Acc: 0.572 Test Loss: 1.799 Test Acc: 0.572
Validation loss decreased (-0.499980 --> -0.572204).  Saving model ...
Epoch: 6 cost time: 1.2000598907470703
Epoch: 6, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.627 Vali Acc: 0.633 Test Loss: 1.627 Test Acc: 0.633
Validation loss decreased (-0.572204 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.355463981628418
Epoch: 7, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.486 Vali Acc: 0.656 Test Loss: 1.486 Test Acc: 0.656
Validation loss decreased (-0.633317 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 1.3788201808929443
Epoch: 8, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.373 Vali Acc: 0.683 Test Loss: 1.373 Test Acc: 0.683
Validation loss decreased (-0.655541 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.378307819366455
Epoch: 9, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.244 Vali Acc: 0.733 Test Loss: 1.244 Test Acc: 0.733
Validation loss decreased (-0.683320 --> -0.733321).  Saving model ...
Epoch: 10 cost time: 1.3811228275299072
Epoch: 10, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.165 Vali Acc: 0.733 Test Loss: 1.165 Test Acc: 0.733
Validation loss decreased (-0.733321 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.301206111907959
Epoch: 11, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.096 Vali Acc: 0.728 Test Loss: 1.096 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.285461664199829
Epoch: 12, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.042 Vali Acc: 0.717 Test Loss: 1.042 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1326112747192383
Epoch: 13, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.992 Vali Acc: 0.739 Test Loss: 0.992 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738879).  Saving model ...
Epoch: 14 cost time: 1.2315382957458496
Epoch: 14, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.951 Vali Acc: 0.744 Test Loss: 0.951 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.2108564376831055
Epoch: 15, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.889 Vali Acc: 0.778 Test Loss: 0.889 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.3745434284210205
Epoch: 16, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.850 Vali Acc: 0.783 Test Loss: 0.850 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.3138463497161865
Epoch: 17, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 1.2265958786010742
Epoch: 18, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
Validation loss decreased (-0.794436 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 1.3293471336364746
Epoch: 19, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 1.4065732955932617
Epoch: 20, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.434596061706543
Epoch: 21, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5375261306762695
Epoch: 22, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.695 Vali Acc: 0.822 Test Loss: 0.695 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1642394065856934
Epoch: 23, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.377791404724121
Epoch: 24, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.3238301277160645
Epoch: 25, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 1.3830878734588623
Epoch: 26, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5690696239471436
Epoch: 27, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4758353233337402
Epoch: 28, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.4595239162445068
Epoch: 29, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 1.2709059715270996
Epoch: 30, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3232369422912598
Epoch: 31, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.316659927368164
Epoch: 32, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.4066026210784912
Epoch: 33, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3132116794586182
Epoch: 34, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2129395008087158
Epoch: 35, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2422525882720947
Epoch: 36, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 37 cost time: 1.3061165809631348
Epoch: 37, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4194927215576172
Epoch: 38, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3056607246398926
Epoch: 39, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3861784934997559
Epoch: 40, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5527679920196533
Epoch: 41, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4295027256011963
Epoch: 42, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3077178001403809
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3858911991119385
Epoch: 44, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.424720287322998
Epoch: 45, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3552954196929932
Epoch: 46, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 47 cost time: 1.4215121269226074
Epoch: 47, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.263434648513794
Epoch: 48, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3648622035980225
Epoch: 49, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2743475437164307
Epoch: 50, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.412053108215332
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.3845653533935547
Epoch: 52, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.4082741737365723
Epoch: 53, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2559688091278076
Epoch: 54, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.3411295413970947
Epoch: 55, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.27933669090271
Epoch: 56, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 157919
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.90606689453125
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.649 Vali Acc: 0.072 Test Loss: 2.649 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 1.4144213199615479
Epoch: 2, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.449 Vali Acc: 0.183 Test Loss: 2.449 Test Acc: 0.183
Validation loss decreased (-0.072196 --> -0.183309).  Saving model ...
Epoch: 3 cost time: 1.257047176361084
Epoch: 3, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.218 Vali Acc: 0.389 Test Loss: 2.218 Test Acc: 0.389
Validation loss decreased (-0.183309 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 1.315709114074707
Epoch: 4, Steps: 12 | Train Loss: 2.123 Vali Loss: 1.991 Vali Acc: 0.467 Test Loss: 1.991 Test Acc: 0.467
Validation loss decreased (-0.388867 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 1.1757919788360596
Epoch: 5, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.785 Vali Acc: 0.561 Test Loss: 1.785 Test Acc: 0.561
Validation loss decreased (-0.466647 --> -0.561093).  Saving model ...
Epoch: 6 cost time: 1.3996574878692627
Epoch: 6, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.609 Vali Acc: 0.600 Test Loss: 1.609 Test Acc: 0.600
Validation loss decreased (-0.561093 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 1.3068461418151855
Epoch: 7, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.466 Vali Acc: 0.650 Test Loss: 1.466 Test Acc: 0.650
Validation loss decreased (-0.599984 --> -0.649985).  Saving model ...
Epoch: 8 cost time: 1.307617425918579
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.356 Vali Acc: 0.683 Test Loss: 1.356 Test Acc: 0.683
Validation loss decreased (-0.649985 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.3218300342559814
Epoch: 9, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.227 Vali Acc: 0.728 Test Loss: 1.227 Test Acc: 0.728
Validation loss decreased (-0.683320 --> -0.727766).  Saving model ...
Epoch: 10 cost time: 1.3444817066192627
Epoch: 10, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3751051425933838
Epoch: 11, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4206273555755615
Epoch: 12, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.015 Vali Acc: 0.711 Test Loss: 1.015 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1175353527069092
Epoch: 13, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.962 Vali Acc: 0.739 Test Loss: 0.962 Test Acc: 0.739
Validation loss decreased (-0.727766 --> -0.738879).  Saving model ...
Epoch: 14 cost time: 1.2229254245758057
Epoch: 14, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.2311787605285645
Epoch: 15, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.852 Vali Acc: 0.789 Test Loss: 0.852 Test Acc: 0.789
Validation loss decreased (-0.749991 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.3895738124847412
Epoch: 16, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.802 Vali Acc: 0.811 Test Loss: 0.802 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 1.5327098369598389
Epoch: 17, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4957342147827148
Epoch: 18, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.4429833889007568
Epoch: 19, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.287452220916748
Epoch: 20, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 1.5146722793579102
Epoch: 21, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 1.3582897186279297
Epoch: 22, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.39772629737854
Epoch: 23, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 1.6176488399505615
Epoch: 24, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 1.3688604831695557
Epoch: 25, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 1.4132261276245117
Epoch: 26, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 1.2739872932434082
Epoch: 27, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5387539863586426
Epoch: 28, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.3567070960998535
Epoch: 29, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.3126606941223145
Epoch: 30, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4718129634857178
Epoch: 31, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4042205810546875
Epoch: 32, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.481773853302002
Epoch: 33, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 1.313842535018921
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4888405799865723
Epoch: 35, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3005692958831787
Epoch: 36, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5538296699523926
Epoch: 37, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3571810722351074
Epoch: 38, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.487 Vali Acc: 0.883 Test Loss: 0.487 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2231359481811523
Epoch: 39, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.282130241394043
Epoch: 40, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 41 cost time: 1.2878999710083008
Epoch: 41, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3972976207733154
Epoch: 42, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.486 Vali Acc: 0.894 Test Loss: 0.486 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 43 cost time: 1.2929959297180176
Epoch: 43, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3206532001495361
Epoch: 44, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.498 Vali Acc: 0.883 Test Loss: 0.498 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3270864486694336
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3302364349365234
Epoch: 46, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3355116844177246
Epoch: 47, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.5706171989440918
Epoch: 48, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 1.3551523685455322
Epoch: 49, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3078689575195312
Epoch: 50, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4019336700439453
Epoch: 51, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.326061725616455
Epoch: 52, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.506 Vali Acc: 0.889 Test Loss: 0.506 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.407182216644287
Epoch: 53, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3648321628570557
Epoch: 54, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2888236045837402
Epoch: 55, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.2426345348358154
Epoch: 56, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.062631368637085
Epoch: 57, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.2070732116699219
Epoch: 58, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 157919
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.768285036087036
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.684 Vali Acc: 0.178 Test Loss: 2.684 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 1.3280532360076904
Epoch: 2, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.483 Vali Acc: 0.239 Test Loss: 2.483 Test Acc: 0.239
Validation loss decreased (-0.177751 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 1.368692398071289
Epoch: 3, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.249 Vali Acc: 0.328 Test Loss: 2.249 Test Acc: 0.328
Validation loss decreased (-0.238864 --> -0.327755).  Saving model ...
Epoch: 4 cost time: 1.2097959518432617
Epoch: 4, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.025 Vali Acc: 0.444 Test Loss: 2.025 Test Acc: 0.444
Validation loss decreased (-0.327755 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 1.2549376487731934
Epoch: 5, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.820 Vali Acc: 0.561 Test Loss: 1.820 Test Acc: 0.561
Validation loss decreased (-0.444424 --> -0.561093).  Saving model ...
Epoch: 6 cost time: 1.3379416465759277
Epoch: 6, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.642 Vali Acc: 0.600 Test Loss: 1.642 Test Acc: 0.600
Validation loss decreased (-0.561093 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 1.2380633354187012
Epoch: 7, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.489 Vali Acc: 0.667 Test Loss: 1.489 Test Acc: 0.667
Validation loss decreased (-0.599984 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.28440523147583
Epoch: 8, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.352 Vali Acc: 0.706 Test Loss: 1.352 Test Acc: 0.706
Validation loss decreased (-0.666652 --> -0.705542).  Saving model ...
Epoch: 9 cost time: 1.2276825904846191
Epoch: 9, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.255 Vali Acc: 0.711 Test Loss: 1.255 Test Acc: 0.711
Validation loss decreased (-0.705542 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.2638099193572998
Epoch: 10, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.152 Vali Acc: 0.733 Test Loss: 1.152 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.3017377853393555
Epoch: 11, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.086 Vali Acc: 0.728 Test Loss: 1.086 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3250298500061035
Epoch: 12, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.017 Vali Acc: 0.739 Test Loss: 1.017 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.2127463817596436
Epoch: 13, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.2619948387145996
Epoch: 14, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3092491626739502
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783324).  Saving model ...
Epoch: 16 cost time: 1.2232344150543213
Epoch: 16, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.849 Vali Acc: 0.783 Test Loss: 0.849 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.1476507186889648
Epoch: 17, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 1.2967581748962402
Epoch: 18, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.798 Vali Acc: 0.806 Test Loss: 0.798 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.395688533782959
Epoch: 19, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.554802417755127
Epoch: 20, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.3929762840270996
Epoch: 21, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.738 Vali Acc: 0.811 Test Loss: 0.738 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3286426067352295
Epoch: 22, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 23 cost time: 1.3580563068389893
Epoch: 23, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.677 Vali Acc: 0.844 Test Loss: 0.677 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 1.4234323501586914
Epoch: 24, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.4779682159423828
Epoch: 25, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2329635620117188
Epoch: 26, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3726048469543457
Epoch: 27, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.264702558517456
Epoch: 28, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 1.1869022846221924
Epoch: 29, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.417553186416626
Epoch: 30, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.4029629230499268
Epoch: 31, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 1.437680959701538
Epoch: 32, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3021292686462402
Epoch: 33, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.1514863967895508
Epoch: 34, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2960944175720215
Epoch: 35, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3989765644073486
Epoch: 36, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 1.5826475620269775
Epoch: 37, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.459754467010498
Epoch: 38, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3844776153564453
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3854951858520508
Epoch: 40, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 1.2746827602386475
Epoch: 41, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.177551031112671
Epoch: 42, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1423797607421875
Epoch: 43, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 44 cost time: 1.167975664138794
Epoch: 44, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2211530208587646
Epoch: 45, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4253740310668945
Epoch: 46, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3008198738098145
Epoch: 47, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 48 cost time: 1.273576259613037
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.268615484237671
Epoch: 49, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2516140937805176
Epoch: 50, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2858784198760986
Epoch: 51, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2402212619781494
Epoch: 52, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.4178004264831543
Epoch: 53, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3339323997497559
Epoch: 54, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.3625781536102295
Epoch: 55, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 56 cost time: 1.30832839012146
Epoch: 56, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 57 cost time: 1.4350006580352783
Epoch: 57, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4140715599060059
Epoch: 58, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.3748219013214111
Epoch: 59, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 60 cost time: 1.2099673748016357
Epoch: 60, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3080816268920898
Epoch: 61, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.3732130527496338
Epoch: 62, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.4292161464691162
Epoch: 63, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.3640830516815186
Epoch: 64, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.4724173545837402
Epoch: 65, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.586897373199463
Epoch: 66, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.318207025527954
Epoch: 67, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.250880479812622
Epoch: 68, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.3711168766021729
Epoch: 69, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 92383
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.656074047088623
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.688 Vali Acc: 0.167 Test Loss: 2.688 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 1.2318894863128662
Epoch: 2, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.488 Vali Acc: 0.244 Test Loss: 2.488 Test Acc: 0.244
Validation loss decreased (-0.166640 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 1.261716365814209
Epoch: 3, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.254 Vali Acc: 0.311 Test Loss: 2.254 Test Acc: 0.311
Validation loss decreased (-0.244420 --> -0.311089).  Saving model ...
Epoch: 4 cost time: 1.1966595649719238
Epoch: 4, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.030 Vali Acc: 0.389 Test Loss: 2.030 Test Acc: 0.389
Validation loss decreased (-0.311089 --> -0.388869).  Saving model ...
Epoch: 5 cost time: 1.3331525325775146
Epoch: 5, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.822 Vali Acc: 0.517 Test Loss: 1.822 Test Acc: 0.517
Validation loss decreased (-0.388869 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 1.4054780006408691
Epoch: 6, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.643 Vali Acc: 0.622 Test Loss: 1.643 Test Acc: 0.622
Validation loss decreased (-0.516648 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 1.2057888507843018
Epoch: 7, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.488 Vali Acc: 0.667 Test Loss: 1.488 Test Acc: 0.667
Validation loss decreased (-0.622206 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.2899024486541748
Epoch: 8, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.352 Vali Acc: 0.706 Test Loss: 1.352 Test Acc: 0.706
Validation loss decreased (-0.666652 --> -0.705542).  Saving model ...
Epoch: 9 cost time: 1.3899312019348145
Epoch: 9, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.252 Vali Acc: 0.711 Test Loss: 1.252 Test Acc: 0.711
Validation loss decreased (-0.705542 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.2093985080718994
Epoch: 10, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.151 Vali Acc: 0.728 Test Loss: 1.151 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.2880854606628418
Epoch: 11, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.086 Vali Acc: 0.722 Test Loss: 1.086 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.255415678024292
Epoch: 12, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.016 Vali Acc: 0.756 Test Loss: 1.016 Test Acc: 0.756
Validation loss decreased (-0.727766 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 1.3382008075714111
Epoch: 13, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.985 Vali Acc: 0.728 Test Loss: 0.985 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2857592105865479
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.502497673034668
Epoch: 15, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.894 Vali Acc: 0.783 Test Loss: 0.894 Test Acc: 0.783
Validation loss decreased (-0.755545 --> -0.783324).  Saving model ...
Epoch: 16 cost time: 1.4094080924987793
Epoch: 16, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.851 Vali Acc: 0.778 Test Loss: 0.851 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4823782444000244
Epoch: 17, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.822 Vali Acc: 0.789 Test Loss: 0.822 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 1.5582544803619385
Epoch: 18, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.3959174156188965
Epoch: 19, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.3536674976348877
Epoch: 20, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.733 Vali Acc: 0.817 Test Loss: 0.733 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3627467155456543
Epoch: 21, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2715818881988525
Epoch: 22, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.714 Vali Acc: 0.833 Test Loss: 0.714 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 23 cost time: 1.1977550983428955
Epoch: 23, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.680 Vali Acc: 0.839 Test Loss: 0.680 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 1.2928626537322998
Epoch: 24, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.687 Vali Acc: 0.839 Test Loss: 0.687 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2129089832305908
Epoch: 25, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3412458896636963
Epoch: 26, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 1.1540412902832031
Epoch: 27, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.5331709384918213
Epoch: 28, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.3789286613464355
Epoch: 29, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.4228343963623047
Epoch: 30, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.287651538848877
Epoch: 31, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 1.580615758895874
Epoch: 32, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.4002962112426758
Epoch: 33, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4791491031646729
Epoch: 34, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3221795558929443
Epoch: 35, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5081372261047363
Epoch: 36, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 1.400362491607666
Epoch: 37, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.450869083404541
Epoch: 38, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2171368598937988
Epoch: 39, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3451945781707764
Epoch: 40, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.317572832107544
Epoch: 41, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4463930130004883
Epoch: 42, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 43 cost time: 1.3796916007995605
Epoch: 43, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 1.5565376281738281
Epoch: 44, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5735559463500977
Epoch: 45, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3792812824249268
Epoch: 46, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3777916431427002
Epoch: 47, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3578786849975586
Epoch: 48, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4221887588500977
Epoch: 49, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.442903995513916
Epoch: 50, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4174015522003174
Epoch: 51, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3939964771270752
Epoch: 52, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.475919246673584
Epoch: 53, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 92383
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3822011947631836
Epoch: 1, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.685 Vali Acc: 0.172 Test Loss: 2.685 Test Acc: 0.172
Validation loss decreased (inf --> -0.172195).  Saving model ...
Epoch: 2 cost time: 1.3593502044677734
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.484 Vali Acc: 0.250 Test Loss: 2.484 Test Acc: 0.250
Validation loss decreased (-0.172195 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 1.1801211833953857
Epoch: 3, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.251 Vali Acc: 0.361 Test Loss: 2.251 Test Acc: 0.361
Validation loss decreased (-0.249975 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 1.2547621726989746
Epoch: 4, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.025 Vali Acc: 0.422 Test Loss: 2.025 Test Acc: 0.422
Validation loss decreased (-0.361089 --> -0.422202).  Saving model ...
Epoch: 5 cost time: 1.2111661434173584
Epoch: 5, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.814 Vali Acc: 0.550 Test Loss: 1.814 Test Acc: 0.550
Validation loss decreased (-0.422202 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.314723253250122
Epoch: 6, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.633 Vali Acc: 0.633 Test Loss: 1.633 Test Acc: 0.633
Validation loss decreased (-0.549982 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.329164981842041
Epoch: 7, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.476 Vali Acc: 0.678 Test Loss: 1.476 Test Acc: 0.678
Validation loss decreased (-0.633317 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 1.355811595916748
Epoch: 8, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.340 Vali Acc: 0.700 Test Loss: 1.340 Test Acc: 0.700
Validation loss decreased (-0.677763 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.3186404705047607
Epoch: 9, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.240 Vali Acc: 0.717 Test Loss: 1.240 Test Acc: 0.717
Validation loss decreased (-0.699987 --> -0.716654).  Saving model ...
Epoch: 10 cost time: 1.375680685043335
Epoch: 10, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.140 Vali Acc: 0.739 Test Loss: 1.140 Test Acc: 0.739
Validation loss decreased (-0.716654 --> -0.738877).  Saving model ...
Epoch: 11 cost time: 1.3517818450927734
Epoch: 11, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.072 Vali Acc: 0.728 Test Loss: 1.072 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.254312515258789
Epoch: 12, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
Validation loss decreased (-0.738877 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 1.299905776977539
Epoch: 13, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4810199737548828
Epoch: 14, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.918 Vali Acc: 0.744 Test Loss: 0.918 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2716491222381592
Epoch: 15, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.4548375606536865
Epoch: 16, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.1728038787841797
Epoch: 17, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.805 Vali Acc: 0.806 Test Loss: 0.805 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 1.2483055591583252
Epoch: 18, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.783 Vali Acc: 0.806 Test Loss: 0.783 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.1971948146820068
Epoch: 19, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.752 Vali Acc: 0.822 Test Loss: 0.752 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.3408503532409668
Epoch: 20, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.278174877166748
Epoch: 21, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.722 Vali Acc: 0.811 Test Loss: 0.722 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.29976487159729
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.1817843914031982
Epoch: 23, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.2217128276824951
Epoch: 24, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 1.162797212600708
Epoch: 25, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2325093746185303
Epoch: 26, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.2640316486358643
Epoch: 27, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.279005765914917
Epoch: 28, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1255154609680176
Epoch: 29, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 1.3570075035095215
Epoch: 30, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.3218297958374023
Epoch: 31, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 1.4933128356933594
Epoch: 32, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.357832670211792
Epoch: 33, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2883100509643555
Epoch: 34, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3601016998291016
Epoch: 35, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.32291579246521
Epoch: 36, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.268019676208496
Epoch: 37, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3477575778961182
Epoch: 38, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.291926383972168
Epoch: 39, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3552327156066895
Epoch: 40, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3349437713623047
Epoch: 41, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 92383
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2021822929382324
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.688 Vali Acc: 0.167 Test Loss: 2.688 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 1.2314047813415527
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.490 Vali Acc: 0.267 Test Loss: 2.490 Test Acc: 0.267
Validation loss decreased (-0.166640 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 1.093503475189209
Epoch: 3, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.261 Vali Acc: 0.317 Test Loss: 2.261 Test Acc: 0.317
Validation loss decreased (-0.266642 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 1.2694108486175537
Epoch: 4, Steps: 12 | Train Loss: 2.137 Vali Loss: 2.035 Vali Acc: 0.428 Test Loss: 2.035 Test Acc: 0.428
Validation loss decreased (-0.316644 --> -0.427757).  Saving model ...
Epoch: 5 cost time: 1.3041906356811523
Epoch: 5, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.823 Vali Acc: 0.556 Test Loss: 1.823 Test Acc: 0.556
Validation loss decreased (-0.427757 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 1.2635838985443115
Epoch: 6, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.640 Vali Acc: 0.617 Test Loss: 1.640 Test Acc: 0.617
Validation loss decreased (-0.555537 --> -0.616650).  Saving model ...
Epoch: 7 cost time: 1.2893834114074707
Epoch: 7, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.482 Vali Acc: 0.667 Test Loss: 1.482 Test Acc: 0.667
Validation loss decreased (-0.616650 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.2496733665466309
Epoch: 8, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.348 Vali Acc: 0.683 Test Loss: 1.348 Test Acc: 0.683
Validation loss decreased (-0.666652 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.2363369464874268
Epoch: 9, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.246 Vali Acc: 0.694 Test Loss: 1.246 Test Acc: 0.694
Validation loss decreased (-0.683320 --> -0.694432).  Saving model ...
Epoch: 10 cost time: 1.1320469379425049
Epoch: 10, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.149 Vali Acc: 0.711 Test Loss: 1.149 Test Acc: 0.711
Validation loss decreased (-0.694432 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.279146671295166
Epoch: 11, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.081 Vali Acc: 0.717 Test Loss: 1.081 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716656).  Saving model ...
Epoch: 12 cost time: 1.2632765769958496
Epoch: 12, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.1761386394500732
Epoch: 13, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.973 Vali Acc: 0.739 Test Loss: 0.973 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 14 cost time: 1.2315380573272705
Epoch: 14, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.920 Vali Acc: 0.767 Test Loss: 0.920 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 1.1931343078613281
Epoch: 15, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.877 Vali Acc: 0.783 Test Loss: 0.877 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.2811493873596191
Epoch: 16, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.1238734722137451
Epoch: 17, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.789 Vali Acc: 0.811 Test Loss: 0.789 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.289360523223877
Epoch: 18, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.769 Vali Acc: 0.817 Test Loss: 0.769 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.2988109588623047
Epoch: 19, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.750 Vali Acc: 0.822 Test Loss: 0.750 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.1741595268249512
Epoch: 20, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2735376358032227
Epoch: 21, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 1.267204761505127
Epoch: 22, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.2754020690917969
Epoch: 23, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2808284759521484
Epoch: 24, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.1886062622070312
Epoch: 25, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0905444622039795
Epoch: 26, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.425743818283081
Epoch: 27, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3818798065185547
Epoch: 28, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2241852283477783
Epoch: 29, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 1.3565845489501953
Epoch: 30, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 1.2722177505493164
Epoch: 31, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 32 cost time: 1.0668363571166992
Epoch: 32, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.172947883605957
Epoch: 33, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 1.2763235569000244
Epoch: 34, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 1.3727898597717285
Epoch: 35, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2849225997924805
Epoch: 36, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 1.2598261833190918
Epoch: 37, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.128873586654663
Epoch: 38, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2897920608520508
Epoch: 39, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3206512928009033
Epoch: 40, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 1.2406034469604492
Epoch: 41, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 1.310866355895996
Epoch: 42, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4543898105621338
Epoch: 43, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 44 cost time: 1.5845274925231934
Epoch: 44, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1999988555908203
Epoch: 45, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3440115451812744
Epoch: 46, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3379671573638916
Epoch: 47, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3148257732391357
Epoch: 48, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3044559955596924
Epoch: 49, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1737422943115234
Epoch: 50, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2662816047668457
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4147279262542725
Epoch: 52, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.2518131732940674
Epoch: 53, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 92383
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7742831707000732
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.700 Vali Acc: 0.078 Test Loss: 2.700 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.416992425918579
Epoch: 2, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.507 Vali Acc: 0.228 Test Loss: 2.507 Test Acc: 0.228
Validation loss decreased (-0.077751 --> -0.227753).  Saving model ...
Epoch: 3 cost time: 1.405038833618164
Epoch: 3, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.284 Vali Acc: 0.306 Test Loss: 2.284 Test Acc: 0.306
Validation loss decreased (-0.227753 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 1.3274824619293213
Epoch: 4, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.074 Vali Acc: 0.378 Test Loss: 2.074 Test Acc: 0.378
Validation loss decreased (-0.305533 --> -0.377757).  Saving model ...
Epoch: 5 cost time: 1.328782320022583
Epoch: 5, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.872 Vali Acc: 0.439 Test Loss: 1.872 Test Acc: 0.439
Validation loss decreased (-0.377757 --> -0.438870).  Saving model ...
Epoch: 6 cost time: 1.3709948062896729
Epoch: 6, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.690 Vali Acc: 0.556 Test Loss: 1.690 Test Acc: 0.556
Validation loss decreased (-0.438870 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 1.6110241413116455
Epoch: 7, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.559 Vali Acc: 0.628 Test Loss: 1.559 Test Acc: 0.628
Validation loss decreased (-0.555539 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 1.4642271995544434
Epoch: 8, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.429 Vali Acc: 0.639 Test Loss: 1.429 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638875).  Saving model ...
Epoch: 9 cost time: 1.3867685794830322
Epoch: 9, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.323 Vali Acc: 0.656 Test Loss: 1.323 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 1.4542009830474854
Epoch: 10, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.226 Vali Acc: 0.689 Test Loss: 1.226 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 1.3403539657592773
Epoch: 11, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.160 Vali Acc: 0.683 Test Loss: 1.160 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4762609004974365
Epoch: 12, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.082 Vali Acc: 0.711 Test Loss: 1.082 Test Acc: 0.711
Validation loss decreased (-0.688877 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 1.446842908859253
Epoch: 13, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 1.460418939590454
Epoch: 14, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.981 Vali Acc: 0.728 Test Loss: 0.981 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 1.6509604454040527
Epoch: 15, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.528385877609253
Epoch: 16, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 1.4661190509796143
Epoch: 17, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.867 Vali Acc: 0.789 Test Loss: 0.867 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788880).  Saving model ...
Epoch: 18 cost time: 1.4286284446716309
Epoch: 18, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.846 Vali Acc: 0.806 Test Loss: 0.846 Test Acc: 0.806
Validation loss decreased (-0.788880 --> -0.805547).  Saving model ...
Epoch: 19 cost time: 1.4349515438079834
Epoch: 19, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.818 Vali Acc: 0.811 Test Loss: 0.818 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.225921630859375
Epoch: 20, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.779 Vali Acc: 0.811 Test Loss: 0.779 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 21 cost time: 1.2034108638763428
Epoch: 21, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.734 Vali Acc: 0.828 Test Loss: 0.734 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827770).  Saving model ...
Epoch: 22 cost time: 1.3023326396942139
Epoch: 22, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.727 Vali Acc: 0.822 Test Loss: 0.727 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4890422821044922
Epoch: 23, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.726 Vali Acc: 0.811 Test Loss: 0.726 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3867712020874023
Epoch: 24, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.718 Vali Acc: 0.817 Test Loss: 0.718 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.427739143371582
Epoch: 25, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4544737339019775
Epoch: 26, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 1.4142100811004639
Epoch: 27, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.3539485931396484
Epoch: 28, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.4078340530395508
Epoch: 29, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 1.3862335681915283
Epoch: 30, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.4667387008666992
Epoch: 31, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 1.491579532623291
Epoch: 32, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.484572410583496
Epoch: 33, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3128564357757568
Epoch: 34, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 1.1752424240112305
Epoch: 35, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2773265838623047
Epoch: 36, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3386964797973633
Epoch: 37, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2575409412384033
Epoch: 38, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2731173038482666
Epoch: 39, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4202823638916016
Epoch: 40, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.335108757019043
Epoch: 41, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.371516227722168
Epoch: 42, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3103599548339844
Epoch: 43, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2418797016143799
Epoch: 44, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 59615
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7421276569366455
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.710 Vali Acc: 0.061 Test Loss: 2.710 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.3626792430877686
Epoch: 2, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.516 Vali Acc: 0.211 Test Loss: 2.516 Test Acc: 0.211
Validation loss decreased (-0.061084 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 1.2079920768737793
Epoch: 3, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.292 Vali Acc: 0.333 Test Loss: 2.292 Test Acc: 0.333
Validation loss decreased (-0.211086 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 1.131385087966919
Epoch: 4, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.079 Vali Acc: 0.417 Test Loss: 2.079 Test Acc: 0.417
Validation loss decreased (-0.333310 --> -0.416646).  Saving model ...
Epoch: 5 cost time: 1.3392717838287354
Epoch: 5, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.876 Vali Acc: 0.456 Test Loss: 1.876 Test Acc: 0.456
Validation loss decreased (-0.416646 --> -0.455537).  Saving model ...
Epoch: 6 cost time: 1.1762948036193848
Epoch: 6, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.692 Vali Acc: 0.567 Test Loss: 1.692 Test Acc: 0.567
Validation loss decreased (-0.455537 --> -0.566650).  Saving model ...
Epoch: 7 cost time: 1.2198677062988281
Epoch: 7, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.559 Vali Acc: 0.622 Test Loss: 1.559 Test Acc: 0.622
Validation loss decreased (-0.566650 --> -0.622207).  Saving model ...
Epoch: 8 cost time: 1.289243459701538
Epoch: 8, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.426 Vali Acc: 0.661 Test Loss: 1.426 Test Acc: 0.661
Validation loss decreased (-0.622207 --> -0.661097).  Saving model ...
Epoch: 9 cost time: 1.3052432537078857
Epoch: 9, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.319 Vali Acc: 0.678 Test Loss: 1.319 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 1.3491721153259277
Epoch: 10, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.221 Vali Acc: 0.689 Test Loss: 1.221 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 1.352285623550415
Epoch: 11, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.152 Vali Acc: 0.706 Test Loss: 1.152 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 1.3276705741882324
Epoch: 12, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.079 Vali Acc: 0.728 Test Loss: 1.079 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 1.4767484664916992
Epoch: 13, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.031 Vali Acc: 0.728 Test Loss: 1.031 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 1.297703504562378
Epoch: 14, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.978 Vali Acc: 0.744 Test Loss: 0.978 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.402613878250122
Epoch: 15, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.934 Vali Acc: 0.756 Test Loss: 0.934 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 1.299227237701416
Epoch: 16, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.899 Vali Acc: 0.772 Test Loss: 0.899 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 1.3604321479797363
Epoch: 17, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.865 Vali Acc: 0.783 Test Loss: 0.865 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 1.211954116821289
Epoch: 18, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.842 Vali Acc: 0.817 Test Loss: 0.842 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816658).  Saving model ...
Epoch: 19 cost time: 1.1399569511413574
Epoch: 19, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.818 Vali Acc: 0.817 Test Loss: 0.818 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816658).  Saving model ...
Epoch: 20 cost time: 1.1660325527191162
Epoch: 20, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.779 Vali Acc: 0.811 Test Loss: 0.779 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3036975860595703
Epoch: 21, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
Validation loss decreased (-0.816658 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.1056532859802246
Epoch: 22, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 1.2151193618774414
Epoch: 23, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 1.1927692890167236
Epoch: 24, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.283029556274414
Epoch: 25, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 26 cost time: 1.1891109943389893
Epoch: 26, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 27 cost time: 1.285355567932129
Epoch: 27, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 28 cost time: 1.3111252784729004
Epoch: 28, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 1.2148363590240479
Epoch: 29, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 1.273895263671875
Epoch: 30, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2979557514190674
Epoch: 31, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 1.4113507270812988
Epoch: 32, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.358947992324829
Epoch: 33, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3082387447357178
Epoch: 34, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4387452602386475
Epoch: 35, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2153370380401611
Epoch: 36, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2369987964630127
Epoch: 37, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2798845767974854
Epoch: 38, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.410707712173462
Epoch: 39, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.728381633758545
Epoch: 40, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.298816204071045
Epoch: 41, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 59615
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3509223461151123
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.712 Vali Acc: 0.067 Test Loss: 2.712 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 1.274021863937378
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.517 Vali Acc: 0.200 Test Loss: 2.517 Test Acc: 0.200
Validation loss decreased (-0.066640 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 1.281822681427002
Epoch: 3, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.292 Vali Acc: 0.317 Test Loss: 2.292 Test Acc: 0.317
Validation loss decreased (-0.199975 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 1.0106067657470703
Epoch: 4, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.073 Vali Acc: 0.394 Test Loss: 2.073 Test Acc: 0.394
Validation loss decreased (-0.316644 --> -0.394424).  Saving model ...
Epoch: 5 cost time: 1.171321153640747
Epoch: 5, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.867 Vali Acc: 0.433 Test Loss: 1.867 Test Acc: 0.433
Validation loss decreased (-0.394424 --> -0.433315).  Saving model ...
Epoch: 6 cost time: 1.3904151916503906
Epoch: 6, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.684 Vali Acc: 0.528 Test Loss: 1.684 Test Acc: 0.528
Validation loss decreased (-0.433315 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 1.2537119388580322
Epoch: 7, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.551 Vali Acc: 0.611 Test Loss: 1.551 Test Acc: 0.611
Validation loss decreased (-0.527761 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 1.271456241607666
Epoch: 8, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.421 Vali Acc: 0.650 Test Loss: 1.421 Test Acc: 0.650
Validation loss decreased (-0.611096 --> -0.649986).  Saving model ...
Epoch: 9 cost time: 1.2404890060424805
Epoch: 9, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.310 Vali Acc: 0.667 Test Loss: 1.310 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666654).  Saving model ...
Epoch: 10 cost time: 1.305673599243164
Epoch: 10, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.215 Vali Acc: 0.678 Test Loss: 1.215 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 11 cost time: 1.348710060119629
Epoch: 11, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.149 Vali Acc: 0.678 Test Loss: 1.149 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 1.3313746452331543
Epoch: 12, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.080 Vali Acc: 0.717 Test Loss: 1.080 Test Acc: 0.717
Validation loss decreased (-0.677766 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 1.4277997016906738
Epoch: 13, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.036 Vali Acc: 0.728 Test Loss: 1.036 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 1.5322272777557373
Epoch: 14, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.977 Vali Acc: 0.739 Test Loss: 0.977 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 1.3415107727050781
Epoch: 15, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.935 Vali Acc: 0.756 Test Loss: 0.935 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 1.3924901485443115
Epoch: 16, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.894 Vali Acc: 0.783 Test Loss: 0.894 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783324).  Saving model ...
Epoch: 17 cost time: 1.2419242858886719
Epoch: 17, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.863 Vali Acc: 0.789 Test Loss: 0.863 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788880).  Saving model ...
Epoch: 18 cost time: 1.3792955875396729
Epoch: 18, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.836 Vali Acc: 0.822 Test Loss: 0.836 Test Acc: 0.822
Validation loss decreased (-0.788880 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 1.2494785785675049
Epoch: 19, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.814 Vali Acc: 0.811 Test Loss: 0.814 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2762956619262695
Epoch: 20, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.773 Vali Acc: 0.811 Test Loss: 0.773 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3952076435089111
Epoch: 21, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3031291961669922
Epoch: 22, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.245326280593872
Epoch: 23, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.726 Vali Acc: 0.817 Test Loss: 0.726 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2077445983886719
Epoch: 24, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2188529968261719
Epoch: 25, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2635295391082764
Epoch: 26, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 1.109767198562622
Epoch: 27, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.340834379196167
Epoch: 28, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.3007469177246094
Epoch: 29, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.2363581657409668
Epoch: 30, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.288835048675537
Epoch: 31, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 1.271369218826294
Epoch: 32, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 1.3667585849761963
Epoch: 33, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 34 cost time: 1.2706429958343506
Epoch: 34, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 1.260918378829956
Epoch: 35, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.248098373413086
Epoch: 36, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2905256748199463
Epoch: 37, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1774547100067139
Epoch: 38, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 1.3376474380493164
Epoch: 39, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 40 cost time: 1.2537198066711426
Epoch: 40, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2711200714111328
Epoch: 41, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.559 Vali Acc: 0.872 Test Loss: 0.559 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 42 cost time: 1.1884796619415283
Epoch: 42, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.230696201324463
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 44 cost time: 1.3350563049316406
Epoch: 44, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 45 cost time: 1.2077794075012207
Epoch: 45, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3209936618804932
Epoch: 46, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.435621976852417
Epoch: 47, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2769775390625
Epoch: 48, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 49 cost time: 1.099501132965088
Epoch: 49, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2803966999053955
Epoch: 50, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.270132303237915
Epoch: 51, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.559 Vali Acc: 0.883 Test Loss: 0.559 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.337311029434204
Epoch: 52, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 53 cost time: 1.34293532371521
Epoch: 53, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3682143688201904
Epoch: 54, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2466843128204346
Epoch: 55, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3106145858764648
Epoch: 56, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2666847705841064
Epoch: 57, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2520484924316406
Epoch: 58, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 59 cost time: 1.2971019744873047
Epoch: 59, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4230682849884033
Epoch: 60, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3407011032104492
Epoch: 61, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.570 Vali Acc: 0.889 Test Loss: 0.570 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.267491340637207
Epoch: 62, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3418657779693604
Epoch: 63, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3703768253326416
Epoch: 64, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.561 Vali Acc: 0.883 Test Loss: 0.561 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2654216289520264
Epoch: 65, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.1350111961364746
Epoch: 66, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.591 Vali Acc: 0.883 Test Loss: 0.591 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.2303118705749512
Epoch: 67, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.566 Vali Acc: 0.883 Test Loss: 0.566 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.253509521484375
Epoch: 68, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 59615
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2922580242156982
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.720 Vali Acc: 0.067 Test Loss: 2.720 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.4144272804260254
Epoch: 2, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.526 Vali Acc: 0.156 Test Loss: 2.526 Test Acc: 0.156
Validation loss decreased (-0.066639 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.3796186447143555
Epoch: 3, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.299 Vali Acc: 0.378 Test Loss: 2.299 Test Acc: 0.378
Validation loss decreased (-0.155530 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 1.213937759399414
Epoch: 4, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.079 Vali Acc: 0.450 Test Loss: 2.079 Test Acc: 0.450
Validation loss decreased (-0.377755 --> -0.449979).  Saving model ...
Epoch: 5 cost time: 1.2733335494995117
Epoch: 5, Steps: 12 | Train Loss: 1.925 Vali Loss: 1.870 Vali Acc: 0.461 Test Loss: 1.870 Test Acc: 0.461
Validation loss decreased (-0.449979 --> -0.461092).  Saving model ...
Epoch: 6 cost time: 1.2350592613220215
Epoch: 6, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.684 Vali Acc: 0.533 Test Loss: 1.684 Test Acc: 0.533
Validation loss decreased (-0.461092 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 1.251859188079834
Epoch: 7, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.549 Vali Acc: 0.617 Test Loss: 1.549 Test Acc: 0.617
Validation loss decreased (-0.533316 --> -0.616651).  Saving model ...
Epoch: 8 cost time: 1.2692720890045166
Epoch: 8, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.425 Vali Acc: 0.650 Test Loss: 1.425 Test Acc: 0.650
Validation loss decreased (-0.616651 --> -0.649986).  Saving model ...
Epoch: 9 cost time: 1.1221356391906738
Epoch: 9, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.317 Vali Acc: 0.656 Test Loss: 1.317 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 1.2697749137878418
Epoch: 10, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.222 Vali Acc: 0.672 Test Loss: 1.222 Test Acc: 0.672
Validation loss decreased (-0.655542 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.2074954509735107
Epoch: 11, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.150 Vali Acc: 0.667 Test Loss: 1.150 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.156020164489746
Epoch: 12, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.081 Vali Acc: 0.706 Test Loss: 1.081 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 1.2072365283966064
Epoch: 13, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.036 Vali Acc: 0.722 Test Loss: 1.036 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.2274298667907715
Epoch: 14, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 1.2327849864959717
Epoch: 15, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.926 Vali Acc: 0.778 Test Loss: 0.926 Test Acc: 0.778
Validation loss decreased (-0.722212 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.3274378776550293
Epoch: 16, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.886 Vali Acc: 0.767 Test Loss: 0.886 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2300662994384766
Epoch: 17, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.856 Vali Acc: 0.794 Test Loss: 0.856 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 1.1846463680267334
Epoch: 18, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.820 Vali Acc: 0.794 Test Loss: 0.820 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794436).  Saving model ...
Epoch: 19 cost time: 1.119422197341919
Epoch: 19, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.795 Vali Acc: 0.817 Test Loss: 0.795 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.197312593460083
Epoch: 20, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.760 Vali Acc: 0.811 Test Loss: 0.760 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2390947341918945
Epoch: 21, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.724 Vali Acc: 0.828 Test Loss: 0.724 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 1.217416524887085
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.271061658859253
Epoch: 23, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2550888061523438
Epoch: 24, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 1.2204458713531494
Epoch: 25, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.12355637550354
Epoch: 26, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.1601171493530273
Epoch: 27, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.1329247951507568
Epoch: 28, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2537174224853516
Epoch: 29, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.271440029144287
Epoch: 30, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.125901460647583
Epoch: 31, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1958723068237305
Epoch: 32, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 33 cost time: 1.2035164833068848
Epoch: 33, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 1.1432063579559326
Epoch: 34, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 1.2334539890289307
Epoch: 35, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 1.170149564743042
Epoch: 36, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.192920207977295
Epoch: 37, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 38 cost time: 1.1712565422058105
Epoch: 38, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 1.436697006225586
Epoch: 39, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2611198425292969
Epoch: 40, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2208802700042725
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2557106018066406
Epoch: 42, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.214855432510376
Epoch: 43, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 44 cost time: 1.2620868682861328
Epoch: 44, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.266822338104248
Epoch: 45, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 46 cost time: 1.2281417846679688
Epoch: 46, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2008535861968994
Epoch: 47, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.102151870727539
Epoch: 48, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.11893630027771
Epoch: 49, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 50 cost time: 1.3697316646575928
Epoch: 50, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2401349544525146
Epoch: 51, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3615615367889404
Epoch: 52, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2985646724700928
Epoch: 53, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.3447668552398682
Epoch: 54, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.3847975730895996
Epoch: 55, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.3208813667297363
Epoch: 56, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.4579823017120361
Epoch: 57, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.554337978363037
Epoch: 58, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.5143537521362305
Epoch: 59, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 59615
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.329759120941162
Epoch: 1, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.599 Vali Acc: 0.183 Test Loss: 2.599 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 1.299818515777588
Epoch: 2, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.401 Vali Acc: 0.278 Test Loss: 2.401 Test Acc: 0.278
Validation loss decreased (-0.183307 --> -0.277754).  Saving model ...
Epoch: 3 cost time: 1.2445259094238281
Epoch: 3, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.173 Vali Acc: 0.406 Test Loss: 2.173 Test Acc: 0.406
Validation loss decreased (-0.277754 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 1.3037383556365967
Epoch: 4, Steps: 12 | Train Loss: 2.041 Vali Loss: 1.954 Vali Acc: 0.478 Test Loss: 1.954 Test Acc: 0.478
Validation loss decreased (-0.405534 --> -0.477758).  Saving model ...
Epoch: 5 cost time: 1.251753807067871
Epoch: 5, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.744 Vali Acc: 0.539 Test Loss: 1.744 Test Acc: 0.539
Validation loss decreased (-0.477758 --> -0.538871).  Saving model ...
Epoch: 6 cost time: 1.3434832096099854
Epoch: 6, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.570 Vali Acc: 0.667 Test Loss: 1.570 Test Acc: 0.667
Validation loss decreased (-0.538871 --> -0.666651).  Saving model ...
Epoch: 7 cost time: 1.3641095161437988
Epoch: 7, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.422 Vali Acc: 0.700 Test Loss: 1.422 Test Acc: 0.700
Validation loss decreased (-0.666651 --> -0.699986).  Saving model ...
Epoch: 8 cost time: 1.3334548473358154
Epoch: 8, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.304 Vali Acc: 0.689 Test Loss: 1.304 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1960675716400146
Epoch: 9, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.209 Vali Acc: 0.694 Test Loss: 1.209 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.294071912765503
Epoch: 10, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
Validation loss decreased (-0.699986 --> -0.738878).  Saving model ...
Epoch: 11 cost time: 1.2653851509094238
Epoch: 11, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.049 Vali Acc: 0.744 Test Loss: 1.049 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.2940292358398438
Epoch: 12, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3841547966003418
Epoch: 13, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.941 Vali Acc: 0.739 Test Loss: 0.941 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2939562797546387
Epoch: 14, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.3085215091705322
Epoch: 15, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.860 Vali Acc: 0.778 Test Loss: 0.860 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.3537240028381348
Epoch: 16, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.1664133071899414
Epoch: 17, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.797 Vali Acc: 0.811 Test Loss: 0.797 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.1695976257324219
Epoch: 18, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1475951671600342
Epoch: 19, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.763 Vali Acc: 0.806 Test Loss: 0.763 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0908112525939941
Epoch: 20, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.724 Vali Acc: 0.822 Test Loss: 0.724 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 1.1819844245910645
Epoch: 21, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.2409627437591553
Epoch: 22, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.2824387550354004
Epoch: 23, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 1.2804148197174072
Epoch: 24, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2517719268798828
Epoch: 25, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3428354263305664
Epoch: 26, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.3157682418823242
Epoch: 27, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.2329716682434082
Epoch: 28, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.2468147277832031
Epoch: 29, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.232168436050415
Epoch: 30, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.253887414932251
Epoch: 31, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2413604259490967
Epoch: 32, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2325680255889893
Epoch: 33, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.3044674396514893
Epoch: 34, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 35 cost time: 1.1389408111572266
Epoch: 35, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1220479011535645
Epoch: 36, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.1522314548492432
Epoch: 37, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.1209723949432373
Epoch: 38, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 1.2071218490600586
Epoch: 39, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2551536560058594
Epoch: 40, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2420189380645752
Epoch: 41, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2296497821807861
Epoch: 42, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.377016305923462
Epoch: 43, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2977001667022705
Epoch: 44, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0369608402252197
Epoch: 45, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1504144668579102
Epoch: 46, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2237794399261475
Epoch: 47, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1562778949737549
Epoch: 48, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 49 cost time: 1.2372093200683594
Epoch: 49, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0780184268951416
Epoch: 50, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3442702293395996
Epoch: 51, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2078626155853271
Epoch: 52, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2621221542358398
Epoch: 53, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1522459983825684
Epoch: 54, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2062013149261475
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.3190977573394775
Epoch: 56, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.4962198734283447
Epoch: 57, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.4133954048156738
Epoch: 58, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 43231
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.35786509513855
Epoch: 1, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.610 Vali Acc: 0.167 Test Loss: 2.610 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.1939680576324463
Epoch: 2, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.411 Vali Acc: 0.272 Test Loss: 2.411 Test Acc: 0.272
Validation loss decreased (-0.166641 --> -0.272198).  Saving model ...
Epoch: 3 cost time: 1.273350477218628
Epoch: 3, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.182 Vali Acc: 0.367 Test Loss: 2.182 Test Acc: 0.367
Validation loss decreased (-0.272198 --> -0.366645).  Saving model ...
Epoch: 4 cost time: 1.1680986881256104
Epoch: 4, Steps: 12 | Train Loss: 2.042 Vali Loss: 1.959 Vali Acc: 0.467 Test Loss: 1.959 Test Acc: 0.467
Validation loss decreased (-0.366645 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 1.3008856773376465
Epoch: 5, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.748 Vali Acc: 0.539 Test Loss: 1.748 Test Acc: 0.539
Validation loss decreased (-0.466647 --> -0.538871).  Saving model ...
Epoch: 6 cost time: 1.4686450958251953
Epoch: 6, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.572 Vali Acc: 0.661 Test Loss: 1.572 Test Acc: 0.661
Validation loss decreased (-0.538871 --> -0.661095).  Saving model ...
Epoch: 7 cost time: 1.388796329498291
Epoch: 7, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.425 Vali Acc: 0.661 Test Loss: 1.425 Test Acc: 0.661
Validation loss decreased (-0.661095 --> -0.661097).  Saving model ...
Epoch: 8 cost time: 1.2618908882141113
Epoch: 8, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.306 Vali Acc: 0.672 Test Loss: 1.306 Test Acc: 0.672
Validation loss decreased (-0.661097 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 1.5195939540863037
Epoch: 9, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.211 Vali Acc: 0.689 Test Loss: 1.211 Test Acc: 0.689
Validation loss decreased (-0.672209 --> -0.688877).  Saving model ...
Epoch: 10 cost time: 1.305527687072754
Epoch: 10, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.130 Vali Acc: 0.728 Test Loss: 1.130 Test Acc: 0.728
Validation loss decreased (-0.688877 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.2717986106872559
Epoch: 11, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.054 Vali Acc: 0.739 Test Loss: 1.054 Test Acc: 0.739
Validation loss decreased (-0.727766 --> -0.738878).  Saving model ...
Epoch: 12 cost time: 1.3775365352630615
Epoch: 12, Steps: 12 | Train Loss: 0.928 Vali Loss: 0.989 Vali Acc: 0.728 Test Loss: 0.989 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.484712839126587
Epoch: 13, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.941 Vali Acc: 0.739 Test Loss: 0.941 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738879).  Saving model ...
Epoch: 14 cost time: 1.2870995998382568
Epoch: 14, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.903 Vali Acc: 0.750 Test Loss: 0.903 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.106184482574463
Epoch: 15, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.864 Vali Acc: 0.761 Test Loss: 0.864 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 16 cost time: 1.36183500289917
Epoch: 16, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.808 Vali Acc: 0.794 Test Loss: 0.808 Test Acc: 0.794
Validation loss decreased (-0.761102 --> -0.794436).  Saving model ...
Epoch: 17 cost time: 1.3699047565460205
Epoch: 17, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.797 Vali Acc: 0.806 Test Loss: 0.797 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 1.347851276397705
Epoch: 18, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.789 Vali Acc: 0.806 Test Loss: 0.789 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.307025671005249
Epoch: 19, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.764 Vali Acc: 0.811 Test Loss: 0.764 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.2004492282867432
Epoch: 20, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 1.3304755687713623
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.2698211669921875
Epoch: 22, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 1.1461455821990967
Epoch: 23, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 1.3180551528930664
Epoch: 24, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.656 Vali Acc: 0.817 Test Loss: 0.656 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3021438121795654
Epoch: 25, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3517112731933594
Epoch: 26, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.629 Vali Acc: 0.839 Test Loss: 0.629 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.3178744316101074
Epoch: 27, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3147897720336914
Epoch: 28, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 1.3173778057098389
Epoch: 29, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3891305923461914
Epoch: 30, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1401782035827637
Epoch: 31, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4404335021972656
Epoch: 32, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.360375165939331
Epoch: 33, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.264277458190918
Epoch: 34, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2651615142822266
Epoch: 35, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2572100162506104
Epoch: 36, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 1.1651403903961182
Epoch: 37, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 1.1200838088989258
Epoch: 38, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 1.198183536529541
Epoch: 39, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3863086700439453
Epoch: 40, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.31233811378479
Epoch: 41, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.270076036453247
Epoch: 42, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5223748683929443
Epoch: 43, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.379591941833496
Epoch: 44, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3995842933654785
Epoch: 45, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4413495063781738
Epoch: 46, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2159385681152344
Epoch: 47, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 1.2190771102905273
Epoch: 48, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2812526226043701
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1847987174987793
Epoch: 50, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2250151634216309
Epoch: 51, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.214643955230713
Epoch: 52, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3414692878723145
Epoch: 53, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 54 cost time: 1.3271117210388184
Epoch: 54, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2986655235290527
Epoch: 55, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3012521266937256
Epoch: 56, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2781081199645996
Epoch: 57, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2352259159088135
Epoch: 58, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.4257166385650635
Epoch: 59, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.286097764968872
Epoch: 60, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.3102662563323975
Epoch: 61, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.2840278148651123
Epoch: 62, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2995624542236328
Epoch: 63, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 43231
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.314716339111328
Epoch: 1, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.612 Vali Acc: 0.150 Test Loss: 2.612 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 1.1380224227905273
Epoch: 2, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.411 Vali Acc: 0.244 Test Loss: 2.411 Test Acc: 0.244
Validation loss decreased (-0.149974 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 1.246034860610962
Epoch: 3, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.179 Vali Acc: 0.378 Test Loss: 2.179 Test Acc: 0.378
Validation loss decreased (-0.244420 --> -0.377756).  Saving model ...
Epoch: 4 cost time: 1.3017115592956543
Epoch: 4, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.954 Vali Acc: 0.478 Test Loss: 1.954 Test Acc: 0.478
Validation loss decreased (-0.377756 --> -0.477758).  Saving model ...
Epoch: 5 cost time: 1.0243182182312012
Epoch: 5, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.743 Vali Acc: 0.583 Test Loss: 1.743 Test Acc: 0.583
Validation loss decreased (-0.477758 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 1.2345664501190186
Epoch: 6, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.568 Vali Acc: 0.656 Test Loss: 1.568 Test Acc: 0.656
Validation loss decreased (-0.583316 --> -0.655540).  Saving model ...
Epoch: 7 cost time: 1.255164384841919
Epoch: 7, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.421 Vali Acc: 0.667 Test Loss: 1.421 Test Acc: 0.667
Validation loss decreased (-0.655540 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.1939289569854736
Epoch: 8, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.303 Vali Acc: 0.672 Test Loss: 1.303 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 1.1295831203460693
Epoch: 9, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.213 Vali Acc: 0.683 Test Loss: 1.213 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.1529755592346191
Epoch: 10, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.136 Vali Acc: 0.728 Test Loss: 1.136 Test Acc: 0.728
Validation loss decreased (-0.683321 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.1907916069030762
Epoch: 11, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.062 Vali Acc: 0.733 Test Loss: 1.062 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 1.155118703842163
Epoch: 12, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.997 Vali Acc: 0.728 Test Loss: 0.997 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2026467323303223
Epoch: 13, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.949 Vali Acc: 0.756 Test Loss: 0.949 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.1833698749542236
Epoch: 14, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1628451347351074
Epoch: 15, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2107396125793457
Epoch: 16, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.2199172973632812
Epoch: 17, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.2147388458251953
Epoch: 18, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.791 Vali Acc: 0.811 Test Loss: 0.791 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.1367714405059814
Epoch: 19, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.771 Vali Acc: 0.811 Test Loss: 0.771 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.1796059608459473
Epoch: 20, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3155958652496338
Epoch: 21, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2511780261993408
Epoch: 22, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 1.2526113986968994
Epoch: 23, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.1388800144195557
Epoch: 24, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.660 Vali Acc: 0.817 Test Loss: 0.660 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.297724962234497
Epoch: 25, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.262495517730713
Epoch: 26, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.629 Vali Acc: 0.839 Test Loss: 0.629 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.1397829055786133
Epoch: 27, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2605278491973877
Epoch: 28, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.2177691459655762
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2821245193481445
Epoch: 30, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.205103874206543
Epoch: 31, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.174894094467163
Epoch: 32, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 1.3468852043151855
Epoch: 33, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.253847360610962
Epoch: 34, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 35 cost time: 1.3377137184143066
Epoch: 35, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 1.2710974216461182
Epoch: 36, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2880072593688965
Epoch: 37, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4010932445526123
Epoch: 38, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 1.3194730281829834
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3675291538238525
Epoch: 40, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 1.1907002925872803
Epoch: 41, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2361226081848145
Epoch: 42, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 1.223982810974121
Epoch: 43, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.296074390411377
Epoch: 44, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0962958335876465
Epoch: 45, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3499600887298584
Epoch: 46, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0769224166870117
Epoch: 47, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.305464744567871
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 49 cost time: 1.2787861824035645
Epoch: 49, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 50 cost time: 1.3018078804016113
Epoch: 50, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3171460628509521
Epoch: 51, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 52 cost time: 1.244182825088501
Epoch: 52, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2820091247558594
Epoch: 53, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.532 Vali Acc: 0.878 Test Loss: 0.532 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 54 cost time: 1.2325732707977295
Epoch: 54, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.552 Vali Acc: 0.878 Test Loss: 0.552 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2078125476837158
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.559 Vali Acc: 0.883 Test Loss: 0.559 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 56 cost time: 1.1526703834533691
Epoch: 56, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.534 Vali Acc: 0.883 Test Loss: 0.534 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 57 cost time: 1.182931900024414
Epoch: 57, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2372770309448242
Epoch: 58, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.332209587097168
Epoch: 59, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.0848584175109863
Epoch: 60, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 61 cost time: 1.0939271450042725
Epoch: 61, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2462494373321533
Epoch: 62, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3633296489715576
Epoch: 63, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.295086145401001
Epoch: 64, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.3781476020812988
Epoch: 65, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.2716686725616455
Epoch: 66, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.2983782291412354
Epoch: 67, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.3023662567138672
Epoch: 68, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.3403408527374268
Epoch: 69, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.207747459411621
Epoch: 70, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 43231
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.125843048095703
Epoch: 1, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.644 Vali Acc: 0.100 Test Loss: 2.644 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 1.3130476474761963
Epoch: 2, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.442 Vali Acc: 0.217 Test Loss: 2.442 Test Acc: 0.217
Validation loss decreased (-0.099974 --> -0.216642).  Saving model ...
Epoch: 3 cost time: 1.2066998481750488
Epoch: 3, Steps: 12 | Train Loss: 2.385 Vali Loss: 2.208 Vali Acc: 0.367 Test Loss: 2.208 Test Acc: 0.367
Validation loss decreased (-0.216642 --> -0.366645).  Saving model ...
Epoch: 4 cost time: 1.1780953407287598
Epoch: 4, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.981 Vali Acc: 0.483 Test Loss: 1.981 Test Acc: 0.483
Validation loss decreased (-0.366645 --> -0.483314).  Saving model ...
Epoch: 5 cost time: 1.198767900466919
Epoch: 5, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.766 Vali Acc: 0.561 Test Loss: 1.766 Test Acc: 0.561
Validation loss decreased (-0.483314 --> -0.561093).  Saving model ...
Epoch: 6 cost time: 1.214752197265625
Epoch: 6, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.586 Vali Acc: 0.639 Test Loss: 1.586 Test Acc: 0.639
Validation loss decreased (-0.561093 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 1.279857873916626
Epoch: 7, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.434 Vali Acc: 0.683 Test Loss: 1.434 Test Acc: 0.683
Validation loss decreased (-0.638873 --> -0.683319).  Saving model ...
Epoch: 8 cost time: 1.1870012283325195
Epoch: 8, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.317 Vali Acc: 0.700 Test Loss: 1.317 Test Acc: 0.700
Validation loss decreased (-0.683319 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.1397900581359863
Epoch: 9, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.222 Vali Acc: 0.694 Test Loss: 1.222 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2154767513275146
Epoch: 10, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.144 Vali Acc: 0.706 Test Loss: 1.144 Test Acc: 0.706
Validation loss decreased (-0.699987 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 1.1196074485778809
Epoch: 11, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.067 Vali Acc: 0.733 Test Loss: 1.067 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 1.0943763256072998
Epoch: 12, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.005 Vali Acc: 0.722 Test Loss: 1.005 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.189673900604248
Epoch: 13, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.210003137588501
Epoch: 14, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.2563886642456055
Epoch: 15, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.1786181926727295
Epoch: 16, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.815 Vali Acc: 0.806 Test Loss: 0.815 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 1.1510958671569824
Epoch: 17, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3826572895050049
Epoch: 18, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.298781394958496
Epoch: 19, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.766 Vali Acc: 0.806 Test Loss: 0.766 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 1.2644047737121582
Epoch: 20, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2690305709838867
Epoch: 21, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.2841053009033203
Epoch: 22, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.674 Vali Acc: 0.828 Test Loss: 0.674 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.1205511093139648
Epoch: 23, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.654 Vali Acc: 0.817 Test Loss: 0.654 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4008007049560547
Epoch: 24, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1577744483947754
Epoch: 25, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 1.0941152572631836
Epoch: 26, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 27 cost time: 1.2216176986694336
Epoch: 27, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2520349025726318
Epoch: 28, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 1.188234806060791
Epoch: 29, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2946083545684814
Epoch: 30, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4368760585784912
Epoch: 31, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.2159485816955566
Epoch: 32, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4565002918243408
Epoch: 33, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.527 Vali Acc: 0.839 Test Loss: 0.527 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3787944316864014
Epoch: 34, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 1.2356319427490234
Epoch: 35, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2607908248901367
Epoch: 36, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2593789100646973
Epoch: 37, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2725565433502197
Epoch: 38, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3856406211853027
Epoch: 39, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2894175052642822
Epoch: 40, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1283092498779297
Epoch: 41, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2030203342437744
Epoch: 42, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.344825029373169
Epoch: 43, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.358022689819336
Epoch: 44, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 43231
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3955960273742676
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.695 Vali Acc: 0.050 Test Loss: 2.695 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.2797930240631104
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.480 Vali Acc: 0.150 Test Loss: 2.480 Test Acc: 0.150
Validation loss decreased (-0.049973 --> -0.149975).  Saving model ...
Epoch: 3 cost time: 1.270815372467041
Epoch: 3, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.238 Vali Acc: 0.344 Test Loss: 2.238 Test Acc: 0.344
Validation loss decreased (-0.149975 --> -0.344422).  Saving model ...
Epoch: 4 cost time: 1.259213924407959
Epoch: 4, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.011 Vali Acc: 0.428 Test Loss: 2.011 Test Acc: 0.428
Validation loss decreased (-0.344422 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 1.3520710468292236
Epoch: 5, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.808 Vali Acc: 0.511 Test Loss: 1.808 Test Acc: 0.511
Validation loss decreased (-0.427758 --> -0.511093).  Saving model ...
Epoch: 6 cost time: 1.2905387878417969
Epoch: 6, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.620 Vali Acc: 0.583 Test Loss: 1.620 Test Acc: 0.583
Validation loss decreased (-0.511093 --> -0.583317).  Saving model ...
Epoch: 7 cost time: 1.0350980758666992
Epoch: 7, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.479 Vali Acc: 0.611 Test Loss: 1.479 Test Acc: 0.611
Validation loss decreased (-0.583317 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 1.2236037254333496
Epoch: 8, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.346 Vali Acc: 0.661 Test Loss: 1.346 Test Acc: 0.661
Validation loss decreased (-0.611096 --> -0.661098).  Saving model ...
Epoch: 9 cost time: 1.24070143699646
Epoch: 9, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.248 Vali Acc: 0.706 Test Loss: 1.248 Test Acc: 0.706
Validation loss decreased (-0.661098 --> -0.705543).  Saving model ...
Epoch: 10 cost time: 1.1678030490875244
Epoch: 10, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.164 Vali Acc: 0.706 Test Loss: 1.164 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 1.2060730457305908
Epoch: 11, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.087 Vali Acc: 0.739 Test Loss: 1.087 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738878).  Saving model ...
Epoch: 12 cost time: 1.146535873413086
Epoch: 12, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.042 Vali Acc: 0.750 Test Loss: 1.042 Test Acc: 0.750
Validation loss decreased (-0.738878 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.1735284328460693
Epoch: 13, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.985 Vali Acc: 0.761 Test Loss: 0.985 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 14 cost time: 1.058349609375
Epoch: 14, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.940 Vali Acc: 0.778 Test Loss: 0.940 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 1.2584114074707031
Epoch: 15, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.884 Vali Acc: 0.794 Test Loss: 0.884 Test Acc: 0.794
Validation loss decreased (-0.777768 --> -0.794436).  Saving model ...
Epoch: 16 cost time: 1.2572739124298096
Epoch: 16, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.867 Vali Acc: 0.778 Test Loss: 0.867 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1415934562683105
Epoch: 17, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.823 Vali Acc: 0.822 Test Loss: 0.823 Test Acc: 0.822
Validation loss decreased (-0.794436 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 1.3317608833312988
Epoch: 18, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2397851943969727
Epoch: 19, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 1.4683864116668701
Epoch: 20, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.752 Vali Acc: 0.811 Test Loss: 0.752 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4499123096466064
Epoch: 21, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.4390926361083984
Epoch: 22, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 23 cost time: 1.3961305618286133
Epoch: 23, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4791555404663086
Epoch: 24, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.44854736328125
Epoch: 25, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 1.3167681694030762
Epoch: 26, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.270035982131958
Epoch: 27, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.3215997219085693
Epoch: 28, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.5271928310394287
Epoch: 29, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1577975749969482
Epoch: 30, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.4024887084960938
Epoch: 31, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.1872072219848633
Epoch: 32, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2895164489746094
Epoch: 33, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2303979396820068
Epoch: 34, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.285198450088501
Epoch: 35, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 1.194366455078125
Epoch: 36, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.1399366855621338
Epoch: 37, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1854710578918457
Epoch: 38, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 1.2689709663391113
Epoch: 39, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 1.1132712364196777
Epoch: 40, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1397643089294434
Epoch: 41, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 42 cost time: 1.1325995922088623
Epoch: 42, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.277848482131958
Epoch: 43, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1991162300109863
Epoch: 44, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.120687484741211
Epoch: 45, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 46 cost time: 1.2143166065216064
Epoch: 46, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.192216157913208
Epoch: 47, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1224138736724854
Epoch: 48, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1074762344360352
Epoch: 49, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2393012046813965
Epoch: 50, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2297179698944092
Epoch: 51, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.2270069122314453
Epoch: 52, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.24660062789917
Epoch: 53, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.4267966747283936
Epoch: 54, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.572 Vali Acc: 0.878 Test Loss: 0.572 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2930920124053955
Epoch: 55, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 35039
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5294690132141113
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.691 Vali Acc: 0.022 Test Loss: 2.691 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 1.2621181011199951
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.476 Vali Acc: 0.200 Test Loss: 2.476 Test Acc: 0.200
Validation loss decreased (-0.022195 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 1.2161178588867188
Epoch: 3, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.233 Vali Acc: 0.383 Test Loss: 2.233 Test Acc: 0.383
Validation loss decreased (-0.199975 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 1.1496655941009521
Epoch: 4, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.003 Vali Acc: 0.444 Test Loss: 2.003 Test Acc: 0.444
Validation loss decreased (-0.383311 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 1.1949849128723145
Epoch: 5, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.799 Vali Acc: 0.528 Test Loss: 1.799 Test Acc: 0.528
Validation loss decreased (-0.444424 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 1.1617488861083984
Epoch: 6, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.611 Vali Acc: 0.628 Test Loss: 1.611 Test Acc: 0.628
Validation loss decreased (-0.527760 --> -0.627762).  Saving model ...
Epoch: 7 cost time: 1.3408586978912354
Epoch: 7, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.469 Vali Acc: 0.639 Test Loss: 1.469 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638874).  Saving model ...
Epoch: 8 cost time: 1.3634274005889893
Epoch: 8, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.337 Vali Acc: 0.683 Test Loss: 1.337 Test Acc: 0.683
Validation loss decreased (-0.638874 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.3556251525878906
Epoch: 9, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.239 Vali Acc: 0.711 Test Loss: 1.239 Test Acc: 0.711
Validation loss decreased (-0.683320 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.1601781845092773
Epoch: 10, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.157 Vali Acc: 0.706 Test Loss: 1.157 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2657537460327148
Epoch: 11, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.086 Vali Acc: 0.739 Test Loss: 1.086 Test Acc: 0.739
Validation loss decreased (-0.711099 --> -0.738878).  Saving model ...
Epoch: 12 cost time: 1.1903727054595947
Epoch: 12, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.043 Vali Acc: 0.744 Test Loss: 1.043 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 13 cost time: 1.2563066482543945
Epoch: 13, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.981 Vali Acc: 0.756 Test Loss: 0.981 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.2896738052368164
Epoch: 14, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.936 Vali Acc: 0.756 Test Loss: 0.936 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 1.272947072982788
Epoch: 15, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.883 Vali Acc: 0.806 Test Loss: 0.883 Test Acc: 0.806
Validation loss decreased (-0.755546 --> -0.805547).  Saving model ...
Epoch: 16 cost time: 1.3129487037658691
Epoch: 16, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.867 Vali Acc: 0.794 Test Loss: 0.867 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1379950046539307
Epoch: 17, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.827 Vali Acc: 0.822 Test Loss: 0.827 Test Acc: 0.822
Validation loss decreased (-0.805547 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 1.13161039352417
Epoch: 18, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.804 Vali Acc: 0.811 Test Loss: 0.804 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1304075717926025
Epoch: 19, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 1.2082853317260742
Epoch: 20, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.757 Vali Acc: 0.806 Test Loss: 0.757 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2462232112884521
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.711 Vali Acc: 0.828 Test Loss: 0.711 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 1.1981041431427002
Epoch: 22, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.3051199913024902
Epoch: 23, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1813645362854004
Epoch: 24, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 1.198638677597046
Epoch: 25, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 1.2072091102600098
Epoch: 26, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.2987513542175293
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.2084784507751465
Epoch: 28, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.081256628036499
Epoch: 29, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.612 Vali Acc: 0.839 Test Loss: 0.612 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2920353412628174
Epoch: 30, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.2047381401062012
Epoch: 31, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 1.4352996349334717
Epoch: 32, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.322688102722168
Epoch: 33, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.221327781677246
Epoch: 34, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2398509979248047
Epoch: 35, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 1.2619960308074951
Epoch: 36, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1553819179534912
Epoch: 37, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.140794038772583
Epoch: 38, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2191176414489746
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 40 cost time: 1.2586429119110107
Epoch: 40, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.218111276626587
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.553 Vali Acc: 0.883 Test Loss: 0.553 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 42 cost time: 1.200594186782837
Epoch: 42, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.363595962524414
Epoch: 43, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2007465362548828
Epoch: 44, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1951074600219727
Epoch: 45, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1874451637268066
Epoch: 46, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1141111850738525
Epoch: 47, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 48 cost time: 1.1960673332214355
Epoch: 48, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.066443920135498
Epoch: 49, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1463932991027832
Epoch: 50, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.217973232269287
Epoch: 51, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2345528602600098
Epoch: 52, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.095818281173706
Epoch: 53, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3220386505126953
Epoch: 54, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0988242626190186
Epoch: 55, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.3961882591247559
Epoch: 56, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.2200148105621338
Epoch: 57, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 35039
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.249346971511841
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.731 Vali Acc: 0.022 Test Loss: 2.731 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 1.192380428314209
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.511 Vali Acc: 0.156 Test Loss: 2.511 Test Acc: 0.156
Validation loss decreased (-0.022195 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.206052303314209
Epoch: 3, Steps: 12 | Train Loss: 2.347 Vali Loss: 2.263 Vali Acc: 0.383 Test Loss: 2.263 Test Acc: 0.383
Validation loss decreased (-0.155530 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 1.2651190757751465
Epoch: 4, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.029 Vali Acc: 0.461 Test Loss: 2.029 Test Acc: 0.461
Validation loss decreased (-0.383311 --> -0.461091).  Saving model ...
Epoch: 5 cost time: 1.1615195274353027
Epoch: 5, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.820 Vali Acc: 0.500 Test Loss: 1.820 Test Acc: 0.500
Validation loss decreased (-0.461091 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 1.122908115386963
Epoch: 6, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.631 Vali Acc: 0.628 Test Loss: 1.631 Test Acc: 0.628
Validation loss decreased (-0.499982 --> -0.627761).  Saving model ...
Epoch: 7 cost time: 1.2916111946105957
Epoch: 7, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.489 Vali Acc: 0.656 Test Loss: 1.489 Test Acc: 0.656
Validation loss decreased (-0.627761 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 1.334012746810913
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.354 Vali Acc: 0.678 Test Loss: 1.354 Test Acc: 0.678
Validation loss decreased (-0.655541 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 1.0908284187316895
Epoch: 9, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.256 Vali Acc: 0.700 Test Loss: 1.256 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699987).  Saving model ...
Epoch: 10 cost time: 1.1336877346038818
Epoch: 10, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.172 Vali Acc: 0.728 Test Loss: 1.172 Test Acc: 0.728
Validation loss decreased (-0.699987 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.2188773155212402
Epoch: 11, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.098 Vali Acc: 0.722 Test Loss: 1.098 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2545802593231201
Epoch: 12, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.057 Vali Acc: 0.756 Test Loss: 1.057 Test Acc: 0.756
Validation loss decreased (-0.727766 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 1.2691729068756104
Epoch: 13, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.999 Vali Acc: 0.767 Test Loss: 0.999 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 1.3339686393737793
Epoch: 14, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2872560024261475
Epoch: 15, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.899 Vali Acc: 0.800 Test Loss: 0.899 Test Acc: 0.800
Validation loss decreased (-0.766657 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.3151156902313232
Epoch: 16, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.886 Vali Acc: 0.789 Test Loss: 0.886 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1358847618103027
Epoch: 17, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.841 Vali Acc: 0.806 Test Loss: 0.841 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.339505910873413
Epoch: 18, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.813 Vali Acc: 0.806 Test Loss: 0.813 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805547).  Saving model ...
Epoch: 19 cost time: 1.2646677494049072
Epoch: 19, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.787 Vali Acc: 0.811 Test Loss: 0.787 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.2608323097229004
Epoch: 20, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.763 Vali Acc: 0.811 Test Loss: 0.763 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 21 cost time: 1.2195007801055908
Epoch: 21, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.3493857383728027
Epoch: 22, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.330810308456421
Epoch: 23, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.2065634727478027
Epoch: 24, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3305330276489258
Epoch: 25, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 1.1998872756958008
Epoch: 26, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.305776834487915
Epoch: 27, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.3097476959228516
Epoch: 28, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.3327653408050537
Epoch: 29, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.2701175212860107
Epoch: 30, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4451251029968262
Epoch: 31, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 1.3551106452941895
Epoch: 32, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.2008519172668457
Epoch: 33, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1240816116333008
Epoch: 34, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2379608154296875
Epoch: 35, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 1.2089288234710693
Epoch: 36, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0930356979370117
Epoch: 37, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2221717834472656
Epoch: 38, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3241069316864014
Epoch: 39, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3068900108337402
Epoch: 40, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1900441646575928
Epoch: 41, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 1.252312183380127
Epoch: 42, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2244563102722168
Epoch: 43, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2986226081848145
Epoch: 44, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.224323034286499
Epoch: 45, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 46 cost time: 1.3218276500701904
Epoch: 46, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2566158771514893
Epoch: 47, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.088057279586792
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2976906299591064
Epoch: 49, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2934489250183105
Epoch: 50, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3004703521728516
Epoch: 51, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.203535795211792
Epoch: 52, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.169842004776001
Epoch: 53, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.105548620223999
Epoch: 54, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2125749588012695
Epoch: 55, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 35039
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3429949283599854
Epoch: 1, Steps: 12 | Train Loss: 2.824 Vali Loss: 2.742 Vali Acc: 0.028 Test Loss: 2.742 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 1.2280304431915283
Epoch: 2, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.523 Vali Acc: 0.156 Test Loss: 2.523 Test Acc: 0.156
Validation loss decreased (-0.027750 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.1303706169128418
Epoch: 3, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.275 Vali Acc: 0.350 Test Loss: 2.275 Test Acc: 0.350
Validation loss decreased (-0.155530 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 1.177389144897461
Epoch: 4, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.038 Vali Acc: 0.478 Test Loss: 2.038 Test Acc: 0.478
Validation loss decreased (-0.349977 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 1.127169132232666
Epoch: 5, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.826 Vali Acc: 0.589 Test Loss: 1.826 Test Acc: 0.589
Validation loss decreased (-0.477757 --> -0.588871).  Saving model ...
Epoch: 6 cost time: 1.1569721698760986
Epoch: 6, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.635 Vali Acc: 0.633 Test Loss: 1.635 Test Acc: 0.633
Validation loss decreased (-0.588871 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.20782470703125
Epoch: 7, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.492 Vali Acc: 0.628 Test Loss: 1.492 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4364371299743652
Epoch: 8, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.360 Vali Acc: 0.683 Test Loss: 1.360 Test Acc: 0.683
Validation loss decreased (-0.633317 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.1767432689666748
Epoch: 9, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.264 Vali Acc: 0.678 Test Loss: 1.264 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2193663120269775
Epoch: 10, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.179 Vali Acc: 0.717 Test Loss: 1.179 Test Acc: 0.717
Validation loss decreased (-0.683320 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.2193453311920166
Epoch: 11, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1974825859069824
Epoch: 12, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.063 Vali Acc: 0.717 Test Loss: 1.063 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 1.1895005702972412
Epoch: 13, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 1.329756498336792
Epoch: 14, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.214615821838379
Epoch: 15, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.906 Vali Acc: 0.767 Test Loss: 0.906 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 16 cost time: 1.2760438919067383
Epoch: 16, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.891 Vali Acc: 0.789 Test Loss: 0.891 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 1.3321375846862793
Epoch: 17, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 1.18430495262146
Epoch: 18, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.807 Vali Acc: 0.817 Test Loss: 0.807 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.2289848327636719
Epoch: 19, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1489417552947998
Epoch: 20, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.759 Vali Acc: 0.806 Test Loss: 0.759 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2221145629882812
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.2130887508392334
Epoch: 22, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 1.4130396842956543
Epoch: 23, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2069487571716309
Epoch: 24, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2124252319335938
Epoch: 25, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.1791999340057373
Epoch: 26, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.2243268489837646
Epoch: 27, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1658751964569092
Epoch: 28, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 1.1781022548675537
Epoch: 29, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.1728551387786865
Epoch: 30, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.612 Vali Acc: 0.839 Test Loss: 0.612 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 31 cost time: 1.1921443939208984
Epoch: 31, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 1.147735357284546
Epoch: 32, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 1.183854579925537
Epoch: 33, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3457958698272705
Epoch: 34, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2081151008605957
Epoch: 35, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2298381328582764
Epoch: 36, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2616956233978271
Epoch: 37, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1709301471710205
Epoch: 38, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1710948944091797
Epoch: 39, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 40 cost time: 1.1962971687316895
Epoch: 40, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0404751300811768
Epoch: 41, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 1.1582188606262207
Epoch: 42, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2428076267242432
Epoch: 43, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1464037895202637
Epoch: 44, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1486952304840088
Epoch: 45, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.179584264755249
Epoch: 46, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1784896850585938
Epoch: 47, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1158239841461182
Epoch: 48, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 49 cost time: 1.1204330921173096
Epoch: 49, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2085719108581543
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3593342304229736
Epoch: 51, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0705945491790771
Epoch: 52, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1595802307128906
Epoch: 53, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.301433801651001
Epoch: 54, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 55 cost time: 1.2841644287109375
Epoch: 55, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3094961643218994
Epoch: 56, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1448249816894531
Epoch: 57, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 58 cost time: 1.1349186897277832
Epoch: 58, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1945865154266357
Epoch: 59, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.016150712966919
Epoch: 60, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.057248830795288
Epoch: 61, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1513938903808594
Epoch: 62, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.564 Vali Acc: 0.894 Test Loss: 0.564 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 63 cost time: 1.1207258701324463
Epoch: 63, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2664008140563965
Epoch: 64, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.605 Vali Acc: 0.883 Test Loss: 0.605 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0876386165618896
Epoch: 65, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.545 Vali Acc: 0.894 Test Loss: 0.545 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 66 cost time: 1.3014535903930664
Epoch: 66, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.4472200870513916
Epoch: 67, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3048937320709229
Epoch: 68, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.196298599243164
Epoch: 69, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3088569641113281
Epoch: 70, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.244194507598877
Epoch: 71, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0969667434692383
Epoch: 72, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.615 Vali Acc: 0.883 Test Loss: 0.615 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1939208507537842
Epoch: 73, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2516345977783203
Epoch: 74, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.591 Vali Acc: 0.889 Test Loss: 0.591 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.2288930416107178
Epoch: 75, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.621 Vali Acc: 0.883 Test Loss: 0.621 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 35039
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.351815700531006
Epoch: 1, Steps: 12 | Train Loss: 2.500 Vali Loss: 1.797 Vali Acc: 0.539 Test Loss: 1.797 Test Acc: 0.539
Validation loss decreased (inf --> -0.538871).  Saving model ...
Epoch: 2 cost time: 1.1862225532531738
Epoch: 2, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.538871 --> -0.699989).  Saving model ...
Epoch: 3 cost time: 1.2990202903747559
Epoch: 3, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.877 Vali Acc: 0.761 Test Loss: 0.877 Test Acc: 0.761
Validation loss decreased (-0.699989 --> -0.761102).  Saving model ...
Epoch: 4 cost time: 1.2102928161621094
Epoch: 4, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2682690620422363
Epoch: 5, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
Validation loss decreased (-0.761102 --> -0.816660).  Saving model ...
Epoch: 6 cost time: 1.0618243217468262
Epoch: 6, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2340219020843506
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1487174034118652
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2852575778961182
Epoch: 9, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855550).  Saving model ...
Epoch: 10 cost time: 1.055497407913208
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1211237907409668
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.018014669418335
Epoch: 12, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.091921329498291
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.797 Vali Acc: 0.839 Test Loss: 0.797 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2185800075531006
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1090178489685059
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.780 Vali Acc: 0.822 Test Loss: 0.780 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1811378002166748
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.869 Vali Acc: 0.839 Test Loss: 0.869 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1641082763671875
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.799 Vali Acc: 0.839 Test Loss: 0.799 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9637877941131592
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.875 Vali Acc: 0.839 Test Loss: 0.875 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1988704204559326
Epoch: 19, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.893 Vali Acc: 0.850 Test Loss: 0.893 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 2978343
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9345550537109375
Epoch: 1, Steps: 12 | Train Loss: 2.496 Vali Loss: 1.797 Vali Acc: 0.528 Test Loss: 1.797 Test Acc: 0.528
Validation loss decreased (inf --> -0.527760).  Saving model ...
Epoch: 2 cost time: 1.1599092483520508
Epoch: 2, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.527760 --> -0.699989).  Saving model ...
Epoch: 3 cost time: 1.119211196899414
Epoch: 3, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
Validation loss decreased (-0.699989 --> -0.755547).  Saving model ...
Epoch: 4 cost time: 1.0134832859039307
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 1.051124095916748
Epoch: 5, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.709 Vali Acc: 0.811 Test Loss: 0.709 Test Acc: 0.811
Validation loss decreased (-0.755548 --> -0.811104).  Saving model ...
Epoch: 6 cost time: 0.9599030017852783
Epoch: 6, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1029915809631348
Epoch: 7, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.796 Vali Acc: 0.783 Test Loss: 0.796 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0200989246368408
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.809 Vali Acc: 0.811 Test Loss: 0.809 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9881007671356201
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.811104 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 0.9615414142608643
Epoch: 10, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.712 Vali Acc: 0.850 Test Loss: 0.712 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9194779396057129
Epoch: 11, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.735 Vali Acc: 0.833 Test Loss: 0.735 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0118680000305176
Epoch: 12, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0751800537109375
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1543622016906738
Epoch: 14, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1207375526428223
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.790 Vali Acc: 0.828 Test Loss: 0.790 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1272945404052734
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.006270408630371
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.790 Vali Acc: 0.856 Test Loss: 0.790 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855548).  Saving model ...
Epoch: 18 cost time: 0.987297773361206
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.977 Vali Acc: 0.839 Test Loss: 0.977 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9630324840545654
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.922 Vali Acc: 0.844 Test Loss: 0.922 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9084005355834961
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.121 Vali Acc: 0.806 Test Loss: 1.121 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9644761085510254
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.956 Vali Acc: 0.844 Test Loss: 0.956 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0266761779785156
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.970 Vali Acc: 0.839 Test Loss: 0.970 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0446739196777344
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.100 Vali Acc: 0.844 Test Loss: 1.100 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9912233352661133
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.893 Vali Acc: 0.878 Test Loss: 0.893 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877769).  Saving model ...
Epoch: 25 cost time: 1.1202542781829834
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.005 Vali Acc: 0.856 Test Loss: 1.005 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.119100570678711
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.073 Vali Acc: 0.850 Test Loss: 1.073 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0043582916259766
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.997 Vali Acc: 0.856 Test Loss: 0.997 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.147721767425537
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.144 Vali Acc: 0.850 Test Loss: 1.144 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1372759342193604
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.999 Vali Acc: 0.833 Test Loss: 0.999 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0927433967590332
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.111 Vali Acc: 0.861 Test Loss: 1.111 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.14473557472229
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.104 Vali Acc: 0.844 Test Loss: 1.104 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.151237964630127
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.120 Vali Acc: 0.844 Test Loss: 1.120 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0968780517578125
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.153 Vali Acc: 0.844 Test Loss: 1.153 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1819450855255127
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.165 Vali Acc: 0.861 Test Loss: 1.165 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2978343
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0580875873565674
Epoch: 1, Steps: 12 | Train Loss: 2.500 Vali Loss: 1.796 Vali Acc: 0.494 Test Loss: 1.796 Test Acc: 0.494
Validation loss decreased (inf --> -0.494426).  Saving model ...
Epoch: 2 cost time: 1.062302827835083
Epoch: 2, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.104 Vali Acc: 0.711 Test Loss: 1.104 Test Acc: 0.711
Validation loss decreased (-0.494426 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 1.111738681793213
Epoch: 3, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
Validation loss decreased (-0.711100 --> -0.755547).  Saving model ...
Epoch: 4 cost time: 1.1708922386169434
Epoch: 4, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.742 Vali Acc: 0.772 Test Loss: 0.742 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 5 cost time: 1.1454863548278809
Epoch: 5, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.772215 --> -0.811104).  Saving model ...
Epoch: 6 cost time: 0.9943051338195801
Epoch: 6, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.689 Vali Acc: 0.794 Test Loss: 0.689 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.127351999282837
Epoch: 7, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2670314311981201
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.092367172241211
Epoch: 9, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
Validation loss decreased (-0.811104 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 1.1036107540130615
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 11 cost time: 1.1541118621826172
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1750719547271729
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1664021015167236
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0829157829284668
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9665031433105469
Epoch: 15, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0423295497894287
Epoch: 16, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.749 Vali Acc: 0.833 Test Loss: 0.749 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0869865417480469
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.148672342300415
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.830 Vali Acc: 0.850 Test Loss: 0.830 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1400227546691895
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1199402809143066
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.864 Vali Acc: 0.833 Test Loss: 0.864 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2978343
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.028775453567505
Epoch: 1, Steps: 12 | Train Loss: 2.521 Vali Loss: 1.834 Vali Acc: 0.539 Test Loss: 1.834 Test Acc: 0.539
Validation loss decreased (inf --> -0.538871).  Saving model ...
Epoch: 2 cost time: 0.9969124794006348
Epoch: 2, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.144 Vali Acc: 0.672 Test Loss: 1.144 Test Acc: 0.672
Validation loss decreased (-0.538871 --> -0.672211).  Saving model ...
Epoch: 3 cost time: 1.078599214553833
Epoch: 3, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
Validation loss decreased (-0.672211 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.146238088607788
Epoch: 4, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.0337090492248535
Epoch: 5, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788882).  Saving model ...
Epoch: 6 cost time: 1.0391738414764404
Epoch: 6, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.677 Vali Acc: 0.778 Test Loss: 0.677 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9701476097106934
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 0.957430362701416
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1402530670166016
Epoch: 9, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.602 Vali Acc: 0.811 Test Loss: 0.602 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 1.0807969570159912
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 11 cost time: 1.051654577255249
Epoch: 11, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 12 cost time: 1.0535881519317627
Epoch: 12, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8534505367279053
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0107896327972412
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.616 Vali Acc: 0.839 Test Loss: 0.616 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9707574844360352
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.075383186340332
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0541017055511475
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.155808448791504
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 1.1872198581695557
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.866 Vali Acc: 0.856 Test Loss: 0.866 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0119366645812988
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.840 Vali Acc: 0.861 Test Loss: 0.840 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0165214538574219
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.839 Vali Acc: 0.867 Test Loss: 0.839 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866658).  Saving model ...
Epoch: 22 cost time: 1.2482593059539795
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 1.2644689083099365
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.818 Vali Acc: 0.867 Test Loss: 0.818 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0996673107147217
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.792 Vali Acc: 0.856 Test Loss: 0.792 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1141347885131836
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.943 Vali Acc: 0.872 Test Loss: 0.943 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872213).  Saving model ...
Epoch: 26 cost time: 1.0319304466247559
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.861 Test Loss: 0.866 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1626648902893066
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.168 Vali Acc: 0.872 Test Loss: 1.168 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.256662130355835
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.900 Vali Acc: 0.856 Test Loss: 0.900 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0752496719360352
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.098 Vali Acc: 0.872 Test Loss: 1.098 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.026106357574463
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.015 Vali Acc: 0.867 Test Loss: 1.015 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.062067985534668
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.274 Vali Acc: 0.878 Test Loss: 1.274 Test Acc: 0.878
Validation loss decreased (-0.872213 --> -0.877765).  Saving model ...
Epoch: 32 cost time: 1.225708246231079
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.026 Vali Acc: 0.883 Test Loss: 1.026 Test Acc: 0.883
Validation loss decreased (-0.877765 --> -0.883323).  Saving model ...
Epoch: 33 cost time: 1.5176379680633545
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3188490867614746
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.872 Test Loss: 1.046 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2344000339508057
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.861 Test Loss: 1.074 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3308095932006836
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.872 Test Loss: 1.083 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.562929630279541
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.878 Test Loss: 1.080 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0905787944793701
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.878 Test Loss: 1.025 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0769691467285156
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.878 Test Loss: 1.069 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.31951904296875
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.878 Test Loss: 1.089 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3815028667449951
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.878 Test Loss: 1.089 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6587235927581787
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.878 Test Loss: 1.079 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2978343
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5263707637786865
Epoch: 1, Steps: 12 | Train Loss: 2.604 Vali Loss: 1.869 Vali Acc: 0.494 Test Loss: 1.869 Test Acc: 0.494
Validation loss decreased (inf --> -0.494426).  Saving model ...
Epoch: 2 cost time: 1.5790801048278809
Epoch: 2, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.148 Vali Acc: 0.689 Test Loss: 1.148 Test Acc: 0.689
Validation loss decreased (-0.494426 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.1242749691009521
Epoch: 3, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.911 Vali Acc: 0.722 Test Loss: 0.911 Test Acc: 0.722
Validation loss decreased (-0.688877 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.3044118881225586
Epoch: 4, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.722213 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.2447140216827393
Epoch: 5, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.732 Vali Acc: 0.806 Test Loss: 0.732 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 1.435964584350586
Epoch: 6, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
Validation loss decreased (-0.805548 --> -0.844438).  Saving model ...
Epoch: 7 cost time: 1.2654082775115967
Epoch: 7, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.786 Vali Acc: 0.794 Test Loss: 0.786 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.392406702041626
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3039813041687012
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.377058744430542
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 11 cost time: 1.196528673171997
Epoch: 11, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.744 Vali Acc: 0.817 Test Loss: 0.744 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2455639839172363
Epoch: 12, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.779 Vali Acc: 0.822 Test Loss: 0.779 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1535656452178955
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2013447284698486
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.886 Vali Acc: 0.817 Test Loss: 0.886 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1573505401611328
Epoch: 15, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.025012493133545
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.965 Vali Acc: 0.817 Test Loss: 0.965 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0223121643066406
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.950 Vali Acc: 0.844 Test Loss: 0.950 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1013524532318115
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.902 Vali Acc: 0.844 Test Loss: 0.902 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1237738132476807
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.284 Vali Acc: 0.844 Test Loss: 1.284 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2026557922363281
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.967 Vali Acc: 0.839 Test Loss: 0.967 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1929767
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.903278350830078
Epoch: 1, Steps: 12 | Train Loss: 2.595 Vali Loss: 1.858 Vali Acc: 0.522 Test Loss: 1.858 Test Acc: 0.522
Validation loss decreased (inf --> -0.522204).  Saving model ...
Epoch: 2 cost time: 1.4613053798675537
Epoch: 2, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.139 Vali Acc: 0.683 Test Loss: 1.139 Test Acc: 0.683
Validation loss decreased (-0.522204 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.0980515480041504
Epoch: 3, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.897 Vali Acc: 0.739 Test Loss: 0.897 Test Acc: 0.739
Validation loss decreased (-0.683322 --> -0.738880).  Saving model ...
Epoch: 4 cost time: 1.0268895626068115
Epoch: 4, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
Validation loss decreased (-0.738880 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 1.0301377773284912
Epoch: 5, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 6 cost time: 0.9993846416473389
Epoch: 6, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838882).  Saving model ...
Epoch: 7 cost time: 1.3603086471557617
Epoch: 7, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0663797855377197
Epoch: 8, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.761 Vali Acc: 0.811 Test Loss: 0.761 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2987494468688965
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.675 Vali Acc: 0.839 Test Loss: 0.675 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2957589626312256
Epoch: 10, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1345012187957764
Epoch: 11, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.770 Vali Acc: 0.817 Test Loss: 0.770 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.234009027481079
Epoch: 12, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.734 Vali Acc: 0.856 Test Loss: 0.734 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 1.335986852645874
Epoch: 13, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.924 Vali Acc: 0.822 Test Loss: 0.924 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3449699878692627
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.897 Vali Acc: 0.817 Test Loss: 0.897 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.431290864944458
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.781 Vali Acc: 0.861 Test Loss: 0.781 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 16 cost time: 1.3216001987457275
Epoch: 16, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.865 Vali Acc: 0.844 Test Loss: 0.865 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4806528091430664
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.962 Vali Acc: 0.822 Test Loss: 0.962 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2208740711212158
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.875 Vali Acc: 0.850 Test Loss: 0.875 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.209787130355835
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.041 Vali Acc: 0.850 Test Loss: 1.041 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3196322917938232
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.928 Vali Acc: 0.839 Test Loss: 0.928 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1751494407653809
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.056 Vali Acc: 0.833 Test Loss: 1.056 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2149434089660645
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.937 Vali Acc: 0.828 Test Loss: 0.937 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1464591026306152
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.018 Vali Acc: 0.839 Test Loss: 1.018 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2350385189056396
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.094 Vali Acc: 0.839 Test Loss: 1.094 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2252533435821533
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.066 Vali Acc: 0.850 Test Loss: 1.066 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1929767
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5511348247528076
Epoch: 1, Steps: 12 | Train Loss: 2.586 Vali Loss: 1.851 Vali Acc: 0.472 Test Loss: 1.851 Test Acc: 0.472
Validation loss decreased (inf --> -0.472204).  Saving model ...
Epoch: 2 cost time: 1.0985009670257568
Epoch: 2, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.142 Vali Acc: 0.672 Test Loss: 1.142 Test Acc: 0.672
Validation loss decreased (-0.472204 --> -0.672211).  Saving model ...
Epoch: 3 cost time: 1.151277780532837
Epoch: 3, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.898 Vali Acc: 0.744 Test Loss: 0.898 Test Acc: 0.744
Validation loss decreased (-0.672211 --> -0.744435).  Saving model ...
Epoch: 4 cost time: 1.1609599590301514
Epoch: 4, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.744435 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 1.1730694770812988
Epoch: 5, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 6 cost time: 1.1501562595367432
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 1.138617753982544
Epoch: 7, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1413166522979736
Epoch: 8, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.1199545860290527
Epoch: 9, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1484649181365967
Epoch: 10, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866660).  Saving model ...
Epoch: 11 cost time: 1.1748247146606445
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.006230354309082
Epoch: 12, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1121501922607422
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.727 Vali Acc: 0.839 Test Loss: 0.727 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3141200542449951
Epoch: 14, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.805 Vali Acc: 0.867 Test Loss: 0.805 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.295917272567749
Epoch: 15, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1412208080291748
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.896 Vali Acc: 0.822 Test Loss: 0.896 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1756813526153564
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.889 Vali Acc: 0.856 Test Loss: 0.889 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.354034662246704
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1438229084014893
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.034 Vali Acc: 0.856 Test Loss: 1.034 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2633919715881348
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.901 Vali Acc: 0.828 Test Loss: 0.901 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1929767
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3638923168182373
Epoch: 1, Steps: 12 | Train Loss: 2.561 Vali Loss: 1.835 Vali Acc: 0.472 Test Loss: 1.835 Test Acc: 0.472
Validation loss decreased (inf --> -0.472204).  Saving model ...
Epoch: 2 cost time: 1.047661304473877
Epoch: 2, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.151 Vali Acc: 0.694 Test Loss: 1.151 Test Acc: 0.694
Validation loss decreased (-0.472204 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.0473730564117432
Epoch: 3, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.1248054504394531
Epoch: 4, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.722213 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.0737354755401611
Epoch: 5, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0734012126922607
Epoch: 6, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.639 Vali Acc: 0.794 Test Loss: 0.639 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0432679653167725
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9804346561431885
Epoch: 8, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.1557812690734863
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9502739906311035
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.630 Vali Acc: 0.817 Test Loss: 0.630 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.143446445465088
Epoch: 11, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0467665195465088
Epoch: 12, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.1614561080932617
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1957991123199463
Epoch: 14, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 15 cost time: 1.1677978038787842
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1047165393829346
Epoch: 16, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.124769926071167
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.790 Vali Acc: 0.828 Test Loss: 0.790 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0703730583190918
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.760 Vali Acc: 0.844 Test Loss: 0.760 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0556766986846924
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.086 Vali Acc: 0.828 Test Loss: 1.086 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0445339679718018
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1096909046173096
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.994 Vali Acc: 0.872 Test Loss: 0.994 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872212).  Saving model ...
Epoch: 22 cost time: 1.085968017578125
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.837 Vali Acc: 0.817 Test Loss: 0.837 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0830597877502441
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.000 Vali Acc: 0.878 Test Loss: 1.000 Test Acc: 0.878
Validation loss decreased (-0.872212 --> -0.877768).  Saving model ...
Epoch: 24 cost time: 1.005873680114746
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.975 Vali Acc: 0.861 Test Loss: 0.975 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.132580041885376
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.893 Vali Acc: 0.861 Test Loss: 0.893 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0771336555480957
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.888 Vali Acc: 0.861 Test Loss: 0.888 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0065124034881592
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.933 Vali Acc: 0.867 Test Loss: 0.933 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.956977128982544
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.872 Test Loss: 0.915 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.141880750656128
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1301445960998535
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.872 Test Loss: 0.926 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.048830509185791
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.872 Test Loss: 0.957 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1052286624908447
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.872 Test Loss: 0.967 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0910675525665283
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.878 Test Loss: 0.967 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877768).  Saving model ...
Epoch: 34 cost time: 1.0014209747314453
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.878 Test Loss: 0.975 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0789439678192139
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.883 Test Loss: 0.983 Test Acc: 0.883
Validation loss decreased (-0.877768 --> -0.883324).  Saving model ...
Epoch: 36 cost time: 1.0946059226989746
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.883 Test Loss: 0.985 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.279282808303833
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.867 Test Loss: 0.975 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1129436492919922
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.872 Test Loss: 1.021 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.103628158569336
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.872 Test Loss: 1.024 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0479223728179932
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.861 Test Loss: 0.998 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1415989398956299
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.861 Test Loss: 0.988 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0024104118347168
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.861 Test Loss: 0.994 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0821971893310547
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.872 Test Loss: 0.993 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.156947135925293
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.872 Test Loss: 1.000 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2282233238220215
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.878 Test Loss: 1.014 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1929767
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0377631187438965
Epoch: 1, Steps: 12 | Train Loss: 2.553 Vali Loss: 1.844 Vali Acc: 0.500 Test Loss: 1.844 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 0.9934463500976562
Epoch: 2, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.124 Vali Acc: 0.722 Test Loss: 1.124 Test Acc: 0.722
Validation loss decreased (-0.499982 --> -0.722211).  Saving model ...
Epoch: 3 cost time: 1.0550456047058105
Epoch: 3, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.129014253616333
Epoch: 4, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.839 Vali Acc: 0.767 Test Loss: 0.839 Test Acc: 0.767
Validation loss decreased (-0.722211 --> -0.766658).  Saving model ...
Epoch: 5 cost time: 0.9638023376464844
Epoch: 5, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 1.0894033908843994
Epoch: 6, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0643434524536133
Epoch: 7, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 1.1463396549224854
Epoch: 8, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822215).  Saving model ...
Epoch: 9 cost time: 1.120300054550171
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844437).  Saving model ...
Epoch: 10 cost time: 1.2063179016113281
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.798 Vali Acc: 0.789 Test Loss: 0.798 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.276850938796997
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.844 Vali Acc: 0.806 Test Loss: 0.844 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2230534553527832
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.2329487800598145
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.767 Vali Acc: 0.811 Test Loss: 0.767 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0560462474822998
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.109656810760498
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.844 Vali Acc: 0.839 Test Loss: 0.844 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0178890228271484
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.929 Vali Acc: 0.833 Test Loss: 0.929 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.116321325302124
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.838 Vali Acc: 0.822 Test Loss: 0.838 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1306746006011963
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.026 Vali Acc: 0.822 Test Loss: 1.026 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.22499418258667
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.954 Vali Acc: 0.833 Test Loss: 0.954 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.182283878326416
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.051 Vali Acc: 0.839 Test Loss: 1.051 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1342155933380127
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.039 Vali Acc: 0.828 Test Loss: 1.039 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1937408447265625
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.136 Vali Acc: 0.844 Test Loss: 1.136 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1405479
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.249769687652588
Epoch: 1, Steps: 12 | Train Loss: 2.532 Vali Loss: 1.822 Vali Acc: 0.528 Test Loss: 1.822 Test Acc: 0.528
Validation loss decreased (inf --> -0.527760).  Saving model ...
Epoch: 2 cost time: 1.0685176849365234
Epoch: 2, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.119 Vali Acc: 0.711 Test Loss: 1.119 Test Acc: 0.711
Validation loss decreased (-0.527760 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 1.0699293613433838
Epoch: 3, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.0589885711669922
Epoch: 4, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.835 Vali Acc: 0.772 Test Loss: 0.835 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.098583698272705
Epoch: 5, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 1.0924615859985352
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.737 Vali Acc: 0.806 Test Loss: 0.737 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.0933325290679932
Epoch: 7, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1278245449066162
Epoch: 8, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 9 cost time: 1.1888282299041748
Epoch: 9, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844437).  Saving model ...
Epoch: 10 cost time: 1.272986888885498
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.079615831375122
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.791 Vali Acc: 0.828 Test Loss: 0.791 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1486241817474365
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.1668579578399658
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.784 Vali Acc: 0.817 Test Loss: 0.784 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.207798957824707
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.860 Vali Acc: 0.828 Test Loss: 0.860 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.104118824005127
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.965 Vali Acc: 0.844 Test Loss: 0.965 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1739482879638672
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.861 Vali Acc: 0.844 Test Loss: 0.861 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1164138317108154
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.848 Vali Acc: 0.828 Test Loss: 0.848 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1462793350219727
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.992 Vali Acc: 0.839 Test Loss: 0.992 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0767979621887207
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1772193908691406
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.980 Vali Acc: 0.856 Test Loss: 0.980 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855546).  Saving model ...
Epoch: 21 cost time: 1.2457730770111084
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.849 Vali Acc: 0.856 Test Loss: 0.849 Test Acc: 0.856
Validation loss decreased (-0.855546 --> -0.855547).  Saving model ...
Epoch: 22 cost time: 1.087031602859497
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.989 Vali Acc: 0.861 Test Loss: 0.989 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861101).  Saving model ...
Epoch: 23 cost time: 1.077462911605835
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.948 Vali Acc: 0.861 Test Loss: 0.948 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861102).  Saving model ...
Epoch: 24 cost time: 1.1216411590576172
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.919 Vali Acc: 0.839 Test Loss: 0.919 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2036798000335693
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.989 Vali Acc: 0.867 Test Loss: 0.989 Test Acc: 0.867
Validation loss decreased (-0.861102 --> -0.866657).  Saving model ...
Epoch: 26 cost time: 1.1374871730804443
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.133 Vali Acc: 0.839 Test Loss: 1.133 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1801388263702393
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.038 Vali Acc: 0.867 Test Loss: 1.038 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0903871059417725
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.964 Vali Acc: 0.867 Test Loss: 0.964 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 29 cost time: 1.1230888366699219
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.067 Vali Acc: 0.861 Test Loss: 1.067 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1708405017852783
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.867 Test Loss: 1.077 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2220897674560547
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.861 Test Loss: 1.054 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1781110763549805
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.092 Vali Acc: 0.883 Test Loss: 1.092 Test Acc: 0.883
Validation loss decreased (-0.866657 --> -0.883322).  Saving model ...
Epoch: 33 cost time: 1.153705358505249
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.872 Test Loss: 1.102 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1190571784973145
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.861 Test Loss: 1.100 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1616816520690918
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.861 Test Loss: 1.101 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.253458023071289
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.861 Test Loss: 1.107 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.115018367767334
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.867 Test Loss: 1.114 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1941287517547607
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.861 Test Loss: 1.098 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.075988531112671
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.867 Test Loss: 1.110 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2518129348754883
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.867 Test Loss: 1.113 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2312171459197998
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.867 Test Loss: 1.124 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1193366050720215
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.872 Test Loss: 1.139 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1405479
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2093989849090576
Epoch: 1, Steps: 12 | Train Loss: 2.494 Vali Loss: 1.820 Vali Acc: 0.517 Test Loss: 1.820 Test Acc: 0.517
Validation loss decreased (inf --> -0.516648).  Saving model ...
Epoch: 2 cost time: 1.2312650680541992
Epoch: 2, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.115 Vali Acc: 0.722 Test Loss: 1.115 Test Acc: 0.722
Validation loss decreased (-0.516648 --> -0.722211).  Saving model ...
Epoch: 3 cost time: 1.0334277153015137
Epoch: 3, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.935 Vali Acc: 0.722 Test Loss: 0.935 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.0696744918823242
Epoch: 4, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.841 Vali Acc: 0.767 Test Loss: 0.841 Test Acc: 0.767
Validation loss decreased (-0.722213 --> -0.766658).  Saving model ...
Epoch: 5 cost time: 1.097879409790039
Epoch: 5, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.747 Vali Acc: 0.811 Test Loss: 0.747 Test Acc: 0.811
Validation loss decreased (-0.766658 --> -0.811104).  Saving model ...
Epoch: 6 cost time: 1.0697789192199707
Epoch: 6, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.129666805267334
Epoch: 7, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.811104 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.2552103996276855
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2723779678344727
Epoch: 9, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.04689621925354
Epoch: 10, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.739 Vali Acc: 0.839 Test Loss: 0.739 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1407191753387451
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.709 Vali Acc: 0.828 Test Loss: 0.709 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0724892616271973
Epoch: 12, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 13 cost time: 1.1184899806976318
Epoch: 13, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2530574798583984
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.911 Vali Acc: 0.828 Test Loss: 0.911 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1275629997253418
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.707 Vali Acc: 0.872 Test Loss: 0.707 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872215).  Saving model ...
Epoch: 16 cost time: 1.0536048412322998
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.804 Vali Acc: 0.839 Test Loss: 0.804 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0618360042572021
Epoch: 17, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.720 Vali Acc: 0.833 Test Loss: 0.720 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1473333835601807
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.879 Vali Acc: 0.839 Test Loss: 0.879 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.246546745300293
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0930585861206055
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.837 Vali Acc: 0.861 Test Loss: 0.837 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2275419235229492
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.793 Vali Acc: 0.856 Test Loss: 0.793 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.145373821258545
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.919 Vali Acc: 0.856 Test Loss: 0.919 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1385300159454346
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.825 Vali Acc: 0.856 Test Loss: 0.825 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1113073825836182
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2594664096832275
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.946 Vali Acc: 0.861 Test Loss: 0.946 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1405479
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2572598457336426
Epoch: 1, Steps: 12 | Train Loss: 2.500 Vali Loss: 1.829 Vali Acc: 0.606 Test Loss: 1.829 Test Acc: 0.606
Validation loss decreased (inf --> -0.605537).  Saving model ...
Epoch: 2 cost time: 1.0532457828521729
Epoch: 2, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.137 Vali Acc: 0.689 Test Loss: 1.137 Test Acc: 0.689
Validation loss decreased (-0.605537 --> -0.688878).  Saving model ...
Epoch: 3 cost time: 1.1084518432617188
Epoch: 3, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.0133602619171143
Epoch: 4, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.868 Vali Acc: 0.733 Test Loss: 0.868 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733325).  Saving model ...
Epoch: 5 cost time: 1.0965189933776855
Epoch: 5, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 1.0554542541503906
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1282958984375
Epoch: 7, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.600 Vali Acc: 0.817 Test Loss: 0.600 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816661).  Saving model ...
Epoch: 8 cost time: 1.0886518955230713
Epoch: 8, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.097609519958496
Epoch: 9, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.079956293106079
Epoch: 10, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.631 Vali Acc: 0.817 Test Loss: 0.631 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.113529920578003
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.667 Vali Acc: 0.806 Test Loss: 0.667 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0918450355529785
Epoch: 12, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.692 Vali Acc: 0.828 Test Loss: 0.692 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.1567776203155518
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 14 cost time: 1.198317527770996
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.748 Vali Acc: 0.861 Test Loss: 0.748 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861104).  Saving model ...
Epoch: 15 cost time: 1.1339049339294434
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0594422817230225
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.770 Vali Acc: 0.861 Test Loss: 0.770 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1148126125335693
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1543993949890137
Epoch: 18, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.904 Vali Acc: 0.850 Test Loss: 0.904 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2852537631988525
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.737 Vali Acc: 0.833 Test Loss: 0.737 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.220994234085083
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.852 Vali Acc: 0.883 Test Loss: 0.852 Test Acc: 0.883
Validation loss decreased (-0.861104 --> -0.883325).  Saving model ...
Epoch: 21 cost time: 1.0822527408599854
Epoch: 21, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.781 Vali Acc: 0.856 Test Loss: 0.781 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.066803216934204
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.032 Vali Acc: 0.861 Test Loss: 1.032 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.002408742904663
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.998 Vali Acc: 0.861 Test Loss: 0.998 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.065352439880371
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.040 Vali Acc: 0.872 Test Loss: 1.040 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1157560348510742
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.979 Vali Acc: 0.867 Test Loss: 0.979 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1594789028167725
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.008 Vali Acc: 0.878 Test Loss: 1.008 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1124544143676758
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.057 Vali Acc: 0.872 Test Loss: 1.057 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0876586437225342
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.067 Vali Acc: 0.872 Test Loss: 1.067 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2149713039398193
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.060 Vali Acc: 0.872 Test Loss: 1.060 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0946929454803467
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.872 Test Loss: 1.057 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1405479
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0874006748199463
Epoch: 1, Steps: 12 | Train Loss: 2.577 Vali Loss: 1.906 Vali Acc: 0.472 Test Loss: 1.906 Test Acc: 0.472
Validation loss decreased (inf --> -0.472203).  Saving model ...
Epoch: 2 cost time: 1.102635145187378
Epoch: 2, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.212 Vali Acc: 0.661 Test Loss: 1.212 Test Acc: 0.661
Validation loss decreased (-0.472203 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 1.0931675434112549
Epoch: 3, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
Validation loss decreased (-0.661099 --> -0.761103).  Saving model ...
Epoch: 4 cost time: 1.1304028034210205
Epoch: 4, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.861 Vali Acc: 0.772 Test Loss: 0.861 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.0516340732574463
Epoch: 5, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794438).  Saving model ...
Epoch: 6 cost time: 1.076960563659668
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.740 Vali Acc: 0.806 Test Loss: 0.740 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.0726003646850586
Epoch: 7, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.0775456428527832
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855549).  Saving model ...
Epoch: 9 cost time: 1.1797411441802979
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.650 Vali Acc: 0.867 Test Loss: 0.650 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 10 cost time: 1.14353346824646
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1237540245056152
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.902 Vali Acc: 0.828 Test Loss: 0.902 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3145434856414795
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.779 Vali Acc: 0.844 Test Loss: 0.779 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2232799530029297
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 1.0980513095855713
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.757 Vali Acc: 0.856 Test Loss: 0.757 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.140265703201294
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.828 Vali Acc: 0.867 Test Loss: 0.828 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1593153476715088
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.817 Vali Acc: 0.867 Test Loss: 0.817 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2855710983276367
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.880 Vali Acc: 0.844 Test Loss: 0.880 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0153942108154297
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.055 Vali Acc: 0.833 Test Loss: 1.055 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1131043434143066
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1052157878875732
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.046 Vali Acc: 0.839 Test Loss: 1.046 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1522514820098877
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.029 Vali Acc: 0.856 Test Loss: 1.029 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.208369255065918
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.014 Vali Acc: 0.822 Test Loss: 1.014 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1730754375457764
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.112 Vali Acc: 0.844 Test Loss: 1.112 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1143335
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.21744704246521
Epoch: 1, Steps: 12 | Train Loss: 2.568 Vali Loss: 1.893 Vali Acc: 0.483 Test Loss: 1.893 Test Acc: 0.483
Validation loss decreased (inf --> -0.483314).  Saving model ...
Epoch: 2 cost time: 1.0607082843780518
Epoch: 2, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.214 Vali Acc: 0.678 Test Loss: 1.214 Test Acc: 0.678
Validation loss decreased (-0.483314 --> -0.677766).  Saving model ...
Epoch: 3 cost time: 1.1764717102050781
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.866 Vali Acc: 0.761 Test Loss: 0.866 Test Acc: 0.761
Validation loss decreased (-0.677766 --> -0.761102).  Saving model ...
Epoch: 4 cost time: 1.2235145568847656
Epoch: 4, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.866 Vali Acc: 0.772 Test Loss: 0.866 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 1.2543351650238037
Epoch: 5, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805549).  Saving model ...
Epoch: 6 cost time: 1.0767805576324463
Epoch: 6, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1275582313537598
Epoch: 7, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 1.1089613437652588
Epoch: 8, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1236522197723389
Epoch: 9, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
Validation loss decreased (-0.838882 --> -0.872216).  Saving model ...
Epoch: 10 cost time: 1.235982894897461
Epoch: 10, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.161468505859375
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.913 Vali Acc: 0.817 Test Loss: 0.913 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.077920913696289
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1388978958129883
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.096043348312378
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1826210021972656
Epoch: 15, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.820 Vali Acc: 0.856 Test Loss: 0.820 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1531765460968018
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.816 Vali Acc: 0.861 Test Loss: 0.816 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1853113174438477
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.896 Vali Acc: 0.839 Test Loss: 0.896 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0116264820098877
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.096 Vali Acc: 0.828 Test Loss: 1.096 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1483521461486816
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.874 Vali Acc: 0.833 Test Loss: 0.874 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1143335
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1725244522094727
Epoch: 1, Steps: 12 | Train Loss: 2.569 Vali Loss: 1.893 Vali Acc: 0.500 Test Loss: 1.893 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 1.1663904190063477
Epoch: 2, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.499981 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 1.1634736061096191
Epoch: 3, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
Validation loss decreased (-0.649988 --> -0.772214).  Saving model ...
Epoch: 4 cost time: 1.1306021213531494
Epoch: 4, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.852 Vali Acc: 0.756 Test Loss: 0.852 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1208844184875488
Epoch: 5, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.772214 --> -0.822216).  Saving model ...
Epoch: 6 cost time: 1.1463303565979004
Epoch: 6, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.679 Vali Acc: 0.817 Test Loss: 0.679 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0729212760925293
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.1089632511138916
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 1.1336915493011475
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 10 cost time: 1.2432754039764404
Epoch: 10, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3373258113861084
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1355714797973633
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.663 Vali Acc: 0.867 Test Loss: 0.663 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866660).  Saving model ...
Epoch: 13 cost time: 1.034024715423584
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1036427021026611
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.902 Vali Acc: 0.822 Test Loss: 0.902 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.14443039894104
Epoch: 15, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.786 Vali Acc: 0.856 Test Loss: 0.786 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1381995677947998
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.761 Vali Acc: 0.867 Test Loss: 0.761 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2004778385162354
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.822 Vali Acc: 0.822 Test Loss: 0.822 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1907668113708496
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.003 Vali Acc: 0.822 Test Loss: 1.003 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1551916599273682
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.831 Vali Acc: 0.844 Test Loss: 0.831 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1922938823699951
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.006 Vali Acc: 0.850 Test Loss: 1.006 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.141695499420166
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.830 Vali Acc: 0.839 Test Loss: 0.830 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1881723403930664
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.043 Vali Acc: 0.850 Test Loss: 1.043 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1143335
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0668370723724365
Epoch: 1, Steps: 12 | Train Loss: 2.544 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 1.0454065799713135
Epoch: 2, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.235 Vali Acc: 0.667 Test Loss: 1.235 Test Acc: 0.667
Validation loss decreased (-0.499981 --> -0.666654).  Saving model ...
Epoch: 3 cost time: 1.0961103439331055
Epoch: 3, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.906 Vali Acc: 0.694 Test Loss: 0.906 Test Acc: 0.694
Validation loss decreased (-0.666654 --> -0.694435).  Saving model ...
Epoch: 4 cost time: 1.102931022644043
Epoch: 4, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 1.1280503273010254
Epoch: 5, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.688 Vali Acc: 0.794 Test Loss: 0.688 Test Acc: 0.794
Validation loss decreased (-0.699991 --> -0.794438).  Saving model ...
Epoch: 6 cost time: 1.1110379695892334
Epoch: 6, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.698 Vali Acc: 0.767 Test Loss: 0.698 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0997235774993896
Epoch: 7, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.615 Vali Acc: 0.794 Test Loss: 0.615 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 1.063061237335205
Epoch: 8, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.531 Vali Acc: 0.817 Test Loss: 0.531 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.177586317062378
Epoch: 9, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.568 Vali Acc: 0.811 Test Loss: 0.568 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.130730152130127
Epoch: 10, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 11 cost time: 1.0680623054504395
Epoch: 11, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0072033405303955
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 0.9409222602844238
Epoch: 13, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.9707839488983154
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872215).  Saving model ...
Epoch: 15 cost time: 0.9661459922790527
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.718 Vali Acc: 0.839 Test Loss: 0.718 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1587233543395996
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9606695175170898
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1015753746032715
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.834 Vali Acc: 0.878 Test Loss: 0.834 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877769).  Saving model ...
Epoch: 19 cost time: 1.0376560688018799
Epoch: 19, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.756 Vali Acc: 0.867 Test Loss: 0.756 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0503900051116943
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.814 Vali Acc: 0.883 Test Loss: 0.814 Test Acc: 0.883
Validation loss decreased (-0.877769 --> -0.883325).  Saving model ...
Epoch: 21 cost time: 1.0243401527404785
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.802 Vali Acc: 0.867 Test Loss: 0.802 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0621764659881592
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.881 Vali Acc: 0.872 Test Loss: 0.881 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1731107234954834
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.906 Vali Acc: 0.867 Test Loss: 0.906 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0156736373901367
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.940 Vali Acc: 0.861 Test Loss: 0.940 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.148620843887329
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.964 Vali Acc: 0.878 Test Loss: 0.964 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0946846008300781
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.889 Test Loss: 0.968 Test Acc: 0.889
Validation loss decreased (-0.883325 --> -0.888879).  Saving model ...
Epoch: 27 cost time: 1.019305944442749
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.872 Test Loss: 0.958 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0658583641052246
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.983 Vali Acc: 0.872 Test Loss: 0.983 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.137542486190796
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.867 Test Loss: 1.000 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.222111463546753
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.979 Vali Acc: 0.867 Test Loss: 0.979 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.048727035522461
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.953 Vali Acc: 0.872 Test Loss: 0.953 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.12758207321167
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.872 Test Loss: 0.974 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0087130069732666
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.872 Test Loss: 0.981 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0982911586761475
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.867 Test Loss: 0.984 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.178950309753418
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.867 Test Loss: 0.980 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0261192321777344
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.872 Test Loss: 0.993 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1143335
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.246915340423584
Epoch: 1, Steps: 12 | Train Loss: 2.588 Vali Loss: 1.868 Vali Acc: 0.533 Test Loss: 1.868 Test Acc: 0.533
Validation loss decreased (inf --> -0.533315).  Saving model ...
Epoch: 2 cost time: 1.0800385475158691
Epoch: 2, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.123 Vali Acc: 0.683 Test Loss: 1.123 Test Acc: 0.683
Validation loss decreased (-0.533315 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.179990530014038
Epoch: 3, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
Validation loss decreased (-0.683322 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.1841206550598145
Epoch: 4, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.716658 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.0900273323059082
Epoch: 5, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.787 Vali Acc: 0.806 Test Loss: 0.787 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 1.1459221839904785
Epoch: 6, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.681 Vali Acc: 0.806 Test Loss: 0.681 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.1300740242004395
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.805549 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 1.1159231662750244
Epoch: 8, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.702 Vali Acc: 0.839 Test Loss: 0.702 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1210005283355713
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0598692893981934
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.873 Vali Acc: 0.828 Test Loss: 0.873 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1903693675994873
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2512550354003906
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.718 Vali Acc: 0.839 Test Loss: 0.718 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.13370943069458
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.901 Vali Acc: 0.833 Test Loss: 0.901 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2483437061309814
Epoch: 14, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1707324981689453
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.081 Vali Acc: 0.789 Test Loss: 1.081 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0809636116027832
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.864 Vali Acc: 0.822 Test Loss: 0.864 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.218017339706421
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.944 Vali Acc: 0.844 Test Loss: 0.944 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1012263
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3747313022613525
Epoch: 1, Steps: 12 | Train Loss: 2.564 Vali Loss: 1.869 Vali Acc: 0.528 Test Loss: 1.869 Test Acc: 0.528
Validation loss decreased (inf --> -0.527759).  Saving model ...
Epoch: 2 cost time: 1.2391483783721924
Epoch: 2, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.127 Vali Acc: 0.694 Test Loss: 1.127 Test Acc: 0.694
Validation loss decreased (-0.527759 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.1289091110229492
Epoch: 3, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.916 Vali Acc: 0.728 Test Loss: 0.916 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727769).  Saving model ...
Epoch: 4 cost time: 1.2234768867492676
Epoch: 4, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.727769 --> -0.811104).  Saving model ...
Epoch: 5 cost time: 1.0612452030181885
Epoch: 5, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.791 Vali Acc: 0.794 Test Loss: 0.791 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2118844985961914
Epoch: 6, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.695 Vali Acc: 0.817 Test Loss: 0.695 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 1.2576813697814941
Epoch: 7, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 8 cost time: 1.277143955230713
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0683646202087402
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2521321773529053
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.846 Vali Acc: 0.817 Test Loss: 0.846 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.068141222000122
Epoch: 11, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2593481540679932
Epoch: 12, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.727 Vali Acc: 0.839 Test Loss: 0.727 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1072309017181396
Epoch: 13, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9722797870635986
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 15 cost time: 1.2160911560058594
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.122 Vali Acc: 0.783 Test Loss: 1.122 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1483962535858154
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.860 Vali Acc: 0.828 Test Loss: 0.860 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1499049663543701
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.926 Vali Acc: 0.850 Test Loss: 0.926 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0787296295166016
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.900 Vali Acc: 0.861 Test Loss: 0.900 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9212064743041992
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.933 Vali Acc: 0.828 Test Loss: 0.933 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.072666883468628
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.100 Vali Acc: 0.817 Test Loss: 1.100 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1171507835388184
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.069 Vali Acc: 0.794 Test Loss: 1.069 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3510046005249023
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.911 Vali Acc: 0.850 Test Loss: 0.911 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.922583818435669
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.250 Vali Acc: 0.822 Test Loss: 1.250 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1181824207305908
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.981 Vali Acc: 0.844 Test Loss: 0.981 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1012263
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3055174350738525
Epoch: 1, Steps: 12 | Train Loss: 2.534 Vali Loss: 1.862 Vali Acc: 0.544 Test Loss: 1.862 Test Acc: 0.544
Validation loss decreased (inf --> -0.544426).  Saving model ...
Epoch: 2 cost time: 1.3164725303649902
Epoch: 2, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.121 Vali Acc: 0.694 Test Loss: 1.121 Test Acc: 0.694
Validation loss decreased (-0.544426 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.4105124473571777
Epoch: 3, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.911 Vali Acc: 0.733 Test Loss: 0.911 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.2270400524139404
Epoch: 4, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
Validation loss decreased (-0.733324 --> -0.811104).  Saving model ...
Epoch: 5 cost time: 1.2539582252502441
Epoch: 5, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1873352527618408
Epoch: 6, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3583192825317383
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
Validation loss decreased (-0.811104 --> -0.872216).  Saving model ...
Epoch: 8 cost time: 1.1644151210784912
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1919033527374268
Epoch: 9, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2154693603515625
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.696 Vali Acc: 0.828 Test Loss: 0.696 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.230733871459961
Epoch: 11, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.44991135597229
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4182353019714355
Epoch: 13, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.719 Vali Acc: 0.867 Test Loss: 0.719 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2699172496795654
Epoch: 14, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2382090091705322
Epoch: 15, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.756 Vali Acc: 0.839 Test Loss: 0.756 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.304680347442627
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3853676319122314
Epoch: 17, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.811 Vali Acc: 0.839 Test Loss: 0.811 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1012263
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.207295179367065
Epoch: 1, Steps: 12 | Train Loss: 2.543 Vali Loss: 1.888 Vali Acc: 0.522 Test Loss: 1.888 Test Acc: 0.522
Validation loss decreased (inf --> -0.522203).  Saving model ...
Epoch: 2 cost time: 1.5738489627838135
Epoch: 2, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.178 Vali Acc: 0.678 Test Loss: 1.178 Test Acc: 0.678
Validation loss decreased (-0.522203 --> -0.677766).  Saving model ...
Epoch: 3 cost time: 1.5204463005065918
Epoch: 3, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
Validation loss decreased (-0.677766 --> -0.716657).  Saving model ...
Epoch: 4 cost time: 1.1774983406066895
Epoch: 4, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.3952312469482422
Epoch: 5, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
Validation loss decreased (-0.722214 --> -0.766659).  Saving model ...
Epoch: 6 cost time: 1.2068943977355957
Epoch: 6, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 1.3586201667785645
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 1.4332380294799805
Epoch: 8, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.677 Vali Acc: 0.811 Test Loss: 0.677 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.672705888748169
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 1.5549039840698242
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4074375629425049
Epoch: 11, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855549).  Saving model ...
Epoch: 12 cost time: 1.441676378250122
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4240562915802002
Epoch: 13, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5802674293518066
Epoch: 14, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.7118828296661377
Epoch: 15, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.890 Vali Acc: 0.839 Test Loss: 0.890 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.556814193725586
Epoch: 16, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.743345022201538
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.850 Vali Acc: 0.861 Test Loss: 0.850 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3670315742492676
Epoch: 18, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.801 Vali Acc: 0.850 Test Loss: 0.801 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7457115650177002
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.776 Vali Acc: 0.844 Test Loss: 0.776 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7964603900909424
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.847 Vali Acc: 0.828 Test Loss: 0.847 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6454310417175293
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.015 Vali Acc: 0.833 Test Loss: 1.015 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6551074981689453
Epoch: 22, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.838 Vali Acc: 0.828 Test Loss: 0.838 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4000699520111084
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.898 Vali Acc: 0.867 Test Loss: 0.898 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866658).  Saving model ...
Epoch: 24 cost time: 1.8924298286437988
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.883 Vali Acc: 0.867 Test Loss: 0.883 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 25 cost time: 1.5967919826507568
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.850 Test Loss: 0.926 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6935040950775146
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.939 Vali Acc: 0.856 Test Loss: 0.939 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5156481266021729
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.867 Test Loss: 0.951 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.600684404373169
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.867 Test Loss: 0.960 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8827331066131592
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.872 Test Loss: 0.947 Test Acc: 0.872
Validation loss decreased (-0.866658 --> -0.872213).  Saving model ...
Epoch: 30 cost time: 1.5929489135742188
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.867 Test Loss: 0.955 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.865586757659912
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.867 Test Loss: 0.968 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6697275638580322
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.861 Test Loss: 0.975 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8431196212768555
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.872 Test Loss: 0.983 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.70210862159729
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.867 Test Loss: 0.991 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6600418090820312
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.867 Test Loss: 0.997 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4892570972442627
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.867 Test Loss: 0.989 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.687648057937622
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.872 Test Loss: 1.001 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5289509296417236
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.872 Test Loss: 1.003 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8068962097167969
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.867 Test Loss: 1.002 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1012263
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2289879322052
Epoch: 1, Steps: 12 | Train Loss: 2.609 Vali Loss: 1.967 Vali Acc: 0.489 Test Loss: 1.967 Test Acc: 0.489
Validation loss decreased (inf --> -0.488869).  Saving model ...
Epoch: 2 cost time: 1.559748888015747
Epoch: 2, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.231 Vali Acc: 0.633 Test Loss: 1.231 Test Acc: 0.633
Validation loss decreased (-0.488869 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.761357307434082
Epoch: 3, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.951 Vali Acc: 0.728 Test Loss: 0.951 Test Acc: 0.728
Validation loss decreased (-0.633321 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 1.469041109085083
Epoch: 4, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.820 Vali Acc: 0.794 Test Loss: 0.820 Test Acc: 0.794
Validation loss decreased (-0.727768 --> -0.794436).  Saving model ...
Epoch: 5 cost time: 1.7479090690612793
Epoch: 5, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794437).  Saving model ...
Epoch: 6 cost time: 1.7061998844146729
Epoch: 6, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 7 cost time: 1.5674805641174316
Epoch: 7, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.675 Vali Acc: 0.839 Test Loss: 0.675 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 1.369441270828247
Epoch: 8, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.764 Vali Acc: 0.833 Test Loss: 0.764 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5486469268798828
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861104).  Saving model ...
Epoch: 10 cost time: 1.382124423980713
Epoch: 10, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.286252498626709
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.789 Vali Acc: 0.828 Test Loss: 0.789 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3357555866241455
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.832 Vali Acc: 0.806 Test Loss: 0.832 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3200290203094482
Epoch: 13, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.033 Vali Acc: 0.800 Test Loss: 1.033 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7624690532684326
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.877 Vali Acc: 0.839 Test Loss: 0.877 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7421605587005615
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.917 Vali Acc: 0.833 Test Loss: 0.917 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5122876167297363
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.868 Vali Acc: 0.844 Test Loss: 0.868 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6988632678985596
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.016 Vali Acc: 0.833 Test Loss: 1.016 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3695025444030762
Epoch: 18, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.981 Vali Acc: 0.839 Test Loss: 0.981 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5999126434326172
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.870 Vali Acc: 0.811 Test Loss: 0.870 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 946727
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.164318561553955
Epoch: 1, Steps: 12 | Train Loss: 2.617 Vali Loss: 1.967 Vali Acc: 0.483 Test Loss: 1.967 Test Acc: 0.483
Validation loss decreased (inf --> -0.483314).  Saving model ...
Epoch: 2 cost time: 1.221583366394043
Epoch: 2, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.223 Vali Acc: 0.639 Test Loss: 1.223 Test Acc: 0.639
Validation loss decreased (-0.483314 --> -0.638877).  Saving model ...
Epoch: 3 cost time: 1.3328726291656494
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.950 Vali Acc: 0.733 Test Loss: 0.950 Test Acc: 0.733
Validation loss decreased (-0.638877 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.28694748878479
Epoch: 4, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.818 Vali Acc: 0.794 Test Loss: 0.818 Test Acc: 0.794
Validation loss decreased (-0.733324 --> -0.794436).  Saving model ...
Epoch: 5 cost time: 1.3881266117095947
Epoch: 5, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.765 Vali Acc: 0.794 Test Loss: 0.765 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794437).  Saving model ...
Epoch: 6 cost time: 1.5203254222869873
Epoch: 6, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 1.4164586067199707
Epoch: 7, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 1.4242002964019775
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.762 Vali Acc: 0.839 Test Loss: 0.762 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2714624404907227
Epoch: 9, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 1.5122425556182861
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.574204921722412
Epoch: 11, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.893 Vali Acc: 0.806 Test Loss: 0.893 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5972609519958496
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.855 Vali Acc: 0.817 Test Loss: 0.855 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5275695323944092
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.008 Vali Acc: 0.794 Test Loss: 1.008 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3571274280548096
Epoch: 14, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.893 Vali Acc: 0.856 Test Loss: 0.893 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6040878295898438
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5639595985412598
Epoch: 16, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.888 Vali Acc: 0.833 Test Loss: 0.888 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6016638278961182
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.130 Vali Acc: 0.817 Test Loss: 1.130 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3417236804962158
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.959 Vali Acc: 0.822 Test Loss: 0.959 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3369786739349365
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.980 Vali Acc: 0.828 Test Loss: 0.980 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 946727
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3689498901367188
Epoch: 1, Steps: 12 | Train Loss: 2.602 Vali Loss: 1.949 Vali Acc: 0.500 Test Loss: 1.949 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 1.4230425357818604
Epoch: 2, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.204 Vali Acc: 0.656 Test Loss: 1.204 Test Acc: 0.656
Validation loss decreased (-0.499981 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 1.5383167266845703
Epoch: 3, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.945 Vali Acc: 0.728 Test Loss: 0.945 Test Acc: 0.728
Validation loss decreased (-0.655544 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 1.339618444442749
Epoch: 4, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
Validation loss decreased (-0.727768 --> -0.794437).  Saving model ...
Epoch: 5 cost time: 1.4399914741516113
Epoch: 5, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.2624597549438477
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.652 Vali Acc: 0.817 Test Loss: 0.652 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 1.425363540649414
Epoch: 7, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 1.1592917442321777
Epoch: 8, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.3500378131866455
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.4334511756896973
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 11 cost time: 1.7099719047546387
Epoch: 11, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.865 Vali Acc: 0.806 Test Loss: 0.865 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7000036239624023
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.756 Vali Acc: 0.811 Test Loss: 0.756 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4802594184875488
Epoch: 13, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.794 Vali Acc: 0.867 Test Loss: 0.794 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 1.5287258625030518
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4259657859802246
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7549030780792236
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.640138864517212
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5155525207519531
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2351524829864502
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.810 Vali Acc: 0.861 Test Loss: 0.810 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4748196601867676
Epoch: 20, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.990 Vali Acc: 0.833 Test Loss: 0.990 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.429872989654541
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.856 Vali Acc: 0.839 Test Loss: 0.856 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6976633071899414
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.065 Vali Acc: 0.833 Test Loss: 1.065 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.501328468322754
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.997 Vali Acc: 0.828 Test Loss: 0.997 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 946727
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.985502004623413
Epoch: 1, Steps: 12 | Train Loss: 2.559 Vali Loss: 1.936 Vali Acc: 0.506 Test Loss: 1.936 Test Acc: 0.506
Validation loss decreased (inf --> -0.505536).  Saving model ...
Epoch: 2 cost time: 1.3029789924621582
Epoch: 2, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.231 Vali Acc: 0.633 Test Loss: 1.231 Test Acc: 0.633
Validation loss decreased (-0.505536 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.1332025527954102
Epoch: 3, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.984 Vali Acc: 0.683 Test Loss: 0.984 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 1.5816030502319336
Epoch: 4, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
Validation loss decreased (-0.683323 --> -0.761103).  Saving model ...
Epoch: 5 cost time: 1.512357234954834
Epoch: 5, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 6 cost time: 1.5883972644805908
Epoch: 6, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.4701385498046875
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 1.2442991733551025
Epoch: 8, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.510951280593872
Epoch: 9, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.4507534503936768
Epoch: 10, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2817819118499756
Epoch: 11, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.672 Vali Acc: 0.811 Test Loss: 0.672 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4658613204956055
Epoch: 12, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.716 Vali Acc: 0.817 Test Loss: 0.716 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5408480167388916
Epoch: 13, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4616730213165283
Epoch: 14, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2718017101287842
Epoch: 15, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4194464683532715
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.316655158996582
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872215).  Saving model ...
Epoch: 18 cost time: 1.5292010307312012
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5704596042633057
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.753 Vali Acc: 0.856 Test Loss: 0.753 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2057323455810547
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.824 Vali Acc: 0.883 Test Loss: 0.824 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883325).  Saving model ...
Epoch: 21 cost time: 1.5974493026733398
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4322640895843506
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.948 Vali Acc: 0.856 Test Loss: 0.948 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3465380668640137
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.915 Vali Acc: 0.850 Test Loss: 0.915 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2996532917022705
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.908 Vali Acc: 0.889 Test Loss: 0.908 Test Acc: 0.889
Validation loss decreased (-0.883325 --> -0.888880).  Saving model ...
Epoch: 25 cost time: 1.3376009464263916
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.878 Test Loss: 0.873 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2039463520050049
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.883 Test Loss: 0.923 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5275843143463135
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.878 Test Loss: 0.946 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5822324752807617
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.872 Test Loss: 0.951 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6216011047363281
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.878 Test Loss: 0.955 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4089019298553467
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.878 Test Loss: 0.976 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.534390926361084
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.878 Test Loss: 0.985 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3572139739990234
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.872 Test Loss: 0.979 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6052980422973633
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.872 Test Loss: 0.971 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5947134494781494
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.878 Test Loss: 0.982 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 946727
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.16534686088562
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.253 Vali Acc: 0.272 Test Loss: 2.253 Test Acc: 0.272
Validation loss decreased (inf --> -0.272200).  Saving model ...
Epoch: 2 cost time: 1.3068492412567139
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.449 Vali Acc: 0.656 Test Loss: 1.449 Test Acc: 0.656
Validation loss decreased (-0.272200 --> -0.655541).  Saving model ...
Epoch: 3 cost time: 1.3265268802642822
Epoch: 3, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.143 Vali Acc: 0.672 Test Loss: 1.143 Test Acc: 0.672
Validation loss decreased (-0.655541 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.4681251049041748
Epoch: 4, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.4596476554870605
Epoch: 5, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.484787940979004
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.805 Vali Acc: 0.783 Test Loss: 0.805 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 1.3469805717468262
Epoch: 7, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.726 Vali Acc: 0.806 Test Loss: 0.726 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 8 cost time: 1.3379364013671875
Epoch: 8, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.2231812477111816
Epoch: 9, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5585565567016602
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 1.5570149421691895
Epoch: 11, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 1.4743432998657227
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2350411415100098
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4820516109466553
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5346417427062988
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.464944839477539
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2727806568145752
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.677 Vali Acc: 0.844 Test Loss: 0.677 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.396155834197998
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5551881790161133
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4254190921783447
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4955101013183594
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.735 Vali Acc: 0.833 Test Loss: 0.735 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1358119
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.827209711074829
Epoch: 1, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.233 Vali Acc: 0.267 Test Loss: 2.233 Test Acc: 0.267
Validation loss decreased (inf --> -0.266644).  Saving model ...
Epoch: 2 cost time: 1.3508362770080566
Epoch: 2, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.434 Vali Acc: 0.661 Test Loss: 1.434 Test Acc: 0.661
Validation loss decreased (-0.266644 --> -0.661097).  Saving model ...
Epoch: 3 cost time: 1.3672585487365723
Epoch: 3, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.132 Vali Acc: 0.694 Test Loss: 1.132 Test Acc: 0.694
Validation loss decreased (-0.661097 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 1.138458490371704
Epoch: 4, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.952 Vali Acc: 0.728 Test Loss: 0.952 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.626363754272461
Epoch: 5, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.865 Vali Acc: 0.761 Test Loss: 0.865 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 1.6720654964447021
Epoch: 6, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 1.524101972579956
Epoch: 7, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.5623018741607666
Epoch: 8, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838882).  Saving model ...
Epoch: 9 cost time: 1.524488925933838
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5387029647827148
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3526499271392822
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 12 cost time: 1.5452134609222412
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6022677421569824
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5989246368408203
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.1919934749603271
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3563132286071777
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0766551494598389
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4097673892974854
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.710 Vali Acc: 0.833 Test Loss: 0.710 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5718483924865723
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7152907848358154
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.787 Vali Acc: 0.833 Test Loss: 0.787 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4562797546386719
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.711 Vali Acc: 0.833 Test Loss: 0.711 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8322501182556152
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.757 Vali Acc: 0.839 Test Loss: 0.757 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4819979667663574
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.792 Vali Acc: 0.856 Test Loss: 0.792 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6635832786560059
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.795 Vali Acc: 0.839 Test Loss: 0.795 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1358119
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.842723846435547
Epoch: 1, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.223 Vali Acc: 0.344 Test Loss: 2.223 Test Acc: 0.344
Validation loss decreased (inf --> -0.344422).  Saving model ...
Epoch: 2 cost time: 1.5272786617279053
Epoch: 2, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.426 Vali Acc: 0.639 Test Loss: 1.426 Test Acc: 0.639
Validation loss decreased (-0.344422 --> -0.638875).  Saving model ...
Epoch: 3 cost time: 1.2507438659667969
Epoch: 3, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.123 Vali Acc: 0.711 Test Loss: 1.123 Test Acc: 0.711
Validation loss decreased (-0.638875 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 1.3513164520263672
Epoch: 4, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.940 Vali Acc: 0.733 Test Loss: 0.940 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.6964449882507324
Epoch: 5, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.847 Vali Acc: 0.772 Test Loss: 0.847 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.2020552158355713
Epoch: 6, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.3873088359832764
Epoch: 7, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 1.2663397789001465
Epoch: 8, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 9 cost time: 1.320507526397705
Epoch: 9, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.2651238441467285
Epoch: 10, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.238271951675415
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.20320463180542
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3665916919708252
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.426398754119873
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.487196445465088
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.32381010055542
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.469144582748413
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 1.1729846000671387
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3186554908752441
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3797597885131836
Epoch: 20, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.740 Vali Acc: 0.856 Test Loss: 0.740 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3685123920440674
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.695 Vali Acc: 0.822 Test Loss: 0.695 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.467456579208374
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.753 Vali Acc: 0.850 Test Loss: 0.753 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1285264492034912
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5186662673950195
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3555150032043457
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.807 Vali Acc: 0.844 Test Loss: 0.807 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.342883825302124
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4291551113128662
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1358119
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5360212326049805
Epoch: 1, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.205 Vali Acc: 0.339 Test Loss: 2.205 Test Acc: 0.339
Validation loss decreased (inf --> -0.338867).  Saving model ...
Epoch: 2 cost time: 1.3718652725219727
Epoch: 2, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.443 Vali Acc: 0.639 Test Loss: 1.443 Test Acc: 0.639
Validation loss decreased (-0.338867 --> -0.638874).  Saving model ...
Epoch: 3 cost time: 1.5051116943359375
Epoch: 3, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.152 Vali Acc: 0.672 Test Loss: 1.152 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.3337533473968506
Epoch: 4, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 1.3391811847686768
Epoch: 5, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 1.1521563529968262
Epoch: 6, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.811 Vali Acc: 0.767 Test Loss: 0.811 Test Acc: 0.767
Validation loss decreased (-0.727769 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 1.341480016708374
Epoch: 7, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4903783798217773
Epoch: 8, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.4116835594177246
Epoch: 9, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4785199165344238
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.569 Vali Acc: 0.817 Test Loss: 0.569 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 1.3495945930480957
Epoch: 11, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.514 Vali Acc: 0.817 Test Loss: 0.514 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 1.2913844585418701
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4797649383544922
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2713751792907715
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.296356439590454
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 1.2027595043182373
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3969659805297852
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3777101039886475
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4401435852050781
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4582345485687256
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4530649185180664
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3990898132324219
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2069768905639648
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.342513084411621
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4262404441833496
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1358119
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9845993518829346
Epoch: 1, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.209 Vali Acc: 0.472 Test Loss: 2.209 Test Acc: 0.472
Validation loss decreased (inf --> -0.472200).  Saving model ...
Epoch: 2 cost time: 1.3278357982635498
Epoch: 2, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.466 Vali Acc: 0.650 Test Loss: 1.466 Test Acc: 0.650
Validation loss decreased (-0.472200 --> -0.649985).  Saving model ...
Epoch: 3 cost time: 1.332617998123169
Epoch: 3, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.124 Vali Acc: 0.706 Test Loss: 1.124 Test Acc: 0.706
Validation loss decreased (-0.649985 --> -0.705544).  Saving model ...
Epoch: 4 cost time: 1.3746087551116943
Epoch: 4, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.923 Vali Acc: 0.711 Test Loss: 0.923 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711102).  Saving model ...
Epoch: 5 cost time: 1.5040087699890137
Epoch: 5, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.843 Vali Acc: 0.772 Test Loss: 0.843 Test Acc: 0.772
Validation loss decreased (-0.711102 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.3585460186004639
Epoch: 6, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.730 Vali Acc: 0.817 Test Loss: 0.730 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816659).  Saving model ...
Epoch: 7 cost time: 1.2984435558319092
Epoch: 7, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.4327025413513184
Epoch: 8, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5711755752563477
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5588300228118896
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.5036523342132568
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.369290828704834
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.5669586658477783
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.698 Vali Acc: 0.811 Test Loss: 0.698 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.544191837310791
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.458510398864746
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.50168776512146
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.472449541091919
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5987284183502197
Epoch: 18, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.505845308303833
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.771 Vali Acc: 0.817 Test Loss: 0.771 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.370704174041748
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7573833465576172
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4204621315002441
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.836 Vali Acc: 0.839 Test Loss: 0.836 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 833831
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9111649990081787
Epoch: 1, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.205 Vali Acc: 0.467 Test Loss: 2.205 Test Acc: 0.467
Validation loss decreased (inf --> -0.466645).  Saving model ...
Epoch: 2 cost time: 1.448598861694336
Epoch: 2, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.460 Vali Acc: 0.667 Test Loss: 1.460 Test Acc: 0.667
Validation loss decreased (-0.466645 --> -0.666652).  Saving model ...
Epoch: 3 cost time: 1.4444737434387207
Epoch: 3, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.127 Vali Acc: 0.689 Test Loss: 1.127 Test Acc: 0.689
Validation loss decreased (-0.666652 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.3695638179779053
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.924 Vali Acc: 0.717 Test Loss: 0.924 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716657).  Saving model ...
Epoch: 5 cost time: 1.4431178569793701
Epoch: 5, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.850 Vali Acc: 0.778 Test Loss: 0.850 Test Acc: 0.778
Validation loss decreased (-0.716657 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 1.4289302825927734
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.740 Vali Acc: 0.811 Test Loss: 0.740 Test Acc: 0.811
Validation loss decreased (-0.777769 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.528728723526001
Epoch: 7, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.5740535259246826
Epoch: 8, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.666 Vali Acc: 0.817 Test Loss: 0.666 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5206823348999023
Epoch: 9, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.345827579498291
Epoch: 10, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 1.4202892780303955
Epoch: 11, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.4581010341644287
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5439321994781494
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4633183479309082
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3431696891784668
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.689 Vali Acc: 0.839 Test Loss: 0.689 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.360433578491211
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6009681224822998
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.711 Vali Acc: 0.833 Test Loss: 0.711 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2415168285369873
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.4238085746765137
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.771 Vali Acc: 0.822 Test Loss: 0.771 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4853839874267578
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3270220756530762
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4180834293365479
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.815 Vali Acc: 0.839 Test Loss: 0.815 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4359948635101318
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.823 Vali Acc: 0.844 Test Loss: 0.823 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5911037921905518
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5156257152557373
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3814728260040283
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3780996799468994
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.891 Vali Acc: 0.839 Test Loss: 0.891 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4828011989593506
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 833831
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0947020053863525
Epoch: 1, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.191 Vali Acc: 0.467 Test Loss: 2.191 Test Acc: 0.467
Validation loss decreased (inf --> -0.466645).  Saving model ...
Epoch: 2 cost time: 1.5340609550476074
Epoch: 2, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.440 Vali Acc: 0.644 Test Loss: 1.440 Test Acc: 0.644
Validation loss decreased (-0.466645 --> -0.644430).  Saving model ...
Epoch: 3 cost time: 1.4215703010559082
Epoch: 3, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.644430 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.1683449745178223
Epoch: 4, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.905 Vali Acc: 0.722 Test Loss: 0.905 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 1.3623361587524414
Epoch: 5, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.828 Vali Acc: 0.789 Test Loss: 0.828 Test Acc: 0.789
Validation loss decreased (-0.722213 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 1.3224592208862305
Epoch: 6, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 1.422750473022461
Epoch: 7, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.675 Vali Acc: 0.839 Test Loss: 0.675 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 1.5498278141021729
Epoch: 8, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.5427238941192627
Epoch: 9, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4868295192718506
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4855985641479492
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 1.4905037879943848
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.427685260772705
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 14 cost time: 1.5785408020019531
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5691041946411133
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2978465557098389
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.520524024963379
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3256824016571045
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.510627269744873
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.43477201461792
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.491286277770996
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3190479278564453
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.724 Vali Acc: 0.833 Test Loss: 0.724 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1926372051239014
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 24 cost time: 1.1319973468780518
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.412853717803955
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.735 Vali Acc: 0.872 Test Loss: 0.735 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 26 cost time: 1.519895315170288
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.768 Vali Acc: 0.856 Test Loss: 0.768 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4884662628173828
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.791 Vali Acc: 0.839 Test Loss: 0.791 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.501028060913086
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.731 Vali Acc: 0.856 Test Loss: 0.731 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4254138469696045
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0538344383239746
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.788 Vali Acc: 0.867 Test Loss: 0.788 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.314823865890503
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.766 Vali Acc: 0.861 Test Loss: 0.766 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2898101806640625
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4018042087554932
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.775 Vali Acc: 0.867 Test Loss: 0.775 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3627727031707764
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.775 Vali Acc: 0.867 Test Loss: 0.775 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4225966930389404
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.810 Vali Acc: 0.867 Test Loss: 0.810 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 833831
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.512590646743774
Epoch: 1, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.240 Vali Acc: 0.411 Test Loss: 2.240 Test Acc: 0.411
Validation loss decreased (inf --> -0.411089).  Saving model ...
Epoch: 2 cost time: 1.4417006969451904
Epoch: 2, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.490 Vali Acc: 0.639 Test Loss: 1.490 Test Acc: 0.639
Validation loss decreased (-0.411089 --> -0.638874).  Saving model ...
Epoch: 3 cost time: 1.6792824268341064
Epoch: 3, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.161 Vali Acc: 0.650 Test Loss: 1.161 Test Acc: 0.650
Validation loss decreased (-0.638874 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 1.480475664138794
Epoch: 4, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.958 Vali Acc: 0.683 Test Loss: 0.958 Test Acc: 0.683
Validation loss decreased (-0.649988 --> -0.683324).  Saving model ...
Epoch: 5 cost time: 1.6319091320037842
Epoch: 5, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.892 Vali Acc: 0.722 Test Loss: 0.892 Test Acc: 0.722
Validation loss decreased (-0.683324 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 1.5992436408996582
Epoch: 6, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 1.4645349979400635
Epoch: 7, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 1.4974780082702637
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5333209037780762
Epoch: 9, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 10 cost time: 1.6605141162872314
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.652 Vali Acc: 0.772 Test Loss: 0.652 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4389865398406982
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 1.2878186702728271
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 1.4952845573425293
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5177414417266846
Epoch: 14, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.539926290512085
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.496363878250122
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2241947650909424
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.546351671218872
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.565 Vali Acc: 0.817 Test Loss: 0.565 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5464613437652588
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4644408226013184
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.693026065826416
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.631 Vali Acc: 0.811 Test Loss: 0.631 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5446679592132568
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6174585819244385
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 1.6736032962799072
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.651 Vali Acc: 0.861 Test Loss: 0.651 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 1.4058818817138672
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.674 Vali Acc: 0.878 Test Loss: 0.674 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 1.3596675395965576
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.674 Vali Acc: 0.883 Test Loss: 0.674 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 27 cost time: 1.5007319450378418
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.819 Vali Acc: 0.856 Test Loss: 0.819 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.525904893875122
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3255925178527832
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.690 Vali Acc: 0.883 Test Loss: 0.690 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4018871784210205
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.758 Vali Acc: 0.856 Test Loss: 0.758 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3486227989196777
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6319246292114258
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.693 Vali Acc: 0.883 Test Loss: 0.693 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4463303089141846
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.878 Test Loss: 0.727 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.373863935470581
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.883 Test Loss: 0.723 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1462554931640625
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.883 Test Loss: 0.758 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3703923225402832
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.883 Test Loss: 0.772 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 833831
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1271655559539795
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.244 Vali Acc: 0.339 Test Loss: 2.244 Test Acc: 0.339
Validation loss decreased (inf --> -0.338866).  Saving model ...
Epoch: 2 cost time: 1.603724479675293
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.515 Vali Acc: 0.572 Test Loss: 1.515 Test Acc: 0.572
Validation loss decreased (-0.338866 --> -0.572207).  Saving model ...
Epoch: 3 cost time: 1.4336555004119873
Epoch: 3, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.205 Vali Acc: 0.678 Test Loss: 1.205 Test Acc: 0.678
Validation loss decreased (-0.572207 --> -0.677766).  Saving model ...
Epoch: 4 cost time: 1.5121972560882568
Epoch: 4, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.000 Vali Acc: 0.694 Test Loss: 1.000 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 1.2531623840332031
Epoch: 5, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.871 Vali Acc: 0.767 Test Loss: 0.871 Test Acc: 0.767
Validation loss decreased (-0.694434 --> -0.766658).  Saving model ...
Epoch: 6 cost time: 1.295854091644287
Epoch: 6, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.4934122562408447
Epoch: 7, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.469353199005127
Epoch: 8, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5889625549316406
Epoch: 9, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 1.3483619689941406
Epoch: 10, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.3941996097564697
Epoch: 11, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.408083200454712
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.5987443923950195
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.53556489944458
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6007707118988037
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.724 Vali Acc: 0.856 Test Loss: 0.724 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1765148639678955
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.680 Vali Acc: 0.833 Test Loss: 0.680 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6607558727264404
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.752 Vali Acc: 0.856 Test Loss: 0.752 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5654571056365967
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.741 Vali Acc: 0.856 Test Loss: 0.741 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5176305770874023
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.376941204071045
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.794 Vali Acc: 0.839 Test Loss: 0.794 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0276885032653809
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2524194717407227
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 571687
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.305986642837524
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.242 Vali Acc: 0.322 Test Loss: 2.242 Test Acc: 0.322
Validation loss decreased (inf --> -0.322200).  Saving model ...
Epoch: 2 cost time: 1.472989559173584
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.506 Vali Acc: 0.583 Test Loss: 1.506 Test Acc: 0.583
Validation loss decreased (-0.322200 --> -0.583318).  Saving model ...
Epoch: 3 cost time: 1.3959875106811523
Epoch: 3, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.201 Vali Acc: 0.694 Test Loss: 1.201 Test Acc: 0.694
Validation loss decreased (-0.583318 --> -0.694432).  Saving model ...
Epoch: 4 cost time: 1.4320244789123535
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.998 Vali Acc: 0.689 Test Loss: 0.998 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5777153968811035
Epoch: 5, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.694432 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.7244422435760498
Epoch: 6, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
Validation loss decreased (-0.749991 --> -0.811104).  Saving model ...
Epoch: 7 cost time: 1.3861849308013916
Epoch: 7, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.4531445503234863
Epoch: 8, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.723 Vali Acc: 0.811 Test Loss: 0.723 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7064640522003174
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838883).  Saving model ...
Epoch: 10 cost time: 1.7382605075836182
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.558685302734375
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.707 Vali Acc: 0.817 Test Loss: 0.707 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5545976161956787
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3439674377441406
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 14 cost time: 1.7437856197357178
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5763764381408691
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4893815517425537
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.681 Vali Acc: 0.844 Test Loss: 0.681 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.468458652496338
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.751 Vali Acc: 0.844 Test Loss: 0.751 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4121549129486084
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3263866901397705
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2822163105010986
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.802 Vali Acc: 0.850 Test Loss: 0.802 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0788018703460693
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3839941024780273
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2578685283660889
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 571687
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.05546498298645
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.224 Vali Acc: 0.344 Test Loss: 2.224 Test Acc: 0.344
Validation loss decreased (inf --> -0.344422).  Saving model ...
Epoch: 2 cost time: 1.6029274463653564
Epoch: 2, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.487 Vali Acc: 0.572 Test Loss: 1.487 Test Acc: 0.572
Validation loss decreased (-0.344422 --> -0.572207).  Saving model ...
Epoch: 3 cost time: 1.5309348106384277
Epoch: 3, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.194 Vali Acc: 0.678 Test Loss: 1.194 Test Acc: 0.678
Validation loss decreased (-0.572207 --> -0.677766).  Saving model ...
Epoch: 4 cost time: 1.6124322414398193
Epoch: 4, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.989 Vali Acc: 0.689 Test Loss: 0.989 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688879).  Saving model ...
Epoch: 5 cost time: 1.5094163417816162
Epoch: 5, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
Validation loss decreased (-0.688879 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.58140230178833
Epoch: 6, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.729 Vali Acc: 0.806 Test Loss: 0.729 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.7035715579986572
Epoch: 7, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.5427565574645996
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3090496063232422
Epoch: 9, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 1.6014378070831299
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 1.324737787246704
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.477785587310791
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4658427238464355
Epoch: 13, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 14 cost time: 1.5136988162994385
Epoch: 14, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1898455619812012
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.63191556930542
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.509103536605835
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4700326919555664
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4153039455413818
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4465787410736084
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.680079698562622
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.721 Vali Acc: 0.828 Test Loss: 0.721 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.478588581085205
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.729 Vali Acc: 0.861 Test Loss: 0.729 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3724679946899414
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 571687
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7182586193084717
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.270 Vali Acc: 0.344 Test Loss: 2.270 Test Acc: 0.344
Validation loss decreased (inf --> -0.344422).  Saving model ...
Epoch: 2 cost time: 1.505021572113037
Epoch: 2, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.518 Vali Acc: 0.622 Test Loss: 1.518 Test Acc: 0.622
Validation loss decreased (-0.344422 --> -0.622207).  Saving model ...
Epoch: 3 cost time: 1.5675418376922607
Epoch: 3, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.228 Vali Acc: 0.678 Test Loss: 1.228 Test Acc: 0.678
Validation loss decreased (-0.622207 --> -0.677765).  Saving model ...
Epoch: 4 cost time: 1.3879814147949219
Epoch: 4, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.024 Vali Acc: 0.656 Test Loss: 1.024 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3342604637145996
Epoch: 5, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.865 Vali Acc: 0.722 Test Loss: 0.865 Test Acc: 0.722
Validation loss decreased (-0.677765 --> -0.722214).  Saving model ...
Epoch: 6 cost time: 1.1926085948944092
Epoch: 6, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.752 Vali Acc: 0.772 Test Loss: 0.752 Test Acc: 0.772
Validation loss decreased (-0.722214 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 1.537118673324585
Epoch: 7, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.5015456676483154
Epoch: 8, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2041535377502441
Epoch: 9, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5009784698486328
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.608 Vali Acc: 0.811 Test Loss: 0.608 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 1.6018397808074951
Epoch: 11, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4561939239501953
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 1.355210542678833
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2794947624206543
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2493350505828857
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.3870866298675537
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4563841819763184
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 1.345564842224121
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3494517803192139
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 1.3965222835540771
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.4981637001037598
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3591556549072266
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.1073505878448486
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2025249004364014
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4261000156402588
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.674 Vali Acc: 0.856 Test Loss: 0.674 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4724562168121338
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.697 Vali Acc: 0.856 Test Loss: 0.697 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3707365989685059
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 28 cost time: 1.272721529006958
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.292534351348877
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.380824327468872
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.697 Vali Acc: 0.883 Test Loss: 0.697 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 31 cost time: 1.5368680953979492
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.712 Vali Acc: 0.872 Test Loss: 0.712 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1990792751312256
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.738 Vali Acc: 0.872 Test Loss: 0.738 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5081851482391357
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.785 Vali Acc: 0.883 Test Loss: 0.785 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3483695983886719
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.867 Test Loss: 0.794 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5251624584197998
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.867 Test Loss: 0.787 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.583319902420044
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.878 Test Loss: 0.800 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3816947937011719
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.878 Test Loss: 0.817 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2281084060668945
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.775 Vali Acc: 0.878 Test Loss: 0.775 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.431776762008667
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.872 Test Loss: 0.773 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4961562156677246
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.883 Test Loss: 0.807 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 571687
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6888437271118164
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.335 Vali Acc: 0.294 Test Loss: 2.335 Test Acc: 0.294
Validation loss decreased (inf --> -0.294421).  Saving model ...
Epoch: 2 cost time: 1.3939626216888428
Epoch: 2, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.496 Vali Acc: 0.628 Test Loss: 1.496 Test Acc: 0.628
Validation loss decreased (-0.294421 --> -0.627763).  Saving model ...
Epoch: 3 cost time: 1.271080493927002
Epoch: 3, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
Validation loss decreased (-0.627763 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.5075626373291016
Epoch: 4, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.930 Vali Acc: 0.711 Test Loss: 0.930 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711102).  Saving model ...
Epoch: 5 cost time: 1.1777293682098389
Epoch: 5, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.835 Vali Acc: 0.778 Test Loss: 0.835 Test Acc: 0.778
Validation loss decreased (-0.711102 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 1.273615837097168
Epoch: 6, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.0614182949066162
Epoch: 7, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.1344044208526611
Epoch: 8, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 1.295332670211792
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.5022189617156982
Epoch: 10, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 11 cost time: 1.401010274887085
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2798726558685303
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2880821228027344
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4070897102355957
Epoch: 14, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.533083438873291
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3798863887786865
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3071022033691406
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.812 Vali Acc: 0.828 Test Loss: 0.812 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1553082466125488
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5250709056854248
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3475582599639893
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.834 Vali Acc: 0.844 Test Loss: 0.834 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 440615
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.287520408630371
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.330 Vali Acc: 0.300 Test Loss: 2.330 Test Acc: 0.300
Validation loss decreased (inf --> -0.299977).  Saving model ...
Epoch: 2 cost time: 1.4277839660644531
Epoch: 2, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.481 Vali Acc: 0.611 Test Loss: 1.481 Test Acc: 0.611
Validation loss decreased (-0.299977 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.6239392757415771
Epoch: 3, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.110 Vali Acc: 0.711 Test Loss: 1.110 Test Acc: 0.711
Validation loss decreased (-0.611096 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 1.6444134712219238
Epoch: 4, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.917 Vali Acc: 0.728 Test Loss: 0.917 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727769).  Saving model ...
Epoch: 5 cost time: 1.6154553890228271
Epoch: 5, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.829 Vali Acc: 0.794 Test Loss: 0.829 Test Acc: 0.794
Validation loss decreased (-0.727769 --> -0.794436).  Saving model ...
Epoch: 6 cost time: 1.3906357288360596
Epoch: 6, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.753 Vali Acc: 0.806 Test Loss: 0.753 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.7580583095550537
Epoch: 7, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.438281774520874
Epoch: 8, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.5409927368164062
Epoch: 9, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.569807767868042
Epoch: 10, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4543304443359375
Epoch: 11, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.615 Vali Acc: 0.839 Test Loss: 0.615 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5550568103790283
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.337341070175171
Epoch: 13, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6600992679595947
Epoch: 14, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.694 Vali Acc: 0.839 Test Loss: 0.694 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4299638271331787
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6202805042266846
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.470785140991211
Epoch: 17, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.819 Vali Acc: 0.806 Test Loss: 0.819 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.529778003692627
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.714 Vali Acc: 0.828 Test Loss: 0.714 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.271388292312622
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.744 Vali Acc: 0.839 Test Loss: 0.744 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 440615
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.098073244094849
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.336 Vali Acc: 0.283 Test Loss: 2.336 Test Acc: 0.283
Validation loss decreased (inf --> -0.283310).  Saving model ...
Epoch: 2 cost time: 1.552534818649292
Epoch: 2, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.482 Vali Acc: 0.606 Test Loss: 1.482 Test Acc: 0.606
Validation loss decreased (-0.283310 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.4137942790985107
Epoch: 3, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
Validation loss decreased (-0.605541 --> -0.711100).  Saving model ...
Epoch: 4 cost time: 1.4646084308624268
Epoch: 4, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 1.4786322116851807
Epoch: 5, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
Validation loss decreased (-0.744435 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 1.5597503185272217
Epoch: 6, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 7 cost time: 1.6052775382995605
Epoch: 7, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.5909762382507324
Epoch: 8, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.448066234588623
Epoch: 9, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.5816900730133057
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 1.4454667568206787
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3367509841918945
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6322875022888184
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4664814472198486
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.24365234375
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3324062824249268
Epoch: 16, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3697502613067627
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3220548629760742
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3871097564697266
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.675 Vali Acc: 0.839 Test Loss: 0.675 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4152004718780518
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 1.6272377967834473
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3967719078063965
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.755 Vali Acc: 0.867 Test Loss: 0.755 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4248380661010742
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.694 Vali Acc: 0.839 Test Loss: 0.694 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5410513877868652
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.781 Vali Acc: 0.856 Test Loss: 0.781 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5920686721801758
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2956268787384033
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.802 Vali Acc: 0.867 Test Loss: 0.802 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.405304193496704
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.799 Vali Acc: 0.867 Test Loss: 0.799 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3311741352081299
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.783 Vali Acc: 0.867 Test Loss: 0.783 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3688116073608398
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4795329570770264
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.821 Vali Acc: 0.872 Test Loss: 0.821 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 31 cost time: 1.4611010551452637
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.833 Vali Acc: 0.839 Test Loss: 0.833 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4342641830444336
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.856 Vali Acc: 0.867 Test Loss: 0.856 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5133030414581299
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2999060153961182
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.846 Vali Acc: 0.861 Test Loss: 0.846 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5223805904388428
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.791 Vali Acc: 0.844 Test Loss: 0.791 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.521458387374878
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.845 Vali Acc: 0.856 Test Loss: 0.845 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.49430513381958
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.841 Vali Acc: 0.867 Test Loss: 0.841 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5545542240142822
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.163 Vali Acc: 0.822 Test Loss: 1.163 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4784746170043945
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.068 Vali Acc: 0.817 Test Loss: 1.068 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3610689640045166
Epoch: 40, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.927 Vali Acc: 0.844 Test Loss: 0.927 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 440615
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.583843231201172
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.344 Vali Acc: 0.294 Test Loss: 2.344 Test Acc: 0.294
Validation loss decreased (inf --> -0.294421).  Saving model ...
Epoch: 2 cost time: 1.4084570407867432
Epoch: 2, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.492 Vali Acc: 0.644 Test Loss: 1.492 Test Acc: 0.644
Validation loss decreased (-0.294421 --> -0.644430).  Saving model ...
Epoch: 3 cost time: 1.4164512157440186
Epoch: 3, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.644430 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 1.3608078956604004
Epoch: 4, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
Validation loss decreased (-0.666655 --> -0.711102).  Saving model ...
Epoch: 5 cost time: 1.5432417392730713
Epoch: 5, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
Validation loss decreased (-0.711102 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.4937326908111572
Epoch: 6, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3202176094055176
Epoch: 7, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
Validation loss decreased (-0.755547 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 1.4711320400238037
Epoch: 8, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.644 Vali Acc: 0.778 Test Loss: 0.644 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3508350849151611
Epoch: 9, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.3656105995178223
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.564 Vali Acc: 0.811 Test Loss: 0.564 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 1.3883235454559326
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2914648056030273
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.811105 --> -0.844439).  Saving model ...
Epoch: 13 cost time: 1.3954026699066162
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 14 cost time: 1.5050885677337646
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3738598823547363
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.510 Vali Acc: 0.817 Test Loss: 0.510 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4654927253723145
Epoch: 16, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 1.221266746520996
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4047706127166748
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2337584495544434
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2605273723602295
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.1358110904693604
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.231961727142334
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.805 Vali Acc: 0.844 Test Loss: 0.805 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3581209182739258
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.625718593597412
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.761 Vali Acc: 0.856 Test Loss: 0.761 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.720637321472168
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4104998111724854
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877770).  Saving model ...
Epoch: 27 cost time: 1.5425333976745605
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6502723693847656
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 1.4948618412017822
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.760 Vali Acc: 0.872 Test Loss: 0.760 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6120877265930176
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.784 Vali Acc: 0.878 Test Loss: 0.784 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5061185359954834
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.878 Test Loss: 0.826 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.636533260345459
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.808 Vali Acc: 0.878 Test Loss: 0.808 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.568638563156128
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.781 Vali Acc: 0.883 Test Loss: 0.781 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883326).  Saving model ...
Epoch: 34 cost time: 1.5863895416259766
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.797 Vali Acc: 0.883 Test Loss: 0.797 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3476371765136719
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.812 Vali Acc: 0.883 Test Loss: 0.812 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6171681880950928
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.878 Test Loss: 0.813 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5282013416290283
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.883 Test Loss: 0.842 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3594071865081787
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.878 Test Loss: 0.857 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6037037372589111
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.878 Test Loss: 0.840 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2659049034118652
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.849 Vali Acc: 0.883 Test Loss: 0.849 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.649885892868042
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.883 Test Loss: 0.864 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4781105518341064
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.883 Test Loss: 0.869 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.237962007522583
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.878 Test Loss: 0.863 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 440615
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.785646677017212
Epoch: 1, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.054 Vali Acc: 0.456 Test Loss: 2.054 Test Acc: 0.456
Validation loss decreased (inf --> -0.455535).  Saving model ...
Epoch: 2 cost time: 1.3122100830078125
Epoch: 2, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.435 Vali Acc: 0.644 Test Loss: 1.435 Test Acc: 0.644
Validation loss decreased (-0.455535 --> -0.644430).  Saving model ...
Epoch: 3 cost time: 1.193030595779419
Epoch: 3, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.106 Vali Acc: 0.672 Test Loss: 1.106 Test Acc: 0.672
Validation loss decreased (-0.644430 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.3843936920166016
Epoch: 4, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.942 Vali Acc: 0.728 Test Loss: 0.942 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.451460361480713
Epoch: 5, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
Validation loss decreased (-0.727768 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 1.5442018508911133
Epoch: 6, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.5331206321716309
Epoch: 7, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 1.3229396343231201
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.657 Vali Acc: 0.817 Test Loss: 0.657 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 1.5616886615753174
Epoch: 9, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 1.3769936561584473
Epoch: 10, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 1.2802519798278809
Epoch: 11, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4251248836517334
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.6448769569396973
Epoch: 13, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5474810600280762
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.6776695251464844
Epoch: 15, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.671 Vali Acc: 0.861 Test Loss: 0.671 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7283222675323486
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4354815483093262
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.741 Vali Acc: 0.856 Test Loss: 0.741 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5413603782653809
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4992554187774658
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.791 Vali Acc: 0.839 Test Loss: 0.791 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5038642883300781
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.741 Vali Acc: 0.844 Test Loss: 0.741 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.636519193649292
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.606477975845337
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.754317045211792
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.636221170425415
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.900 Vali Acc: 0.856 Test Loss: 0.900 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 375079
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.988527536392212
Epoch: 1, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.064 Vali Acc: 0.467 Test Loss: 2.064 Test Acc: 0.467
Validation loss decreased (inf --> -0.466646).  Saving model ...
Epoch: 2 cost time: 1.3351731300354004
Epoch: 2, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.432 Vali Acc: 0.628 Test Loss: 1.432 Test Acc: 0.628
Validation loss decreased (-0.466646 --> -0.627763).  Saving model ...
Epoch: 3 cost time: 1.476567268371582
Epoch: 3, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
Validation loss decreased (-0.627763 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 1.21712327003479
Epoch: 4, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.666656 --> -0.711102).  Saving model ...
Epoch: 5 cost time: 1.1662039756774902
Epoch: 5, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.711102 --> -0.783326).  Saving model ...
Epoch: 6 cost time: 1.217764139175415
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.4143106937408447
Epoch: 7, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.223635196685791
Epoch: 8, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 1.1186747550964355
Epoch: 9, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.4552578926086426
Epoch: 10, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5201637744903564
Epoch: 11, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3044414520263672
Epoch: 12, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5968525409698486
Epoch: 13, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4795928001403809
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.2706689834594727
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5662262439727783
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4116950035095215
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.756 Vali Acc: 0.844 Test Loss: 0.756 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3869481086730957
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4749174118041992
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.786 Vali Acc: 0.822 Test Loss: 0.786 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.449474811553955
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4791953563690186
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.833 Vali Acc: 0.828 Test Loss: 0.833 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.629441738128662
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.819 Vali Acc: 0.844 Test Loss: 0.819 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4387555122375488
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.769 Vali Acc: 0.833 Test Loss: 0.769 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6632208824157715
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.881 Vali Acc: 0.844 Test Loss: 0.881 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 375079
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.626190662384033
Epoch: 1, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.093 Vali Acc: 0.439 Test Loss: 2.093 Test Acc: 0.439
Validation loss decreased (inf --> -0.438868).  Saving model ...
Epoch: 2 cost time: 1.4519035816192627
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.440 Vali Acc: 0.628 Test Loss: 1.440 Test Acc: 0.628
Validation loss decreased (-0.438868 --> -0.627763).  Saving model ...
Epoch: 3 cost time: 1.2255628108978271
Epoch: 3, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.107 Vali Acc: 0.672 Test Loss: 1.107 Test Acc: 0.672
Validation loss decreased (-0.627763 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.243396520614624
Epoch: 4, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.934 Vali Acc: 0.728 Test Loss: 0.934 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.1331968307495117
Epoch: 5, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.776 Vali Acc: 0.789 Test Loss: 0.776 Test Acc: 0.789
Validation loss decreased (-0.727768 --> -0.788881).  Saving model ...
Epoch: 6 cost time: 1.2814085483551025
Epoch: 6, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.732 Vali Acc: 0.806 Test Loss: 0.732 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.3840856552124023
Epoch: 7, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 8 cost time: 1.5850605964660645
Epoch: 8, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.805548 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.530808925628662
Epoch: 9, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.552330493927002
Epoch: 10, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.248985767364502
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5128257274627686
Epoch: 12, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 13 cost time: 1.6325359344482422
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5158076286315918
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 15 cost time: 1.4172914028167725
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4186971187591553
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.592 Vali Acc: 0.839 Test Loss: 0.592 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.469491720199585
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.686 Vali Acc: 0.856 Test Loss: 0.686 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.287843942642212
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.392385721206665
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4224658012390137
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.47770357131958
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.711 Vali Acc: 0.844 Test Loss: 0.711 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4303927421569824
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.737 Vali Acc: 0.861 Test Loss: 0.737 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.486591100692749
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2856225967407227
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.756 Vali Acc: 0.828 Test Loss: 0.756 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 375079
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6339969635009766
Epoch: 1, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.112 Vali Acc: 0.472 Test Loss: 2.112 Test Acc: 0.472
Validation loss decreased (inf --> -0.472201).  Saving model ...
Epoch: 2 cost time: 1.3999345302581787
Epoch: 2, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.469 Vali Acc: 0.606 Test Loss: 1.469 Test Acc: 0.606
Validation loss decreased (-0.472201 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.541839361190796
Epoch: 3, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.154 Vali Acc: 0.667 Test Loss: 1.154 Test Acc: 0.667
Validation loss decreased (-0.605541 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 1.4941251277923584
Epoch: 4, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705546).  Saving model ...
Epoch: 5 cost time: 1.4160635471343994
Epoch: 5, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
Validation loss decreased (-0.705546 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.4965572357177734
Epoch: 6, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.775 Vali Acc: 0.756 Test Loss: 0.775 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 7 cost time: 1.3394169807434082
Epoch: 7, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.714 Vali Acc: 0.767 Test Loss: 0.714 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 1.540668249130249
Epoch: 8, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.671 Vali Acc: 0.772 Test Loss: 0.671 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 1.0744202136993408
Epoch: 9, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 1.455320119857788
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.5443716049194336
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.662 Vali Acc: 0.778 Test Loss: 0.662 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2517471313476562
Epoch: 12, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 1.5054709911346436
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4670989513397217
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2354276180267334
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4802875518798828
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4107873439788818
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.278914213180542
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4938735961914062
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.499290943145752
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.3051881790161133
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.722 Vali Acc: 0.872 Test Loss: 0.722 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872215).  Saving model ...
Epoch: 22 cost time: 1.540724515914917
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3202567100524902
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4194347858428955
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.694 Vali Acc: 0.856 Test Loss: 0.694 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.335296392440796
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6370112895965576
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2480425834655762
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3866989612579346
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.726 Vali Acc: 0.872 Test Loss: 0.726 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4412004947662354
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872215).  Saving model ...
Epoch: 30 cost time: 1.4289114475250244
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.716 Vali Acc: 0.878 Test Loss: 0.716 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877771).  Saving model ...
Epoch: 31 cost time: 1.483208179473877
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.713 Vali Acc: 0.878 Test Loss: 0.713 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 1.1669180393218994
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4158456325531006
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.878 Test Loss: 0.760 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5982322692871094
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.401599645614624
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.883 Test Loss: 0.753 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 36 cost time: 1.4529345035552979
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.770 Vali Acc: 0.889 Test Loss: 0.770 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 37 cost time: 1.6335747241973877
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.894 Test Loss: 0.794 Test Acc: 0.894
Validation loss decreased (-0.888881 --> -0.894437).  Saving model ...
Epoch: 38 cost time: 1.5101547241210938
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.784 Vali Acc: 0.878 Test Loss: 0.784 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5256233215332031
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.889 Test Loss: 0.784 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6333608627319336
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.878 Test Loss: 0.802 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3769519329071045
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.883 Test Loss: 0.800 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4740772247314453
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.807 Vali Acc: 0.894 Test Loss: 0.807 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.607471227645874
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.817 Vali Acc: 0.883 Test Loss: 0.817 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.62235689163208
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.894 Test Loss: 0.851 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.5215551853179932
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.894 Test Loss: 0.851 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.599299669265747
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.889 Test Loss: 0.849 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3934392929077148
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.888 Vali Acc: 0.878 Test Loss: 0.888 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 375079
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.953692674636841
Epoch: 1, Steps: 12 | Train Loss: 2.648 Vali Loss: 2.231 Vali Acc: 0.333 Test Loss: 2.231 Test Acc: 0.333
Validation loss decreased (inf --> -0.333311).  Saving model ...
Epoch: 2 cost time: 1.3975274562835693
Epoch: 2, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.451 Vali Acc: 0.633 Test Loss: 1.451 Test Acc: 0.633
Validation loss decreased (-0.333311 --> -0.633319).  Saving model ...
Epoch: 3 cost time: 1.3477141857147217
Epoch: 3, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.106 Vali Acc: 0.694 Test Loss: 1.106 Test Acc: 0.694
Validation loss decreased (-0.633319 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 1.426102876663208
Epoch: 4, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.694433 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.2716801166534424
Epoch: 5, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.836 Vali Acc: 0.772 Test Loss: 0.836 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 1.4966909885406494
Epoch: 6, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 1.5116510391235352
Epoch: 7, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.708 Vali Acc: 0.811 Test Loss: 0.708 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3938877582550049
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 9 cost time: 1.301649808883667
Epoch: 9, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.579 Vali Acc: 0.883 Test Loss: 0.579 Test Acc: 0.883
Validation loss decreased (-0.855549 --> -0.883328).  Saving model ...
Epoch: 10 cost time: 1.4416329860687256
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5793612003326416
Epoch: 11, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.575782060623169
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5313420295715332
Epoch: 13, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6322126388549805
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.738 Vali Acc: 0.856 Test Loss: 0.738 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.55912446975708
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4219012260437012
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.767 Vali Acc: 0.844 Test Loss: 0.767 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3408825397491455
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6267571449279785
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.744 Vali Acc: 0.844 Test Loss: 0.744 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4501841068267822
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 342311
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8781700134277344
Epoch: 1, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.224 Vali Acc: 0.339 Test Loss: 2.224 Test Acc: 0.339
Validation loss decreased (inf --> -0.338867).  Saving model ...
Epoch: 2 cost time: 1.323768138885498
Epoch: 2, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.446 Vali Acc: 0.628 Test Loss: 1.446 Test Acc: 0.628
Validation loss decreased (-0.338867 --> -0.627763).  Saving model ...
Epoch: 3 cost time: 1.1663908958435059
Epoch: 3, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.104 Vali Acc: 0.689 Test Loss: 1.104 Test Acc: 0.689
Validation loss decreased (-0.627763 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.3802919387817383
Epoch: 4, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.688878 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.4461474418640137
Epoch: 5, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.835 Vali Acc: 0.783 Test Loss: 0.835 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783325).  Saving model ...
Epoch: 6 cost time: 1.4372525215148926
Epoch: 6, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 1.301171064376831
Epoch: 7, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.359344482421875
Epoch: 8, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.535029649734497
Epoch: 9, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 10 cost time: 1.4425837993621826
Epoch: 10, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.387220859527588
Epoch: 11, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5523579120635986
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.283825159072876
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6095595359802246
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.384209394454956
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5842301845550537
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2508907318115234
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5810024738311768
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.758 Vali Acc: 0.839 Test Loss: 0.758 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.444389820098877
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 342311
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9997169971466064
Epoch: 1, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.228 Vali Acc: 0.317 Test Loss: 2.228 Test Acc: 0.317
Validation loss decreased (inf --> -0.316644).  Saving model ...
Epoch: 2 cost time: 1.2680103778839111
Epoch: 2, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.446 Vali Acc: 0.622 Test Loss: 1.446 Test Acc: 0.622
Validation loss decreased (-0.316644 --> -0.622208).  Saving model ...
Epoch: 3 cost time: 1.3067593574523926
Epoch: 3, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.103 Vali Acc: 0.706 Test Loss: 1.103 Test Acc: 0.706
Validation loss decreased (-0.622208 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 1.3207499980926514
Epoch: 4, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.911 Vali Acc: 0.772 Test Loss: 0.911 Test Acc: 0.772
Validation loss decreased (-0.705545 --> -0.772213).  Saving model ...
Epoch: 5 cost time: 1.4809339046478271
Epoch: 5, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 1.419248342514038
Epoch: 6, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 1.2649319171905518
Epoch: 7, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5527853965759277
Epoch: 8, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 1.5340545177459717
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.4162163734436035
Epoch: 10, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 11 cost time: 1.1639692783355713
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3632678985595703
Epoch: 12, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1259922981262207
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.697 Vali Acc: 0.811 Test Loss: 0.697 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.363229751586914
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2335925102233887
Epoch: 15, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3267297744750977
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.3224084377288818
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2511928081512451
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0937457084655762
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1561269760131836
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.151850700378418
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1032538414001465
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1720116138458252
Epoch: 23, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5208470821380615
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.423304796218872
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.387575626373291
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 342311
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5086991786956787
Epoch: 1, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.228 Vali Acc: 0.367 Test Loss: 2.228 Test Acc: 0.367
Validation loss decreased (inf --> -0.366644).  Saving model ...
Epoch: 2 cost time: 1.1985795497894287
Epoch: 2, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.478 Vali Acc: 0.606 Test Loss: 1.478 Test Acc: 0.606
Validation loss decreased (-0.366644 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.503934621810913
Epoch: 3, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.151 Vali Acc: 0.683 Test Loss: 1.151 Test Acc: 0.683
Validation loss decreased (-0.605541 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 1.4454219341278076
Epoch: 4, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.973 Vali Acc: 0.689 Test Loss: 0.973 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 5 cost time: 1.5637850761413574
Epoch: 5, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
Validation loss decreased (-0.688879 --> -0.733325).  Saving model ...
Epoch: 6 cost time: 1.3491969108581543
Epoch: 6, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 1.5016467571258545
Epoch: 7, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.728 Vali Acc: 0.794 Test Loss: 0.728 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 1.4253675937652588
Epoch: 8, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.523280382156372
Epoch: 9, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.741614818572998
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4782238006591797
Epoch: 11, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
Validation loss decreased (-0.799994 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 1.396742820739746
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0028352737426758
Epoch: 13, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4063396453857422
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.6915113925933838
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5950467586517334
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.6304972171783447
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5855939388275146
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3566994667053223
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6564176082611084
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.643 Vali Acc: 0.817 Test Loss: 0.643 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4021704196929932
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 1.456282615661621
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6871652603149414
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5679724216461182
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4248933792114258
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4510231018066406
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.683 Vali Acc: 0.867 Test Loss: 0.683 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5059027671813965
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.684 Vali Acc: 0.883 Test Loss: 0.684 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 28 cost time: 1.397829532623291
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.691 Vali Acc: 0.872 Test Loss: 0.691 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5927512645721436
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.717 Vali Acc: 0.883 Test Loss: 0.717 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3751325607299805
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.704 Vali Acc: 0.883 Test Loss: 0.704 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.326338291168213
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.777 Vali Acc: 0.883 Test Loss: 0.777 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5901174545288086
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.889 Test Loss: 0.769 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 33 cost time: 1.4691221714019775
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.750 Vali Acc: 0.872 Test Loss: 0.750 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4045050144195557
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.763 Vali Acc: 0.883 Test Loss: 0.763 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.156308650970459
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.878 Test Loss: 0.738 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.396068811416626
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.756 Vali Acc: 0.878 Test Loss: 0.756 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2277488708496094
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.883 Test Loss: 0.793 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4542982578277588
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.800 Vali Acc: 0.883 Test Loss: 0.800 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.623152732849121
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.795 Vali Acc: 0.878 Test Loss: 0.795 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5414783954620361
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.780 Vali Acc: 0.883 Test Loss: 0.780 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5224192142486572
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.863 Vali Acc: 0.872 Test Loss: 0.863 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6541640758514404
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.818 Vali Acc: 0.878 Test Loss: 0.818 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 342311
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.847287893295288
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.384 Vali Acc: 0.189 Test Loss: 2.384 Test Acc: 0.189
Validation loss decreased (inf --> -0.188865).  Saving model ...
Epoch: 2 cost time: 1.357301950454712
Epoch: 2, Steps: 12 | Train Loss: 2.196 Vali Loss: 1.849 Vali Acc: 0.522 Test Loss: 1.849 Test Acc: 0.522
Validation loss decreased (-0.188865 --> -0.522204).  Saving model ...
Epoch: 3 cost time: 1.5267412662506104
Epoch: 3, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.456 Vali Acc: 0.633 Test Loss: 1.456 Test Acc: 0.633
Validation loss decreased (-0.522204 --> -0.633319).  Saving model ...
Epoch: 4 cost time: 1.3867652416229248
Epoch: 4, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.210 Vali Acc: 0.672 Test Loss: 1.210 Test Acc: 0.672
Validation loss decreased (-0.633319 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.4519813060760498
Epoch: 5, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.024 Vali Acc: 0.728 Test Loss: 1.024 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 1.316361665725708
Epoch: 6, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.932 Vali Acc: 0.744 Test Loss: 0.932 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.26220703125
Epoch: 7, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761103).  Saving model ...
Epoch: 8 cost time: 1.363065242767334
Epoch: 8, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.790 Vali Acc: 0.794 Test Loss: 0.790 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 1.133922815322876
Epoch: 9, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827770).  Saving model ...
Epoch: 10 cost time: 1.3419890403747559
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3093886375427246
Epoch: 11, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.718 Vali Acc: 0.828 Test Loss: 0.718 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.3161897659301758
Epoch: 12, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.2335667610168457
Epoch: 13, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 1.2453579902648926
Epoch: 14, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 15 cost time: 1.389472246170044
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2603919506072998
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3907594680786133
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2644741535186768
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 1.2843961715698242
Epoch: 19, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4131488800048828
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3984079360961914
Epoch: 21, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.378760814666748
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2642123699188232
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.295274019241333
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2810306549072266
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.515852451324463
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3045568466186523
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2726280689239502
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 646311
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7806591987609863
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.395 Vali Acc: 0.206 Test Loss: 2.395 Test Acc: 0.206
Validation loss decreased (inf --> -0.205532).  Saving model ...
Epoch: 2 cost time: 1.3222908973693848
Epoch: 2, Steps: 12 | Train Loss: 2.193 Vali Loss: 1.854 Vali Acc: 0.478 Test Loss: 1.854 Test Acc: 0.478
Validation loss decreased (-0.205532 --> -0.477759).  Saving model ...
Epoch: 3 cost time: 1.2041969299316406
Epoch: 3, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.455 Vali Acc: 0.639 Test Loss: 1.455 Test Acc: 0.639
Validation loss decreased (-0.477759 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.2352166175842285
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.203 Vali Acc: 0.672 Test Loss: 1.203 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.2341022491455078
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.018 Vali Acc: 0.728 Test Loss: 1.018 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 1.3046865463256836
Epoch: 6, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 1.3337509632110596
Epoch: 7, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.841 Vali Acc: 0.767 Test Loss: 0.841 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.3011150360107422
Epoch: 8, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.785 Vali Acc: 0.794 Test Loss: 0.785 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 1.2672507762908936
Epoch: 9, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
Validation loss decreased (-0.794437 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 1.3189420700073242
Epoch: 10, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.718 Vali Acc: 0.811 Test Loss: 0.718 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1894605159759521
Epoch: 11, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1311986446380615
Epoch: 12, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.2594387531280518
Epoch: 13, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.640 Vali Acc: 0.844 Test Loss: 0.640 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.32676362991333
Epoch: 14, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.322392225265503
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 1.4888062477111816
Epoch: 16, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4617900848388672
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2622787952423096
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.623 Vali Acc: 0.872 Test Loss: 0.623 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 19 cost time: 1.1167736053466797
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1877973079681396
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2964375019073486
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.275611162185669
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2266027927398682
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.348792314529419
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2027122974395752
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.603 Vali Acc: 0.878 Test Loss: 0.603 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.2889044284820557
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.650 Vali Acc: 0.889 Test Loss: 0.650 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888882).  Saving model ...
Epoch: 27 cost time: 1.3392033576965332
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4359240531921387
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4007253646850586
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5032930374145508
Epoch: 30, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2364919185638428
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.366046667098999
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4924581050872803
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7167446613311768
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.33201265335083
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.709 Vali Acc: 0.867 Test Loss: 0.709 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5963702201843262
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.707 Vali Acc: 0.867 Test Loss: 0.707 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 646311
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7120418548583984
Epoch: 1, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.408 Vali Acc: 0.200 Test Loss: 2.408 Test Acc: 0.200
Validation loss decreased (inf --> -0.199976).  Saving model ...
Epoch: 2 cost time: 1.4895288944244385
Epoch: 2, Steps: 12 | Train Loss: 2.208 Vali Loss: 1.861 Vali Acc: 0.506 Test Loss: 1.861 Test Acc: 0.506
Validation loss decreased (-0.199976 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 1.4255499839782715
Epoch: 3, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.456 Vali Acc: 0.639 Test Loss: 1.456 Test Acc: 0.639
Validation loss decreased (-0.505537 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.360156774520874
Epoch: 4, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.201 Vali Acc: 0.683 Test Loss: 1.201 Test Acc: 0.683
Validation loss decreased (-0.638874 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.3298709392547607
Epoch: 5, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.017 Vali Acc: 0.722 Test Loss: 1.017 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.3654263019561768
Epoch: 6, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.927 Vali Acc: 0.728 Test Loss: 0.927 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 1.4281094074249268
Epoch: 7, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.840 Vali Acc: 0.778 Test Loss: 0.840 Test Acc: 0.778
Validation loss decreased (-0.727769 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.4429638385772705
Epoch: 8, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.768 Vali Acc: 0.794 Test Loss: 0.768 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 1.4040095806121826
Epoch: 9, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.720 Vali Acc: 0.817 Test Loss: 0.720 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.3582239151000977
Epoch: 10, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2787511348724365
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 1.291818380355835
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.3662009239196777
Epoch: 13, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5509834289550781
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 15 cost time: 1.5541772842407227
Epoch: 15, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 1.422394037246704
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3010287284851074
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4034204483032227
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3001279830932617
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3259801864624023
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3969459533691406
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.417855978012085
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3882255554199219
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3066058158874512
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 1.2506141662597656
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.460892677307129
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.580 Vali Acc: 0.894 Test Loss: 0.580 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 27 cost time: 1.4844136238098145
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5105266571044922
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.631 Vali Acc: 0.883 Test Loss: 0.631 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.348278522491455
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3980891704559326
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4843945503234863
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5427558422088623
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.655 Vali Acc: 0.878 Test Loss: 0.655 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.425811529159546
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.517075777053833
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.423865556716919
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.643 Vali Acc: 0.883 Test Loss: 0.643 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1927573680877686
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 646311
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.584421396255493
Epoch: 1, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.418 Vali Acc: 0.244 Test Loss: 2.418 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 1.237842082977295
Epoch: 2, Steps: 12 | Train Loss: 2.214 Vali Loss: 1.886 Vali Acc: 0.550 Test Loss: 1.886 Test Acc: 0.550
Validation loss decreased (-0.244420 --> -0.549981).  Saving model ...
Epoch: 3 cost time: 1.2442858219146729
Epoch: 3, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.494 Vali Acc: 0.628 Test Loss: 1.494 Test Acc: 0.628
Validation loss decreased (-0.549981 --> -0.627763).  Saving model ...
Epoch: 4 cost time: 1.1861553192138672
Epoch: 4, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.251 Vali Acc: 0.661 Test Loss: 1.251 Test Acc: 0.661
Validation loss decreased (-0.627763 --> -0.661099).  Saving model ...
Epoch: 5 cost time: 1.1295804977416992
Epoch: 5, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.068 Vali Acc: 0.689 Test Loss: 1.068 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 1.100372076034546
Epoch: 6, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.995 Vali Acc: 0.683 Test Loss: 0.995 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.130185842514038
Epoch: 7, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 1.4235045909881592
Epoch: 8, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.3501307964324951
Epoch: 9, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 1.3756332397460938
Epoch: 10, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.759 Vali Acc: 0.750 Test Loss: 0.759 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0282294750213623
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 1.2945594787597656
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 13 cost time: 1.1415014266967773
Epoch: 13, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.623 Vali Acc: 0.794 Test Loss: 0.623 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 1.1419847011566162
Epoch: 14, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.1611084938049316
Epoch: 15, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0725829601287842
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 17 cost time: 1.1389970779418945
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 18 cost time: 1.1347572803497314
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1773922443389893
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 20 cost time: 1.3044779300689697
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.822217 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.201540470123291
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4073154926300049
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3312554359436035
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.536 Vali Acc: 0.839 Test Loss: 0.536 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2935640811920166
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2561917304992676
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1977765560150146
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.347120761871338
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3348667621612549
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3789820671081543
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 1.4021029472351074
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.33139967918396
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.38620924949646
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 33 cost time: 1.4621555805206299
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.656 Vali Acc: 0.867 Test Loss: 0.656 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4062609672546387
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4744226932525635
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.644 Vali Acc: 0.867 Test Loss: 0.644 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3800528049468994
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.647 Vali Acc: 0.878 Test Loss: 0.647 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.364330530166626
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.650 Vali Acc: 0.872 Test Loss: 0.650 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2420470714569092
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.706 Vali Acc: 0.861 Test Loss: 0.706 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3006665706634521
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.692 Vali Acc: 0.883 Test Loss: 0.692 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 40 cost time: 1.332348108291626
Epoch: 40, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.695 Vali Acc: 0.883 Test Loss: 0.695 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4979333877563477
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.744 Vali Acc: 0.872 Test Loss: 0.744 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4637627601623535
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.791 Vali Acc: 0.867 Test Loss: 0.791 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4687752723693848
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.750 Vali Acc: 0.867 Test Loss: 0.750 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2611277103424072
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.813 Vali Acc: 0.867 Test Loss: 0.813 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4017820358276367
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.746 Vali Acc: 0.878 Test Loss: 0.746 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5637297630310059
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.872 Test Loss: 0.754 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4727108478546143
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.774 Vali Acc: 0.878 Test Loss: 0.774 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.463531494140625
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.797 Vali Acc: 0.872 Test Loss: 0.797 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5126383304595947
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.801 Vali Acc: 0.878 Test Loss: 0.801 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 646311
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.441403388977051
Epoch: 1, Steps: 12 | Train Loss: 2.850 Vali Loss: 2.488 Vali Acc: 0.150 Test Loss: 2.488 Test Acc: 0.150
Validation loss decreased (inf --> -0.149975).  Saving model ...
Epoch: 2 cost time: 1.353790521621704
Epoch: 2, Steps: 12 | Train Loss: 2.312 Vali Loss: 1.903 Vali Acc: 0.483 Test Loss: 1.903 Test Acc: 0.483
Validation loss decreased (-0.149975 --> -0.483314).  Saving model ...
Epoch: 3 cost time: 1.4121601581573486
Epoch: 3, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.491 Vali Acc: 0.639 Test Loss: 1.491 Test Acc: 0.639
Validation loss decreased (-0.483314 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.2801697254180908
Epoch: 4, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.238 Vali Acc: 0.706 Test Loss: 1.238 Test Acc: 0.706
Validation loss decreased (-0.638874 --> -0.705543).  Saving model ...
Epoch: 5 cost time: 1.40293550491333
Epoch: 5, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.072 Vali Acc: 0.722 Test Loss: 1.072 Test Acc: 0.722
Validation loss decreased (-0.705543 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.3304574489593506
Epoch: 6, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 1.484931230545044
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.875 Vali Acc: 0.772 Test Loss: 0.875 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772213).  Saving model ...
Epoch: 8 cost time: 1.423619031906128
Epoch: 8, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.824 Vali Acc: 0.806 Test Loss: 0.824 Test Acc: 0.806
Validation loss decreased (-0.772213 --> -0.805547).  Saving model ...
Epoch: 9 cost time: 1.3727822303771973
Epoch: 9, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.760 Vali Acc: 0.811 Test Loss: 0.760 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.2685298919677734
Epoch: 10, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 1.4117791652679443
Epoch: 11, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.700 Vali Acc: 0.828 Test Loss: 0.700 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.211463212966919
Epoch: 12, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.342233419418335
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.2996587753295898
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.091491460800171
Epoch: 15, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 1.0948712825775146
Epoch: 16, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2117326259613037
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.241905927658081
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.361435890197754
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.1560239791870117
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.280245065689087
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2830042839050293
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.1023094654083252
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3600270748138428
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3031911849975586
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3070237636566162
Epoch: 26, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4050228595733643
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.647 Vali Acc: 0.856 Test Loss: 0.647 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.27457594871521
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.273423194885254
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.251492977142334
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.401008129119873
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.314192295074463
Epoch: 32, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 384167
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.187715530395508
Epoch: 1, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.482 Vali Acc: 0.144 Test Loss: 2.482 Test Acc: 0.144
Validation loss decreased (inf --> -0.144420).  Saving model ...
Epoch: 2 cost time: 1.353100061416626
Epoch: 2, Steps: 12 | Train Loss: 2.310 Vali Loss: 1.897 Vali Acc: 0.506 Test Loss: 1.897 Test Acc: 0.506
Validation loss decreased (-0.144420 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 1.330568552017212
Epoch: 3, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.484 Vali Acc: 0.650 Test Loss: 1.484 Test Acc: 0.650
Validation loss decreased (-0.505537 --> -0.649985).  Saving model ...
Epoch: 4 cost time: 1.4049110412597656
Epoch: 4, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.233 Vali Acc: 0.700 Test Loss: 1.233 Test Acc: 0.700
Validation loss decreased (-0.649985 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.3511486053466797
Epoch: 5, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.066 Vali Acc: 0.733 Test Loss: 1.066 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.3898844718933105
Epoch: 6, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.937 Vali Acc: 0.722 Test Loss: 0.937 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3258824348449707
Epoch: 7, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.871 Vali Acc: 0.767 Test Loss: 0.871 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.474071979522705
Epoch: 8, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.813 Vali Acc: 0.811 Test Loss: 0.813 Test Acc: 0.811
Validation loss decreased (-0.766658 --> -0.811103).  Saving model ...
Epoch: 9 cost time: 1.4460711479187012
Epoch: 9, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.759 Vali Acc: 0.806 Test Loss: 0.759 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4876916408538818
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 1.314082384109497
Epoch: 11, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.695 Vali Acc: 0.817 Test Loss: 0.695 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2516460418701172
Epoch: 12, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 1.3083250522613525
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.0396478176116943
Epoch: 14, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.0223677158355713
Epoch: 15, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 0.9921975135803223
Epoch: 16, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.183393955230713
Epoch: 17, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.445403814315796
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4571046829223633
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.1565518379211426
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.473015546798706
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5270440578460693
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.6293933391571045
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.511042833328247
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5254707336425781
Epoch: 25, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.315213680267334
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.646 Vali Acc: 0.878 Test Loss: 0.646 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4475064277648926
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.644 Vali Acc: 0.872 Test Loss: 0.644 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.464050054550171
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.683 Vali Acc: 0.867 Test Loss: 0.683 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3561296463012695
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5193474292755127
Epoch: 30, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.711 Vali Acc: 0.867 Test Loss: 0.711 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.452181100845337
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.710 Vali Acc: 0.861 Test Loss: 0.710 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2101519107818604
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 384167
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.739337921142578
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.476 Vali Acc: 0.200 Test Loss: 2.476 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 1.4233624935150146
Epoch: 2, Steps: 12 | Train Loss: 2.292 Vali Loss: 1.891 Vali Acc: 0.506 Test Loss: 1.891 Test Acc: 0.506
Validation loss decreased (-0.199975 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 1.5881052017211914
Epoch: 3, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.473 Vali Acc: 0.661 Test Loss: 1.473 Test Acc: 0.661
Validation loss decreased (-0.505537 --> -0.661096).  Saving model ...
Epoch: 4 cost time: 1.1855432987213135
Epoch: 4, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.223 Vali Acc: 0.700 Test Loss: 1.223 Test Acc: 0.700
Validation loss decreased (-0.661096 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.3930518627166748
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.060 Vali Acc: 0.711 Test Loss: 1.060 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 1.5725281238555908
Epoch: 6, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 1.3714404106140137
Epoch: 7, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.860 Vali Acc: 0.772 Test Loss: 0.860 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 1.4430077075958252
Epoch: 8, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.801 Vali Acc: 0.789 Test Loss: 0.801 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 1.5019845962524414
Epoch: 9, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.740 Vali Acc: 0.811 Test Loss: 0.740 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.3073554039001465
Epoch: 10, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.2688312530517578
Epoch: 11, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1702375411987305
Epoch: 12, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.2906582355499268
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.4360127449035645
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.3372547626495361
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2680330276489258
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.334867238998413
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.434626579284668
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4215950965881348
Epoch: 19, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3495309352874756
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.36922287940979
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5624611377716064
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.4185559749603271
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.571 Vali Acc: 0.878 Test Loss: 0.571 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4095451831817627
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.33842134475708
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2897083759307861
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.596 Vali Acc: 0.883 Test Loss: 0.596 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 27 cost time: 1.464832067489624
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4420721530914307
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.662 Vali Acc: 0.883 Test Loss: 0.662 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.373417854309082
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5242030620574951
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.588315486907959
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.295975923538208
Epoch: 32, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3658416271209717
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.675 Vali Acc: 0.878 Test Loss: 0.675 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3087821006774902
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.696 Vali Acc: 0.883 Test Loss: 0.696 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5379478931427002
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3443312644958496
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 384167
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.598214626312256
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.449 Vali Acc: 0.233 Test Loss: 2.449 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 1.1516361236572266
Epoch: 2, Steps: 12 | Train Loss: 2.260 Vali Loss: 1.875 Vali Acc: 0.628 Test Loss: 1.875 Test Acc: 0.628
Validation loss decreased (-0.233309 --> -0.627759).  Saving model ...
Epoch: 3 cost time: 1.2013394832611084
Epoch: 3, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.461 Vali Acc: 0.672 Test Loss: 1.461 Test Acc: 0.672
Validation loss decreased (-0.627759 --> -0.672208).  Saving model ...
Epoch: 4 cost time: 1.3564157485961914
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.228 Vali Acc: 0.694 Test Loss: 1.228 Test Acc: 0.694
Validation loss decreased (-0.672208 --> -0.694432).  Saving model ...
Epoch: 5 cost time: 1.1396548748016357
Epoch: 5, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 1.148245096206665
Epoch: 6, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.954 Vali Acc: 0.678 Test Loss: 0.954 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2361693382263184
Epoch: 7, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.897 Vali Acc: 0.694 Test Loss: 0.897 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 1.1741788387298584
Epoch: 8, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.842 Vali Acc: 0.744 Test Loss: 0.842 Test Acc: 0.744
Validation loss decreased (-0.694435 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.2298533916473389
Epoch: 9, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.781 Vali Acc: 0.778 Test Loss: 0.781 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 1.0467028617858887
Epoch: 10, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.2148001194000244
Epoch: 11, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.2482380867004395
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0773735046386719
Epoch: 13, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.670 Vali Acc: 0.794 Test Loss: 0.670 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2594237327575684
Epoch: 14, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1367018222808838
Epoch: 15, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.599 Vali Acc: 0.811 Test Loss: 0.599 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 1.284590244293213
Epoch: 16, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.561 Vali Acc: 0.817 Test Loss: 0.561 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 1.303419589996338
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 1.3604159355163574
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 1.264108657836914
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2691335678100586
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.389744520187378
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4599049091339111
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3060436248779297
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.108323335647583
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 1.2768311500549316
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3480007648468018
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2682762145996094
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1939809322357178
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1407575607299805
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.343977689743042
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.651 Vali Acc: 0.861 Test Loss: 0.651 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1711649894714355
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866660).  Saving model ...
Epoch: 32 cost time: 1.325845718383789
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1856603622436523
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 34 cost time: 1.067155122756958
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2736787796020508
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2957077026367188
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3003816604614258
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.761 Vali Acc: 0.861 Test Loss: 0.761 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3894472122192383
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.728 Vali Acc: 0.867 Test Loss: 0.728 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3138372898101807
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.761 Vali Acc: 0.861 Test Loss: 0.761 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1668436527252197
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.715 Vali Acc: 0.861 Test Loss: 0.715 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.420724630355835
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0991156101226807
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.727 Vali Acc: 0.872 Test Loss: 0.727 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0121266841888428
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.780 Vali Acc: 0.867 Test Loss: 0.780 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 384167
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6559412479400635
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.607 Vali Acc: 0.222 Test Loss: 2.607 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 1.4845762252807617
Epoch: 2, Steps: 12 | Train Loss: 2.308 Vali Loss: 1.958 Vali Acc: 0.467 Test Loss: 1.958 Test Acc: 0.467
Validation loss decreased (-0.222196 --> -0.466647).  Saving model ...
Epoch: 3 cost time: 1.3720026016235352
Epoch: 3, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.527 Vali Acc: 0.589 Test Loss: 1.527 Test Acc: 0.589
Validation loss decreased (-0.466647 --> -0.588874).  Saving model ...
Epoch: 4 cost time: 1.2509799003601074
Epoch: 4, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.261 Vali Acc: 0.678 Test Loss: 1.261 Test Acc: 0.678
Validation loss decreased (-0.588874 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 1.2746076583862305
Epoch: 5, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.064 Vali Acc: 0.744 Test Loss: 1.064 Test Acc: 0.744
Validation loss decreased (-0.677765 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 1.2236387729644775
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.2271473407745361
Epoch: 7, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.884 Vali Acc: 0.778 Test Loss: 0.884 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.2037467956542969
Epoch: 8, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.821 Vali Acc: 0.817 Test Loss: 0.821 Test Acc: 0.817
Validation loss decreased (-0.777769 --> -0.816658).  Saving model ...
Epoch: 9 cost time: 1.261425256729126
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 10 cost time: 1.2924306392669678
Epoch: 10, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.749 Vali Acc: 0.811 Test Loss: 0.749 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1297483444213867
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 1.1174437999725342
Epoch: 12, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4104499816894531
Epoch: 13, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.711 Vali Acc: 0.839 Test Loss: 0.711 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.2680268287658691
Epoch: 14, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.059145450592041
Epoch: 15, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866660).  Saving model ...
Epoch: 16 cost time: 1.3593692779541016
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4741098880767822
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 1.2570266723632812
Epoch: 18, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4150795936584473
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.631 Vali Acc: 0.872 Test Loss: 0.631 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.4071261882781982
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4050769805908203
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3536674976348877
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2921726703643799
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2096824645996094
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.651 Vali Acc: 0.861 Test Loss: 0.651 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2642052173614502
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3685975074768066
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.280287742614746
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2747654914855957
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2218363285064697
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 253095
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9873850345611572
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.624 Vali Acc: 0.156 Test Loss: 2.624 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.3053340911865234
Epoch: 2, Steps: 12 | Train Loss: 2.304 Vali Loss: 1.974 Vali Acc: 0.433 Test Loss: 1.974 Test Acc: 0.433
Validation loss decreased (-0.155529 --> -0.433314).  Saving model ...
Epoch: 3 cost time: 1.3474044799804688
Epoch: 3, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.537 Vali Acc: 0.544 Test Loss: 1.537 Test Acc: 0.544
Validation loss decreased (-0.433314 --> -0.544429).  Saving model ...
Epoch: 4 cost time: 1.2684829235076904
Epoch: 4, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.267 Vali Acc: 0.683 Test Loss: 1.267 Test Acc: 0.683
Validation loss decreased (-0.544429 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.283585786819458
Epoch: 5, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.073 Vali Acc: 0.722 Test Loss: 1.073 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722211).  Saving model ...
Epoch: 6 cost time: 1.3987352848052979
Epoch: 6, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 1.3620469570159912
Epoch: 7, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788880).  Saving model ...
Epoch: 8 cost time: 1.4320871829986572
Epoch: 8, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.823 Vali Acc: 0.794 Test Loss: 0.823 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.2402434349060059
Epoch: 9, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.764 Vali Acc: 0.817 Test Loss: 0.764 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.646087884902954
Epoch: 10, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2070808410644531
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.3671746253967285
Epoch: 12, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.666 Vali Acc: 0.828 Test Loss: 0.666 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3939776420593262
Epoch: 13, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.707 Vali Acc: 0.839 Test Loss: 0.707 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.2599687576293945
Epoch: 14, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.258948802947998
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 1.2824432849884033
Epoch: 16, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1385116577148438
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.286210536956787
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2949209213256836
Epoch: 19, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.631 Vali Acc: 0.872 Test Loss: 0.631 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.203540563583374
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.26173996925354
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.475543737411499
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4258196353912354
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3132305145263672
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3363029956817627
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4624454975128174
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5819580554962158
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4922797679901123
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.698 Vali Acc: 0.844 Test Loss: 0.698 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5741214752197266
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 253095
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.614380359649658
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.616 Vali Acc: 0.183 Test Loss: 2.616 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 1.378758192062378
Epoch: 2, Steps: 12 | Train Loss: 2.302 Vali Loss: 1.964 Vali Acc: 0.467 Test Loss: 1.964 Test Acc: 0.467
Validation loss decreased (-0.183307 --> -0.466647).  Saving model ...
Epoch: 3 cost time: 1.3290867805480957
Epoch: 3, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.522 Vali Acc: 0.600 Test Loss: 1.522 Test Acc: 0.600
Validation loss decreased (-0.466647 --> -0.599985).  Saving model ...
Epoch: 4 cost time: 1.3762133121490479
Epoch: 4, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.254 Vali Acc: 0.694 Test Loss: 1.254 Test Acc: 0.694
Validation loss decreased (-0.599985 --> -0.694432).  Saving model ...
Epoch: 5 cost time: 1.0152437686920166
Epoch: 5, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.064 Vali Acc: 0.728 Test Loss: 1.064 Test Acc: 0.728
Validation loss decreased (-0.694432 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.4823856353759766
Epoch: 6, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.948 Vali Acc: 0.717 Test Loss: 0.948 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1929066181182861
Epoch: 7, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.873 Vali Acc: 0.767 Test Loss: 0.873 Test Acc: 0.767
Validation loss decreased (-0.727767 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.2708406448364258
Epoch: 8, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.797 Vali Acc: 0.794 Test Loss: 0.797 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.1656403541564941
Epoch: 9, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.739 Vali Acc: 0.817 Test Loss: 0.739 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.086198329925537
Epoch: 10, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.724 Vali Acc: 0.811 Test Loss: 0.724 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2058289051055908
Epoch: 11, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.1191706657409668
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1232664585113525
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.1103174686431885
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.0784876346588135
Epoch: 15, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 1.288968563079834
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.428309679031372
Epoch: 17, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4540350437164307
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.366701364517212
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.377007246017456
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.40993070602417
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.4208738803863525
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6457288265228271
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3535256385803223
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 25 cost time: 1.4250240325927734
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4942734241485596
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2311911582946777
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1175456047058105
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.624 Vali Acc: 0.883 Test Loss: 0.624 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2390773296356201
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1476099491119385
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.644 Vali Acc: 0.872 Test Loss: 0.644 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4656732082366943
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.150702714920044
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.646 Vali Acc: 0.883 Test Loss: 0.646 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.443068265914917
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.701 Vali Acc: 0.883 Test Loss: 0.701 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3733599185943604
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 253095
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5558886528015137
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.595 Vali Acc: 0.178 Test Loss: 2.595 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.2155249118804932
Epoch: 2, Steps: 12 | Train Loss: 2.277 Vali Loss: 1.972 Vali Acc: 0.433 Test Loss: 1.972 Test Acc: 0.433
Validation loss decreased (-0.177752 --> -0.433314).  Saving model ...
Epoch: 3 cost time: 1.0998146533966064
Epoch: 3, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.541 Vali Acc: 0.633 Test Loss: 1.541 Test Acc: 0.633
Validation loss decreased (-0.433314 --> -0.633318).  Saving model ...
Epoch: 4 cost time: 1.1816623210906982
Epoch: 4, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.290 Vali Acc: 0.672 Test Loss: 1.290 Test Acc: 0.672
Validation loss decreased (-0.633318 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.2917006015777588
Epoch: 5, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.115 Vali Acc: 0.678 Test Loss: 1.115 Test Acc: 0.678
Validation loss decreased (-0.672209 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.3619916439056396
Epoch: 6, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.004 Vali Acc: 0.683 Test Loss: 1.004 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 1.3050878047943115
Epoch: 7, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.933 Vali Acc: 0.711 Test Loss: 0.933 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 1.2928094863891602
Epoch: 8, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.858 Vali Acc: 0.728 Test Loss: 0.858 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 9 cost time: 1.2874782085418701
Epoch: 9, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
Validation loss decreased (-0.727769 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 1.3436880111694336
Epoch: 10, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.759 Vali Acc: 0.794 Test Loss: 0.759 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 1.3298323154449463
Epoch: 11, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.274310827255249
Epoch: 12, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.242490291595459
Epoch: 13, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.4119303226470947
Epoch: 14, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805550).  Saving model ...
Epoch: 15 cost time: 1.2606079578399658
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.590 Vali Acc: 0.794 Test Loss: 0.590 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4258296489715576
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.585 Vali Acc: 0.817 Test Loss: 0.585 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 1.223027229309082
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.3413865566253662
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4274132251739502
Epoch: 19, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.2733831405639648
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.542370319366455
Epoch: 21, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4091384410858154
Epoch: 22, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1992309093475342
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3291175365447998
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2854862213134766
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 1.296900987625122
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1035573482513428
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0982427597045898
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.189955711364746
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.254638433456421
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1815178394317627
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.203857183456421
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 33 cost time: 1.176555871963501
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1375946998596191
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 35 cost time: 1.2116472721099854
Epoch: 35, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1805944442749023
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.693 Vali Acc: 0.878 Test Loss: 0.693 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 37 cost time: 1.0985333919525146
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3271408081054688
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3048722743988037
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.685 Vali Acc: 0.861 Test Loss: 0.685 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3016643524169922
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2836511135101318
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.692 Vali Acc: 0.878 Test Loss: 0.692 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 42 cost time: 1.3995225429534912
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2679939270019531
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.718 Vali Acc: 0.872 Test Loss: 0.718 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3591432571411133
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2100157737731934
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.778 Vali Acc: 0.872 Test Loss: 0.778 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3075392246246338
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.780 Vali Acc: 0.867 Test Loss: 0.780 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2008543014526367
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.802 Vali Acc: 0.872 Test Loss: 0.802 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2522358894348145
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3202171325683594
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.804 Vali Acc: 0.872 Test Loss: 0.804 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.362262487411499
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.842 Vali Acc: 0.861 Test Loss: 0.842 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3271572589874268
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.828 Vali Acc: 0.867 Test Loss: 0.828 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 253095
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.47202467918396
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.387 Vali Acc: 0.183 Test Loss: 2.387 Test Acc: 0.183
Validation loss decreased (inf --> -0.183309).  Saving model ...
Epoch: 2 cost time: 1.397386074066162
Epoch: 2, Steps: 12 | Train Loss: 2.223 Vali Loss: 1.838 Vali Acc: 0.539 Test Loss: 1.838 Test Acc: 0.539
Validation loss decreased (-0.183309 --> -0.538871).  Saving model ...
Epoch: 3 cost time: 1.3768861293792725
Epoch: 3, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.444 Vali Acc: 0.650 Test Loss: 1.444 Test Acc: 0.650
Validation loss decreased (-0.538871 --> -0.649986).  Saving model ...
Epoch: 4 cost time: 1.2794601917266846
Epoch: 4, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.649986 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.2167956829071045
Epoch: 5, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.079 Vali Acc: 0.722 Test Loss: 1.079 Test Acc: 0.722
Validation loss decreased (-0.699988 --> -0.722211).  Saving model ...
Epoch: 6 cost time: 1.243739128112793
Epoch: 6, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 1.4429340362548828
Epoch: 7, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
Validation loss decreased (-0.738879 --> -0.772213).  Saving model ...
Epoch: 8 cost time: 1.0781035423278809
Epoch: 8, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.3543477058410645
Epoch: 9, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.776 Vali Acc: 0.806 Test Loss: 0.776 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.426767349243164
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.773 Vali Acc: 0.806 Test Loss: 0.773 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.4098806381225586
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.1680493354797363
Epoch: 12, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.700 Vali Acc: 0.817 Test Loss: 0.700 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0956010818481445
Epoch: 13, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.3510818481445312
Epoch: 14, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 1.4649114608764648
Epoch: 15, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2781150341033936
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4023354053497314
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5732638835906982
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.4767918586730957
Epoch: 19, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.5886292457580566
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5155131816864014
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4655370712280273
Epoch: 22, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2811996936798096
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2688095569610596
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3274431228637695
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5158419609069824
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3268706798553467
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.335789680480957
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.674 Vali Acc: 0.872 Test Loss: 0.674 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3424012660980225
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 187559
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.653446674346924
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.399 Vali Acc: 0.222 Test Loss: 2.399 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.3834753036499023
Epoch: 2, Steps: 12 | Train Loss: 2.248 Vali Loss: 1.844 Vali Acc: 0.550 Test Loss: 1.844 Test Acc: 0.550
Validation loss decreased (-0.222198 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 1.307281732559204
Epoch: 3, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.445 Vali Acc: 0.667 Test Loss: 1.445 Test Acc: 0.667
Validation loss decreased (-0.549982 --> -0.666652).  Saving model ...
Epoch: 4 cost time: 1.326392650604248
Epoch: 4, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.229 Vali Acc: 0.678 Test Loss: 1.229 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 1.1851069927215576
Epoch: 5, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.079 Vali Acc: 0.744 Test Loss: 1.079 Test Acc: 0.744
Validation loss decreased (-0.677765 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 1.34407377243042
Epoch: 6, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.392991304397583
Epoch: 7, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
Validation loss decreased (-0.744434 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.355985164642334
Epoch: 8, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 1.1985831260681152
Epoch: 9, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.767 Vali Acc: 0.806 Test Loss: 0.767 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.1533372402191162
Epoch: 10, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2923424243927002
Epoch: 11, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.697 Vali Acc: 0.828 Test Loss: 0.697 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.237083911895752
Epoch: 12, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.2810556888580322
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.2868266105651855
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 1.3134765625
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.219933032989502
Epoch: 16, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9973893165588379
Epoch: 17, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3128907680511475
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.420888900756836
Epoch: 19, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.387843370437622
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.472304105758667
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 1.2895658016204834
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.340963363647461
Epoch: 23, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2693843841552734
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2960224151611328
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3543875217437744
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3638219833374023
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2836222648620605
Epoch: 28, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.654 Vali Acc: 0.883 Test Loss: 0.654 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 29 cost time: 1.2218410968780518
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.396195650100708
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3707082271575928
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2715671062469482
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2532055377960205
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3097259998321533
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.183020830154419
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.750 Vali Acc: 0.867 Test Loss: 0.750 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.965383768081665
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.710 Vali Acc: 0.878 Test Loss: 0.710 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0659730434417725
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9994966983795166
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 187559
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.573462724685669
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.405 Vali Acc: 0.200 Test Loss: 2.405 Test Acc: 0.200
Validation loss decreased (inf --> -0.199976).  Saving model ...
Epoch: 2 cost time: 1.4393043518066406
Epoch: 2, Steps: 12 | Train Loss: 2.246 Vali Loss: 1.845 Vali Acc: 0.517 Test Loss: 1.845 Test Acc: 0.517
Validation loss decreased (-0.199976 --> -0.516648).  Saving model ...
Epoch: 3 cost time: 1.4801552295684814
Epoch: 3, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.441 Vali Acc: 0.656 Test Loss: 1.441 Test Acc: 0.656
Validation loss decreased (-0.516648 --> -0.655541).  Saving model ...
Epoch: 4 cost time: 1.3226318359375
Epoch: 4, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.220 Vali Acc: 0.711 Test Loss: 1.220 Test Acc: 0.711
Validation loss decreased (-0.655541 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 1.371006965637207
Epoch: 5, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.069 Vali Acc: 0.722 Test Loss: 1.069 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.1886942386627197
Epoch: 6, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.4022033214569092
Epoch: 7, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.856 Vali Acc: 0.778 Test Loss: 0.856 Test Acc: 0.778
Validation loss decreased (-0.749990 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.4046406745910645
Epoch: 8, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.2286784648895264
Epoch: 9, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.447401523590088
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 1.1853151321411133
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 12 cost time: 1.3301441669464111
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.4241704940795898
Epoch: 13, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.378220796585083
Epoch: 14, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.4844982624053955
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1682026386260986
Epoch: 16, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.3898653984069824
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5023720264434814
Epoch: 18, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3496370315551758
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.584 Vali Acc: 0.883 Test Loss: 0.584 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883327).  Saving model ...
Epoch: 20 cost time: 1.502448320388794
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4392595291137695
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6051244735717773
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2872951030731201
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2420783042907715
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.203991413116455
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5555322170257568
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3978543281555176
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6291751861572266
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.625 Vali Acc: 0.894 Test Loss: 0.625 Test Acc: 0.894
Validation loss decreased (-0.883327 --> -0.894438).  Saving model ...
Epoch: 29 cost time: 1.2778630256652832
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2874953746795654
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.373896837234497
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4558639526367188
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2273881435394287
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3565170764923096
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3787312507629395
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3518919944763184
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1659643650054932
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.683 Vali Acc: 0.878 Test Loss: 0.683 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2947285175323486
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.700 Vali Acc: 0.867 Test Loss: 0.700 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 187559
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3988616466522217
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 1.2761414051055908
Epoch: 2, Steps: 12 | Train Loss: 2.222 Vali Loss: 1.837 Vali Acc: 0.594 Test Loss: 1.837 Test Acc: 0.594
Validation loss decreased (-0.277754 --> -0.594426).  Saving model ...
Epoch: 3 cost time: 1.2240004539489746
Epoch: 3, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.451 Vali Acc: 0.667 Test Loss: 1.451 Test Acc: 0.667
Validation loss decreased (-0.594426 --> -0.666652).  Saving model ...
Epoch: 4 cost time: 1.2561860084533691
Epoch: 4, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.240 Vali Acc: 0.672 Test Loss: 1.240 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.0910627841949463
Epoch: 5, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.107 Vali Acc: 0.672 Test Loss: 1.107 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 1.1200084686279297
Epoch: 6, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.006 Vali Acc: 0.683 Test Loss: 1.006 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 1.101374626159668
Epoch: 7, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 1.209317684173584
Epoch: 8, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.1898696422576904
Epoch: 9, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.785 Vali Acc: 0.744 Test Loss: 0.785 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 1.2494375705718994
Epoch: 10, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783326).  Saving model ...
Epoch: 11 cost time: 1.1935780048370361
Epoch: 11, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.090294361114502
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.685 Vali Acc: 0.778 Test Loss: 0.685 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2920503616333008
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.206906795501709
Epoch: 14, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.607 Vali Acc: 0.806 Test Loss: 0.607 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 1.0696492195129395
Epoch: 15, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1581051349639893
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.581 Vali Acc: 0.794 Test Loss: 0.581 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1937546730041504
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838884).  Saving model ...
Epoch: 18 cost time: 1.1810612678527832
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.302518606185913
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.567 Vali Acc: 0.811 Test Loss: 0.567 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1582140922546387
Epoch: 20, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.540 Vali Acc: 0.817 Test Loss: 0.540 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2295045852661133
Epoch: 21, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.2624270915985107
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2079997062683105
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.097085952758789
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.175685167312622
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0771868228912354
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1672253608703613
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1565825939178467
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.23305082321167
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1432251930236816
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.111670732498169
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 187559
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7565083503723145
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.431 Vali Acc: 0.189 Test Loss: 2.431 Test Acc: 0.189
Validation loss decreased (inf --> -0.188865).  Saving model ...
Epoch: 2 cost time: 1.3142070770263672
Epoch: 2, Steps: 12 | Train Loss: 2.176 Vali Loss: 1.883 Vali Acc: 0.406 Test Loss: 1.883 Test Acc: 0.406
Validation loss decreased (-0.188865 --> -0.405537).  Saving model ...
Epoch: 3 cost time: 1.191953182220459
Epoch: 3, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.511 Vali Acc: 0.578 Test Loss: 1.511 Test Acc: 0.578
Validation loss decreased (-0.405537 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 1.15334153175354
Epoch: 4, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.272 Vali Acc: 0.672 Test Loss: 1.272 Test Acc: 0.672
Validation loss decreased (-0.577763 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.0517246723175049
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.086 Vali Acc: 0.728 Test Loss: 1.086 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.4267001152038574
Epoch: 6, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.001 Vali Acc: 0.722 Test Loss: 1.001 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2649765014648438
Epoch: 7, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
Validation loss decreased (-0.727767 --> -0.761102).  Saving model ...
Epoch: 8 cost time: 1.3770532608032227
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.866 Vali Acc: 0.772 Test Loss: 0.866 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 1.2499518394470215
Epoch: 9, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
Validation loss decreased (-0.772214 --> -0.822215).  Saving model ...
Epoch: 10 cost time: 1.3524751663208008
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 1.4286105632781982
Epoch: 11, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.738 Vali Acc: 0.817 Test Loss: 0.738 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1945693492889404
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4087238311767578
Epoch: 13, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861104).  Saving model ...
Epoch: 14 cost time: 1.3644871711730957
Epoch: 14, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.309774398803711
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4525878429412842
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3376140594482422
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4313294887542725
Epoch: 18, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5489087104797363
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.861104 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.2842307090759277
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3629133701324463
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3317244052886963
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.292330026626587
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.480011224746704
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3045885562896729
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3738486766815186
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.355926513671875
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5343623161315918
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2316710948944092
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 154791
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.062624931335449
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.423 Vali Acc: 0.189 Test Loss: 2.423 Test Acc: 0.189
Validation loss decreased (inf --> -0.188865).  Saving model ...
Epoch: 2 cost time: 1.5210609436035156
Epoch: 2, Steps: 12 | Train Loss: 2.168 Vali Loss: 1.872 Vali Acc: 0.433 Test Loss: 1.872 Test Acc: 0.433
Validation loss decreased (-0.188865 --> -0.433315).  Saving model ...
Epoch: 3 cost time: 1.4060540199279785
Epoch: 3, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.499 Vali Acc: 0.572 Test Loss: 1.499 Test Acc: 0.572
Validation loss decreased (-0.433315 --> -0.572207).  Saving model ...
Epoch: 4 cost time: 1.462442398071289
Epoch: 4, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.260 Vali Acc: 0.683 Test Loss: 1.260 Test Acc: 0.683
Validation loss decreased (-0.572207 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.41506028175354
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722211).  Saving model ...
Epoch: 6 cost time: 1.2037153244018555
Epoch: 6, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.997 Vali Acc: 0.717 Test Loss: 0.997 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5003998279571533
Epoch: 7, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
Validation loss decreased (-0.722211 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 1.388495922088623
Epoch: 8, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.861 Vali Acc: 0.772 Test Loss: 0.861 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 1.3651742935180664
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.327951431274414
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.737 Vali Acc: 0.828 Test Loss: 0.737 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827770).  Saving model ...
Epoch: 11 cost time: 1.202143669128418
Epoch: 11, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.729 Vali Acc: 0.811 Test Loss: 0.729 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1141655445098877
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3884477615356445
Epoch: 13, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.827770 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.2001609802246094
Epoch: 14, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3237969875335693
Epoch: 15, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2053284645080566
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.2432284355163574
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2497267723083496
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2685530185699463
Epoch: 19, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.388620138168335
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.210726261138916
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3236143589019775
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.2340202331542969
Epoch: 23, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2225992679595947
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.407409429550171
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3589880466461182
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2706634998321533
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2239561080932617
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.657 Vali Acc: 0.867 Test Loss: 0.657 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3502264022827148
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1445212364196777
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4485986232757568
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3476943969726562
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 154791
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6288604736328125
Epoch: 1, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.453 Vali Acc: 0.178 Test Loss: 2.453 Test Acc: 0.178
Validation loss decreased (inf --> -0.177753).  Saving model ...
Epoch: 2 cost time: 1.2274932861328125
Epoch: 2, Steps: 12 | Train Loss: 2.179 Vali Loss: 1.893 Vali Acc: 0.456 Test Loss: 1.893 Test Acc: 0.456
Validation loss decreased (-0.177753 --> -0.455537).  Saving model ...
Epoch: 3 cost time: 1.223884105682373
Epoch: 3, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.507 Vali Acc: 0.594 Test Loss: 1.507 Test Acc: 0.594
Validation loss decreased (-0.455537 --> -0.594429).  Saving model ...
Epoch: 4 cost time: 1.211916446685791
Epoch: 4, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.264 Vali Acc: 0.672 Test Loss: 1.264 Test Acc: 0.672
Validation loss decreased (-0.594429 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.320469856262207
Epoch: 5, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.079 Vali Acc: 0.711 Test Loss: 1.079 Test Acc: 0.711
Validation loss decreased (-0.672210 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 1.4216594696044922
Epoch: 6, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 7 cost time: 1.083970546722412
Epoch: 7, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.3348369598388672
Epoch: 8, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.843 Vali Acc: 0.794 Test Loss: 0.843 Test Acc: 0.794
Validation loss decreased (-0.744436 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.3152287006378174
Epoch: 9, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.744 Vali Acc: 0.811 Test Loss: 0.744 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.2765886783599854
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.3142247200012207
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 12 cost time: 1.3703312873840332
Epoch: 12, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.274902582168579
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.1829578876495361
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.2107491493225098
Epoch: 15, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.3181488513946533
Epoch: 16, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 1.406376838684082
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2701196670532227
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.233637809753418
Epoch: 19, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.3113338947296143
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3167874813079834
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4316623210906982
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.3756647109985352
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.552 Vali Acc: 0.872 Test Loss: 0.552 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2581264972686768
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883327).  Saving model ...
Epoch: 25 cost time: 1.0850093364715576
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3473243713378906
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0594687461853027
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.12677001953125
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2856268882751465
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3102529048919678
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2469582557678223
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2659833431243896
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4021215438842773
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4032666683197021
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.636 Vali Acc: 0.878 Test Loss: 0.636 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 154791
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6217117309570312
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.451 Vali Acc: 0.200 Test Loss: 2.451 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 1.4241909980773926
Epoch: 2, Steps: 12 | Train Loss: 2.190 Vali Loss: 1.911 Vali Acc: 0.450 Test Loss: 1.911 Test Acc: 0.450
Validation loss decreased (-0.199975 --> -0.449981).  Saving model ...
Epoch: 3 cost time: 1.3437085151672363
Epoch: 3, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.531 Vali Acc: 0.561 Test Loss: 1.531 Test Acc: 0.561
Validation loss decreased (-0.449981 --> -0.561096).  Saving model ...
Epoch: 4 cost time: 1.178734302520752
Epoch: 4, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.291 Vali Acc: 0.672 Test Loss: 1.291 Test Acc: 0.672
Validation loss decreased (-0.561096 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.326462984085083
Epoch: 5, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.117 Vali Acc: 0.678 Test Loss: 1.117 Test Acc: 0.678
Validation loss decreased (-0.672209 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.2587711811065674
Epoch: 6, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.036 Vali Acc: 0.678 Test Loss: 1.036 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 1.1111440658569336
Epoch: 7, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.912 Vali Acc: 0.706 Test Loss: 0.912 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 1.4328198432922363
Epoch: 8, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.875 Vali Acc: 0.733 Test Loss: 0.875 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.319185733795166
Epoch: 9, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.1103086471557617
Epoch: 10, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.3143341541290283
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.213162899017334
Epoch: 12, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2737071514129639
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 1.3311688899993896
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3251097202301025
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3696048259735107
Epoch: 16, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.552 Vali Acc: 0.811 Test Loss: 0.552 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811106).  Saving model ...
Epoch: 17 cost time: 1.3784592151641846
Epoch: 17, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 18 cost time: 1.2957227230072021
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 1.3169498443603516
Epoch: 19, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.3377454280853271
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.4350886344909668
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.273202896118164
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.1591944694519043
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1916453838348389
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0906343460083008
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1381454467773438
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1952857971191406
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2193162441253662
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.298046350479126
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4207441806793213
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.286346673965454
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2206082344055176
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 154791
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.883925437927246
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.413 Vali Acc: 0.228 Test Loss: 2.413 Test Acc: 0.228
Validation loss decreased (inf --> -0.227754).  Saving model ...
Epoch: 2 cost time: 1.371746301651001
Epoch: 2, Steps: 12 | Train Loss: 2.183 Vali Loss: 1.839 Vali Acc: 0.578 Test Loss: 1.839 Test Acc: 0.578
Validation loss decreased (-0.227754 --> -0.577759).  Saving model ...
Epoch: 3 cost time: 1.2687287330627441
Epoch: 3, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.458 Vali Acc: 0.644 Test Loss: 1.458 Test Acc: 0.644
Validation loss decreased (-0.577759 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 1.2606184482574463
Epoch: 4, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.245 Vali Acc: 0.678 Test Loss: 1.245 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 1.290604829788208
Epoch: 5, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.061 Vali Acc: 0.744 Test Loss: 1.061 Test Acc: 0.744
Validation loss decreased (-0.677765 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 1.386672019958496
Epoch: 6, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.944 Vali Acc: 0.744 Test Loss: 0.944 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.306567668914795
Epoch: 7, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.892 Vali Acc: 0.778 Test Loss: 0.892 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.292494773864746
Epoch: 8, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.2755224704742432
Epoch: 9, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.780 Vali Acc: 0.811 Test Loss: 0.780 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.3878588676452637
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 1.4503936767578125
Epoch: 11, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.2279071807861328
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.725 Vali Acc: 0.828 Test Loss: 0.725 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2240307331085205
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.2093336582183838
Epoch: 14, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3358571529388428
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.663 Vali Acc: 0.828 Test Loss: 0.663 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3473930358886719
Epoch: 16, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 17 cost time: 1.339118480682373
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.273728847503662
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 1.3124992847442627
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2474076747894287
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 1.4074721336364746
Epoch: 21, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3211443424224854
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3289496898651123
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.666 Vali Acc: 0.856 Test Loss: 0.666 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4092044830322266
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3005359172821045
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3088176250457764
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2544360160827637
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.367429494857788
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4127166271209717
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3422479629516602
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 138407
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.446255683898926
Epoch: 1, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.427 Vali Acc: 0.200 Test Loss: 2.427 Test Acc: 0.200
Validation loss decreased (inf --> -0.199976).  Saving model ...
Epoch: 2 cost time: 1.2218191623687744
Epoch: 2, Steps: 12 | Train Loss: 2.182 Vali Loss: 1.843 Vali Acc: 0.578 Test Loss: 1.843 Test Acc: 0.578
Validation loss decreased (-0.199976 --> -0.577759).  Saving model ...
Epoch: 3 cost time: 1.2842514514923096
Epoch: 3, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.454 Vali Acc: 0.628 Test Loss: 1.454 Test Acc: 0.628
Validation loss decreased (-0.577759 --> -0.627763).  Saving model ...
Epoch: 4 cost time: 1.3572025299072266
Epoch: 4, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.238 Vali Acc: 0.656 Test Loss: 1.238 Test Acc: 0.656
Validation loss decreased (-0.627763 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.3776912689208984
Epoch: 5, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.056 Vali Acc: 0.739 Test Loss: 1.056 Test Acc: 0.739
Validation loss decreased (-0.655543 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 1.331620693206787
Epoch: 6, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.937 Vali Acc: 0.756 Test Loss: 0.937 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 7 cost time: 1.3378028869628906
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.880 Vali Acc: 0.778 Test Loss: 0.880 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.4508838653564453
Epoch: 8, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 9 cost time: 1.416121482849121
Epoch: 9, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.777 Vali Acc: 0.806 Test Loss: 0.777 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.3372187614440918
Epoch: 10, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.755 Vali Acc: 0.822 Test Loss: 0.755 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 1.3535621166229248
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 12 cost time: 1.4956715106964111
Epoch: 12, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2293024063110352
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.3701221942901611
Epoch: 14, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.4166224002838135
Epoch: 15, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1792845726013184
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.2284326553344727
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2836544513702393
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.4663076400756836
Epoch: 19, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3904035091400146
Epoch: 20, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.5451562404632568
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.478100299835205
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5860075950622559
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4196712970733643
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3611118793487549
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.643 Vali Acc: 0.867 Test Loss: 0.643 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4743902683258057
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 1.3101184368133545
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.640 Vali Acc: 0.867 Test Loss: 0.640 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4040608406066895
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3820960521697998
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4416682720184326
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.5732388496398926
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.699 Vali Acc: 0.872 Test Loss: 0.699 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4438116550445557
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.472719669342041
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5088536739349365
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3458590507507324
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.745 Vali Acc: 0.867 Test Loss: 0.745 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.50117826461792
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.746 Vali Acc: 0.883 Test Loss: 0.746 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 37 cost time: 1.4176363945007324
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.747 Vali Acc: 0.878 Test Loss: 0.747 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3799734115600586
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3899831771850586
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.738 Vali Acc: 0.878 Test Loss: 0.738 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3125078678131104
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.765 Vali Acc: 0.872 Test Loss: 0.765 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5146582126617432
Epoch: 41, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.770 Vali Acc: 0.872 Test Loss: 0.770 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4029123783111572
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3215312957763672
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.758 Vali Acc: 0.872 Test Loss: 0.758 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1906025409698486
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.806 Vali Acc: 0.878 Test Loss: 0.806 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4407563209533691
Epoch: 45, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.872 Test Loss: 0.823 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3025362491607666
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.797 Vali Acc: 0.872 Test Loss: 0.797 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 138407
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.679004430770874
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.425 Vali Acc: 0.189 Test Loss: 2.425 Test Acc: 0.189
Validation loss decreased (inf --> -0.188865).  Saving model ...
Epoch: 2 cost time: 1.3200404644012451
Epoch: 2, Steps: 12 | Train Loss: 2.180 Vali Loss: 1.839 Vali Acc: 0.594 Test Loss: 1.839 Test Acc: 0.594
Validation loss decreased (-0.188865 --> -0.594426).  Saving model ...
Epoch: 3 cost time: 1.175945520401001
Epoch: 3, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.441 Vali Acc: 0.644 Test Loss: 1.441 Test Acc: 0.644
Validation loss decreased (-0.594426 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 1.1031761169433594
Epoch: 4, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.227 Vali Acc: 0.656 Test Loss: 1.227 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.2666590213775635
Epoch: 5, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.055 Vali Acc: 0.733 Test Loss: 1.055 Test Acc: 0.733
Validation loss decreased (-0.655543 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.2784144878387451
Epoch: 6, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.928 Vali Acc: 0.744 Test Loss: 0.928 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.0327329635620117
Epoch: 7, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.865 Vali Acc: 0.778 Test Loss: 0.865 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 1.0648715496063232
Epoch: 8, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.796 Vali Acc: 0.806 Test Loss: 0.796 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 9 cost time: 1.3424851894378662
Epoch: 9, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.764 Vali Acc: 0.811 Test Loss: 0.764 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 10 cost time: 1.178208589553833
Epoch: 10, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.733 Vali Acc: 0.811 Test Loss: 0.733 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 1.0894434452056885
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 12 cost time: 1.131173849105835
Epoch: 12, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2053954601287842
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 1.1712160110473633
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.26220703125
Epoch: 15, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2283999919891357
Epoch: 16, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 17 cost time: 1.154292106628418
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2093403339385986
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.1371557712554932
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2304928302764893
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3391468524932861
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.303314208984375
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1027216911315918
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.616 Vali Acc: 0.839 Test Loss: 0.616 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1789090633392334
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2498888969421387
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2670528888702393
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1806292533874512
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1684300899505615
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 138407
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.342419147491455
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.446 Vali Acc: 0.244 Test Loss: 2.446 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 1.224107265472412
Epoch: 2, Steps: 12 | Train Loss: 2.215 Vali Loss: 1.877 Vali Acc: 0.572 Test Loss: 1.877 Test Acc: 0.572
Validation loss decreased (-0.244420 --> -0.572203).  Saving model ...
Epoch: 3 cost time: 1.044379472732544
Epoch: 3, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.485 Vali Acc: 0.617 Test Loss: 1.485 Test Acc: 0.617
Validation loss decreased (-0.572203 --> -0.616652).  Saving model ...
Epoch: 4 cost time: 1.0959560871124268
Epoch: 4, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.285 Vali Acc: 0.656 Test Loss: 1.285 Test Acc: 0.656
Validation loss decreased (-0.616652 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.0449538230895996
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.122 Vali Acc: 0.683 Test Loss: 1.122 Test Acc: 0.683
Validation loss decreased (-0.655543 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 1.3075642585754395
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
Validation loss decreased (-0.683322 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 1.213268518447876
Epoch: 7, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 1.267042636871338
Epoch: 8, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.838 Vali Acc: 0.761 Test Loss: 0.838 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.172480583190918
Epoch: 9, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.125748872756958
Epoch: 10, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 1.1935603618621826
Epoch: 11, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
Validation loss decreased (-0.761103 --> -0.805549).  Saving model ...
Epoch: 12 cost time: 1.0860600471496582
Epoch: 12, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0280234813690186
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 1.1746888160705566
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3060612678527832
Epoch: 15, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.636 Vali Acc: 0.794 Test Loss: 0.636 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2678697109222412
Epoch: 16, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.596 Vali Acc: 0.811 Test Loss: 0.596 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 1.1214616298675537
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 1.3955333232879639
Epoch: 18, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 1.3445065021514893
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.232771873474121
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.243978500366211
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4027149677276611
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.528895378112793
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3423569202423096
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3031277656555176
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.314260721206665
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.2608129978179932
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0429368019104004
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2634046077728271
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2868013381958008
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3903350830078125
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1103627681732178
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.1699748039245605
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3681435585021973
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.640 Vali Acc: 0.861 Test Loss: 0.640 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.301983118057251
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2644619941711426
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.664 Vali Acc: 0.878 Test Loss: 0.664 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 37 cost time: 1.1161222457885742
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.288362979888916
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.330674171447754
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.700 Vali Acc: 0.872 Test Loss: 0.700 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2933626174926758
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.231964111328125
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.699 Vali Acc: 0.872 Test Loss: 0.699 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2881591320037842
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.722 Vali Acc: 0.861 Test Loss: 0.722 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2460808753967285
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.685 Vali Acc: 0.878 Test Loss: 0.685 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2283806800842285
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.745 Vali Acc: 0.867 Test Loss: 0.745 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.387840747833252
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.756 Vali Acc: 0.872 Test Loss: 0.756 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4012649059295654
Epoch: 46, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.748 Vali Acc: 0.867 Test Loss: 0.748 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 138407
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5753109455108643
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.553 Vali Acc: 0.122 Test Loss: 2.553 Test Acc: 0.122
Validation loss decreased (inf --> -0.122197).  Saving model ...
Epoch: 2 cost time: 1.216505527496338
Epoch: 2, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.163 Vali Acc: 0.411 Test Loss: 2.163 Test Acc: 0.411
Validation loss decreased (-0.122197 --> -0.411089).  Saving model ...
Epoch: 3 cost time: 1.3075315952301025
Epoch: 3, Steps: 12 | Train Loss: 1.969 Vali Loss: 1.793 Vali Acc: 0.589 Test Loss: 1.793 Test Acc: 0.589
Validation loss decreased (-0.411089 --> -0.588871).  Saving model ...
Epoch: 4 cost time: 1.2758057117462158
Epoch: 4, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.541 Vali Acc: 0.639 Test Loss: 1.541 Test Acc: 0.639
Validation loss decreased (-0.588871 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 1.216905117034912
Epoch: 5, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.352 Vali Acc: 0.667 Test Loss: 1.352 Test Acc: 0.667
Validation loss decreased (-0.638873 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 1.2807343006134033
Epoch: 6, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.191 Vali Acc: 0.700 Test Loss: 1.191 Test Acc: 0.700
Validation loss decreased (-0.666653 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 1.273789405822754
Epoch: 7, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.075 Vali Acc: 0.711 Test Loss: 1.075 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 1.3182106018066406
Epoch: 8, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 9 cost time: 1.1319808959960938
Epoch: 9, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.926 Vali Acc: 0.756 Test Loss: 0.926 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.0991249084472656
Epoch: 10, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.867 Vali Acc: 0.783 Test Loss: 0.867 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 1.1689519882202148
Epoch: 11, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.820 Vali Acc: 0.794 Test Loss: 0.820 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.241837501525879
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.777 Vali Acc: 0.794 Test Loss: 0.777 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.1708900928497314
Epoch: 13, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.751 Vali Acc: 0.778 Test Loss: 0.751 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2686443328857422
Epoch: 14, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.4403858184814453
Epoch: 15, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.704 Vali Acc: 0.817 Test Loss: 0.704 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3401381969451904
Epoch: 16, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 1.1261329650878906
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.1044821739196777
Epoch: 18, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1044132709503174
Epoch: 19, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 1.2533507347106934
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.270672082901001
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.289074420928955
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.3057599067687988
Epoch: 23, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 1.2470903396606445
Epoch: 24, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.044132947921753
Epoch: 25, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 1.0446109771728516
Epoch: 26, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.407843828201294
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3454699516296387
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.223421573638916
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1906859874725342
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2805955410003662
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3424711227416992
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2732226848602295
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2585313320159912
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1551728248596191
Epoch: 35, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 314983
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.734543561935425
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.551 Vali Acc: 0.083 Test Loss: 2.551 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.2132399082183838
Epoch: 2, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.159 Vali Acc: 0.389 Test Loss: 2.159 Test Acc: 0.389
Validation loss decreased (-0.083308 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.1392550468444824
Epoch: 3, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.785 Vali Acc: 0.578 Test Loss: 1.785 Test Acc: 0.578
Validation loss decreased (-0.388867 --> -0.577760).  Saving model ...
Epoch: 4 cost time: 1.2093377113342285
Epoch: 4, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.532 Vali Acc: 0.656 Test Loss: 1.532 Test Acc: 0.656
Validation loss decreased (-0.577760 --> -0.655540).  Saving model ...
Epoch: 5 cost time: 1.3277366161346436
Epoch: 5, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.342 Vali Acc: 0.656 Test Loss: 1.342 Test Acc: 0.656
Validation loss decreased (-0.655540 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 1.173943042755127
Epoch: 6, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.183 Vali Acc: 0.694 Test Loss: 1.183 Test Acc: 0.694
Validation loss decreased (-0.655542 --> -0.694433).  Saving model ...
Epoch: 7 cost time: 0.9802947044372559
Epoch: 7, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 0.8170373439788818
Epoch: 8, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.1888089179992676
Epoch: 9, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.928 Vali Acc: 0.756 Test Loss: 0.928 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.1157166957855225
Epoch: 10, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.0135130882263184
Epoch: 11, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
Validation loss decreased (-0.777769 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.0496838092803955
Epoch: 12, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1963508129119873
Epoch: 13, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.0822820663452148
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.26743483543396
Epoch: 15, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3451189994812012
Epoch: 16, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.3095886707305908
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.342067003250122
Epoch: 18, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 1.3705368041992188
Epoch: 19, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 1.036087989807129
Epoch: 20, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.4376189708709717
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.539947271347046
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3319964408874512
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2045013904571533
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 1.2644250392913818
Epoch: 25, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 1.4897644519805908
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.388014554977417
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3142695426940918
Epoch: 28, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4025063514709473
Epoch: 29, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3494558334350586
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3044545650482178
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0190465450286865
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.303459882736206
Epoch: 33, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.469970941543579
Epoch: 34, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4063599109649658
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 314983
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.68823504447937
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.539 Vali Acc: 0.072 Test Loss: 2.539 Test Acc: 0.072
Validation loss decreased (inf --> -0.072197).  Saving model ...
Epoch: 2 cost time: 1.2821543216705322
Epoch: 2, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.147 Vali Acc: 0.406 Test Loss: 2.147 Test Acc: 0.406
Validation loss decreased (-0.072197 --> -0.405534).  Saving model ...
Epoch: 3 cost time: 1.0131032466888428
Epoch: 3, Steps: 12 | Train Loss: 1.952 Vali Loss: 1.774 Vali Acc: 0.561 Test Loss: 1.774 Test Acc: 0.561
Validation loss decreased (-0.405534 --> -0.561093).  Saving model ...
Epoch: 4 cost time: 1.2504479885101318
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.521 Vali Acc: 0.622 Test Loss: 1.521 Test Acc: 0.622
Validation loss decreased (-0.561093 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.2127883434295654
Epoch: 5, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.333 Vali Acc: 0.650 Test Loss: 1.333 Test Acc: 0.650
Validation loss decreased (-0.622207 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 1.1319842338562012
Epoch: 6, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.176 Vali Acc: 0.678 Test Loss: 1.176 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677766).  Saving model ...
Epoch: 7 cost time: 1.2198660373687744
Epoch: 7, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.32243013381958
Epoch: 8, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.2329444885253906
Epoch: 9, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.913 Vali Acc: 0.756 Test Loss: 0.913 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.1756260395050049
Epoch: 10, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.849 Vali Acc: 0.783 Test Loss: 0.849 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 0.9345557689666748
Epoch: 11, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.805 Vali Acc: 0.789 Test Loss: 0.805 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.1255552768707275
Epoch: 12, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.284548282623291
Epoch: 13, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 1.145899772644043
Epoch: 14, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.088623046875
Epoch: 15, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.686 Vali Acc: 0.817 Test Loss: 0.686 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1704423427581787
Epoch: 16, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.2671723365783691
Epoch: 17, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.119821548461914
Epoch: 18, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1903657913208008
Epoch: 19, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 1.1014299392700195
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.191920280456543
Epoch: 21, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 1.2440438270568848
Epoch: 22, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1081669330596924
Epoch: 23, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.1487727165222168
Epoch: 24, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.103562831878662
Epoch: 25, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.1347322463989258
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3512744903564453
Epoch: 27, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.208155870437622
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2330026626586914
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.164673089981079
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2827861309051514
Epoch: 31, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.203404426574707
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 1.192742109298706
Epoch: 33, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1865851879119873
Epoch: 34, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2435522079467773
Epoch: 35, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2565882205963135
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.2345187664031982
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1480045318603516
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.192990779876709
Epoch: 39, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 1.2015910148620605
Epoch: 40, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2462091445922852
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0389397144317627
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1786284446716309
Epoch: 43, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0881047248840332
Epoch: 44, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2519690990447998
Epoch: 45, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1974656581878662
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.559 Vali Acc: 0.872 Test Loss: 0.559 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2703547477722168
Epoch: 47, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2531483173370361
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.153451681137085
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 314983
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4670350551605225
Epoch: 1, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.528 Vali Acc: 0.100 Test Loss: 2.528 Test Acc: 0.100
Validation loss decreased (inf --> -0.099975).  Saving model ...
Epoch: 2 cost time: 1.2889914512634277
Epoch: 2, Steps: 12 | Train Loss: 2.362 Vali Loss: 2.158 Vali Acc: 0.411 Test Loss: 2.158 Test Acc: 0.411
Validation loss decreased (-0.099975 --> -0.411090).  Saving model ...
Epoch: 3 cost time: 1.0454812049865723
Epoch: 3, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.799 Vali Acc: 0.556 Test Loss: 1.799 Test Acc: 0.556
Validation loss decreased (-0.411090 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 1.119309902191162
Epoch: 4, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.550 Vali Acc: 0.622 Test Loss: 1.550 Test Acc: 0.622
Validation loss decreased (-0.555538 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.1575193405151367
Epoch: 5, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.361 Vali Acc: 0.661 Test Loss: 1.361 Test Acc: 0.661
Validation loss decreased (-0.622207 --> -0.661098).  Saving model ...
Epoch: 6 cost time: 1.1801836490631104
Epoch: 6, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.209 Vali Acc: 0.689 Test Loss: 1.209 Test Acc: 0.689
Validation loss decreased (-0.661098 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 1.164304494857788
Epoch: 7, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.099 Vali Acc: 0.683 Test Loss: 1.099 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.121633768081665
Epoch: 8, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.018 Vali Acc: 0.706 Test Loss: 1.018 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 0.9957225322723389
Epoch: 9, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.961 Vali Acc: 0.717 Test Loss: 0.961 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 10 cost time: 1.1829581260681152
Epoch: 10, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.901 Vali Acc: 0.728 Test Loss: 0.901 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 1.050931692123413
Epoch: 11, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.857 Vali Acc: 0.728 Test Loss: 0.857 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 1.1486973762512207
Epoch: 12, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.805 Vali Acc: 0.772 Test Loss: 0.805 Test Acc: 0.772
Validation loss decreased (-0.727769 --> -0.772214).  Saving model ...
Epoch: 13 cost time: 1.03859543800354
Epoch: 13, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.767 Vali Acc: 0.761 Test Loss: 0.767 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9198043346405029
Epoch: 14, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.164193868637085
Epoch: 15, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.187779188156128
Epoch: 16, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 1.1556611061096191
Epoch: 17, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.1521422863006592
Epoch: 18, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1929869651794434
Epoch: 19, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9436769485473633
Epoch: 20, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.620 Vali Acc: 0.811 Test Loss: 0.620 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2209618091583252
Epoch: 21, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9164068698883057
Epoch: 22, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9943838119506836
Epoch: 23, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.578 Vali Acc: 0.811 Test Loss: 0.578 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0890803337097168
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 25 cost time: 1.011613368988037
Epoch: 25, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.507 Vali Acc: 0.839 Test Loss: 0.507 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 26 cost time: 1.05741286277771
Epoch: 26, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.536 Vali Acc: 0.817 Test Loss: 0.536 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1312456130981445
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861106).  Saving model ...
Epoch: 28 cost time: 1.1461131572723389
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.168125867843628
Epoch: 29, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.497 Vali Acc: 0.839 Test Loss: 0.497 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.273024559020996
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.494 Vali Acc: 0.839 Test Loss: 0.494 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1697356700897217
Epoch: 31, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.2988526821136475
Epoch: 32, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3139493465423584
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0808823108673096
Epoch: 34, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.016258955001831
Epoch: 35, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.248234510421753
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9861817359924316
Epoch: 37, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 1.1391427516937256
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1831459999084473
Epoch: 39, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 40 cost time: 1.0885162353515625
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2513961791992188
Epoch: 41, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 42 cost time: 1.1265020370483398
Epoch: 42, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1188061237335205
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 44 cost time: 1.1870412826538086
Epoch: 44, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.169402837753296
Epoch: 45, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0369048118591309
Epoch: 46, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.959169864654541
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.169858455657959
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1133794784545898
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1304681301116943
Epoch: 50, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.082122564315796
Epoch: 51, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.27632474899292
Epoch: 52, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.970228910446167
Epoch: 53, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 314983
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6690804958343506
Epoch: 1, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.501 Vali Acc: 0.172 Test Loss: 2.501 Test Acc: 0.172
Validation loss decreased (inf --> -0.172197).  Saving model ...
Epoch: 2 cost time: 1.20247483253479
Epoch: 2, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.132 Vali Acc: 0.322 Test Loss: 2.132 Test Acc: 0.322
Validation loss decreased (-0.172197 --> -0.322201).  Saving model ...
Epoch: 3 cost time: 1.1654746532440186
Epoch: 3, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.798 Vali Acc: 0.561 Test Loss: 1.798 Test Acc: 0.561
Validation loss decreased (-0.322201 --> -0.561093).  Saving model ...
Epoch: 4 cost time: 1.302635908126831
Epoch: 4, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.554 Vali Acc: 0.622 Test Loss: 1.554 Test Acc: 0.622
Validation loss decreased (-0.561093 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.2439711093902588
Epoch: 5, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.336 Vali Acc: 0.706 Test Loss: 1.336 Test Acc: 0.706
Validation loss decreased (-0.622207 --> -0.705542).  Saving model ...
Epoch: 6 cost time: 1.2224273681640625
Epoch: 6, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.203 Vali Acc: 0.678 Test Loss: 1.203 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.25516939163208
Epoch: 7, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.094 Vali Acc: 0.739 Test Loss: 1.094 Test Acc: 0.739
Validation loss decreased (-0.705542 --> -0.738878).  Saving model ...
Epoch: 8 cost time: 1.191892385482788
Epoch: 8, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.005 Vali Acc: 0.756 Test Loss: 1.005 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 1.2555952072143555
Epoch: 9, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.2495627403259277
Epoch: 10, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.860 Vali Acc: 0.789 Test Loss: 0.860 Test Acc: 0.789
Validation loss decreased (-0.766657 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 1.14024019241333
Epoch: 11, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.834 Vali Acc: 0.789 Test Loss: 0.834 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.2629621028900146
Epoch: 12, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.776 Vali Acc: 0.811 Test Loss: 0.776 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.3840758800506592
Epoch: 13, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.769 Vali Acc: 0.817 Test Loss: 0.769 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.3500220775604248
Epoch: 14, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.3196017742156982
Epoch: 15, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2384512424468994
Epoch: 16, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.317833662033081
Epoch: 17, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.245021104812622
Epoch: 18, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3581950664520264
Epoch: 19, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 1.425018548965454
Epoch: 20, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1578025817871094
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 1.240952491760254
Epoch: 22, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.2854390144348145
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 1.128005027770996
Epoch: 24, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.2689704895019531
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2687902450561523
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2999205589294434
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1225173473358154
Epoch: 28, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9513814449310303
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.252401351928711
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1823289394378662
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3048381805419922
Epoch: 32, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2949566841125488
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3437213897705078
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 183911
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4979796409606934
Epoch: 1, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.496 Vali Acc: 0.183 Test Loss: 2.496 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 1.2009308338165283
Epoch: 2, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.128 Vali Acc: 0.350 Test Loss: 2.128 Test Acc: 0.350
Validation loss decreased (-0.183308 --> -0.349979).  Saving model ...
Epoch: 3 cost time: 1.1982884407043457
Epoch: 3, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.796 Vali Acc: 0.506 Test Loss: 1.796 Test Acc: 0.506
Validation loss decreased (-0.349979 --> -0.505538).  Saving model ...
Epoch: 4 cost time: 1.1775035858154297
Epoch: 4, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.552 Vali Acc: 0.622 Test Loss: 1.552 Test Acc: 0.622
Validation loss decreased (-0.505538 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 1.287674903869629
Epoch: 5, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.331 Vali Acc: 0.706 Test Loss: 1.331 Test Acc: 0.706
Validation loss decreased (-0.622207 --> -0.705542).  Saving model ...
Epoch: 6 cost time: 1.0200412273406982
Epoch: 6, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.198 Vali Acc: 0.689 Test Loss: 1.198 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1954727172851562
Epoch: 7, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
Validation loss decreased (-0.705542 --> -0.716656).  Saving model ...
Epoch: 8 cost time: 1.1140682697296143
Epoch: 8, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.003 Vali Acc: 0.756 Test Loss: 1.003 Test Acc: 0.756
Validation loss decreased (-0.716656 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 1.2366197109222412
Epoch: 9, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.929 Vali Acc: 0.761 Test Loss: 0.929 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.1761865615844727
Epoch: 10, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.859 Vali Acc: 0.789 Test Loss: 0.859 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 1.0984008312225342
Epoch: 11, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.832 Vali Acc: 0.794 Test Loss: 0.832 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 0.8998794555664062
Epoch: 12, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.777 Vali Acc: 0.817 Test Loss: 0.777 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.0799264907836914
Epoch: 13, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.770 Vali Acc: 0.806 Test Loss: 0.770 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.283006191253662
Epoch: 14, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 0.9301478862762451
Epoch: 15, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.721 Vali Acc: 0.811 Test Loss: 0.721 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9280147552490234
Epoch: 16, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.016667127609253
Epoch: 17, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.092991828918457
Epoch: 18, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.096968412399292
Epoch: 19, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2198402881622314
Epoch: 20, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.615 Vali Acc: 0.839 Test Loss: 0.615 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.310157060623169
Epoch: 21, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.608 Vali Acc: 0.839 Test Loss: 0.608 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0676088333129883
Epoch: 22, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 1.3127524852752686
Epoch: 23, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2833037376403809
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3627288341522217
Epoch: 25, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3825654983520508
Epoch: 26, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2027668952941895
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1971983909606934
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9408609867095947
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2252850532531738
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9161877632141113
Epoch: 31, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.109961986541748
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 183911
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3823063373565674
Epoch: 1, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.514 Vali Acc: 0.183 Test Loss: 2.514 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 1.1889848709106445
Epoch: 2, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.143 Vali Acc: 0.339 Test Loss: 2.143 Test Acc: 0.339
Validation loss decreased (-0.183308 --> -0.338867).  Saving model ...
Epoch: 3 cost time: 1.1895394325256348
Epoch: 3, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.805 Vali Acc: 0.517 Test Loss: 1.805 Test Acc: 0.517
Validation loss decreased (-0.338867 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 1.0907957553863525
Epoch: 4, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.555 Vali Acc: 0.617 Test Loss: 1.555 Test Acc: 0.617
Validation loss decreased (-0.516649 --> -0.616651).  Saving model ...
Epoch: 5 cost time: 1.026116132736206
Epoch: 5, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.332 Vali Acc: 0.717 Test Loss: 1.332 Test Acc: 0.717
Validation loss decreased (-0.616651 --> -0.716653).  Saving model ...
Epoch: 6 cost time: 1.0990045070648193
Epoch: 6, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.196 Vali Acc: 0.717 Test Loss: 1.196 Test Acc: 0.717
Validation loss decreased (-0.716653 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 1.071340560913086
Epoch: 7, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.094 Vali Acc: 0.722 Test Loss: 1.094 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722211).  Saving model ...
Epoch: 8 cost time: 1.1306121349334717
Epoch: 8, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.004 Vali Acc: 0.756 Test Loss: 1.004 Test Acc: 0.756
Validation loss decreased (-0.722211 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 1.129634141921997
Epoch: 9, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.1124920845031738
Epoch: 10, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.850 Vali Acc: 0.800 Test Loss: 0.850 Test Acc: 0.800
Validation loss decreased (-0.766657 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 1.2605581283569336
Epoch: 11, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.820 Vali Acc: 0.794 Test Loss: 0.820 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2262113094329834
Epoch: 12, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.772 Vali Acc: 0.806 Test Loss: 0.772 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.0795841217041016
Epoch: 13, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1740360260009766
Epoch: 14, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.699 Vali Acc: 0.817 Test Loss: 0.699 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.085181474685669
Epoch: 15, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0759708881378174
Epoch: 16, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 1.037146806716919
Epoch: 17, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 0.9307432174682617
Epoch: 18, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.04115891456604
Epoch: 19, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0538299083709717
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0858190059661865
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1835083961486816
Epoch: 22, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.1257872581481934
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.127938985824585
Epoch: 24, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.552 Vali Acc: 0.839 Test Loss: 0.552 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1466963291168213
Epoch: 25, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.077099084854126
Epoch: 26, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0965960025787354
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9726927280426025
Epoch: 28, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1402461528778076
Epoch: 29, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1416614055633545
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9648230075836182
Epoch: 31, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2191088199615479
Epoch: 32, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 183911
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5497920513153076
Epoch: 1, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.580 Vali Acc: 0.128 Test Loss: 2.580 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 1.0467498302459717
Epoch: 2, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.214 Vali Acc: 0.333 Test Loss: 2.214 Test Acc: 0.333
Validation loss decreased (-0.127752 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 1.2138211727142334
Epoch: 3, Steps: 12 | Train Loss: 2.056 Vali Loss: 1.872 Vali Acc: 0.539 Test Loss: 1.872 Test Acc: 0.539
Validation loss decreased (-0.333311 --> -0.538870).  Saving model ...
Epoch: 4 cost time: 1.1028387546539307
Epoch: 4, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.616 Vali Acc: 0.583 Test Loss: 1.616 Test Acc: 0.583
Validation loss decreased (-0.538870 --> -0.583317).  Saving model ...
Epoch: 5 cost time: 0.8078815937042236
Epoch: 5, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.394 Vali Acc: 0.667 Test Loss: 1.394 Test Acc: 0.667
Validation loss decreased (-0.583317 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 1.019679307937622
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.254 Vali Acc: 0.694 Test Loss: 1.254 Test Acc: 0.694
Validation loss decreased (-0.666653 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 0.9295480251312256
Epoch: 7, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.151 Vali Acc: 0.683 Test Loss: 1.151 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.105515718460083
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.061 Vali Acc: 0.694 Test Loss: 1.061 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 1.0445196628570557
Epoch: 9, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.997 Vali Acc: 0.711 Test Loss: 0.997 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 1.1610493659973145
Epoch: 10, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.918 Vali Acc: 0.744 Test Loss: 0.918 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 1.086763858795166
Epoch: 11, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.883 Vali Acc: 0.767 Test Loss: 0.883 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 1.0991566181182861
Epoch: 12, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.849 Vali Acc: 0.756 Test Loss: 0.849 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9036176204681396
Epoch: 13, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.796 Vali Acc: 0.778 Test Loss: 0.796 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 14 cost time: 1.1404361724853516
Epoch: 14, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0709137916564941
Epoch: 15, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.779 Vali Acc: 0.794 Test Loss: 0.779 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 1.1550638675689697
Epoch: 16, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 1.008699655532837
Epoch: 17, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.9945435523986816
Epoch: 18, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.117983341217041
Epoch: 19, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0229370594024658
Epoch: 20, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 1.0202431678771973
Epoch: 21, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 22 cost time: 0.9051241874694824
Epoch: 22, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.0733168125152588
Epoch: 23, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.554 Vali Acc: 0.817 Test Loss: 0.554 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3003928661346436
Epoch: 24, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.155677080154419
Epoch: 25, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 1.0958025455474854
Epoch: 26, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 27 cost time: 1.1024446487426758
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1157777309417725
Epoch: 28, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 1.1127543449401855
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0513207912445068
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.0303637981414795
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0521793365478516
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0977675914764404
Epoch: 33, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 34 cost time: 1.2280395030975342
Epoch: 34, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 35 cost time: 1.0335338115692139
Epoch: 35, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1905858516693115
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0976362228393555
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0982105731964111
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0333049297332764
Epoch: 39, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0540084838867188
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.127716064453125
Epoch: 41, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1612582206726074
Epoch: 42, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1002411842346191
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9915816783905029
Epoch: 44, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 183911
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1013970375061035
Epoch: 1, Steps: 12 | Train Loss: 2.874 Vali Loss: 2.625 Vali Acc: 0.122 Test Loss: 2.625 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.0367000102996826
Epoch: 2, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.237 Vali Acc: 0.306 Test Loss: 2.237 Test Acc: 0.306
Validation loss decreased (-0.122196 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 0.8413357734680176
Epoch: 3, Steps: 12 | Train Loss: 2.053 Vali Loss: 1.862 Vali Acc: 0.478 Test Loss: 1.862 Test Acc: 0.478
Validation loss decreased (-0.305533 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 0.8557946681976318
Epoch: 4, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.591 Vali Acc: 0.533 Test Loss: 1.591 Test Acc: 0.533
Validation loss decreased (-0.477759 --> -0.533317).  Saving model ...
Epoch: 5 cost time: 0.865337610244751
Epoch: 5, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.378 Vali Acc: 0.628 Test Loss: 1.378 Test Acc: 0.628
Validation loss decreased (-0.533317 --> -0.627764).  Saving model ...
Epoch: 6 cost time: 0.930748701095581
Epoch: 6, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.250 Vali Acc: 0.689 Test Loss: 1.250 Test Acc: 0.689
Validation loss decreased (-0.627764 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 0.7059347629547119
Epoch: 7, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.102 Vali Acc: 0.744 Test Loss: 1.102 Test Acc: 0.744
Validation loss decreased (-0.688876 --> -0.744433).  Saving model ...
Epoch: 8 cost time: 0.9000027179718018
Epoch: 8, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
Validation loss decreased (-0.744433 --> -0.744434).  Saving model ...
Epoch: 9 cost time: 1.316347360610962
Epoch: 9, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.932 Vali Acc: 0.778 Test Loss: 0.932 Test Acc: 0.778
Validation loss decreased (-0.744434 --> -0.777768).  Saving model ...
Epoch: 10 cost time: 1.1457180976867676
Epoch: 10, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.886 Vali Acc: 0.767 Test Loss: 0.886 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3311381340026855
Epoch: 11, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.848 Vali Acc: 0.789 Test Loss: 0.848 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 1.22935152053833
Epoch: 12, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.811 Vali Acc: 0.817 Test Loss: 0.811 Test Acc: 0.817
Validation loss decreased (-0.788880 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 1.1987435817718506
Epoch: 13, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.768 Vali Acc: 0.817 Test Loss: 0.768 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.233328104019165
Epoch: 14, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2707457542419434
Epoch: 15, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.720 Vali Acc: 0.817 Test Loss: 0.720 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 16 cost time: 1.2379286289215088
Epoch: 16, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.2867481708526611
Epoch: 17, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.677 Vali Acc: 0.828 Test Loss: 0.677 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.1949410438537598
Epoch: 18, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 1.1251826286315918
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.2067382335662842
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.2572262287139893
Epoch: 21, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1386666297912598
Epoch: 22, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.058276891708374
Epoch: 23, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1979765892028809
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.15940523147583
Epoch: 25, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 26 cost time: 1.210744857788086
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2431416511535645
Epoch: 27, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.211881399154663
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2263751029968262
Epoch: 29, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.155707836151123
Epoch: 30, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9947667121887207
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0885155200958252
Epoch: 32, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2720005512237549
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0374665260314941
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1433675289154053
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 118375
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.521437883377075
Epoch: 1, Steps: 12 | Train Loss: 2.873 Vali Loss: 2.627 Vali Acc: 0.106 Test Loss: 2.627 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.0414650440216064
Epoch: 2, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.237 Vali Acc: 0.317 Test Loss: 2.237 Test Acc: 0.317
Validation loss decreased (-0.105529 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 1.1133339405059814
Epoch: 3, Steps: 12 | Train Loss: 2.052 Vali Loss: 1.855 Vali Acc: 0.478 Test Loss: 1.855 Test Acc: 0.478
Validation loss decreased (-0.316644 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 1.1567654609680176
Epoch: 4, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.582 Vali Acc: 0.583 Test Loss: 1.582 Test Acc: 0.583
Validation loss decreased (-0.477759 --> -0.583318).  Saving model ...
Epoch: 5 cost time: 1.1247928142547607
Epoch: 5, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.370 Vali Acc: 0.622 Test Loss: 1.370 Test Acc: 0.622
Validation loss decreased (-0.583318 --> -0.622209).  Saving model ...
Epoch: 6 cost time: 1.1743123531341553
Epoch: 6, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.240 Vali Acc: 0.694 Test Loss: 1.240 Test Acc: 0.694
Validation loss decreased (-0.622209 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 1.1462502479553223
Epoch: 7, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.095 Vali Acc: 0.744 Test Loss: 1.095 Test Acc: 0.744
Validation loss decreased (-0.694432 --> -0.744433).  Saving model ...
Epoch: 8 cost time: 1.104325294494629
Epoch: 8, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1640949249267578
Epoch: 9, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.925 Vali Acc: 0.767 Test Loss: 0.925 Test Acc: 0.767
Validation loss decreased (-0.744433 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 0.866478443145752
Epoch: 10, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.881 Vali Acc: 0.778 Test Loss: 0.881 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.1037068367004395
Epoch: 11, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.841 Vali Acc: 0.789 Test Loss: 0.841 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 1.0494797229766846
Epoch: 12, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.806 Vali Acc: 0.817 Test Loss: 0.806 Test Acc: 0.817
Validation loss decreased (-0.788880 --> -0.816659).  Saving model ...
Epoch: 13 cost time: 0.9339420795440674
Epoch: 13, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.767 Vali Acc: 0.828 Test Loss: 0.767 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 14 cost time: 1.0180943012237549
Epoch: 14, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.705 Vali Acc: 0.806 Test Loss: 0.705 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1450603008270264
Epoch: 15, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1121373176574707
Epoch: 16, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1289098262786865
Epoch: 17, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.1359694004058838
Epoch: 18, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.2079288959503174
Epoch: 19, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.2152745723724365
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.1320037841796875
Epoch: 21, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2510919570922852
Epoch: 22, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.168769121170044
Epoch: 23, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.173563003540039
Epoch: 24, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.279118299484253
Epoch: 25, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.590 Vali Acc: 0.883 Test Loss: 0.590 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883327).  Saving model ...
Epoch: 26 cost time: 1.0839974880218506
Epoch: 26, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0477936267852783
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2181932926177979
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1187505722045898
Epoch: 29, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8836402893066406
Epoch: 30, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1164588928222656
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0221400260925293
Epoch: 32, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0614826679229736
Epoch: 33, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1772572994232178
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1248595714569092
Epoch: 35, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 118375
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.773381471633911
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.632 Vali Acc: 0.089 Test Loss: 2.632 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 1.0667390823364258
Epoch: 2, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.241 Vali Acc: 0.283 Test Loss: 2.241 Test Acc: 0.283
Validation loss decreased (-0.088863 --> -0.283311).  Saving model ...
Epoch: 3 cost time: 1.0550165176391602
Epoch: 3, Steps: 12 | Train Loss: 2.041 Vali Loss: 1.856 Vali Acc: 0.450 Test Loss: 1.856 Test Acc: 0.450
Validation loss decreased (-0.283311 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 1.0558691024780273
Epoch: 4, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.580 Vali Acc: 0.606 Test Loss: 1.580 Test Acc: 0.606
Validation loss decreased (-0.449981 --> -0.605540).  Saving model ...
Epoch: 5 cost time: 1.0745081901550293
Epoch: 5, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 0.9335067272186279
Epoch: 6, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.239 Vali Acc: 0.689 Test Loss: 1.239 Test Acc: 0.689
Validation loss decreased (-0.644431 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 0.9804620742797852
Epoch: 7, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.090 Vali Acc: 0.728 Test Loss: 1.090 Test Acc: 0.728
Validation loss decreased (-0.688876 --> -0.727767).  Saving model ...
Epoch: 8 cost time: 0.8960034847259521
Epoch: 8, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.002 Vali Acc: 0.739 Test Loss: 1.002 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 0.875070333480835
Epoch: 9, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.911 Vali Acc: 0.778 Test Loss: 0.911 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777769).  Saving model ...
Epoch: 10 cost time: 0.8709118366241455
Epoch: 10, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.864 Vali Acc: 0.794 Test Loss: 0.864 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 11 cost time: 0.9612765312194824
Epoch: 11, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.824 Vali Acc: 0.794 Test Loss: 0.824 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.2118184566497803
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.793 Vali Acc: 0.806 Test Loss: 0.793 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.2171735763549805
Epoch: 13, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.748 Vali Acc: 0.817 Test Loss: 0.748 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.1492843627929688
Epoch: 14, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1027283668518066
Epoch: 15, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0757441520690918
Epoch: 16, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.659 Vali Acc: 0.817 Test Loss: 0.659 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.150233507156372
Epoch: 17, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.639 Vali Acc: 0.817 Test Loss: 0.639 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.0947246551513672
Epoch: 18, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 1.2222702503204346
Epoch: 19, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 1.1101009845733643
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.109438419342041
Epoch: 21, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2314419746398926
Epoch: 22, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 1.2704038619995117
Epoch: 23, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 1.1136748790740967
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0269432067871094
Epoch: 25, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.0823819637298584
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.233384132385254
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2735824584960938
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0228114128112793
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1416692733764648
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0944483280181885
Epoch: 31, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1115870475769043
Epoch: 32, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.523 Vali Acc: 0.839 Test Loss: 0.523 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0442407131195068
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9700484275817871
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9631764888763428
Epoch: 35, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 118375
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3641788959503174
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.598 Vali Acc: 0.083 Test Loss: 2.598 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.9990236759185791
Epoch: 2, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.229 Vali Acc: 0.344 Test Loss: 2.229 Test Acc: 0.344
Validation loss decreased (-0.083307 --> -0.344422).  Saving model ...
Epoch: 3 cost time: 1.0153074264526367
Epoch: 3, Steps: 12 | Train Loss: 2.059 Vali Loss: 1.859 Vali Acc: 0.489 Test Loss: 1.859 Test Acc: 0.489
Validation loss decreased (-0.344422 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.0452661514282227
Epoch: 4, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.590 Vali Acc: 0.600 Test Loss: 1.590 Test Acc: 0.600
Validation loss decreased (-0.488870 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 0.9709212779998779
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.386 Vali Acc: 0.656 Test Loss: 1.386 Test Acc: 0.656
Validation loss decreased (-0.599984 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 1.1245856285095215
Epoch: 6, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.263 Vali Acc: 0.678 Test Loss: 1.263 Test Acc: 0.678
Validation loss decreased (-0.655542 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 1.0965235233306885
Epoch: 7, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.121 Vali Acc: 0.706 Test Loss: 1.121 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 8 cost time: 1.007115125656128
Epoch: 8, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.036 Vali Acc: 0.711 Test Loss: 1.036 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 0.9944536685943604
Epoch: 9, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.950 Vali Acc: 0.722 Test Loss: 0.950 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 1.021345615386963
Epoch: 10, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.903 Vali Acc: 0.756 Test Loss: 0.903 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 1.0578553676605225
Epoch: 11, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.864 Vali Acc: 0.744 Test Loss: 0.864 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1985831260681152
Epoch: 12, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 1.0847227573394775
Epoch: 13, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.777 Vali Acc: 0.794 Test Loss: 0.777 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 1.1851203441619873
Epoch: 14, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0098462104797363
Epoch: 15, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.716 Vali Acc: 0.794 Test Loss: 0.716 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 1.0943233966827393
Epoch: 16, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.096106767654419
Epoch: 17, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 18 cost time: 1.0375831127166748
Epoch: 18, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.9863300323486328
Epoch: 19, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.614 Vali Acc: 0.794 Test Loss: 0.614 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1100225448608398
Epoch: 20, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.605 Vali Acc: 0.817 Test Loss: 0.605 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 21 cost time: 1.046536922454834
Epoch: 21, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1057870388031006
Epoch: 22, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 23 cost time: 0.8980307579040527
Epoch: 23, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 1.0008196830749512
Epoch: 24, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1931936740875244
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 1.0884690284729004
Epoch: 26, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1236803531646729
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9166791439056396
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.523 Vali Acc: 0.839 Test Loss: 0.523 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0541934967041016
Epoch: 29, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 30 cost time: 1.1313986778259277
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9569873809814453
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 0.9083001613616943
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9787333011627197
Epoch: 33, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.041961669921875
Epoch: 34, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0764410495758057
Epoch: 35, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.108776569366455
Epoch: 36, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9919333457946777
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 38 cost time: 0.9849698543548584
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.483 Vali Acc: 0.839 Test Loss: 0.483 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2625279426574707
Epoch: 39, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1698613166809082
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1132702827453613
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0611441135406494
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1690700054168701
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9592151641845703
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8773994445800781
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9223852157592773
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.043471097946167
Epoch: 47, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 118375
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4838860034942627
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.606 Vali Acc: 0.150 Test Loss: 2.606 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 1.2562096118927002
Epoch: 2, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.236 Vali Acc: 0.317 Test Loss: 2.236 Test Acc: 0.317
Validation loss decreased (-0.149974 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 1.2806408405303955
Epoch: 3, Steps: 12 | Train Loss: 2.003 Vali Loss: 1.869 Vali Acc: 0.439 Test Loss: 1.869 Test Acc: 0.439
Validation loss decreased (-0.316644 --> -0.438870).  Saving model ...
Epoch: 4 cost time: 1.0103819370269775
Epoch: 4, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.594 Vali Acc: 0.567 Test Loss: 1.594 Test Acc: 0.567
Validation loss decreased (-0.438870 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 0.9899075031280518
Epoch: 5, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.393 Vali Acc: 0.672 Test Loss: 1.393 Test Acc: 0.672
Validation loss decreased (-0.566651 --> -0.672208).  Saving model ...
Epoch: 6 cost time: 1.0821223258972168
Epoch: 6, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.236 Vali Acc: 0.706 Test Loss: 1.236 Test Acc: 0.706
Validation loss decreased (-0.672208 --> -0.705543).  Saving model ...
Epoch: 7 cost time: 1.288114309310913
Epoch: 7, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.116 Vali Acc: 0.728 Test Loss: 1.116 Test Acc: 0.728
Validation loss decreased (-0.705543 --> -0.727767).  Saving model ...
Epoch: 8 cost time: 1.2151896953582764
Epoch: 8, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.237436056137085
Epoch: 9, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.956 Vali Acc: 0.761 Test Loss: 0.956 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.301887035369873
Epoch: 10, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.893 Vali Acc: 0.772 Test Loss: 0.893 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 11 cost time: 1.3562629222869873
Epoch: 11, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.870 Vali Acc: 0.767 Test Loss: 0.870 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2209479808807373
Epoch: 12, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.821 Vali Acc: 0.800 Test Loss: 0.821 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.2292988300323486
Epoch: 13, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.772 Vali Acc: 0.817 Test Loss: 0.772 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.2750728130340576
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.742 Vali Acc: 0.817 Test Loss: 0.742 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 1.185234785079956
Epoch: 15, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 1.1677796840667725
Epoch: 16, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 1.2598199844360352
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0969090461730957
Epoch: 18, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.1390671730041504
Epoch: 19, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0111005306243896
Epoch: 20, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.2100074291229248
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 1.192537784576416
Epoch: 22, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 1.2500922679901123
Epoch: 23, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.358701467514038
Epoch: 24, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2104370594024658
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3369522094726562
Epoch: 26, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2155439853668213
Epoch: 27, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.297912836074829
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0200083255767822
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3445329666137695
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.197474479675293
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1691431999206543
Epoch: 32, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 85607
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7219724655151367
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.590 Vali Acc: 0.172 Test Loss: 2.590 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 1.2342336177825928
Epoch: 2, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.222 Vali Acc: 0.333 Test Loss: 2.222 Test Acc: 0.333
Validation loss decreased (-0.172196 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 1.1642138957977295
Epoch: 3, Steps: 12 | Train Loss: 2.009 Vali Loss: 1.855 Vali Acc: 0.428 Test Loss: 1.855 Test Acc: 0.428
Validation loss decreased (-0.333311 --> -0.427759).  Saving model ...
Epoch: 4 cost time: 1.3006784915924072
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
Validation loss decreased (-0.427759 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.2946603298187256
Epoch: 5, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.380 Vali Acc: 0.678 Test Loss: 1.380 Test Acc: 0.678
Validation loss decreased (-0.549984 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 1.3346302509307861
Epoch: 6, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.225 Vali Acc: 0.711 Test Loss: 1.225 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 1.283881664276123
Epoch: 7, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.103 Vali Acc: 0.733 Test Loss: 1.103 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 8 cost time: 1.3185627460479736
Epoch: 8, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.008 Vali Acc: 0.744 Test Loss: 1.008 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 9 cost time: 1.3412683010101318
Epoch: 9, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.947 Vali Acc: 0.756 Test Loss: 0.947 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.2488958835601807
Epoch: 10, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.882 Vali Acc: 0.772 Test Loss: 0.882 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 11 cost time: 0.9101059436798096
Epoch: 11, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.090484857559204
Epoch: 12, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.810 Vali Acc: 0.794 Test Loss: 0.810 Test Acc: 0.794
Validation loss decreased (-0.772213 --> -0.794436).  Saving model ...
Epoch: 13 cost time: 0.9023849964141846
Epoch: 13, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.760 Vali Acc: 0.817 Test Loss: 0.760 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 0.9923079013824463
Epoch: 14, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0770819187164307
Epoch: 15, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 1.2846665382385254
Epoch: 16, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.062821626663208
Epoch: 17, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.18934965133667
Epoch: 18, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.0508763790130615
Epoch: 19, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.1949267387390137
Epoch: 20, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.0725295543670654
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.0237281322479248
Epoch: 22, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.0146472454071045
Epoch: 23, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.210111379623413
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3338971138000488
Epoch: 25, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.280277967453003
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.257775068283081
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 1.2735545635223389
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1604042053222656
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0412464141845703
Epoch: 30, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.0871281623840332
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.175994634628296
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.116370677947998
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3202576637268066
Epoch: 34, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.114875078201294
Epoch: 35, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.288949966430664
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3013198375701904
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1651639938354492
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2317008972167969
Epoch: 39, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2332897186279297
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 85607
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.673146963119507
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.600 Vali Acc: 0.144 Test Loss: 2.600 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.0633509159088135
Epoch: 2, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.227 Vali Acc: 0.378 Test Loss: 2.227 Test Acc: 0.378
Validation loss decreased (-0.144418 --> -0.377756).  Saving model ...
Epoch: 3 cost time: 1.2261269092559814
Epoch: 3, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.856 Vali Acc: 0.461 Test Loss: 1.856 Test Acc: 0.461
Validation loss decreased (-0.377756 --> -0.461093).  Saving model ...
Epoch: 4 cost time: 1.212801456451416
Epoch: 4, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.575 Vali Acc: 0.544 Test Loss: 1.575 Test Acc: 0.544
Validation loss decreased (-0.461093 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 0.9807531833648682
Epoch: 5, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.372 Vali Acc: 0.656 Test Loss: 1.372 Test Acc: 0.656
Validation loss decreased (-0.544429 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 0.9636573791503906
Epoch: 6, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.218 Vali Acc: 0.694 Test Loss: 1.218 Test Acc: 0.694
Validation loss decreased (-0.655542 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 0.9326648712158203
Epoch: 7, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.100 Vali Acc: 0.739 Test Loss: 1.100 Test Acc: 0.739
Validation loss decreased (-0.694432 --> -0.738878).  Saving model ...
Epoch: 8 cost time: 1.1459119319915771
Epoch: 8, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
Validation loss decreased (-0.738878 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.2346768379211426
Epoch: 9, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.940 Vali Acc: 0.767 Test Loss: 0.940 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.375657558441162
Epoch: 10, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.874 Vali Acc: 0.772 Test Loss: 0.874 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 11 cost time: 1.212005615234375
Epoch: 11, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.848 Vali Acc: 0.767 Test Loss: 0.848 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0953381061553955
Epoch: 12, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.793 Vali Acc: 0.789 Test Loss: 0.793 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 1.0803096294403076
Epoch: 13, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 14 cost time: 1.159864902496338
Epoch: 14, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 15 cost time: 1.0825684070587158
Epoch: 15, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 0.8878519535064697
Epoch: 16, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 0.9742627143859863
Epoch: 17, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1809241771697998
Epoch: 18, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 1.0666742324829102
Epoch: 19, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.1570980548858643
Epoch: 20, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.138871431350708
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.113893747329712
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1763629913330078
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.2162506580352783
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1716969013214111
Epoch: 25, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1526081562042236
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1278979778289795
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2145006656646729
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2161245346069336
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2125818729400635
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 1.1822385787963867
Epoch: 31, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1246097087860107
Epoch: 32, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.018071174621582
Epoch: 33, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.097381353378296
Epoch: 34, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 1.1274926662445068
Epoch: 35, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.553 Vali Acc: 0.883 Test Loss: 0.553 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 36 cost time: 1.1307110786437988
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.192429780960083
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2332062721252441
Epoch: 38, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.012873888015747
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0318078994750977
Epoch: 40, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0623176097869873
Epoch: 41, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9125704765319824
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0462937355041504
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1349129676818848
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.1643550395965576
Epoch: 45, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 85607
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6942732334136963
Epoch: 1, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.602 Vali Acc: 0.117 Test Loss: 2.602 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 1.0380754470825195
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.245 Vali Acc: 0.350 Test Loss: 2.245 Test Acc: 0.350
Validation loss decreased (-0.116641 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 1.070239543914795
Epoch: 3, Steps: 12 | Train Loss: 2.032 Vali Loss: 1.877 Vali Acc: 0.461 Test Loss: 1.877 Test Acc: 0.461
Validation loss decreased (-0.349978 --> -0.461092).  Saving model ...
Epoch: 4 cost time: 1.0520803928375244
Epoch: 4, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.599 Vali Acc: 0.583 Test Loss: 1.599 Test Acc: 0.583
Validation loss decreased (-0.461092 --> -0.583317).  Saving model ...
Epoch: 5 cost time: 0.9211797714233398
Epoch: 5, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.401 Vali Acc: 0.672 Test Loss: 1.401 Test Acc: 0.672
Validation loss decreased (-0.583317 --> -0.672208).  Saving model ...
Epoch: 6 cost time: 0.8547027111053467
Epoch: 6, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.254 Vali Acc: 0.683 Test Loss: 1.254 Test Acc: 0.683
Validation loss decreased (-0.672208 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 0.9046363830566406
Epoch: 7, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.137 Vali Acc: 0.689 Test Loss: 1.137 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 1.1693041324615479
Epoch: 8, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 1.1124627590179443
Epoch: 9, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 1.0364856719970703
Epoch: 10, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.0492901802062988
Epoch: 11, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9877986907958984
Epoch: 12, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 0.9944858551025391
Epoch: 13, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.9810175895690918
Epoch: 14, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.1008491516113281
Epoch: 15, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9711472988128662
Epoch: 16, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.688 Vali Acc: 0.806 Test Loss: 0.688 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 1.0218241214752197
Epoch: 17, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0661754608154297
Epoch: 18, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.0763378143310547
Epoch: 19, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.611 Vali Acc: 0.806 Test Loss: 0.611 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0143992900848389
Epoch: 20, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1234283447265625
Epoch: 21, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 1.1013734340667725
Epoch: 22, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.0297656059265137
Epoch: 23, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.985370397567749
Epoch: 24, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0661120414733887
Epoch: 25, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.522 Vali Acc: 0.817 Test Loss: 0.522 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9341762065887451
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 0.9797632694244385
Epoch: 27, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1190168857574463
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9921038150787354
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9168174266815186
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 0.8639223575592041
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.0624334812164307
Epoch: 32, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.9719018936157227
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.028038740158081
Epoch: 34, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0974876880645752
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 36 cost time: 0.9249241352081299
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.0081770420074463
Epoch: 37, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.883669376373291
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.0064489841461182
Epoch: 39, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0794217586517334
Epoch: 40, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1019527912139893
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1400949954986572
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.066711664199829
Epoch: 43, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0881402492523193
Epoch: 44, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.009843111038208
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.132197618484497
Epoch: 46, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0149636268615723
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1108338832855225
Epoch: 48, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 85607
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.259364366531372
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.626 Vali Acc: 0.128 Test Loss: 2.626 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 1.0079758167266846
Epoch: 2, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.206 Vali Acc: 0.322 Test Loss: 2.206 Test Acc: 0.322
Validation loss decreased (-0.127752 --> -0.322200).  Saving model ...
Epoch: 3 cost time: 1.150101661682129
Epoch: 3, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.848 Vali Acc: 0.489 Test Loss: 1.848 Test Acc: 0.489
Validation loss decreased (-0.322200 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.148756504058838
Epoch: 4, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.549 Vali Acc: 0.683 Test Loss: 1.549 Test Acc: 0.683
Validation loss decreased (-0.488870 --> -0.683318).  Saving model ...
Epoch: 5 cost time: 1.063537359237671
Epoch: 5, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.346 Vali Acc: 0.711 Test Loss: 1.346 Test Acc: 0.711
Validation loss decreased (-0.683318 --> -0.711098).  Saving model ...
Epoch: 6 cost time: 1.1628572940826416
Epoch: 6, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.215 Vali Acc: 0.711 Test Loss: 1.215 Test Acc: 0.711
Validation loss decreased (-0.711098 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 0.9991393089294434
Epoch: 7, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.093 Vali Acc: 0.728 Test Loss: 1.093 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727767).  Saving model ...
Epoch: 8 cost time: 1.0081024169921875
Epoch: 8, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.0704288482666016
Epoch: 9, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.919 Vali Acc: 0.772 Test Loss: 0.919 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 10 cost time: 1.1383650302886963
Epoch: 10, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.887 Vali Acc: 0.789 Test Loss: 0.887 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 1.2721307277679443
Epoch: 11, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.815 Vali Acc: 0.811 Test Loss: 0.815 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 1.2983195781707764
Epoch: 12, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.775 Vali Acc: 0.811 Test Loss: 0.775 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.1217687129974365
Epoch: 13, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.759 Vali Acc: 0.822 Test Loss: 0.759 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 1.1225335597991943
Epoch: 14, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1757638454437256
Epoch: 15, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 1.1231632232666016
Epoch: 16, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 0.9736402034759521
Epoch: 17, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0594534873962402
Epoch: 18, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 0.9759435653686523
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.036534070968628
Epoch: 20, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0498566627502441
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 0.9490189552307129
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9255261421203613
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.9952521324157715
Epoch: 24, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.1450092792510986
Epoch: 25, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2092292308807373
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1722843647003174
Epoch: 27, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3068289756774902
Epoch: 28, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0577683448791504
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9902582168579102
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0107688903808594
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2604572772979736
Epoch: 32, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2557313442230225
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2437965869903564
Epoch: 34, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 69223
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.558804750442505
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.630 Vali Acc: 0.156 Test Loss: 2.630 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.1234211921691895
Epoch: 2, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.212 Vali Acc: 0.317 Test Loss: 2.212 Test Acc: 0.317
Validation loss decreased (-0.155529 --> -0.316645).  Saving model ...
Epoch: 3 cost time: 1.280651569366455
Epoch: 3, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.853 Vali Acc: 0.489 Test Loss: 1.853 Test Acc: 0.489
Validation loss decreased (-0.316645 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.1427481174468994
Epoch: 4, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.551 Vali Acc: 0.639 Test Loss: 1.551 Test Acc: 0.639
Validation loss decreased (-0.488870 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 1.0800583362579346
Epoch: 5, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.346 Vali Acc: 0.689 Test Loss: 1.346 Test Acc: 0.689
Validation loss decreased (-0.638873 --> -0.688875).  Saving model ...
Epoch: 6 cost time: 1.157886266708374
Epoch: 6, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.212 Vali Acc: 0.722 Test Loss: 1.212 Test Acc: 0.722
Validation loss decreased (-0.688875 --> -0.722210).  Saving model ...
Epoch: 7 cost time: 1.3095059394836426
Epoch: 7, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.095 Vali Acc: 0.717 Test Loss: 1.095 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1419532299041748
Epoch: 8, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.1808202266693115
Epoch: 9, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.919 Vali Acc: 0.767 Test Loss: 0.919 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 1.283498764038086
Epoch: 10, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.884 Vali Acc: 0.783 Test Loss: 0.884 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783324).  Saving model ...
Epoch: 11 cost time: 1.299665927886963
Epoch: 11, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.814 Vali Acc: 0.811 Test Loss: 0.814 Test Acc: 0.811
Validation loss decreased (-0.783324 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 1.2358059883117676
Epoch: 12, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.773 Vali Acc: 0.806 Test Loss: 0.773 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2304399013519287
Epoch: 13, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.759 Vali Acc: 0.822 Test Loss: 0.759 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 1.1167337894439697
Epoch: 14, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.729 Vali Acc: 0.806 Test Loss: 0.729 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1545133590698242
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.1222915649414062
Epoch: 16, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.2453620433807373
Epoch: 17, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3065299987792969
Epoch: 18, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.2182300090789795
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2452504634857178
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1249468326568604
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.2331089973449707
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3044226169586182
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.1212713718414307
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.180663824081421
Epoch: 25, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0113484859466553
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2864282131195068
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2179896831512451
Epoch: 28, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1531550884246826
Epoch: 29, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3064601421356201
Epoch: 30, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2703344821929932
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2158267498016357
Epoch: 32, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2500593662261963
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9771072864532471
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 69223
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1917970180511475
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.638 Vali Acc: 0.172 Test Loss: 2.638 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 1.0169901847839355
Epoch: 2, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.224 Vali Acc: 0.306 Test Loss: 2.224 Test Acc: 0.306
Validation loss decreased (-0.172196 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 1.0456812381744385
Epoch: 3, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.860 Vali Acc: 0.478 Test Loss: 1.860 Test Acc: 0.478
Validation loss decreased (-0.305533 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 0.9907760620117188
Epoch: 4, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.557 Vali Acc: 0.678 Test Loss: 1.557 Test Acc: 0.678
Validation loss decreased (-0.477759 --> -0.677762).  Saving model ...
Epoch: 5 cost time: 0.8897521495819092
Epoch: 5, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.351 Vali Acc: 0.678 Test Loss: 1.351 Test Acc: 0.678
Validation loss decreased (-0.677762 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 0.9189057350158691
Epoch: 6, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.210 Vali Acc: 0.711 Test Loss: 1.210 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 0.9319460391998291
Epoch: 7, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.090 Vali Acc: 0.728 Test Loss: 1.090 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727767).  Saving model ...
Epoch: 8 cost time: 1.124598503112793
Epoch: 8, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1156420707702637
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.908 Vali Acc: 0.767 Test Loss: 0.908 Test Acc: 0.767
Validation loss decreased (-0.727767 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.1787810325622559
Epoch: 10, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 1.1561756134033203
Epoch: 11, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.203007459640503
Epoch: 12, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.8949606418609619
Epoch: 13, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.9964182376861572
Epoch: 14, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.1239042282104492
Epoch: 15, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 1.0168492794036865
Epoch: 16, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.021263599395752
Epoch: 17, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.638 Vali Acc: 0.811 Test Loss: 0.638 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0661966800689697
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.0264525413513184
Epoch: 19, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0034399032592773
Epoch: 20, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1220998764038086
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 1.0842163562774658
Epoch: 22, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0361344814300537
Epoch: 23, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.111128330230713
Epoch: 24, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 1.0569331645965576
Epoch: 25, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.144291877746582
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.028578281402588
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9500813484191895
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.575 Vali Acc: 0.883 Test Loss: 0.575 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.0548667907714844
Epoch: 29, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0865411758422852
Epoch: 30, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1368160247802734
Epoch: 31, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0650396347045898
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0422403812408447
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9756040573120117
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.053870439529419
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0593833923339844
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.950385332107544
Epoch: 37, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9993083477020264
Epoch: 38, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 69223
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.229804515838623
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.621 Vali Acc: 0.117 Test Loss: 2.621 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.069232702255249
Epoch: 2, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.229 Vali Acc: 0.306 Test Loss: 2.229 Test Acc: 0.306
Validation loss decreased (-0.116640 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 1.0738704204559326
Epoch: 3, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.883 Vali Acc: 0.444 Test Loss: 1.883 Test Acc: 0.444
Validation loss decreased (-0.305533 --> -0.444426).  Saving model ...
Epoch: 4 cost time: 1.0519092082977295
Epoch: 4, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.593 Vali Acc: 0.667 Test Loss: 1.593 Test Acc: 0.667
Validation loss decreased (-0.444426 --> -0.666651).  Saving model ...
Epoch: 5 cost time: 1.0345900058746338
Epoch: 5, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.392 Vali Acc: 0.667 Test Loss: 1.392 Test Acc: 0.667
Validation loss decreased (-0.666651 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 1.0825550556182861
Epoch: 6, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.254 Vali Acc: 0.694 Test Loss: 1.254 Test Acc: 0.694
Validation loss decreased (-0.666653 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 0.9941704273223877
Epoch: 7, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.138 Vali Acc: 0.683 Test Loss: 1.138 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9362576007843018
Epoch: 8, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.041 Vali Acc: 0.672 Test Loss: 1.041 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9309651851654053
Epoch: 9, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.945 Vali Acc: 0.733 Test Loss: 0.945 Test Acc: 0.733
Validation loss decreased (-0.694432 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 1.0371477603912354
Epoch: 10, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 1.1832520961761475
Epoch: 11, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.852 Vali Acc: 0.744 Test Loss: 0.852 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744436).  Saving model ...
Epoch: 12 cost time: 1.0171289443969727
Epoch: 12, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.1403172016143799
Epoch: 13, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 1.1953496932983398
Epoch: 14, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 15 cost time: 0.8869245052337646
Epoch: 15, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0986173152923584
Epoch: 16, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 1.0557787418365479
Epoch: 17, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.668 Vali Acc: 0.794 Test Loss: 0.668 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1851184368133545
Epoch: 18, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0500173568725586
Epoch: 19, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 1.1698873043060303
Epoch: 20, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2024896144866943
Epoch: 21, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 1.2342994213104248
Epoch: 22, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.811 Test Loss: 0.560 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1627485752105713
Epoch: 23, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 1.118657112121582
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 1.1362340450286865
Epoch: 25, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.0936927795410156
Epoch: 26, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0570507049560547
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1477203369140625
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1637730598449707
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0356419086456299
Epoch: 30, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1288065910339355
Epoch: 31, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 1.2230141162872314
Epoch: 32, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 33 cost time: 1.3020105361938477
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.475 Vali Acc: 0.872 Test Loss: 0.475 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 1.1393632888793945
Epoch: 34, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2202792167663574
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2052595615386963
Epoch: 36, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0801382064819336
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1267452239990234
Epoch: 38, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9924349784851074
Epoch: 39, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9712414741516113
Epoch: 40, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 0.9582648277282715
Epoch: 41, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0767111778259277
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9864439964294434
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9009175300598145
Epoch: 44, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1200981140136719
Epoch: 45, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1102352142333984
Epoch: 46, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1652848720550537
Epoch: 47, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1703577041625977
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.066817283630371
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0817062854766846
Epoch: 50, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 69223
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.363646984100342
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.690 Vali Acc: 0.200 Test Loss: 2.690 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 1.0258097648620605
Epoch: 2, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.287 Vali Acc: 0.311 Test Loss: 2.287 Test Acc: 0.311
Validation loss decreased (-0.199973 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 1.2001681327819824
Epoch: 3, Steps: 12 | Train Loss: 2.028 Vali Loss: 1.885 Vali Acc: 0.494 Test Loss: 1.885 Test Acc: 0.494
Validation loss decreased (-0.311088 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 1.1271142959594727
Epoch: 4, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.564 Vali Acc: 0.594 Test Loss: 1.564 Test Acc: 0.594
Validation loss decreased (-0.494426 --> -0.594429).  Saving model ...
Epoch: 5 cost time: 1.0619971752166748
Epoch: 5, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.373 Vali Acc: 0.694 Test Loss: 1.373 Test Acc: 0.694
Validation loss decreased (-0.594429 --> -0.694431).  Saving model ...
Epoch: 6 cost time: 1.2447717189788818
Epoch: 6, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.203 Vali Acc: 0.717 Test Loss: 1.203 Test Acc: 0.717
Validation loss decreased (-0.694431 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 1.0446522235870361
Epoch: 7, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.118 Vali Acc: 0.728 Test Loss: 1.118 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 8 cost time: 0.9526476860046387
Epoch: 8, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.025 Vali Acc: 0.739 Test Loss: 1.025 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 1.161212682723999
Epoch: 9, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.933 Vali Acc: 0.761 Test Loss: 0.933 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.0652384757995605
Epoch: 10, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.872 Vali Acc: 0.761 Test Loss: 0.872 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 1.0814402103424072
Epoch: 11, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.819 Vali Acc: 0.811 Test Loss: 0.819 Test Acc: 0.811
Validation loss decreased (-0.761102 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 1.3158698081970215
Epoch: 12, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.799 Vali Acc: 0.806 Test Loss: 0.799 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.101595163345337
Epoch: 13, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.748 Vali Acc: 0.811 Test Loss: 0.748 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 1.2956719398498535
Epoch: 14, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.1930429935455322
Epoch: 15, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2849094867706299
Epoch: 16, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.2084345817565918
Epoch: 17, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 1.3453733921051025
Epoch: 18, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3484416007995605
Epoch: 19, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2173655033111572
Epoch: 20, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.2526099681854248
Epoch: 21, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2166452407836914
Epoch: 22, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.244668960571289
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.2447891235351562
Epoch: 24, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 1.187662124633789
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 0.9557123184204102
Epoch: 26, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 1.1339032649993896
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0324311256408691
Epoch: 28, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1619229316711426
Epoch: 29, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1094927787780762
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9667527675628662
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1621415615081787
Epoch: 32, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2817704677581787
Epoch: 33, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1189460754394531
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2321293354034424
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.273397445678711
Epoch: 36, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 61031
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8249728679656982
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.668 Vali Acc: 0.183 Test Loss: 2.668 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 1.0209236145019531
Epoch: 2, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.269 Vali Acc: 0.328 Test Loss: 2.269 Test Acc: 0.328
Validation loss decreased (-0.183307 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 1.0399723052978516
Epoch: 3, Steps: 12 | Train Loss: 2.022 Vali Loss: 1.869 Vali Acc: 0.500 Test Loss: 1.869 Test Acc: 0.500
Validation loss decreased (-0.327755 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.0052015781402588
Epoch: 4, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.552 Vali Acc: 0.578 Test Loss: 1.552 Test Acc: 0.578
Validation loss decreased (-0.499981 --> -0.577762).  Saving model ...
Epoch: 5 cost time: 1.1882503032684326
Epoch: 5, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.363 Vali Acc: 0.700 Test Loss: 1.363 Test Acc: 0.700
Validation loss decreased (-0.577762 --> -0.699986).  Saving model ...
Epoch: 6 cost time: 1.2195963859558105
Epoch: 6, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.197 Vali Acc: 0.722 Test Loss: 1.197 Test Acc: 0.722
Validation loss decreased (-0.699986 --> -0.722210).  Saving model ...
Epoch: 7 cost time: 1.2535066604614258
Epoch: 7, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.114 Vali Acc: 0.717 Test Loss: 1.114 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3027589321136475
Epoch: 8, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
Validation loss decreased (-0.722210 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 1.1843512058258057
Epoch: 9, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.930 Vali Acc: 0.761 Test Loss: 0.930 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.168351650238037
Epoch: 10, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3347282409667969
Epoch: 11, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.822 Vali Acc: 0.817 Test Loss: 0.822 Test Acc: 0.817
Validation loss decreased (-0.761102 --> -0.816658).  Saving model ...
Epoch: 12 cost time: 1.1158909797668457
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.058779001235962
Epoch: 13, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.750 Vali Acc: 0.811 Test Loss: 0.750 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1865341663360596
Epoch: 14, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3222301006317139
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
Validation loss decreased (-0.816658 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.2114102840423584
Epoch: 16, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.2842764854431152
Epoch: 17, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.2594008445739746
Epoch: 18, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 1.2917404174804688
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 1.3146343231201172
Epoch: 20, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.176055669784546
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3704345226287842
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.320605754852295
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 1.4673161506652832
Epoch: 24, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 1.1850619316101074
Epoch: 25, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1255850791931152
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 1.2390313148498535
Epoch: 27, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.092231035232544
Epoch: 28, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4253439903259277
Epoch: 29, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.32012939453125
Epoch: 30, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.1217987537384033
Epoch: 31, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 1.243131399154663
Epoch: 32, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.2923946380615234
Epoch: 33, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1602129936218262
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2634570598602295
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3917076587677002
Epoch: 36, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3708882331848145
Epoch: 37, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2812714576721191
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.354457139968872
Epoch: 39, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1597533226013184
Epoch: 40, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2237706184387207
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1305606365203857
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877771).  Saving model ...
Epoch: 43 cost time: 1.0948855876922607
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2851555347442627
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.166823148727417
Epoch: 45, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2907297611236572
Epoch: 46, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0434973239898682
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.197150468826294
Epoch: 48, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1525311470031738
Epoch: 49, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.732 Vali Acc: 0.867 Test Loss: 0.732 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2967698574066162
Epoch: 50, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.1967670917510986
Epoch: 51, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.24135160446167
Epoch: 52, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.708 Vali Acc: 0.861 Test Loss: 0.708 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 61031
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0328919887542725
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.665 Vali Acc: 0.200 Test Loss: 2.665 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 1.0160517692565918
Epoch: 2, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.267 Vali Acc: 0.328 Test Loss: 2.267 Test Acc: 0.328
Validation loss decreased (-0.199973 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 0.9450278282165527
Epoch: 3, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.863 Vali Acc: 0.539 Test Loss: 1.863 Test Acc: 0.539
Validation loss decreased (-0.327755 --> -0.538870).  Saving model ...
Epoch: 4 cost time: 0.9104866981506348
Epoch: 4, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.543 Vali Acc: 0.644 Test Loss: 1.543 Test Acc: 0.644
Validation loss decreased (-0.538870 --> -0.644429).  Saving model ...
Epoch: 5 cost time: 0.943244218826294
Epoch: 5, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.355 Vali Acc: 0.689 Test Loss: 1.355 Test Acc: 0.689
Validation loss decreased (-0.644429 --> -0.688875).  Saving model ...
Epoch: 6 cost time: 0.9160332679748535
Epoch: 6, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.190 Vali Acc: 0.711 Test Loss: 1.190 Test Acc: 0.711
Validation loss decreased (-0.688875 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 0.93355393409729
Epoch: 7, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.105 Vali Acc: 0.717 Test Loss: 1.105 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716656).  Saving model ...
Epoch: 8 cost time: 1.0392308235168457
Epoch: 8, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 0.8574056625366211
Epoch: 9, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.917 Vali Acc: 0.761 Test Loss: 0.917 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 0.8771071434020996
Epoch: 10, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.857 Vali Acc: 0.772 Test Loss: 0.857 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 0.8713982105255127
Epoch: 11, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.809 Vali Acc: 0.811 Test Loss: 0.809 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 0.9606654644012451
Epoch: 12, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9571170806884766
Epoch: 13, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.729 Vali Acc: 0.811 Test Loss: 0.729 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 0.9844129085540771
Epoch: 14, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0680358409881592
Epoch: 15, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.0593359470367432
Epoch: 16, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.677 Vali Acc: 0.828 Test Loss: 0.677 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.0742056369781494
Epoch: 17, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.116137981414795
Epoch: 18, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.629 Vali Acc: 0.828 Test Loss: 0.629 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 0.9487249851226807
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 0.9453418254852295
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 0.9693489074707031
Epoch: 21, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8724195957183838
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9499692916870117
Epoch: 23, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 0.920673131942749
Epoch: 24, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 0.9149096012115479
Epoch: 25, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8508114814758301
Epoch: 26, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.9072186946868896
Epoch: 27, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.03202223777771
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.003387451171875
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.162428379058838
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 1.0941944122314453
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.123800277709961
Epoch: 32, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 33 cost time: 0.9716246128082275
Epoch: 33, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.991950511932373
Epoch: 34, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0930325984954834
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.091003656387329
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.09409761428833
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1510686874389648
Epoch: 38, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1568145751953125
Epoch: 39, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.044175624847412
Epoch: 40, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 1.0404951572418213
Epoch: 41, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0766677856445312
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.068326473236084
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1991441249847412
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2529869079589844
Epoch: 45, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.171987771987915
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.093782901763916
Epoch: 47, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1783928871154785
Epoch: 48, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2275230884552002
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1075620651245117
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 61031
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5653364658355713
Epoch: 1, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.665 Vali Acc: 0.239 Test Loss: 2.665 Test Acc: 0.239
Validation loss decreased (inf --> -0.238862).  Saving model ...
Epoch: 2 cost time: 1.2269537448883057
Epoch: 2, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.293 Vali Acc: 0.317 Test Loss: 2.293 Test Acc: 0.317
Validation loss decreased (-0.238862 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 1.1045737266540527
Epoch: 3, Steps: 12 | Train Loss: 2.042 Vali Loss: 1.907 Vali Acc: 0.522 Test Loss: 1.907 Test Acc: 0.522
Validation loss decreased (-0.316644 --> -0.522203).  Saving model ...
Epoch: 4 cost time: 1.1162660121917725
Epoch: 4, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.596 Vali Acc: 0.606 Test Loss: 1.596 Test Acc: 0.606
Validation loss decreased (-0.522203 --> -0.605540).  Saving model ...
Epoch: 5 cost time: 1.0915026664733887
Epoch: 5, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.410 Vali Acc: 0.661 Test Loss: 1.410 Test Acc: 0.661
Validation loss decreased (-0.605540 --> -0.661097).  Saving model ...
Epoch: 6 cost time: 1.0454614162445068
Epoch: 6, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.255 Vali Acc: 0.661 Test Loss: 1.255 Test Acc: 0.661
Validation loss decreased (-0.661097 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 1.2122838497161865
Epoch: 7, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0332884788513184
Epoch: 8, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.080 Vali Acc: 0.672 Test Loss: 1.080 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 1.0140635967254639
Epoch: 9, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705546).  Saving model ...
Epoch: 10 cost time: 1.0970706939697266
Epoch: 10, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.923 Vali Acc: 0.728 Test Loss: 0.923 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 1.1853680610656738
Epoch: 11, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.863 Vali Acc: 0.767 Test Loss: 0.863 Test Acc: 0.767
Validation loss decreased (-0.727769 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 1.152904748916626
Epoch: 12, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.833 Vali Acc: 0.767 Test Loss: 0.833 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 1.0727441310882568
Epoch: 13, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1032154560089111
Epoch: 14, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 1.0485680103302002
Epoch: 15, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 1.065337896347046
Epoch: 16, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.747 Vali Acc: 0.806 Test Loss: 0.747 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 1.0955519676208496
Epoch: 17, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0146288871765137
Epoch: 18, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0903472900390625
Epoch: 19, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.668 Vali Acc: 0.811 Test Loss: 0.668 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.1060471534729004
Epoch: 20, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1376070976257324
Epoch: 21, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 1.07686185836792
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2211604118347168
Epoch: 23, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.573 Vali Acc: 0.811 Test Loss: 0.573 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0307157039642334
Epoch: 24, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 25 cost time: 1.1172683238983154
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 1.0380234718322754
Epoch: 26, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 0.9488263130187988
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.078549861907959
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1129150390625
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0120539665222168
Epoch: 30, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.1287553310394287
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1941163539886475
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1638967990875244
Epoch: 33, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.509 Vali Acc: 0.839 Test Loss: 0.509 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0957989692687988
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1610281467437744
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1070947647094727
Epoch: 36, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1926469802856445
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2465603351593018
Epoch: 38, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 1.093834638595581
Epoch: 39, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.071631908416748
Epoch: 40, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1228053569793701
Epoch: 41, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0722742080688477
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1154065132141113
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2048766613006592
Epoch: 44, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1110498905181885
Epoch: 45, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1368989944458008
Epoch: 46, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0727617740631104
Epoch: 47, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 48 cost time: 1.0259740352630615
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1247875690460205
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1083838939666748
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.279416561126709
Epoch: 51, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9610564708709717
Epoch: 52, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1447725296020508
Epoch: 53, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1501364707946777
Epoch: 54, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0290095806121826
Epoch: 55, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0061159133911133
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9578783512115479
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 61031
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5572850704193115
Epoch: 1, Steps: 12 | Train Loss: 2.918 Vali Loss: 2.794 Vali Acc: 0.139 Test Loss: 2.794 Test Acc: 0.139
Validation loss decreased (inf --> -0.138861).  Saving model ...
Epoch: 2 cost time: 1.200498342514038
Epoch: 2, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.564 Vali Acc: 0.222 Test Loss: 2.564 Test Acc: 0.222
Validation loss decreased (-0.138861 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.0496344566345215
Epoch: 3, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.304 Vali Acc: 0.317 Test Loss: 2.304 Test Acc: 0.317
Validation loss decreased (-0.222197 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 1.1867005825042725
Epoch: 4, Steps: 12 | Train Loss: 2.166 Vali Loss: 2.047 Vali Acc: 0.439 Test Loss: 2.047 Test Acc: 0.439
Validation loss decreased (-0.316644 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.1683099269866943
Epoch: 5, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.809 Vali Acc: 0.600 Test Loss: 1.809 Test Acc: 0.600
Validation loss decreased (-0.438868 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 1.070805549621582
Epoch: 6, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.623 Vali Acc: 0.600 Test Loss: 1.623 Test Acc: 0.600
Validation loss decreased (-0.599982 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 1.085416555404663
Epoch: 7, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.467 Vali Acc: 0.644 Test Loss: 1.467 Test Acc: 0.644
Validation loss decreased (-0.599984 --> -0.644430).  Saving model ...
Epoch: 8 cost time: 1.0602483749389648
Epoch: 8, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.342 Vali Acc: 0.678 Test Loss: 1.342 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 1.0638327598571777
Epoch: 9, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.233 Vali Acc: 0.694 Test Loss: 1.233 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694432).  Saving model ...
Epoch: 10 cost time: 0.9891061782836914
Epoch: 10, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.157 Vali Acc: 0.717 Test Loss: 1.157 Test Acc: 0.717
Validation loss decreased (-0.694432 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.1449711322784424
Epoch: 11, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.080 Vali Acc: 0.733 Test Loss: 1.080 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 1.2483572959899902
Epoch: 12, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1645028591156006
Epoch: 13, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 1.2014501094818115
Epoch: 14, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.918 Vali Acc: 0.761 Test Loss: 0.918 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0673840045928955
Epoch: 15, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.873 Vali Acc: 0.794 Test Loss: 0.873 Test Acc: 0.794
Validation loss decreased (-0.766657 --> -0.794436).  Saving model ...
Epoch: 16 cost time: 1.194904088973999
Epoch: 16, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.828 Vali Acc: 0.806 Test Loss: 0.828 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 1.1874947547912598
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.142409086227417
Epoch: 18, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.1661524772644043
Epoch: 19, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1588361263275146
Epoch: 20, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.115987777709961
Epoch: 21, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.724 Vali Acc: 0.811 Test Loss: 0.724 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.3011415004730225
Epoch: 22, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 1.1455237865447998
Epoch: 23, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.0966014862060547
Epoch: 24, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1530373096466064
Epoch: 25, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 1.1652367115020752
Epoch: 26, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 1.0874478816986084
Epoch: 27, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1877765655517578
Epoch: 28, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 1.170548915863037
Epoch: 29, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.0874195098876953
Epoch: 30, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.085916519165039
Epoch: 31, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.087764024734497
Epoch: 32, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.0585744380950928
Epoch: 33, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2849276065826416
Epoch: 34, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3346407413482666
Epoch: 35, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0974581241607666
Epoch: 36, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0192883014678955
Epoch: 37, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1323010921478271
Epoch: 38, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.993403434753418
Epoch: 39, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2279555797576904
Epoch: 40, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2321267127990723
Epoch: 41, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1579406261444092
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 155463
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.038949489593506
Epoch: 1, Steps: 12 | Train Loss: 2.926 Vali Loss: 2.817 Vali Acc: 0.122 Test Loss: 2.817 Test Acc: 0.122
Validation loss decreased (inf --> -0.122194).  Saving model ...
Epoch: 2 cost time: 0.9578855037689209
Epoch: 2, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.585 Vali Acc: 0.217 Test Loss: 2.585 Test Acc: 0.217
Validation loss decreased (-0.122194 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 1.0286052227020264
Epoch: 3, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.321 Vali Acc: 0.317 Test Loss: 2.321 Test Acc: 0.317
Validation loss decreased (-0.216641 --> -0.316643).  Saving model ...
Epoch: 4 cost time: 1.0016083717346191
Epoch: 4, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.060 Vali Acc: 0.417 Test Loss: 2.060 Test Acc: 0.417
Validation loss decreased (-0.316643 --> -0.416646).  Saving model ...
Epoch: 5 cost time: 1.0235085487365723
Epoch: 5, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.818 Vali Acc: 0.539 Test Loss: 1.818 Test Acc: 0.539
Validation loss decreased (-0.416646 --> -0.538871).  Saving model ...
Epoch: 6 cost time: 1.0046193599700928
Epoch: 6, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.628 Vali Acc: 0.583 Test Loss: 1.628 Test Acc: 0.583
Validation loss decreased (-0.538871 --> -0.583317).  Saving model ...
Epoch: 7 cost time: 0.9320433139801025
Epoch: 7, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.471 Vali Acc: 0.661 Test Loss: 1.471 Test Acc: 0.661
Validation loss decreased (-0.583317 --> -0.661096).  Saving model ...
Epoch: 8 cost time: 0.9834022521972656
Epoch: 8, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.345 Vali Acc: 0.689 Test Loss: 1.345 Test Acc: 0.689
Validation loss decreased (-0.661096 --> -0.688875).  Saving model ...
Epoch: 9 cost time: 1.064039707183838
Epoch: 9, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (-0.688875 --> -0.694432).  Saving model ...
Epoch: 10 cost time: 1.0165183544158936
Epoch: 10, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.161 Vali Acc: 0.717 Test Loss: 1.161 Test Acc: 0.717
Validation loss decreased (-0.694432 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 0.9385871887207031
Epoch: 11, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.085 Vali Acc: 0.728 Test Loss: 1.085 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 0.8659894466400146
Epoch: 12, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.9882147312164307
Epoch: 13, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.947 Vali Acc: 0.761 Test Loss: 0.947 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 0.9272181987762451
Epoch: 14, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.921 Vali Acc: 0.756 Test Loss: 0.921 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9745407104492188
Epoch: 15, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.877 Vali Acc: 0.789 Test Loss: 0.877 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.1142630577087402
Epoch: 16, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.0024309158325195
Epoch: 17, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 1.028285264968872
Epoch: 18, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.768 Vali Acc: 0.817 Test Loss: 0.768 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.0179548263549805
Epoch: 19, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0246875286102295
Epoch: 20, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.752 Vali Acc: 0.806 Test Loss: 0.752 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0047283172607422
Epoch: 21, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 22 cost time: 1.0048089027404785
Epoch: 22, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9679234027862549
Epoch: 23, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.0326955318450928
Epoch: 24, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1504697799682617
Epoch: 25, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 0.9351487159729004
Epoch: 26, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.9485032558441162
Epoch: 27, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.0086781978607178
Epoch: 28, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 1.0295307636260986
Epoch: 29, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.9543905258178711
Epoch: 30, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0135719776153564
Epoch: 31, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0002331733703613
Epoch: 32, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 0.9776425361633301
Epoch: 33, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0359361171722412
Epoch: 34, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9206316471099854
Epoch: 35, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 1.0142085552215576
Epoch: 36, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9921014308929443
Epoch: 37, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.9542694091796875
Epoch: 38, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0048809051513672
Epoch: 39, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 40 cost time: 1.0549945831298828
Epoch: 40, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8473379611968994
Epoch: 41, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9572501182556152
Epoch: 42, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9258801937103271
Epoch: 43, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.04018235206604
Epoch: 44, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1237056255340576
Epoch: 45, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9663801193237305
Epoch: 46, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 47 cost time: 1.0615382194519043
Epoch: 47, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.558 Vali Acc: 0.883 Test Loss: 0.558 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 48 cost time: 1.0843391418457031
Epoch: 48, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9988596439361572
Epoch: 49, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9972584247589111
Epoch: 50, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.055753469467163
Epoch: 51, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9849643707275391
Epoch: 52, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0307691097259521
Epoch: 53, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9921839237213135
Epoch: 54, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9857304096221924
Epoch: 55, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1172120571136475
Epoch: 56, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0503456592559814
Epoch: 57, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 155463
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1919751167297363
Epoch: 1, Steps: 12 | Train Loss: 2.928 Vali Loss: 2.839 Vali Acc: 0.094 Test Loss: 2.839 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 0.9924066066741943
Epoch: 2, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.608 Vali Acc: 0.194 Test Loss: 2.608 Test Acc: 0.194
Validation loss decreased (-0.094416 --> -0.194418).  Saving model ...
Epoch: 3 cost time: 0.950861930847168
Epoch: 3, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.343 Vali Acc: 0.328 Test Loss: 2.343 Test Acc: 0.328
Validation loss decreased (-0.194418 --> -0.327754).  Saving model ...
Epoch: 4 cost time: 1.155275583267212
Epoch: 4, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.078 Vali Acc: 0.428 Test Loss: 2.078 Test Acc: 0.428
Validation loss decreased (-0.327754 --> -0.427757).  Saving model ...
Epoch: 5 cost time: 1.117117166519165
Epoch: 5, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.832 Vali Acc: 0.561 Test Loss: 1.832 Test Acc: 0.561
Validation loss decreased (-0.427757 --> -0.561093).  Saving model ...
Epoch: 6 cost time: 0.9036421775817871
Epoch: 6, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.637 Vali Acc: 0.622 Test Loss: 1.637 Test Acc: 0.622
Validation loss decreased (-0.561093 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 1.0304710865020752
Epoch: 7, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.476 Vali Acc: 0.650 Test Loss: 1.476 Test Acc: 0.650
Validation loss decreased (-0.622206 --> -0.649985).  Saving model ...
Epoch: 8 cost time: 0.9715890884399414
Epoch: 8, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.348 Vali Acc: 0.661 Test Loss: 1.348 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661098).  Saving model ...
Epoch: 9 cost time: 0.9953141212463379
Epoch: 9, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.237 Vali Acc: 0.700 Test Loss: 1.237 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.047757863998413
Epoch: 10, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.156 Vali Acc: 0.711 Test Loss: 1.156 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.0166747570037842
Epoch: 11, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.081 Vali Acc: 0.728 Test Loss: 1.081 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.0716633796691895
Epoch: 12, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.012 Vali Acc: 0.728 Test Loss: 1.012 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 1.0323972702026367
Epoch: 13, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.0091240406036377
Epoch: 14, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.916 Vali Acc: 0.767 Test Loss: 0.916 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 1.0661609172821045
Epoch: 15, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.872 Vali Acc: 0.772 Test Loss: 0.872 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 0.9078900814056396
Epoch: 16, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.825 Vali Acc: 0.789 Test Loss: 0.825 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 0.8691327571868896
Epoch: 17, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.0350520610809326
Epoch: 18, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.757 Vali Acc: 0.817 Test Loss: 0.757 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.2143936157226562
Epoch: 19, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.743 Vali Acc: 0.806 Test Loss: 0.743 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1248817443847656
Epoch: 20, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.736 Vali Acc: 0.794 Test Loss: 0.736 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2353498935699463
Epoch: 21, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0891156196594238
Epoch: 22, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 1.1978120803833008
Epoch: 23, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 1.1898527145385742
Epoch: 24, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.12520432472229
Epoch: 25, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 1.215916395187378
Epoch: 26, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 1.2049190998077393
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.178652048110962
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 1.2207133769989014
Epoch: 29, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1775641441345215
Epoch: 30, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2272851467132568
Epoch: 31, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 0.8931233882904053
Epoch: 32, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.1019561290740967
Epoch: 33, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0247077941894531
Epoch: 34, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.038374900817871
Epoch: 35, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0723869800567627
Epoch: 36, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 1.1187505722045898
Epoch: 37, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1601777076721191
Epoch: 38, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1821837425231934
Epoch: 39, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1187493801116943
Epoch: 40, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1449432373046875
Epoch: 41, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1160259246826172
Epoch: 42, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 43 cost time: 0.9776301383972168
Epoch: 43, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0195050239562988
Epoch: 44, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9977555274963379
Epoch: 45, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.150982141494751
Epoch: 46, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 47 cost time: 1.0185596942901611
Epoch: 47, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0673878192901611
Epoch: 48, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.089813470840454
Epoch: 49, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9697928428649902
Epoch: 50, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.033050537109375
Epoch: 51, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 52 cost time: 1.1785738468170166
Epoch: 52, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0534336566925049
Epoch: 53, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0086517333984375
Epoch: 54, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9054172039031982
Epoch: 55, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1064660549163818
Epoch: 56, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1237540245056152
Epoch: 57, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.1536777019500732
Epoch: 58, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0790419578552246
Epoch: 59, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.004286527633667
Epoch: 60, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.130051851272583
Epoch: 61, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 155463
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1998867988586426
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.792 Vali Acc: 0.106 Test Loss: 2.792 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 1.0179483890533447
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.576 Vali Acc: 0.172 Test Loss: 2.576 Test Acc: 0.172
Validation loss decreased (-0.105528 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 1.0760834217071533
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.321 Vali Acc: 0.361 Test Loss: 2.321 Test Acc: 0.361
Validation loss decreased (-0.172196 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.0051636695861816
Epoch: 4, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.064 Vali Acc: 0.478 Test Loss: 2.064 Test Acc: 0.478
Validation loss decreased (-0.361088 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 0.9971792697906494
Epoch: 5, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.825 Vali Acc: 0.606 Test Loss: 1.825 Test Acc: 0.606
Validation loss decreased (-0.477757 --> -0.605537).  Saving model ...
Epoch: 6 cost time: 0.908440113067627
Epoch: 6, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.638 Vali Acc: 0.667 Test Loss: 1.638 Test Acc: 0.667
Validation loss decreased (-0.605537 --> -0.666650).  Saving model ...
Epoch: 7 cost time: 0.9400560855865479
Epoch: 7, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.482 Vali Acc: 0.672 Test Loss: 1.482 Test Acc: 0.672
Validation loss decreased (-0.666650 --> -0.672207).  Saving model ...
Epoch: 8 cost time: 1.076117753982544
Epoch: 8, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.360 Vali Acc: 0.678 Test Loss: 1.360 Test Acc: 0.678
Validation loss decreased (-0.672207 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 1.129633903503418
Epoch: 9, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.256 Vali Acc: 0.700 Test Loss: 1.256 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699987).  Saving model ...
Epoch: 10 cost time: 1.221147060394287
Epoch: 10, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.183 Vali Acc: 0.689 Test Loss: 1.183 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.061556339263916
Epoch: 11, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.121 Vali Acc: 0.689 Test Loss: 1.121 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8570361137390137
Epoch: 12, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.058 Vali Acc: 0.689 Test Loss: 1.058 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8431072235107422
Epoch: 13, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.997 Vali Acc: 0.728 Test Loss: 0.997 Test Acc: 0.728
Validation loss decreased (-0.699987 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 0.9876594543457031
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.966 Vali Acc: 0.711 Test Loss: 0.966 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1181089878082275
Epoch: 15, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.926 Vali Acc: 0.728 Test Loss: 0.926 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 16 cost time: 1.0907163619995117
Epoch: 16, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.891 Vali Acc: 0.744 Test Loss: 0.891 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.9767296314239502
Epoch: 17, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.9340410232543945
Epoch: 18, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8773350715637207
Epoch: 19, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9963257312774658
Epoch: 20, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 21 cost time: 0.9474568367004395
Epoch: 21, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.792 Vali Acc: 0.739 Test Loss: 0.792 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.249817132949829
Epoch: 22, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 1.0244567394256592
Epoch: 23, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0202491283416748
Epoch: 24, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0191283226013184
Epoch: 25, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9977493286132812
Epoch: 26, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 0.906278133392334
Epoch: 27, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0115702152252197
Epoch: 28, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.041987657546997
Epoch: 29, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 1.0444207191467285
Epoch: 30, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0067741870880127
Epoch: 31, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 32 cost time: 1.039289951324463
Epoch: 32, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.612 Vali Acc: 0.794 Test Loss: 0.612 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9810135364532471
Epoch: 33, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.635 Vali Acc: 0.806 Test Loss: 0.635 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 34 cost time: 0.9502718448638916
Epoch: 34, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0607924461364746
Epoch: 35, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.607 Vali Acc: 0.806 Test Loss: 0.607 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 36 cost time: 0.8725376129150391
Epoch: 36, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 37 cost time: 0.9469232559204102
Epoch: 37, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 38 cost time: 0.9109034538269043
Epoch: 38, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9460062980651855
Epoch: 39, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.577 Vali Acc: 0.817 Test Loss: 0.577 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 40 cost time: 0.9217548370361328
Epoch: 40, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 0.9383833408355713
Epoch: 41, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1941499710083008
Epoch: 42, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0861387252807617
Epoch: 43, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.558 Vali Acc: 0.817 Test Loss: 0.558 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2303619384765625
Epoch: 44, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.144629955291748
Epoch: 45, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 0.991694450378418
Epoch: 46, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 47 cost time: 1.1392178535461426
Epoch: 47, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 48 cost time: 1.1616873741149902
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1502325534820557
Epoch: 49, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1060030460357666
Epoch: 50, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 51 cost time: 1.15342378616333
Epoch: 51, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9250247478485107
Epoch: 52, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1403708457946777
Epoch: 53, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 54 cost time: 1.2471277713775635
Epoch: 54, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0739378929138184
Epoch: 55, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2862610816955566
Epoch: 56, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1797406673431396
Epoch: 57, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0873219966888428
Epoch: 58, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0650396347045898
Epoch: 59, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9574613571166992
Epoch: 60, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.0610692501068115
Epoch: 61, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.1349139213562012
Epoch: 62, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2067770957946777
Epoch: 63, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 155463
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5125234127044678
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.618 Vali Acc: 0.100 Test Loss: 2.618 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 1.1606495380401611
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.407 Vali Acc: 0.189 Test Loss: 2.407 Test Acc: 0.189
Validation loss decreased (-0.099974 --> -0.188865).  Saving model ...
Epoch: 3 cost time: 1.1462156772613525
Epoch: 3, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.169 Vali Acc: 0.367 Test Loss: 2.169 Test Acc: 0.367
Validation loss decreased (-0.188865 --> -0.366645).  Saving model ...
Epoch: 4 cost time: 1.1094460487365723
Epoch: 4, Steps: 12 | Train Loss: 2.127 Vali Loss: 1.936 Vali Acc: 0.450 Test Loss: 1.936 Test Acc: 0.450
Validation loss decreased (-0.366645 --> -0.449981).  Saving model ...
Epoch: 5 cost time: 1.0592584609985352
Epoch: 5, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.740 Vali Acc: 0.500 Test Loss: 1.740 Test Acc: 0.500
Validation loss decreased (-0.449981 --> -0.499983).  Saving model ...
Epoch: 6 cost time: 1.020033836364746
Epoch: 6, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.593 Vali Acc: 0.578 Test Loss: 1.593 Test Acc: 0.578
Validation loss decreased (-0.499983 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 1.0703108310699463
Epoch: 7, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.451 Vali Acc: 0.689 Test Loss: 1.451 Test Acc: 0.689
Validation loss decreased (-0.577762 --> -0.688874).  Saving model ...
Epoch: 8 cost time: 1.0858829021453857
Epoch: 8, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.341 Vali Acc: 0.700 Test Loss: 1.341 Test Acc: 0.700
Validation loss decreased (-0.688874 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.055335521697998
Epoch: 9, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.232 Vali Acc: 0.706 Test Loss: 1.232 Test Acc: 0.706
Validation loss decreased (-0.699987 --> -0.705543).  Saving model ...
Epoch: 10 cost time: 0.8674366474151611
Epoch: 10, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.149 Vali Acc: 0.711 Test Loss: 1.149 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.0137944221496582
Epoch: 11, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.078 Vali Acc: 0.711 Test Loss: 1.078 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 0.9172110557556152
Epoch: 12, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.005 Vali Acc: 0.717 Test Loss: 1.005 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.9043447971343994
Epoch: 13, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.0447618961334229
Epoch: 14, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 1.0590214729309082
Epoch: 15, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.755546 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.014578104019165
Epoch: 16, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.837 Vali Acc: 0.794 Test Loss: 0.837 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1374974250793457
Epoch: 17, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.814 Vali Acc: 0.811 Test Loss: 0.814 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.004166841506958
Epoch: 18, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.777 Vali Acc: 0.822 Test Loss: 0.777 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 0.8808317184448242
Epoch: 19, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 1.0213804244995117
Epoch: 20, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1079058647155762
Epoch: 21, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0613799095153809
Epoch: 22, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.687 Vali Acc: 0.839 Test Loss: 0.687 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.0904979705810547
Epoch: 23, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 1.0395514965057373
Epoch: 24, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.093973159790039
Epoch: 25, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0263392925262451
Epoch: 26, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.1098167896270752
Epoch: 27, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 0.9447047710418701
Epoch: 28, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.102717638015747
Epoch: 29, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.035184383392334
Epoch: 30, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.058114767074585
Epoch: 31, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9037997722625732
Epoch: 32, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.0622961521148682
Epoch: 33, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9673688411712646
Epoch: 34, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9247183799743652
Epoch: 35, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8481557369232178
Epoch: 36, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 0.9425430297851562
Epoch: 37, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9137821197509766
Epoch: 38, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9293580055236816
Epoch: 39, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0342068672180176
Epoch: 40, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0837960243225098
Epoch: 41, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0851502418518066
Epoch: 42, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.059276819229126
Epoch: 43, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.078948736190796
Epoch: 44, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.099381923675537
Epoch: 45, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1833207607269287
Epoch: 46, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 89927
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0506742000579834
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.625 Vali Acc: 0.094 Test Loss: 2.625 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.116957426071167
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.413 Vali Acc: 0.200 Test Loss: 2.413 Test Acc: 0.200
Validation loss decreased (-0.094418 --> -0.199976).  Saving model ...
Epoch: 3 cost time: 1.1300339698791504
Epoch: 3, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.174 Vali Acc: 0.333 Test Loss: 2.174 Test Acc: 0.333
Validation loss decreased (-0.199976 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 1.0923407077789307
Epoch: 4, Steps: 12 | Train Loss: 2.132 Vali Loss: 1.939 Vali Acc: 0.467 Test Loss: 1.939 Test Acc: 0.467
Validation loss decreased (-0.333312 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 1.2190883159637451
Epoch: 5, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.741 Vali Acc: 0.511 Test Loss: 1.741 Test Acc: 0.511
Validation loss decreased (-0.466647 --> -0.511094).  Saving model ...
Epoch: 6 cost time: 1.099167823791504
Epoch: 6, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.592 Vali Acc: 0.567 Test Loss: 1.592 Test Acc: 0.567
Validation loss decreased (-0.511094 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 1.0021302700042725
Epoch: 7, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.449 Vali Acc: 0.683 Test Loss: 1.449 Test Acc: 0.683
Validation loss decreased (-0.566651 --> -0.683319).  Saving model ...
Epoch: 8 cost time: 1.1267266273498535
Epoch: 8, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.338 Vali Acc: 0.706 Test Loss: 1.338 Test Acc: 0.706
Validation loss decreased (-0.683319 --> -0.705542).  Saving model ...
Epoch: 9 cost time: 1.1611297130584717
Epoch: 9, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.231 Vali Acc: 0.711 Test Loss: 1.231 Test Acc: 0.711
Validation loss decreased (-0.705542 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.3140678405761719
Epoch: 10, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.148 Vali Acc: 0.711 Test Loss: 1.148 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.1652915477752686
Epoch: 11, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.078 Vali Acc: 0.728 Test Loss: 1.078 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.1706640720367432
Epoch: 12, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.2270405292510986
Epoch: 13, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.955 Vali Acc: 0.744 Test Loss: 0.955 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1083934307098389
Epoch: 14, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.914 Vali Acc: 0.761 Test Loss: 0.914 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 1.0936360359191895
Epoch: 15, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.027515172958374
Epoch: 16, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.842 Vali Acc: 0.811 Test Loss: 0.842 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 1.22615647315979
Epoch: 17, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1983857154846191
Epoch: 18, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 1.13283109664917
Epoch: 19, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.763 Vali Acc: 0.828 Test Loss: 0.763 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 20 cost time: 1.028064250946045
Epoch: 20, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.741 Vali Acc: 0.817 Test Loss: 0.741 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.015075922012329
Epoch: 21, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.121717929840088
Epoch: 22, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.004408359527588
Epoch: 23, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.677 Vali Acc: 0.839 Test Loss: 0.677 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 0.8921616077423096
Epoch: 24, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.892146110534668
Epoch: 25, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9155538082122803
Epoch: 26, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.8943638801574707
Epoch: 27, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 1.0138826370239258
Epoch: 28, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0686192512512207
Epoch: 29, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.9978079795837402
Epoch: 30, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0492885112762451
Epoch: 31, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.9974396228790283
Epoch: 32, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1066408157348633
Epoch: 33, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.1452617645263672
Epoch: 34, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.181168556213379
Epoch: 35, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 1.1500182151794434
Epoch: 36, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.0477356910705566
Epoch: 37, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2330281734466553
Epoch: 38, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2037229537963867
Epoch: 39, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9858391284942627
Epoch: 40, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1375012397766113
Epoch: 41, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1002519130706787
Epoch: 42, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 43 cost time: 1.1145906448364258
Epoch: 43, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0632309913635254
Epoch: 44, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.086794137954712
Epoch: 45, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.064183235168457
Epoch: 46, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9941980838775635
Epoch: 47, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0361666679382324
Epoch: 48, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.997882604598999
Epoch: 49, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9990253448486328
Epoch: 50, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9749600887298584
Epoch: 51, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0245015621185303
Epoch: 52, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 89927
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.443267345428467
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.622 Vali Acc: 0.100 Test Loss: 2.622 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 0.8787376880645752
Epoch: 2, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.414 Vali Acc: 0.200 Test Loss: 2.414 Test Acc: 0.200
Validation loss decreased (-0.099974 --> -0.199976).  Saving model ...
Epoch: 3 cost time: 0.9534182548522949
Epoch: 3, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.176 Vali Acc: 0.356 Test Loss: 2.176 Test Acc: 0.356
Validation loss decreased (-0.199976 --> -0.355534).  Saving model ...
Epoch: 4 cost time: 0.8504152297973633
Epoch: 4, Steps: 12 | Train Loss: 2.126 Vali Loss: 1.939 Vali Acc: 0.428 Test Loss: 1.939 Test Acc: 0.428
Validation loss decreased (-0.355534 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 0.883509635925293
Epoch: 5, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.739 Vali Acc: 0.522 Test Loss: 1.739 Test Acc: 0.522
Validation loss decreased (-0.427758 --> -0.522205).  Saving model ...
Epoch: 6 cost time: 1.1036546230316162
Epoch: 6, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.589 Vali Acc: 0.578 Test Loss: 1.589 Test Acc: 0.578
Validation loss decreased (-0.522205 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 0.9326028823852539
Epoch: 7, Steps: 12 | Train Loss: 1.544 Vali Loss: 1.443 Vali Acc: 0.672 Test Loss: 1.443 Test Acc: 0.672
Validation loss decreased (-0.577762 --> -0.672208).  Saving model ...
Epoch: 8 cost time: 0.8991482257843018
Epoch: 8, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.330 Vali Acc: 0.694 Test Loss: 1.330 Test Acc: 0.694
Validation loss decreased (-0.672208 --> -0.694431).  Saving model ...
Epoch: 9 cost time: 0.9363725185394287
Epoch: 9, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.223 Vali Acc: 0.711 Test Loss: 1.223 Test Acc: 0.711
Validation loss decreased (-0.694431 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 0.8747589588165283
Epoch: 10, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.141 Vali Acc: 0.728 Test Loss: 1.141 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 0.8376693725585938
Epoch: 11, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.075 Vali Acc: 0.728 Test Loss: 1.075 Test Acc: 0.728
Validation loss decreased (-0.727766 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.0165598392486572
Epoch: 12, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.0660324096679688
Epoch: 13, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.953 Vali Acc: 0.744 Test Loss: 0.953 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0438785552978516
Epoch: 14, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.907 Vali Acc: 0.778 Test Loss: 0.907 Test Acc: 0.778
Validation loss decreased (-0.749990 --> -0.777769).  Saving model ...
Epoch: 15 cost time: 1.050072431564331
Epoch: 15, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.1637847423553467
Epoch: 16, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.834 Vali Acc: 0.794 Test Loss: 0.834 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 17 cost time: 1.1077766418457031
Epoch: 17, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.812 Vali Acc: 0.806 Test Loss: 0.812 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.1316864490509033
Epoch: 18, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.775 Vali Acc: 0.811 Test Loss: 0.775 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.1926770210266113
Epoch: 19, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.747 Vali Acc: 0.811 Test Loss: 0.747 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.0894274711608887
Epoch: 20, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.725 Vali Acc: 0.806 Test Loss: 0.725 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1114747524261475
Epoch: 21, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 1.096055269241333
Epoch: 22, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 1.1215112209320068
Epoch: 23, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9762599468231201
Epoch: 24, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9705734252929688
Epoch: 25, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9875640869140625
Epoch: 26, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.2080724239349365
Epoch: 27, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 1.0316920280456543
Epoch: 28, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0312201976776123
Epoch: 29, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0031495094299316
Epoch: 30, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.277214765548706
Epoch: 31, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.9241704940795898
Epoch: 32, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 0.9856710433959961
Epoch: 33, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.174708366394043
Epoch: 34, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.129119873046875
Epoch: 35, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.066805362701416
Epoch: 36, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 0.979888916015625
Epoch: 37, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1144657135009766
Epoch: 38, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0400543212890625
Epoch: 39, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9778060913085938
Epoch: 40, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1875882148742676
Epoch: 41, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1491339206695557
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1618006229400635
Epoch: 43, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0525059700012207
Epoch: 44, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 45 cost time: 1.0597591400146484
Epoch: 45, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1701037883758545
Epoch: 46, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1121788024902344
Epoch: 47, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0342273712158203
Epoch: 48, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 49 cost time: 1.0608785152435303
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0330870151519775
Epoch: 50, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.104607343673706
Epoch: 51, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9791691303253174
Epoch: 52, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2161245346069336
Epoch: 53, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0399882793426514
Epoch: 54, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8787024021148682
Epoch: 55, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9015190601348877
Epoch: 56, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.0848469734191895
Epoch: 57, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.1497373580932617
Epoch: 58, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 89927
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.272212266921997
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.619 Vali Acc: 0.094 Test Loss: 2.619 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.091317892074585
Epoch: 2, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.417 Vali Acc: 0.200 Test Loss: 2.417 Test Acc: 0.200
Validation loss decreased (-0.094418 --> -0.199976).  Saving model ...
Epoch: 3 cost time: 0.9991023540496826
Epoch: 3, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.188 Vali Acc: 0.406 Test Loss: 2.188 Test Acc: 0.406
Validation loss decreased (-0.199976 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 1.0718369483947754
Epoch: 4, Steps: 12 | Train Loss: 2.151 Vali Loss: 1.958 Vali Acc: 0.456 Test Loss: 1.958 Test Acc: 0.456
Validation loss decreased (-0.405534 --> -0.455536).  Saving model ...
Epoch: 5 cost time: 1.171726942062378
Epoch: 5, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.764 Vali Acc: 0.528 Test Loss: 1.764 Test Acc: 0.528
Validation loss decreased (-0.455536 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 0.9285774230957031
Epoch: 6, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.615 Vali Acc: 0.617 Test Loss: 1.615 Test Acc: 0.617
Validation loss decreased (-0.527760 --> -0.616651).  Saving model ...
Epoch: 7 cost time: 0.9745926856994629
Epoch: 7, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.473 Vali Acc: 0.667 Test Loss: 1.473 Test Acc: 0.667
Validation loss decreased (-0.616651 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 0.9640026092529297
Epoch: 8, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.369 Vali Acc: 0.672 Test Loss: 1.369 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 1.1694543361663818
Epoch: 9, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.268 Vali Acc: 0.683 Test Loss: 1.268 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.1724965572357178
Epoch: 10, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.190 Vali Acc: 0.689 Test Loss: 1.190 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 1.0244851112365723
Epoch: 11, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.127 Vali Acc: 0.689 Test Loss: 1.127 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 1.028383493423462
Epoch: 12, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.8410210609436035
Epoch: 13, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.005 Vali Acc: 0.706 Test Loss: 1.005 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705546).  Saving model ...
Epoch: 14 cost time: 1.0722301006317139
Epoch: 14, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 1.1133286952972412
Epoch: 15, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 0.9671318531036377
Epoch: 16, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.9073529243469238
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.876 Vali Acc: 0.761 Test Loss: 0.876 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 18 cost time: 0.9855215549468994
Epoch: 18, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.839 Vali Acc: 0.733 Test Loss: 0.839 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1407585144042969
Epoch: 19, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1812281608581543
Epoch: 20, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.784 Vali Acc: 0.767 Test Loss: 0.784 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766659).  Saving model ...
Epoch: 21 cost time: 1.054152011871338
Epoch: 21, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 1.1548597812652588
Epoch: 22, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1235356330871582
Epoch: 23, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 1.1562681198120117
Epoch: 24, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 1.1082029342651367
Epoch: 25, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0987284183502197
Epoch: 26, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 1.1964552402496338
Epoch: 27, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 28 cost time: 1.1699097156524658
Epoch: 28, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.649 Vali Acc: 0.806 Test Loss: 0.649 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0802946090698242
Epoch: 29, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 1.0222556591033936
Epoch: 30, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 1.209930181503296
Epoch: 31, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.590 Vali Acc: 0.811 Test Loss: 0.590 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.074570655822754
Epoch: 32, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 33 cost time: 1.0794577598571777
Epoch: 33, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1548981666564941
Epoch: 34, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.571 Vali Acc: 0.806 Test Loss: 0.571 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0229480266571045
Epoch: 35, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.577 Vali Acc: 0.806 Test Loss: 0.577 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0060255527496338
Epoch: 36, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.542 Vali Acc: 0.817 Test Loss: 0.542 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.240006446838379
Epoch: 37, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.554 Vali Acc: 0.817 Test Loss: 0.554 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2275748252868652
Epoch: 38, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827773).  Saving model ...
Epoch: 39 cost time: 1.2151217460632324
Epoch: 39, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.531 Vali Acc: 0.811 Test Loss: 0.531 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1836962699890137
Epoch: 40, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.2044861316680908
Epoch: 41, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.527 Vali Acc: 0.839 Test Loss: 0.527 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 42 cost time: 0.9896993637084961
Epoch: 42, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.518 Vali Acc: 0.839 Test Loss: 0.518 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 43 cost time: 1.027860164642334
Epoch: 43, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.532 Vali Acc: 0.811 Test Loss: 0.532 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.176530122756958
Epoch: 44, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 1.3204097747802734
Epoch: 45, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2492241859436035
Epoch: 46, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1391761302947998
Epoch: 47, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.240699052810669
Epoch: 48, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 1.0826044082641602
Epoch: 49, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2089893817901611
Epoch: 50, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2421643733978271
Epoch: 51, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1024656295776367
Epoch: 52, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866662).  Saving model ...
Epoch: 53 cost time: 1.178377628326416
Epoch: 53, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9867527484893799
Epoch: 54, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2071290016174316
Epoch: 55, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0854201316833496
Epoch: 56, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.1645102500915527
Epoch: 57, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2517704963684082
Epoch: 58, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2465291023254395
Epoch: 59, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3276968002319336
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3104801177978516
Epoch: 61, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.310530424118042
Epoch: 62, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 63 cost time: 1.2836887836456299
Epoch: 63, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3180313110351562
Epoch: 64, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2542681694030762
Epoch: 65, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.291346788406372
Epoch: 66, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.3889834880828857
Epoch: 67, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.2927465438842773
Epoch: 68, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.1967859268188477
Epoch: 69, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.1816487312316895
Epoch: 70, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.124274730682373
Epoch: 71, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.2000679969787598
Epoch: 72, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 89927
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.470860719680786
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.635 Vali Acc: 0.139 Test Loss: 2.635 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.2301416397094727
Epoch: 2, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.426 Vali Acc: 0.294 Test Loss: 2.426 Test Acc: 0.294
Validation loss decreased (-0.138863 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 1.0717980861663818
Epoch: 3, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.195 Vali Acc: 0.406 Test Loss: 2.195 Test Acc: 0.406
Validation loss decreased (-0.294420 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 1.120316505432129
Epoch: 4, Steps: 12 | Train Loss: 2.031 Vali Loss: 1.976 Vali Acc: 0.511 Test Loss: 1.976 Test Acc: 0.511
Validation loss decreased (-0.405534 --> -0.511091).  Saving model ...
Epoch: 5 cost time: 1.0781104564666748
Epoch: 5, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.772 Vali Acc: 0.544 Test Loss: 1.772 Test Acc: 0.544
Validation loss decreased (-0.511091 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 1.0813064575195312
Epoch: 6, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.608 Vali Acc: 0.639 Test Loss: 1.608 Test Acc: 0.639
Validation loss decreased (-0.544427 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 1.089841604232788
Epoch: 7, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.469 Vali Acc: 0.661 Test Loss: 1.469 Test Acc: 0.661
Validation loss decreased (-0.638873 --> -0.661096).  Saving model ...
Epoch: 8 cost time: 1.1077699661254883
Epoch: 8, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.350 Vali Acc: 0.656 Test Loss: 1.350 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0765380859375
Epoch: 9, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.253 Vali Acc: 0.683 Test Loss: 1.253 Test Acc: 0.683
Validation loss decreased (-0.661096 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.0823354721069336
Epoch: 10, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.179 Vali Acc: 0.706 Test Loss: 1.179 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 0.9680593013763428
Epoch: 11, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.102 Vali Acc: 0.728 Test Loss: 1.102 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.0239806175231934
Epoch: 12, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.041 Vali Acc: 0.728 Test Loss: 1.041 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 1.0851421356201172
Epoch: 13, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.280390977859497
Epoch: 14, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.949 Vali Acc: 0.728 Test Loss: 0.949 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 1.1817619800567627
Epoch: 15, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.902 Vali Acc: 0.789 Test Loss: 0.902 Test Acc: 0.789
Validation loss decreased (-0.727768 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.1429598331451416
Epoch: 16, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.847 Vali Acc: 0.811 Test Loss: 0.847 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 1.081758975982666
Epoch: 17, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.832 Vali Acc: 0.783 Test Loss: 0.832 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1861999034881592
Epoch: 18, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.794 Vali Acc: 0.817 Test Loss: 0.794 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.1370878219604492
Epoch: 19, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.773 Vali Acc: 0.817 Test Loss: 0.773 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.3081417083740234
Epoch: 20, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.2969088554382324
Epoch: 21, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3255293369293213
Epoch: 22, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.715 Vali Acc: 0.828 Test Loss: 0.715 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 1.0091652870178223
Epoch: 23, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 1.0902001857757568
Epoch: 24, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.687 Vali Acc: 0.839 Test Loss: 0.687 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0263035297393799
Epoch: 25, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 1.1058714389801025
Epoch: 26, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1585211753845215
Epoch: 27, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 1.002246618270874
Epoch: 28, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1095123291015625
Epoch: 29, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.3266468048095703
Epoch: 30, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.215453863143921
Epoch: 31, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2624337673187256
Epoch: 32, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 33 cost time: 1.0535471439361572
Epoch: 33, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9422295093536377
Epoch: 34, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.013908863067627
Epoch: 35, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.123504877090454
Epoch: 36, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0379679203033447
Epoch: 37, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.2118172645568848
Epoch: 38, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 1.1773149967193604
Epoch: 39, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1636497974395752
Epoch: 40, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0531542301177979
Epoch: 41, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0348217487335205
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0366771221160889
Epoch: 43, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1315646171569824
Epoch: 44, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.038799524307251
Epoch: 45, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9892206192016602
Epoch: 46, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.328678846359253
Epoch: 47, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2624316215515137
Epoch: 48, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 57159
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5148332118988037
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.652 Vali Acc: 0.106 Test Loss: 2.652 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9312515258789062
Epoch: 2, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.444 Vali Acc: 0.239 Test Loss: 2.444 Test Acc: 0.239
Validation loss decreased (-0.105529 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 0.9191739559173584
Epoch: 3, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.210 Vali Acc: 0.417 Test Loss: 2.210 Test Acc: 0.417
Validation loss decreased (-0.238864 --> -0.416645).  Saving model ...
Epoch: 4 cost time: 1.032905101776123
Epoch: 4, Steps: 12 | Train Loss: 2.031 Vali Loss: 1.988 Vali Acc: 0.506 Test Loss: 1.988 Test Acc: 0.506
Validation loss decreased (-0.416645 --> -0.505536).  Saving model ...
Epoch: 5 cost time: 1.1615676879882812
Epoch: 5, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.781 Vali Acc: 0.533 Test Loss: 1.781 Test Acc: 0.533
Validation loss decreased (-0.505536 --> -0.533316).  Saving model ...
Epoch: 6 cost time: 1.0440776348114014
Epoch: 6, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.613 Vali Acc: 0.633 Test Loss: 1.613 Test Acc: 0.633
Validation loss decreased (-0.533316 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 1.0585711002349854
Epoch: 7, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.471 Vali Acc: 0.667 Test Loss: 1.471 Test Acc: 0.667
Validation loss decreased (-0.633317 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.0905542373657227
Epoch: 8, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.350 Vali Acc: 0.689 Test Loss: 1.350 Test Acc: 0.689
Validation loss decreased (-0.666652 --> -0.688875).  Saving model ...
Epoch: 9 cost time: 1.0879769325256348
Epoch: 9, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.252 Vali Acc: 0.683 Test Loss: 1.252 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1006722450256348
Epoch: 10, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.176 Vali Acc: 0.706 Test Loss: 1.176 Test Acc: 0.706
Validation loss decreased (-0.688875 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 1.1146891117095947
Epoch: 11, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.100 Vali Acc: 0.739 Test Loss: 1.100 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738878).  Saving model ...
Epoch: 12 cost time: 1.0167336463928223
Epoch: 12, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.040 Vali Acc: 0.733 Test Loss: 1.040 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.007993459701538
Epoch: 13, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.988 Vali Acc: 0.744 Test Loss: 0.988 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 1.2096168994903564
Epoch: 14, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.949 Vali Acc: 0.744 Test Loss: 0.949 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.1045091152191162
Epoch: 15, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.904 Vali Acc: 0.778 Test Loss: 0.904 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.1127994060516357
Epoch: 16, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.851 Vali Acc: 0.806 Test Loss: 0.851 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 1.0953888893127441
Epoch: 17, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.836 Vali Acc: 0.806 Test Loss: 0.836 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.0042593479156494
Epoch: 18, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.798 Vali Acc: 0.822 Test Loss: 0.798 Test Acc: 0.822
Validation loss decreased (-0.805547 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 1.1262991428375244
Epoch: 19, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 1.0870389938354492
Epoch: 20, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.750 Vali Acc: 0.828 Test Loss: 0.750 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.047304630279541
Epoch: 21, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.722 Vali Acc: 0.817 Test Loss: 0.722 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0395746231079102
Epoch: 22, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.723 Vali Acc: 0.817 Test Loss: 0.723 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0671427249908447
Epoch: 23, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.0453112125396729
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 1.093625783920288
Epoch: 25, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 26 cost time: 1.039898157119751
Epoch: 26, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9877252578735352
Epoch: 27, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9970335960388184
Epoch: 28, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1171836853027344
Epoch: 29, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 1.0604147911071777
Epoch: 30, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.1297595500946045
Epoch: 31, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.2753307819366455
Epoch: 32, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.0076968669891357
Epoch: 33, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0496597290039062
Epoch: 34, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.187575101852417
Epoch: 35, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9997551441192627
Epoch: 36, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.932708740234375
Epoch: 37, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 0.9432108402252197
Epoch: 38, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 1.0789775848388672
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.96661376953125
Epoch: 40, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9299545288085938
Epoch: 41, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9679617881774902
Epoch: 42, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9670591354370117
Epoch: 43, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.027892827987671
Epoch: 44, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0290815830230713
Epoch: 45, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0865488052368164
Epoch: 46, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.104182243347168
Epoch: 47, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0561461448669434
Epoch: 48, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 57159
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.475721836090088
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.634 Vali Acc: 0.117 Test Loss: 2.634 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.1112580299377441
Epoch: 2, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.426 Vali Acc: 0.300 Test Loss: 2.426 Test Acc: 0.300
Validation loss decreased (-0.116640 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 1.043053388595581
Epoch: 3, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.192 Vali Acc: 0.433 Test Loss: 2.192 Test Acc: 0.433
Validation loss decreased (-0.299976 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 1.1201317310333252
Epoch: 4, Steps: 12 | Train Loss: 2.029 Vali Loss: 1.969 Vali Acc: 0.556 Test Loss: 1.969 Test Acc: 0.556
Validation loss decreased (-0.433311 --> -0.555536).  Saving model ...
Epoch: 5 cost time: 1.1050968170166016
Epoch: 5, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.760 Vali Acc: 0.572 Test Loss: 1.760 Test Acc: 0.572
Validation loss decreased (-0.555536 --> -0.572205).  Saving model ...
Epoch: 6 cost time: 0.9401438236236572
Epoch: 6, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.590 Vali Acc: 0.656 Test Loss: 1.590 Test Acc: 0.656
Validation loss decreased (-0.572205 --> -0.655540).  Saving model ...
Epoch: 7 cost time: 0.9126684665679932
Epoch: 7, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.447 Vali Acc: 0.694 Test Loss: 1.447 Test Acc: 0.694
Validation loss decreased (-0.655540 --> -0.694430).  Saving model ...
Epoch: 8 cost time: 0.9484751224517822
Epoch: 8, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.328 Vali Acc: 0.694 Test Loss: 1.328 Test Acc: 0.694
Validation loss decreased (-0.694430 --> -0.694431).  Saving model ...
Epoch: 9 cost time: 1.0283119678497314
Epoch: 9, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.230 Vali Acc: 0.706 Test Loss: 1.230 Test Acc: 0.706
Validation loss decreased (-0.694431 --> -0.705543).  Saving model ...
Epoch: 10 cost time: 1.0923924446105957
Epoch: 10, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.154 Vali Acc: 0.706 Test Loss: 1.154 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 0.9976348876953125
Epoch: 11, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.077 Vali Acc: 0.733 Test Loss: 1.077 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 1.2244069576263428
Epoch: 12, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.015 Vali Acc: 0.739 Test Loss: 1.015 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.2013030052185059
Epoch: 13, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.959 Vali Acc: 0.744 Test Loss: 0.959 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 1.1111266613006592
Epoch: 14, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.1650559902191162
Epoch: 15, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.875 Vali Acc: 0.789 Test Loss: 0.875 Test Acc: 0.789
Validation loss decreased (-0.749991 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.0331215858459473
Epoch: 16, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0857982635498047
Epoch: 17, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.0528059005737305
Epoch: 18, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.768 Vali Acc: 0.806 Test Loss: 0.768 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.0478582382202148
Epoch: 19, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0644197463989258
Epoch: 20, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 1.231560230255127
Epoch: 21, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.084639549255371
Epoch: 22, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.686 Vali Acc: 0.817 Test Loss: 0.686 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.0532054901123047
Epoch: 23, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 0.9300849437713623
Epoch: 24, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.23991060256958
Epoch: 25, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.1087944507598877
Epoch: 26, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 1.0359773635864258
Epoch: 27, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0652263164520264
Epoch: 28, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 0.9905221462249756
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.0680534839630127
Epoch: 30, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 0.8613169193267822
Epoch: 31, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1450786590576172
Epoch: 32, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.0789034366607666
Epoch: 33, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.02390718460083
Epoch: 34, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 35 cost time: 1.0800812244415283
Epoch: 35, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0812628269195557
Epoch: 36, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 0.9544651508331299
Epoch: 37, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 38 cost time: 1.1264255046844482
Epoch: 38, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 39 cost time: 1.0381584167480469
Epoch: 39, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.116260290145874
Epoch: 40, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1923458576202393
Epoch: 41, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9510042667388916
Epoch: 42, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9809474945068359
Epoch: 43, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0272154808044434
Epoch: 44, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.139878511428833
Epoch: 45, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.123225212097168
Epoch: 46, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2091128826141357
Epoch: 47, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.219597578048706
Epoch: 48, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 57159
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3807098865509033
Epoch: 1, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.609 Vali Acc: 0.139 Test Loss: 2.609 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.0559327602386475
Epoch: 2, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.412 Vali Acc: 0.289 Test Loss: 2.412 Test Acc: 0.289
Validation loss decreased (-0.138863 --> -0.288865).  Saving model ...
Epoch: 3 cost time: 0.9823329448699951
Epoch: 3, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.189 Vali Acc: 0.467 Test Loss: 2.189 Test Acc: 0.467
Validation loss decreased (-0.288865 --> -0.466645).  Saving model ...
Epoch: 4 cost time: 1.0806317329406738
Epoch: 4, Steps: 12 | Train Loss: 2.028 Vali Loss: 1.975 Vali Acc: 0.533 Test Loss: 1.975 Test Acc: 0.533
Validation loss decreased (-0.466645 --> -0.533314).  Saving model ...
Epoch: 5 cost time: 1.1005477905273438
Epoch: 5, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.773 Vali Acc: 0.556 Test Loss: 1.773 Test Acc: 0.556
Validation loss decreased (-0.533314 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 0.9903302192687988
Epoch: 6, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.609 Vali Acc: 0.622 Test Loss: 1.609 Test Acc: 0.622
Validation loss decreased (-0.555538 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 0.9443185329437256
Epoch: 7, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.474 Vali Acc: 0.661 Test Loss: 1.474 Test Acc: 0.661
Validation loss decreased (-0.622206 --> -0.661096).  Saving model ...
Epoch: 8 cost time: 0.9723799228668213
Epoch: 8, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.361 Vali Acc: 0.650 Test Loss: 1.361 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9032282829284668
Epoch: 9, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.269 Vali Acc: 0.644 Test Loss: 1.269 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9186444282531738
Epoch: 10, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.198 Vali Acc: 0.650 Test Loss: 1.198 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8573169708251953
Epoch: 11, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.127 Vali Acc: 0.678 Test Loss: 1.127 Test Acc: 0.678
Validation loss decreased (-0.661096 --> -0.677767).  Saving model ...
Epoch: 12 cost time: 0.9351527690887451
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.069 Vali Acc: 0.683 Test Loss: 1.069 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 0.9035520553588867
Epoch: 13, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.019 Vali Acc: 0.717 Test Loss: 1.019 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716656).  Saving model ...
Epoch: 14 cost time: 0.930304765701294
Epoch: 14, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 1.0788488388061523
Epoch: 15, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.939 Vali Acc: 0.739 Test Loss: 0.939 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 1.1649351119995117
Epoch: 16, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.887 Vali Acc: 0.733 Test Loss: 0.887 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9986996650695801
Epoch: 17, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.866 Vali Acc: 0.739 Test Loss: 0.866 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 18 cost time: 1.018172025680542
Epoch: 18, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 1.0271849632263184
Epoch: 19, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.062978982925415
Epoch: 20, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.11210036277771
Epoch: 21, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.762 Vali Acc: 0.772 Test Loss: 0.762 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 1.0882821083068848
Epoch: 22, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.9107410907745361
Epoch: 23, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 0.993769645690918
Epoch: 24, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 0.9302544593811035
Epoch: 25, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 26 cost time: 0.9516932964324951
Epoch: 26, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816660).  Saving model ...
Epoch: 27 cost time: 1.0109786987304688
Epoch: 27, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0016021728515625
Epoch: 28, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.021080493927002
Epoch: 29, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.064182996749878
Epoch: 30, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.010871171951294
Epoch: 31, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9779977798461914
Epoch: 32, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0006201267242432
Epoch: 33, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.590 Vali Acc: 0.811 Test Loss: 0.590 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.93166184425354
Epoch: 34, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.564 Vali Acc: 0.806 Test Loss: 0.564 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0756070613861084
Epoch: 35, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.569 Vali Acc: 0.806 Test Loss: 0.569 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.037306308746338
Epoch: 36, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 57159
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1813836097717285
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.617 Vali Acc: 0.100 Test Loss: 2.617 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 1.1185965538024902
Epoch: 2, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.405 Vali Acc: 0.306 Test Loss: 2.405 Test Acc: 0.306
Validation loss decreased (-0.099974 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.9640755653381348
Epoch: 3, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.166 Vali Acc: 0.400 Test Loss: 2.166 Test Acc: 0.400
Validation loss decreased (-0.305532 --> -0.399978).  Saving model ...
Epoch: 4 cost time: 1.063122272491455
Epoch: 4, Steps: 12 | Train Loss: 2.100 Vali Loss: 1.929 Vali Acc: 0.444 Test Loss: 1.929 Test Acc: 0.444
Validation loss decreased (-0.399978 --> -0.444425).  Saving model ...
Epoch: 5 cost time: 1.0358622074127197
Epoch: 5, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.730 Vali Acc: 0.583 Test Loss: 1.730 Test Acc: 0.583
Validation loss decreased (-0.444425 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 1.0047883987426758
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.557 Vali Acc: 0.672 Test Loss: 1.557 Test Acc: 0.672
Validation loss decreased (-0.583316 --> -0.672207).  Saving model ...
Epoch: 7 cost time: 1.0889167785644531
Epoch: 7, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.414 Vali Acc: 0.706 Test Loss: 1.414 Test Acc: 0.706
Validation loss decreased (-0.672207 --> -0.705541).  Saving model ...
Epoch: 8 cost time: 1.105891227722168
Epoch: 8, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.295 Vali Acc: 0.711 Test Loss: 1.295 Test Acc: 0.711
Validation loss decreased (-0.705541 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 0.9477150440216064
Epoch: 9, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.206 Vali Acc: 0.722 Test Loss: 1.206 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722210).  Saving model ...
Epoch: 10 cost time: 1.106945514678955
Epoch: 10, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.122 Vali Acc: 0.733 Test Loss: 1.122 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.0818212032318115
Epoch: 11, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.064 Vali Acc: 0.722 Test Loss: 1.064 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.036757469177246
Epoch: 12, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.999 Vali Acc: 0.756 Test Loss: 0.999 Test Acc: 0.756
Validation loss decreased (-0.733322 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 1.1333417892456055
Epoch: 13, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0196716785430908
Epoch: 14, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.896 Vali Acc: 0.750 Test Loss: 0.896 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9748387336730957
Epoch: 15, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.843 Vali Acc: 0.789 Test Loss: 0.843 Test Acc: 0.789
Validation loss decreased (-0.755546 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.0123863220214844
Epoch: 16, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.845 Vali Acc: 0.789 Test Loss: 0.845 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8923835754394531
Epoch: 17, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.806 Vali Acc: 0.806 Test Loss: 0.806 Test Acc: 0.806
Validation loss decreased (-0.788880 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 0.8724589347839355
Epoch: 18, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.783 Vali Acc: 0.811 Test Loss: 0.783 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 0.9061620235443115
Epoch: 19, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.074455976486206
Epoch: 20, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 1.088036298751831
Epoch: 21, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0453100204467773
Epoch: 22, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9066824913024902
Epoch: 23, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.0437030792236328
Epoch: 24, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.0077438354492188
Epoch: 25, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 1.0375611782073975
Epoch: 26, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.034191608428955
Epoch: 27, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.0937154293060303
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.8982186317443848
Epoch: 29, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.9399068355560303
Epoch: 30, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 31 cost time: 1.05018949508667
Epoch: 31, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1480712890625
Epoch: 32, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 1.0043513774871826
Epoch: 33, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0147781372070312
Epoch: 34, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0797715187072754
Epoch: 35, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1456375122070312
Epoch: 36, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.114250659942627
Epoch: 37, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1169443130493164
Epoch: 38, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9846594333648682
Epoch: 39, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.171813726425171
Epoch: 40, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9660615921020508
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0721843242645264
Epoch: 42, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 40775
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0665080547332764
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.644 Vali Acc: 0.089 Test Loss: 2.644 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0408518314361572
Epoch: 2, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.432 Vali Acc: 0.317 Test Loss: 2.432 Test Acc: 0.317
Validation loss decreased (-0.088862 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 0.9891676902770996
Epoch: 3, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.189 Vali Acc: 0.389 Test Loss: 2.189 Test Acc: 0.389
Validation loss decreased (-0.316642 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 1.2929143905639648
Epoch: 4, Steps: 12 | Train Loss: 2.105 Vali Loss: 1.950 Vali Acc: 0.439 Test Loss: 1.950 Test Acc: 0.439
Validation loss decreased (-0.388867 --> -0.438869).  Saving model ...
Epoch: 5 cost time: 1.1347122192382812
Epoch: 5, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.747 Vali Acc: 0.517 Test Loss: 1.747 Test Acc: 0.517
Validation loss decreased (-0.438869 --> -0.516649).  Saving model ...
Epoch: 6 cost time: 1.189314603805542
Epoch: 6, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.570 Vali Acc: 0.622 Test Loss: 1.570 Test Acc: 0.622
Validation loss decreased (-0.516649 --> -0.622207).  Saving model ...
Epoch: 7 cost time: 1.1171672344207764
Epoch: 7, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.427 Vali Acc: 0.656 Test Loss: 1.427 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 0.9777078628540039
Epoch: 8, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.308 Vali Acc: 0.683 Test Loss: 1.308 Test Acc: 0.683
Validation loss decreased (-0.655541 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 0.9595086574554443
Epoch: 9, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.218 Vali Acc: 0.711 Test Loss: 1.218 Test Acc: 0.711
Validation loss decreased (-0.683320 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 0.9791100025177002
Epoch: 10, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.136 Vali Acc: 0.728 Test Loss: 1.136 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 1.1265783309936523
Epoch: 11, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.076 Vali Acc: 0.728 Test Loss: 1.076 Test Acc: 0.728
Validation loss decreased (-0.727766 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.0500946044921875
Epoch: 12, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.012 Vali Acc: 0.756 Test Loss: 1.012 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 1.1621394157409668
Epoch: 13, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.955 Vali Acc: 0.728 Test Loss: 0.955 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.114070177078247
Epoch: 14, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.909 Vali Acc: 0.761 Test Loss: 0.909 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 1.0581252574920654
Epoch: 15, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.857 Vali Acc: 0.783 Test Loss: 0.857 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.042452096939087
Epoch: 16, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.857 Vali Acc: 0.789 Test Loss: 0.857 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 1.1725332736968994
Epoch: 17, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.818 Vali Acc: 0.811 Test Loss: 0.818 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.1158719062805176
Epoch: 18, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.798 Vali Acc: 0.817 Test Loss: 0.798 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 0.9686892032623291
Epoch: 19, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.763 Vali Acc: 0.794 Test Loss: 0.763 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0783801078796387
Epoch: 20, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.746 Vali Acc: 0.828 Test Loss: 0.746 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.1176164150238037
Epoch: 21, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2199280261993408
Epoch: 22, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.722 Vali Acc: 0.817 Test Loss: 0.722 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0964815616607666
Epoch: 23, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.688 Vali Acc: 0.833 Test Loss: 0.688 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 1.2083730697631836
Epoch: 24, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.1228652000427246
Epoch: 25, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 1.2330703735351562
Epoch: 26, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1807608604431152
Epoch: 27, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.0783960819244385
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.0119960308074951
Epoch: 29, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.0697460174560547
Epoch: 30, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.203092098236084
Epoch: 31, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 1.1337451934814453
Epoch: 32, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 1.1125144958496094
Epoch: 33, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 34 cost time: 1.2182652950286865
Epoch: 34, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1366777420043945
Epoch: 35, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2556116580963135
Epoch: 36, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1198573112487793
Epoch: 37, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9699647426605225
Epoch: 38, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.007298231124878
Epoch: 39, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0881381034851074
Epoch: 40, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9520320892333984
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9252314567565918
Epoch: 42, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1126759052276611
Epoch: 43, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 40775
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1686651706695557
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.668 Vali Acc: 0.083 Test Loss: 2.668 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.1575074195861816
Epoch: 2, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.455 Vali Acc: 0.322 Test Loss: 2.455 Test Acc: 0.322
Validation loss decreased (-0.083307 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 1.1889431476593018
Epoch: 3, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.210 Vali Acc: 0.372 Test Loss: 2.210 Test Acc: 0.372
Validation loss decreased (-0.322198 --> -0.372200).  Saving model ...
Epoch: 4 cost time: 1.1454036235809326
Epoch: 4, Steps: 12 | Train Loss: 2.123 Vali Loss: 1.965 Vali Acc: 0.456 Test Loss: 1.965 Test Acc: 0.456
Validation loss decreased (-0.372200 --> -0.455536).  Saving model ...
Epoch: 5 cost time: 0.9470870494842529
Epoch: 5, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.756 Vali Acc: 0.556 Test Loss: 1.756 Test Acc: 0.556
Validation loss decreased (-0.455536 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 1.0823698043823242
Epoch: 6, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.574 Vali Acc: 0.644 Test Loss: 1.574 Test Acc: 0.644
Validation loss decreased (-0.555538 --> -0.644429).  Saving model ...
Epoch: 7 cost time: 1.0019078254699707
Epoch: 7, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.426 Vali Acc: 0.689 Test Loss: 1.426 Test Acc: 0.689
Validation loss decreased (-0.644429 --> -0.688875).  Saving model ...
Epoch: 8 cost time: 1.062976598739624
Epoch: 8, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.305 Vali Acc: 0.700 Test Loss: 1.305 Test Acc: 0.700
Validation loss decreased (-0.688875 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.0525836944580078
Epoch: 9, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.216 Vali Acc: 0.717 Test Loss: 1.216 Test Acc: 0.717
Validation loss decreased (-0.699987 --> -0.716655).  Saving model ...
Epoch: 10 cost time: 0.9436948299407959
Epoch: 10, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.135 Vali Acc: 0.728 Test Loss: 1.135 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727766).  Saving model ...
Epoch: 11 cost time: 0.9506115913391113
Epoch: 11, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.076 Vali Acc: 0.733 Test Loss: 1.076 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 0.9978601932525635
Epoch: 12, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.1055912971496582
Epoch: 13, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.955 Vali Acc: 0.733 Test Loss: 0.955 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9838082790374756
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 0.9292042255401611
Epoch: 15, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.857 Vali Acc: 0.772 Test Loss: 0.857 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 1.1607475280761719
Epoch: 16, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.855 Vali Acc: 0.778 Test Loss: 0.855 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 1.1108403205871582
Epoch: 17, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.820 Vali Acc: 0.794 Test Loss: 0.820 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 1.0189812183380127
Epoch: 18, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0921497344970703
Epoch: 19, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9060733318328857
Epoch: 20, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 0.9380185604095459
Epoch: 21, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.729 Vali Acc: 0.817 Test Loss: 0.729 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 22 cost time: 0.9348902702331543
Epoch: 22, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0576422214508057
Epoch: 23, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 1.051243543624878
Epoch: 24, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 1.0999321937561035
Epoch: 25, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 1.1429400444030762
Epoch: 26, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.0632760524749756
Epoch: 27, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 28 cost time: 1.1752161979675293
Epoch: 28, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 0.9962234497070312
Epoch: 29, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.0839078426361084
Epoch: 30, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.0402445793151855
Epoch: 31, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 1.057572841644287
Epoch: 32, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 1.1401748657226562
Epoch: 33, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 1.0980608463287354
Epoch: 34, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1356995105743408
Epoch: 35, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 1.0390543937683105
Epoch: 36, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9791359901428223
Epoch: 37, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9512138366699219
Epoch: 38, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8504314422607422
Epoch: 39, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0735349655151367
Epoch: 40, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0787112712860107
Epoch: 41, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 42 cost time: 0.8952698707580566
Epoch: 42, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.034449577331543
Epoch: 43, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0563640594482422
Epoch: 44, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.085139274597168
Epoch: 45, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1590332984924316
Epoch: 46, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 47 cost time: 0.9325437545776367
Epoch: 47, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0027587413787842
Epoch: 48, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.043762445449829
Epoch: 49, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1400773525238037
Epoch: 50, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9433610439300537
Epoch: 51, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0038330554962158
Epoch: 52, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0873570442199707
Epoch: 53, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0436172485351562
Epoch: 54, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.138396978378296
Epoch: 55, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.2273750305175781
Epoch: 56, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 40775
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.916261672973633
Epoch: 1, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.712 Vali Acc: 0.050 Test Loss: 2.712 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.066479206085205
Epoch: 2, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.504 Vali Acc: 0.233 Test Loss: 2.504 Test Acc: 0.233
Validation loss decreased (-0.049973 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 1.136078119277954
Epoch: 3, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.262 Vali Acc: 0.372 Test Loss: 2.262 Test Acc: 0.372
Validation loss decreased (-0.233308 --> -0.372200).  Saving model ...
Epoch: 4 cost time: 0.9967050552368164
Epoch: 4, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.016 Vali Acc: 0.478 Test Loss: 2.016 Test Acc: 0.478
Validation loss decreased (-0.372200 --> -0.477758).  Saving model ...
Epoch: 5 cost time: 0.9840672016143799
Epoch: 5, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.804 Vali Acc: 0.550 Test Loss: 1.804 Test Acc: 0.550
Validation loss decreased (-0.477758 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.0017802715301514
Epoch: 6, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.616 Vali Acc: 0.606 Test Loss: 1.616 Test Acc: 0.606
Validation loss decreased (-0.549982 --> -0.605539).  Saving model ...
Epoch: 7 cost time: 1.0608818531036377
Epoch: 7, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.464 Vali Acc: 0.633 Test Loss: 1.464 Test Acc: 0.633
Validation loss decreased (-0.605539 --> -0.633319).  Saving model ...
Epoch: 8 cost time: 1.0720007419586182
Epoch: 8, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.342 Vali Acc: 0.667 Test Loss: 1.342 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 1.0144858360290527
Epoch: 9, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.252 Vali Acc: 0.694 Test Loss: 1.252 Test Acc: 0.694
Validation loss decreased (-0.666653 --> -0.694432).  Saving model ...
Epoch: 10 cost time: 1.1071350574493408
Epoch: 10, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 1.01334547996521
Epoch: 11, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.9593467712402344
Epoch: 12, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.056 Vali Acc: 0.711 Test Loss: 1.056 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 1.0021522045135498
Epoch: 13, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9760725498199463
Epoch: 14, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 1.064021348953247
Epoch: 15, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.905 Vali Acc: 0.733 Test Loss: 0.905 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.1689999103546143
Epoch: 16, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1048297882080078
Epoch: 17, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 1.0371088981628418
Epoch: 18, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.852 Vali Acc: 0.767 Test Loss: 0.852 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766658).  Saving model ...
Epoch: 19 cost time: 1.041806697845459
Epoch: 19, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.817 Vali Acc: 0.756 Test Loss: 0.817 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0790212154388428
Epoch: 20, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.805 Vali Acc: 0.772 Test Loss: 0.805 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.9583344459533691
Epoch: 21, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9286231994628906
Epoch: 22, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9888365268707275
Epoch: 23, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 24 cost time: 0.859708309173584
Epoch: 24, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.8828065395355225
Epoch: 25, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0996918678283691
Epoch: 26, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9411578178405762
Epoch: 27, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0782039165496826
Epoch: 28, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.670 Vali Acc: 0.794 Test Loss: 0.670 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0782108306884766
Epoch: 29, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.641 Vali Acc: 0.794 Test Loss: 0.641 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9901576042175293
Epoch: 30, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.648 Vali Acc: 0.806 Test Loss: 0.648 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 31 cost time: 1.010385274887085
Epoch: 31, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.609 Vali Acc: 0.778 Test Loss: 0.609 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.203775405883789
Epoch: 32, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.606 Vali Acc: 0.794 Test Loss: 0.606 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.049011468887329
Epoch: 33, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0624525547027588
Epoch: 34, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1546425819396973
Epoch: 35, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.028214693069458
Epoch: 36, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1163511276245117
Epoch: 37, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1417083740234375
Epoch: 38, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 39 cost time: 0.8811600208282471
Epoch: 39, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0547657012939453
Epoch: 40, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.550 Vali Acc: 0.806 Test Loss: 0.550 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 41 cost time: 1.098649501800537
Epoch: 41, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0880789756774902
Epoch: 42, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 43 cost time: 0.9468698501586914
Epoch: 43, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 44 cost time: 1.1327195167541504
Epoch: 44, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.566 Vali Acc: 0.811 Test Loss: 0.566 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9617626667022705
Epoch: 45, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.539 Vali Acc: 0.806 Test Loss: 0.539 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0615239143371582
Epoch: 46, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827773).  Saving model ...
Epoch: 47 cost time: 1.1770076751708984
Epoch: 47, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.811 Test Loss: 0.538 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0213465690612793
Epoch: 48, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844439).  Saving model ...
Epoch: 49 cost time: 1.0639939308166504
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1209895610809326
Epoch: 50, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0426373481750488
Epoch: 51, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.527 Vali Acc: 0.806 Test Loss: 0.527 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0465879440307617
Epoch: 52, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1375374794006348
Epoch: 53, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 54 cost time: 1.0122442245483398
Epoch: 54, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9325428009033203
Epoch: 55, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 56 cost time: 1.0738990306854248
Epoch: 56, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9155879020690918
Epoch: 57, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9859921932220459
Epoch: 58, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.043419361114502
Epoch: 59, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8622925281524658
Epoch: 60, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0431885719299316
Epoch: 61, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1893627643585205
Epoch: 62, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.9897472858428955
Epoch: 63, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.839 Test Loss: 0.534 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0763790607452393
Epoch: 64, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.034461259841919
Epoch: 65, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 40775
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2502946853637695
Epoch: 1, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.723 Vali Acc: 0.094 Test Loss: 2.723 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.9853944778442383
Epoch: 2, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.511 Vali Acc: 0.156 Test Loss: 2.511 Test Acc: 0.156
Validation loss decreased (-0.094417 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 1.0338408946990967
Epoch: 3, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.251 Vali Acc: 0.272 Test Loss: 2.251 Test Acc: 0.272
Validation loss decreased (-0.155530 --> -0.272200).  Saving model ...
Epoch: 4 cost time: 1.0163898468017578
Epoch: 4, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.012 Vali Acc: 0.444 Test Loss: 2.012 Test Acc: 0.444
Validation loss decreased (-0.272200 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 0.9842042922973633
Epoch: 5, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.805 Vali Acc: 0.483 Test Loss: 1.805 Test Acc: 0.483
Validation loss decreased (-0.444424 --> -0.483315).  Saving model ...
Epoch: 6 cost time: 0.9893338680267334
Epoch: 6, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.628 Vali Acc: 0.572 Test Loss: 1.628 Test Acc: 0.572
Validation loss decreased (-0.483315 --> -0.572206).  Saving model ...
Epoch: 7 cost time: 0.965632438659668
Epoch: 7, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.478 Vali Acc: 0.683 Test Loss: 1.478 Test Acc: 0.683
Validation loss decreased (-0.572206 --> -0.683319).  Saving model ...
Epoch: 8 cost time: 0.9946987628936768
Epoch: 8, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.360 Vali Acc: 0.706 Test Loss: 1.360 Test Acc: 0.706
Validation loss decreased (-0.683319 --> -0.705542).  Saving model ...
Epoch: 9 cost time: 0.9651098251342773
Epoch: 9, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.247 Vali Acc: 0.711 Test Loss: 1.247 Test Acc: 0.711
Validation loss decreased (-0.705542 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.066422939300537
Epoch: 10, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.154 Vali Acc: 0.717 Test Loss: 1.154 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.0306503772735596
Epoch: 11, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.091 Vali Acc: 0.744 Test Loss: 1.091 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 0.8915975093841553
Epoch: 12, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744434).  Saving model ...
Epoch: 13 cost time: 1.0664212703704834
Epoch: 13, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.9890420436859131
Epoch: 14, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.928 Vali Acc: 0.772 Test Loss: 0.928 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 0.8267631530761719
Epoch: 15, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.879 Vali Acc: 0.783 Test Loss: 0.879 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 0.8462080955505371
Epoch: 16, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 1.0014317035675049
Epoch: 17, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.821 Vali Acc: 0.817 Test Loss: 0.821 Test Acc: 0.817
Validation loss decreased (-0.799991 --> -0.816658).  Saving model ...
Epoch: 18 cost time: 0.9575331211090088
Epoch: 18, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.787 Vali Acc: 0.828 Test Loss: 0.787 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 19 cost time: 1.0318779945373535
Epoch: 19, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.772 Vali Acc: 0.822 Test Loss: 0.772 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8793118000030518
Epoch: 20, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.740 Vali Acc: 0.822 Test Loss: 0.740 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9468631744384766
Epoch: 21, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0231084823608398
Epoch: 22, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0465755462646484
Epoch: 23, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0530891418457031
Epoch: 24, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.0869088172912598
Epoch: 25, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0523319244384766
Epoch: 26, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.064131498336792
Epoch: 27, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.0186750888824463
Epoch: 28, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 0.9626867771148682
Epoch: 29, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.9868853092193604
Epoch: 30, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.111762285232544
Epoch: 31, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.0741090774536133
Epoch: 32, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 0.9336755275726318
Epoch: 33, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9198184013366699
Epoch: 34, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9745612144470215
Epoch: 35, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0799083709716797
Epoch: 36, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.018082618713379
Epoch: 37, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0412673950195312
Epoch: 38, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2114012241363525
Epoch: 39, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2089407444000244
Epoch: 40, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2345139980316162
Epoch: 41, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1618969440460205
Epoch: 42, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 32583
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3843955993652344
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.728 Vali Acc: 0.100 Test Loss: 2.728 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.2647809982299805
Epoch: 2, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.517 Vali Acc: 0.144 Test Loss: 2.517 Test Acc: 0.144
Validation loss decreased (-0.099973 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 1.1841611862182617
Epoch: 3, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.258 Vali Acc: 0.272 Test Loss: 2.258 Test Acc: 0.272
Validation loss decreased (-0.144419 --> -0.272200).  Saving model ...
Epoch: 4 cost time: 1.2122743129730225
Epoch: 4, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.020 Vali Acc: 0.433 Test Loss: 2.020 Test Acc: 0.433
Validation loss decreased (-0.272200 --> -0.433313).  Saving model ...
Epoch: 5 cost time: 0.9979362487792969
Epoch: 5, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.811 Vali Acc: 0.478 Test Loss: 1.811 Test Acc: 0.478
Validation loss decreased (-0.433313 --> -0.477760).  Saving model ...
Epoch: 6 cost time: 0.9703311920166016
Epoch: 6, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.633 Vali Acc: 0.556 Test Loss: 1.633 Test Acc: 0.556
Validation loss decreased (-0.477760 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 0.9896378517150879
Epoch: 7, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.483 Vali Acc: 0.683 Test Loss: 1.483 Test Acc: 0.683
Validation loss decreased (-0.555539 --> -0.683319).  Saving model ...
Epoch: 8 cost time: 1.2178361415863037
Epoch: 8, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.367 Vali Acc: 0.678 Test Loss: 1.367 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3302910327911377
Epoch: 9, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.254 Vali Acc: 0.678 Test Loss: 1.254 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2074542045593262
Epoch: 10, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.162 Vali Acc: 0.717 Test Loss: 1.162 Test Acc: 0.717
Validation loss decreased (-0.683319 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.2437257766723633
Epoch: 11, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.101 Vali Acc: 0.739 Test Loss: 1.101 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738878).  Saving model ...
Epoch: 12 cost time: 1.0283632278442383
Epoch: 12, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.024 Vali Acc: 0.761 Test Loss: 1.024 Test Acc: 0.761
Validation loss decreased (-0.738878 --> -0.761101).  Saving model ...
Epoch: 13 cost time: 1.0217695236206055
Epoch: 13, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.985 Vali Acc: 0.756 Test Loss: 0.985 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1488559246063232
Epoch: 14, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.937 Vali Acc: 0.783 Test Loss: 0.937 Test Acc: 0.783
Validation loss decreased (-0.761101 --> -0.783324).  Saving model ...
Epoch: 15 cost time: 1.2097532749176025
Epoch: 15, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.1881098747253418
Epoch: 16, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.868 Vali Acc: 0.806 Test Loss: 0.868 Test Acc: 0.806
Validation loss decreased (-0.788880 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 0.9166746139526367
Epoch: 17, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.834 Vali Acc: 0.811 Test Loss: 0.834 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.067657709121704
Epoch: 18, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.802 Vali Acc: 0.817 Test Loss: 0.802 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.1681485176086426
Epoch: 19, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.787 Vali Acc: 0.817 Test Loss: 0.787 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.0707027912139893
Epoch: 20, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.752 Vali Acc: 0.828 Test Loss: 0.752 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 0.9766168594360352
Epoch: 21, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1853971481323242
Epoch: 22, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827770).  Saving model ...
Epoch: 23 cost time: 1.1267988681793213
Epoch: 23, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0691919326782227
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.1601626873016357
Epoch: 25, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.1499245166778564
Epoch: 26, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.1979129314422607
Epoch: 27, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0266118049621582
Epoch: 28, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.073503017425537
Epoch: 29, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 0.9900460243225098
Epoch: 30, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1275250911712646
Epoch: 31, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 1.3191757202148438
Epoch: 32, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 1.0990667343139648
Epoch: 33, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 34 cost time: 1.0846056938171387
Epoch: 34, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0890722274780273
Epoch: 35, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9937858581542969
Epoch: 36, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 37 cost time: 1.1025886535644531
Epoch: 37, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0565931797027588
Epoch: 38, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1396193504333496
Epoch: 39, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0713212490081787
Epoch: 40, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0659945011138916
Epoch: 41, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0757453441619873
Epoch: 42, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1500437259674072
Epoch: 43, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1347765922546387
Epoch: 44, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0866906642913818
Epoch: 45, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1300766468048096
Epoch: 46, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 32583
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1337742805480957
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.704 Vali Acc: 0.100 Test Loss: 2.704 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.152043104171753
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.498 Vali Acc: 0.156 Test Loss: 2.498 Test Acc: 0.156
Validation loss decreased (-0.099973 --> -0.155531).  Saving model ...
Epoch: 3 cost time: 1.0248141288757324
Epoch: 3, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.243 Vali Acc: 0.289 Test Loss: 2.243 Test Acc: 0.289
Validation loss decreased (-0.155531 --> -0.288866).  Saving model ...
Epoch: 4 cost time: 1.1049904823303223
Epoch: 4, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.006 Vali Acc: 0.428 Test Loss: 2.006 Test Acc: 0.428
Validation loss decreased (-0.288866 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 0.921076774597168
Epoch: 5, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.798 Vali Acc: 0.567 Test Loss: 1.798 Test Acc: 0.567
Validation loss decreased (-0.427758 --> -0.566649).  Saving model ...
Epoch: 6 cost time: 1.1689929962158203
Epoch: 6, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.623 Vali Acc: 0.578 Test Loss: 1.623 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 0.9349696636199951
Epoch: 7, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.474 Vali Acc: 0.694 Test Loss: 1.474 Test Acc: 0.694
Validation loss decreased (-0.577762 --> -0.694430).  Saving model ...
Epoch: 8 cost time: 1.0891368389129639
Epoch: 8, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.357 Vali Acc: 0.678 Test Loss: 1.357 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1580970287322998
Epoch: 9, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.246 Vali Acc: 0.700 Test Loss: 1.246 Test Acc: 0.700
Validation loss decreased (-0.694430 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.9851014614105225
Epoch: 10, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.153 Vali Acc: 0.711 Test Loss: 1.153 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.0723400115966797
Epoch: 11, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.093 Vali Acc: 0.728 Test Loss: 1.093 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.0497925281524658
Epoch: 12, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.017 Vali Acc: 0.756 Test Loss: 1.017 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 1.297276258468628
Epoch: 13, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.103576421737671
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.924 Vali Acc: 0.772 Test Loss: 0.924 Test Acc: 0.772
Validation loss decreased (-0.755545 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 1.2319724559783936
Epoch: 15, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.872 Vali Acc: 0.783 Test Loss: 0.872 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.0185635089874268
Epoch: 16, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.1083035469055176
Epoch: 17, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.815 Vali Acc: 0.806 Test Loss: 0.815 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.1357078552246094
Epoch: 18, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.780 Vali Acc: 0.811 Test Loss: 0.780 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.160595178604126
Epoch: 19, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.761 Vali Acc: 0.806 Test Loss: 0.761 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2298481464385986
Epoch: 20, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 1.1507456302642822
Epoch: 21, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.719 Vali Acc: 0.811 Test Loss: 0.719 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.2565040588378906
Epoch: 22, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.700 Vali Acc: 0.839 Test Loss: 0.700 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.150036334991455
Epoch: 23, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2629368305206299
Epoch: 24, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2926998138427734
Epoch: 25, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0131843090057373
Epoch: 26, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3255887031555176
Epoch: 27, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.1015172004699707
Epoch: 28, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.0147509574890137
Epoch: 29, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 1.2334074974060059
Epoch: 30, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.0980842113494873
Epoch: 31, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 1.3308780193328857
Epoch: 32, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.1457974910736084
Epoch: 33, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1692192554473877
Epoch: 34, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 35 cost time: 1.1405627727508545
Epoch: 35, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1243720054626465
Epoch: 36, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.1619961261749268
Epoch: 37, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.095231533050537
Epoch: 38, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0779972076416016
Epoch: 39, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.067988395690918
Epoch: 40, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.139955997467041
Epoch: 41, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9796092510223389
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0149750709533691
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0165388584136963
Epoch: 44, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1351051330566406
Epoch: 45, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1050267219543457
Epoch: 46, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 32583
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.873985528945923
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.686 Vali Acc: 0.100 Test Loss: 2.686 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.9524028301239014
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.489 Vali Acc: 0.167 Test Loss: 2.489 Test Acc: 0.167
Validation loss decreased (-0.099973 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 1.111452341079712
Epoch: 3, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.244 Vali Acc: 0.283 Test Loss: 2.244 Test Acc: 0.283
Validation loss decreased (-0.166642 --> -0.283311).  Saving model ...
Epoch: 4 cost time: 1.1301109790802002
Epoch: 4, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.015 Vali Acc: 0.372 Test Loss: 2.015 Test Acc: 0.372
Validation loss decreased (-0.283311 --> -0.372202).  Saving model ...
Epoch: 5 cost time: 0.9814457893371582
Epoch: 5, Steps: 12 | Train Loss: 1.916 Vali Loss: 1.811 Vali Acc: 0.489 Test Loss: 1.811 Test Acc: 0.489
Validation loss decreased (-0.372202 --> -0.488871).  Saving model ...
Epoch: 6 cost time: 1.0486812591552734
Epoch: 6, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.638 Vali Acc: 0.528 Test Loss: 1.638 Test Acc: 0.528
Validation loss decreased (-0.488871 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 0.9707803726196289
Epoch: 7, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.492 Vali Acc: 0.650 Test Loss: 1.492 Test Acc: 0.650
Validation loss decreased (-0.527761 --> -0.649985).  Saving model ...
Epoch: 8 cost time: 1.0137596130371094
Epoch: 8, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.378 Vali Acc: 0.656 Test Loss: 1.378 Test Acc: 0.656
Validation loss decreased (-0.649985 --> -0.655542).  Saving model ...
Epoch: 9 cost time: 1.1613054275512695
Epoch: 9, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.275 Vali Acc: 0.667 Test Loss: 1.275 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 10 cost time: 1.1082878112792969
Epoch: 10, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.190 Vali Acc: 0.689 Test Loss: 1.190 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 1.0271072387695312
Epoch: 11, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.131 Vali Acc: 0.694 Test Loss: 1.131 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 1.1310806274414062
Epoch: 12, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.055 Vali Acc: 0.689 Test Loss: 1.055 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1827712059020996
Epoch: 13, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.019 Vali Acc: 0.711 Test Loss: 1.019 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 1.0567479133605957
Epoch: 14, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 1.0925562381744385
Epoch: 15, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.926 Vali Acc: 0.711 Test Loss: 0.926 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.073279619216919
Epoch: 16, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.896 Vali Acc: 0.733 Test Loss: 0.896 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 1.1756956577301025
Epoch: 17, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.870 Vali Acc: 0.728 Test Loss: 0.870 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.091529130935669
Epoch: 18, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0280115604400635
Epoch: 19, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.830 Vali Acc: 0.761 Test Loss: 0.830 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 20 cost time: 1.1071577072143555
Epoch: 20, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1232953071594238
Epoch: 21, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0675079822540283
Epoch: 22, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.764 Vali Acc: 0.794 Test Loss: 0.764 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 1.157989263534546
Epoch: 23, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.742 Vali Acc: 0.767 Test Loss: 0.742 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0973401069641113
Epoch: 24, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1352481842041016
Epoch: 25, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 26 cost time: 1.019728183746338
Epoch: 26, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.672 Vali Acc: 0.794 Test Loss: 0.672 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 27 cost time: 1.192807674407959
Epoch: 27, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.682 Vali Acc: 0.794 Test Loss: 0.682 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1265358924865723
Epoch: 28, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0689082145690918
Epoch: 29, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 30 cost time: 0.9647700786590576
Epoch: 30, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.635 Vali Acc: 0.778 Test Loss: 0.635 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1247234344482422
Epoch: 31, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1085352897644043
Epoch: 32, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.626 Vali Acc: 0.789 Test Loss: 0.626 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0645864009857178
Epoch: 33, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0991864204406738
Epoch: 34, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 1.109806776046753
Epoch: 35, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0938141345977783
Epoch: 36, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.566 Vali Acc: 0.794 Test Loss: 0.566 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0235259532928467
Epoch: 37, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2190592288970947
Epoch: 38, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.561 Vali Acc: 0.794 Test Loss: 0.561 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.163590908050537
Epoch: 39, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 40 cost time: 1.2714104652404785
Epoch: 40, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.547 Vali Acc: 0.817 Test Loss: 0.547 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 41 cost time: 1.1811637878417969
Epoch: 41, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.1524155139923096
Epoch: 42, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9683568477630615
Epoch: 43, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.551 Vali Acc: 0.817 Test Loss: 0.551 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1141154766082764
Epoch: 44, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1639902591705322
Epoch: 45, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.3130686283111572
Epoch: 46, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1505532264709473
Epoch: 47, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1689655780792236
Epoch: 48, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1474311351776123
Epoch: 49, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 50 cost time: 1.1507973670959473
Epoch: 50, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2836291790008545
Epoch: 51, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 52 cost time: 1.074876070022583
Epoch: 52, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 53 cost time: 1.146549940109253
Epoch: 53, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0522561073303223
Epoch: 54, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 55 cost time: 0.9861183166503906
Epoch: 55, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0923116207122803
Epoch: 56, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1339752674102783
Epoch: 57, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1137018203735352
Epoch: 58, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1281816959381104
Epoch: 59, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.2106602191925049
Epoch: 60, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1582396030426025
Epoch: 61, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1825182437896729
Epoch: 62, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0427141189575195
Epoch: 63, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.2082338333129883
Epoch: 64, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 32583
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1030585765838623
Epoch: 1, Steps: 12 | Train Loss: 2.864 Vali Loss: 2.728 Vali Acc: 0.100 Test Loss: 2.728 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.0615432262420654
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.511 Vali Acc: 0.122 Test Loss: 2.511 Test Acc: 0.122
Validation loss decreased (-0.099973 --> -0.122197).  Saving model ...
Epoch: 3 cost time: 1.068094253540039
Epoch: 3, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.250 Vali Acc: 0.333 Test Loss: 2.250 Test Acc: 0.333
Validation loss decreased (-0.122197 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 0.9803643226623535
Epoch: 4, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.013 Vali Acc: 0.450 Test Loss: 2.013 Test Acc: 0.450
Validation loss decreased (-0.333311 --> -0.449980).  Saving model ...
Epoch: 5 cost time: 0.9950799942016602
Epoch: 5, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.793 Vali Acc: 0.550 Test Loss: 1.793 Test Acc: 0.550
Validation loss decreased (-0.449980 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.1445751190185547
Epoch: 6, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.603 Vali Acc: 0.650 Test Loss: 1.603 Test Acc: 0.650
Validation loss decreased (-0.549982 --> -0.649984).  Saving model ...
Epoch: 7 cost time: 1.1392781734466553
Epoch: 7, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.444 Vali Acc: 0.694 Test Loss: 1.444 Test Acc: 0.694
Validation loss decreased (-0.649984 --> -0.694430).  Saving model ...
Epoch: 8 cost time: 1.0058598518371582
Epoch: 8, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.328 Vali Acc: 0.694 Test Loss: 1.328 Test Acc: 0.694
Validation loss decreased (-0.694430 --> -0.694431).  Saving model ...
Epoch: 9 cost time: 1.1404550075531006
Epoch: 9, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.221 Vali Acc: 0.706 Test Loss: 1.221 Test Acc: 0.706
Validation loss decreased (-0.694431 --> -0.705543).  Saving model ...
Epoch: 10 cost time: 1.093430995941162
Epoch: 10, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.156 Vali Acc: 0.711 Test Loss: 1.156 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.149289608001709
Epoch: 11, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.094 Vali Acc: 0.744 Test Loss: 1.094 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744433).  Saving model ...
Epoch: 12 cost time: 1.2764737606048584
Epoch: 12, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.030 Vali Acc: 0.739 Test Loss: 1.030 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0327413082122803
Epoch: 13, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.050468921661377
Epoch: 14, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.929 Vali Acc: 0.761 Test Loss: 0.929 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 1.0287487506866455
Epoch: 15, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.888 Vali Acc: 0.767 Test Loss: 0.888 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 16 cost time: 1.1453790664672852
Epoch: 16, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.1783454418182373
Epoch: 17, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 1.1158242225646973
Epoch: 18, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.789 Vali Acc: 0.822 Test Loss: 0.789 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 1.075070858001709
Epoch: 19, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0800747871398926
Epoch: 20, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.742 Vali Acc: 0.828 Test Loss: 0.742 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.0444049835205078
Epoch: 21, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0567586421966553
Epoch: 22, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1448116302490234
Epoch: 23, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 0.970350980758667
Epoch: 24, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.1186718940734863
Epoch: 25, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.141357421875
Epoch: 26, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 1.1018316745758057
Epoch: 27, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 1.104752779006958
Epoch: 28, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0753328800201416
Epoch: 29, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 1.221362829208374
Epoch: 30, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.076279640197754
Epoch: 31, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.1887264251708984
Epoch: 32, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0705575942993164
Epoch: 33, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1110079288482666
Epoch: 34, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 35 cost time: 1.1310231685638428
Epoch: 35, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 1.1506400108337402
Epoch: 36, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1336004734039307
Epoch: 37, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.557 Vali Acc: 0.878 Test Loss: 0.557 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.1613242626190186
Epoch: 38, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.155604600906372
Epoch: 39, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.149068832397461
Epoch: 40, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2342016696929932
Epoch: 41, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1184864044189453
Epoch: 42, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1818842887878418
Epoch: 43, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.066476583480835
Epoch: 44, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1675658226013184
Epoch: 45, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1522443294525146
Epoch: 46, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.29195237159729
Epoch: 47, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 28487
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2093443870544434
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.711 Vali Acc: 0.094 Test Loss: 2.711 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.0151734352111816
Epoch: 2, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.495 Vali Acc: 0.128 Test Loss: 2.495 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127753).  Saving model ...
Epoch: 3 cost time: 0.9252884387969971
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.237 Vali Acc: 0.344 Test Loss: 2.237 Test Acc: 0.344
Validation loss decreased (-0.127753 --> -0.344422).  Saving model ...
Epoch: 4 cost time: 0.9697208404541016
Epoch: 4, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.000 Vali Acc: 0.489 Test Loss: 2.000 Test Acc: 0.489
Validation loss decreased (-0.344422 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 0.9823164939880371
Epoch: 5, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.779 Vali Acc: 0.583 Test Loss: 1.779 Test Acc: 0.583
Validation loss decreased (-0.488869 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 1.1489083766937256
Epoch: 6, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.589 Vali Acc: 0.656 Test Loss: 1.589 Test Acc: 0.656
Validation loss decreased (-0.583316 --> -0.655540).  Saving model ...
Epoch: 7 cost time: 1.216371774673462
Epoch: 7, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.431 Vali Acc: 0.706 Test Loss: 1.431 Test Acc: 0.706
Validation loss decreased (-0.655540 --> -0.705541).  Saving model ...
Epoch: 8 cost time: 1.0155901908874512
Epoch: 8, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.317 Vali Acc: 0.711 Test Loss: 1.317 Test Acc: 0.711
Validation loss decreased (-0.705541 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 1.0801804065704346
Epoch: 9, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.210 Vali Acc: 0.706 Test Loss: 1.210 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0475044250488281
Epoch: 10, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.145 Vali Acc: 0.717 Test Loss: 1.145 Test Acc: 0.717
Validation loss decreased (-0.711098 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.07045316696167
Epoch: 11, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.0943925380706787
Epoch: 12, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.0987060070037842
Epoch: 13, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.957 Vali Acc: 0.767 Test Loss: 0.957 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 1.1335985660552979
Epoch: 14, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.923 Vali Acc: 0.772 Test Loss: 0.923 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 1.077571153640747
Epoch: 15, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.881 Vali Acc: 0.778 Test Loss: 0.881 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 0.9995865821838379
Epoch: 16, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.829 Vali Acc: 0.806 Test Loss: 0.829 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 1.0729491710662842
Epoch: 17, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.812 Vali Acc: 0.817 Test Loss: 0.812 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816659).  Saving model ...
Epoch: 18 cost time: 1.0565907955169678
Epoch: 18, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.784 Vali Acc: 0.817 Test Loss: 0.784 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.107107400894165
Epoch: 19, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.12992262840271
Epoch: 20, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.740 Vali Acc: 0.828 Test Loss: 0.740 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 1.182915210723877
Epoch: 21, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0332303047180176
Epoch: 22, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0743446350097656
Epoch: 23, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 1.0671780109405518
Epoch: 24, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.1017143726348877
Epoch: 25, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1186294555664062
Epoch: 26, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 1.0331060886383057
Epoch: 27, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.182917594909668
Epoch: 28, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.167982578277588
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 1.0881226062774658
Epoch: 30, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 1.1169559955596924
Epoch: 31, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.9946305751800537
Epoch: 32, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1907424926757812
Epoch: 33, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.1077051162719727
Epoch: 34, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 35 cost time: 0.9468216896057129
Epoch: 35, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 0.9073929786682129
Epoch: 36, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9814074039459229
Epoch: 37, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.0713520050048828
Epoch: 38, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.792229175567627
Epoch: 39, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9585862159729004
Epoch: 40, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9776046276092529
Epoch: 41, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9666237831115723
Epoch: 42, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8738462924957275
Epoch: 43, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0268588066101074
Epoch: 44, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1165540218353271
Epoch: 45, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0956926345825195
Epoch: 46, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1375153064727783
Epoch: 47, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 28487
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.342352867126465
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.712 Vali Acc: 0.089 Test Loss: 2.712 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.046720266342163
Epoch: 2, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.500 Vali Acc: 0.139 Test Loss: 2.500 Test Acc: 0.139
Validation loss decreased (-0.088862 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 1.208493709564209
Epoch: 3, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.244 Vali Acc: 0.333 Test Loss: 2.244 Test Acc: 0.333
Validation loss decreased (-0.138864 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 1.0621201992034912
Epoch: 4, Steps: 12 | Train Loss: 2.124 Vali Loss: 2.007 Vali Acc: 0.450 Test Loss: 2.007 Test Acc: 0.450
Validation loss decreased (-0.333311 --> -0.449980).  Saving model ...
Epoch: 5 cost time: 1.1202552318572998
Epoch: 5, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.784 Vali Acc: 0.544 Test Loss: 1.784 Test Acc: 0.544
Validation loss decreased (-0.449980 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 1.2625401020050049
Epoch: 6, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.592 Vali Acc: 0.667 Test Loss: 1.592 Test Acc: 0.667
Validation loss decreased (-0.544427 --> -0.666651).  Saving model ...
Epoch: 7 cost time: 1.083744764328003
Epoch: 7, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.432 Vali Acc: 0.694 Test Loss: 1.432 Test Acc: 0.694
Validation loss decreased (-0.666651 --> -0.694430).  Saving model ...
Epoch: 8 cost time: 1.121128797531128
Epoch: 8, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.315 Vali Acc: 0.700 Test Loss: 1.315 Test Acc: 0.700
Validation loss decreased (-0.694430 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.1183583736419678
Epoch: 9, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.208 Vali Acc: 0.711 Test Loss: 1.208 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.0927975177764893
Epoch: 10, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.145 Vali Acc: 0.717 Test Loss: 1.145 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.1332616806030273
Epoch: 11, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.083 Vali Acc: 0.761 Test Loss: 1.083 Test Acc: 0.761
Validation loss decreased (-0.716655 --> -0.761100).  Saving model ...
Epoch: 12 cost time: 1.016427993774414
Epoch: 12, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.019 Vali Acc: 0.756 Test Loss: 1.019 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0730195045471191
Epoch: 13, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.954 Vali Acc: 0.761 Test Loss: 0.954 Test Acc: 0.761
Validation loss decreased (-0.761100 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 0.9986815452575684
Epoch: 14, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.918 Vali Acc: 0.761 Test Loss: 0.918 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 1.0283193588256836
Epoch: 15, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 1.0930116176605225
Epoch: 16, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.818 Vali Acc: 0.789 Test Loss: 0.818 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 1.214616060256958
Epoch: 17, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.800 Vali Acc: 0.806 Test Loss: 0.800 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 1.0976402759552002
Epoch: 18, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1285967826843262
Epoch: 19, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.753 Vali Acc: 0.794 Test Loss: 0.753 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0653023719787598
Epoch: 20, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.724 Vali Acc: 0.817 Test Loss: 0.724 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 1.1479568481445312
Epoch: 21, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 1.0637843608856201
Epoch: 22, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.679 Vali Acc: 0.817 Test Loss: 0.679 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.0449602603912354
Epoch: 23, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.670 Vali Acc: 0.817 Test Loss: 0.670 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 1.0056657791137695
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 1.0649182796478271
Epoch: 25, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.049323320388794
Epoch: 26, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.1513018608093262
Epoch: 27, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.0971112251281738
Epoch: 28, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.017078161239624
Epoch: 29, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.9607923030853271
Epoch: 30, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.1214828491210938
Epoch: 31, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 1.085712194442749
Epoch: 32, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0429613590240479
Epoch: 33, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.956432580947876
Epoch: 34, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 1.0321545600891113
Epoch: 35, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 0.9688284397125244
Epoch: 36, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.0450739860534668
Epoch: 37, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.9769351482391357
Epoch: 38, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1044971942901611
Epoch: 39, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1301665306091309
Epoch: 40, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0837533473968506
Epoch: 41, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 1.1488926410675049
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0819435119628906
Epoch: 43, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.194061279296875
Epoch: 44, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0900237560272217
Epoch: 45, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1495118141174316
Epoch: 46, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.109560251235962
Epoch: 47, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9386899471282959
Epoch: 48, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1037602424621582
Epoch: 49, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.1490728855133057
Epoch: 50, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.1777143478393555
Epoch: 51, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 28487
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3237152099609375
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.727 Vali Acc: 0.078 Test Loss: 2.727 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.9181687831878662
Epoch: 2, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.520 Vali Acc: 0.178 Test Loss: 2.520 Test Acc: 0.178
Validation loss decreased (-0.077751 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 1.0485119819641113
Epoch: 3, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.267 Vali Acc: 0.361 Test Loss: 2.267 Test Acc: 0.361
Validation loss decreased (-0.177753 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.11454176902771
Epoch: 4, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.032 Vali Acc: 0.528 Test Loss: 2.032 Test Acc: 0.528
Validation loss decreased (-0.361088 --> -0.527757).  Saving model ...
Epoch: 5 cost time: 1.026623249053955
Epoch: 5, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.807 Vali Acc: 0.556 Test Loss: 1.807 Test Acc: 0.556
Validation loss decreased (-0.527757 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 1.0116791725158691
Epoch: 6, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.613 Vali Acc: 0.639 Test Loss: 1.613 Test Acc: 0.639
Validation loss decreased (-0.555537 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 0.9600913524627686
Epoch: 7, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.454 Vali Acc: 0.678 Test Loss: 1.454 Test Acc: 0.678
Validation loss decreased (-0.638873 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 1.0769262313842773
Epoch: 8, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.341 Vali Acc: 0.672 Test Loss: 1.341 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9755194187164307
Epoch: 9, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.234 Vali Acc: 0.700 Test Loss: 1.234 Test Acc: 0.700
Validation loss decreased (-0.677763 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.9495530128479004
Epoch: 10, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.170 Vali Acc: 0.694 Test Loss: 1.170 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.057845115661621
Epoch: 11, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.9873967170715332
Epoch: 12, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.052 Vali Acc: 0.711 Test Loss: 1.052 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.976524829864502
Epoch: 13, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.991 Vali Acc: 0.728 Test Loss: 0.991 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 1.0964291095733643
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.963 Vali Acc: 0.694 Test Loss: 0.963 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9756715297698975
Epoch: 15, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.0589754581451416
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.868 Vali Acc: 0.761 Test Loss: 0.868 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761102).  Saving model ...
Epoch: 17 cost time: 1.0977392196655273
Epoch: 17, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9297831058502197
Epoch: 18, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.825 Vali Acc: 0.756 Test Loss: 0.825 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0995383262634277
Epoch: 19, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 20 cost time: 1.1102123260498047
Epoch: 20, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.791 Vali Acc: 0.767 Test Loss: 0.791 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0463581085205078
Epoch: 21, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9649856090545654
Epoch: 22, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.728 Vali Acc: 0.767 Test Loss: 0.728 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.08414626121521
Epoch: 23, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.725 Vali Acc: 0.772 Test Loss: 0.725 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0446906089782715
Epoch: 24, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 0.9901108741760254
Epoch: 25, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.0389845371246338
Epoch: 26, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1209986209869385
Epoch: 27, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.9334328174591064
Epoch: 28, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1360769271850586
Epoch: 29, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 30 cost time: 1.1361010074615479
Epoch: 30, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0644593238830566
Epoch: 31, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 32 cost time: 1.0508344173431396
Epoch: 32, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.602 Vali Acc: 0.794 Test Loss: 0.602 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9230556488037109
Epoch: 33, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.609 Vali Acc: 0.811 Test Loss: 0.609 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.062927007675171
Epoch: 34, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.604 Vali Acc: 0.817 Test Loss: 0.604 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 35 cost time: 1.0689599514007568
Epoch: 35, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.573 Vali Acc: 0.811 Test Loss: 0.573 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1123461723327637
Epoch: 36, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.018763780593872
Epoch: 37, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.554 Vali Acc: 0.806 Test Loss: 0.554 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8153986930847168
Epoch: 38, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.559 Vali Acc: 0.811 Test Loss: 0.559 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0352959632873535
Epoch: 39, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9772851467132568
Epoch: 40, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.0341651439666748
Epoch: 41, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0195980072021484
Epoch: 42, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 43 cost time: 0.9366903305053711
Epoch: 43, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.108346700668335
Epoch: 44, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 45 cost time: 1.0295956134796143
Epoch: 45, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9701821804046631
Epoch: 46, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 47 cost time: 0.8976476192474365
Epoch: 47, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.507 Vali Acc: 0.839 Test Loss: 0.507 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9563767910003662
Epoch: 48, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.510 Vali Acc: 0.839 Test Loss: 0.510 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0928537845611572
Epoch: 49, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9271252155303955
Epoch: 50, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9995899200439453
Epoch: 51, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.522 Vali Acc: 0.839 Test Loss: 0.522 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0713627338409424
Epoch: 52, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 53 cost time: 1.1364948749542236
Epoch: 53, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0336031913757324
Epoch: 54, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.513 Vali Acc: 0.839 Test Loss: 0.513 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0944573879241943
Epoch: 55, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.207669973373413
Epoch: 56, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9681177139282227
Epoch: 57, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2147364616394043
Epoch: 58, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 59 cost time: 1.1893634796142578
Epoch: 59, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 60 cost time: 1.027651071548462
Epoch: 60, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0276057720184326
Epoch: 61, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1178131103515625
Epoch: 62, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0932376384735107
Epoch: 63, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.043027639389038
Epoch: 64, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.148564338684082
Epoch: 65, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0309743881225586
Epoch: 66, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.000105381011963
Epoch: 67, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.0044522285461426
Epoch: 68, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.0186774730682373
Epoch: 69, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ETSformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 28487
model size : 0.73MB
