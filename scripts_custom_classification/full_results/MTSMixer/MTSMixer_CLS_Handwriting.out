Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7429380416870117
Epoch: 1, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.324 Vali Acc: 0.045 Test Loss: 3.324 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.2012381553649902
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.307 Vali Acc: 0.051 Test Loss: 3.307 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.287046194076538
Epoch: 3, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.286 Vali Acc: 0.051 Test Loss: 3.286 Test Acc: 0.051
Validation loss decreased (-0.050555 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.4634675979614258
Epoch: 4, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.270 Vali Acc: 0.047 Test Loss: 3.270 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2337639331817627
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.260 Vali Acc: 0.052 Test Loss: 3.260 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 1.2664527893066406
Epoch: 6, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.249 Vali Acc: 0.068 Test Loss: 3.249 Test Acc: 0.068
Validation loss decreased (-0.051732 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 1.222327470779419
Epoch: 7, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.241 Vali Acc: 0.080 Test Loss: 3.241 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 1.3601784706115723
Epoch: 8, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.229 Vali Acc: 0.107 Test Loss: 3.229 Test Acc: 0.107
Validation loss decreased (-0.079968 --> -0.107027).  Saving model ...
Epoch: 9 cost time: 1.4541270732879639
Epoch: 9, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.222 Vali Acc: 0.120 Test Loss: 3.222 Test Acc: 0.120
Validation loss decreased (-0.107027 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 1.3447108268737793
Epoch: 10, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.220 Vali Acc: 0.116 Test Loss: 3.220 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.189023733139038
Epoch: 11, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.216 Vali Acc: 0.116 Test Loss: 3.216 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4467449188232422
Epoch: 12, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.212 Vali Acc: 0.118 Test Loss: 3.212 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3602800369262695
Epoch: 13, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.202 Vali Acc: 0.121 Test Loss: 3.202 Test Acc: 0.121
Validation loss decreased (-0.119968 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 1.1318020820617676
Epoch: 14, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.200 Vali Acc: 0.126 Test Loss: 3.200 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 1.5084147453308105
Epoch: 15, Steps: 10 | Train Loss: 2.034 Vali Loss: 3.197 Vali Acc: 0.131 Test Loss: 3.197 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 1.291609525680542
Epoch: 16, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.191 Vali Acc: 0.135 Test Loss: 3.191 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 1.3356361389160156
Epoch: 17, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.184 Vali Acc: 0.138 Test Loss: 3.184 Test Acc: 0.138
Validation loss decreased (-0.135262 --> -0.137615).  Saving model ...
Epoch: 18 cost time: 1.2556405067443848
Epoch: 18, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.170 Vali Acc: 0.134 Test Loss: 3.170 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.170696496963501
Epoch: 19, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.169 Vali Acc: 0.141 Test Loss: 3.169 Test Acc: 0.141
Validation loss decreased (-0.137615 --> -0.141145).  Saving model ...
Epoch: 20 cost time: 1.343315601348877
Epoch: 20, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.163 Vali Acc: 0.146 Test Loss: 3.163 Test Acc: 0.146
Validation loss decreased (-0.141145 --> -0.145851).  Saving model ...
Epoch: 21 cost time: 1.320420265197754
Epoch: 21, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.156 Vali Acc: 0.141 Test Loss: 3.156 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3047661781311035
Epoch: 22, Steps: 10 | Train Loss: 1.403 Vali Loss: 3.162 Vali Acc: 0.136 Test Loss: 3.162 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.64408540725708
Epoch: 23, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.157 Vali Acc: 0.148 Test Loss: 3.157 Test Acc: 0.148
Validation loss decreased (-0.145851 --> -0.148204).  Saving model ...
Epoch: 24 cost time: 1.262746810913086
Epoch: 24, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.158 Vali Acc: 0.151 Test Loss: 3.158 Test Acc: 0.151
Validation loss decreased (-0.148204 --> -0.150557).  Saving model ...
Epoch: 25 cost time: 2.011890172958374
Epoch: 25, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.160 Vali Acc: 0.154 Test Loss: 3.160 Test Acc: 0.154
Validation loss decreased (-0.150557 --> -0.154086).  Saving model ...
Epoch: 26 cost time: 1.4434149265289307
Epoch: 26, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.153 Vali Acc: 0.146 Test Loss: 3.153 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7797973155975342
Epoch: 27, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.155 Vali Acc: 0.158 Test Loss: 3.155 Test Acc: 0.158
Validation loss decreased (-0.154086 --> -0.157616).  Saving model ...
Epoch: 28 cost time: 1.679123878479004
Epoch: 28, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.169 Vali Acc: 0.147 Test Loss: 3.169 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.431959867477417
Epoch: 29, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.163 Vali Acc: 0.162 Test Loss: 3.163 Test Acc: 0.162
Validation loss decreased (-0.157616 --> -0.162321).  Saving model ...
Epoch: 30 cost time: 1.608069896697998
Epoch: 30, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.173 Vali Acc: 0.153 Test Loss: 3.173 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8593521118164062
Epoch: 31, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.181 Vali Acc: 0.155 Test Loss: 3.181 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.571828842163086
Epoch: 32, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.185 Vali Acc: 0.167 Test Loss: 3.185 Test Acc: 0.167
Validation loss decreased (-0.162321 --> -0.167027).  Saving model ...
Epoch: 33 cost time: 1.856489896774292
Epoch: 33, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.196 Vali Acc: 0.160 Test Loss: 3.196 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9617643356323242
Epoch: 34, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.204 Vali Acc: 0.161 Test Loss: 3.204 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6563122272491455
Epoch: 35, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.205 Vali Acc: 0.167 Test Loss: 3.205 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8041136264801025
Epoch: 36, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.211 Vali Acc: 0.176 Test Loss: 3.211 Test Acc: 0.176
Validation loss decreased (-0.167027 --> -0.176438).  Saving model ...
Epoch: 37 cost time: 1.6779160499572754
Epoch: 37, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.216 Vali Acc: 0.171 Test Loss: 3.216 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.38993239402771
Epoch: 38, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.237 Vali Acc: 0.171 Test Loss: 3.237 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5673267841339111
Epoch: 39, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.240 Vali Acc: 0.168 Test Loss: 3.240 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4782283306121826
Epoch: 40, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.269 Vali Acc: 0.171 Test Loss: 3.269 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5180678367614746
Epoch: 41, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.281 Vali Acc: 0.176 Test Loss: 3.281 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4705605506896973
Epoch: 42, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.287 Vali Acc: 0.174 Test Loss: 3.287 Test Acc: 0.174
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4585490226745605
Epoch: 43, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.287 Vali Acc: 0.171 Test Loss: 3.287 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.221104860305786
Epoch: 44, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.299 Vali Acc: 0.181 Test Loss: 3.299 Test Acc: 0.181
Validation loss decreased (-0.176438 --> -0.181143).  Saving model ...
Epoch: 45 cost time: 1.591970682144165
Epoch: 45, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.313 Vali Acc: 0.178 Test Loss: 3.313 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5711784362792969
Epoch: 46, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.342 Vali Acc: 0.174 Test Loss: 3.342 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6306178569793701
Epoch: 47, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.358 Vali Acc: 0.175 Test Loss: 3.358 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.673084020614624
Epoch: 48, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.360 Vali Acc: 0.185 Test Loss: 3.360 Test Acc: 0.185
Validation loss decreased (-0.181143 --> -0.184672).  Saving model ...
Epoch: 49 cost time: 1.406090259552002
Epoch: 49, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.357 Vali Acc: 0.184 Test Loss: 3.357 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4578206539154053
Epoch: 50, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.364 Vali Acc: 0.173 Test Loss: 3.364 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4647612571716309
Epoch: 51, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.388 Vali Acc: 0.172 Test Loss: 3.388 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.66825270652771
Epoch: 52, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.399 Vali Acc: 0.176 Test Loss: 3.399 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5170671939849854
Epoch: 53, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.415 Vali Acc: 0.173 Test Loss: 3.415 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.8756422996520996
Epoch: 54, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.408 Vali Acc: 0.181 Test Loss: 3.408 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.5061447620391846
Epoch: 55, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.398 Vali Acc: 0.181 Test Loss: 3.398 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.7772276401519775
Epoch: 56, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.414 Vali Acc: 0.178 Test Loss: 3.414 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.5353569984436035
Epoch: 57, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.420 Vali Acc: 0.169 Test Loss: 3.420 Test Acc: 0.169
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.5533561706542969
Epoch: 58, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.425 Vali Acc: 0.167 Test Loss: 3.425 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 673742
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2162625789642334
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.315 Vali Acc: 0.044 Test Loss: 3.315 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.4456629753112793
Epoch: 2, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.301 Vali Acc: 0.052 Test Loss: 3.301 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.303455114364624
Epoch: 3, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.292 Vali Acc: 0.053 Test Loss: 3.292 Test Acc: 0.053
Validation loss decreased (-0.051732 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.2979083061218262
Epoch: 4, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.283 Vali Acc: 0.053 Test Loss: 3.283 Test Acc: 0.053
Validation loss decreased (-0.052908 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 1.3299601078033447
Epoch: 5, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.272 Vali Acc: 0.058 Test Loss: 3.272 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 1.2279891967773438
Epoch: 6, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.263 Vali Acc: 0.061 Test Loss: 3.263 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 1.2744922637939453
Epoch: 7, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.260 Vali Acc: 0.067 Test Loss: 3.260 Test Acc: 0.067
Validation loss decreased (-0.061144 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.2673048973083496
Epoch: 8, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.257 Vali Acc: 0.065 Test Loss: 3.257 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6091976165771484
Epoch: 9, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.248 Vali Acc: 0.084 Test Loss: 3.248 Test Acc: 0.084
Validation loss decreased (-0.067026 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 1.4196655750274658
Epoch: 10, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.245 Vali Acc: 0.085 Test Loss: 3.245 Test Acc: 0.085
Validation loss decreased (-0.083497 --> -0.084673).  Saving model ...
Epoch: 11 cost time: 1.7364797592163086
Epoch: 11, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.244 Vali Acc: 0.088 Test Loss: 3.244 Test Acc: 0.088
Validation loss decreased (-0.084673 --> -0.088203).  Saving model ...
Epoch: 12 cost time: 1.5821244716644287
Epoch: 12, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.237 Vali Acc: 0.098 Test Loss: 3.237 Test Acc: 0.098
Validation loss decreased (-0.088203 --> -0.097615).  Saving model ...
Epoch: 13 cost time: 1.498403787612915
Epoch: 13, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.230 Vali Acc: 0.107 Test Loss: 3.230 Test Acc: 0.107
Validation loss decreased (-0.097615 --> -0.107027).  Saving model ...
Epoch: 14 cost time: 1.4751508235931396
Epoch: 14, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.225 Vali Acc: 0.111 Test Loss: 3.225 Test Acc: 0.111
Validation loss decreased (-0.107027 --> -0.110556).  Saving model ...
Epoch: 15 cost time: 1.3731002807617188
Epoch: 15, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.217 Vali Acc: 0.105 Test Loss: 3.217 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5114850997924805
Epoch: 16, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.206 Vali Acc: 0.112 Test Loss: 3.206 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111733).  Saving model ...
Epoch: 17 cost time: 1.3818273544311523
Epoch: 17, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.206 Vali Acc: 0.120 Test Loss: 3.206 Test Acc: 0.120
Validation loss decreased (-0.111733 --> -0.119968).  Saving model ...
Epoch: 18 cost time: 1.9708456993103027
Epoch: 18, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.204 Vali Acc: 0.132 Test Loss: 3.204 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131733).  Saving model ...
Epoch: 19 cost time: 1.3575725555419922
Epoch: 19, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.204 Vali Acc: 0.141 Test Loss: 3.204 Test Acc: 0.141
Validation loss decreased (-0.131733 --> -0.141144).  Saving model ...
Epoch: 20 cost time: 1.5121586322784424
Epoch: 20, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.197 Vali Acc: 0.136 Test Loss: 3.197 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9767441749572754
Epoch: 21, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.199 Vali Acc: 0.144 Test Loss: 3.199 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 22 cost time: 1.585317611694336
Epoch: 22, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.203 Vali Acc: 0.136 Test Loss: 3.203 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5281989574432373
Epoch: 23, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.203 Vali Acc: 0.142 Test Loss: 3.203 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4929652214050293
Epoch: 24, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.200 Vali Acc: 0.146 Test Loss: 3.200 Test Acc: 0.146
Validation loss decreased (-0.143497 --> -0.145850).  Saving model ...
Epoch: 25 cost time: 1.434990406036377
Epoch: 25, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.197 Vali Acc: 0.156 Test Loss: 3.197 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156439).  Saving model ...
Epoch: 26 cost time: 1.4545938968658447
Epoch: 26, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.211 Vali Acc: 0.148 Test Loss: 3.211 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3459231853485107
Epoch: 27, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.211 Vali Acc: 0.146 Test Loss: 3.211 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2124693393707275
Epoch: 28, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.230 Vali Acc: 0.147 Test Loss: 3.230 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3488502502441406
Epoch: 29, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.235 Vali Acc: 0.151 Test Loss: 3.235 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4962334632873535
Epoch: 30, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.222 Vali Acc: 0.162 Test Loss: 3.222 Test Acc: 0.162
Validation loss decreased (-0.156439 --> -0.162321).  Saving model ...
Epoch: 31 cost time: 1.540403127670288
Epoch: 31, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.237 Vali Acc: 0.156 Test Loss: 3.237 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3287830352783203
Epoch: 32, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.256 Vali Acc: 0.161 Test Loss: 3.256 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4322733879089355
Epoch: 33, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.264 Vali Acc: 0.156 Test Loss: 3.264 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6319308280944824
Epoch: 34, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.292 Vali Acc: 0.152 Test Loss: 3.292 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3780415058135986
Epoch: 35, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.327 Vali Acc: 0.152 Test Loss: 3.327 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.496488094329834
Epoch: 36, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.332 Vali Acc: 0.161 Test Loss: 3.332 Test Acc: 0.161
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3537628650665283
Epoch: 37, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.337 Vali Acc: 0.168 Test Loss: 3.337 Test Acc: 0.168
Validation loss decreased (-0.162321 --> -0.168202).  Saving model ...
Epoch: 38 cost time: 1.4200184345245361
Epoch: 38, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.366 Vali Acc: 0.169 Test Loss: 3.366 Test Acc: 0.169
Validation loss decreased (-0.168202 --> -0.169378).  Saving model ...
Epoch: 39 cost time: 1.3745107650756836
Epoch: 39, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.367 Vali Acc: 0.173 Test Loss: 3.367 Test Acc: 0.173
Validation loss decreased (-0.169378 --> -0.172908).  Saving model ...
Epoch: 40 cost time: 1.4880781173706055
Epoch: 40, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.387 Vali Acc: 0.171 Test Loss: 3.387 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5776174068450928
Epoch: 41, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.417 Vali Acc: 0.165 Test Loss: 3.417 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5013933181762695
Epoch: 42, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.437 Vali Acc: 0.165 Test Loss: 3.437 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3353898525238037
Epoch: 43, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.465 Vali Acc: 0.169 Test Loss: 3.465 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5829105377197266
Epoch: 44, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.489 Vali Acc: 0.173 Test Loss: 3.489 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.462364673614502
Epoch: 45, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.512 Vali Acc: 0.175 Test Loss: 3.512 Test Acc: 0.175
Validation loss decreased (-0.172908 --> -0.175259).  Saving model ...
Epoch: 46 cost time: 1.626110553741455
Epoch: 46, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.524 Vali Acc: 0.175 Test Loss: 3.524 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4450693130493164
Epoch: 47, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.531 Vali Acc: 0.175 Test Loss: 3.531 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3638677597045898
Epoch: 48, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.549 Vali Acc: 0.176 Test Loss: 3.549 Test Acc: 0.176
Validation loss decreased (-0.175259 --> -0.176435).  Saving model ...
Epoch: 49 cost time: 1.4893293380737305
Epoch: 49, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.558 Vali Acc: 0.175 Test Loss: 3.558 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6011488437652588
Epoch: 50, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.582 Vali Acc: 0.178 Test Loss: 3.582 Test Acc: 0.178
Validation loss decreased (-0.176435 --> -0.177611).  Saving model ...
Epoch: 51 cost time: 1.2663097381591797
Epoch: 51, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.592 Vali Acc: 0.168 Test Loss: 3.592 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3254084587097168
Epoch: 52, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.607 Vali Acc: 0.172 Test Loss: 3.607 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.4380521774291992
Epoch: 53, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.611 Vali Acc: 0.179 Test Loss: 3.611 Test Acc: 0.179
Validation loss decreased (-0.177611 --> -0.178787).  Saving model ...
Epoch: 54 cost time: 1.4330980777740479
Epoch: 54, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.626 Vali Acc: 0.178 Test Loss: 3.626 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4042410850524902
Epoch: 55, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.637 Vali Acc: 0.180 Test Loss: 3.637 Test Acc: 0.180
Validation loss decreased (-0.178787 --> -0.179964).  Saving model ...
Epoch: 56 cost time: 1.2141306400299072
Epoch: 56, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.651 Vali Acc: 0.176 Test Loss: 3.651 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.337665319442749
Epoch: 57, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.671 Vali Acc: 0.169 Test Loss: 3.671 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2537155151367188
Epoch: 58, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.687 Vali Acc: 0.174 Test Loss: 3.687 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3975372314453125
Epoch: 59, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.693 Vali Acc: 0.172 Test Loss: 3.693 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.4097003936767578
Epoch: 60, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.706 Vali Acc: 0.171 Test Loss: 3.706 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.7424037456512451
Epoch: 61, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.715 Vali Acc: 0.178 Test Loss: 3.715 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.4935743808746338
Epoch: 62, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.723 Vali Acc: 0.176 Test Loss: 3.723 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.4818224906921387
Epoch: 63, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.728 Vali Acc: 0.174 Test Loss: 3.728 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.2831616401672363
Epoch: 64, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.735 Vali Acc: 0.176 Test Loss: 3.735 Test Acc: 0.176
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.5937232971191406
Epoch: 65, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.743 Vali Acc: 0.169 Test Loss: 3.743 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18
model parameter : 667598
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8599610328674316
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.351 Vali Acc: 0.039 Test Loss: 3.351 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.2309060096740723
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.335 Vali Acc: 0.041 Test Loss: 3.335 Test Acc: 0.041
Validation loss decreased (-0.038790 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.2135725021362305
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.321 Vali Acc: 0.040 Test Loss: 3.321 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2794525623321533
Epoch: 4, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.304 Vali Acc: 0.040 Test Loss: 3.304 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.03955078125
Epoch: 5, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.293 Vali Acc: 0.042 Test Loss: 3.293 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 6 cost time: 1.0851259231567383
Epoch: 6, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.282 Vali Acc: 0.052 Test Loss: 3.282 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 7 cost time: 1.1029362678527832
Epoch: 7, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.280 Vali Acc: 0.074 Test Loss: 3.280 Test Acc: 0.074
Validation loss decreased (-0.051732 --> -0.074085).  Saving model ...
Epoch: 8 cost time: 1.189814567565918
Epoch: 8, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.279 Vali Acc: 0.069 Test Loss: 3.279 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.022958517074585
Epoch: 9, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.266 Vali Acc: 0.074 Test Loss: 3.266 Test Acc: 0.074
Validation loss decreased (-0.074085 --> -0.074085).  Saving model ...
Epoch: 10 cost time: 1.6097476482391357
Epoch: 10, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.264 Vali Acc: 0.086 Test Loss: 3.264 Test Acc: 0.086
Validation loss decreased (-0.074085 --> -0.085850).  Saving model ...
Epoch: 11 cost time: 1.3634700775146484
Epoch: 11, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.247 Vali Acc: 0.089 Test Loss: 3.247 Test Acc: 0.089
Validation loss decreased (-0.085850 --> -0.089379).  Saving model ...
Epoch: 12 cost time: 1.455068588256836
Epoch: 12, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.247 Vali Acc: 0.089 Test Loss: 3.247 Test Acc: 0.089
Validation loss decreased (-0.089379 --> -0.089379).  Saving model ...
Epoch: 13 cost time: 1.3877785205841064
Epoch: 13, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.243 Vali Acc: 0.098 Test Loss: 3.243 Test Acc: 0.098
Validation loss decreased (-0.089379 --> -0.097615).  Saving model ...
Epoch: 14 cost time: 1.3868672847747803
Epoch: 14, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.238 Vali Acc: 0.113 Test Loss: 3.238 Test Acc: 0.113
Validation loss decreased (-0.097615 --> -0.112909).  Saving model ...
Epoch: 15 cost time: 1.3695728778839111
Epoch: 15, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.239 Vali Acc: 0.107 Test Loss: 3.239 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4457728862762451
Epoch: 16, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.241 Vali Acc: 0.109 Test Loss: 3.241 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5683643817901611
Epoch: 17, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.245 Vali Acc: 0.111 Test Loss: 3.245 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3894505500793457
Epoch: 18, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.237 Vali Acc: 0.108 Test Loss: 3.237 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4620225429534912
Epoch: 19, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.229 Vali Acc: 0.109 Test Loss: 3.229 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3246560096740723
Epoch: 20, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.229 Vali Acc: 0.121 Test Loss: 3.229 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121144).  Saving model ...
Epoch: 21 cost time: 1.3370730876922607
Epoch: 21, Steps: 10 | Train Loss: 1.966 Vali Loss: 3.230 Vali Acc: 0.118 Test Loss: 3.230 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4883654117584229
Epoch: 22, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.216 Vali Acc: 0.120 Test Loss: 3.216 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2953743934631348
Epoch: 23, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.194 Vali Acc: 0.131 Test Loss: 3.194 Test Acc: 0.131
Validation loss decreased (-0.121144 --> -0.130556).  Saving model ...
Epoch: 24 cost time: 1.1417617797851562
Epoch: 24, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.206 Vali Acc: 0.140 Test Loss: 3.206 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 25 cost time: 1.2238576412200928
Epoch: 25, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.207 Vali Acc: 0.142 Test Loss: 3.207 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 26 cost time: 1.1958417892456055
Epoch: 26, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.202 Vali Acc: 0.139 Test Loss: 3.202 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5702145099639893
Epoch: 27, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.222 Vali Acc: 0.139 Test Loss: 3.222 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.387608289718628
Epoch: 28, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.218 Vali Acc: 0.128 Test Loss: 3.218 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1311931610107422
Epoch: 29, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.224 Vali Acc: 0.136 Test Loss: 3.224 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.579885482788086
Epoch: 30, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.204 Vali Acc: 0.154 Test Loss: 3.204 Test Acc: 0.154
Validation loss decreased (-0.142321 --> -0.154086).  Saving model ...
Epoch: 31 cost time: 1.382889747619629
Epoch: 31, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.206 Vali Acc: 0.169 Test Loss: 3.206 Test Acc: 0.169
Validation loss decreased (-0.154086 --> -0.169380).  Saving model ...
Epoch: 32 cost time: 1.5626862049102783
Epoch: 32, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.220 Vali Acc: 0.161 Test Loss: 3.220 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3622369766235352
Epoch: 33, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.236 Vali Acc: 0.148 Test Loss: 3.236 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.579482078552246
Epoch: 34, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.243 Vali Acc: 0.148 Test Loss: 3.243 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4351024627685547
Epoch: 35, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.230 Vali Acc: 0.153 Test Loss: 3.230 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4784221649169922
Epoch: 36, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.234 Vali Acc: 0.160 Test Loss: 3.234 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.265927791595459
Epoch: 37, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.239 Vali Acc: 0.162 Test Loss: 3.239 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5375111103057861
Epoch: 38, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.247 Vali Acc: 0.160 Test Loss: 3.247 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.435124397277832
Epoch: 39, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.269 Vali Acc: 0.164 Test Loss: 3.269 Test Acc: 0.164
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6467559337615967
Epoch: 40, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.279 Vali Acc: 0.168 Test Loss: 3.279 Test Acc: 0.168
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4691917896270752
Epoch: 41, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.290 Vali Acc: 0.166 Test Loss: 3.290 Test Acc: 0.166
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16941176470588235
model parameter : 659406
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.973778486251831
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.334 Vali Acc: 0.034 Test Loss: 3.334 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.1957087516784668
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.313 Vali Acc: 0.036 Test Loss: 3.313 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 1.0159385204315186
Epoch: 3, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.289 Vali Acc: 0.041 Test Loss: 3.289 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.962374210357666
Epoch: 4, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.267 Vali Acc: 0.053 Test Loss: 3.267 Test Acc: 0.053
Validation loss decreased (-0.041144 --> -0.052909).  Saving model ...
Epoch: 5 cost time: 1.16098952293396
Epoch: 5, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.250 Vali Acc: 0.069 Test Loss: 3.250 Test Acc: 0.069
Validation loss decreased (-0.052909 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 1.0855827331542969
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.234 Vali Acc: 0.086 Test Loss: 3.234 Test Acc: 0.086
Validation loss decreased (-0.069379 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.159376621246338
Epoch: 7, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.219 Vali Acc: 0.101 Test Loss: 3.219 Test Acc: 0.101
Validation loss decreased (-0.085850 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 1.0379362106323242
Epoch: 8, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.206 Vali Acc: 0.113 Test Loss: 3.206 Test Acc: 0.113
Validation loss decreased (-0.101144 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.2862884998321533
Epoch: 9, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.198 Vali Acc: 0.113 Test Loss: 3.198 Test Acc: 0.113
Validation loss decreased (-0.112909 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 1.5195691585540771
Epoch: 10, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.178 Vali Acc: 0.118 Test Loss: 3.178 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.129180669784546
Epoch: 11, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.177 Vali Acc: 0.132 Test Loss: 3.177 Test Acc: 0.132
Validation loss decreased (-0.117615 --> -0.131733).  Saving model ...
Epoch: 12 cost time: 1.1884434223175049
Epoch: 12, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.163 Vali Acc: 0.138 Test Loss: 3.163 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137615).  Saving model ...
Epoch: 13 cost time: 0.9690825939178467
Epoch: 13, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.163 Vali Acc: 0.142 Test Loss: 3.163 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 14 cost time: 1.2164998054504395
Epoch: 14, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.153 Vali Acc: 0.149 Test Loss: 3.153 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 15 cost time: 1.0504236221313477
Epoch: 15, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.147 Vali Acc: 0.153 Test Loss: 3.147 Test Acc: 0.153
Validation loss decreased (-0.149380 --> -0.152910).  Saving model ...
Epoch: 16 cost time: 1.3015155792236328
Epoch: 16, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.145 Vali Acc: 0.145 Test Loss: 3.145 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0660226345062256
Epoch: 17, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.142 Vali Acc: 0.154 Test Loss: 3.142 Test Acc: 0.154
Validation loss decreased (-0.152910 --> -0.154086).  Saving model ...
Epoch: 18 cost time: 1.5518217086791992
Epoch: 18, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.142 Vali Acc: 0.158 Test Loss: 3.142 Test Acc: 0.158
Validation loss decreased (-0.154086 --> -0.157616).  Saving model ...
Epoch: 19 cost time: 0.9988274574279785
Epoch: 19, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.129 Vali Acc: 0.166 Test Loss: 3.129 Test Acc: 0.166
Validation loss decreased (-0.157616 --> -0.165851).  Saving model ...
Epoch: 20 cost time: 1.6011152267456055
Epoch: 20, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.123 Vali Acc: 0.169 Test Loss: 3.123 Test Acc: 0.169
Validation loss decreased (-0.165851 --> -0.169381).  Saving model ...
Epoch: 21 cost time: 1.0885732173919678
Epoch: 21, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.109 Vali Acc: 0.171 Test Loss: 3.109 Test Acc: 0.171
Validation loss decreased (-0.169381 --> -0.170557).  Saving model ...
Epoch: 22 cost time: 1.188086748123169
Epoch: 22, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.111 Vali Acc: 0.161 Test Loss: 3.111 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1802964210510254
Epoch: 23, Steps: 10 | Train Loss: 0.898 Vali Loss: 3.116 Vali Acc: 0.184 Test Loss: 3.116 Test Acc: 0.184
Validation loss decreased (-0.170557 --> -0.183498).  Saving model ...
Epoch: 24 cost time: 1.2979531288146973
Epoch: 24, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.104 Vali Acc: 0.176 Test Loss: 3.104 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0940937995910645
Epoch: 25, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.093 Vali Acc: 0.180 Test Loss: 3.093 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1268925666809082
Epoch: 26, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.104 Vali Acc: 0.187 Test Loss: 3.104 Test Acc: 0.187
Validation loss decreased (-0.183498 --> -0.187028).  Saving model ...
Epoch: 27 cost time: 1.4068737030029297
Epoch: 27, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.116 Vali Acc: 0.169 Test Loss: 3.116 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2379732131958008
Epoch: 28, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.118 Vali Acc: 0.179 Test Loss: 3.118 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2908239364624023
Epoch: 29, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.124 Vali Acc: 0.180 Test Loss: 3.124 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1209070682525635
Epoch: 30, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.139 Vali Acc: 0.178 Test Loss: 3.139 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2145044803619385
Epoch: 31, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.140 Vali Acc: 0.189 Test Loss: 3.140 Test Acc: 0.189
Validation loss decreased (-0.187028 --> -0.189380).  Saving model ...
Epoch: 32 cost time: 1.0557560920715332
Epoch: 32, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.133 Vali Acc: 0.186 Test Loss: 3.133 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5279695987701416
Epoch: 33, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.140 Vali Acc: 0.189 Test Loss: 3.140 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1592118740081787
Epoch: 34, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.175 Vali Acc: 0.180 Test Loss: 3.175 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3942930698394775
Epoch: 35, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.178 Vali Acc: 0.185 Test Loss: 3.178 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1499040126800537
Epoch: 36, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.164 Vali Acc: 0.185 Test Loss: 3.164 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2120492458343506
Epoch: 37, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.179 Vali Acc: 0.185 Test Loss: 3.179 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4928898811340332
Epoch: 38, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.199 Vali Acc: 0.181 Test Loss: 3.199 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1120474338531494
Epoch: 39, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.215 Vali Acc: 0.189 Test Loss: 3.215 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.077432632446289
Epoch: 40, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.218 Vali Acc: 0.187 Test Loss: 3.218 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.311208724975586
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.228 Vali Acc: 0.179 Test Loss: 3.228 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18941176470588236
model parameter : 651214
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.958320140838623
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.293 Vali Acc: 0.044 Test Loss: 3.293 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.4277708530426025
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.280 Vali Acc: 0.042 Test Loss: 3.280 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.170102834701538
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.266 Vali Acc: 0.053 Test Loss: 3.266 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052909).  Saving model ...
Epoch: 4 cost time: 1.0178148746490479
Epoch: 4, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.256 Vali Acc: 0.056 Test Loss: 3.256 Test Acc: 0.056
Validation loss decreased (-0.052909 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.9169554710388184
Epoch: 5, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.250 Vali Acc: 0.066 Test Loss: 3.250 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 0.8957924842834473
Epoch: 6, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.239 Vali Acc: 0.069 Test Loss: 3.239 Test Acc: 0.069
Validation loss decreased (-0.065850 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.011157512664795
Epoch: 7, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.236 Vali Acc: 0.071 Test Loss: 3.236 Test Acc: 0.071
Validation loss decreased (-0.069379 --> -0.070556).  Saving model ...
Epoch: 8 cost time: 0.9231314659118652
Epoch: 8, Steps: 10 | Train Loss: 2.594 Vali Loss: 3.229 Vali Acc: 0.085 Test Loss: 3.229 Test Acc: 0.085
Validation loss decreased (-0.070556 --> -0.084674).  Saving model ...
Epoch: 9 cost time: 1.0877721309661865
Epoch: 9, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.220 Vali Acc: 0.091 Test Loss: 3.220 Test Acc: 0.091
Validation loss decreased (-0.084674 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 1.0891139507293701
Epoch: 10, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.216 Vali Acc: 0.093 Test Loss: 3.216 Test Acc: 0.093
Validation loss decreased (-0.090556 --> -0.092909).  Saving model ...
Epoch: 11 cost time: 1.1529591083526611
Epoch: 11, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.210 Vali Acc: 0.100 Test Loss: 3.210 Test Acc: 0.100
Validation loss decreased (-0.092909 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 1.0502123832702637
Epoch: 12, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.204 Vali Acc: 0.109 Test Loss: 3.204 Test Acc: 0.109
Validation loss decreased (-0.099968 --> -0.109380).  Saving model ...
Epoch: 13 cost time: 1.1660397052764893
Epoch: 13, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.196 Vali Acc: 0.107 Test Loss: 3.196 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1001217365264893
Epoch: 14, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.183 Vali Acc: 0.118 Test Loss: 3.183 Test Acc: 0.118
Validation loss decreased (-0.109380 --> -0.117615).  Saving model ...
Epoch: 15 cost time: 1.1132357120513916
Epoch: 15, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.188 Vali Acc: 0.125 Test Loss: 3.188 Test Acc: 0.125
Validation loss decreased (-0.117615 --> -0.124674).  Saving model ...
Epoch: 16 cost time: 1.0301878452301025
Epoch: 16, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.175 Vali Acc: 0.135 Test Loss: 3.175 Test Acc: 0.135
Validation loss decreased (-0.124674 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 1.0470492839813232
Epoch: 17, Steps: 10 | Train Loss: 1.636 Vali Loss: 3.162 Vali Acc: 0.136 Test Loss: 3.162 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136439).  Saving model ...
Epoch: 18 cost time: 1.1293418407440186
Epoch: 18, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.164 Vali Acc: 0.142 Test Loss: 3.164 Test Acc: 0.142
Validation loss decreased (-0.136439 --> -0.142321).  Saving model ...
Epoch: 19 cost time: 1.111706256866455
Epoch: 19, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.151 Vali Acc: 0.145 Test Loss: 3.151 Test Acc: 0.145
Validation loss decreased (-0.142321 --> -0.144674).  Saving model ...
Epoch: 20 cost time: 1.1410224437713623
Epoch: 20, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.146 Vali Acc: 0.152 Test Loss: 3.146 Test Acc: 0.152
Validation loss decreased (-0.144674 --> -0.151733).  Saving model ...
Epoch: 21 cost time: 1.1240653991699219
Epoch: 21, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.136 Vali Acc: 0.152 Test Loss: 3.136 Test Acc: 0.152
Validation loss decreased (-0.151733 --> -0.151733).  Saving model ...
Epoch: 22 cost time: 1.1590378284454346
Epoch: 22, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.133 Vali Acc: 0.155 Test Loss: 3.133 Test Acc: 0.155
Validation loss decreased (-0.151733 --> -0.155263).  Saving model ...
Epoch: 23 cost time: 1.1910135746002197
Epoch: 23, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.126 Vali Acc: 0.155 Test Loss: 3.126 Test Acc: 0.155
Validation loss decreased (-0.155263 --> -0.155263).  Saving model ...
Epoch: 24 cost time: 1.0142362117767334
Epoch: 24, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.102 Vali Acc: 0.164 Test Loss: 3.102 Test Acc: 0.164
Validation loss decreased (-0.155263 --> -0.163498).  Saving model ...
Epoch: 25 cost time: 1.1072766780853271
Epoch: 25, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.107 Vali Acc: 0.172 Test Loss: 3.107 Test Acc: 0.172
Validation loss decreased (-0.163498 --> -0.171734).  Saving model ...
Epoch: 26 cost time: 1.324260950088501
Epoch: 26, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.107 Vali Acc: 0.164 Test Loss: 3.107 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5102086067199707
Epoch: 27, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.107 Vali Acc: 0.169 Test Loss: 3.107 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9776802062988281
Epoch: 28, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.093 Vali Acc: 0.181 Test Loss: 3.093 Test Acc: 0.181
Validation loss decreased (-0.171734 --> -0.181146).  Saving model ...
Epoch: 29 cost time: 1.3106884956359863
Epoch: 29, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.095 Vali Acc: 0.178 Test Loss: 3.095 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0358784198760986
Epoch: 30, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.090 Vali Acc: 0.182 Test Loss: 3.090 Test Acc: 0.182
Validation loss decreased (-0.181146 --> -0.182322).  Saving model ...
Epoch: 31 cost time: 1.4160232543945312
Epoch: 31, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.096 Vali Acc: 0.188 Test Loss: 3.096 Test Acc: 0.188
Validation loss decreased (-0.182322 --> -0.188204).  Saving model ...
Epoch: 32 cost time: 1.1480252742767334
Epoch: 32, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.096 Vali Acc: 0.193 Test Loss: 3.096 Test Acc: 0.193
Validation loss decreased (-0.188204 --> -0.192910).  Saving model ...
Epoch: 33 cost time: 1.268343448638916
Epoch: 33, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.077 Vali Acc: 0.195 Test Loss: 3.077 Test Acc: 0.195
Validation loss decreased (-0.192910 --> -0.195263).  Saving model ...
Epoch: 34 cost time: 1.2076780796051025
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.097 Vali Acc: 0.184 Test Loss: 3.097 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4176363945007324
Epoch: 35, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.135 Vali Acc: 0.184 Test Loss: 3.135 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3763031959533691
Epoch: 36, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.123 Vali Acc: 0.184 Test Loss: 3.123 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0003857612609863
Epoch: 37, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.125 Vali Acc: 0.178 Test Loss: 3.125 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2767446041107178
Epoch: 38, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.119 Vali Acc: 0.192 Test Loss: 3.119 Test Acc: 0.192
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1746726036071777
Epoch: 39, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.133 Vali Acc: 0.192 Test Loss: 3.133 Test Acc: 0.192
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3955416679382324
Epoch: 40, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.145 Vali Acc: 0.182 Test Loss: 3.145 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2810227870941162
Epoch: 41, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.154 Vali Acc: 0.193 Test Loss: 3.154 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2929999828338623
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.156 Vali Acc: 0.193 Test Loss: 3.156 Test Acc: 0.193
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3910465240478516
Epoch: 43, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.161 Vali Acc: 0.189 Test Loss: 3.161 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1952941176470588
model parameter : 645070
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8097822666168213
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.306 Vali Acc: 0.027 Test Loss: 3.306 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 1.3985168933868408
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.292 Vali Acc: 0.035 Test Loss: 3.292 Test Acc: 0.035
Validation loss decreased (-0.027026 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.0264482498168945
Epoch: 3, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.278 Vali Acc: 0.042 Test Loss: 3.278 Test Acc: 0.042
Validation loss decreased (-0.035261 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 1.3347711563110352
Epoch: 4, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.264 Vali Acc: 0.045 Test Loss: 3.264 Test Acc: 0.045
Validation loss decreased (-0.042320 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 1.0507879257202148
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.255 Vali Acc: 0.054 Test Loss: 3.255 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 1.1199977397918701
Epoch: 6, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.246 Vali Acc: 0.065 Test Loss: 3.246 Test Acc: 0.065
Validation loss decreased (-0.054085 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 0.977264404296875
Epoch: 7, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.238 Vali Acc: 0.078 Test Loss: 3.238 Test Acc: 0.078
Validation loss decreased (-0.064673 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 1.1157174110412598
Epoch: 8, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.233 Vali Acc: 0.088 Test Loss: 3.233 Test Acc: 0.088
Validation loss decreased (-0.077615 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 1.2699847221374512
Epoch: 9, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.226 Vali Acc: 0.089 Test Loss: 3.226 Test Acc: 0.089
Validation loss decreased (-0.088203 --> -0.089380).  Saving model ...
Epoch: 10 cost time: 1.0496008396148682
Epoch: 10, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.227 Vali Acc: 0.096 Test Loss: 3.227 Test Acc: 0.096
Validation loss decreased (-0.089380 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.914818286895752
Epoch: 11, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.223 Vali Acc: 0.096 Test Loss: 3.223 Test Acc: 0.096
Validation loss decreased (-0.096438 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 1.0126185417175293
Epoch: 12, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.218 Vali Acc: 0.100 Test Loss: 3.218 Test Acc: 0.100
Validation loss decreased (-0.096438 --> -0.099968).  Saving model ...
Epoch: 13 cost time: 1.1663899421691895
Epoch: 13, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.221 Vali Acc: 0.101 Test Loss: 3.221 Test Acc: 0.101
Validation loss decreased (-0.099968 --> -0.101144).  Saving model ...
Epoch: 14 cost time: 0.9516642093658447
Epoch: 14, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.212 Vali Acc: 0.111 Test Loss: 3.212 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 15 cost time: 1.346972942352295
Epoch: 15, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.213 Vali Acc: 0.113 Test Loss: 3.213 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.957390546798706
Epoch: 16, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.212 Vali Acc: 0.118 Test Loss: 3.212 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 17 cost time: 1.3603739738464355
Epoch: 17, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.198 Vali Acc: 0.128 Test Loss: 3.198 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 1.1183702945709229
Epoch: 18, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.190 Vali Acc: 0.133 Test Loss: 3.190 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 19 cost time: 1.15932035446167
Epoch: 19, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.190 Vali Acc: 0.124 Test Loss: 3.190 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0291249752044678
Epoch: 20, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.181 Vali Acc: 0.136 Test Loss: 3.181 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136439).  Saving model ...
Epoch: 21 cost time: 1.1645236015319824
Epoch: 21, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.192 Vali Acc: 0.145 Test Loss: 3.192 Test Acc: 0.145
Validation loss decreased (-0.136439 --> -0.144674).  Saving model ...
Epoch: 22 cost time: 1.2854878902435303
Epoch: 22, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.179 Vali Acc: 0.155 Test Loss: 3.179 Test Acc: 0.155
Validation loss decreased (-0.144674 --> -0.155262).  Saving model ...
Epoch: 23 cost time: 1.2541844844818115
Epoch: 23, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.190 Vali Acc: 0.149 Test Loss: 3.190 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3772687911987305
Epoch: 24, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.194 Vali Acc: 0.139 Test Loss: 3.194 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1491436958312988
Epoch: 25, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.197 Vali Acc: 0.146 Test Loss: 3.197 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6711788177490234
Epoch: 26, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.189 Vali Acc: 0.138 Test Loss: 3.189 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.183779001235962
Epoch: 27, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.200 Vali Acc: 0.146 Test Loss: 3.200 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2223243713378906
Epoch: 28, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.180 Vali Acc: 0.146 Test Loss: 3.180 Test Acc: 0.146
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2869555950164795
Epoch: 29, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.185 Vali Acc: 0.146 Test Loss: 3.185 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0572929382324219
Epoch: 30, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.190 Vali Acc: 0.159 Test Loss: 3.190 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158792).  Saving model ...
Epoch: 31 cost time: 0.9916501045227051
Epoch: 31, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.222 Vali Acc: 0.142 Test Loss: 3.222 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2691121101379395
Epoch: 32, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.214 Vali Acc: 0.148 Test Loss: 3.214 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0943562984466553
Epoch: 33, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.226 Vali Acc: 0.138 Test Loss: 3.226 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0827527046203613
Epoch: 34, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.247 Vali Acc: 0.141 Test Loss: 3.247 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2770256996154785
Epoch: 35, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.247 Vali Acc: 0.140 Test Loss: 3.247 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9422392845153809
Epoch: 36, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.252 Vali Acc: 0.141 Test Loss: 3.252 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2492008209228516
Epoch: 37, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.252 Vali Acc: 0.153 Test Loss: 3.252 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9700853824615479
Epoch: 38, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.240 Vali Acc: 0.160 Test Loss: 3.240 Test Acc: 0.160
Validation loss decreased (-0.158792 --> -0.159968).  Saving model ...
Epoch: 39 cost time: 1.0484516620635986
Epoch: 39, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.255 Vali Acc: 0.169 Test Loss: 3.255 Test Acc: 0.169
Validation loss decreased (-0.159968 --> -0.169379).  Saving model ...
Epoch: 40 cost time: 1.3819820880889893
Epoch: 40, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.269 Vali Acc: 0.156 Test Loss: 3.269 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0660877227783203
Epoch: 41, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.290 Vali Acc: 0.155 Test Loss: 3.290 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4412543773651123
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.301 Vali Acc: 0.153 Test Loss: 3.301 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3629412651062012
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.317 Vali Acc: 0.159 Test Loss: 3.317 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3164241313934326
Epoch: 44, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.326 Vali Acc: 0.162 Test Loss: 3.326 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0638794898986816
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.340 Vali Acc: 0.145 Test Loss: 3.340 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3215153217315674
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.341 Vali Acc: 0.155 Test Loss: 3.341 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6724488735198975
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.346 Vali Acc: 0.154 Test Loss: 3.346 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.038755178451538
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.348 Vali Acc: 0.154 Test Loss: 3.348 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2364943027496338
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.354 Vali Acc: 0.155 Test Loss: 3.354 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16941176470588235
model parameter : 643022
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7433409690856934
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.325 Vali Acc: 0.039 Test Loss: 3.325 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.9245281219482422
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.311 Vali Acc: 0.047 Test Loss: 3.311 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.8860652446746826
Epoch: 3, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.288 Vali Acc: 0.051 Test Loss: 3.288 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.8247923851013184
Epoch: 4, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.282 Vali Acc: 0.065 Test Loss: 3.282 Test Acc: 0.065
Validation loss decreased (-0.050555 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.1102180480957031
Epoch: 5, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.268 Vali Acc: 0.060 Test Loss: 3.268 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0730535984039307
Epoch: 6, Steps: 10 | Train Loss: 2.623 Vali Loss: 3.260 Vali Acc: 0.076 Test Loss: 3.260 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.8081953525543213
Epoch: 7, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.252 Vali Acc: 0.076 Test Loss: 3.252 Test Acc: 0.076
Validation loss decreased (-0.076438 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 1.6245906352996826
Epoch: 8, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.236 Vali Acc: 0.079 Test Loss: 3.236 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 9 cost time: 0.856623649597168
Epoch: 9, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.223 Vali Acc: 0.084 Test Loss: 3.223 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 1.4151337146759033
Epoch: 10, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.221 Vali Acc: 0.085 Test Loss: 3.221 Test Acc: 0.085
Validation loss decreased (-0.083497 --> -0.084674).  Saving model ...
Epoch: 11 cost time: 1.157975196838379
Epoch: 11, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.222 Vali Acc: 0.099 Test Loss: 3.222 Test Acc: 0.099
Validation loss decreased (-0.084674 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 0.9776344299316406
Epoch: 12, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.219 Vali Acc: 0.101 Test Loss: 3.219 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 13 cost time: 1.1389756202697754
Epoch: 13, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.198 Vali Acc: 0.112 Test Loss: 3.198 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111733).  Saving model ...
Epoch: 14 cost time: 1.3094055652618408
Epoch: 14, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.192 Vali Acc: 0.120 Test Loss: 3.192 Test Acc: 0.120
Validation loss decreased (-0.111733 --> -0.119968).  Saving model ...
Epoch: 15 cost time: 1.008317232131958
Epoch: 15, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.194 Vali Acc: 0.121 Test Loss: 3.194 Test Acc: 0.121
Validation loss decreased (-0.119968 --> -0.121145).  Saving model ...
Epoch: 16 cost time: 0.9557907581329346
Epoch: 16, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.196 Vali Acc: 0.124 Test Loss: 3.196 Test Acc: 0.124
Validation loss decreased (-0.121145 --> -0.123497).  Saving model ...
Epoch: 17 cost time: 1.0216076374053955
Epoch: 17, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.183 Vali Acc: 0.127 Test Loss: 3.183 Test Acc: 0.127
Validation loss decreased (-0.123497 --> -0.127027).  Saving model ...
Epoch: 18 cost time: 0.968468427658081
Epoch: 18, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.197 Vali Acc: 0.135 Test Loss: 3.197 Test Acc: 0.135
Validation loss decreased (-0.127027 --> -0.135262).  Saving model ...
Epoch: 19 cost time: 1.124964714050293
Epoch: 19, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.181 Vali Acc: 0.144 Test Loss: 3.181 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143498).  Saving model ...
Epoch: 20 cost time: 0.9705579280853271
Epoch: 20, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.178 Vali Acc: 0.146 Test Loss: 3.178 Test Acc: 0.146
Validation loss decreased (-0.143498 --> -0.145851).  Saving model ...
Epoch: 21 cost time: 1.023425579071045
Epoch: 21, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.168 Vali Acc: 0.148 Test Loss: 3.168 Test Acc: 0.148
Validation loss decreased (-0.145851 --> -0.148204).  Saving model ...
Epoch: 22 cost time: 0.9359228610992432
Epoch: 22, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.178 Vali Acc: 0.159 Test Loss: 3.178 Test Acc: 0.159
Validation loss decreased (-0.148204 --> -0.158792).  Saving model ...
Epoch: 23 cost time: 1.0365183353424072
Epoch: 23, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.160 Vali Acc: 0.161 Test Loss: 3.160 Test Acc: 0.161
Validation loss decreased (-0.158792 --> -0.161145).  Saving model ...
Epoch: 24 cost time: 1.152890920639038
Epoch: 24, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.201 Vali Acc: 0.158 Test Loss: 3.201 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9186527729034424
Epoch: 25, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.185 Vali Acc: 0.176 Test Loss: 3.185 Test Acc: 0.176
Validation loss decreased (-0.161145 --> -0.176439).  Saving model ...
Epoch: 26 cost time: 1.0994398593902588
Epoch: 26, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.164 Vali Acc: 0.182 Test Loss: 3.164 Test Acc: 0.182
Validation loss decreased (-0.176439 --> -0.182321).  Saving model ...
Epoch: 27 cost time: 0.9749152660369873
Epoch: 27, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.182 Vali Acc: 0.175 Test Loss: 3.182 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8770689964294434
Epoch: 28, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.206 Vali Acc: 0.174 Test Loss: 3.206 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.231372356414795
Epoch: 29, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.236 Vali Acc: 0.171 Test Loss: 3.236 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2426674365997314
Epoch: 30, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.253 Vali Acc: 0.175 Test Loss: 3.253 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0719168186187744
Epoch: 31, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.253 Vali Acc: 0.185 Test Loss: 3.253 Test Acc: 0.185
Validation loss decreased (-0.182321 --> -0.184673).  Saving model ...
Epoch: 32 cost time: 1.0079214572906494
Epoch: 32, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.265 Vali Acc: 0.185 Test Loss: 3.265 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1856369972229004
Epoch: 33, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.292 Vali Acc: 0.184 Test Loss: 3.292 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9549193382263184
Epoch: 34, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.305 Vali Acc: 0.173 Test Loss: 3.305 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9718453884124756
Epoch: 35, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.317 Vali Acc: 0.167 Test Loss: 3.317 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2864353656768799
Epoch: 36, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.351 Vali Acc: 0.174 Test Loss: 3.351 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2353942394256592
Epoch: 37, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.364 Vali Acc: 0.169 Test Loss: 3.364 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8423705101013184
Epoch: 38, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.366 Vali Acc: 0.165 Test Loss: 3.366 Test Acc: 0.165
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8893387317657471
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.367 Vali Acc: 0.159 Test Loss: 3.367 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3545525074005127
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.385 Vali Acc: 0.159 Test Loss: 3.385 Test Acc: 0.159
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9657461643218994
Epoch: 41, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.409 Vali Acc: 0.172 Test Loss: 3.409 Test Acc: 0.172
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 638926
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8588268756866455
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.313 Vali Acc: 0.028 Test Loss: 3.313 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.079824447631836
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.298 Vali Acc: 0.035 Test Loss: 3.298 Test Acc: 0.035
Validation loss decreased (-0.028202 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.0586988925933838
Epoch: 3, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.284 Vali Acc: 0.035 Test Loss: 3.284 Test Acc: 0.035
Validation loss decreased (-0.035261 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 1.0281567573547363
Epoch: 4, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.268 Vali Acc: 0.051 Test Loss: 3.268 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 1.06111741065979
Epoch: 5, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.252 Vali Acc: 0.056 Test Loss: 3.252 Test Acc: 0.056
Validation loss decreased (-0.050556 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 1.0258753299713135
Epoch: 6, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.243 Vali Acc: 0.075 Test Loss: 3.243 Test Acc: 0.075
Validation loss decreased (-0.056438 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 0.9869506359100342
Epoch: 7, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.231 Vali Acc: 0.081 Test Loss: 3.231 Test Acc: 0.081
Validation loss decreased (-0.075262 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.9388906955718994
Epoch: 8, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.222 Vali Acc: 0.094 Test Loss: 3.222 Test Acc: 0.094
Validation loss decreased (-0.081144 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 1.024540901184082
Epoch: 9, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.216 Vali Acc: 0.109 Test Loss: 3.216 Test Acc: 0.109
Validation loss decreased (-0.094085 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 0.991966962814331
Epoch: 10, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.204 Vali Acc: 0.113 Test Loss: 3.204 Test Acc: 0.113
Validation loss decreased (-0.109380 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.8630387783050537
Epoch: 11, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.191 Vali Acc: 0.126 Test Loss: 3.191 Test Acc: 0.126
Validation loss decreased (-0.112909 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 0.8451189994812012
Epoch: 12, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.185 Vali Acc: 0.132 Test Loss: 3.185 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131733).  Saving model ...
Epoch: 13 cost time: 0.8980534076690674
Epoch: 13, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.167 Vali Acc: 0.135 Test Loss: 3.167 Test Acc: 0.135
Validation loss decreased (-0.131733 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 0.8091022968292236
Epoch: 14, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.166 Vali Acc: 0.140 Test Loss: 3.166 Test Acc: 0.140
Validation loss decreased (-0.135262 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.9591338634490967
Epoch: 15, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.165 Vali Acc: 0.147 Test Loss: 3.165 Test Acc: 0.147
Validation loss decreased (-0.139968 --> -0.147027).  Saving model ...
Epoch: 16 cost time: 1.0154635906219482
Epoch: 16, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.158 Vali Acc: 0.148 Test Loss: 3.158 Test Acc: 0.148
Validation loss decreased (-0.147027 --> -0.148204).  Saving model ...
Epoch: 17 cost time: 0.8228309154510498
Epoch: 17, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.148 Vali Acc: 0.145 Test Loss: 3.148 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0885083675384521
Epoch: 18, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.144 Vali Acc: 0.160 Test Loss: 3.144 Test Acc: 0.160
Validation loss decreased (-0.148204 --> -0.159969).  Saving model ...
Epoch: 19 cost time: 1.0700225830078125
Epoch: 19, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.135 Vali Acc: 0.153 Test Loss: 3.135 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0074963569641113
Epoch: 20, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.130 Vali Acc: 0.162 Test Loss: 3.130 Test Acc: 0.162
Validation loss decreased (-0.159969 --> -0.162322).  Saving model ...
Epoch: 21 cost time: 1.021789312362671
Epoch: 21, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.123 Vali Acc: 0.174 Test Loss: 3.123 Test Acc: 0.174
Validation loss decreased (-0.162322 --> -0.174086).  Saving model ...
Epoch: 22 cost time: 0.9651546478271484
Epoch: 22, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.132 Vali Acc: 0.172 Test Loss: 3.132 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0445826053619385
Epoch: 23, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.142 Vali Acc: 0.162 Test Loss: 3.142 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.120811939239502
Epoch: 24, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.139 Vali Acc: 0.164 Test Loss: 3.139 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.143955945968628
Epoch: 25, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.155 Vali Acc: 0.165 Test Loss: 3.155 Test Acc: 0.165
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9547345638275146
Epoch: 26, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.166 Vali Acc: 0.161 Test Loss: 3.166 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1671996116638184
Epoch: 27, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.161 Vali Acc: 0.171 Test Loss: 3.161 Test Acc: 0.171
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.075693130493164
Epoch: 28, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.168 Vali Acc: 0.168 Test Loss: 3.168 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9874036312103271
Epoch: 29, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.162 Vali Acc: 0.174 Test Loss: 3.162 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2511162757873535
Epoch: 30, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.175 Vali Acc: 0.172 Test Loss: 3.175 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9676525592803955
Epoch: 31, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.188 Vali Acc: 0.168 Test Loss: 3.188 Test Acc: 0.168
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17411764705882352
model parameter : 636878
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.795701026916504
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.315 Vali Acc: 0.042 Test Loss: 3.315 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.695690393447876
Epoch: 2, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.275 Vali Acc: 0.053 Test Loss: 3.275 Test Acc: 0.053
Validation loss decreased (-0.042320 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.7149934768676758
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.255 Vali Acc: 0.064 Test Loss: 3.255 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 1.935816764831543
Epoch: 4, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.240 Vali Acc: 0.085 Test Loss: 3.240 Test Acc: 0.085
Validation loss decreased (-0.063497 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.4951565265655518
Epoch: 5, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.236 Vali Acc: 0.084 Test Loss: 3.236 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.152198553085327
Epoch: 6, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.220 Vali Acc: 0.096 Test Loss: 3.220 Test Acc: 0.096
Validation loss decreased (-0.084673 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 1.711230754852295
Epoch: 7, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.214 Vali Acc: 0.089 Test Loss: 3.214 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.739220380783081
Epoch: 8, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.227 Vali Acc: 0.087 Test Loss: 3.227 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8166658878326416
Epoch: 9, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.226 Vali Acc: 0.092 Test Loss: 3.226 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.938807487487793
Epoch: 10, Steps: 10 | Train Loss: 2.139 Vali Loss: 3.214 Vali Acc: 0.107 Test Loss: 3.214 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107027).  Saving model ...
Epoch: 11 cost time: 1.8314354419708252
Epoch: 11, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.219 Vali Acc: 0.093 Test Loss: 3.219 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7185091972351074
Epoch: 12, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.220 Vali Acc: 0.102 Test Loss: 3.220 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2945284843444824
Epoch: 13, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.228 Vali Acc: 0.115 Test Loss: 3.228 Test Acc: 0.115
Validation loss decreased (-0.107027 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 1.8520514965057373
Epoch: 14, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.219 Vali Acc: 0.113 Test Loss: 3.219 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.955798864364624
Epoch: 15, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.228 Vali Acc: 0.119 Test Loss: 3.228 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 1.5688271522521973
Epoch: 16, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.245 Vali Acc: 0.116 Test Loss: 3.245 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1477625370025635
Epoch: 17, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.118791 --> -0.131732).  Saving model ...
Epoch: 18 cost time: 1.8430161476135254
Epoch: 18, Steps: 10 | Train Loss: 1.458 Vali Loss: 3.261 Vali Acc: 0.122 Test Loss: 3.261 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.842437982559204
Epoch: 19, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.258 Vali Acc: 0.119 Test Loss: 3.258 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7755002975463867
Epoch: 20, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.245 Vali Acc: 0.129 Test Loss: 3.245 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.049572467803955
Epoch: 21, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.244 Vali Acc: 0.126 Test Loss: 3.244 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.187621831893921
Epoch: 22, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5730183124542236
Epoch: 23, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.280 Vali Acc: 0.126 Test Loss: 3.280 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.903764247894287
Epoch: 24, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.276 Vali Acc: 0.128 Test Loss: 3.276 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.944915533065796
Epoch: 25, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.295 Vali Acc: 0.135 Test Loss: 3.295 Test Acc: 0.135
Validation loss decreased (-0.131732 --> -0.135261).  Saving model ...
Epoch: 26 cost time: 2.2763290405273438
Epoch: 26, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.285 Vali Acc: 0.135 Test Loss: 3.285 Test Acc: 0.135
Validation loss decreased (-0.135261 --> -0.135261).  Saving model ...
Epoch: 27 cost time: 1.8104209899902344
Epoch: 27, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.317 Vali Acc: 0.134 Test Loss: 3.317 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.077609062194824
Epoch: 28, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.332 Vali Acc: 0.141 Test Loss: 3.332 Test Acc: 0.141
Validation loss decreased (-0.135261 --> -0.141143).  Saving model ...
Epoch: 29 cost time: 1.784902572631836
Epoch: 29, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.355 Vali Acc: 0.152 Test Loss: 3.355 Test Acc: 0.152
Validation loss decreased (-0.141143 --> -0.151731).  Saving model ...
Epoch: 30 cost time: 2.128502368927002
Epoch: 30, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.365 Vali Acc: 0.154 Test Loss: 3.365 Test Acc: 0.154
Validation loss decreased (-0.151731 --> -0.154084).  Saving model ...
Epoch: 31 cost time: 1.6031837463378906
Epoch: 31, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.416 Vali Acc: 0.147 Test Loss: 3.416 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.978700876235962
Epoch: 32, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.423 Vali Acc: 0.149 Test Loss: 3.423 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.301511764526367
Epoch: 33, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.461 Vali Acc: 0.153 Test Loss: 3.461 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6863863468170166
Epoch: 34, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.481 Vali Acc: 0.151 Test Loss: 3.481 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.892836332321167
Epoch: 35, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.468 Vali Acc: 0.151 Test Loss: 3.468 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.9919846057891846
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.518 Vali Acc: 0.160 Test Loss: 3.518 Test Acc: 0.160
Validation loss decreased (-0.154084 --> -0.159965).  Saving model ...
Epoch: 37 cost time: 1.6034417152404785
Epoch: 37, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.545 Vali Acc: 0.148 Test Loss: 3.545 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4977822303771973
Epoch: 38, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.553 Vali Acc: 0.151 Test Loss: 3.553 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5733766555786133
Epoch: 39, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.600 Vali Acc: 0.145 Test Loss: 3.600 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7730748653411865
Epoch: 40, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.626 Vali Acc: 0.162 Test Loss: 3.626 Test Acc: 0.162
Validation loss decreased (-0.159965 --> -0.162317).  Saving model ...
Epoch: 41 cost time: 1.5274426937103271
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.637 Vali Acc: 0.153 Test Loss: 3.637 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.366230010986328
Epoch: 42, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.661 Vali Acc: 0.155 Test Loss: 3.661 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0054028034210205
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.696 Vali Acc: 0.152 Test Loss: 3.696 Test Acc: 0.152
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5103416442871094
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.700 Vali Acc: 0.154 Test Loss: 3.700 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.3335037231445312
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.700 Vali Acc: 0.152 Test Loss: 3.700 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.605715036392212
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.705 Vali Acc: 0.151 Test Loss: 3.705 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.2670156955718994
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.720 Vali Acc: 0.151 Test Loss: 3.720 Test Acc: 0.151
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.815046787261963
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.738 Vali Acc: 0.158 Test Loss: 3.738 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.7211573123931885
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.745 Vali Acc: 0.156 Test Loss: 3.745 Test Acc: 0.156
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.9339661598205566
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.755 Vali Acc: 0.156 Test Loss: 3.755 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1623529411764706
model parameter : 673708
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.356699228286743
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.318 Vali Acc: 0.036 Test Loss: 3.318 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.3515937328338623
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.293 Vali Acc: 0.033 Test Loss: 3.293 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.650679111480713
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.266 Vali Acc: 0.049 Test Loss: 3.266 Test Acc: 0.049
Validation loss decreased (-0.036437 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.4094908237457275
Epoch: 4, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.229 Vali Acc: 0.059 Test Loss: 3.229 Test Acc: 0.059
Validation loss decreased (-0.049379 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.4706964492797852
Epoch: 5, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.216 Vali Acc: 0.067 Test Loss: 3.216 Test Acc: 0.067
Validation loss decreased (-0.058791 --> -0.067027).  Saving model ...
Epoch: 6 cost time: 1.426581859588623
Epoch: 6, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.211 Vali Acc: 0.071 Test Loss: 3.211 Test Acc: 0.071
Validation loss decreased (-0.067027 --> -0.070556).  Saving model ...
Epoch: 7 cost time: 1.405134916305542
Epoch: 7, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.207 Vali Acc: 0.080 Test Loss: 3.207 Test Acc: 0.080
Validation loss decreased (-0.070556 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 1.2537622451782227
Epoch: 8, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.205 Vali Acc: 0.081 Test Loss: 3.205 Test Acc: 0.081
Validation loss decreased (-0.079968 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.6085302829742432
Epoch: 9, Steps: 10 | Train Loss: 2.217 Vali Loss: 3.202 Vali Acc: 0.094 Test Loss: 3.202 Test Acc: 0.094
Validation loss decreased (-0.081144 --> -0.094086).  Saving model ...
Epoch: 10 cost time: 1.4813485145568848
Epoch: 10, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.217 Vali Acc: 0.106 Test Loss: 3.217 Test Acc: 0.106
Validation loss decreased (-0.094086 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 1.6218645572662354
Epoch: 11, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.222 Vali Acc: 0.092 Test Loss: 3.222 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5778768062591553
Epoch: 12, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.217 Vali Acc: 0.107 Test Loss: 3.217 Test Acc: 0.107
Validation loss decreased (-0.105850 --> -0.107027).  Saving model ...
Epoch: 13 cost time: 1.332235336303711
Epoch: 13, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.224 Vali Acc: 0.106 Test Loss: 3.224 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6236751079559326
Epoch: 14, Steps: 10 | Train Loss: 1.822 Vali Loss: 3.216 Vali Acc: 0.106 Test Loss: 3.216 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7203781604766846
Epoch: 15, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.215 Vali Acc: 0.113 Test Loss: 3.215 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 1.801269292831421
Epoch: 16, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.211 Vali Acc: 0.124 Test Loss: 3.211 Test Acc: 0.124
Validation loss decreased (-0.112909 --> -0.123497).  Saving model ...
Epoch: 17 cost time: 1.464966058731079
Epoch: 17, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.224 Vali Acc: 0.113 Test Loss: 3.224 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.083491325378418
Epoch: 18, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.241 Vali Acc: 0.115 Test Loss: 3.241 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4910228252410889
Epoch: 19, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.245 Vali Acc: 0.113 Test Loss: 3.245 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5102128982543945
Epoch: 20, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.242 Vali Acc: 0.115 Test Loss: 3.242 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7210602760314941
Epoch: 21, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.258 Vali Acc: 0.118 Test Loss: 3.258 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.499755620956421
Epoch: 22, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.272 Vali Acc: 0.124 Test Loss: 3.272 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.442476749420166
Epoch: 23, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.275 Vali Acc: 0.120 Test Loss: 3.275 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.739055871963501
Epoch: 24, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.279 Vali Acc: 0.131 Test Loss: 3.279 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130555).  Saving model ...
Epoch: 25 cost time: 1.3871593475341797
Epoch: 25, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7184958457946777
Epoch: 26, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.318 Vali Acc: 0.128 Test Loss: 3.318 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4818615913391113
Epoch: 27, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.323 Vali Acc: 0.129 Test Loss: 3.323 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5053400993347168
Epoch: 28, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.314 Vali Acc: 0.139 Test Loss: 3.314 Test Acc: 0.139
Validation loss decreased (-0.130555 --> -0.138790).  Saving model ...
Epoch: 29 cost time: 1.714024543762207
Epoch: 29, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.329 Vali Acc: 0.135 Test Loss: 3.329 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.427091360092163
Epoch: 30, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.333 Vali Acc: 0.136 Test Loss: 3.333 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.706514596939087
Epoch: 31, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.356 Vali Acc: 0.140 Test Loss: 3.356 Test Acc: 0.140
Validation loss decreased (-0.138790 --> -0.139966).  Saving model ...
Epoch: 32 cost time: 1.7561495304107666
Epoch: 32, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.357 Vali Acc: 0.141 Test Loss: 3.357 Test Acc: 0.141
Validation loss decreased (-0.139966 --> -0.141143).  Saving model ...
Epoch: 33 cost time: 2.021056652069092
Epoch: 33, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.376 Vali Acc: 0.141 Test Loss: 3.376 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7370474338531494
Epoch: 34, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.396 Vali Acc: 0.139 Test Loss: 3.396 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.646801233291626
Epoch: 35, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.441 Vali Acc: 0.138 Test Loss: 3.441 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7363197803497314
Epoch: 36, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.492 Vali Acc: 0.132 Test Loss: 3.492 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4719288349151611
Epoch: 37, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.490 Vali Acc: 0.139 Test Loss: 3.490 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5550663471221924
Epoch: 38, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.518 Vali Acc: 0.141 Test Loss: 3.518 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8075575828552246
Epoch: 39, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.583 Vali Acc: 0.139 Test Loss: 3.583 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.744241714477539
Epoch: 40, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.603 Vali Acc: 0.136 Test Loss: 3.603 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.739100456237793
Epoch: 41, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.616 Vali Acc: 0.129 Test Loss: 3.616 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6648764610290527
Epoch: 42, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.585 Vali Acc: 0.146 Test Loss: 3.585 Test Acc: 0.146
Validation loss decreased (-0.141143 --> -0.145847).  Saving model ...
Epoch: 43 cost time: 1.524003505706787
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.599 Vali Acc: 0.154 Test Loss: 3.599 Test Acc: 0.154
Validation loss decreased (-0.145847 --> -0.154082).  Saving model ...
Epoch: 44 cost time: 1.4532272815704346
Epoch: 44, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.633 Vali Acc: 0.145 Test Loss: 3.633 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4333815574645996
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.669 Vali Acc: 0.149 Test Loss: 3.669 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3185818195343018
Epoch: 46, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.688 Vali Acc: 0.145 Test Loss: 3.688 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5434019565582275
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.684 Vali Acc: 0.144 Test Loss: 3.684 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5716180801391602
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.694 Vali Acc: 0.146 Test Loss: 3.694 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3703880310058594
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.703 Vali Acc: 0.144 Test Loss: 3.703 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6265645027160645
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.705 Vali Acc: 0.140 Test Loss: 3.705 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6212570667266846
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.705 Vali Acc: 0.154 Test Loss: 3.705 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.618453025817871
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.709 Vali Acc: 0.151 Test Loss: 3.709 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.774435043334961
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.724 Vali Acc: 0.147 Test Loss: 3.724 Test Acc: 0.147
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15411764705882353
model parameter : 667564
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4807276725769043
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.308 Vali Acc: 0.052 Test Loss: 3.308 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 1.6184587478637695
Epoch: 2, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.289 Vali Acc: 0.056 Test Loss: 3.289 Test Acc: 0.056
Validation loss decreased (-0.051732 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.3969967365264893
Epoch: 3, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.282 Vali Acc: 0.054 Test Loss: 3.282 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.615067720413208
Epoch: 4, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.265 Vali Acc: 0.055 Test Loss: 3.265 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8393445014953613
Epoch: 5, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.249 Vali Acc: 0.069 Test Loss: 3.249 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 1.5464653968811035
Epoch: 6, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.242 Vali Acc: 0.085 Test Loss: 3.242 Test Acc: 0.085
Validation loss decreased (-0.069379 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 1.551070213317871
Epoch: 7, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.236 Vali Acc: 0.089 Test Loss: 3.236 Test Acc: 0.089
Validation loss decreased (-0.084673 --> -0.089379).  Saving model ...
Epoch: 8 cost time: 1.7006466388702393
Epoch: 8, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.230 Vali Acc: 0.089 Test Loss: 3.230 Test Acc: 0.089
Validation loss decreased (-0.089379 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 1.710158348083496
Epoch: 9, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.229 Vali Acc: 0.099 Test Loss: 3.229 Test Acc: 0.099
Validation loss decreased (-0.089379 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 1.7571721076965332
Epoch: 10, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.225 Vali Acc: 0.107 Test Loss: 3.225 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 11 cost time: 1.606165885925293
Epoch: 11, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.228 Vali Acc: 0.101 Test Loss: 3.228 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4336538314819336
Epoch: 12, Steps: 10 | Train Loss: 1.813 Vali Loss: 3.226 Vali Acc: 0.116 Test Loss: 3.226 Test Acc: 0.116
Validation loss decreased (-0.107027 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 1.1564064025878906
Epoch: 13, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.218 Vali Acc: 0.125 Test Loss: 3.218 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124674).  Saving model ...
Epoch: 14 cost time: 1.3491549491882324
Epoch: 14, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.221 Vali Acc: 0.105 Test Loss: 3.221 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.645359754562378
Epoch: 15, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.212 Vali Acc: 0.106 Test Loss: 3.212 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5617563724517822
Epoch: 16, Steps: 10 | Train Loss: 1.498 Vali Loss: 3.240 Vali Acc: 0.112 Test Loss: 3.240 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.495419979095459
Epoch: 17, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.238 Vali Acc: 0.125 Test Loss: 3.238 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2521674633026123
Epoch: 18, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.217 Vali Acc: 0.124 Test Loss: 3.217 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.440638780593872
Epoch: 19, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.237 Vali Acc: 0.125 Test Loss: 3.237 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3491711616516113
Epoch: 20, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.212 Vali Acc: 0.138 Test Loss: 3.212 Test Acc: 0.138
Validation loss decreased (-0.124674 --> -0.137615).  Saving model ...
Epoch: 21 cost time: 1.635420322418213
Epoch: 21, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.225 Vali Acc: 0.134 Test Loss: 3.225 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1694214344024658
Epoch: 22, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.236 Vali Acc: 0.127 Test Loss: 3.236 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1922123432159424
Epoch: 23, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.226 Vali Acc: 0.138 Test Loss: 3.226 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4273803234100342
Epoch: 24, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.239 Vali Acc: 0.136 Test Loss: 3.239 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2579123973846436
Epoch: 25, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.242 Vali Acc: 0.146 Test Loss: 3.242 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145850).  Saving model ...
Epoch: 26 cost time: 1.3572826385498047
Epoch: 26, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.264 Vali Acc: 0.146 Test Loss: 3.264 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5232360363006592
Epoch: 27, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.287 Vali Acc: 0.154 Test Loss: 3.287 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 28 cost time: 1.4790189266204834
Epoch: 28, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.284 Vali Acc: 0.151 Test Loss: 3.284 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5060524940490723
Epoch: 29, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.293 Vali Acc: 0.148 Test Loss: 3.293 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.614199161529541
Epoch: 30, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.301 Vali Acc: 0.151 Test Loss: 3.301 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.58705735206604
Epoch: 31, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.320 Vali Acc: 0.148 Test Loss: 3.320 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1649434566497803
Epoch: 32, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.321 Vali Acc: 0.152 Test Loss: 3.321 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4247124195098877
Epoch: 33, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.332 Vali Acc: 0.162 Test Loss: 3.332 Test Acc: 0.162
Validation loss decreased (-0.154085 --> -0.162320).  Saving model ...
Epoch: 34 cost time: 1.4403877258300781
Epoch: 34, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.339 Vali Acc: 0.160 Test Loss: 3.339 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2295470237731934
Epoch: 35, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.395 Vali Acc: 0.141 Test Loss: 3.395 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1226005554199219
Epoch: 36, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.398 Vali Acc: 0.152 Test Loss: 3.398 Test Acc: 0.152
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2860379219055176
Epoch: 37, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.425 Vali Acc: 0.166 Test Loss: 3.425 Test Acc: 0.166
Validation loss decreased (-0.162320 --> -0.165848).  Saving model ...
Epoch: 38 cost time: 1.0476140975952148
Epoch: 38, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.429 Vali Acc: 0.165 Test Loss: 3.429 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2370643615722656
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.445 Vali Acc: 0.167 Test Loss: 3.445 Test Acc: 0.167
Validation loss decreased (-0.165848 --> -0.167024).  Saving model ...
Epoch: 40 cost time: 1.3066294193267822
Epoch: 40, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.470 Vali Acc: 0.159 Test Loss: 3.470 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9121739864349365
Epoch: 41, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.475 Vali Acc: 0.172 Test Loss: 3.475 Test Acc: 0.172
Validation loss decreased (-0.167024 --> -0.171730).  Saving model ...
Epoch: 42 cost time: 1.4550392627716064
Epoch: 42, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.482 Vali Acc: 0.171 Test Loss: 3.482 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4883959293365479
Epoch: 43, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.496 Vali Acc: 0.166 Test Loss: 3.496 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5756795406341553
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.509 Vali Acc: 0.164 Test Loss: 3.509 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3695578575134277
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.509 Vali Acc: 0.173 Test Loss: 3.509 Test Acc: 0.173
Validation loss decreased (-0.171730 --> -0.172906).  Saving model ...
Epoch: 46 cost time: 1.5052876472473145
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.510 Vali Acc: 0.168 Test Loss: 3.510 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7298665046691895
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.514 Vali Acc: 0.168 Test Loss: 3.514 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4589118957519531
Epoch: 48, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.522 Vali Acc: 0.172 Test Loss: 3.522 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.360921859741211
Epoch: 49, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.524 Vali Acc: 0.174 Test Loss: 3.524 Test Acc: 0.174
Validation loss decreased (-0.172906 --> -0.174082).  Saving model ...
Epoch: 50 cost time: 1.4165964126586914
Epoch: 50, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.530 Vali Acc: 0.175 Test Loss: 3.530 Test Acc: 0.175
Validation loss decreased (-0.174082 --> -0.175259).  Saving model ...
Epoch: 51 cost time: 1.4591095447540283
Epoch: 51, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.531 Vali Acc: 0.180 Test Loss: 3.531 Test Acc: 0.180
Validation loss decreased (-0.175259 --> -0.179965).  Saving model ...
Epoch: 52 cost time: 1.380082130432129
Epoch: 52, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.538 Vali Acc: 0.176 Test Loss: 3.538 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3777825832366943
Epoch: 53, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.542 Vali Acc: 0.169 Test Loss: 3.542 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.454596757888794
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.549 Vali Acc: 0.168 Test Loss: 3.549 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3578932285308838
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.548 Vali Acc: 0.171 Test Loss: 3.548 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2915232181549072
Epoch: 56, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.550 Vali Acc: 0.173 Test Loss: 3.550 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.4902429580688477
Epoch: 57, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.552 Vali Acc: 0.174 Test Loss: 3.552 Test Acc: 0.174
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.3289554119110107
Epoch: 58, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.554 Vali Acc: 0.168 Test Loss: 3.554 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.695920467376709
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.556 Vali Acc: 0.166 Test Loss: 3.556 Test Acc: 0.166
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.5650534629821777
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.560 Vali Acc: 0.167 Test Loss: 3.560 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.5320649147033691
Epoch: 61, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.564 Vali Acc: 0.168 Test Loss: 3.564 Test Acc: 0.168
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18
model parameter : 659372
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3535959720611572
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.332 Vali Acc: 0.042 Test Loss: 3.332 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.5881760120391846
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.311 Vali Acc: 0.048 Test Loss: 3.311 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 1.3544068336486816
Epoch: 3, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.288 Vali Acc: 0.053 Test Loss: 3.288 Test Acc: 0.053
Validation loss decreased (-0.048202 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.1944105625152588
Epoch: 4, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.265 Vali Acc: 0.054 Test Loss: 3.265 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 1.040776252746582
Epoch: 5, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.241 Vali Acc: 0.066 Test Loss: 3.241 Test Acc: 0.066
Validation loss decreased (-0.054085 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 1.0324888229370117
Epoch: 6, Steps: 10 | Train Loss: 2.330 Vali Loss: 3.232 Vali Acc: 0.076 Test Loss: 3.232 Test Acc: 0.076
Validation loss decreased (-0.065850 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.3577184677124023
Epoch: 7, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.227 Vali Acc: 0.093 Test Loss: 3.227 Test Acc: 0.093
Validation loss decreased (-0.076438 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.4712436199188232
Epoch: 8, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.200 Vali Acc: 0.094 Test Loss: 3.200 Test Acc: 0.094
Validation loss decreased (-0.092909 --> -0.094086).  Saving model ...
Epoch: 9 cost time: 0.985095739364624
Epoch: 9, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.200 Vali Acc: 0.102 Test Loss: 3.200 Test Acc: 0.102
Validation loss decreased (-0.094086 --> -0.102321).  Saving model ...
Epoch: 10 cost time: 1.0651578903198242
Epoch: 10, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.202 Vali Acc: 0.102 Test Loss: 3.202 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5666875839233398
Epoch: 11, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.199 Vali Acc: 0.113 Test Loss: 3.199 Test Acc: 0.113
Validation loss decreased (-0.102321 --> -0.112909).  Saving model ...
Epoch: 12 cost time: 1.6198418140411377
Epoch: 12, Steps: 10 | Train Loss: 1.649 Vali Loss: 3.212 Vali Acc: 0.107 Test Loss: 3.212 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2906928062438965
Epoch: 13, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.206 Vali Acc: 0.113 Test Loss: 3.206 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2728374004364014
Epoch: 14, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.200 Vali Acc: 0.111 Test Loss: 3.200 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3467090129852295
Epoch: 15, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.204 Vali Acc: 0.112 Test Loss: 3.204 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.078479290008545
Epoch: 16, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.207 Vali Acc: 0.128 Test Loss: 3.207 Test Acc: 0.128
Validation loss decreased (-0.112909 --> -0.128203).  Saving model ...
Epoch: 17 cost time: 1.4355838298797607
Epoch: 17, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.206 Vali Acc: 0.133 Test Loss: 3.206 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 18 cost time: 1.0124731063842773
Epoch: 18, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.224 Vali Acc: 0.132 Test Loss: 3.224 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.135474443435669
Epoch: 19, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.219 Vali Acc: 0.127 Test Loss: 3.219 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1451377868652344
Epoch: 20, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.225 Vali Acc: 0.126 Test Loss: 3.225 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3284637928009033
Epoch: 21, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.234 Vali Acc: 0.132 Test Loss: 3.234 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.005206823348999
Epoch: 22, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.222 Vali Acc: 0.126 Test Loss: 3.222 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.954655647277832
Epoch: 23, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.242 Vali Acc: 0.136 Test Loss: 3.242 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136438).  Saving model ...
Epoch: 24 cost time: 0.9269726276397705
Epoch: 24, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.250 Vali Acc: 0.147 Test Loss: 3.250 Test Acc: 0.147
Validation loss decreased (-0.136438 --> -0.147026).  Saving model ...
Epoch: 25 cost time: 1.055143117904663
Epoch: 25, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.231 Vali Acc: 0.155 Test Loss: 3.231 Test Acc: 0.155
Validation loss decreased (-0.147026 --> -0.155262).  Saving model ...
Epoch: 26 cost time: 1.1364028453826904
Epoch: 26, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.273 Vali Acc: 0.139 Test Loss: 3.273 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3985116481781006
Epoch: 27, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.250 Vali Acc: 0.149 Test Loss: 3.250 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0442547798156738
Epoch: 28, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.277 Vali Acc: 0.148 Test Loss: 3.277 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0878524780273438
Epoch: 29, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.295 Vali Acc: 0.158 Test Loss: 3.295 Test Acc: 0.158
Validation loss decreased (-0.155262 --> -0.157614).  Saving model ...
Epoch: 30 cost time: 1.3089079856872559
Epoch: 30, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.312 Vali Acc: 0.145 Test Loss: 3.312 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3995039463043213
Epoch: 31, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.323 Vali Acc: 0.151 Test Loss: 3.323 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2405345439910889
Epoch: 32, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.348 Vali Acc: 0.147 Test Loss: 3.348 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.697272777557373
Epoch: 33, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.355 Vali Acc: 0.154 Test Loss: 3.355 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6908164024353027
Epoch: 34, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.347 Vali Acc: 0.165 Test Loss: 3.347 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164672).  Saving model ...
Epoch: 35 cost time: 1.3341093063354492
Epoch: 35, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.346 Vali Acc: 0.171 Test Loss: 3.346 Test Acc: 0.171
Validation loss decreased (-0.164672 --> -0.170555).  Saving model ...
Epoch: 36 cost time: 1.1188549995422363
Epoch: 36, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.376 Vali Acc: 0.160 Test Loss: 3.376 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1744694709777832
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.388 Vali Acc: 0.156 Test Loss: 3.388 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2651503086090088
Epoch: 38, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.409 Vali Acc: 0.155 Test Loss: 3.409 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2601525783538818
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.425 Vali Acc: 0.152 Test Loss: 3.425 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3522679805755615
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.435 Vali Acc: 0.153 Test Loss: 3.435 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2485496997833252
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.437 Vali Acc: 0.154 Test Loss: 3.437 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3056995868682861
Epoch: 42, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.435 Vali Acc: 0.161 Test Loss: 3.435 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3272948265075684
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.427 Vali Acc: 0.168 Test Loss: 3.427 Test Acc: 0.168
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1667265892028809
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.423 Vali Acc: 0.168 Test Loss: 3.423 Test Acc: 0.168
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3172366619110107
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.432 Vali Acc: 0.165 Test Loss: 3.432 Test Acc: 0.165
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17058823529411765
model parameter : 651180
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.828028678894043
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.262 Vali Acc: 0.065 Test Loss: 3.262 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 1.0006709098815918
Epoch: 2, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.246 Vali Acc: 0.073 Test Loss: 3.246 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072909).  Saving model ...
Epoch: 3 cost time: 0.8996889591217041
Epoch: 3, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.232 Vali Acc: 0.072 Test Loss: 3.232 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.983734130859375
Epoch: 4, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.226 Vali Acc: 0.076 Test Loss: 3.226 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.042525053024292
Epoch: 5, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.207 Vali Acc: 0.089 Test Loss: 3.207 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089380).  Saving model ...
Epoch: 6 cost time: 0.8063209056854248
Epoch: 6, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.196 Vali Acc: 0.109 Test Loss: 3.196 Test Acc: 0.109
Validation loss decreased (-0.089380 --> -0.109380).  Saving model ...
Epoch: 7 cost time: 0.9976170063018799
Epoch: 7, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.193 Vali Acc: 0.102 Test Loss: 3.193 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9741737842559814
Epoch: 8, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.183 Vali Acc: 0.109 Test Loss: 3.183 Test Acc: 0.109
Validation loss decreased (-0.109380 --> -0.109380).  Saving model ...
Epoch: 9 cost time: 1.027592420578003
Epoch: 9, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.182 Vali Acc: 0.105 Test Loss: 3.182 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9432556629180908
Epoch: 10, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.174 Vali Acc: 0.107 Test Loss: 3.174 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9496936798095703
Epoch: 11, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.174 Vali Acc: 0.115 Test Loss: 3.174 Test Acc: 0.115
Validation loss decreased (-0.109380 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 1.0793635845184326
Epoch: 12, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.166 Vali Acc: 0.120 Test Loss: 3.166 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.9174578189849854
Epoch: 13, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.162 Vali Acc: 0.112 Test Loss: 3.162 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0573315620422363
Epoch: 14, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.181 Vali Acc: 0.122 Test Loss: 3.181 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122321).  Saving model ...
Epoch: 15 cost time: 0.8011858463287354
Epoch: 15, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.183 Vali Acc: 0.131 Test Loss: 3.183 Test Acc: 0.131
Validation loss decreased (-0.122321 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 1.0423617362976074
Epoch: 16, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.177 Vali Acc: 0.135 Test Loss: 3.177 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 0.9265820980072021
Epoch: 17, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.177 Vali Acc: 0.140 Test Loss: 3.177 Test Acc: 0.140
Validation loss decreased (-0.135262 --> -0.139968).  Saving model ...
Epoch: 18 cost time: 0.8173058032989502
Epoch: 18, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.190 Vali Acc: 0.140 Test Loss: 3.190 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1300969123840332
Epoch: 19, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.179 Vali Acc: 0.133 Test Loss: 3.179 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.058424472808838
Epoch: 20, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.180 Vali Acc: 0.141 Test Loss: 3.180 Test Acc: 0.141
Validation loss decreased (-0.139968 --> -0.141145).  Saving model ...
Epoch: 21 cost time: 1.2337257862091064
Epoch: 21, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.198 Vali Acc: 0.146 Test Loss: 3.198 Test Acc: 0.146
Validation loss decreased (-0.141145 --> -0.145850).  Saving model ...
Epoch: 22 cost time: 1.114755630493164
Epoch: 22, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.185 Vali Acc: 0.135 Test Loss: 3.185 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3846302032470703
Epoch: 23, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.207 Vali Acc: 0.138 Test Loss: 3.207 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2212884426116943
Epoch: 24, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.222 Vali Acc: 0.135 Test Loss: 3.222 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.163381814956665
Epoch: 25, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.220 Vali Acc: 0.140 Test Loss: 3.220 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3929336071014404
Epoch: 26, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.224 Vali Acc: 0.139 Test Loss: 3.224 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0877795219421387
Epoch: 27, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.231 Vali Acc: 0.136 Test Loss: 3.231 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0209603309631348
Epoch: 28, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.234 Vali Acc: 0.146 Test Loss: 3.234 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2423534393310547
Epoch: 29, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.261 Vali Acc: 0.134 Test Loss: 3.261 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2629976272583008
Epoch: 30, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.269 Vali Acc: 0.148 Test Loss: 3.269 Test Acc: 0.148
Validation loss decreased (-0.145850 --> -0.148203).  Saving model ...
Epoch: 31 cost time: 1.029724359512329
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.259 Vali Acc: 0.148 Test Loss: 3.259 Test Acc: 0.148
Validation loss decreased (-0.148203 --> -0.148203).  Saving model ...
Epoch: 32 cost time: 1.1378138065338135
Epoch: 32, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.255 Vali Acc: 0.154 Test Loss: 3.255 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154085).  Saving model ...
Epoch: 33 cost time: 0.9603636264801025
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.274 Vali Acc: 0.155 Test Loss: 3.274 Test Acc: 0.155
Validation loss decreased (-0.154085 --> -0.155261).  Saving model ...
Epoch: 34 cost time: 0.9030046463012695
Epoch: 34, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.304 Vali Acc: 0.146 Test Loss: 3.304 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1144676208496094
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.310 Vali Acc: 0.152 Test Loss: 3.310 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3445870876312256
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.320 Vali Acc: 0.145 Test Loss: 3.320 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2509961128234863
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.320 Vali Acc: 0.152 Test Loss: 3.320 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2958028316497803
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.324 Vali Acc: 0.151 Test Loss: 3.324 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2175397872924805
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.331 Vali Acc: 0.155 Test Loss: 3.331 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0532605648040771
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.333 Vali Acc: 0.156 Test Loss: 3.333 Test Acc: 0.156
Validation loss decreased (-0.155261 --> -0.156437).  Saving model ...
Epoch: 41 cost time: 0.9040703773498535
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.339 Vali Acc: 0.158 Test Loss: 3.339 Test Acc: 0.158
Validation loss decreased (-0.156437 --> -0.157614).  Saving model ...
Epoch: 42 cost time: 1.2311396598815918
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.347 Vali Acc: 0.154 Test Loss: 3.347 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3758823871612549
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.347 Vali Acc: 0.153 Test Loss: 3.347 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2675466537475586
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.352 Vali Acc: 0.153 Test Loss: 3.352 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.303941011428833
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.355 Vali Acc: 0.154 Test Loss: 3.355 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.976966142654419
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.356 Vali Acc: 0.156 Test Loss: 3.356 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1685800552368164
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.357 Vali Acc: 0.153 Test Loss: 3.357 Test Acc: 0.153
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1426937580108643
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.359 Vali Acc: 0.152 Test Loss: 3.359 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.002263069152832
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.362 Vali Acc: 0.154 Test Loss: 3.362 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0896649360656738
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.367 Vali Acc: 0.153 Test Loss: 3.367 Test Acc: 0.153
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.1062564849853516
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.369 Vali Acc: 0.156 Test Loss: 3.369 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15764705882352942
model parameter : 645036
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1092727184295654
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.312 Vali Acc: 0.042 Test Loss: 3.312 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.0544893741607666
Epoch: 2, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.284 Vali Acc: 0.046 Test Loss: 3.284 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 1.1341283321380615
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.264 Vali Acc: 0.053 Test Loss: 3.264 Test Acc: 0.053
Validation loss decreased (-0.045850 --> -0.052909).  Saving model ...
Epoch: 4 cost time: 0.9025871753692627
Epoch: 4, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.244 Vali Acc: 0.065 Test Loss: 3.244 Test Acc: 0.065
Validation loss decreased (-0.052909 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.0814790725708008
Epoch: 5, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.222 Vali Acc: 0.088 Test Loss: 3.222 Test Acc: 0.088
Validation loss decreased (-0.064673 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 1.1144695281982422
Epoch: 6, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.200 Vali Acc: 0.086 Test Loss: 3.200 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3037421703338623
Epoch: 7, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.201 Vali Acc: 0.098 Test Loss: 3.201 Test Acc: 0.098
Validation loss decreased (-0.088203 --> -0.097615).  Saving model ...
Epoch: 8 cost time: 1.0219197273254395
Epoch: 8, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.191 Vali Acc: 0.104 Test Loss: 3.191 Test Acc: 0.104
Validation loss decreased (-0.097615 --> -0.103498).  Saving model ...
Epoch: 9 cost time: 0.9967505931854248
Epoch: 9, Steps: 10 | Train Loss: 1.768 Vali Loss: 3.174 Vali Acc: 0.100 Test Loss: 3.174 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1242926120758057
Epoch: 10, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.165 Vali Acc: 0.119 Test Loss: 3.165 Test Acc: 0.119
Validation loss decreased (-0.103498 --> -0.118792).  Saving model ...
Epoch: 11 cost time: 0.9073302745819092
Epoch: 11, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.162 Vali Acc: 0.112 Test Loss: 3.162 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1320416927337646
Epoch: 12, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.138 Vali Acc: 0.112 Test Loss: 3.138 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.171194314956665
Epoch: 13, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.136 Vali Acc: 0.122 Test Loss: 3.136 Test Acc: 0.122
Validation loss decreased (-0.118792 --> -0.122322).  Saving model ...
Epoch: 14 cost time: 1.0986039638519287
Epoch: 14, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.133 Vali Acc: 0.126 Test Loss: 3.133 Test Acc: 0.126
Validation loss decreased (-0.122322 --> -0.125851).  Saving model ...
Epoch: 15 cost time: 1.1583762168884277
Epoch: 15, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.141 Vali Acc: 0.126 Test Loss: 3.141 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0003230571746826
Epoch: 16, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.131 Vali Acc: 0.141 Test Loss: 3.131 Test Acc: 0.141
Validation loss decreased (-0.125851 --> -0.141145).  Saving model ...
Epoch: 17 cost time: 1.0257699489593506
Epoch: 17, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.130 Vali Acc: 0.153 Test Loss: 3.130 Test Acc: 0.153
Validation loss decreased (-0.141145 --> -0.152910).  Saving model ...
Epoch: 18 cost time: 0.892723798751831
Epoch: 18, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.128 Vali Acc: 0.145 Test Loss: 3.128 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1983709335327148
Epoch: 19, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.156 Vali Acc: 0.139 Test Loss: 3.156 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9645767211914062
Epoch: 20, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.147 Vali Acc: 0.146 Test Loss: 3.147 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.927476167678833
Epoch: 21, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.140 Vali Acc: 0.146 Test Loss: 3.140 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.937230110168457
Epoch: 22, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.133 Vali Acc: 0.144 Test Loss: 3.133 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0539822578430176
Epoch: 23, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.135 Vali Acc: 0.151 Test Loss: 3.135 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.935685396194458
Epoch: 24, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.169 Vali Acc: 0.144 Test Loss: 3.169 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1697847843170166
Epoch: 25, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.172 Vali Acc: 0.156 Test Loss: 3.172 Test Acc: 0.156
Validation loss decreased (-0.152910 --> -0.156439).  Saving model ...
Epoch: 26 cost time: 0.9926390647888184
Epoch: 26, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.190 Vali Acc: 0.149 Test Loss: 3.190 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1385071277618408
Epoch: 27, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.206 Vali Acc: 0.162 Test Loss: 3.206 Test Acc: 0.162
Validation loss decreased (-0.156439 --> -0.162321).  Saving model ...
Epoch: 28 cost time: 0.9897432327270508
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.202 Vali Acc: 0.162 Test Loss: 3.202 Test Acc: 0.162
Validation loss decreased (-0.162321 --> -0.162321).  Saving model ...
Epoch: 29 cost time: 1.463904857635498
Epoch: 29, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.252 Vali Acc: 0.152 Test Loss: 3.252 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1626977920532227
Epoch: 30, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.253 Vali Acc: 0.165 Test Loss: 3.253 Test Acc: 0.165
Validation loss decreased (-0.162321 --> -0.164673).  Saving model ...
Epoch: 31 cost time: 1.0057075023651123
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.253 Vali Acc: 0.161 Test Loss: 3.253 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2251276969909668
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.258 Vali Acc: 0.165 Test Loss: 3.258 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1183617115020752
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.265 Vali Acc: 0.160 Test Loss: 3.265 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.135725975036621
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.275 Vali Acc: 0.165 Test Loss: 3.275 Test Acc: 0.165
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2433905601501465
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.286 Vali Acc: 0.159 Test Loss: 3.286 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.203423261642456
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.289 Vali Acc: 0.160 Test Loss: 3.289 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1099982261657715
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.284 Vali Acc: 0.159 Test Loss: 3.284 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9617691040039062
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.289 Vali Acc: 0.156 Test Loss: 3.289 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2707295417785645
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.296 Vali Acc: 0.158 Test Loss: 3.296 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0209095478057861
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.306 Vali Acc: 0.159 Test Loss: 3.306 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16470588235294117
model parameter : 642988
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.939385175704956
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.292 Vali Acc: 0.036 Test Loss: 3.292 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.8774113655090332
Epoch: 2, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.272 Vali Acc: 0.048 Test Loss: 3.272 Test Acc: 0.048
Validation loss decreased (-0.036438 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 0.7393913269042969
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.246 Vali Acc: 0.061 Test Loss: 3.246 Test Acc: 0.061
Validation loss decreased (-0.048203 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.9488580226898193
Epoch: 4, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.230 Vali Acc: 0.078 Test Loss: 3.230 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077615).  Saving model ...
Epoch: 5 cost time: 0.8447208404541016
Epoch: 5, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.228 Vali Acc: 0.081 Test Loss: 3.228 Test Acc: 0.081
Validation loss decreased (-0.077615 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.8233592510223389
Epoch: 6, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.210 Vali Acc: 0.088 Test Loss: 3.210 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 0.9020674228668213
Epoch: 7, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.199 Vali Acc: 0.102 Test Loss: 3.199 Test Acc: 0.102
Validation loss decreased (-0.088203 --> -0.102321).  Saving model ...
Epoch: 8 cost time: 0.8154981136322021
Epoch: 8, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.192 Vali Acc: 0.096 Test Loss: 3.192 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9326920509338379
Epoch: 9, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.198 Vali Acc: 0.109 Test Loss: 3.198 Test Acc: 0.109
Validation loss decreased (-0.102321 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 1.0213215351104736
Epoch: 10, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.172 Vali Acc: 0.113 Test Loss: 3.172 Test Acc: 0.113
Validation loss decreased (-0.109380 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 1.001396894454956
Epoch: 11, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.183 Vali Acc: 0.107 Test Loss: 3.183 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9882888793945312
Epoch: 12, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.171 Vali Acc: 0.120 Test Loss: 3.171 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 1.0162551403045654
Epoch: 13, Steps: 10 | Train Loss: 1.057 Vali Loss: 3.165 Vali Acc: 0.124 Test Loss: 3.165 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123498).  Saving model ...
Epoch: 14 cost time: 0.9024026393890381
Epoch: 14, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.176 Vali Acc: 0.124 Test Loss: 3.176 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7829940319061279
Epoch: 15, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.172 Vali Acc: 0.131 Test Loss: 3.172 Test Acc: 0.131
Validation loss decreased (-0.123498 --> -0.130557).  Saving model ...
Epoch: 16 cost time: 0.9166886806488037
Epoch: 16, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.186 Vali Acc: 0.126 Test Loss: 3.186 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8748166561126709
Epoch: 17, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.178 Vali Acc: 0.135 Test Loss: 3.178 Test Acc: 0.135
Validation loss decreased (-0.130557 --> -0.135262).  Saving model ...
Epoch: 18 cost time: 1.0457806587219238
Epoch: 18, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.168 Vali Acc: 0.138 Test Loss: 3.168 Test Acc: 0.138
Validation loss decreased (-0.135262 --> -0.137615).  Saving model ...
Epoch: 19 cost time: 1.0755770206451416
Epoch: 19, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.181 Vali Acc: 0.136 Test Loss: 3.181 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0624220371246338
Epoch: 20, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.182 Vali Acc: 0.128 Test Loss: 3.182 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9670031070709229
Epoch: 21, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.198 Vali Acc: 0.127 Test Loss: 3.198 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9357004165649414
Epoch: 22, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.188 Vali Acc: 0.144 Test Loss: 3.188 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143498).  Saving model ...
Epoch: 23 cost time: 0.9816310405731201
Epoch: 23, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.201 Vali Acc: 0.142 Test Loss: 3.201 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9997611045837402
Epoch: 24, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.223 Vali Acc: 0.128 Test Loss: 3.223 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8848845958709717
Epoch: 25, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.244 Vali Acc: 0.145 Test Loss: 3.244 Test Acc: 0.145
Validation loss decreased (-0.143498 --> -0.144673).  Saving model ...
Epoch: 26 cost time: 1.0411906242370605
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.283 Vali Acc: 0.133 Test Loss: 3.283 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9742445945739746
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.268 Vali Acc: 0.141 Test Loss: 3.268 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7873141765594482
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.279 Vali Acc: 0.144 Test Loss: 3.279 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8502485752105713
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.291 Vali Acc: 0.155 Test Loss: 3.291 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155261).  Saving model ...
Epoch: 30 cost time: 1.0634160041809082
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.290 Vali Acc: 0.149 Test Loss: 3.290 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8733088970184326
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.285 Vali Acc: 0.151 Test Loss: 3.285 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8144786357879639
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.293 Vali Acc: 0.147 Test Loss: 3.293 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9006273746490479
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.299 Vali Acc: 0.152 Test Loss: 3.299 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9126956462860107
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.302 Vali Acc: 0.155 Test Loss: 3.302 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2139685153961182
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.306 Vali Acc: 0.154 Test Loss: 3.306 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8891613483428955
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.312 Vali Acc: 0.152 Test Loss: 3.312 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8993582725524902
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.316 Vali Acc: 0.153 Test Loss: 3.316 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8115568161010742
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.317 Vali Acc: 0.155 Test Loss: 3.317 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7396414279937744
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.322 Vali Acc: 0.155 Test Loss: 3.322 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15529411764705883
model parameter : 638892
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6912381649017334
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.295 Vali Acc: 0.041 Test Loss: 3.295 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.7539212703704834
Epoch: 2, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.268 Vali Acc: 0.052 Test Loss: 3.268 Test Acc: 0.052
Validation loss decreased (-0.041144 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.7478578090667725
Epoch: 3, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.241 Vali Acc: 0.059 Test Loss: 3.241 Test Acc: 0.059
Validation loss decreased (-0.051732 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.724844217300415
Epoch: 4, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.224 Vali Acc: 0.074 Test Loss: 3.224 Test Acc: 0.074
Validation loss decreased (-0.058791 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.5980627536773682
Epoch: 5, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.207 Vali Acc: 0.094 Test Loss: 3.207 Test Acc: 0.094
Validation loss decreased (-0.074085 --> -0.094086).  Saving model ...
Epoch: 6 cost time: 0.6969389915466309
Epoch: 6, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.207 Vali Acc: 0.092 Test Loss: 3.207 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7259972095489502
Epoch: 7, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.202 Vali Acc: 0.086 Test Loss: 3.202 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7105836868286133
Epoch: 8, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.190 Vali Acc: 0.108 Test Loss: 3.190 Test Acc: 0.108
Validation loss decreased (-0.094086 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.817194938659668
Epoch: 9, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.193 Vali Acc: 0.114 Test Loss: 3.193 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114086).  Saving model ...
Epoch: 10 cost time: 0.8988492488861084
Epoch: 10, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.187 Vali Acc: 0.116 Test Loss: 3.187 Test Acc: 0.116
Validation loss decreased (-0.114086 --> -0.116439).  Saving model ...
Epoch: 11 cost time: 0.7648000717163086
Epoch: 11, Steps: 10 | Train Loss: 1.292 Vali Loss: 3.176 Vali Acc: 0.121 Test Loss: 3.176 Test Acc: 0.121
Validation loss decreased (-0.116439 --> -0.121145).  Saving model ...
Epoch: 12 cost time: 0.8089785575866699
Epoch: 12, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.187 Vali Acc: 0.119 Test Loss: 3.187 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0105912685394287
Epoch: 13, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.175 Vali Acc: 0.127 Test Loss: 3.175 Test Acc: 0.127
Validation loss decreased (-0.121145 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.7093002796173096
Epoch: 14, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.189 Vali Acc: 0.131 Test Loss: 3.189 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.813976526260376
Epoch: 15, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.183 Vali Acc: 0.140 Test Loss: 3.183 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.7513065338134766
Epoch: 16, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.183 Vali Acc: 0.144 Test Loss: 3.183 Test Acc: 0.144
Validation loss decreased (-0.139968 --> -0.143498).  Saving model ...
Epoch: 17 cost time: 0.8343942165374756
Epoch: 17, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.190 Vali Acc: 0.136 Test Loss: 3.190 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8751833438873291
Epoch: 18, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.193 Vali Acc: 0.149 Test Loss: 3.193 Test Acc: 0.149
Validation loss decreased (-0.143498 --> -0.149380).  Saving model ...
Epoch: 19 cost time: 0.8643183708190918
Epoch: 19, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.184 Vali Acc: 0.158 Test Loss: 3.184 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157615).  Saving model ...
Epoch: 20 cost time: 1.046590805053711
Epoch: 20, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.222 Vali Acc: 0.152 Test Loss: 3.222 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1635894775390625
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.229 Vali Acc: 0.161 Test Loss: 3.229 Test Acc: 0.161
Validation loss decreased (-0.157615 --> -0.161144).  Saving model ...
Epoch: 22 cost time: 0.8127181529998779
Epoch: 22, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.247 Vali Acc: 0.152 Test Loss: 3.247 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7783048152923584
Epoch: 23, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.274 Vali Acc: 0.138 Test Loss: 3.274 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7970616817474365
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.249 Vali Acc: 0.165 Test Loss: 3.249 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 25 cost time: 0.8717436790466309
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.265 Vali Acc: 0.156 Test Loss: 3.265 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0118024349212646
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.274 Vali Acc: 0.161 Test Loss: 3.274 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8675024509429932
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.271 Vali Acc: 0.171 Test Loss: 3.271 Test Acc: 0.171
Validation loss decreased (-0.164673 --> -0.170556).  Saving model ...
Epoch: 28 cost time: 0.8925018310546875
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.282 Vali Acc: 0.167 Test Loss: 3.282 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8870241641998291
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.287 Vali Acc: 0.160 Test Loss: 3.287 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8995461463928223
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.298 Vali Acc: 0.160 Test Loss: 3.298 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.029527187347412
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.304 Vali Acc: 0.164 Test Loss: 3.304 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8359277248382568
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.312 Vali Acc: 0.160 Test Loss: 3.312 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8268709182739258
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.320 Vali Acc: 0.164 Test Loss: 3.320 Test Acc: 0.164
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.80655837059021
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.321 Vali Acc: 0.159 Test Loss: 3.321 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0540380477905273
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.324 Vali Acc: 0.162 Test Loss: 3.324 Test Acc: 0.162
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.942572832107544
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.331 Vali Acc: 0.160 Test Loss: 3.331 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9953949451446533
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.338 Vali Acc: 0.156 Test Loss: 3.338 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17058823529411765
model parameter : 636844
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.14982533454895
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.323 Vali Acc: 0.042 Test Loss: 3.323 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.65419602394104
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.309 Vali Acc: 0.046 Test Loss: 3.309 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.6889846324920654
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.296 Vali Acc: 0.053 Test Loss: 3.296 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.975553035736084
Epoch: 4, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.288 Vali Acc: 0.049 Test Loss: 3.288 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9566104412078857
Epoch: 5, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.274 Vali Acc: 0.064 Test Loss: 3.274 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.575075626373291
Epoch: 6, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.262 Vali Acc: 0.064 Test Loss: 3.262 Test Acc: 0.064
Validation loss decreased (-0.063497 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 1.89164400100708
Epoch: 7, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.252 Vali Acc: 0.075 Test Loss: 3.252 Test Acc: 0.075
Validation loss decreased (-0.063497 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 1.7473289966583252
Epoch: 8, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.241 Vali Acc: 0.079 Test Loss: 3.241 Test Acc: 0.079
Validation loss decreased (-0.075262 --> -0.078791).  Saving model ...
Epoch: 9 cost time: 1.8377690315246582
Epoch: 9, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.231 Vali Acc: 0.086 Test Loss: 3.231 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 10 cost time: 2.2719533443450928
Epoch: 10, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.226 Vali Acc: 0.092 Test Loss: 3.226 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 1.8224141597747803
Epoch: 11, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.220 Vali Acc: 0.093 Test Loss: 3.220 Test Acc: 0.093
Validation loss decreased (-0.091732 --> -0.092909).  Saving model ...
Epoch: 12 cost time: 1.9194769859313965
Epoch: 12, Steps: 10 | Train Loss: 2.353 Vali Loss: 3.212 Vali Acc: 0.095 Test Loss: 3.212 Test Acc: 0.095
Validation loss decreased (-0.092909 --> -0.095262).  Saving model ...
Epoch: 13 cost time: 1.5911736488342285
Epoch: 13, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.210 Vali Acc: 0.093 Test Loss: 3.210 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7762207984924316
Epoch: 14, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.210 Vali Acc: 0.093 Test Loss: 3.210 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6859445571899414
Epoch: 15, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.204 Vali Acc: 0.098 Test Loss: 3.204 Test Acc: 0.098
Validation loss decreased (-0.095262 --> -0.097615).  Saving model ...
Epoch: 16 cost time: 1.6951754093170166
Epoch: 16, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.199 Vali Acc: 0.106 Test Loss: 3.199 Test Acc: 0.106
Validation loss decreased (-0.097615 --> -0.105850).  Saving model ...
Epoch: 17 cost time: 1.6162536144256592
Epoch: 17, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.194 Vali Acc: 0.105 Test Loss: 3.194 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7455027103424072
Epoch: 18, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.191 Vali Acc: 0.113 Test Loss: 3.191 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 19 cost time: 1.9416348934173584
Epoch: 19, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.189 Vali Acc: 0.122 Test Loss: 3.189 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122321).  Saving model ...
Epoch: 20 cost time: 2.2732038497924805
Epoch: 20, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.188 Vali Acc: 0.121 Test Loss: 3.188 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9292576313018799
Epoch: 21, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.187 Vali Acc: 0.128 Test Loss: 3.187 Test Acc: 0.128
Validation loss decreased (-0.122321 --> -0.128203).  Saving model ...
Epoch: 22 cost time: 1.806429386138916
Epoch: 22, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.193 Vali Acc: 0.119 Test Loss: 3.193 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1299123764038086
Epoch: 23, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.195 Vali Acc: 0.138 Test Loss: 3.195 Test Acc: 0.138
Validation loss decreased (-0.128203 --> -0.137615).  Saving model ...
Epoch: 24 cost time: 1.9017086029052734
Epoch: 24, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.197 Vali Acc: 0.131 Test Loss: 3.197 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2025339603424072
Epoch: 25, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.188 Vali Acc: 0.142 Test Loss: 3.188 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 26 cost time: 1.7308998107910156
Epoch: 26, Steps: 10 | Train Loss: 1.235 Vali Loss: 3.189 Vali Acc: 0.142 Test Loss: 3.189 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6420190334320068
Epoch: 27, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.188 Vali Acc: 0.159 Test Loss: 3.188 Test Acc: 0.159
Validation loss decreased (-0.142321 --> -0.158792).  Saving model ...
Epoch: 28 cost time: 1.5723628997802734
Epoch: 28, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.196 Vali Acc: 0.153 Test Loss: 3.196 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.671203374862671
Epoch: 29, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.191 Vali Acc: 0.167 Test Loss: 3.191 Test Acc: 0.167
Validation loss decreased (-0.158792 --> -0.167027).  Saving model ...
Epoch: 30 cost time: 1.6671912670135498
Epoch: 30, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.207 Vali Acc: 0.164 Test Loss: 3.207 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8970003128051758
Epoch: 31, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.226 Vali Acc: 0.162 Test Loss: 3.226 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7069923877716064
Epoch: 32, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.243 Vali Acc: 0.165 Test Loss: 3.243 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0755817890167236
Epoch: 33, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.251 Vali Acc: 0.166 Test Loss: 3.251 Test Acc: 0.166
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8202290534973145
Epoch: 34, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.264 Vali Acc: 0.169 Test Loss: 3.264 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169379).  Saving model ...
Epoch: 35 cost time: 1.61252760887146
Epoch: 35, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.276 Vali Acc: 0.174 Test Loss: 3.276 Test Acc: 0.174
Validation loss decreased (-0.169379 --> -0.174085).  Saving model ...
Epoch: 36 cost time: 1.8068864345550537
Epoch: 36, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.289 Vali Acc: 0.175 Test Loss: 3.289 Test Acc: 0.175
Validation loss decreased (-0.174085 --> -0.175261).  Saving model ...
Epoch: 37 cost time: 1.3593347072601318
Epoch: 37, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.324 Vali Acc: 0.175 Test Loss: 3.324 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7309510707855225
Epoch: 38, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.333 Vali Acc: 0.173 Test Loss: 3.333 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3348424434661865
Epoch: 39, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.357 Vali Acc: 0.173 Test Loss: 3.357 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7018578052520752
Epoch: 40, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.355 Vali Acc: 0.173 Test Loss: 3.355 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.090374708175659
Epoch: 41, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.378 Vali Acc: 0.174 Test Loss: 3.378 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.103532314300537
Epoch: 42, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.399 Vali Acc: 0.172 Test Loss: 3.399 Test Acc: 0.172
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4668872356414795
Epoch: 43, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.413 Vali Acc: 0.185 Test Loss: 3.413 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184672).  Saving model ...
Epoch: 44 cost time: 1.4050724506378174
Epoch: 44, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.419 Vali Acc: 0.179 Test Loss: 3.419 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9131121635437012
Epoch: 45, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.435 Vali Acc: 0.178 Test Loss: 3.435 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1349127292633057
Epoch: 46, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.475 Vali Acc: 0.182 Test Loss: 3.475 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7838025093078613
Epoch: 47, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.481 Vali Acc: 0.173 Test Loss: 3.481 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5434799194335938
Epoch: 48, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.496 Vali Acc: 0.176 Test Loss: 3.496 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.549797534942627
Epoch: 49, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.510 Vali Acc: 0.175 Test Loss: 3.510 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.825880765914917
Epoch: 50, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.522 Vali Acc: 0.171 Test Loss: 3.522 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.5368602275848389
Epoch: 51, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.534 Vali Acc: 0.168 Test Loss: 3.534 Test Acc: 0.168
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.6454906463623047
Epoch: 52, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.541 Vali Acc: 0.174 Test Loss: 3.541 Test Acc: 0.174
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.9090218544006348
Epoch: 53, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.565 Vali Acc: 0.165 Test Loss: 3.565 Test Acc: 0.165
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 342990
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2898032665252686
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.4477324485778809
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.291 Vali Acc: 0.029 Test Loss: 3.291 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3391351699829102
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.282 Vali Acc: 0.038 Test Loss: 3.282 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9588420391082764
Epoch: 4, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.275 Vali Acc: 0.055 Test Loss: 3.275 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.4962081909179688
Epoch: 5, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.271 Vali Acc: 0.055 Test Loss: 3.271 Test Acc: 0.055
Validation loss decreased (-0.055261 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.742485761642456
Epoch: 6, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.263 Vali Acc: 0.056 Test Loss: 3.263 Test Acc: 0.056
Validation loss decreased (-0.055261 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 1.58504319190979
Epoch: 7, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.254 Vali Acc: 0.056 Test Loss: 3.254 Test Acc: 0.056
Validation loss decreased (-0.056438 --> -0.056438).  Saving model ...
Epoch: 8 cost time: 1.5187492370605469
Epoch: 8, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.250 Vali Acc: 0.064 Test Loss: 3.250 Test Acc: 0.064
Validation loss decreased (-0.056438 --> -0.063497).  Saving model ...
Epoch: 9 cost time: 1.4207923412322998
Epoch: 9, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.242 Vali Acc: 0.075 Test Loss: 3.242 Test Acc: 0.075
Validation loss decreased (-0.063497 --> -0.075262).  Saving model ...
Epoch: 10 cost time: 1.9100499153137207
Epoch: 10, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.238 Vali Acc: 0.082 Test Loss: 3.238 Test Acc: 0.082
Validation loss decreased (-0.075262 --> -0.082321).  Saving model ...
Epoch: 11 cost time: 1.732611894607544
Epoch: 11, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.234 Vali Acc: 0.089 Test Loss: 3.234 Test Acc: 0.089
Validation loss decreased (-0.082321 --> -0.089379).  Saving model ...
Epoch: 12 cost time: 1.4696459770202637
Epoch: 12, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.228 Vali Acc: 0.101 Test Loss: 3.228 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101144).  Saving model ...
Epoch: 13 cost time: 1.4820301532745361
Epoch: 13, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.217 Vali Acc: 0.099 Test Loss: 3.217 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5574207305908203
Epoch: 14, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.210 Vali Acc: 0.108 Test Loss: 3.210 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108203).  Saving model ...
Epoch: 15 cost time: 1.5020332336425781
Epoch: 15, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.200 Vali Acc: 0.114 Test Loss: 3.200 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114086).  Saving model ...
Epoch: 16 cost time: 1.5219385623931885
Epoch: 16, Steps: 10 | Train Loss: 2.032 Vali Loss: 3.196 Vali Acc: 0.106 Test Loss: 3.196 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3912150859832764
Epoch: 17, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.189 Vali Acc: 0.115 Test Loss: 3.189 Test Acc: 0.115
Validation loss decreased (-0.114086 --> -0.115262).  Saving model ...
Epoch: 18 cost time: 1.4418988227844238
Epoch: 18, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.179 Vali Acc: 0.118 Test Loss: 3.179 Test Acc: 0.118
Validation loss decreased (-0.115262 --> -0.117615).  Saving model ...
Epoch: 19 cost time: 1.6083581447601318
Epoch: 19, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.173 Vali Acc: 0.125 Test Loss: 3.173 Test Acc: 0.125
Validation loss decreased (-0.117615 --> -0.124674).  Saving model ...
Epoch: 20 cost time: 1.4715170860290527
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.178 Vali Acc: 0.108 Test Loss: 3.178 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.743337869644165
Epoch: 21, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.164 Vali Acc: 0.118 Test Loss: 3.164 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.399787425994873
Epoch: 22, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.164 Vali Acc: 0.120 Test Loss: 3.164 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5442650318145752
Epoch: 23, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.165 Vali Acc: 0.129 Test Loss: 3.165 Test Acc: 0.129
Validation loss decreased (-0.124674 --> -0.129380).  Saving model ...
Epoch: 24 cost time: 1.6733918190002441
Epoch: 24, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.157 Vali Acc: 0.131 Test Loss: 3.157 Test Acc: 0.131
Validation loss decreased (-0.129380 --> -0.130557).  Saving model ...
Epoch: 25 cost time: 1.7794811725616455
Epoch: 25, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.151 Vali Acc: 0.128 Test Loss: 3.151 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.769439935684204
Epoch: 26, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.156 Vali Acc: 0.133 Test Loss: 3.156 Test Acc: 0.133
Validation loss decreased (-0.130557 --> -0.132910).  Saving model ...
Epoch: 27 cost time: 1.4875500202178955
Epoch: 27, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.158 Vali Acc: 0.133 Test Loss: 3.158 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6303503513336182
Epoch: 28, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.170 Vali Acc: 0.133 Test Loss: 3.170 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.055999517440796
Epoch: 29, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.187 Vali Acc: 0.138 Test Loss: 3.187 Test Acc: 0.138
Validation loss decreased (-0.132910 --> -0.137615).  Saving model ...
Epoch: 30 cost time: 1.890427827835083
Epoch: 30, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.189 Vali Acc: 0.144 Test Loss: 3.189 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143498).  Saving model ...
Epoch: 31 cost time: 1.4517555236816406
Epoch: 31, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.185 Vali Acc: 0.152 Test Loss: 3.185 Test Acc: 0.152
Validation loss decreased (-0.143498 --> -0.151733).  Saving model ...
Epoch: 32 cost time: 1.7952792644500732
Epoch: 32, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.201 Vali Acc: 0.139 Test Loss: 3.201 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6557672023773193
Epoch: 33, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.203 Vali Acc: 0.149 Test Loss: 3.203 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.652202844619751
Epoch: 34, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.219 Vali Acc: 0.155 Test Loss: 3.219 Test Acc: 0.155
Validation loss decreased (-0.151733 --> -0.155262).  Saving model ...
Epoch: 35 cost time: 1.3854284286499023
Epoch: 35, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.202 Vali Acc: 0.165 Test Loss: 3.202 Test Acc: 0.165
Validation loss decreased (-0.155262 --> -0.164674).  Saving model ...
Epoch: 36 cost time: 1.460834264755249
Epoch: 36, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.213 Vali Acc: 0.159 Test Loss: 3.213 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4469308853149414
Epoch: 37, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.224 Vali Acc: 0.159 Test Loss: 3.224 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4271631240844727
Epoch: 38, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.231 Vali Acc: 0.160 Test Loss: 3.231 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.455526351928711
Epoch: 39, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.244 Vali Acc: 0.162 Test Loss: 3.244 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.776545524597168
Epoch: 40, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.259 Vali Acc: 0.169 Test Loss: 3.259 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169379).  Saving model ...
Epoch: 41 cost time: 1.5482468605041504
Epoch: 41, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.254 Vali Acc: 0.166 Test Loss: 3.254 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8045988082885742
Epoch: 42, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.267 Vali Acc: 0.167 Test Loss: 3.267 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.469592809677124
Epoch: 43, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.266 Vali Acc: 0.176 Test Loss: 3.266 Test Acc: 0.176
Validation loss decreased (-0.169379 --> -0.176438).  Saving model ...
Epoch: 44 cost time: 1.2101233005523682
Epoch: 44, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.279 Vali Acc: 0.173 Test Loss: 3.279 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2744863033294678
Epoch: 45, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.289 Vali Acc: 0.172 Test Loss: 3.289 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.799698829650879
Epoch: 46, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.303 Vali Acc: 0.178 Test Loss: 3.303 Test Acc: 0.178
Validation loss decreased (-0.176438 --> -0.177614).  Saving model ...
Epoch: 47 cost time: 1.7156994342803955
Epoch: 47, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.312 Vali Acc: 0.171 Test Loss: 3.312 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4425349235534668
Epoch: 48, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.315 Vali Acc: 0.172 Test Loss: 3.315 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7902278900146484
Epoch: 49, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.333 Vali Acc: 0.165 Test Loss: 3.333 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.76383638381958
Epoch: 50, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.345 Vali Acc: 0.161 Test Loss: 3.345 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.5508601665496826
Epoch: 51, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.351 Vali Acc: 0.172 Test Loss: 3.351 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2568392753601074
Epoch: 52, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.359 Vali Acc: 0.171 Test Loss: 3.359 Test Acc: 0.171
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3031682968139648
Epoch: 53, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.368 Vali Acc: 0.168 Test Loss: 3.368 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.4116053581237793
Epoch: 54, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.366 Vali Acc: 0.168 Test Loss: 3.366 Test Acc: 0.168
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.301741123199463
Epoch: 55, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.374 Vali Acc: 0.172 Test Loss: 3.374 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.5193326473236084
Epoch: 56, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.368 Vali Acc: 0.169 Test Loss: 3.368 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1776470588235294
model parameter : 339918
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5329980850219727
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.351 Vali Acc: 0.044 Test Loss: 3.351 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.3290860652923584
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.336 Vali Acc: 0.048 Test Loss: 3.336 Test Acc: 0.048
Validation loss decreased (-0.043496 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 1.3153772354125977
Epoch: 3, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.317 Vali Acc: 0.049 Test Loss: 3.317 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.581252098083496
Epoch: 4, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.305 Vali Acc: 0.058 Test Loss: 3.305 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.8419947624206543
Epoch: 5, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.299 Vali Acc: 0.059 Test Loss: 3.299 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 1.2424259185791016
Epoch: 6, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.293 Vali Acc: 0.060 Test Loss: 3.293 Test Acc: 0.060
Validation loss decreased (-0.058791 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.3422539234161377
Epoch: 7, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.285 Vali Acc: 0.060 Test Loss: 3.285 Test Acc: 0.060
Validation loss decreased (-0.059967 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 1.3929407596588135
Epoch: 8, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.285 Vali Acc: 0.071 Test Loss: 3.285 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 1.4226272106170654
Epoch: 9, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.280 Vali Acc: 0.068 Test Loss: 3.280 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4194655418395996
Epoch: 10, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.281 Vali Acc: 0.068 Test Loss: 3.281 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.137784719467163
Epoch: 11, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.283 Vali Acc: 0.071 Test Loss: 3.283 Test Acc: 0.071
Validation loss decreased (-0.070555 --> -0.070555).  Saving model ...
Epoch: 12 cost time: 1.018937349319458
Epoch: 12, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.280 Vali Acc: 0.078 Test Loss: 3.280 Test Acc: 0.078
Validation loss decreased (-0.070555 --> -0.077614).  Saving model ...
Epoch: 13 cost time: 1.3641903400421143
Epoch: 13, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.273 Vali Acc: 0.082 Test Loss: 3.273 Test Acc: 0.082
Validation loss decreased (-0.077614 --> -0.082320).  Saving model ...
Epoch: 14 cost time: 1.2624406814575195
Epoch: 14, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.272 Vali Acc: 0.087 Test Loss: 3.272 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 15 cost time: 1.157252311706543
Epoch: 15, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.274 Vali Acc: 0.085 Test Loss: 3.274 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1220216751098633
Epoch: 16, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.277 Vali Acc: 0.087 Test Loss: 3.277 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.136540174484253
Epoch: 17, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.279 Vali Acc: 0.085 Test Loss: 3.279 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3387415409088135
Epoch: 18, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.277 Vali Acc: 0.092 Test Loss: 3.277 Test Acc: 0.092
Validation loss decreased (-0.087026 --> -0.091732).  Saving model ...
Epoch: 19 cost time: 1.1243493556976318
Epoch: 19, Steps: 10 | Train Loss: 1.759 Vali Loss: 3.281 Vali Acc: 0.100 Test Loss: 3.281 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099967).  Saving model ...
Epoch: 20 cost time: 1.233973503112793
Epoch: 20, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.285 Vali Acc: 0.105 Test Loss: 3.285 Test Acc: 0.105
Validation loss decreased (-0.099967 --> -0.104673).  Saving model ...
Epoch: 21 cost time: 1.1964454650878906
Epoch: 21, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.285 Vali Acc: 0.116 Test Loss: 3.285 Test Acc: 0.116
Validation loss decreased (-0.104673 --> -0.116438).  Saving model ...
Epoch: 22 cost time: 1.1622040271759033
Epoch: 22, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.285 Vali Acc: 0.109 Test Loss: 3.285 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.327028751373291
Epoch: 23, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.277 Vali Acc: 0.109 Test Loss: 3.277 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2700645923614502
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.287 Vali Acc: 0.108 Test Loss: 3.287 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4660310745239258
Epoch: 25, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.292 Vali Acc: 0.108 Test Loss: 3.292 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5351312160491943
Epoch: 26, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.286 Vali Acc: 0.113 Test Loss: 3.286 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2601964473724365
Epoch: 27, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.282 Vali Acc: 0.119 Test Loss: 3.282 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 28 cost time: 1.5432422161102295
Epoch: 28, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.293 Vali Acc: 0.118 Test Loss: 3.293 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7231817245483398
Epoch: 29, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.293 Vali Acc: 0.119 Test Loss: 3.293 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6377921104431152
Epoch: 30, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.290 Vali Acc: 0.124 Test Loss: 3.290 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 31 cost time: 1.4622647762298584
Epoch: 31, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.295 Vali Acc: 0.132 Test Loss: 3.295 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131732).  Saving model ...
Epoch: 32 cost time: 1.271054744720459
Epoch: 32, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.306 Vali Acc: 0.141 Test Loss: 3.306 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141143).  Saving model ...
Epoch: 33 cost time: 1.2910099029541016
Epoch: 33, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.343 Vali Acc: 0.140 Test Loss: 3.343 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4018537998199463
Epoch: 34, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.345 Vali Acc: 0.132 Test Loss: 3.345 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4022715091705322
Epoch: 35, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.346 Vali Acc: 0.136 Test Loss: 3.346 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.317772626876831
Epoch: 36, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.351 Vali Acc: 0.146 Test Loss: 3.351 Test Acc: 0.146
Validation loss decreased (-0.141143 --> -0.145849).  Saving model ...
Epoch: 37 cost time: 1.3440442085266113
Epoch: 37, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.375 Vali Acc: 0.136 Test Loss: 3.375 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4504199028015137
Epoch: 38, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.375 Vali Acc: 0.142 Test Loss: 3.375 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2010152339935303
Epoch: 39, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.385 Vali Acc: 0.142 Test Loss: 3.385 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0980463027954102
Epoch: 40, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.401 Vali Acc: 0.138 Test Loss: 3.401 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2573132514953613
Epoch: 41, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.410 Vali Acc: 0.142 Test Loss: 3.410 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.685326337814331
Epoch: 42, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.413 Vali Acc: 0.144 Test Loss: 3.413 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3096990585327148
Epoch: 43, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.429 Vali Acc: 0.142 Test Loss: 3.429 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3591570854187012
Epoch: 44, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.459 Vali Acc: 0.144 Test Loss: 3.459 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2902672290802002
Epoch: 45, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.493 Vali Acc: 0.146 Test Loss: 3.493 Test Acc: 0.146
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4866352081298828
Epoch: 46, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.510 Vali Acc: 0.145 Test Loss: 3.510 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14588235294117646
model parameter : 335822
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3543753623962402
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.320 Vali Acc: 0.051 Test Loss: 3.320 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.2915234565734863
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.310 Vali Acc: 0.048 Test Loss: 3.310 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1672744750976562
Epoch: 3, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.297 Vali Acc: 0.052 Test Loss: 3.297 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.1919050216674805
Epoch: 4, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.286 Vali Acc: 0.055 Test Loss: 3.286 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.1069605350494385
Epoch: 5, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.275 Vali Acc: 0.071 Test Loss: 3.275 Test Acc: 0.071
Validation loss decreased (-0.055261 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 1.09299635887146
Epoch: 6, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.265 Vali Acc: 0.072 Test Loss: 3.265 Test Acc: 0.072
Validation loss decreased (-0.070555 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 1.1923987865447998
Epoch: 7, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.261 Vali Acc: 0.076 Test Loss: 3.261 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 1.2147414684295654
Epoch: 8, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.254 Vali Acc: 0.086 Test Loss: 3.254 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 1.508131504058838
Epoch: 9, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.246 Vali Acc: 0.092 Test Loss: 3.246 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 1.4336433410644531
Epoch: 10, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.239 Vali Acc: 0.095 Test Loss: 3.239 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 1.4540672302246094
Epoch: 11, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.235 Vali Acc: 0.099 Test Loss: 3.235 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 1.2887096405029297
Epoch: 12, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.228 Vali Acc: 0.098 Test Loss: 3.228 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.218515396118164
Epoch: 13, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.225 Vali Acc: 0.113 Test Loss: 3.225 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 1.1949501037597656
Epoch: 14, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.216 Vali Acc: 0.112 Test Loss: 3.216 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9930863380432129
Epoch: 15, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.219 Vali Acc: 0.119 Test Loss: 3.219 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 1.1859970092773438
Epoch: 16, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.211 Vali Acc: 0.120 Test Loss: 3.211 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119968).  Saving model ...
Epoch: 17 cost time: 1.1138567924499512
Epoch: 17, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.203 Vali Acc: 0.129 Test Loss: 3.203 Test Acc: 0.129
Validation loss decreased (-0.119968 --> -0.129380).  Saving model ...
Epoch: 18 cost time: 1.114959478378296
Epoch: 18, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.200 Vali Acc: 0.139 Test Loss: 3.200 Test Acc: 0.139
Validation loss decreased (-0.129380 --> -0.138792).  Saving model ...
Epoch: 19 cost time: 1.1524319648742676
Epoch: 19, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.200 Vali Acc: 0.138 Test Loss: 3.200 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1491644382476807
Epoch: 20, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.193 Vali Acc: 0.139 Test Loss: 3.193 Test Acc: 0.139
Validation loss decreased (-0.138792 --> -0.138792).  Saving model ...
Epoch: 21 cost time: 0.9785573482513428
Epoch: 21, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.186 Vali Acc: 0.142 Test Loss: 3.186 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142321).  Saving model ...
Epoch: 22 cost time: 1.2233831882476807
Epoch: 22, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.189 Vali Acc: 0.140 Test Loss: 3.189 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0358822345733643
Epoch: 23, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.197 Vali Acc: 0.141 Test Loss: 3.197 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2874631881713867
Epoch: 24, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.194 Vali Acc: 0.153 Test Loss: 3.194 Test Acc: 0.153
Validation loss decreased (-0.142321 --> -0.152909).  Saving model ...
Epoch: 25 cost time: 1.3320674896240234
Epoch: 25, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.187 Vali Acc: 0.151 Test Loss: 3.187 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0854763984680176
Epoch: 26, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.177 Vali Acc: 0.154 Test Loss: 3.177 Test Acc: 0.154
Validation loss decreased (-0.152909 --> -0.154086).  Saving model ...
Epoch: 27 cost time: 1.3012628555297852
Epoch: 27, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.196 Vali Acc: 0.151 Test Loss: 3.196 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0839529037475586
Epoch: 28, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.181 Vali Acc: 0.155 Test Loss: 3.181 Test Acc: 0.155
Validation loss decreased (-0.154086 --> -0.155262).  Saving model ...
Epoch: 29 cost time: 1.2262375354766846
Epoch: 29, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.191 Vali Acc: 0.153 Test Loss: 3.191 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0709068775177002
Epoch: 30, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.207 Vali Acc: 0.160 Test Loss: 3.207 Test Acc: 0.160
Validation loss decreased (-0.155262 --> -0.159968).  Saving model ...
Epoch: 31 cost time: 1.0802443027496338
Epoch: 31, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.207 Vali Acc: 0.146 Test Loss: 3.207 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1691057682037354
Epoch: 32, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.211 Vali Acc: 0.149 Test Loss: 3.211 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1449859142303467
Epoch: 33, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.212 Vali Acc: 0.159 Test Loss: 3.212 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.039963722229004
Epoch: 34, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1835668087005615
Epoch: 35, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.236 Vali Acc: 0.160 Test Loss: 3.236 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5032215118408203
Epoch: 36, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.256 Vali Acc: 0.154 Test Loss: 3.256 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1709933280944824
Epoch: 37, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.246 Vali Acc: 0.165 Test Loss: 3.246 Test Acc: 0.165
Validation loss decreased (-0.159968 --> -0.164673).  Saving model ...
Epoch: 38 cost time: 1.3632802963256836
Epoch: 38, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.259 Vali Acc: 0.167 Test Loss: 3.259 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167026).  Saving model ...
Epoch: 39 cost time: 1.3556690216064453
Epoch: 39, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.283 Vali Acc: 0.164 Test Loss: 3.283 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3965418338775635
Epoch: 40, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.335 Vali Acc: 0.153 Test Loss: 3.335 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2181293964385986
Epoch: 41, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.333 Vali Acc: 0.156 Test Loss: 3.333 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3476645946502686
Epoch: 42, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.352 Vali Acc: 0.161 Test Loss: 3.352 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2150468826293945
Epoch: 43, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.367 Vali Acc: 0.151 Test Loss: 3.367 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1209979057312012
Epoch: 44, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.392 Vali Acc: 0.144 Test Loss: 3.392 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4004063606262207
Epoch: 45, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.373 Vali Acc: 0.164 Test Loss: 3.373 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3084895610809326
Epoch: 46, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.393 Vali Acc: 0.149 Test Loss: 3.393 Test Acc: 0.149
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0627765655517578
Epoch: 47, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.396 Vali Acc: 0.162 Test Loss: 3.396 Test Acc: 0.162
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9562242031097412
Epoch: 48, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.414 Vali Acc: 0.162 Test Loss: 3.414 Test Acc: 0.162
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16705882352941176
model parameter : 331726
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5086798667907715
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.316 Vali Acc: 0.040 Test Loss: 3.316 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.133457899093628
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.301 Vali Acc: 0.042 Test Loss: 3.301 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.9124484062194824
Epoch: 3, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.282 Vali Acc: 0.047 Test Loss: 3.282 Test Acc: 0.047
Validation loss decreased (-0.042320 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 1.0068702697753906
Epoch: 4, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.262 Vali Acc: 0.059 Test Loss: 3.262 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.1201224327087402
Epoch: 5, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.248 Vali Acc: 0.064 Test Loss: 3.248 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.0554425716400146
Epoch: 6, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.233 Vali Acc: 0.067 Test Loss: 3.233 Test Acc: 0.067
Validation loss decreased (-0.063497 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 1.084505319595337
Epoch: 7, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.223 Vali Acc: 0.075 Test Loss: 3.223 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 1.2863259315490723
Epoch: 8, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.213 Vali Acc: 0.086 Test Loss: 3.213 Test Acc: 0.086
Validation loss decreased (-0.075262 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 0.8403875827789307
Epoch: 9, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.207 Vali Acc: 0.089 Test Loss: 3.207 Test Acc: 0.089
Validation loss decreased (-0.085850 --> -0.089380).  Saving model ...
Epoch: 10 cost time: 1.3176798820495605
Epoch: 10, Steps: 10 | Train Loss: 2.314 Vali Loss: 3.198 Vali Acc: 0.094 Test Loss: 3.198 Test Acc: 0.094
Validation loss decreased (-0.089380 --> -0.094086).  Saving model ...
Epoch: 11 cost time: 1.1281828880310059
Epoch: 11, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.195 Vali Acc: 0.095 Test Loss: 3.195 Test Acc: 0.095
Validation loss decreased (-0.094086 --> -0.095262).  Saving model ...
Epoch: 12 cost time: 1.0710694789886475
Epoch: 12, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.187 Vali Acc: 0.100 Test Loss: 3.187 Test Acc: 0.100
Validation loss decreased (-0.095262 --> -0.099968).  Saving model ...
Epoch: 13 cost time: 1.245077133178711
Epoch: 13, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.187 Vali Acc: 0.106 Test Loss: 3.187 Test Acc: 0.106
Validation loss decreased (-0.099968 --> -0.105850).  Saving model ...
Epoch: 14 cost time: 1.0786588191986084
Epoch: 14, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.184 Vali Acc: 0.114 Test Loss: 3.184 Test Acc: 0.114
Validation loss decreased (-0.105850 --> -0.114086).  Saving model ...
Epoch: 15 cost time: 1.0595521926879883
Epoch: 15, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.181 Vali Acc: 0.120 Test Loss: 3.181 Test Acc: 0.120
Validation loss decreased (-0.114086 --> -0.119968).  Saving model ...
Epoch: 16 cost time: 0.9804883003234863
Epoch: 16, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.168 Vali Acc: 0.109 Test Loss: 3.168 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1762259006500244
Epoch: 17, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.153 Vali Acc: 0.125 Test Loss: 3.153 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124674).  Saving model ...
Epoch: 18 cost time: 1.1924328804016113
Epoch: 18, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.157 Vali Acc: 0.129 Test Loss: 3.157 Test Acc: 0.129
Validation loss decreased (-0.124674 --> -0.129380).  Saving model ...
Epoch: 19 cost time: 1.1131350994110107
Epoch: 19, Steps: 10 | Train Loss: 1.421 Vali Loss: 3.148 Vali Acc: 0.133 Test Loss: 3.148 Test Acc: 0.133
Validation loss decreased (-0.129380 --> -0.132910).  Saving model ...
Epoch: 20 cost time: 1.1345596313476562
Epoch: 20, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.147 Vali Acc: 0.139 Test Loss: 3.147 Test Acc: 0.139
Validation loss decreased (-0.132910 --> -0.138792).  Saving model ...
Epoch: 21 cost time: 0.989687442779541
Epoch: 21, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.144 Vali Acc: 0.138 Test Loss: 3.144 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0741469860076904
Epoch: 22, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.139 Vali Acc: 0.142 Test Loss: 3.139 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142322).  Saving model ...
Epoch: 23 cost time: 0.9765076637268066
Epoch: 23, Steps: 10 | Train Loss: 0.992 Vali Loss: 3.136 Vali Acc: 0.148 Test Loss: 3.136 Test Acc: 0.148
Validation loss decreased (-0.142322 --> -0.148204).  Saving model ...
Epoch: 24 cost time: 0.9648721218109131
Epoch: 24, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.140 Vali Acc: 0.149 Test Loss: 3.140 Test Acc: 0.149
Validation loss decreased (-0.148204 --> -0.149380).  Saving model ...
Epoch: 25 cost time: 1.1996304988861084
Epoch: 25, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.138 Vali Acc: 0.156 Test Loss: 3.138 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156439).  Saving model ...
Epoch: 26 cost time: 1.069077730178833
Epoch: 26, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.150 Vali Acc: 0.151 Test Loss: 3.150 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0171585083007812
Epoch: 27, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.145 Vali Acc: 0.156 Test Loss: 3.145 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8992750644683838
Epoch: 28, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.148 Vali Acc: 0.160 Test Loss: 3.148 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159969).  Saving model ...
Epoch: 29 cost time: 1.0043282508850098
Epoch: 29, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.160 Vali Acc: 0.168 Test Loss: 3.160 Test Acc: 0.168
Validation loss decreased (-0.159969 --> -0.168204).  Saving model ...
Epoch: 30 cost time: 1.112701654434204
Epoch: 30, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.183 Vali Acc: 0.155 Test Loss: 3.183 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2112066745758057
Epoch: 31, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.178 Vali Acc: 0.152 Test Loss: 3.178 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2361118793487549
Epoch: 32, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.186 Vali Acc: 0.153 Test Loss: 3.186 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.132810354232788
Epoch: 33, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.202 Vali Acc: 0.166 Test Loss: 3.202 Test Acc: 0.166
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.118518590927124
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.196 Vali Acc: 0.159 Test Loss: 3.196 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0035619735717773
Epoch: 35, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.194 Vali Acc: 0.172 Test Loss: 3.194 Test Acc: 0.172
Validation loss decreased (-0.168204 --> -0.171733).  Saving model ...
Epoch: 36 cost time: 0.9383962154388428
Epoch: 36, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.215 Vali Acc: 0.169 Test Loss: 3.215 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1947035789489746
Epoch: 37, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.225 Vali Acc: 0.169 Test Loss: 3.225 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2890501022338867
Epoch: 38, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.233 Vali Acc: 0.168 Test Loss: 3.233 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9961409568786621
Epoch: 39, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.239 Vali Acc: 0.174 Test Loss: 3.239 Test Acc: 0.174
Validation loss decreased (-0.171733 --> -0.174085).  Saving model ...
Epoch: 40 cost time: 0.9672019481658936
Epoch: 40, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.250 Vali Acc: 0.178 Test Loss: 3.250 Test Acc: 0.178
Validation loss decreased (-0.174085 --> -0.177615).  Saving model ...
Epoch: 41 cost time: 1.1714298725128174
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.252 Vali Acc: 0.175 Test Loss: 3.252 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1642568111419678
Epoch: 42, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.259 Vali Acc: 0.180 Test Loss: 3.259 Test Acc: 0.180
Validation loss decreased (-0.177615 --> -0.179967).  Saving model ...
Epoch: 43 cost time: 1.1010825634002686
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.259 Vali Acc: 0.182 Test Loss: 3.259 Test Acc: 0.182
Validation loss decreased (-0.179967 --> -0.182320).  Saving model ...
Epoch: 44 cost time: 0.9782521724700928
Epoch: 44, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.272 Vali Acc: 0.182 Test Loss: 3.272 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3621113300323486
Epoch: 45, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.282 Vali Acc: 0.184 Test Loss: 3.282 Test Acc: 0.184
Validation loss decreased (-0.182320 --> -0.183497).  Saving model ...
Epoch: 46 cost time: 0.934126615524292
Epoch: 46, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.283 Vali Acc: 0.181 Test Loss: 3.283 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0699121952056885
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.290 Vali Acc: 0.184 Test Loss: 3.290 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8841524124145508
Epoch: 48, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.295 Vali Acc: 0.179 Test Loss: 3.295 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1829032897949219
Epoch: 49, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.307 Vali Acc: 0.182 Test Loss: 3.307 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1461398601531982
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.318 Vali Acc: 0.178 Test Loss: 3.318 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0885627269744873
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.323 Vali Acc: 0.180 Test Loss: 3.323 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0027501583099365
Epoch: 52, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.325 Vali Acc: 0.185 Test Loss: 3.325 Test Acc: 0.185
Validation loss decreased (-0.183497 --> -0.184673).  Saving model ...
Epoch: 53 cost time: 1.2045562267303467
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.333 Vali Acc: 0.176 Test Loss: 3.333 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1331992149353027
Epoch: 54, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.333 Vali Acc: 0.178 Test Loss: 3.333 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2579076290130615
Epoch: 55, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.337 Vali Acc: 0.180 Test Loss: 3.337 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9031546115875244
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.341 Vali Acc: 0.178 Test Loss: 3.341 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.025467872619629
Epoch: 57, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.340 Vali Acc: 0.174 Test Loss: 3.340 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.1491789817810059
Epoch: 58, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.341 Vali Acc: 0.174 Test Loss: 3.341 Test Acc: 0.174
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2624542713165283
Epoch: 59, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.343 Vali Acc: 0.176 Test Loss: 3.343 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.1684608459472656
Epoch: 60, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.346 Vali Acc: 0.179 Test Loss: 3.346 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.0295112133026123
Epoch: 61, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.351 Vali Acc: 0.180 Test Loss: 3.351 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.2901811599731445
Epoch: 62, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.360 Vali Acc: 0.179 Test Loss: 3.360 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 328654
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0374276638031006
Epoch: 1, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.289 Vali Acc: 0.047 Test Loss: 3.289 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.8795387744903564
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.277 Vali Acc: 0.059 Test Loss: 3.277 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 0.7896368503570557
Epoch: 3, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.266 Vali Acc: 0.053 Test Loss: 3.266 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8294260501861572
Epoch: 4, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.259 Vali Acc: 0.059 Test Loss: 3.259 Test Acc: 0.059
Validation loss decreased (-0.058791 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.8702895641326904
Epoch: 5, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.255 Vali Acc: 0.064 Test Loss: 3.255 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.7441134452819824
Epoch: 6, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.252 Vali Acc: 0.066 Test Loss: 3.252 Test Acc: 0.066
Validation loss decreased (-0.063497 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 0.6873993873596191
Epoch: 7, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.249 Vali Acc: 0.078 Test Loss: 3.249 Test Acc: 0.078
Validation loss decreased (-0.065850 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 0.8301715850830078
Epoch: 8, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.243 Vali Acc: 0.081 Test Loss: 3.243 Test Acc: 0.081
Validation loss decreased (-0.077615 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 0.7373964786529541
Epoch: 9, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.239 Vali Acc: 0.087 Test Loss: 3.239 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 0.7554969787597656
Epoch: 10, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.231 Vali Acc: 0.087 Test Loss: 3.231 Test Acc: 0.087
Validation loss decreased (-0.087026 --> -0.087027).  Saving model ...
Epoch: 11 cost time: 0.9353294372558594
Epoch: 11, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.225 Vali Acc: 0.095 Test Loss: 3.225 Test Acc: 0.095
Validation loss decreased (-0.087027 --> -0.095262).  Saving model ...
Epoch: 12 cost time: 0.7473015785217285
Epoch: 12, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.222 Vali Acc: 0.101 Test Loss: 3.222 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 13 cost time: 0.74188232421875
Epoch: 13, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.221 Vali Acc: 0.104 Test Loss: 3.221 Test Acc: 0.104
Validation loss decreased (-0.101144 --> -0.103497).  Saving model ...
Epoch: 14 cost time: 1.0733833312988281
Epoch: 14, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.207 Vali Acc: 0.115 Test Loss: 3.207 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115262).  Saving model ...
Epoch: 15 cost time: 0.8890149593353271
Epoch: 15, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.204 Vali Acc: 0.120 Test Loss: 3.204 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 16 cost time: 0.7370550632476807
Epoch: 16, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.194 Vali Acc: 0.126 Test Loss: 3.194 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 17 cost time: 1.1151010990142822
Epoch: 17, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.186 Vali Acc: 0.135 Test Loss: 3.186 Test Acc: 0.135
Validation loss decreased (-0.125850 --> -0.135262).  Saving model ...
Epoch: 18 cost time: 0.9931948184967041
Epoch: 18, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.181 Vali Acc: 0.134 Test Loss: 3.181 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1718246936798096
Epoch: 19, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.183 Vali Acc: 0.145 Test Loss: 3.183 Test Acc: 0.145
Validation loss decreased (-0.135262 --> -0.144674).  Saving model ...
Epoch: 20 cost time: 0.8163187503814697
Epoch: 20, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.177 Vali Acc: 0.147 Test Loss: 3.177 Test Acc: 0.147
Validation loss decreased (-0.144674 --> -0.147027).  Saving model ...
Epoch: 21 cost time: 0.966223955154419
Epoch: 21, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.171 Vali Acc: 0.147 Test Loss: 3.171 Test Acc: 0.147
Validation loss decreased (-0.147027 --> -0.147027).  Saving model ...
Epoch: 22 cost time: 1.0700294971466064
Epoch: 22, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.171 Vali Acc: 0.153 Test Loss: 3.171 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152909).  Saving model ...
Epoch: 23 cost time: 0.8764200210571289
Epoch: 23, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.159 Vali Acc: 0.155 Test Loss: 3.159 Test Acc: 0.155
Validation loss decreased (-0.152909 --> -0.155263).  Saving model ...
Epoch: 24 cost time: 0.9330284595489502
Epoch: 24, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.156 Vali Acc: 0.159 Test Loss: 3.156 Test Acc: 0.159
Validation loss decreased (-0.155263 --> -0.158792).  Saving model ...
Epoch: 25 cost time: 1.1933808326721191
Epoch: 25, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.162 Vali Acc: 0.164 Test Loss: 3.162 Test Acc: 0.164
Validation loss decreased (-0.158792 --> -0.163498).  Saving model ...
Epoch: 26 cost time: 0.9107253551483154
Epoch: 26, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.167 Vali Acc: 0.168 Test Loss: 3.167 Test Acc: 0.168
Validation loss decreased (-0.163498 --> -0.168204).  Saving model ...
Epoch: 27 cost time: 0.883551836013794
Epoch: 27, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.181 Vali Acc: 0.165 Test Loss: 3.181 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0548043251037598
Epoch: 28, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.177 Vali Acc: 0.161 Test Loss: 3.177 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9156427383422852
Epoch: 29, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.179 Vali Acc: 0.162 Test Loss: 3.179 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.793182373046875
Epoch: 30, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.186 Vali Acc: 0.168 Test Loss: 3.186 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9349260330200195
Epoch: 31, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.185 Vali Acc: 0.168 Test Loss: 3.185 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9659855365753174
Epoch: 32, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.205 Vali Acc: 0.167 Test Loss: 3.205 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9453928470611572
Epoch: 33, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.218 Vali Acc: 0.159 Test Loss: 3.218 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9449975490570068
Epoch: 34, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.225 Vali Acc: 0.165 Test Loss: 3.225 Test Acc: 0.165
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9309508800506592
Epoch: 35, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.224 Vali Acc: 0.166 Test Loss: 3.224 Test Acc: 0.166
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0073871612548828
Epoch: 36, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.230 Vali Acc: 0.162 Test Loss: 3.230 Test Acc: 0.162
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16823529411764707
model parameter : 327630
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.977555751800537
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.291 Vali Acc: 0.038 Test Loss: 3.291 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.7906520366668701
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.279 Vali Acc: 0.042 Test Loss: 3.279 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.9134089946746826
Epoch: 3, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.269 Vali Acc: 0.046 Test Loss: 3.269 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 1.0747365951538086
Epoch: 4, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.259 Vali Acc: 0.047 Test Loss: 3.259 Test Acc: 0.047
Validation loss decreased (-0.045850 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.755669116973877
Epoch: 5, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.248 Vali Acc: 0.059 Test Loss: 3.248 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 0.8653438091278076
Epoch: 6, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.242 Vali Acc: 0.076 Test Loss: 3.242 Test Acc: 0.076
Validation loss decreased (-0.058791 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.1359992027282715
Epoch: 7, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.234 Vali Acc: 0.086 Test Loss: 3.234 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 1.1043014526367188
Epoch: 8, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.228 Vali Acc: 0.092 Test Loss: 3.228 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.9796617031097412
Epoch: 9, Steps: 10 | Train Loss: 2.202 Vali Loss: 3.224 Vali Acc: 0.098 Test Loss: 3.224 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097615).  Saving model ...
Epoch: 10 cost time: 0.8345000743865967
Epoch: 10, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.217 Vali Acc: 0.101 Test Loss: 3.217 Test Acc: 0.101
Validation loss decreased (-0.097615 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.9771275520324707
Epoch: 11, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.209 Vali Acc: 0.118 Test Loss: 3.209 Test Acc: 0.118
Validation loss decreased (-0.101144 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 1.0334982872009277
Epoch: 12, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.201 Vali Acc: 0.127 Test Loss: 3.201 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.8520362377166748
Epoch: 13, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.189 Vali Acc: 0.127 Test Loss: 3.189 Test Acc: 0.127
Validation loss decreased (-0.127027 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.8459594249725342
Epoch: 14, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.181 Vali Acc: 0.125 Test Loss: 3.181 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0413289070129395
Epoch: 15, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.176 Vali Acc: 0.132 Test Loss: 3.176 Test Acc: 0.132
Validation loss decreased (-0.127027 --> -0.131733).  Saving model ...
Epoch: 16 cost time: 1.1214323043823242
Epoch: 16, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.170 Vali Acc: 0.136 Test Loss: 3.170 Test Acc: 0.136
Validation loss decreased (-0.131733 --> -0.136439).  Saving model ...
Epoch: 17 cost time: 0.9970097541809082
Epoch: 17, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.167 Vali Acc: 0.141 Test Loss: 3.167 Test Acc: 0.141
Validation loss decreased (-0.136439 --> -0.141145).  Saving model ...
Epoch: 18 cost time: 0.8758974075317383
Epoch: 18, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.164 Vali Acc: 0.146 Test Loss: 3.164 Test Acc: 0.146
Validation loss decreased (-0.141145 --> -0.145851).  Saving model ...
Epoch: 19 cost time: 0.9219157695770264
Epoch: 19, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.157 Vali Acc: 0.146 Test Loss: 3.157 Test Acc: 0.146
Validation loss decreased (-0.145851 --> -0.145851).  Saving model ...
Epoch: 20 cost time: 1.1151373386383057
Epoch: 20, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.157 Vali Acc: 0.154 Test Loss: 3.157 Test Acc: 0.154
Validation loss decreased (-0.145851 --> -0.154086).  Saving model ...
Epoch: 21 cost time: 0.9517126083374023
Epoch: 21, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.157 Vali Acc: 0.156 Test Loss: 3.157 Test Acc: 0.156
Validation loss decreased (-0.154086 --> -0.156439).  Saving model ...
Epoch: 22 cost time: 0.8978297710418701
Epoch: 22, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.144 Vali Acc: 0.169 Test Loss: 3.144 Test Acc: 0.169
Validation loss decreased (-0.156439 --> -0.169380).  Saving model ...
Epoch: 23 cost time: 0.8614513874053955
Epoch: 23, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.126 Vali Acc: 0.167 Test Loss: 3.126 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.244067907333374
Epoch: 24, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.145 Vali Acc: 0.162 Test Loss: 3.145 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8852920532226562
Epoch: 25, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.145 Vali Acc: 0.172 Test Loss: 3.145 Test Acc: 0.172
Validation loss decreased (-0.169380 --> -0.171733).  Saving model ...
Epoch: 26 cost time: 0.8309459686279297
Epoch: 26, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.148 Vali Acc: 0.181 Test Loss: 3.148 Test Acc: 0.181
Validation loss decreased (-0.171733 --> -0.181145).  Saving model ...
Epoch: 27 cost time: 0.7495908737182617
Epoch: 27, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.148 Vali Acc: 0.184 Test Loss: 3.148 Test Acc: 0.184
Validation loss decreased (-0.181145 --> -0.183498).  Saving model ...
Epoch: 28 cost time: 0.9313671588897705
Epoch: 28, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.155 Vali Acc: 0.175 Test Loss: 3.155 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9079358577728271
Epoch: 29, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.174 Vali Acc: 0.172 Test Loss: 3.174 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8887953758239746
Epoch: 30, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.169 Vali Acc: 0.169 Test Loss: 3.169 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0204734802246094
Epoch: 31, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.180 Vali Acc: 0.187 Test Loss: 3.180 Test Acc: 0.187
Validation loss decreased (-0.183498 --> -0.187027).  Saving model ...
Epoch: 32 cost time: 1.1377763748168945
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.183 Vali Acc: 0.189 Test Loss: 3.183 Test Acc: 0.189
Validation loss decreased (-0.187027 --> -0.189380).  Saving model ...
Epoch: 33 cost time: 0.8890750408172607
Epoch: 33, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.195 Vali Acc: 0.182 Test Loss: 3.195 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9165301322937012
Epoch: 34, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.212 Vali Acc: 0.180 Test Loss: 3.212 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9640247821807861
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.220 Vali Acc: 0.184 Test Loss: 3.220 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.95682692527771
Epoch: 36, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.211 Vali Acc: 0.186 Test Loss: 3.211 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8999125957489014
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.202 Vali Acc: 0.191 Test Loss: 3.202 Test Acc: 0.191
Validation loss decreased (-0.189380 --> -0.190556).  Saving model ...
Epoch: 38 cost time: 0.8606774806976318
Epoch: 38, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.210 Vali Acc: 0.186 Test Loss: 3.210 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8290548324584961
Epoch: 39, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.209 Vali Acc: 0.189 Test Loss: 3.209 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4660718441009521
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.207 Vali Acc: 0.186 Test Loss: 3.207 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8646070957183838
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.214 Vali Acc: 0.188 Test Loss: 3.214 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.877403736114502
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.218 Vali Acc: 0.185 Test Loss: 3.218 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9484903812408447
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.221 Vali Acc: 0.189 Test Loss: 3.221 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8531284332275391
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.227 Vali Acc: 0.185 Test Loss: 3.227 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7680032253265381
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.231 Vali Acc: 0.189 Test Loss: 3.231 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9206500053405762
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.237 Vali Acc: 0.189 Test Loss: 3.237 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0634417533874512
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.240 Vali Acc: 0.184 Test Loss: 3.240 Test Acc: 0.184
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19058823529411764
model parameter : 325582
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6390857696533203
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.286 Vali Acc: 0.039 Test Loss: 3.286 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.8864562511444092
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.272 Vali Acc: 0.040 Test Loss: 3.272 Test Acc: 0.040
Validation loss decreased (-0.038791 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.9630563259124756
Epoch: 3, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.258 Vali Acc: 0.052 Test Loss: 3.258 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.9642434120178223
Epoch: 4, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.245 Vali Acc: 0.064 Test Loss: 3.245 Test Acc: 0.064
Validation loss decreased (-0.051732 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.7441391944885254
Epoch: 5, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.232 Vali Acc: 0.069 Test Loss: 3.232 Test Acc: 0.069
Validation loss decreased (-0.063497 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.9085266590118408
Epoch: 6, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.221 Vali Acc: 0.080 Test Loss: 3.221 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079968).  Saving model ...
Epoch: 7 cost time: 0.7427942752838135
Epoch: 7, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.209 Vali Acc: 0.084 Test Loss: 3.209 Test Acc: 0.084
Validation loss decreased (-0.079968 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.8831737041473389
Epoch: 8, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.202 Vali Acc: 0.091 Test Loss: 3.202 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.6725614070892334
Epoch: 9, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.200 Vali Acc: 0.089 Test Loss: 3.200 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7190346717834473
Epoch: 10, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.190 Vali Acc: 0.094 Test Loss: 3.190 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094086).  Saving model ...
Epoch: 11 cost time: 0.859346866607666
Epoch: 11, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.184 Vali Acc: 0.099 Test Loss: 3.184 Test Acc: 0.099
Validation loss decreased (-0.094086 --> -0.098792).  Saving model ...
Epoch: 12 cost time: 0.8498497009277344
Epoch: 12, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.180 Vali Acc: 0.107 Test Loss: 3.180 Test Acc: 0.107
Validation loss decreased (-0.098792 --> -0.107027).  Saving model ...
Epoch: 13 cost time: 0.8542771339416504
Epoch: 13, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.177 Vali Acc: 0.109 Test Loss: 3.177 Test Acc: 0.109
Validation loss decreased (-0.107027 --> -0.109380).  Saving model ...
Epoch: 14 cost time: 0.8465456962585449
Epoch: 14, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.165 Vali Acc: 0.126 Test Loss: 3.165 Test Acc: 0.126
Validation loss decreased (-0.109380 --> -0.125851).  Saving model ...
Epoch: 15 cost time: 0.8386807441711426
Epoch: 15, Steps: 10 | Train Loss: 1.644 Vali Loss: 3.163 Vali Acc: 0.119 Test Loss: 3.163 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6941044330596924
Epoch: 16, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.152 Vali Acc: 0.127 Test Loss: 3.152 Test Acc: 0.127
Validation loss decreased (-0.125851 --> -0.127027).  Saving model ...
Epoch: 17 cost time: 0.5909116268157959
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.150 Vali Acc: 0.134 Test Loss: 3.150 Test Acc: 0.134
Validation loss decreased (-0.127027 --> -0.134086).  Saving model ...
Epoch: 18 cost time: 0.7944254875183105
Epoch: 18, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.144 Vali Acc: 0.140 Test Loss: 3.144 Test Acc: 0.140
Validation loss decreased (-0.134086 --> -0.139969).  Saving model ...
Epoch: 19 cost time: 0.7613787651062012
Epoch: 19, Steps: 10 | Train Loss: 1.129 Vali Loss: 3.152 Vali Acc: 0.139 Test Loss: 3.152 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7621715068817139
Epoch: 20, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.152 Vali Acc: 0.145 Test Loss: 3.152 Test Acc: 0.145
Validation loss decreased (-0.139969 --> -0.144674).  Saving model ...
Epoch: 21 cost time: 0.686913013458252
Epoch: 21, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.139 Vali Acc: 0.152 Test Loss: 3.139 Test Acc: 0.152
Validation loss decreased (-0.144674 --> -0.151733).  Saving model ...
Epoch: 22 cost time: 0.8999416828155518
Epoch: 22, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.145 Vali Acc: 0.156 Test Loss: 3.145 Test Acc: 0.156
Validation loss decreased (-0.151733 --> -0.156439).  Saving model ...
Epoch: 23 cost time: 0.8177223205566406
Epoch: 23, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.143 Vali Acc: 0.172 Test Loss: 3.143 Test Acc: 0.172
Validation loss decreased (-0.156439 --> -0.171733).  Saving model ...
Epoch: 24 cost time: 0.8107657432556152
Epoch: 24, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.156 Vali Acc: 0.173 Test Loss: 3.156 Test Acc: 0.173
Validation loss decreased (-0.171733 --> -0.172910).  Saving model ...
Epoch: 25 cost time: 0.8197965621948242
Epoch: 25, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.156 Vali Acc: 0.161 Test Loss: 3.156 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8147323131561279
Epoch: 26, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.167 Vali Acc: 0.167 Test Loss: 3.167 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7880284786224365
Epoch: 27, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.176 Vali Acc: 0.161 Test Loss: 3.176 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9256584644317627
Epoch: 28, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.178 Vali Acc: 0.168 Test Loss: 3.178 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7659828662872314
Epoch: 29, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.183 Vali Acc: 0.171 Test Loss: 3.183 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9098730087280273
Epoch: 30, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.191 Vali Acc: 0.173 Test Loss: 3.191 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6437427997589111
Epoch: 31, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.194 Vali Acc: 0.176 Test Loss: 3.194 Test Acc: 0.176
Validation loss decreased (-0.172910 --> -0.176439).  Saving model ...
Epoch: 32 cost time: 0.7731375694274902
Epoch: 32, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.207 Vali Acc: 0.181 Test Loss: 3.207 Test Acc: 0.181
Validation loss decreased (-0.176439 --> -0.181144).  Saving model ...
Epoch: 33 cost time: 0.9122123718261719
Epoch: 33, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.218 Vali Acc: 0.166 Test Loss: 3.218 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.807267427444458
Epoch: 34, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.216 Vali Acc: 0.166 Test Loss: 3.216 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8930790424346924
Epoch: 35, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.232 Vali Acc: 0.168 Test Loss: 3.232 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8945255279541016
Epoch: 36, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.238 Vali Acc: 0.169 Test Loss: 3.238 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8697829246520996
Epoch: 37, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.252 Vali Acc: 0.174 Test Loss: 3.252 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8071389198303223
Epoch: 38, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.259 Vali Acc: 0.175 Test Loss: 3.259 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9657199382781982
Epoch: 39, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.265 Vali Acc: 0.175 Test Loss: 3.265 Test Acc: 0.175
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8090860843658447
Epoch: 40, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.269 Vali Acc: 0.171 Test Loss: 3.269 Test Acc: 0.171
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7910277843475342
Epoch: 41, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.278 Vali Acc: 0.179 Test Loss: 3.278 Test Acc: 0.179
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0042881965637207
Epoch: 42, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.287 Vali Acc: 0.178 Test Loss: 3.287 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1811764705882353
model parameter : 324558
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.416123628616333
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.327 Vali Acc: 0.035 Test Loss: 3.327 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.3522872924804688
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.310 Vali Acc: 0.051 Test Loss: 3.310 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.5298545360565186
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.297 Vali Acc: 0.055 Test Loss: 3.297 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 1.6229770183563232
Epoch: 4, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.287 Vali Acc: 0.059 Test Loss: 3.287 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.5746238231658936
Epoch: 5, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.280 Vali Acc: 0.056 Test Loss: 3.280 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6651558876037598
Epoch: 6, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.272 Vali Acc: 0.066 Test Loss: 3.272 Test Acc: 0.066
Validation loss decreased (-0.058791 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 1.8940155506134033
Epoch: 7, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.265 Vali Acc: 0.064 Test Loss: 3.265 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.716672658920288
Epoch: 8, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.255 Vali Acc: 0.067 Test Loss: 3.255 Test Acc: 0.067
Validation loss decreased (-0.065850 --> -0.067026).  Saving model ...
Epoch: 9 cost time: 1.8228342533111572
Epoch: 9, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.259 Vali Acc: 0.073 Test Loss: 3.259 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072909).  Saving model ...
Epoch: 10 cost time: 1.9779880046844482
Epoch: 10, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.267 Vali Acc: 0.085 Test Loss: 3.267 Test Acc: 0.085
Validation loss decreased (-0.072909 --> -0.084673).  Saving model ...
Epoch: 11 cost time: 1.7630937099456787
Epoch: 11, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.256 Vali Acc: 0.087 Test Loss: 3.256 Test Acc: 0.087
Validation loss decreased (-0.084673 --> -0.087026).  Saving model ...
Epoch: 12 cost time: 1.9062750339508057
Epoch: 12, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.262 Vali Acc: 0.084 Test Loss: 3.262 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9437401294708252
Epoch: 13, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.255 Vali Acc: 0.100 Test Loss: 3.255 Test Acc: 0.100
Validation loss decreased (-0.087026 --> -0.099967).  Saving model ...
Epoch: 14 cost time: 1.9138600826263428
Epoch: 14, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.274 Vali Acc: 0.095 Test Loss: 3.274 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7848601341247559
Epoch: 15, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.257 Vali Acc: 0.091 Test Loss: 3.257 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.904564619064331
Epoch: 16, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.259 Vali Acc: 0.099 Test Loss: 3.259 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9569149017333984
Epoch: 17, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.264 Vali Acc: 0.099 Test Loss: 3.264 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1460165977478027
Epoch: 18, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.269 Vali Acc: 0.095 Test Loss: 3.269 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8890259265899658
Epoch: 19, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.257 Vali Acc: 0.098 Test Loss: 3.257 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5450658798217773
Epoch: 20, Steps: 10 | Train Loss: 1.237 Vali Loss: 3.270 Vali Acc: 0.104 Test Loss: 3.270 Test Acc: 0.104
Validation loss decreased (-0.099967 --> -0.103497).  Saving model ...
Epoch: 21 cost time: 1.7628095149993896
Epoch: 21, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.283 Vali Acc: 0.108 Test Loss: 3.283 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108202).  Saving model ...
Epoch: 22 cost time: 1.8185079097747803
Epoch: 22, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.289 Vali Acc: 0.109 Test Loss: 3.289 Test Acc: 0.109
Validation loss decreased (-0.108202 --> -0.109379).  Saving model ...
Epoch: 23 cost time: 1.75944185256958
Epoch: 23, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.303 Vali Acc: 0.102 Test Loss: 3.303 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.484269380569458
Epoch: 24, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6454823017120361
Epoch: 25, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.310 Vali Acc: 0.111 Test Loss: 3.310 Test Acc: 0.111
Validation loss decreased (-0.109379 --> -0.110555).  Saving model ...
Epoch: 26 cost time: 1.6696085929870605
Epoch: 26, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.301 Vali Acc: 0.115 Test Loss: 3.301 Test Acc: 0.115
Validation loss decreased (-0.110555 --> -0.115261).  Saving model ...
Epoch: 27 cost time: 1.7593486309051514
Epoch: 27, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.309 Vali Acc: 0.126 Test Loss: 3.309 Test Acc: 0.126
Validation loss decreased (-0.115261 --> -0.125849).  Saving model ...
Epoch: 28 cost time: 1.2874717712402344
Epoch: 28, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.322 Vali Acc: 0.125 Test Loss: 3.322 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2557461261749268
Epoch: 29, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.341 Vali Acc: 0.127 Test Loss: 3.341 Test Acc: 0.127
Validation loss decreased (-0.125849 --> -0.127025).  Saving model ...
Epoch: 30 cost time: 1.7395312786102295
Epoch: 30, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.351 Vali Acc: 0.131 Test Loss: 3.351 Test Acc: 0.131
Validation loss decreased (-0.127025 --> -0.130555).  Saving model ...
Epoch: 31 cost time: 1.6949782371520996
Epoch: 31, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.367 Vali Acc: 0.133 Test Loss: 3.367 Test Acc: 0.133
Validation loss decreased (-0.130555 --> -0.132908).  Saving model ...
Epoch: 32 cost time: 2.046586036682129
Epoch: 32, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.369 Vali Acc: 0.132 Test Loss: 3.369 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5764641761779785
Epoch: 33, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.400 Vali Acc: 0.138 Test Loss: 3.400 Test Acc: 0.138
Validation loss decreased (-0.132908 --> -0.137613).  Saving model ...
Epoch: 34 cost time: 1.8653450012207031
Epoch: 34, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.381 Vali Acc: 0.140 Test Loss: 3.381 Test Acc: 0.140
Validation loss decreased (-0.137613 --> -0.139966).  Saving model ...
Epoch: 35 cost time: 1.7644381523132324
Epoch: 35, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.408 Vali Acc: 0.136 Test Loss: 3.408 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5312483310699463
Epoch: 36, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.410 Vali Acc: 0.139 Test Loss: 3.410 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4971082210540771
Epoch: 37, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.439 Vali Acc: 0.149 Test Loss: 3.439 Test Acc: 0.149
Validation loss decreased (-0.139966 --> -0.149377).  Saving model ...
Epoch: 38 cost time: 1.7041192054748535
Epoch: 38, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.494 Vali Acc: 0.142 Test Loss: 3.494 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7282569408416748
Epoch: 39, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.503 Vali Acc: 0.136 Test Loss: 3.503 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7666678428649902
Epoch: 40, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.517 Vali Acc: 0.134 Test Loss: 3.517 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4632365703582764
Epoch: 41, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.545 Vali Acc: 0.132 Test Loss: 3.545 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3768529891967773
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.566 Vali Acc: 0.135 Test Loss: 3.566 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.486659288406372
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.601 Vali Acc: 0.148 Test Loss: 3.601 Test Acc: 0.148
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8606622219085693
Epoch: 44, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.621 Vali Acc: 0.136 Test Loss: 3.621 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8146297931671143
Epoch: 45, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.639 Vali Acc: 0.140 Test Loss: 3.639 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.7525882720947266
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.646 Vali Acc: 0.141 Test Loss: 3.646 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.426868200302124
Epoch: 47, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.646 Vali Acc: 0.140 Test Loss: 3.646 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 342956
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.356302499771118
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.308 Vali Acc: 0.041 Test Loss: 3.308 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.9350128173828125
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.297 Vali Acc: 0.040 Test Loss: 3.297 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6777801513671875
Epoch: 3, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.287 Vali Acc: 0.048 Test Loss: 3.287 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 1.4808275699615479
Epoch: 4, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.274 Vali Acc: 0.060 Test Loss: 3.274 Test Acc: 0.060
Validation loss decreased (-0.048202 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.4800357818603516
Epoch: 5, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.269 Vali Acc: 0.068 Test Loss: 3.269 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 1.6199796199798584
Epoch: 6, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.260 Vali Acc: 0.073 Test Loss: 3.260 Test Acc: 0.073
Validation loss decreased (-0.068203 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 1.455409288406372
Epoch: 7, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.253 Vali Acc: 0.082 Test Loss: 3.253 Test Acc: 0.082
Validation loss decreased (-0.072909 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 1.2931041717529297
Epoch: 8, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.237 Vali Acc: 0.099 Test Loss: 3.237 Test Acc: 0.099
Validation loss decreased (-0.082320 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.3377015590667725
Epoch: 9, Steps: 10 | Train Loss: 2.207 Vali Loss: 3.227 Vali Acc: 0.107 Test Loss: 3.227 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 1.4341557025909424
Epoch: 10, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.231 Vali Acc: 0.105 Test Loss: 3.231 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5205907821655273
Epoch: 11, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.239 Vali Acc: 0.093 Test Loss: 3.239 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5856969356536865
Epoch: 12, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.228 Vali Acc: 0.093 Test Loss: 3.228 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4447705745697021
Epoch: 13, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.225 Vali Acc: 0.108 Test Loss: 3.225 Test Acc: 0.108
Validation loss decreased (-0.107027 --> -0.108203).  Saving model ...
Epoch: 14 cost time: 1.5561439990997314
Epoch: 14, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.233 Vali Acc: 0.101 Test Loss: 3.233 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.565256118774414
Epoch: 15, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.232 Vali Acc: 0.101 Test Loss: 3.232 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6287713050842285
Epoch: 16, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.235 Vali Acc: 0.104 Test Loss: 3.235 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4007568359375
Epoch: 17, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.248 Vali Acc: 0.111 Test Loss: 3.248 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 18 cost time: 1.3648929595947266
Epoch: 18, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.239 Vali Acc: 0.108 Test Loss: 3.239 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5546612739562988
Epoch: 19, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.243 Vali Acc: 0.122 Test Loss: 3.243 Test Acc: 0.122
Validation loss decreased (-0.110556 --> -0.122321).  Saving model ...
Epoch: 20 cost time: 1.7371764183044434
Epoch: 20, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.259 Vali Acc: 0.115 Test Loss: 3.259 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.949681282043457
Epoch: 21, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.264 Vali Acc: 0.102 Test Loss: 3.264 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6884851455688477
Epoch: 22, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.278 Vali Acc: 0.118 Test Loss: 3.278 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8097212314605713
Epoch: 23, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.257 Vali Acc: 0.118 Test Loss: 3.257 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5829367637634277
Epoch: 24, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.259 Vali Acc: 0.127 Test Loss: 3.259 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127026).  Saving model ...
Epoch: 25 cost time: 1.5712716579437256
Epoch: 25, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.268 Vali Acc: 0.128 Test Loss: 3.268 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128203).  Saving model ...
Epoch: 26 cost time: 1.2779591083526611
Epoch: 26, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.295 Vali Acc: 0.129 Test Loss: 3.295 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 27 cost time: 1.4321396350860596
Epoch: 27, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.305 Vali Acc: 0.135 Test Loss: 3.305 Test Acc: 0.135
Validation loss decreased (-0.129379 --> -0.135261).  Saving model ...
Epoch: 28 cost time: 1.4960660934448242
Epoch: 28, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.298 Vali Acc: 0.136 Test Loss: 3.298 Test Acc: 0.136
Validation loss decreased (-0.135261 --> -0.136438).  Saving model ...
Epoch: 29 cost time: 1.3193402290344238
Epoch: 29, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.309 Vali Acc: 0.132 Test Loss: 3.309 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.373948335647583
Epoch: 30, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.353 Vali Acc: 0.120 Test Loss: 3.353 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.283942461013794
Epoch: 31, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.354 Vali Acc: 0.132 Test Loss: 3.354 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6302473545074463
Epoch: 32, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.363 Vali Acc: 0.121 Test Loss: 3.363 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5986311435699463
Epoch: 33, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.368 Vali Acc: 0.131 Test Loss: 3.368 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.495934009552002
Epoch: 34, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.413 Vali Acc: 0.132 Test Loss: 3.413 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4081132411956787
Epoch: 35, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.412 Vali Acc: 0.122 Test Loss: 3.412 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.498807668685913
Epoch: 36, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.432 Vali Acc: 0.138 Test Loss: 3.432 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137613).  Saving model ...
Epoch: 37 cost time: 1.8404550552368164
Epoch: 37, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.428 Vali Acc: 0.139 Test Loss: 3.428 Test Acc: 0.139
Validation loss decreased (-0.137613 --> -0.138789).  Saving model ...
Epoch: 38 cost time: 1.2599644660949707
Epoch: 38, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.436 Vali Acc: 0.136 Test Loss: 3.436 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5661790370941162
Epoch: 39, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.448 Vali Acc: 0.142 Test Loss: 3.448 Test Acc: 0.142
Validation loss decreased (-0.138789 --> -0.142318).  Saving model ...
Epoch: 40 cost time: 1.3908107280731201
Epoch: 40, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.492 Vali Acc: 0.141 Test Loss: 3.492 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6155290603637695
Epoch: 41, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.514 Vali Acc: 0.144 Test Loss: 3.514 Test Acc: 0.144
Validation loss decreased (-0.142318 --> -0.143494).  Saving model ...
Epoch: 42 cost time: 1.2305948734283447
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.500 Vali Acc: 0.148 Test Loss: 3.500 Test Acc: 0.148
Validation loss decreased (-0.143494 --> -0.148200).  Saving model ...
Epoch: 43 cost time: 1.6753199100494385
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.526 Vali Acc: 0.156 Test Loss: 3.526 Test Acc: 0.156
Validation loss decreased (-0.148200 --> -0.156435).  Saving model ...
Epoch: 44 cost time: 1.4235129356384277
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.542 Vali Acc: 0.155 Test Loss: 3.542 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3769786357879639
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.552 Vali Acc: 0.149 Test Loss: 3.552 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4344990253448486
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.562 Vali Acc: 0.155 Test Loss: 3.562 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3908607959747314
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.571 Vali Acc: 0.152 Test Loss: 3.571 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.484100341796875
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.578 Vali Acc: 0.152 Test Loss: 3.578 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.624809980392456
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.589 Vali Acc: 0.151 Test Loss: 3.589 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.573899269104004
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.593 Vali Acc: 0.148 Test Loss: 3.593 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.0083234310150146
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.601 Vali Acc: 0.153 Test Loss: 3.601 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2695159912109375
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.605 Vali Acc: 0.149 Test Loss: 3.605 Test Acc: 0.149
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.9093728065490723
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.610 Vali Acc: 0.148 Test Loss: 3.610 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1564705882352941
model parameter : 339884
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.758997917175293
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.306 Vali Acc: 0.033 Test Loss: 3.306 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.1667225360870361
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.292 Vali Acc: 0.035 Test Loss: 3.292 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.30263352394104
Epoch: 3, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.275 Vali Acc: 0.045 Test Loss: 3.275 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.2804036140441895
Epoch: 4, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.257 Vali Acc: 0.056 Test Loss: 3.257 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.3929097652435303
Epoch: 5, Steps: 10 | Train Loss: 2.660 Vali Loss: 3.247 Vali Acc: 0.059 Test Loss: 3.247 Test Acc: 0.059
Validation loss decreased (-0.056438 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 1.0812883377075195
Epoch: 6, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.229 Vali Acc: 0.072 Test Loss: 3.229 Test Acc: 0.072
Validation loss decreased (-0.058791 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 1.1092774868011475
Epoch: 7, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.224 Vali Acc: 0.078 Test Loss: 3.224 Test Acc: 0.078
Validation loss decreased (-0.071732 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 1.286217212677002
Epoch: 8, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.220 Vali Acc: 0.068 Test Loss: 3.220 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1674888134002686
Epoch: 9, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.216 Vali Acc: 0.080 Test Loss: 3.216 Test Acc: 0.080
Validation loss decreased (-0.077615 --> -0.079968).  Saving model ...
Epoch: 10 cost time: 1.3961174488067627
Epoch: 10, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.206 Vali Acc: 0.094 Test Loss: 3.206 Test Acc: 0.094
Validation loss decreased (-0.079968 --> -0.094086).  Saving model ...
Epoch: 11 cost time: 1.054048776626587
Epoch: 11, Steps: 10 | Train Loss: 1.974 Vali Loss: 3.205 Vali Acc: 0.092 Test Loss: 3.205 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.198329210281372
Epoch: 12, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.203 Vali Acc: 0.094 Test Loss: 3.203 Test Acc: 0.094
Validation loss decreased (-0.094086 --> -0.094086).  Saving model ...
Epoch: 13 cost time: 1.2181060314178467
Epoch: 13, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.198 Vali Acc: 0.107 Test Loss: 3.198 Test Acc: 0.107
Validation loss decreased (-0.094086 --> -0.107027).  Saving model ...
Epoch: 14 cost time: 1.3870015144348145
Epoch: 14, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.204 Vali Acc: 0.099 Test Loss: 3.204 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3136827945709229
Epoch: 15, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.204 Vali Acc: 0.107 Test Loss: 3.204 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3184428215026855
Epoch: 16, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.209 Vali Acc: 0.102 Test Loss: 3.209 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1872472763061523
Epoch: 17, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.204 Vali Acc: 0.106 Test Loss: 3.204 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.17293119430542
Epoch: 18, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.203 Vali Acc: 0.113 Test Loss: 3.203 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 19 cost time: 1.409644365310669
Epoch: 19, Steps: 10 | Train Loss: 1.079 Vali Loss: 3.203 Vali Acc: 0.114 Test Loss: 3.203 Test Acc: 0.114
Validation loss decreased (-0.112909 --> -0.114086).  Saving model ...
Epoch: 20 cost time: 1.281071662902832
Epoch: 20, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.208 Vali Acc: 0.121 Test Loss: 3.208 Test Acc: 0.121
Validation loss decreased (-0.114086 --> -0.121144).  Saving model ...
Epoch: 21 cost time: 1.54034423828125
Epoch: 21, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.211 Vali Acc: 0.127 Test Loss: 3.211 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127027).  Saving model ...
Epoch: 22 cost time: 1.3523468971252441
Epoch: 22, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.217 Vali Acc: 0.120 Test Loss: 3.217 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.680927038192749
Epoch: 23, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.233 Vali Acc: 0.116 Test Loss: 3.233 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3659412860870361
Epoch: 24, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.216 Vali Acc: 0.129 Test Loss: 3.216 Test Acc: 0.129
Validation loss decreased (-0.127027 --> -0.129380).  Saving model ...
Epoch: 25 cost time: 1.213315486907959
Epoch: 25, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.211 Vali Acc: 0.134 Test Loss: 3.211 Test Acc: 0.134
Validation loss decreased (-0.129380 --> -0.134086).  Saving model ...
Epoch: 26 cost time: 1.1683826446533203
Epoch: 26, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.226 Vali Acc: 0.134 Test Loss: 3.226 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2888774871826172
Epoch: 27, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.231 Vali Acc: 0.135 Test Loss: 3.231 Test Acc: 0.135
Validation loss decreased (-0.134086 --> -0.135262).  Saving model ...
Epoch: 28 cost time: 1.2356109619140625
Epoch: 28, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.259 Vali Acc: 0.129 Test Loss: 3.259 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.017052173614502
Epoch: 29, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.266 Vali Acc: 0.131 Test Loss: 3.266 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5238542556762695
Epoch: 30, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.287 Vali Acc: 0.136 Test Loss: 3.287 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 31 cost time: 1.505420207977295
Epoch: 31, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.313 Vali Acc: 0.118 Test Loss: 3.313 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0669803619384766
Epoch: 32, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.309 Vali Acc: 0.136 Test Loss: 3.309 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.155782699584961
Epoch: 33, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.299 Vali Acc: 0.141 Test Loss: 3.299 Test Acc: 0.141
Validation loss decreased (-0.136438 --> -0.141143).  Saving model ...
Epoch: 34 cost time: 1.1227552890777588
Epoch: 34, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.318 Vali Acc: 0.141 Test Loss: 3.318 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4587619304656982
Epoch: 35, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.353 Vali Acc: 0.146 Test Loss: 3.353 Test Acc: 0.146
Validation loss decreased (-0.141143 --> -0.145849).  Saving model ...
Epoch: 36 cost time: 1.2575182914733887
Epoch: 36, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.368 Vali Acc: 0.142 Test Loss: 3.368 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2312688827514648
Epoch: 37, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.354 Vali Acc: 0.151 Test Loss: 3.354 Test Acc: 0.151
Validation loss decreased (-0.145849 --> -0.150555).  Saving model ...
Epoch: 38 cost time: 1.274524211883545
Epoch: 38, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.373 Vali Acc: 0.158 Test Loss: 3.373 Test Acc: 0.158
Validation loss decreased (-0.150555 --> -0.157613).  Saving model ...
Epoch: 39 cost time: 1.1725215911865234
Epoch: 39, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.390 Vali Acc: 0.152 Test Loss: 3.390 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2047789096832275
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.404 Vali Acc: 0.141 Test Loss: 3.404 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3388724327087402
Epoch: 41, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.416 Vali Acc: 0.146 Test Loss: 3.416 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5085933208465576
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.429 Vali Acc: 0.145 Test Loss: 3.429 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7130661010742188
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.433 Vali Acc: 0.147 Test Loss: 3.433 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7349464893341064
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.437 Vali Acc: 0.151 Test Loss: 3.437 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.358628511428833
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.437 Vali Acc: 0.155 Test Loss: 3.437 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2857303619384766
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.441 Vali Acc: 0.154 Test Loss: 3.441 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.152014970779419
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.446 Vali Acc: 0.153 Test Loss: 3.446 Test Acc: 0.153
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.165663719177246
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.446 Vali Acc: 0.146 Test Loss: 3.446 Test Acc: 0.146
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15764705882352942
model parameter : 335788
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.410932779312134
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.321 Vali Acc: 0.033 Test Loss: 3.321 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.210371732711792
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.302 Vali Acc: 0.047 Test Loss: 3.302 Test Acc: 0.047
Validation loss decreased (-0.032908 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.3099133968353271
Epoch: 3, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.283 Vali Acc: 0.045 Test Loss: 3.283 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9790675640106201
Epoch: 4, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.273 Vali Acc: 0.052 Test Loss: 3.273 Test Acc: 0.052
Validation loss decreased (-0.047026 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 1.2093067169189453
Epoch: 5, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.261 Vali Acc: 0.065 Test Loss: 3.261 Test Acc: 0.065
Validation loss decreased (-0.051732 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 1.1363446712493896
Epoch: 6, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.249 Vali Acc: 0.069 Test Loss: 3.249 Test Acc: 0.069
Validation loss decreased (-0.064673 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.0488600730895996
Epoch: 7, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.241 Vali Acc: 0.081 Test Loss: 3.241 Test Acc: 0.081
Validation loss decreased (-0.069379 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 1.114924430847168
Epoch: 8, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.230 Vali Acc: 0.087 Test Loss: 3.230 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087027).  Saving model ...
Epoch: 9 cost time: 1.1729810237884521
Epoch: 9, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.225 Vali Acc: 0.091 Test Loss: 3.225 Test Acc: 0.091
Validation loss decreased (-0.087027 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 0.942711353302002
Epoch: 10, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.220 Vali Acc: 0.094 Test Loss: 3.220 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 0.9991984367370605
Epoch: 11, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.221 Vali Acc: 0.096 Test Loss: 3.221 Test Acc: 0.096
Validation loss decreased (-0.094085 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.9696316719055176
Epoch: 12, Steps: 10 | Train Loss: 1.649 Vali Loss: 3.225 Vali Acc: 0.109 Test Loss: 3.225 Test Acc: 0.109
Validation loss decreased (-0.096438 --> -0.109380).  Saving model ...
Epoch: 13 cost time: 1.0902047157287598
Epoch: 13, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.228 Vali Acc: 0.102 Test Loss: 3.228 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0157957077026367
Epoch: 14, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.229 Vali Acc: 0.100 Test Loss: 3.229 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2320818901062012
Epoch: 15, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.229 Vali Acc: 0.115 Test Loss: 3.229 Test Acc: 0.115
Validation loss decreased (-0.109380 --> -0.115262).  Saving model ...
Epoch: 16 cost time: 1.4374613761901855
Epoch: 16, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.217 Vali Acc: 0.112 Test Loss: 3.217 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2611186504364014
Epoch: 17, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.214 Vali Acc: 0.114 Test Loss: 3.214 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2489218711853027
Epoch: 18, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.216 Vali Acc: 0.118 Test Loss: 3.216 Test Acc: 0.118
Validation loss decreased (-0.115262 --> -0.117615).  Saving model ...
Epoch: 19 cost time: 1.1807682514190674
Epoch: 19, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.233 Vali Acc: 0.118 Test Loss: 3.233 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.079247236251831
Epoch: 20, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.221 Vali Acc: 0.120 Test Loss: 3.221 Test Acc: 0.120
Validation loss decreased (-0.117615 --> -0.119968).  Saving model ...
Epoch: 21 cost time: 1.130910873413086
Epoch: 21, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.232 Vali Acc: 0.129 Test Loss: 3.232 Test Acc: 0.129
Validation loss decreased (-0.119968 --> -0.129379).  Saving model ...
Epoch: 22 cost time: 1.2783045768737793
Epoch: 22, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.231 Vali Acc: 0.126 Test Loss: 3.231 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1109182834625244
Epoch: 23, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.228 Vali Acc: 0.133 Test Loss: 3.228 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 24 cost time: 0.9788751602172852
Epoch: 24, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.243 Vali Acc: 0.125 Test Loss: 3.243 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1446020603179932
Epoch: 25, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.240 Vali Acc: 0.134 Test Loss: 3.240 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134085).  Saving model ...
Epoch: 26 cost time: 1.044999599456787
Epoch: 26, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.244 Vali Acc: 0.127 Test Loss: 3.244 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0957674980163574
Epoch: 27, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.267 Vali Acc: 0.132 Test Loss: 3.267 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0448970794677734
Epoch: 28, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.259 Vali Acc: 0.136 Test Loss: 3.259 Test Acc: 0.136
Validation loss decreased (-0.134085 --> -0.136438).  Saving model ...
Epoch: 29 cost time: 1.0533983707427979
Epoch: 29, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.272 Vali Acc: 0.144 Test Loss: 3.272 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 30 cost time: 0.9481217861175537
Epoch: 30, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.265 Vali Acc: 0.146 Test Loss: 3.265 Test Acc: 0.146
Validation loss decreased (-0.143497 --> -0.145850).  Saving model ...
Epoch: 31 cost time: 1.2313992977142334
Epoch: 31, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.298 Vali Acc: 0.149 Test Loss: 3.298 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 32 cost time: 1.0041999816894531
Epoch: 32, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.335 Vali Acc: 0.151 Test Loss: 3.335 Test Acc: 0.151
Validation loss decreased (-0.149379 --> -0.150555).  Saving model ...
Epoch: 33 cost time: 1.1145830154418945
Epoch: 33, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.348 Vali Acc: 0.140 Test Loss: 3.348 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0269920825958252
Epoch: 34, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.358 Vali Acc: 0.148 Test Loss: 3.358 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0172648429870605
Epoch: 35, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.364 Vali Acc: 0.149 Test Loss: 3.364 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9952554702758789
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.370 Vali Acc: 0.152 Test Loss: 3.370 Test Acc: 0.152
Validation loss decreased (-0.150555 --> -0.151731).  Saving model ...
Epoch: 37 cost time: 1.0181472301483154
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.384 Vali Acc: 0.149 Test Loss: 3.384 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9798998832702637
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.385 Vali Acc: 0.154 Test Loss: 3.385 Test Acc: 0.154
Validation loss decreased (-0.151731 --> -0.154084).  Saving model ...
Epoch: 39 cost time: 1.10410737991333
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.391 Vali Acc: 0.151 Test Loss: 3.391 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0001616477966309
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.400 Vali Acc: 0.155 Test Loss: 3.400 Test Acc: 0.155
Validation loss decreased (-0.154084 --> -0.155260).  Saving model ...
Epoch: 41 cost time: 1.0502915382385254
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.410 Vali Acc: 0.156 Test Loss: 3.410 Test Acc: 0.156
Validation loss decreased (-0.155260 --> -0.156436).  Saving model ...
Epoch: 42 cost time: 1.0617542266845703
Epoch: 42, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.411 Vali Acc: 0.152 Test Loss: 3.411 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.089806079864502
Epoch: 43, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.420 Vali Acc: 0.153 Test Loss: 3.420 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0117852687835693
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.424 Vali Acc: 0.153 Test Loss: 3.424 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.09311842918396
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.426 Vali Acc: 0.152 Test Loss: 3.426 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0937607288360596
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.428 Vali Acc: 0.154 Test Loss: 3.428 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2089452743530273
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.429 Vali Acc: 0.152 Test Loss: 3.429 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9566700458526611
Epoch: 48, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.434 Vali Acc: 0.152 Test Loss: 3.434 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0362062454223633
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.439 Vali Acc: 0.153 Test Loss: 3.439 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2747297286987305
Epoch: 50, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.438 Vali Acc: 0.154 Test Loss: 3.438 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2029070854187012
Epoch: 51, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.439 Vali Acc: 0.159 Test Loss: 3.439 Test Acc: 0.159
Validation loss decreased (-0.156436 --> -0.158789).  Saving model ...
Epoch: 52 cost time: 0.8811414241790771
Epoch: 52, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.443 Vali Acc: 0.155 Test Loss: 3.443 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0605690479278564
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.441 Vali Acc: 0.158 Test Loss: 3.441 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9415740966796875
Epoch: 54, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.443 Vali Acc: 0.158 Test Loss: 3.443 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0682506561279297
Epoch: 55, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.446 Vali Acc: 0.152 Test Loss: 3.446 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.256852149963379
Epoch: 56, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.447 Vali Acc: 0.152 Test Loss: 3.447 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0228478908538818
Epoch: 57, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.452 Vali Acc: 0.149 Test Loss: 3.452 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0434434413909912
Epoch: 58, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.454 Vali Acc: 0.151 Test Loss: 3.454 Test Acc: 0.151
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.165412425994873
Epoch: 59, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.458 Vali Acc: 0.156 Test Loss: 3.458 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.2157344818115234
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.461 Vali Acc: 0.155 Test Loss: 3.461 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1097397804260254
Epoch: 61, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.464 Vali Acc: 0.154 Test Loss: 3.464 Test Acc: 0.154
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1588235294117647
model parameter : 331692
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3488855361938477
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.352 Vali Acc: 0.035 Test Loss: 3.352 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9673497676849365
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.336 Vali Acc: 0.038 Test Loss: 3.336 Test Acc: 0.038
Validation loss decreased (-0.035261 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.0718605518341064
Epoch: 3, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.319 Vali Acc: 0.051 Test Loss: 3.319 Test Acc: 0.051
Validation loss decreased (-0.037614 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.8449490070343018
Epoch: 4, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.300 Vali Acc: 0.052 Test Loss: 3.300 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.8685283660888672
Epoch: 5, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.281 Vali Acc: 0.061 Test Loss: 3.281 Test Acc: 0.061
Validation loss decreased (-0.051732 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.7871243953704834
Epoch: 6, Steps: 10 | Train Loss: 2.390 Vali Loss: 3.268 Vali Acc: 0.062 Test Loss: 3.268 Test Acc: 0.062
Validation loss decreased (-0.061144 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 0.853726863861084
Epoch: 7, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.255 Vali Acc: 0.075 Test Loss: 3.255 Test Acc: 0.075
Validation loss decreased (-0.062320 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 0.7819924354553223
Epoch: 8, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.242 Vali Acc: 0.081 Test Loss: 3.242 Test Acc: 0.081
Validation loss decreased (-0.075262 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 0.94441819190979
Epoch: 9, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.235 Vali Acc: 0.084 Test Loss: 3.235 Test Acc: 0.084
Validation loss decreased (-0.081144 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.8366820812225342
Epoch: 10, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.233 Vali Acc: 0.093 Test Loss: 3.233 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092909).  Saving model ...
Epoch: 11 cost time: 0.8983399868011475
Epoch: 11, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.231 Vali Acc: 0.100 Test Loss: 3.231 Test Acc: 0.100
Validation loss decreased (-0.092909 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 0.8266375064849854
Epoch: 12, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.217 Vali Acc: 0.104 Test Loss: 3.217 Test Acc: 0.104
Validation loss decreased (-0.099968 --> -0.103497).  Saving model ...
Epoch: 13 cost time: 1.006971836090088
Epoch: 13, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.229 Vali Acc: 0.108 Test Loss: 3.229 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 14 cost time: 0.9736850261688232
Epoch: 14, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.239 Vali Acc: 0.111 Test Loss: 3.239 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 15 cost time: 0.9012248516082764
Epoch: 15, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.240 Vali Acc: 0.112 Test Loss: 3.240 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111732).  Saving model ...
Epoch: 16 cost time: 0.9758889675140381
Epoch: 16, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.231 Vali Acc: 0.115 Test Loss: 3.231 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 17 cost time: 0.9094507694244385
Epoch: 17, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.236 Vali Acc: 0.107 Test Loss: 3.236 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.017549753189087
Epoch: 18, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.224 Vali Acc: 0.114 Test Loss: 3.224 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9402952194213867
Epoch: 19, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.235 Vali Acc: 0.114 Test Loss: 3.235 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0860216617584229
Epoch: 20, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.248 Vali Acc: 0.119 Test Loss: 3.248 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 21 cost time: 1.4044947624206543
Epoch: 21, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.228 Vali Acc: 0.128 Test Loss: 3.228 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128203).  Saving model ...
Epoch: 22 cost time: 0.8826072216033936
Epoch: 22, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.235 Vali Acc: 0.127 Test Loss: 3.235 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8363156318664551
Epoch: 23, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.262 Vali Acc: 0.114 Test Loss: 3.262 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0439279079437256
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.267 Vali Acc: 0.126 Test Loss: 3.267 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0243349075317383
Epoch: 25, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.276 Vali Acc: 0.131 Test Loss: 3.276 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130555).  Saving model ...
Epoch: 26 cost time: 0.8237528800964355
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.287 Vali Acc: 0.136 Test Loss: 3.287 Test Acc: 0.136
Validation loss decreased (-0.130555 --> -0.136438).  Saving model ...
Epoch: 27 cost time: 0.9854605197906494
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.308 Vali Acc: 0.134 Test Loss: 3.308 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8516600131988525
Epoch: 28, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.303 Vali Acc: 0.133 Test Loss: 3.303 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9332311153411865
Epoch: 29, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.324 Vali Acc: 0.141 Test Loss: 3.324 Test Acc: 0.141
Validation loss decreased (-0.136438 --> -0.141143).  Saving model ...
Epoch: 30 cost time: 0.7928721904754639
Epoch: 30, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.329 Vali Acc: 0.128 Test Loss: 3.329 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0791261196136475
Epoch: 31, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.335 Vali Acc: 0.128 Test Loss: 3.335 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.007873296737671
Epoch: 32, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.349 Vali Acc: 0.127 Test Loss: 3.349 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.153028964996338
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.366 Vali Acc: 0.129 Test Loss: 3.366 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9431028366088867
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.375 Vali Acc: 0.135 Test Loss: 3.375 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9421217441558838
Epoch: 35, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.385 Vali Acc: 0.146 Test Loss: 3.385 Test Acc: 0.146
Validation loss decreased (-0.141143 --> -0.145849).  Saving model ...
Epoch: 36 cost time: 0.967968225479126
Epoch: 36, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.387 Vali Acc: 0.144 Test Loss: 3.387 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.931915283203125
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.385 Vali Acc: 0.140 Test Loss: 3.385 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9383094310760498
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.392 Vali Acc: 0.139 Test Loss: 3.392 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9499702453613281
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.395 Vali Acc: 0.139 Test Loss: 3.395 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.926271915435791
Epoch: 40, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.399 Vali Acc: 0.135 Test Loss: 3.399 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1122596263885498
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.403 Vali Acc: 0.139 Test Loss: 3.403 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.058901071548462
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.405 Vali Acc: 0.142 Test Loss: 3.405 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9557268619537354
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.409 Vali Acc: 0.146 Test Loss: 3.409 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9945037364959717
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.413 Vali Acc: 0.147 Test Loss: 3.413 Test Acc: 0.147
Validation loss decreased (-0.145849 --> -0.147025).  Saving model ...
Epoch: 45 cost time: 0.8718490600585938
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.416 Vali Acc: 0.148 Test Loss: 3.416 Test Acc: 0.148
Validation loss decreased (-0.147025 --> -0.148201).  Saving model ...
Epoch: 46 cost time: 0.8726723194122314
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.419 Vali Acc: 0.148 Test Loss: 3.419 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9393959045410156
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.424 Vali Acc: 0.149 Test Loss: 3.424 Test Acc: 0.149
Validation loss decreased (-0.148201 --> -0.149378).  Saving model ...
Epoch: 48 cost time: 0.9021117687225342
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.430 Vali Acc: 0.148 Test Loss: 3.430 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1836411952972412
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.435 Vali Acc: 0.148 Test Loss: 3.435 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9434568881988525
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.438 Vali Acc: 0.151 Test Loss: 3.438 Test Acc: 0.151
Validation loss decreased (-0.149378 --> -0.150554).  Saving model ...
Epoch: 51 cost time: 1.180257797241211
Epoch: 51, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.440 Vali Acc: 0.149 Test Loss: 3.440 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0612666606903076
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.444 Vali Acc: 0.151 Test Loss: 3.444 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9349925518035889
Epoch: 53, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.449 Vali Acc: 0.147 Test Loss: 3.449 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9129855632781982
Epoch: 54, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.451 Vali Acc: 0.149 Test Loss: 3.451 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8608906269073486
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.454 Vali Acc: 0.146 Test Loss: 3.454 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7736241817474365
Epoch: 56, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.456 Vali Acc: 0.147 Test Loss: 3.456 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9373631477355957
Epoch: 57, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.459 Vali Acc: 0.146 Test Loss: 3.459 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9330506324768066
Epoch: 58, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.462 Vali Acc: 0.144 Test Loss: 3.462 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.9762821197509766
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.466 Vali Acc: 0.145 Test Loss: 3.466 Test Acc: 0.145
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.382965087890625
Epoch: 60, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.469 Vali Acc: 0.144 Test Loss: 3.469 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15058823529411763
model parameter : 328620
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.164564371109009
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.319 Vali Acc: 0.033 Test Loss: 3.319 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.0339198112487793
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.301 Vali Acc: 0.038 Test Loss: 3.301 Test Acc: 0.038
Validation loss decreased (-0.032908 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 0.815941572189331
Epoch: 3, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.283 Vali Acc: 0.045 Test Loss: 3.283 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.7397937774658203
Epoch: 4, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.266 Vali Acc: 0.047 Test Loss: 3.266 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.9803595542907715
Epoch: 5, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.248 Vali Acc: 0.067 Test Loss: 3.248 Test Acc: 0.067
Validation loss decreased (-0.047026 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.7719151973724365
Epoch: 6, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.239 Vali Acc: 0.086 Test Loss: 3.239 Test Acc: 0.086
Validation loss decreased (-0.067026 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.9278817176818848
Epoch: 7, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.226 Vali Acc: 0.093 Test Loss: 3.226 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.8978836536407471
Epoch: 8, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.222 Vali Acc: 0.102 Test Loss: 3.222 Test Acc: 0.102
Validation loss decreased (-0.092909 --> -0.102321).  Saving model ...
Epoch: 9 cost time: 1.0448830127716064
Epoch: 9, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.227 Vali Acc: 0.088 Test Loss: 3.227 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9768085479736328
Epoch: 10, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.219 Vali Acc: 0.098 Test Loss: 3.219 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8804123401641846
Epoch: 11, Steps: 10 | Train Loss: 1.592 Vali Loss: 3.219 Vali Acc: 0.109 Test Loss: 3.219 Test Acc: 0.109
Validation loss decreased (-0.102321 --> -0.109380).  Saving model ...
Epoch: 12 cost time: 0.7527596950531006
Epoch: 12, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.202 Vali Acc: 0.113 Test Loss: 3.202 Test Acc: 0.113
Validation loss decreased (-0.109380 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 1.0992867946624756
Epoch: 13, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.215 Vali Acc: 0.112 Test Loss: 3.215 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9478137493133545
Epoch: 14, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.212 Vali Acc: 0.107 Test Loss: 3.212 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8103387355804443
Epoch: 15, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.213 Vali Acc: 0.128 Test Loss: 3.213 Test Acc: 0.128
Validation loss decreased (-0.112909 --> -0.128203).  Saving model ...
Epoch: 16 cost time: 0.800745964050293
Epoch: 16, Steps: 10 | Train Loss: 0.952 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7979648113250732
Epoch: 17, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.226 Vali Acc: 0.119 Test Loss: 3.226 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8386068344116211
Epoch: 18, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.214 Vali Acc: 0.132 Test Loss: 3.214 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131733).  Saving model ...
Epoch: 19 cost time: 0.9674994945526123
Epoch: 19, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.198 Vali Acc: 0.138 Test Loss: 3.198 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137615).  Saving model ...
Epoch: 20 cost time: 0.9403622150421143
Epoch: 20, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.210 Vali Acc: 0.136 Test Loss: 3.210 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8148767948150635
Epoch: 21, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.196 Vali Acc: 0.136 Test Loss: 3.196 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1399457454681396
Epoch: 22, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.215 Vali Acc: 0.144 Test Loss: 3.215 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 23 cost time: 0.796572208404541
Epoch: 23, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.201 Vali Acc: 0.147 Test Loss: 3.201 Test Acc: 0.147
Validation loss decreased (-0.143497 --> -0.147027).  Saving model ...
Epoch: 24 cost time: 0.9506914615631104
Epoch: 24, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.220 Vali Acc: 0.166 Test Loss: 3.220 Test Acc: 0.166
Validation loss decreased (-0.147027 --> -0.165850).  Saving model ...
Epoch: 25 cost time: 0.8749191761016846
Epoch: 25, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.238 Vali Acc: 0.149 Test Loss: 3.238 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9640011787414551
Epoch: 26, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.256 Vali Acc: 0.142 Test Loss: 3.256 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9707815647125244
Epoch: 27, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.253 Vali Acc: 0.148 Test Loss: 3.253 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0215561389923096
Epoch: 28, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.257 Vali Acc: 0.144 Test Loss: 3.257 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9327225685119629
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.265 Vali Acc: 0.152 Test Loss: 3.265 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8118910789489746
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.270 Vali Acc: 0.155 Test Loss: 3.270 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9156684875488281
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.281 Vali Acc: 0.154 Test Loss: 3.281 Test Acc: 0.154
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1060717105865479
Epoch: 32, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.282 Vali Acc: 0.159 Test Loss: 3.282 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1558563709259033
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.282 Vali Acc: 0.162 Test Loss: 3.282 Test Acc: 0.162
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8173282146453857
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.294 Vali Acc: 0.159 Test Loss: 3.294 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16588235294117648
model parameter : 327596
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.360220432281494
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.328 Vali Acc: 0.042 Test Loss: 3.328 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7797906398773193
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.317 Vali Acc: 0.046 Test Loss: 3.317 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.6663424968719482
Epoch: 3, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.298 Vali Acc: 0.052 Test Loss: 3.298 Test Acc: 0.052
Validation loss decreased (-0.045849 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.7526490688323975
Epoch: 4, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.276 Vali Acc: 0.072 Test Loss: 3.276 Test Acc: 0.072
Validation loss decreased (-0.051732 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.6620159149169922
Epoch: 5, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.258 Vali Acc: 0.079 Test Loss: 3.258 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.7283625602722168
Epoch: 6, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.241 Vali Acc: 0.072 Test Loss: 3.241 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7240900993347168
Epoch: 7, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.239 Vali Acc: 0.085 Test Loss: 3.239 Test Acc: 0.085
Validation loss decreased (-0.078791 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.7228806018829346
Epoch: 8, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.223 Vali Acc: 0.094 Test Loss: 3.223 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.8083808422088623
Epoch: 9, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.227 Vali Acc: 0.093 Test Loss: 3.227 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7657434940338135
Epoch: 10, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.216 Vali Acc: 0.095 Test Loss: 3.216 Test Acc: 0.095
Validation loss decreased (-0.094085 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 0.6749203205108643
Epoch: 11, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.212 Vali Acc: 0.107 Test Loss: 3.212 Test Acc: 0.107
Validation loss decreased (-0.095262 --> -0.107027).  Saving model ...
Epoch: 12 cost time: 0.7561237812042236
Epoch: 12, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.203 Vali Acc: 0.105 Test Loss: 3.203 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7885556221008301
Epoch: 13, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.192 Vali Acc: 0.112 Test Loss: 3.192 Test Acc: 0.112
Validation loss decreased (-0.107027 --> -0.111733).  Saving model ...
Epoch: 14 cost time: 0.8849804401397705
Epoch: 14, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.212 Vali Acc: 0.125 Test Loss: 3.212 Test Acc: 0.125
Validation loss decreased (-0.111733 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 0.9032082557678223
Epoch: 15, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.202 Vali Acc: 0.121 Test Loss: 3.202 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7259523868560791
Epoch: 16, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.200 Vali Acc: 0.126 Test Loss: 3.200 Test Acc: 0.126
Validation loss decreased (-0.124674 --> -0.125850).  Saving model ...
Epoch: 17 cost time: 0.8382627964019775
Epoch: 17, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.206 Vali Acc: 0.126 Test Loss: 3.206 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9752049446105957
Epoch: 18, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.209 Vali Acc: 0.136 Test Loss: 3.209 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 0.8294026851654053
Epoch: 19, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.197 Vali Acc: 0.132 Test Loss: 3.197 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7609207630157471
Epoch: 20, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.207 Vali Acc: 0.132 Test Loss: 3.207 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7589004039764404
Epoch: 21, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.220 Vali Acc: 0.134 Test Loss: 3.220 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7755208015441895
Epoch: 22, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.227 Vali Acc: 0.140 Test Loss: 3.227 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139968).  Saving model ...
Epoch: 23 cost time: 1.0568578243255615
Epoch: 23, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.238 Vali Acc: 0.142 Test Loss: 3.238 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 24 cost time: 0.8598244190216064
Epoch: 24, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.237 Vali Acc: 0.146 Test Loss: 3.237 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 25 cost time: 0.7622082233428955
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.238 Vali Acc: 0.145 Test Loss: 3.238 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9264802932739258
Epoch: 26, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.249 Vali Acc: 0.144 Test Loss: 3.249 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8239643573760986
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.273 Vali Acc: 0.144 Test Loss: 3.273 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7838728427886963
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.267 Vali Acc: 0.146 Test Loss: 3.267 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7371878623962402
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.268 Vali Acc: 0.142 Test Loss: 3.268 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6939430236816406
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.275 Vali Acc: 0.142 Test Loss: 3.275 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8053803443908691
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.281 Vali Acc: 0.142 Test Loss: 3.281 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7670488357543945
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.286 Vali Acc: 0.142 Test Loss: 3.286 Test Acc: 0.142
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7876701354980469
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.292 Vali Acc: 0.141 Test Loss: 3.292 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7200663089752197
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.296 Vali Acc: 0.140 Test Loss: 3.296 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14588235294117646
model parameter : 325548
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.287271499633789
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.315 Vali Acc: 0.052 Test Loss: 3.315 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.865084171295166
Epoch: 2, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.306 Vali Acc: 0.049 Test Loss: 3.306 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9801855087280273
Epoch: 3, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.288 Vali Acc: 0.044 Test Loss: 3.288 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7177174091339111
Epoch: 4, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.267 Vali Acc: 0.055 Test Loss: 3.267 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.9313817024230957
Epoch: 5, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.252 Vali Acc: 0.067 Test Loss: 3.252 Test Acc: 0.067
Validation loss decreased (-0.055261 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.7455787658691406
Epoch: 6, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.237 Vali Acc: 0.072 Test Loss: 3.237 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.6818363666534424
Epoch: 7, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.242 Vali Acc: 0.080 Test Loss: 3.242 Test Acc: 0.080
Validation loss decreased (-0.071732 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.7378931045532227
Epoch: 8, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.232 Vali Acc: 0.084 Test Loss: 3.232 Test Acc: 0.084
Validation loss decreased (-0.079968 --> -0.083497).  Saving model ...
Epoch: 9 cost time: 1.0122475624084473
Epoch: 9, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.236 Vali Acc: 0.089 Test Loss: 3.236 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089379).  Saving model ...
Epoch: 10 cost time: 0.9482686519622803
Epoch: 10, Steps: 10 | Train Loss: 1.589 Vali Loss: 3.223 Vali Acc: 0.096 Test Loss: 3.223 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.7829766273498535
Epoch: 11, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.218 Vali Acc: 0.102 Test Loss: 3.218 Test Acc: 0.102
Validation loss decreased (-0.096438 --> -0.102321).  Saving model ...
Epoch: 12 cost time: 0.7346935272216797
Epoch: 12, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.222 Vali Acc: 0.106 Test Loss: 3.222 Test Acc: 0.106
Validation loss decreased (-0.102321 --> -0.105850).  Saving model ...
Epoch: 13 cost time: 0.784550666809082
Epoch: 13, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.214 Vali Acc: 0.112 Test Loss: 3.214 Test Acc: 0.112
Validation loss decreased (-0.105850 --> -0.111733).  Saving model ...
Epoch: 14 cost time: 1.0110232830047607
Epoch: 14, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.210 Vali Acc: 0.115 Test Loss: 3.210 Test Acc: 0.115
Validation loss decreased (-0.111733 --> -0.115262).  Saving model ...
Epoch: 15 cost time: 0.7617113590240479
Epoch: 15, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.208 Vali Acc: 0.119 Test Loss: 3.208 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 0.8378827571868896
Epoch: 16, Steps: 10 | Train Loss: 0.678 Vali Loss: 3.206 Vali Acc: 0.120 Test Loss: 3.206 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119968).  Saving model ...
Epoch: 17 cost time: 0.8602023124694824
Epoch: 17, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.239 Vali Acc: 0.116 Test Loss: 3.239 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6887879371643066
Epoch: 18, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.214 Vali Acc: 0.121 Test Loss: 3.214 Test Acc: 0.121
Validation loss decreased (-0.119968 --> -0.121144).  Saving model ...
Epoch: 19 cost time: 0.8547744750976562
Epoch: 19, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.222 Vali Acc: 0.122 Test Loss: 3.222 Test Acc: 0.122
Validation loss decreased (-0.121144 --> -0.122321).  Saving model ...
Epoch: 20 cost time: 0.8372693061828613
Epoch: 20, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.221 Vali Acc: 0.133 Test Loss: 3.221 Test Acc: 0.133
Validation loss decreased (-0.122321 --> -0.132909).  Saving model ...
Epoch: 21 cost time: 0.7595522403717041
Epoch: 21, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.254 Vali Acc: 0.129 Test Loss: 3.254 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7445862293243408
Epoch: 22, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.239 Vali Acc: 0.126 Test Loss: 3.239 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7467641830444336
Epoch: 23, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.251 Vali Acc: 0.133 Test Loss: 3.251 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8414030075073242
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.251 Vali Acc: 0.135 Test Loss: 3.251 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 25 cost time: 1.1606667041778564
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.272 Vali Acc: 0.127 Test Loss: 3.272 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7083964347839355
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.290 Vali Acc: 0.133 Test Loss: 3.290 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7169661521911621
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.298 Vali Acc: 0.127 Test Loss: 3.298 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7384777069091797
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.307 Vali Acc: 0.126 Test Loss: 3.307 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0972778797149658
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.308 Vali Acc: 0.133 Test Loss: 3.308 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8928313255310059
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.307 Vali Acc: 0.133 Test Loss: 3.307 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8973009586334229
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.307 Vali Acc: 0.131 Test Loss: 3.307 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7961125373840332
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.309 Vali Acc: 0.138 Test Loss: 3.309 Test Acc: 0.138
Validation loss decreased (-0.135262 --> -0.137614).  Saving model ...
Epoch: 33 cost time: 0.7792272567749023
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.312 Vali Acc: 0.140 Test Loss: 3.312 Test Acc: 0.140
Validation loss decreased (-0.137614 --> -0.139967).  Saving model ...
Epoch: 34 cost time: 0.9522411823272705
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.313 Vali Acc: 0.139 Test Loss: 3.313 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.838860034942627
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.319 Vali Acc: 0.135 Test Loss: 3.319 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8687071800231934
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.322 Vali Acc: 0.139 Test Loss: 3.322 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7350757122039795
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.325 Vali Acc: 0.138 Test Loss: 3.325 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8733088970184326
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.329 Vali Acc: 0.139 Test Loss: 3.329 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6791524887084961
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.332 Vali Acc: 0.138 Test Loss: 3.332 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.869255781173706
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.339 Vali Acc: 0.138 Test Loss: 3.339 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7226336002349854
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.340 Vali Acc: 0.139 Test Loss: 3.340 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6527669429779053
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.343 Vali Acc: 0.141 Test Loss: 3.343 Test Acc: 0.141
Validation loss decreased (-0.139967 --> -0.141143).  Saving model ...
Epoch: 43 cost time: 0.6932668685913086
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.347 Vali Acc: 0.144 Test Loss: 3.347 Test Acc: 0.144
Validation loss decreased (-0.141143 --> -0.143496).  Saving model ...
Epoch: 44 cost time: 0.7102806568145752
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.351 Vali Acc: 0.145 Test Loss: 3.351 Test Acc: 0.145
Validation loss decreased (-0.143496 --> -0.144672).  Saving model ...
Epoch: 45 cost time: 0.808863639831543
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.355 Vali Acc: 0.142 Test Loss: 3.355 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8790123462677002
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.358 Vali Acc: 0.135 Test Loss: 3.358 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.56170654296875
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.363 Vali Acc: 0.136 Test Loss: 3.363 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7043731212615967
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.365 Vali Acc: 0.140 Test Loss: 3.365 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7081401348114014
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.370 Vali Acc: 0.139 Test Loss: 3.370 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8107395172119141
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.372 Vali Acc: 0.138 Test Loss: 3.372 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6461787223815918
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.376 Vali Acc: 0.139 Test Loss: 3.376 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6266708374023438
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.377 Vali Acc: 0.138 Test Loss: 3.377 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7210509777069092
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.380 Vali Acc: 0.141 Test Loss: 3.380 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6223392486572266
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.382 Vali Acc: 0.142 Test Loss: 3.382 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 324524
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.241950750350952
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.317 Vali Acc: 0.051 Test Loss: 3.317 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.4367856979370117
Epoch: 2, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.305 Vali Acc: 0.059 Test Loss: 3.305 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 1.71528959274292
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.292 Vali Acc: 0.061 Test Loss: 3.292 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.6585259437561035
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.279 Vali Acc: 0.060 Test Loss: 3.279 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5919976234436035
Epoch: 5, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.268 Vali Acc: 0.066 Test Loss: 3.268 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 1.589348316192627
Epoch: 6, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.261 Vali Acc: 0.066 Test Loss: 3.261 Test Acc: 0.066
Validation loss decreased (-0.065850 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 1.485588550567627
Epoch: 7, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.255 Vali Acc: 0.072 Test Loss: 3.255 Test Acc: 0.072
Validation loss decreased (-0.065850 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 1.4721286296844482
Epoch: 8, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.247 Vali Acc: 0.071 Test Loss: 3.247 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.413116693496704
Epoch: 9, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.244 Vali Acc: 0.078 Test Loss: 3.244 Test Acc: 0.078
Validation loss decreased (-0.071732 --> -0.077615).  Saving model ...
Epoch: 10 cost time: 1.4372124671936035
Epoch: 10, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.238 Vali Acc: 0.076 Test Loss: 3.238 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.663578987121582
Epoch: 11, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.230 Vali Acc: 0.087 Test Loss: 3.230 Test Acc: 0.087
Validation loss decreased (-0.077615 --> -0.087027).  Saving model ...
Epoch: 12 cost time: 1.4583866596221924
Epoch: 12, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.221 Vali Acc: 0.088 Test Loss: 3.221 Test Acc: 0.088
Validation loss decreased (-0.087027 --> -0.088203).  Saving model ...
Epoch: 13 cost time: 1.4427015781402588
Epoch: 13, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.220 Vali Acc: 0.096 Test Loss: 3.220 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 14 cost time: 1.3265905380249023
Epoch: 14, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.212 Vali Acc: 0.101 Test Loss: 3.212 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 15 cost time: 1.5727884769439697
Epoch: 15, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.205 Vali Acc: 0.100 Test Loss: 3.205 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.441035509109497
Epoch: 16, Steps: 10 | Train Loss: 2.058 Vali Loss: 3.205 Vali Acc: 0.100 Test Loss: 3.205 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4180576801300049
Epoch: 17, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.202 Vali Acc: 0.113 Test Loss: 3.202 Test Acc: 0.113
Validation loss decreased (-0.101144 --> -0.112909).  Saving model ...
Epoch: 18 cost time: 1.186967134475708
Epoch: 18, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.199 Vali Acc: 0.119 Test Loss: 3.199 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118792).  Saving model ...
Epoch: 19 cost time: 1.5340542793273926
Epoch: 19, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.193 Vali Acc: 0.114 Test Loss: 3.193 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5349948406219482
Epoch: 20, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.188 Vali Acc: 0.113 Test Loss: 3.188 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6849627494812012
Epoch: 21, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.182 Vali Acc: 0.124 Test Loss: 3.182 Test Acc: 0.124
Validation loss decreased (-0.118792 --> -0.123498).  Saving model ...
Epoch: 22 cost time: 1.516920566558838
Epoch: 22, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.174 Vali Acc: 0.133 Test Loss: 3.174 Test Acc: 0.133
Validation loss decreased (-0.123498 --> -0.132909).  Saving model ...
Epoch: 23 cost time: 1.6201601028442383
Epoch: 23, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.178 Vali Acc: 0.132 Test Loss: 3.178 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5728471279144287
Epoch: 24, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.173 Vali Acc: 0.135 Test Loss: 3.173 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 25 cost time: 1.426347255706787
Epoch: 25, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.179 Vali Acc: 0.136 Test Loss: 3.179 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136439).  Saving model ...
Epoch: 26 cost time: 1.4321503639221191
Epoch: 26, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.180 Vali Acc: 0.141 Test Loss: 3.180 Test Acc: 0.141
Validation loss decreased (-0.136439 --> -0.141145).  Saving model ...
Epoch: 27 cost time: 1.421604871749878
Epoch: 27, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.183 Vali Acc: 0.142 Test Loss: 3.183 Test Acc: 0.142
Validation loss decreased (-0.141145 --> -0.142321).  Saving model ...
Epoch: 28 cost time: 1.4110159873962402
Epoch: 28, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.175 Vali Acc: 0.152 Test Loss: 3.175 Test Acc: 0.152
Validation loss decreased (-0.142321 --> -0.151733).  Saving model ...
Epoch: 29 cost time: 1.448143720626831
Epoch: 29, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.179 Vali Acc: 0.153 Test Loss: 3.179 Test Acc: 0.153
Validation loss decreased (-0.151733 --> -0.152909).  Saving model ...
Epoch: 30 cost time: 1.4513187408447266
Epoch: 30, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.183 Vali Acc: 0.153 Test Loss: 3.183 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5781934261322021
Epoch: 31, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.182 Vali Acc: 0.159 Test Loss: 3.182 Test Acc: 0.159
Validation loss decreased (-0.152909 --> -0.158792).  Saving model ...
Epoch: 32 cost time: 1.3090128898620605
Epoch: 32, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.188 Vali Acc: 0.154 Test Loss: 3.188 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4185247421264648
Epoch: 33, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.198 Vali Acc: 0.164 Test Loss: 3.198 Test Acc: 0.164
Validation loss decreased (-0.158792 --> -0.163497).  Saving model ...
Epoch: 34 cost time: 1.3308768272399902
Epoch: 34, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.213 Vali Acc: 0.158 Test Loss: 3.213 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7765614986419678
Epoch: 35, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.210 Vali Acc: 0.166 Test Loss: 3.210 Test Acc: 0.166
Validation loss decreased (-0.163497 --> -0.165850).  Saving model ...
Epoch: 36 cost time: 1.8728375434875488
Epoch: 36, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.221 Vali Acc: 0.167 Test Loss: 3.221 Test Acc: 0.167
Validation loss decreased (-0.165850 --> -0.167027).  Saving model ...
Epoch: 37 cost time: 1.6268599033355713
Epoch: 37, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.236 Vali Acc: 0.161 Test Loss: 3.236 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8112766742706299
Epoch: 38, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.256 Vali Acc: 0.164 Test Loss: 3.256 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.022670269012451
Epoch: 39, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.265 Vali Acc: 0.160 Test Loss: 3.265 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.858635425567627
Epoch: 40, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.261 Vali Acc: 0.161 Test Loss: 3.261 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6280863285064697
Epoch: 41, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.270 Vali Acc: 0.169 Test Loss: 3.270 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169379).  Saving model ...
Epoch: 42 cost time: 1.8445255756378174
Epoch: 42, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.287 Vali Acc: 0.178 Test Loss: 3.287 Test Acc: 0.178
Validation loss decreased (-0.169379 --> -0.177614).  Saving model ...
Epoch: 43 cost time: 1.6808545589447021
Epoch: 43, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.294 Vali Acc: 0.172 Test Loss: 3.294 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9113457202911377
Epoch: 44, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.316 Vali Acc: 0.168 Test Loss: 3.316 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.926687479019165
Epoch: 45, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.329 Vali Acc: 0.172 Test Loss: 3.329 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.517223834991455
Epoch: 46, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.336 Vali Acc: 0.181 Test Loss: 3.336 Test Acc: 0.181
Validation loss decreased (-0.177614 --> -0.181143).  Saving model ...
Epoch: 47 cost time: 1.7452917098999023
Epoch: 47, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.348 Vali Acc: 0.176 Test Loss: 3.348 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.1466593742370605
Epoch: 48, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.370 Vali Acc: 0.179 Test Loss: 3.370 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9857203960418701
Epoch: 49, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.375 Vali Acc: 0.172 Test Loss: 3.375 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5508208274841309
Epoch: 50, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.393 Vali Acc: 0.171 Test Loss: 3.393 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.846935510635376
Epoch: 51, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.404 Vali Acc: 0.179 Test Loss: 3.404 Test Acc: 0.179
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.8036212921142578
Epoch: 52, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.403 Vali Acc: 0.175 Test Loss: 3.403 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.0912864208221436
Epoch: 53, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.402 Vali Acc: 0.178 Test Loss: 3.402 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.9140868186950684
Epoch: 54, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.412 Vali Acc: 0.178 Test Loss: 3.412 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.925539493560791
Epoch: 55, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.417 Vali Acc: 0.172 Test Loss: 3.417 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.8611772060394287
Epoch: 56, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.428 Vali Acc: 0.180 Test Loss: 3.428 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1811764705882353
model parameter : 177614
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3343682289123535
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.321 Vali Acc: 0.044 Test Loss: 3.321 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.7796480655670166
Epoch: 2, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.308 Vali Acc: 0.045 Test Loss: 3.308 Test Acc: 0.045
Validation loss decreased (-0.043496 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.4087655544281006
Epoch: 3, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.293 Vali Acc: 0.038 Test Loss: 3.293 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6404404640197754
Epoch: 4, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.280 Vali Acc: 0.049 Test Loss: 3.280 Test Acc: 0.049
Validation loss decreased (-0.044673 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 1.5462384223937988
Epoch: 5, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.269 Vali Acc: 0.052 Test Loss: 3.269 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 1.5914418697357178
Epoch: 6, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.260 Vali Acc: 0.059 Test Loss: 3.260 Test Acc: 0.059
Validation loss decreased (-0.051732 --> -0.058791).  Saving model ...
Epoch: 7 cost time: 1.5905907154083252
Epoch: 7, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.255 Vali Acc: 0.067 Test Loss: 3.255 Test Acc: 0.067
Validation loss decreased (-0.058791 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.5297377109527588
Epoch: 8, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.255 Vali Acc: 0.069 Test Loss: 3.255 Test Acc: 0.069
Validation loss decreased (-0.067026 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 1.5438013076782227
Epoch: 9, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.249 Vali Acc: 0.078 Test Loss: 3.249 Test Acc: 0.078
Validation loss decreased (-0.069379 --> -0.077615).  Saving model ...
Epoch: 10 cost time: 1.1935713291168213
Epoch: 10, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.244 Vali Acc: 0.098 Test Loss: 3.244 Test Acc: 0.098
Validation loss decreased (-0.077615 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 1.3364965915679932
Epoch: 11, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.097615 --> -0.107026).  Saving model ...
Epoch: 12 cost time: 1.4313690662384033
Epoch: 12, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.225 Vali Acc: 0.108 Test Loss: 3.225 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108203).  Saving model ...
Epoch: 13 cost time: 1.2703959941864014
Epoch: 13, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.216 Vali Acc: 0.115 Test Loss: 3.216 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 1.6595180034637451
Epoch: 14, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.210 Vali Acc: 0.113 Test Loss: 3.210 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.484605073928833
Epoch: 15, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.199 Vali Acc: 0.114 Test Loss: 3.199 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9196701049804688
Epoch: 16, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.201 Vali Acc: 0.114 Test Loss: 3.201 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.432527780532837
Epoch: 17, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.186 Vali Acc: 0.126 Test Loss: 3.186 Test Acc: 0.126
Validation loss decreased (-0.115262 --> -0.125850).  Saving model ...
Epoch: 18 cost time: 1.2096269130706787
Epoch: 18, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.180 Vali Acc: 0.127 Test Loss: 3.180 Test Acc: 0.127
Validation loss decreased (-0.125850 --> -0.127027).  Saving model ...
Epoch: 19 cost time: 1.4239892959594727
Epoch: 19, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.182 Vali Acc: 0.131 Test Loss: 3.182 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130556).  Saving model ...
Epoch: 20 cost time: 1.5682907104492188
Epoch: 20, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.172 Vali Acc: 0.131 Test Loss: 3.172 Test Acc: 0.131
Validation loss decreased (-0.130556 --> -0.130557).  Saving model ...
Epoch: 21 cost time: 1.6710798740386963
Epoch: 21, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.167 Vali Acc: 0.140 Test Loss: 3.167 Test Acc: 0.140
Validation loss decreased (-0.130557 --> -0.139968).  Saving model ...
Epoch: 22 cost time: 1.4896917343139648
Epoch: 22, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.157 Vali Acc: 0.152 Test Loss: 3.157 Test Acc: 0.152
Validation loss decreased (-0.139968 --> -0.151733).  Saving model ...
Epoch: 23 cost time: 1.445159673690796
Epoch: 23, Steps: 10 | Train Loss: 1.543 Vali Loss: 3.154 Vali Acc: 0.165 Test Loss: 3.154 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 24 cost time: 1.303626537322998
Epoch: 24, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.162 Vali Acc: 0.165 Test Loss: 3.162 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7952115535736084
Epoch: 25, Steps: 10 | Train Loss: 1.342 Vali Loss: 3.148 Vali Acc: 0.169 Test Loss: 3.148 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169380).  Saving model ...
Epoch: 26 cost time: 1.2988190650939941
Epoch: 26, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.145 Vali Acc: 0.174 Test Loss: 3.145 Test Acc: 0.174
Validation loss decreased (-0.169380 --> -0.174086).  Saving model ...
Epoch: 27 cost time: 1.3048322200775146
Epoch: 27, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.140 Vali Acc: 0.174 Test Loss: 3.140 Test Acc: 0.174
Validation loss decreased (-0.174086 --> -0.174086).  Saving model ...
Epoch: 28 cost time: 1.640592098236084
Epoch: 28, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.144 Vali Acc: 0.178 Test Loss: 3.144 Test Acc: 0.178
Validation loss decreased (-0.174086 --> -0.177616).  Saving model ...
Epoch: 29 cost time: 1.3642077445983887
Epoch: 29, Steps: 10 | Train Loss: 0.952 Vali Loss: 3.155 Vali Acc: 0.180 Test Loss: 3.155 Test Acc: 0.180
Validation loss decreased (-0.177616 --> -0.179968).  Saving model ...
Epoch: 30 cost time: 1.5458171367645264
Epoch: 30, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.169 Vali Acc: 0.182 Test Loss: 3.169 Test Acc: 0.182
Validation loss decreased (-0.179968 --> -0.182321).  Saving model ...
Epoch: 31 cost time: 1.3559212684631348
Epoch: 31, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.172 Vali Acc: 0.179 Test Loss: 3.172 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.397287130355835
Epoch: 32, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.171 Vali Acc: 0.178 Test Loss: 3.171 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.605675220489502
Epoch: 33, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.184 Vali Acc: 0.185 Test Loss: 3.184 Test Acc: 0.185
Validation loss decreased (-0.182321 --> -0.184674).  Saving model ...
Epoch: 34 cost time: 1.5494709014892578
Epoch: 34, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.186 Vali Acc: 0.184 Test Loss: 3.186 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7084143161773682
Epoch: 35, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.203 Vali Acc: 0.188 Test Loss: 3.203 Test Acc: 0.188
Validation loss decreased (-0.184674 --> -0.188203).  Saving model ...
Epoch: 36 cost time: 1.4052455425262451
Epoch: 36, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.222 Vali Acc: 0.189 Test Loss: 3.222 Test Acc: 0.189
Validation loss decreased (-0.188203 --> -0.189380).  Saving model ...
Epoch: 37 cost time: 1.5694992542266846
Epoch: 37, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.228 Vali Acc: 0.186 Test Loss: 3.228 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5928905010223389
Epoch: 38, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.238 Vali Acc: 0.188 Test Loss: 3.238 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5888903141021729
Epoch: 39, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.252 Vali Acc: 0.184 Test Loss: 3.252 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4104440212249756
Epoch: 40, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.262 Vali Acc: 0.186 Test Loss: 3.262 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5628585815429688
Epoch: 41, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.280 Vali Acc: 0.187 Test Loss: 3.280 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.433730125427246
Epoch: 42, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.287 Vali Acc: 0.185 Test Loss: 3.287 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4453456401824951
Epoch: 43, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.292 Vali Acc: 0.185 Test Loss: 3.292 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4980080127716064
Epoch: 44, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.321 Vali Acc: 0.184 Test Loss: 3.321 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3698320388793945
Epoch: 45, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.333 Vali Acc: 0.192 Test Loss: 3.333 Test Acc: 0.192
Validation loss decreased (-0.189380 --> -0.191731).  Saving model ...
Epoch: 46 cost time: 1.256852626800537
Epoch: 46, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.335 Vali Acc: 0.182 Test Loss: 3.335 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3755176067352295
Epoch: 47, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.344 Vali Acc: 0.185 Test Loss: 3.344 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4469449520111084
Epoch: 48, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.345 Vali Acc: 0.194 Test Loss: 3.345 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194084).  Saving model ...
Epoch: 49 cost time: 1.2716081142425537
Epoch: 49, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.357 Vali Acc: 0.189 Test Loss: 3.357 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3715236186981201
Epoch: 50, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.359 Vali Acc: 0.186 Test Loss: 3.359 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2515463829040527
Epoch: 51, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.367 Vali Acc: 0.186 Test Loss: 3.367 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1684906482696533
Epoch: 52, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.396 Vali Acc: 0.191 Test Loss: 3.396 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.259934663772583
Epoch: 53, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.406 Vali Acc: 0.179 Test Loss: 3.406 Test Acc: 0.179
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.6235589981079102
Epoch: 54, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.428 Vali Acc: 0.185 Test Loss: 3.428 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7512357234954834
Epoch: 55, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.440 Vali Acc: 0.181 Test Loss: 3.440 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.7130625247955322
Epoch: 56, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.438 Vali Acc: 0.181 Test Loss: 3.438 Test Acc: 0.181
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.4104089736938477
Epoch: 57, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.452 Vali Acc: 0.180 Test Loss: 3.452 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.7890472412109375
Epoch: 58, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.459 Vali Acc: 0.184 Test Loss: 3.459 Test Acc: 0.184
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19411764705882353
model parameter : 176078
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.65610408782959
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.304 Vali Acc: 0.039 Test Loss: 3.304 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.4911305904388428
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.294 Vali Acc: 0.040 Test Loss: 3.294 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.2253012657165527
Epoch: 3, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.282 Vali Acc: 0.040 Test Loss: 3.282 Test Acc: 0.040
Validation loss decreased (-0.039967 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.4885411262512207
Epoch: 4, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.273 Vali Acc: 0.042 Test Loss: 3.273 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 1.1802411079406738
Epoch: 5, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.266 Vali Acc: 0.047 Test Loss: 3.266 Test Acc: 0.047
Validation loss decreased (-0.042320 --> -0.047026).  Saving model ...
Epoch: 6 cost time: 1.326063632965088
Epoch: 6, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.263 Vali Acc: 0.061 Test Loss: 3.263 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 1.1051108837127686
Epoch: 7, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.258 Vali Acc: 0.072 Test Loss: 3.258 Test Acc: 0.072
Validation loss decreased (-0.061144 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 1.1669433116912842
Epoch: 8, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.252 Vali Acc: 0.082 Test Loss: 3.252 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082320).  Saving model ...
Epoch: 9 cost time: 1.2552225589752197
Epoch: 9, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.247 Vali Acc: 0.088 Test Loss: 3.247 Test Acc: 0.088
Validation loss decreased (-0.082320 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 1.128993272781372
Epoch: 10, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.244 Vali Acc: 0.091 Test Loss: 3.244 Test Acc: 0.091
Validation loss decreased (-0.088203 --> -0.090556).  Saving model ...
Epoch: 11 cost time: 1.205094814300537
Epoch: 11, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.241 Vali Acc: 0.100 Test Loss: 3.241 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 1.0240519046783447
Epoch: 12, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.236 Vali Acc: 0.111 Test Loss: 3.236 Test Acc: 0.111
Validation loss decreased (-0.099968 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 1.1152229309082031
Epoch: 13, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.230 Vali Acc: 0.108 Test Loss: 3.230 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3730604648590088
Epoch: 14, Steps: 10 | Train Loss: 2.273 Vali Loss: 3.227 Vali Acc: 0.109 Test Loss: 3.227 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1432974338531494
Epoch: 15, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.217 Vali Acc: 0.113 Test Loss: 3.217 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 1.3111116886138916
Epoch: 16, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.216 Vali Acc: 0.122 Test Loss: 3.216 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122321).  Saving model ...
Epoch: 17 cost time: 1.1364901065826416
Epoch: 17, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.211 Vali Acc: 0.127 Test Loss: 3.211 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 18 cost time: 1.2962863445281982
Epoch: 18, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.202 Vali Acc: 0.129 Test Loss: 3.202 Test Acc: 0.129
Validation loss decreased (-0.127027 --> -0.129380).  Saving model ...
Epoch: 19 cost time: 1.0550715923309326
Epoch: 19, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.189 Vali Acc: 0.136 Test Loss: 3.189 Test Acc: 0.136
Validation loss decreased (-0.129380 --> -0.136439).  Saving model ...
Epoch: 20 cost time: 1.3598062992095947
Epoch: 20, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.189 Vali Acc: 0.139 Test Loss: 3.189 Test Acc: 0.139
Validation loss decreased (-0.136439 --> -0.138792).  Saving model ...
Epoch: 21 cost time: 1.1693434715270996
Epoch: 21, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.181 Vali Acc: 0.142 Test Loss: 3.181 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142321).  Saving model ...
Epoch: 22 cost time: 1.202474594116211
Epoch: 22, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.181 Vali Acc: 0.139 Test Loss: 3.181 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6901414394378662
Epoch: 23, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.185 Vali Acc: 0.135 Test Loss: 3.185 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8780076503753662
Epoch: 24, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.184 Vali Acc: 0.145 Test Loss: 3.184 Test Acc: 0.145
Validation loss decreased (-0.142321 --> -0.144674).  Saving model ...
Epoch: 25 cost time: 1.422682285308838
Epoch: 25, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.178 Vali Acc: 0.149 Test Loss: 3.178 Test Acc: 0.149
Validation loss decreased (-0.144674 --> -0.149380).  Saving model ...
Epoch: 26 cost time: 1.4350183010101318
Epoch: 26, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.174 Vali Acc: 0.145 Test Loss: 3.174 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3868632316589355
Epoch: 27, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.171 Vali Acc: 0.152 Test Loss: 3.171 Test Acc: 0.152
Validation loss decreased (-0.149380 --> -0.151733).  Saving model ...
Epoch: 28 cost time: 1.6163170337677002
Epoch: 28, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.174 Vali Acc: 0.144 Test Loss: 3.174 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3105969429016113
Epoch: 29, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.171 Vali Acc: 0.155 Test Loss: 3.171 Test Acc: 0.155
Validation loss decreased (-0.151733 --> -0.155262).  Saving model ...
Epoch: 30 cost time: 1.2982261180877686
Epoch: 30, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.179 Vali Acc: 0.151 Test Loss: 3.179 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4297316074371338
Epoch: 31, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.178 Vali Acc: 0.149 Test Loss: 3.178 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.631295919418335
Epoch: 32, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.181 Vali Acc: 0.149 Test Loss: 3.181 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4923903942108154
Epoch: 33, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.194 Vali Acc: 0.142 Test Loss: 3.194 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6309621334075928
Epoch: 34, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.208 Vali Acc: 0.151 Test Loss: 3.208 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3953804969787598
Epoch: 35, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.216 Vali Acc: 0.147 Test Loss: 3.216 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4946348667144775
Epoch: 36, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.224 Vali Acc: 0.161 Test Loss: 3.224 Test Acc: 0.161
Validation loss decreased (-0.155262 --> -0.161144).  Saving model ...
Epoch: 37 cost time: 1.508805751800537
Epoch: 37, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.234 Vali Acc: 0.152 Test Loss: 3.234 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8817360401153564
Epoch: 38, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.258 Vali Acc: 0.151 Test Loss: 3.258 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.390669345855713
Epoch: 39, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.267 Vali Acc: 0.155 Test Loss: 3.267 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.1651856899261475
Epoch: 40, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.273 Vali Acc: 0.152 Test Loss: 3.273 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5283238887786865
Epoch: 41, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.282 Vali Acc: 0.159 Test Loss: 3.282 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6284935474395752
Epoch: 42, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.292 Vali Acc: 0.159 Test Loss: 3.292 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2991373538970947
Epoch: 43, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.309 Vali Acc: 0.152 Test Loss: 3.309 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.435767412185669
Epoch: 44, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.320 Vali Acc: 0.146 Test Loss: 3.320 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.414581060409546
Epoch: 45, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.321 Vali Acc: 0.155 Test Loss: 3.321 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4778635501861572
Epoch: 46, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.325 Vali Acc: 0.159 Test Loss: 3.325 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16117647058823528
model parameter : 174030
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2105767726898193
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.291 Vali Acc: 0.049 Test Loss: 3.291 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.091714859008789
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.282 Vali Acc: 0.053 Test Loss: 3.282 Test Acc: 0.053
Validation loss decreased (-0.049379 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.352231502532959
Epoch: 3, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.271 Vali Acc: 0.061 Test Loss: 3.271 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.1690120697021484
Epoch: 4, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.260 Vali Acc: 0.061 Test Loss: 3.260 Test Acc: 0.061
Validation loss decreased (-0.061144 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 0.999359130859375
Epoch: 5, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.251 Vali Acc: 0.067 Test Loss: 3.251 Test Acc: 0.067
Validation loss decreased (-0.061144 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 1.1275341510772705
Epoch: 6, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.246 Vali Acc: 0.076 Test Loss: 3.246 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.0336005687713623
Epoch: 7, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.243 Vali Acc: 0.087 Test Loss: 3.243 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.9965786933898926
Epoch: 8, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.237 Vali Acc: 0.088 Test Loss: 3.237 Test Acc: 0.088
Validation loss decreased (-0.087026 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 1.120107650756836
Epoch: 9, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.233 Vali Acc: 0.098 Test Loss: 3.233 Test Acc: 0.098
Validation loss decreased (-0.088203 --> -0.097615).  Saving model ...
Epoch: 10 cost time: 0.970057487487793
Epoch: 10, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.230 Vali Acc: 0.107 Test Loss: 3.230 Test Acc: 0.107
Validation loss decreased (-0.097615 --> -0.107027).  Saving model ...
Epoch: 11 cost time: 1.1381604671478271
Epoch: 11, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.226 Vali Acc: 0.105 Test Loss: 3.226 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2218358516693115
Epoch: 12, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.220 Vali Acc: 0.115 Test Loss: 3.220 Test Acc: 0.115
Validation loss decreased (-0.107027 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 1.1856920719146729
Epoch: 13, Steps: 10 | Train Loss: 2.114 Vali Loss: 3.218 Vali Acc: 0.119 Test Loss: 3.218 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 1.2603695392608643
Epoch: 14, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.214 Vali Acc: 0.124 Test Loss: 3.214 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 15 cost time: 0.8875441551208496
Epoch: 15, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.205 Vali Acc: 0.129 Test Loss: 3.205 Test Acc: 0.129
Validation loss decreased (-0.123497 --> -0.129380).  Saving model ...
Epoch: 16 cost time: 0.9251484870910645
Epoch: 16, Steps: 10 | Train Loss: 1.805 Vali Loss: 3.207 Vali Acc: 0.132 Test Loss: 3.207 Test Acc: 0.132
Validation loss decreased (-0.129380 --> -0.131733).  Saving model ...
Epoch: 17 cost time: 1.0309910774230957
Epoch: 17, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.203 Vali Acc: 0.141 Test Loss: 3.203 Test Acc: 0.141
Validation loss decreased (-0.131733 --> -0.141144).  Saving model ...
Epoch: 18 cost time: 0.9787082672119141
Epoch: 18, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.200 Vali Acc: 0.139 Test Loss: 3.200 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0037484169006348
Epoch: 19, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.196 Vali Acc: 0.151 Test Loss: 3.196 Test Acc: 0.151
Validation loss decreased (-0.141144 --> -0.150556).  Saving model ...
Epoch: 20 cost time: 1.0769634246826172
Epoch: 20, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.196 Vali Acc: 0.147 Test Loss: 3.196 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.034858226776123
Epoch: 21, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.187 Vali Acc: 0.147 Test Loss: 3.187 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0358259677886963
Epoch: 22, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.188 Vali Acc: 0.156 Test Loss: 3.188 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156439).  Saving model ...
Epoch: 23 cost time: 0.9838294982910156
Epoch: 23, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.190 Vali Acc: 0.155 Test Loss: 3.190 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2512116432189941
Epoch: 24, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.190 Vali Acc: 0.160 Test Loss: 3.190 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 25 cost time: 1.1234052181243896
Epoch: 25, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.184 Vali Acc: 0.158 Test Loss: 3.184 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3157577514648438
Epoch: 26, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.188 Vali Acc: 0.158 Test Loss: 3.188 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0055310726165771
Epoch: 27, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.194 Vali Acc: 0.155 Test Loss: 3.194 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1575703620910645
Epoch: 28, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.199 Vali Acc: 0.159 Test Loss: 3.199 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0675415992736816
Epoch: 29, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.206 Vali Acc: 0.161 Test Loss: 3.206 Test Acc: 0.161
Validation loss decreased (-0.159968 --> -0.161144).  Saving model ...
Epoch: 30 cost time: 1.2123816013336182
Epoch: 30, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.206 Vali Acc: 0.164 Test Loss: 3.206 Test Acc: 0.164
Validation loss decreased (-0.161144 --> -0.163497).  Saving model ...
Epoch: 31 cost time: 0.9481523036956787
Epoch: 31, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.212 Vali Acc: 0.164 Test Loss: 3.212 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2486052513122559
Epoch: 32, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.223 Vali Acc: 0.159 Test Loss: 3.223 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.244823694229126
Epoch: 33, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.229 Vali Acc: 0.162 Test Loss: 3.229 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0266904830932617
Epoch: 34, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.240 Vali Acc: 0.164 Test Loss: 3.240 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0138864517211914
Epoch: 35, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.246 Vali Acc: 0.162 Test Loss: 3.246 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0045349597930908
Epoch: 36, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.254 Vali Acc: 0.166 Test Loss: 3.254 Test Acc: 0.166
Validation loss decreased (-0.163497 --> -0.165850).  Saving model ...
Epoch: 37 cost time: 0.9804248809814453
Epoch: 37, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.253 Vali Acc: 0.171 Test Loss: 3.253 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170556).  Saving model ...
Epoch: 38 cost time: 1.1800131797790527
Epoch: 38, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.251 Vali Acc: 0.171 Test Loss: 3.251 Test Acc: 0.171
Validation loss decreased (-0.170556 --> -0.170556).  Saving model ...
Epoch: 39 cost time: 1.0066664218902588
Epoch: 39, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.267 Vali Acc: 0.171 Test Loss: 3.267 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0641047954559326
Epoch: 40, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.270 Vali Acc: 0.173 Test Loss: 3.270 Test Acc: 0.173
Validation loss decreased (-0.170556 --> -0.172908).  Saving model ...
Epoch: 41 cost time: 1.0225462913513184
Epoch: 41, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.276 Vali Acc: 0.172 Test Loss: 3.276 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1132917404174805
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.280 Vali Acc: 0.178 Test Loss: 3.280 Test Acc: 0.178
Validation loss decreased (-0.172908 --> -0.177614).  Saving model ...
Epoch: 43 cost time: 1.0663132667541504
Epoch: 43, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.287 Vali Acc: 0.176 Test Loss: 3.287 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1444013118743896
Epoch: 44, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.296 Vali Acc: 0.178 Test Loss: 3.296 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9960942268371582
Epoch: 45, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.302 Vali Acc: 0.173 Test Loss: 3.302 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9902033805847168
Epoch: 46, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.309 Vali Acc: 0.176 Test Loss: 3.309 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0837593078613281
Epoch: 47, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.314 Vali Acc: 0.175 Test Loss: 3.314 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9465751647949219
Epoch: 48, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.317 Vali Acc: 0.175 Test Loss: 3.317 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1370654106140137
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.326 Vali Acc: 0.172 Test Loss: 3.326 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0003392696380615
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.332 Vali Acc: 0.173 Test Loss: 3.332 Test Acc: 0.173
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0126433372497559
Epoch: 51, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.341 Vali Acc: 0.173 Test Loss: 3.341 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0713930130004883
Epoch: 52, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.349 Vali Acc: 0.175 Test Loss: 3.349 Test Acc: 0.175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1776470588235294
model parameter : 171982
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.642063617706299
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.325 Vali Acc: 0.041 Test Loss: 3.325 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.9184515476226807
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.318 Vali Acc: 0.045 Test Loss: 3.318 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.9759888648986816
Epoch: 3, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.309 Vali Acc: 0.047 Test Loss: 3.309 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.8280301094055176
Epoch: 4, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.300 Vali Acc: 0.049 Test Loss: 3.300 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.8663585186004639
Epoch: 5, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.292 Vali Acc: 0.049 Test Loss: 3.292 Test Acc: 0.049
Validation loss decreased (-0.049379 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 1.1408755779266357
Epoch: 6, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.288 Vali Acc: 0.052 Test Loss: 3.288 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 7 cost time: 0.7986323833465576
Epoch: 7, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.286 Vali Acc: 0.054 Test Loss: 3.286 Test Acc: 0.054
Validation loss decreased (-0.051732 --> -0.054085).  Saving model ...
Epoch: 8 cost time: 0.944023609161377
Epoch: 8, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.284 Vali Acc: 0.055 Test Loss: 3.284 Test Acc: 0.055
Validation loss decreased (-0.054085 --> -0.055261).  Saving model ...
Epoch: 9 cost time: 0.9525086879730225
Epoch: 9, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.281 Vali Acc: 0.065 Test Loss: 3.281 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064673).  Saving model ...
Epoch: 10 cost time: 1.0491247177124023
Epoch: 10, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.279 Vali Acc: 0.071 Test Loss: 3.279 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 11 cost time: 1.0174028873443604
Epoch: 11, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.279 Vali Acc: 0.071 Test Loss: 3.279 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9553251266479492
Epoch: 12, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.274 Vali Acc: 0.079 Test Loss: 3.274 Test Acc: 0.079
Validation loss decreased (-0.070555 --> -0.078791).  Saving model ...
Epoch: 13 cost time: 1.2017185688018799
Epoch: 13, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.270 Vali Acc: 0.080 Test Loss: 3.270 Test Acc: 0.080
Validation loss decreased (-0.078791 --> -0.079967).  Saving model ...
Epoch: 14 cost time: 0.8988022804260254
Epoch: 14, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.264 Vali Acc: 0.085 Test Loss: 3.264 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 15 cost time: 0.9757332801818848
Epoch: 15, Steps: 10 | Train Loss: 2.215 Vali Loss: 3.256 Vali Acc: 0.088 Test Loss: 3.256 Test Acc: 0.088
Validation loss decreased (-0.084673 --> -0.088203).  Saving model ...
Epoch: 16 cost time: 1.0138120651245117
Epoch: 16, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.250 Vali Acc: 0.094 Test Loss: 3.250 Test Acc: 0.094
Validation loss decreased (-0.088203 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 0.8680615425109863
Epoch: 17, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.246 Vali Acc: 0.099 Test Loss: 3.246 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 0.987476110458374
Epoch: 18, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.250 Vali Acc: 0.101 Test Loss: 3.250 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 19 cost time: 0.9867560863494873
Epoch: 19, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.245 Vali Acc: 0.108 Test Loss: 3.245 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108203).  Saving model ...
Epoch: 20 cost time: 1.3052890300750732
Epoch: 20, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.240 Vali Acc: 0.109 Test Loss: 3.240 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 21 cost time: 1.122694730758667
Epoch: 21, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.236 Vali Acc: 0.116 Test Loss: 3.236 Test Acc: 0.116
Validation loss decreased (-0.109379 --> -0.116438).  Saving model ...
Epoch: 22 cost time: 1.1777303218841553
Epoch: 22, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.231 Vali Acc: 0.116 Test Loss: 3.231 Test Acc: 0.116
Validation loss decreased (-0.116438 --> -0.116438).  Saving model ...
Epoch: 23 cost time: 0.917304277420044
Epoch: 23, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.223 Vali Acc: 0.120 Test Loss: 3.223 Test Acc: 0.120
Validation loss decreased (-0.116438 --> -0.119968).  Saving model ...
Epoch: 24 cost time: 0.9563724994659424
Epoch: 24, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.218 Vali Acc: 0.132 Test Loss: 3.218 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131733).  Saving model ...
Epoch: 25 cost time: 0.8876166343688965
Epoch: 25, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.225 Vali Acc: 0.128 Test Loss: 3.225 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3745112419128418
Epoch: 26, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.229 Vali Acc: 0.135 Test Loss: 3.229 Test Acc: 0.135
Validation loss decreased (-0.131733 --> -0.135262).  Saving model ...
Epoch: 27 cost time: 0.9045228958129883
Epoch: 27, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.220 Vali Acc: 0.129 Test Loss: 3.220 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1261370182037354
Epoch: 28, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.218 Vali Acc: 0.141 Test Loss: 3.218 Test Acc: 0.141
Validation loss decreased (-0.135262 --> -0.141144).  Saving model ...
Epoch: 29 cost time: 1.3266808986663818
Epoch: 29, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.218 Vali Acc: 0.144 Test Loss: 3.218 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 30 cost time: 0.8606796264648438
Epoch: 30, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.213 Vali Acc: 0.144 Test Loss: 3.213 Test Acc: 0.144
Validation loss decreased (-0.143497 --> -0.143497).  Saving model ...
Epoch: 31 cost time: 0.9310040473937988
Epoch: 31, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.222 Vali Acc: 0.149 Test Loss: 3.222 Test Acc: 0.149
Validation loss decreased (-0.143497 --> -0.149380).  Saving model ...
Epoch: 32 cost time: 0.8118600845336914
Epoch: 32, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.231 Vali Acc: 0.149 Test Loss: 3.231 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9824440479278564
Epoch: 33, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.230 Vali Acc: 0.147 Test Loss: 3.230 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9212687015533447
Epoch: 34, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.237 Vali Acc: 0.152 Test Loss: 3.237 Test Acc: 0.152
Validation loss decreased (-0.149380 --> -0.151732).  Saving model ...
Epoch: 35 cost time: 0.9542255401611328
Epoch: 35, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.236 Vali Acc: 0.161 Test Loss: 3.236 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 36 cost time: 0.9770729541778564
Epoch: 36, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.259 Vali Acc: 0.149 Test Loss: 3.259 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7981362342834473
Epoch: 37, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.274 Vali Acc: 0.154 Test Loss: 3.274 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9741272926330566
Epoch: 38, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.285 Vali Acc: 0.148 Test Loss: 3.285 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0378694534301758
Epoch: 39, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.293 Vali Acc: 0.146 Test Loss: 3.293 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8528459072113037
Epoch: 40, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.280 Vali Acc: 0.156 Test Loss: 3.280 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8638758659362793
Epoch: 41, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.285 Vali Acc: 0.155 Test Loss: 3.285 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.898418664932251
Epoch: 42, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.297 Vali Acc: 0.153 Test Loss: 3.297 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9953207969665527
Epoch: 43, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.300 Vali Acc: 0.155 Test Loss: 3.300 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2237279415130615
Epoch: 44, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.308 Vali Acc: 0.151 Test Loss: 3.308 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9725973606109619
Epoch: 45, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.316 Vali Acc: 0.161 Test Loss: 3.316 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16117647058823528
model parameter : 170446
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.745853900909424
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.310 Vali Acc: 0.044 Test Loss: 3.310 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.085132122039795
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.303 Vali Acc: 0.042 Test Loss: 3.303 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9960451126098633
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.296 Vali Acc: 0.046 Test Loss: 3.296 Test Acc: 0.046
Validation loss decreased (-0.043496 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.0240998268127441
Epoch: 4, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.288 Vali Acc: 0.053 Test Loss: 3.288 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.917999267578125
Epoch: 5, Steps: 10 | Train Loss: 3.057 Vali Loss: 3.281 Vali Acc: 0.064 Test Loss: 3.281 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.9641437530517578
Epoch: 6, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.273 Vali Acc: 0.076 Test Loss: 3.273 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.043386697769165
Epoch: 7, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.266 Vali Acc: 0.078 Test Loss: 3.266 Test Acc: 0.078
Validation loss decreased (-0.076438 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 1.0048828125
Epoch: 8, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.259 Vali Acc: 0.086 Test Loss: 3.259 Test Acc: 0.086
Validation loss decreased (-0.077614 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 1.1159546375274658
Epoch: 9, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.252 Vali Acc: 0.093 Test Loss: 3.252 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 1.1388764381408691
Epoch: 10, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.245 Vali Acc: 0.096 Test Loss: 3.245 Test Acc: 0.096
Validation loss decreased (-0.092909 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 1.1401166915893555
Epoch: 11, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.245 Vali Acc: 0.099 Test Loss: 3.245 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 1.0052001476287842
Epoch: 12, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.234 Vali Acc: 0.102 Test Loss: 3.234 Test Acc: 0.102
Validation loss decreased (-0.098791 --> -0.102321).  Saving model ...
Epoch: 13 cost time: 1.0930125713348389
Epoch: 13, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.225 Vali Acc: 0.109 Test Loss: 3.225 Test Acc: 0.109
Validation loss decreased (-0.102321 --> -0.109380).  Saving model ...
Epoch: 14 cost time: 1.2789592742919922
Epoch: 14, Steps: 10 | Train Loss: 2.139 Vali Loss: 3.219 Vali Acc: 0.114 Test Loss: 3.219 Test Acc: 0.114
Validation loss decreased (-0.109380 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 0.9328248500823975
Epoch: 15, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.210 Vali Acc: 0.121 Test Loss: 3.210 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 16 cost time: 1.1008260250091553
Epoch: 16, Steps: 10 | Train Loss: 1.880 Vali Loss: 3.203 Vali Acc: 0.132 Test Loss: 3.203 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131733).  Saving model ...
Epoch: 17 cost time: 1.1195228099822998
Epoch: 17, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.197 Vali Acc: 0.132 Test Loss: 3.197 Test Acc: 0.132
Validation loss decreased (-0.131733 --> -0.131733).  Saving model ...
Epoch: 18 cost time: 1.1886131763458252
Epoch: 18, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.191 Vali Acc: 0.144 Test Loss: 3.191 Test Acc: 0.144
Validation loss decreased (-0.131733 --> -0.143498).  Saving model ...
Epoch: 19 cost time: 1.1213009357452393
Epoch: 19, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.186 Vali Acc: 0.141 Test Loss: 3.186 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0923247337341309
Epoch: 20, Steps: 10 | Train Loss: 1.421 Vali Loss: 3.180 Vali Acc: 0.146 Test Loss: 3.180 Test Acc: 0.146
Validation loss decreased (-0.143498 --> -0.145851).  Saving model ...
Epoch: 21 cost time: 1.107924222946167
Epoch: 21, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.171 Vali Acc: 0.156 Test Loss: 3.171 Test Acc: 0.156
Validation loss decreased (-0.145851 --> -0.156439).  Saving model ...
Epoch: 22 cost time: 1.1967902183532715
Epoch: 22, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.174 Vali Acc: 0.160 Test Loss: 3.174 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 23 cost time: 1.4706857204437256
Epoch: 23, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.168 Vali Acc: 0.169 Test Loss: 3.168 Test Acc: 0.169
Validation loss decreased (-0.159968 --> -0.169380).  Saving model ...
Epoch: 24 cost time: 0.9849128723144531
Epoch: 24, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.159 Vali Acc: 0.169 Test Loss: 3.159 Test Acc: 0.169
Validation loss decreased (-0.169380 --> -0.169380).  Saving model ...
Epoch: 25 cost time: 0.9426522254943848
Epoch: 25, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.159 Vali Acc: 0.171 Test Loss: 3.159 Test Acc: 0.171
Validation loss decreased (-0.169380 --> -0.170557).  Saving model ...
Epoch: 26 cost time: 1.2863881587982178
Epoch: 26, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.162 Vali Acc: 0.167 Test Loss: 3.162 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0822126865386963
Epoch: 27, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.169 Vali Acc: 0.172 Test Loss: 3.169 Test Acc: 0.172
Validation loss decreased (-0.170557 --> -0.171733).  Saving model ...
Epoch: 28 cost time: 1.1546518802642822
Epoch: 28, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.169 Vali Acc: 0.178 Test Loss: 3.169 Test Acc: 0.178
Validation loss decreased (-0.171733 --> -0.177615).  Saving model ...
Epoch: 29 cost time: 1.1885788440704346
Epoch: 29, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.184 Vali Acc: 0.175 Test Loss: 3.184 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3972387313842773
Epoch: 30, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.187 Vali Acc: 0.178 Test Loss: 3.187 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.884042501449585
Epoch: 31, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.183 Vali Acc: 0.185 Test Loss: 3.183 Test Acc: 0.185
Validation loss decreased (-0.177615 --> -0.184674).  Saving model ...
Epoch: 32 cost time: 1.0459067821502686
Epoch: 32, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.187 Vali Acc: 0.187 Test Loss: 3.187 Test Acc: 0.187
Validation loss decreased (-0.184674 --> -0.187027).  Saving model ...
Epoch: 33 cost time: 0.9014272689819336
Epoch: 33, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.199 Vali Acc: 0.186 Test Loss: 3.199 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9750831127166748
Epoch: 34, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.208 Vali Acc: 0.185 Test Loss: 3.208 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9080889225006104
Epoch: 35, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.208 Vali Acc: 0.184 Test Loss: 3.208 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9171462059020996
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.216 Vali Acc: 0.185 Test Loss: 3.216 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9455413818359375
Epoch: 37, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.229 Vali Acc: 0.186 Test Loss: 3.229 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0060725212097168
Epoch: 38, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.238 Vali Acc: 0.186 Test Loss: 3.238 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0521938800811768
Epoch: 39, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.248 Vali Acc: 0.191 Test Loss: 3.248 Test Acc: 0.191
Validation loss decreased (-0.187027 --> -0.190556).  Saving model ...
Epoch: 40 cost time: 1.2007060050964355
Epoch: 40, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.259 Vali Acc: 0.192 Test Loss: 3.259 Test Acc: 0.192
Validation loss decreased (-0.190556 --> -0.191732).  Saving model ...
Epoch: 41 cost time: 0.9296116828918457
Epoch: 41, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.265 Vali Acc: 0.189 Test Loss: 3.265 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2092654705047607
Epoch: 42, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.271 Vali Acc: 0.188 Test Loss: 3.271 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1854448318481445
Epoch: 43, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.277 Vali Acc: 0.194 Test Loss: 3.277 Test Acc: 0.194
Validation loss decreased (-0.191732 --> -0.194085).  Saving model ...
Epoch: 44 cost time: 1.040889024734497
Epoch: 44, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.287 Vali Acc: 0.187 Test Loss: 3.287 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4395771026611328
Epoch: 45, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.297 Vali Acc: 0.186 Test Loss: 3.297 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4276585578918457
Epoch: 46, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.308 Vali Acc: 0.187 Test Loss: 3.308 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3011739253997803
Epoch: 47, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.313 Vali Acc: 0.186 Test Loss: 3.313 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.460221290588379
Epoch: 48, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.318 Vali Acc: 0.186 Test Loss: 3.318 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3627755641937256
Epoch: 49, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.325 Vali Acc: 0.182 Test Loss: 3.325 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3282995223999023
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.331 Vali Acc: 0.193 Test Loss: 3.331 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8990976810455322
Epoch: 51, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.338 Vali Acc: 0.187 Test Loss: 3.338 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.265812635421753
Epoch: 52, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.345 Vali Acc: 0.179 Test Loss: 3.345 Test Acc: 0.179
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0651862621307373
Epoch: 53, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.349 Vali Acc: 0.185 Test Loss: 3.349 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19411764705882353
model parameter : 169934
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5347015857696533
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.332 Vali Acc: 0.033 Test Loss: 3.332 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.8826191425323486
Epoch: 2, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.320 Vali Acc: 0.034 Test Loss: 3.320 Test Acc: 0.034
Validation loss decreased (-0.032908 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 0.6507284641265869
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.306 Vali Acc: 0.038 Test Loss: 3.306 Test Acc: 0.038
Validation loss decreased (-0.034084 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.7578234672546387
Epoch: 4, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.291 Vali Acc: 0.036 Test Loss: 3.291 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7971770763397217
Epoch: 5, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.279 Vali Acc: 0.033 Test Loss: 3.279 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8612382411956787
Epoch: 6, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.269 Vali Acc: 0.042 Test Loss: 3.269 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 7 cost time: 0.8734099864959717
Epoch: 7, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.260 Vali Acc: 0.054 Test Loss: 3.260 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054085).  Saving model ...
Epoch: 8 cost time: 0.8836190700531006
Epoch: 8, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.251 Vali Acc: 0.056 Test Loss: 3.251 Test Acc: 0.056
Validation loss decreased (-0.054085 --> -0.056438).  Saving model ...
Epoch: 9 cost time: 0.8801329135894775
Epoch: 9, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.244 Vali Acc: 0.065 Test Loss: 3.244 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 10 cost time: 0.6927838325500488
Epoch: 10, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.238 Vali Acc: 0.068 Test Loss: 3.238 Test Acc: 0.068
Validation loss decreased (-0.064673 --> -0.068203).  Saving model ...
Epoch: 11 cost time: 0.8378312587738037
Epoch: 11, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.232 Vali Acc: 0.076 Test Loss: 3.232 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 12 cost time: 0.9687643051147461
Epoch: 12, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.224 Vali Acc: 0.085 Test Loss: 3.224 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084674).  Saving model ...
Epoch: 13 cost time: 0.7709410190582275
Epoch: 13, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.218 Vali Acc: 0.091 Test Loss: 3.218 Test Acc: 0.091
Validation loss decreased (-0.084674 --> -0.090556).  Saving model ...
Epoch: 14 cost time: 0.9573609828948975
Epoch: 14, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.213 Vali Acc: 0.098 Test Loss: 3.213 Test Acc: 0.098
Validation loss decreased (-0.090556 --> -0.097615).  Saving model ...
Epoch: 15 cost time: 0.8653914928436279
Epoch: 15, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.210 Vali Acc: 0.111 Test Loss: 3.210 Test Acc: 0.111
Validation loss decreased (-0.097615 --> -0.110556).  Saving model ...
Epoch: 16 cost time: 0.8135201930999756
Epoch: 16, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.205 Vali Acc: 0.119 Test Loss: 3.205 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 17 cost time: 0.8668653964996338
Epoch: 17, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.198 Vali Acc: 0.124 Test Loss: 3.198 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 18 cost time: 0.9074766635894775
Epoch: 18, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.195 Vali Acc: 0.128 Test Loss: 3.195 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 19 cost time: 0.7944159507751465
Epoch: 19, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.192 Vali Acc: 0.138 Test Loss: 3.192 Test Acc: 0.138
Validation loss decreased (-0.128203 --> -0.137615).  Saving model ...
Epoch: 20 cost time: 0.8920340538024902
Epoch: 20, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.186 Vali Acc: 0.148 Test Loss: 3.186 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 21 cost time: 1.0728950500488281
Epoch: 21, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.184 Vali Acc: 0.152 Test Loss: 3.184 Test Acc: 0.152
Validation loss decreased (-0.148203 --> -0.151733).  Saving model ...
Epoch: 22 cost time: 0.8150830268859863
Epoch: 22, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.176 Vali Acc: 0.165 Test Loss: 3.176 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 23 cost time: 0.8656256198883057
Epoch: 23, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.173 Vali Acc: 0.160 Test Loss: 3.173 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0366342067718506
Epoch: 24, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.182 Vali Acc: 0.153 Test Loss: 3.182 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2121191024780273
Epoch: 25, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.181 Vali Acc: 0.158 Test Loss: 3.181 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9701473712921143
Epoch: 26, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.190 Vali Acc: 0.161 Test Loss: 3.190 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9729719161987305
Epoch: 27, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.177 Vali Acc: 0.162 Test Loss: 3.177 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8676638603210449
Epoch: 28, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.179 Vali Acc: 0.167 Test Loss: 3.179 Test Acc: 0.167
Validation loss decreased (-0.164674 --> -0.167027).  Saving model ...
Epoch: 29 cost time: 0.8457574844360352
Epoch: 29, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.189 Vali Acc: 0.167 Test Loss: 3.189 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9286484718322754
Epoch: 30, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.195 Vali Acc: 0.154 Test Loss: 3.195 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9498305320739746
Epoch: 31, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.203 Vali Acc: 0.172 Test Loss: 3.203 Test Acc: 0.172
Validation loss decreased (-0.167027 --> -0.171733).  Saving model ...
Epoch: 32 cost time: 0.8969624042510986
Epoch: 32, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.222 Vali Acc: 0.159 Test Loss: 3.222 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.912147045135498
Epoch: 33, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.229 Vali Acc: 0.165 Test Loss: 3.229 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8793444633483887
Epoch: 34, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.225 Vali Acc: 0.161 Test Loss: 3.225 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9347620010375977
Epoch: 35, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.230 Vali Acc: 0.164 Test Loss: 3.230 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9756453037261963
Epoch: 36, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.245 Vali Acc: 0.161 Test Loss: 3.245 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8942830562591553
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.252 Vali Acc: 0.165 Test Loss: 3.252 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9671885967254639
Epoch: 38, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.262 Vali Acc: 0.156 Test Loss: 3.262 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.973679780960083
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.268 Vali Acc: 0.171 Test Loss: 3.268 Test Acc: 0.171
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.898909330368042
Epoch: 40, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.283 Vali Acc: 0.172 Test Loss: 3.283 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0800457000732422
Epoch: 41, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.291 Vali Acc: 0.178 Test Loss: 3.291 Test Acc: 0.178
Validation loss decreased (-0.171733 --> -0.177614).  Saving model ...
Epoch: 42 cost time: 0.8299639225006104
Epoch: 42, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.298 Vali Acc: 0.174 Test Loss: 3.298 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8009457588195801
Epoch: 43, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.307 Vali Acc: 0.166 Test Loss: 3.307 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.098400592803955
Epoch: 44, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.312 Vali Acc: 0.168 Test Loss: 3.312 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9515235424041748
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.313 Vali Acc: 0.169 Test Loss: 3.313 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1131534576416016
Epoch: 46, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.316 Vali Acc: 0.168 Test Loss: 3.316 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7357659339904785
Epoch: 47, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.324 Vali Acc: 0.165 Test Loss: 3.324 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8854198455810547
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.332 Vali Acc: 0.167 Test Loss: 3.332 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9302194118499756
Epoch: 49, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.336 Vali Acc: 0.162 Test Loss: 3.336 Test Acc: 0.162
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.896939754486084
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.342 Vali Acc: 0.165 Test Loss: 3.342 Test Acc: 0.165
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9414851665496826
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.347 Vali Acc: 0.168 Test Loss: 3.347 Test Acc: 0.168
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1776470588235294
model parameter : 168910
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2469191551208496
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.344 Vali Acc: 0.042 Test Loss: 3.344 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.922447919845581
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.331 Vali Acc: 0.035 Test Loss: 3.331 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9060280323028564
Epoch: 3, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.313 Vali Acc: 0.029 Test Loss: 3.313 Test Acc: 0.029
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1678636074066162
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.297 Vali Acc: 0.028 Test Loss: 3.297 Test Acc: 0.028
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0400633811950684
Epoch: 5, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.284 Vali Acc: 0.038 Test Loss: 3.284 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2259025573730469
Epoch: 6, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.271 Vali Acc: 0.047 Test Loss: 3.271 Test Acc: 0.047
Validation loss decreased (-0.042320 --> -0.047026).  Saving model ...
Epoch: 7 cost time: 1.1612756252288818
Epoch: 7, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.261 Vali Acc: 0.064 Test Loss: 3.261 Test Acc: 0.064
Validation loss decreased (-0.047026 --> -0.063497).  Saving model ...
Epoch: 8 cost time: 0.8685033321380615
Epoch: 8, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.254 Vali Acc: 0.081 Test Loss: 3.254 Test Acc: 0.081
Validation loss decreased (-0.063497 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 0.9086523056030273
Epoch: 9, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.247 Vali Acc: 0.088 Test Loss: 3.247 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 0.8306269645690918
Epoch: 10, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.237 Vali Acc: 0.092 Test Loss: 3.237 Test Acc: 0.092
Validation loss decreased (-0.088203 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 0.8252949714660645
Epoch: 11, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.224 Vali Acc: 0.107 Test Loss: 3.224 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107027).  Saving model ...
Epoch: 12 cost time: 0.7195756435394287
Epoch: 12, Steps: 10 | Train Loss: 2.417 Vali Loss: 3.210 Vali Acc: 0.116 Test Loss: 3.210 Test Acc: 0.116
Validation loss decreased (-0.107027 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 1.0215635299682617
Epoch: 13, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.200 Vali Acc: 0.118 Test Loss: 3.200 Test Acc: 0.118
Validation loss decreased (-0.116438 --> -0.117615).  Saving model ...
Epoch: 14 cost time: 0.8773660659790039
Epoch: 14, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.189 Vali Acc: 0.128 Test Loss: 3.189 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 0.865849494934082
Epoch: 15, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.176 Vali Acc: 0.132 Test Loss: 3.176 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131733).  Saving model ...
Epoch: 16 cost time: 0.9548933506011963
Epoch: 16, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.166 Vali Acc: 0.145 Test Loss: 3.166 Test Acc: 0.145
Validation loss decreased (-0.131733 --> -0.144674).  Saving model ...
Epoch: 17 cost time: 0.8267035484313965
Epoch: 17, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.152 Vali Acc: 0.141 Test Loss: 3.152 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8861048221588135
Epoch: 18, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.150 Vali Acc: 0.151 Test Loss: 3.150 Test Acc: 0.151
Validation loss decreased (-0.144674 --> -0.150557).  Saving model ...
Epoch: 19 cost time: 0.9729583263397217
Epoch: 19, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.145 Vali Acc: 0.152 Test Loss: 3.145 Test Acc: 0.152
Validation loss decreased (-0.150557 --> -0.151733).  Saving model ...
Epoch: 20 cost time: 1.1016788482666016
Epoch: 20, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.130 Vali Acc: 0.154 Test Loss: 3.130 Test Acc: 0.154
Validation loss decreased (-0.151733 --> -0.154086).  Saving model ...
Epoch: 21 cost time: 1.068772315979004
Epoch: 21, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.112 Vali Acc: 0.158 Test Loss: 3.112 Test Acc: 0.158
Validation loss decreased (-0.154086 --> -0.157616).  Saving model ...
Epoch: 22 cost time: 0.9402642250061035
Epoch: 22, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.110 Vali Acc: 0.167 Test Loss: 3.110 Test Acc: 0.167
Validation loss decreased (-0.157616 --> -0.167028).  Saving model ...
Epoch: 23 cost time: 1.0655734539031982
Epoch: 23, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.104 Vali Acc: 0.169 Test Loss: 3.104 Test Acc: 0.169
Validation loss decreased (-0.167028 --> -0.169381).  Saving model ...
Epoch: 24 cost time: 0.8859825134277344
Epoch: 24, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.113 Vali Acc: 0.171 Test Loss: 3.113 Test Acc: 0.171
Validation loss decreased (-0.169381 --> -0.170557).  Saving model ...
Epoch: 25 cost time: 0.9757003784179688
Epoch: 25, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.105 Vali Acc: 0.175 Test Loss: 3.105 Test Acc: 0.175
Validation loss decreased (-0.170557 --> -0.175263).  Saving model ...
Epoch: 26 cost time: 0.9285814762115479
Epoch: 26, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.095 Vali Acc: 0.174 Test Loss: 3.095 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.071176290512085
Epoch: 27, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.110 Vali Acc: 0.180 Test Loss: 3.110 Test Acc: 0.180
Validation loss decreased (-0.175263 --> -0.179969).  Saving model ...
Epoch: 28 cost time: 0.968726634979248
Epoch: 28, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.107 Vali Acc: 0.179 Test Loss: 3.107 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7913117408752441
Epoch: 29, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.117 Vali Acc: 0.179 Test Loss: 3.117 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1478736400604248
Epoch: 30, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.107 Vali Acc: 0.178 Test Loss: 3.107 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9878077507019043
Epoch: 31, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.125 Vali Acc: 0.188 Test Loss: 3.125 Test Acc: 0.188
Validation loss decreased (-0.179969 --> -0.188204).  Saving model ...
Epoch: 32 cost time: 1.1062541007995605
Epoch: 32, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.132 Vali Acc: 0.181 Test Loss: 3.132 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8557524681091309
Epoch: 33, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.147 Vali Acc: 0.185 Test Loss: 3.147 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0347957611083984
Epoch: 34, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.151 Vali Acc: 0.186 Test Loss: 3.151 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8196306228637695
Epoch: 35, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.149 Vali Acc: 0.188 Test Loss: 3.149 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8278093338012695
Epoch: 36, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.163 Vali Acc: 0.184 Test Loss: 3.163 Test Acc: 0.184
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8935649394989014
Epoch: 37, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.173 Vali Acc: 0.191 Test Loss: 3.173 Test Acc: 0.191
Validation loss decreased (-0.188204 --> -0.190557).  Saving model ...
Epoch: 38 cost time: 0.8081316947937012
Epoch: 38, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.172 Vali Acc: 0.188 Test Loss: 3.172 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9075589179992676
Epoch: 39, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.186 Vali Acc: 0.184 Test Loss: 3.186 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8638639450073242
Epoch: 40, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.192 Vali Acc: 0.187 Test Loss: 3.192 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9280152320861816
Epoch: 41, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.193 Vali Acc: 0.188 Test Loss: 3.193 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8514583110809326
Epoch: 42, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.201 Vali Acc: 0.195 Test Loss: 3.201 Test Acc: 0.195
Validation loss decreased (-0.190557 --> -0.195262).  Saving model ...
Epoch: 43 cost time: 0.9709000587463379
Epoch: 43, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.204 Vali Acc: 0.196 Test Loss: 3.204 Test Acc: 0.196
Validation loss decreased (-0.195262 --> -0.196439).  Saving model ...
Epoch: 44 cost time: 0.9165749549865723
Epoch: 44, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.209 Vali Acc: 0.194 Test Loss: 3.209 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7449359893798828
Epoch: 45, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.218 Vali Acc: 0.192 Test Loss: 3.218 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9420506954193115
Epoch: 46, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.223 Vali Acc: 0.186 Test Loss: 3.223 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9715805053710938
Epoch: 47, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.228 Vali Acc: 0.193 Test Loss: 3.228 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8719000816345215
Epoch: 48, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.236 Vali Acc: 0.191 Test Loss: 3.236 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8127572536468506
Epoch: 49, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.239 Vali Acc: 0.192 Test Loss: 3.239 Test Acc: 0.192
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9654161930084229
Epoch: 50, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.243 Vali Acc: 0.194 Test Loss: 3.243 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8570537567138672
Epoch: 51, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.250 Vali Acc: 0.194 Test Loss: 3.250 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9051656723022461
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.255 Vali Acc: 0.195 Test Loss: 3.255 Test Acc: 0.195
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0162053108215332
Epoch: 53, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.258 Vali Acc: 0.192 Test Loss: 3.258 Test Acc: 0.192
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19647058823529412
model parameter : 168398
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6728692054748535
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.329 Vali Acc: 0.045 Test Loss: 3.329 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.6818716526031494
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.316 Vali Acc: 0.046 Test Loss: 3.316 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.6943345069885254
Epoch: 3, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.304 Vali Acc: 0.044 Test Loss: 3.304 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7713894844055176
Epoch: 4, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.294 Vali Acc: 0.044 Test Loss: 3.294 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7009685039520264
Epoch: 5, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.285 Vali Acc: 0.051 Test Loss: 3.285 Test Acc: 0.051
Validation loss decreased (-0.045849 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 1.3183104991912842
Epoch: 6, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.272 Vali Acc: 0.060 Test Loss: 3.272 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.4502716064453125
Epoch: 7, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.272 Vali Acc: 0.069 Test Loss: 3.272 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 1.6675617694854736
Epoch: 8, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.266 Vali Acc: 0.080 Test Loss: 3.266 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079967).  Saving model ...
Epoch: 9 cost time: 1.5574049949645996
Epoch: 9, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.261 Vali Acc: 0.085 Test Loss: 3.261 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 1.4563589096069336
Epoch: 10, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.257 Vali Acc: 0.091 Test Loss: 3.257 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 11 cost time: 1.4602265357971191
Epoch: 11, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.258 Vali Acc: 0.091 Test Loss: 3.258 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4782705307006836
Epoch: 12, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.259 Vali Acc: 0.098 Test Loss: 3.259 Test Acc: 0.098
Validation loss decreased (-0.090556 --> -0.097614).  Saving model ...
Epoch: 13 cost time: 1.6289138793945312
Epoch: 13, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.260 Vali Acc: 0.094 Test Loss: 3.260 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.810868263244629
Epoch: 14, Steps: 10 | Train Loss: 1.835 Vali Loss: 3.255 Vali Acc: 0.091 Test Loss: 3.255 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6070678234100342
Epoch: 15, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.257 Vali Acc: 0.093 Test Loss: 3.257 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6553101539611816
Epoch: 16, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.257 Vali Acc: 0.108 Test Loss: 3.257 Test Acc: 0.108
Validation loss decreased (-0.097614 --> -0.108203).  Saving model ...
Epoch: 17 cost time: 1.339714765548706
Epoch: 17, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.259 Vali Acc: 0.104 Test Loss: 3.259 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7261269092559814
Epoch: 18, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.270 Vali Acc: 0.111 Test Loss: 3.270 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 19 cost time: 1.6271889209747314
Epoch: 19, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.281 Vali Acc: 0.113 Test Loss: 3.281 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112908).  Saving model ...
Epoch: 20 cost time: 1.5951261520385742
Epoch: 20, Steps: 10 | Train Loss: 1.250 Vali Loss: 3.261 Vali Acc: 0.120 Test Loss: 3.261 Test Acc: 0.120
Validation loss decreased (-0.112908 --> -0.119967).  Saving model ...
Epoch: 21 cost time: 1.7098844051361084
Epoch: 21, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.272 Vali Acc: 0.118 Test Loss: 3.272 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6651532649993896
Epoch: 22, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.275 Vali Acc: 0.111 Test Loss: 3.275 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5027928352355957
Epoch: 23, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.290 Vali Acc: 0.111 Test Loss: 3.290 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7180891036987305
Epoch: 24, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.306 Vali Acc: 0.125 Test Loss: 3.306 Test Acc: 0.125
Validation loss decreased (-0.119967 --> -0.124673).  Saving model ...
Epoch: 25 cost time: 1.414886236190796
Epoch: 25, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.307 Vali Acc: 0.111 Test Loss: 3.307 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3862414360046387
Epoch: 26, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.314 Vali Acc: 0.112 Test Loss: 3.314 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3549728393554688
Epoch: 27, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.301 Vali Acc: 0.127 Test Loss: 3.301 Test Acc: 0.127
Validation loss decreased (-0.124673 --> -0.127026).  Saving model ...
Epoch: 28 cost time: 1.3871474266052246
Epoch: 28, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.328 Vali Acc: 0.131 Test Loss: 3.328 Test Acc: 0.131
Validation loss decreased (-0.127026 --> -0.130555).  Saving model ...
Epoch: 29 cost time: 1.599787712097168
Epoch: 29, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.339 Vali Acc: 0.129 Test Loss: 3.339 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5249779224395752
Epoch: 30, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.343 Vali Acc: 0.121 Test Loss: 3.343 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5991971492767334
Epoch: 31, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.359 Vali Acc: 0.138 Test Loss: 3.359 Test Acc: 0.138
Validation loss decreased (-0.130555 --> -0.137613).  Saving model ...
Epoch: 32 cost time: 1.7064929008483887
Epoch: 32, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.375 Vali Acc: 0.129 Test Loss: 3.375 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9040508270263672
Epoch: 33, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.401 Vali Acc: 0.122 Test Loss: 3.401 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7044720649719238
Epoch: 34, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.442 Vali Acc: 0.125 Test Loss: 3.442 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6926155090332031
Epoch: 35, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.432 Vali Acc: 0.138 Test Loss: 3.432 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.862283706665039
Epoch: 36, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.439 Vali Acc: 0.135 Test Loss: 3.439 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.480112075805664
Epoch: 37, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.464 Vali Acc: 0.124 Test Loss: 3.464 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7412781715393066
Epoch: 38, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.465 Vali Acc: 0.126 Test Loss: 3.465 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7710604667663574
Epoch: 39, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.508 Vali Acc: 0.133 Test Loss: 3.508 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8957445621490479
Epoch: 40, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.518 Vali Acc: 0.133 Test Loss: 3.518 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6961562633514404
Epoch: 41, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.542 Vali Acc: 0.132 Test Loss: 3.542 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1376470588235294
model parameter : 177580
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1632556915283203
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.323 Vali Acc: 0.040 Test Loss: 3.323 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.8087916374206543
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.313 Vali Acc: 0.033 Test Loss: 3.313 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5486741065979004
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.300 Vali Acc: 0.034 Test Loss: 3.300 Test Acc: 0.034
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6027660369873047
Epoch: 4, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.288 Vali Acc: 0.038 Test Loss: 3.288 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.438314437866211
Epoch: 5, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.275 Vali Acc: 0.052 Test Loss: 3.275 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 1.5351347923278809
Epoch: 6, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.263 Vali Acc: 0.055 Test Loss: 3.263 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 1.3928630352020264
Epoch: 7, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.251 Vali Acc: 0.059 Test Loss: 3.251 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 1.6809520721435547
Epoch: 8, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.241 Vali Acc: 0.072 Test Loss: 3.241 Test Acc: 0.072
Validation loss decreased (-0.058791 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 1.7350542545318604
Epoch: 9, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.240 Vali Acc: 0.069 Test Loss: 3.240 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7196919918060303
Epoch: 10, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.246 Vali Acc: 0.068 Test Loss: 3.246 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8595402240753174
Epoch: 11, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.244 Vali Acc: 0.080 Test Loss: 3.244 Test Acc: 0.080
Validation loss decreased (-0.071732 --> -0.079968).  Saving model ...
Epoch: 12 cost time: 1.8230960369110107
Epoch: 12, Steps: 10 | Train Loss: 1.964 Vali Loss: 3.242 Vali Acc: 0.092 Test Loss: 3.242 Test Acc: 0.092
Validation loss decreased (-0.079968 --> -0.091732).  Saving model ...
Epoch: 13 cost time: 2.1958117485046387
Epoch: 13, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.242 Vali Acc: 0.095 Test Loss: 3.242 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 14 cost time: 1.3305351734161377
Epoch: 14, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.237 Vali Acc: 0.104 Test Loss: 3.237 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 15 cost time: 1.619199275970459
Epoch: 15, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.244 Vali Acc: 0.100 Test Loss: 3.244 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7835426330566406
Epoch: 16, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.248 Vali Acc: 0.094 Test Loss: 3.248 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5410947799682617
Epoch: 17, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.235 Vali Acc: 0.115 Test Loss: 3.235 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115262).  Saving model ...
Epoch: 18 cost time: 1.7235138416290283
Epoch: 18, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.232 Vali Acc: 0.116 Test Loss: 3.232 Test Acc: 0.116
Validation loss decreased (-0.115262 --> -0.116438).  Saving model ...
Epoch: 19 cost time: 1.871081829071045
Epoch: 19, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.239 Vali Acc: 0.121 Test Loss: 3.239 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 20 cost time: 1.5472347736358643
Epoch: 20, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.239 Vali Acc: 0.119 Test Loss: 3.239 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6386401653289795
Epoch: 21, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.243 Vali Acc: 0.114 Test Loss: 3.243 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7575294971466064
Epoch: 22, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.253 Vali Acc: 0.118 Test Loss: 3.253 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.46181321144104
Epoch: 23, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.253 Vali Acc: 0.112 Test Loss: 3.253 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3930609226226807
Epoch: 24, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.260 Vali Acc: 0.111 Test Loss: 3.260 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8077380657196045
Epoch: 25, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.261 Vali Acc: 0.129 Test Loss: 3.261 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129379).  Saving model ...
Epoch: 26 cost time: 1.4696297645568848
Epoch: 26, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.268 Vali Acc: 0.122 Test Loss: 3.268 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5566017627716064
Epoch: 27, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.268 Vali Acc: 0.131 Test Loss: 3.268 Test Acc: 0.131
Validation loss decreased (-0.129379 --> -0.130556).  Saving model ...
Epoch: 28 cost time: 1.5258398056030273
Epoch: 28, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.273 Vali Acc: 0.126 Test Loss: 3.273 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9090406894683838
Epoch: 29, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.302 Vali Acc: 0.133 Test Loss: 3.302 Test Acc: 0.133
Validation loss decreased (-0.130556 --> -0.132908).  Saving model ...
Epoch: 30 cost time: 1.5486342906951904
Epoch: 30, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.329 Vali Acc: 0.129 Test Loss: 3.329 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5257141590118408
Epoch: 31, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.345 Vali Acc: 0.134 Test Loss: 3.345 Test Acc: 0.134
Validation loss decreased (-0.132908 --> -0.134084).  Saving model ...
Epoch: 32 cost time: 1.3784303665161133
Epoch: 32, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.338 Vali Acc: 0.122 Test Loss: 3.338 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9204564094543457
Epoch: 33, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.358 Vali Acc: 0.127 Test Loss: 3.358 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4224355220794678
Epoch: 34, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.363 Vali Acc: 0.129 Test Loss: 3.363 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2525577545166016
Epoch: 35, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.372 Vali Acc: 0.120 Test Loss: 3.372 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7467691898345947
Epoch: 36, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.385 Vali Acc: 0.133 Test Loss: 3.385 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8248240947723389
Epoch: 37, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.404 Vali Acc: 0.140 Test Loss: 3.404 Test Acc: 0.140
Validation loss decreased (-0.134084 --> -0.139966).  Saving model ...
Epoch: 38 cost time: 1.5614147186279297
Epoch: 38, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.437 Vali Acc: 0.142 Test Loss: 3.437 Test Acc: 0.142
Validation loss decreased (-0.139966 --> -0.142319).  Saving model ...
Epoch: 39 cost time: 1.6968858242034912
Epoch: 39, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.457 Vali Acc: 0.139 Test Loss: 3.457 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5974645614624023
Epoch: 40, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.457 Vali Acc: 0.135 Test Loss: 3.457 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.587508201599121
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.453 Vali Acc: 0.136 Test Loss: 3.453 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3482866287231445
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.474 Vali Acc: 0.144 Test Loss: 3.474 Test Acc: 0.144
Validation loss decreased (-0.142319 --> -0.143495).  Saving model ...
Epoch: 43 cost time: 1.6277496814727783
Epoch: 43, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.496 Vali Acc: 0.133 Test Loss: 3.496 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5107636451721191
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.501 Vali Acc: 0.127 Test Loss: 3.501 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.442643404006958
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.510 Vali Acc: 0.124 Test Loss: 3.510 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4327280521392822
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.527 Vali Acc: 0.122 Test Loss: 3.527 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5313925743103027
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.534 Vali Acc: 0.127 Test Loss: 3.534 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4634222984313965
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.536 Vali Acc: 0.121 Test Loss: 3.536 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.913252830505371
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.543 Vali Acc: 0.125 Test Loss: 3.543 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.613478660583496
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.549 Vali Acc: 0.121 Test Loss: 3.549 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.621464729309082
Epoch: 51, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.552 Vali Acc: 0.126 Test Loss: 3.552 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.7490642070770264
Epoch: 52, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.554 Vali Acc: 0.129 Test Loss: 3.554 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14352941176470588
model parameter : 176044
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.491445779800415
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.339 Vali Acc: 0.032 Test Loss: 3.339 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.4613065719604492
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.326 Vali Acc: 0.031 Test Loss: 3.326 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3348102569580078
Epoch: 3, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.312 Vali Acc: 0.032 Test Loss: 3.312 Test Acc: 0.032
Validation loss decreased (-0.031731 --> -0.031732).  Saving model ...
Epoch: 4 cost time: 1.2490074634552002
Epoch: 4, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.295 Vali Acc: 0.036 Test Loss: 3.295 Test Acc: 0.036
Validation loss decreased (-0.031732 --> -0.036438).  Saving model ...
Epoch: 5 cost time: 1.1062965393066406
Epoch: 5, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.279 Vali Acc: 0.049 Test Loss: 3.279 Test Acc: 0.049
Validation loss decreased (-0.036438 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 1.277890682220459
Epoch: 6, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.269 Vali Acc: 0.053 Test Loss: 3.269 Test Acc: 0.053
Validation loss decreased (-0.049379 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 1.1029326915740967
Epoch: 7, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.264 Vali Acc: 0.069 Test Loss: 3.264 Test Acc: 0.069
Validation loss decreased (-0.052908 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 1.1136682033538818
Epoch: 8, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.252 Vali Acc: 0.074 Test Loss: 3.252 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 1.2204527854919434
Epoch: 9, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.247 Vali Acc: 0.079 Test Loss: 3.247 Test Acc: 0.079
Validation loss decreased (-0.074085 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 1.0167317390441895
Epoch: 10, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.247 Vali Acc: 0.081 Test Loss: 3.247 Test Acc: 0.081
Validation loss decreased (-0.078791 --> -0.081144).  Saving model ...
Epoch: 11 cost time: 1.0363006591796875
Epoch: 11, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.243 Vali Acc: 0.089 Test Loss: 3.243 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089379).  Saving model ...
Epoch: 12 cost time: 1.122952938079834
Epoch: 12, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.241 Vali Acc: 0.089 Test Loss: 3.241 Test Acc: 0.089
Validation loss decreased (-0.089379 --> -0.089379).  Saving model ...
Epoch: 13 cost time: 1.166978359222412
Epoch: 13, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.238 Vali Acc: 0.092 Test Loss: 3.238 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 14 cost time: 1.2038462162017822
Epoch: 14, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.237 Vali Acc: 0.093 Test Loss: 3.237 Test Acc: 0.093
Validation loss decreased (-0.091732 --> -0.092909).  Saving model ...
Epoch: 15 cost time: 1.0860090255737305
Epoch: 15, Steps: 10 | Train Loss: 1.546 Vali Loss: 3.234 Vali Acc: 0.111 Test Loss: 3.234 Test Acc: 0.111
Validation loss decreased (-0.092909 --> -0.110556).  Saving model ...
Epoch: 16 cost time: 1.1271626949310303
Epoch: 16, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.238 Vali Acc: 0.111 Test Loss: 3.238 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2228102684020996
Epoch: 17, Steps: 10 | Train Loss: 1.322 Vali Loss: 3.241 Vali Acc: 0.116 Test Loss: 3.241 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116438).  Saving model ...
Epoch: 18 cost time: 1.0119578838348389
Epoch: 18, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.240 Vali Acc: 0.114 Test Loss: 3.240 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2305126190185547
Epoch: 19, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.238 Vali Acc: 0.115 Test Loss: 3.238 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2503178119659424
Epoch: 20, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.245 Vali Acc: 0.121 Test Loss: 3.245 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 21 cost time: 1.163834810256958
Epoch: 21, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.223 Vali Acc: 0.114 Test Loss: 3.223 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1469645500183105
Epoch: 22, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.236 Vali Acc: 0.118 Test Loss: 3.236 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2337143421173096
Epoch: 23, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.231 Vali Acc: 0.120 Test Loss: 3.231 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0629746913909912
Epoch: 24, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.232 Vali Acc: 0.121 Test Loss: 3.232 Test Acc: 0.121
Validation loss decreased (-0.121144 --> -0.121144).  Saving model ...
Epoch: 25 cost time: 1.0966856479644775
Epoch: 25, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.244 Vali Acc: 0.138 Test Loss: 3.244 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137615).  Saving model ...
Epoch: 26 cost time: 1.1104528903961182
Epoch: 26, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.252 Vali Acc: 0.139 Test Loss: 3.252 Test Acc: 0.139
Validation loss decreased (-0.137615 --> -0.138791).  Saving model ...
Epoch: 27 cost time: 1.315659999847412
Epoch: 27, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.260 Vali Acc: 0.126 Test Loss: 3.260 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.100992202758789
Epoch: 28, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.257 Vali Acc: 0.142 Test Loss: 3.257 Test Acc: 0.142
Validation loss decreased (-0.138791 --> -0.142320).  Saving model ...
Epoch: 29 cost time: 1.2611560821533203
Epoch: 29, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.255 Vali Acc: 0.141 Test Loss: 3.255 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1580307483673096
Epoch: 30, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.254 Vali Acc: 0.142 Test Loss: 3.254 Test Acc: 0.142
Validation loss decreased (-0.142320 --> -0.142320).  Saving model ...
Epoch: 31 cost time: 1.1982507705688477
Epoch: 31, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.259 Vali Acc: 0.145 Test Loss: 3.259 Test Acc: 0.145
Validation loss decreased (-0.142320 --> -0.144673).  Saving model ...
Epoch: 32 cost time: 1.0550909042358398
Epoch: 32, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.277 Vali Acc: 0.155 Test Loss: 3.277 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155261).  Saving model ...
Epoch: 33 cost time: 1.1935029029846191
Epoch: 33, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.274 Vali Acc: 0.148 Test Loss: 3.274 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2058963775634766
Epoch: 34, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.303 Vali Acc: 0.145 Test Loss: 3.303 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1320946216583252
Epoch: 35, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.295 Vali Acc: 0.151 Test Loss: 3.295 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0684466361999512
Epoch: 36, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.320 Vali Acc: 0.146 Test Loss: 3.320 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.088503122329712
Epoch: 37, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.318 Vali Acc: 0.146 Test Loss: 3.318 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.160017490386963
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.346 Vali Acc: 0.151 Test Loss: 3.346 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1370635032653809
Epoch: 39, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.356 Vali Acc: 0.147 Test Loss: 3.356 Test Acc: 0.147
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.056171178817749
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.366 Vali Acc: 0.147 Test Loss: 3.366 Test Acc: 0.147
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9710204601287842
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.368 Vali Acc: 0.152 Test Loss: 3.368 Test Acc: 0.152
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0233356952667236
Epoch: 42, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.383 Vali Acc: 0.145 Test Loss: 3.383 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15529411764705883
model parameter : 173996
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7860500812530518
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.357 Vali Acc: 0.042 Test Loss: 3.357 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 1.1955757141113281
Epoch: 2, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.342 Vali Acc: 0.048 Test Loss: 3.342 Test Acc: 0.048
Validation loss decreased (-0.042319 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 1.2323124408721924
Epoch: 3, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.327 Vali Acc: 0.052 Test Loss: 3.327 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.230276107788086
Epoch: 4, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.307 Vali Acc: 0.056 Test Loss: 3.307 Test Acc: 0.056
Validation loss decreased (-0.051731 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.0240931510925293
Epoch: 5, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.291 Vali Acc: 0.068 Test Loss: 3.291 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 1.1221914291381836
Epoch: 6, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.281 Vali Acc: 0.076 Test Loss: 3.281 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.448413372039795
Epoch: 7, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.270 Vali Acc: 0.076 Test Loss: 3.270 Test Acc: 0.076
Validation loss decreased (-0.076438 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 1.0290906429290771
Epoch: 8, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.260 Vali Acc: 0.085 Test Loss: 3.260 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 1.0074799060821533
Epoch: 9, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.253 Vali Acc: 0.079 Test Loss: 3.253 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1754612922668457
Epoch: 10, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.249 Vali Acc: 0.078 Test Loss: 3.249 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9599590301513672
Epoch: 11, Steps: 10 | Train Loss: 1.969 Vali Loss: 3.251 Vali Acc: 0.080 Test Loss: 3.251 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1585688591003418
Epoch: 12, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.250 Vali Acc: 0.086 Test Loss: 3.250 Test Acc: 0.086
Validation loss decreased (-0.084673 --> -0.085850).  Saving model ...
Epoch: 13 cost time: 1.1183006763458252
Epoch: 13, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.249 Vali Acc: 0.096 Test Loss: 3.249 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 14 cost time: 0.9335856437683105
Epoch: 14, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.250 Vali Acc: 0.098 Test Loss: 3.250 Test Acc: 0.098
Validation loss decreased (-0.096438 --> -0.097615).  Saving model ...
Epoch: 15 cost time: 1.1581966876983643
Epoch: 15, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.248 Vali Acc: 0.104 Test Loss: 3.248 Test Acc: 0.104
Validation loss decreased (-0.097615 --> -0.103497).  Saving model ...
Epoch: 16 cost time: 1.3953025341033936
Epoch: 16, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.251 Vali Acc: 0.100 Test Loss: 3.251 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1976609230041504
Epoch: 17, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.245 Vali Acc: 0.107 Test Loss: 3.245 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 18 cost time: 1.0079166889190674
Epoch: 18, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.235 Vali Acc: 0.106 Test Loss: 3.235 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.180548906326294
Epoch: 19, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.237 Vali Acc: 0.109 Test Loss: 3.237 Test Acc: 0.109
Validation loss decreased (-0.107026 --> -0.109379).  Saving model ...
Epoch: 20 cost time: 0.8549940586090088
Epoch: 20, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.245 Vali Acc: 0.114 Test Loss: 3.245 Test Acc: 0.114
Validation loss decreased (-0.109379 --> -0.114085).  Saving model ...
Epoch: 21 cost time: 1.1394257545471191
Epoch: 21, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.242 Vali Acc: 0.120 Test Loss: 3.242 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119968).  Saving model ...
Epoch: 22 cost time: 1.0962047576904297
Epoch: 22, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.246 Vali Acc: 0.118 Test Loss: 3.246 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.095979928970337
Epoch: 23, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.267 Vali Acc: 0.116 Test Loss: 3.267 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.178276777267456
Epoch: 24, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.261 Vali Acc: 0.125 Test Loss: 3.261 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124673).  Saving model ...
Epoch: 25 cost time: 1.1572256088256836
Epoch: 25, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.264 Vali Acc: 0.122 Test Loss: 3.264 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3556370735168457
Epoch: 26, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.269 Vali Acc: 0.132 Test Loss: 3.269 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 27 cost time: 1.5671005249023438
Epoch: 27, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.259 Vali Acc: 0.127 Test Loss: 3.259 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.287714958190918
Epoch: 28, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.575944185256958
Epoch: 29, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.298 Vali Acc: 0.131 Test Loss: 3.298 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4444427490234375
Epoch: 30, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.294 Vali Acc: 0.131 Test Loss: 3.294 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1638822555541992
Epoch: 31, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.303 Vali Acc: 0.128 Test Loss: 3.303 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2506968975067139
Epoch: 32, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.303 Vali Acc: 0.132 Test Loss: 3.303 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1990547180175781
Epoch: 33, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.324 Vali Acc: 0.131 Test Loss: 3.324 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0946192741394043
Epoch: 34, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.333 Vali Acc: 0.133 Test Loss: 3.333 Test Acc: 0.133
Validation loss decreased (-0.131732 --> -0.132908).  Saving model ...
Epoch: 35 cost time: 1.3006739616394043
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.346 Vali Acc: 0.135 Test Loss: 3.346 Test Acc: 0.135
Validation loss decreased (-0.132908 --> -0.135261).  Saving model ...
Epoch: 36 cost time: 1.1571943759918213
Epoch: 36, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.356 Vali Acc: 0.135 Test Loss: 3.356 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.511948823928833
Epoch: 37, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.359 Vali Acc: 0.134 Test Loss: 3.359 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4725489616394043
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.367 Vali Acc: 0.140 Test Loss: 3.367 Test Acc: 0.140
Validation loss decreased (-0.135261 --> -0.139966).  Saving model ...
Epoch: 39 cost time: 1.3676326274871826
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.373 Vali Acc: 0.136 Test Loss: 3.373 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.208669900894165
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.386 Vali Acc: 0.127 Test Loss: 3.386 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3388140201568604
Epoch: 41, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.393 Vali Acc: 0.129 Test Loss: 3.393 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2264971733093262
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.397 Vali Acc: 0.128 Test Loss: 3.397 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2840285301208496
Epoch: 43, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.404 Vali Acc: 0.132 Test Loss: 3.404 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1211402416229248
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.410 Vali Acc: 0.132 Test Loss: 3.410 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2809617519378662
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.414 Vali Acc: 0.132 Test Loss: 3.414 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.468916893005371
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.413 Vali Acc: 0.133 Test Loss: 3.413 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3095204830169678
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.416 Vali Acc: 0.135 Test Loss: 3.416 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0766239166259766
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.422 Vali Acc: 0.134 Test Loss: 3.422 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14
model parameter : 171948
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0312843322753906
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.306 Vali Acc: 0.051 Test Loss: 3.306 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.9299750328063965
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.294 Vali Acc: 0.052 Test Loss: 3.294 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.031184196472168
Epoch: 3, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.279 Vali Acc: 0.056 Test Loss: 3.279 Test Acc: 0.056
Validation loss decreased (-0.051732 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.8996856212615967
Epoch: 4, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.271 Vali Acc: 0.065 Test Loss: 3.271 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.9885869026184082
Epoch: 5, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.260 Vali Acc: 0.065 Test Loss: 3.260 Test Acc: 0.065
Validation loss decreased (-0.064673 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 1.1622097492218018
Epoch: 6, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.247 Vali Acc: 0.078 Test Loss: 3.247 Test Acc: 0.078
Validation loss decreased (-0.064673 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 1.3065364360809326
Epoch: 7, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.233 Vali Acc: 0.088 Test Loss: 3.233 Test Acc: 0.088
Validation loss decreased (-0.077615 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 0.8920574188232422
Epoch: 8, Steps: 10 | Train Loss: 2.270 Vali Loss: 3.229 Vali Acc: 0.082 Test Loss: 3.229 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0166771411895752
Epoch: 9, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.226 Vali Acc: 0.096 Test Loss: 3.226 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 1.0110578536987305
Epoch: 10, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.225 Vali Acc: 0.096 Test Loss: 3.225 Test Acc: 0.096
Validation loss decreased (-0.096438 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.9268538951873779
Epoch: 11, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.224 Vali Acc: 0.101 Test Loss: 3.224 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 1.1321899890899658
Epoch: 12, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.229 Vali Acc: 0.104 Test Loss: 3.229 Test Acc: 0.104
Validation loss decreased (-0.101144 --> -0.103497).  Saving model ...
Epoch: 13 cost time: 1.054272174835205
Epoch: 13, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.231 Vali Acc: 0.108 Test Loss: 3.231 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 14 cost time: 1.066859245300293
Epoch: 14, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.229 Vali Acc: 0.105 Test Loss: 3.229 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.853379487991333
Epoch: 15, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.108203 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.9960074424743652
Epoch: 16, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.224 Vali Acc: 0.119 Test Loss: 3.224 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118791).  Saving model ...
Epoch: 17 cost time: 1.0459096431732178
Epoch: 17, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.227 Vali Acc: 0.116 Test Loss: 3.227 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9293255805969238
Epoch: 18, Steps: 10 | Train Loss: 0.926 Vali Loss: 3.235 Vali Acc: 0.129 Test Loss: 3.235 Test Acc: 0.129
Validation loss decreased (-0.118791 --> -0.129379).  Saving model ...
Epoch: 19 cost time: 1.0360057353973389
Epoch: 19, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.241 Vali Acc: 0.128 Test Loss: 3.241 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.809575080871582
Epoch: 20, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.240 Vali Acc: 0.122 Test Loss: 3.240 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8494482040405273
Epoch: 21, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.238 Vali Acc: 0.139 Test Loss: 3.238 Test Acc: 0.139
Validation loss decreased (-0.129379 --> -0.138791).  Saving model ...
Epoch: 22 cost time: 0.8736672401428223
Epoch: 22, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.240 Vali Acc: 0.134 Test Loss: 3.240 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8960649967193604
Epoch: 23, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.241 Vali Acc: 0.139 Test Loss: 3.241 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9403743743896484
Epoch: 24, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.245 Vali Acc: 0.129 Test Loss: 3.245 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9189841747283936
Epoch: 25, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.237 Vali Acc: 0.129 Test Loss: 3.237 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.929224967956543
Epoch: 26, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.245 Vali Acc: 0.131 Test Loss: 3.245 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0324649810791016
Epoch: 27, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.253 Vali Acc: 0.138 Test Loss: 3.253 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9478211402893066
Epoch: 28, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.267 Vali Acc: 0.131 Test Loss: 3.267 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0696136951446533
Epoch: 29, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.265 Vali Acc: 0.135 Test Loss: 3.265 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0139720439910889
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.266 Vali Acc: 0.136 Test Loss: 3.266 Test Acc: 0.136
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0057158470153809
Epoch: 31, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.277 Vali Acc: 0.133 Test Loss: 3.277 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1388235294117647
model parameter : 170412
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.622856616973877
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.315 Vali Acc: 0.041 Test Loss: 3.315 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.977083683013916
Epoch: 2, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.298 Vali Acc: 0.049 Test Loss: 3.298 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.8926191329956055
Epoch: 3, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.282 Vali Acc: 0.052 Test Loss: 3.282 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.8628768920898438
Epoch: 4, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.267 Vali Acc: 0.046 Test Loss: 3.267 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.09991455078125
Epoch: 5, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.254 Vali Acc: 0.060 Test Loss: 3.254 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.9566161632537842
Epoch: 6, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.239 Vali Acc: 0.055 Test Loss: 3.239 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3952302932739258
Epoch: 7, Steps: 10 | Train Loss: 2.440 Vali Loss: 3.223 Vali Acc: 0.065 Test Loss: 3.223 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064674).  Saving model ...
Epoch: 8 cost time: 1.0234854221343994
Epoch: 8, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.218 Vali Acc: 0.076 Test Loss: 3.218 Test Acc: 0.076
Validation loss decreased (-0.064674 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 0.976172685623169
Epoch: 9, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.216 Vali Acc: 0.079 Test Loss: 3.216 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 1.298509120941162
Epoch: 10, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.218 Vali Acc: 0.087 Test Loss: 3.218 Test Acc: 0.087
Validation loss decreased (-0.078791 --> -0.087027).  Saving model ...
Epoch: 11 cost time: 1.105652093887329
Epoch: 11, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.217 Vali Acc: 0.084 Test Loss: 3.217 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9386682510375977
Epoch: 12, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.216 Vali Acc: 0.094 Test Loss: 3.216 Test Acc: 0.094
Validation loss decreased (-0.087027 --> -0.094085).  Saving model ...
Epoch: 13 cost time: 1.0091731548309326
Epoch: 13, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.215 Vali Acc: 0.111 Test Loss: 3.215 Test Acc: 0.111
Validation loss decreased (-0.094085 --> -0.110556).  Saving model ...
Epoch: 14 cost time: 1.1194376945495605
Epoch: 14, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.217 Vali Acc: 0.111 Test Loss: 3.217 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9597268104553223
Epoch: 15, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.217 Vali Acc: 0.113 Test Loss: 3.217 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.9273302555084229
Epoch: 16, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.204 Vali Acc: 0.112 Test Loss: 3.204 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8973910808563232
Epoch: 17, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.197 Vali Acc: 0.116 Test Loss: 3.197 Test Acc: 0.116
Validation loss decreased (-0.112909 --> -0.116439).  Saving model ...
Epoch: 18 cost time: 0.8074393272399902
Epoch: 18, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.201 Vali Acc: 0.115 Test Loss: 3.201 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.20982027053833
Epoch: 19, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.208 Vali Acc: 0.114 Test Loss: 3.208 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0261836051940918
Epoch: 20, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.213 Vali Acc: 0.114 Test Loss: 3.213 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9482042789459229
Epoch: 21, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.210 Vali Acc: 0.113 Test Loss: 3.210 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9978258609771729
Epoch: 22, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.217 Vali Acc: 0.126 Test Loss: 3.217 Test Acc: 0.126
Validation loss decreased (-0.116439 --> -0.125850).  Saving model ...
Epoch: 23 cost time: 0.9172217845916748
Epoch: 23, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.223 Vali Acc: 0.121 Test Loss: 3.223 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.933544397354126
Epoch: 24, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.230 Vali Acc: 0.125 Test Loss: 3.230 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9169788360595703
Epoch: 25, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.243 Vali Acc: 0.128 Test Loss: 3.243 Test Acc: 0.128
Validation loss decreased (-0.125850 --> -0.128203).  Saving model ...
Epoch: 26 cost time: 0.9604265689849854
Epoch: 26, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.242 Vali Acc: 0.126 Test Loss: 3.242 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9076523780822754
Epoch: 27, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.244 Vali Acc: 0.134 Test Loss: 3.244 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 28 cost time: 0.9818506240844727
Epoch: 28, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.250 Vali Acc: 0.139 Test Loss: 3.250 Test Acc: 0.139
Validation loss decreased (-0.134085 --> -0.138791).  Saving model ...
Epoch: 29 cost time: 0.9564223289489746
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.266 Vali Acc: 0.139 Test Loss: 3.266 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1077041625976562
Epoch: 30, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.272 Vali Acc: 0.139 Test Loss: 3.272 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8394861221313477
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.284 Vali Acc: 0.138 Test Loss: 3.284 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9661591053009033
Epoch: 32, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.281 Vali Acc: 0.138 Test Loss: 3.281 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1219899654388428
Epoch: 33, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.287 Vali Acc: 0.148 Test Loss: 3.287 Test Acc: 0.148
Validation loss decreased (-0.138791 --> -0.148202).  Saving model ...
Epoch: 34 cost time: 0.9505875110626221
Epoch: 34, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.290 Vali Acc: 0.140 Test Loss: 3.290 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9947724342346191
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.300 Vali Acc: 0.135 Test Loss: 3.300 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.174980878829956
Epoch: 36, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.308 Vali Acc: 0.136 Test Loss: 3.308 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1340956687927246
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.310 Vali Acc: 0.144 Test Loss: 3.310 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0148365497589111
Epoch: 38, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.311 Vali Acc: 0.144 Test Loss: 3.311 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1610586643218994
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.317 Vali Acc: 0.142 Test Loss: 3.317 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0765876770019531
Epoch: 40, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.322 Vali Acc: 0.138 Test Loss: 3.322 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0017900466918945
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.326 Vali Acc: 0.134 Test Loss: 3.326 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.018190860748291
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.330 Vali Acc: 0.141 Test Loss: 3.330 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0612151622772217
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.335 Vali Acc: 0.136 Test Loss: 3.335 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14823529411764705
model parameter : 169900
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5461599826812744
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.350 Vali Acc: 0.027 Test Loss: 3.350 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.948946475982666
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.338 Vali Acc: 0.031 Test Loss: 3.338 Test Acc: 0.031
Validation loss decreased (-0.027025 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 0.657376766204834
Epoch: 3, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.327 Vali Acc: 0.032 Test Loss: 3.327 Test Acc: 0.032
Validation loss decreased (-0.030555 --> -0.031731).  Saving model ...
Epoch: 4 cost time: 0.7600152492523193
Epoch: 4, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.318 Vali Acc: 0.033 Test Loss: 3.318 Test Acc: 0.033
Validation loss decreased (-0.031731 --> -0.032908).  Saving model ...
Epoch: 5 cost time: 0.8192977905273438
Epoch: 5, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.302 Vali Acc: 0.044 Test Loss: 3.302 Test Acc: 0.044
Validation loss decreased (-0.032908 --> -0.043496).  Saving model ...
Epoch: 6 cost time: 1.0393650531768799
Epoch: 6, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.290 Vali Acc: 0.053 Test Loss: 3.290 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 0.8650734424591064
Epoch: 7, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.275 Vali Acc: 0.059 Test Loss: 3.275 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 1.221970558166504
Epoch: 8, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.265 Vali Acc: 0.073 Test Loss: 3.265 Test Acc: 0.073
Validation loss decreased (-0.058791 --> -0.072909).  Saving model ...
Epoch: 9 cost time: 1.0448615550994873
Epoch: 9, Steps: 10 | Train Loss: 2.016 Vali Loss: 3.262 Vali Acc: 0.076 Test Loss: 3.262 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 1.291191577911377
Epoch: 10, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.256 Vali Acc: 0.085 Test Loss: 3.256 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 11 cost time: 1.1127045154571533
Epoch: 11, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.256 Vali Acc: 0.085 Test Loss: 3.256 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1247079372406006
Epoch: 12, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.260 Vali Acc: 0.093 Test Loss: 3.260 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092909).  Saving model ...
Epoch: 13 cost time: 1.0536887645721436
Epoch: 13, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.260 Vali Acc: 0.095 Test Loss: 3.260 Test Acc: 0.095
Validation loss decreased (-0.092909 --> -0.095262).  Saving model ...
Epoch: 14 cost time: 0.9417672157287598
Epoch: 14, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.253 Vali Acc: 0.093 Test Loss: 3.253 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.40510892868042
Epoch: 15, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.245 Vali Acc: 0.101 Test Loss: 3.245 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 16 cost time: 1.0720252990722656
Epoch: 16, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.246 Vali Acc: 0.116 Test Loss: 3.246 Test Acc: 0.116
Validation loss decreased (-0.101144 --> -0.116438).  Saving model ...
Epoch: 17 cost time: 1.0401971340179443
Epoch: 17, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.240 Vali Acc: 0.125 Test Loss: 3.240 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124673).  Saving model ...
Epoch: 18 cost time: 1.1583104133605957
Epoch: 18, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.249 Vali Acc: 0.124 Test Loss: 3.249 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2263362407684326
Epoch: 19, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.245 Vali Acc: 0.122 Test Loss: 3.245 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0156080722808838
Epoch: 20, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.257 Vali Acc: 0.133 Test Loss: 3.257 Test Acc: 0.133
Validation loss decreased (-0.124673 --> -0.132909).  Saving model ...
Epoch: 21 cost time: 0.9148049354553223
Epoch: 21, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.268 Vali Acc: 0.131 Test Loss: 3.268 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0052318572998047
Epoch: 22, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.269 Vali Acc: 0.129 Test Loss: 3.269 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8253121376037598
Epoch: 23, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.266 Vali Acc: 0.132 Test Loss: 3.266 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8916964530944824
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.262 Vali Acc: 0.132 Test Loss: 3.262 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9654057025909424
Epoch: 25, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.269 Vali Acc: 0.136 Test Loss: 3.269 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136438).  Saving model ...
Epoch: 26 cost time: 0.7165944576263428
Epoch: 26, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.290 Vali Acc: 0.132 Test Loss: 3.290 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9796838760375977
Epoch: 27, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.292 Vali Acc: 0.138 Test Loss: 3.292 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137614).  Saving model ...
Epoch: 28 cost time: 1.0946369171142578
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.307 Vali Acc: 0.140 Test Loss: 3.307 Test Acc: 0.140
Validation loss decreased (-0.137614 --> -0.139967).  Saving model ...
Epoch: 29 cost time: 1.0091631412506104
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.313 Vali Acc: 0.136 Test Loss: 3.313 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7898619174957275
Epoch: 30, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.312 Vali Acc: 0.144 Test Loss: 3.312 Test Acc: 0.144
Validation loss decreased (-0.139967 --> -0.143496).  Saving model ...
Epoch: 31 cost time: 1.1980369091033936
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.314 Vali Acc: 0.146 Test Loss: 3.314 Test Acc: 0.146
Validation loss decreased (-0.143496 --> -0.145849).  Saving model ...
Epoch: 32 cost time: 1.0113890171051025
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.318 Vali Acc: 0.139 Test Loss: 3.318 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1370980739593506
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.326 Vali Acc: 0.135 Test Loss: 3.326 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0573022365570068
Epoch: 34, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.330 Vali Acc: 0.134 Test Loss: 3.330 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0910911560058594
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.335 Vali Acc: 0.135 Test Loss: 3.335 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0846519470214844
Epoch: 36, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.341 Vali Acc: 0.141 Test Loss: 3.341 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0230345726013184
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.343 Vali Acc: 0.141 Test Loss: 3.343 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1251442432403564
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.347 Vali Acc: 0.142 Test Loss: 3.347 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2083055973052979
Epoch: 39, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.356 Vali Acc: 0.141 Test Loss: 3.356 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.033907175064087
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.364 Vali Acc: 0.138 Test Loss: 3.364 Test Acc: 0.138
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1429646015167236
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.368 Vali Acc: 0.138 Test Loss: 3.368 Test Acc: 0.138
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14588235294117646
model parameter : 168876
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.783684730529785
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.336 Vali Acc: 0.032 Test Loss: 3.336 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.6922318935394287
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.327 Vali Acc: 0.028 Test Loss: 3.327 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7129983901977539
Epoch: 3, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.312 Vali Acc: 0.035 Test Loss: 3.312 Test Acc: 0.035
Validation loss decreased (-0.031731 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.6802067756652832
Epoch: 4, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.6065149307250977
Epoch: 5, Steps: 10 | Train Loss: 2.733 Vali Loss: 3.293 Vali Acc: 0.053 Test Loss: 3.293 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 0.8115360736846924
Epoch: 6, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.287 Vali Acc: 0.055 Test Loss: 3.287 Test Acc: 0.055
Validation loss decreased (-0.052908 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 0.7408745288848877
Epoch: 7, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.275 Vali Acc: 0.058 Test Loss: 3.275 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 0.7385265827178955
Epoch: 8, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.269 Vali Acc: 0.071 Test Loss: 3.269 Test Acc: 0.071
Validation loss decreased (-0.057614 --> -0.070556).  Saving model ...
Epoch: 9 cost time: 0.778559684753418
Epoch: 9, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.271 Vali Acc: 0.066 Test Loss: 3.271 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6523792743682861
Epoch: 10, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.271 Vali Acc: 0.079 Test Loss: 3.271 Test Acc: 0.079
Validation loss decreased (-0.070556 --> -0.078791).  Saving model ...
Epoch: 11 cost time: 0.7059662342071533
Epoch: 11, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.264 Vali Acc: 0.085 Test Loss: 3.264 Test Acc: 0.085
Validation loss decreased (-0.078791 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 0.6303422451019287
Epoch: 12, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.264 Vali Acc: 0.093 Test Loss: 3.264 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092909).  Saving model ...
Epoch: 13 cost time: 0.6474299430847168
Epoch: 13, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.269 Vali Acc: 0.092 Test Loss: 3.269 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6876399517059326
Epoch: 14, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.264 Vali Acc: 0.104 Test Loss: 3.264 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 15 cost time: 0.8153035640716553
Epoch: 15, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.262 Vali Acc: 0.102 Test Loss: 3.262 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7109365463256836
Epoch: 16, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.265 Vali Acc: 0.106 Test Loss: 3.265 Test Acc: 0.106
Validation loss decreased (-0.103497 --> -0.105850).  Saving model ...
Epoch: 17 cost time: 0.7097721099853516
Epoch: 17, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.265 Vali Acc: 0.113 Test Loss: 3.265 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 18 cost time: 0.695509672164917
Epoch: 18, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.279 Vali Acc: 0.113 Test Loss: 3.279 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8167152404785156
Epoch: 19, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.272 Vali Acc: 0.115 Test Loss: 3.272 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115261).  Saving model ...
Epoch: 20 cost time: 0.7089624404907227
Epoch: 20, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.286 Vali Acc: 0.125 Test Loss: 3.286 Test Acc: 0.125
Validation loss decreased (-0.115261 --> -0.124673).  Saving model ...
Epoch: 21 cost time: 0.8452901840209961
Epoch: 21, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.291 Vali Acc: 0.124 Test Loss: 3.291 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7226266860961914
Epoch: 22, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.299 Vali Acc: 0.114 Test Loss: 3.299 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8652992248535156
Epoch: 23, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.291 Vali Acc: 0.122 Test Loss: 3.291 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7614853382110596
Epoch: 24, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.315 Vali Acc: 0.128 Test Loss: 3.315 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128202).  Saving model ...
Epoch: 25 cost time: 0.8670721054077148
Epoch: 25, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.336 Vali Acc: 0.129 Test Loss: 3.336 Test Acc: 0.129
Validation loss decreased (-0.128202 --> -0.129378).  Saving model ...
Epoch: 26 cost time: 0.7101151943206787
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.332 Vali Acc: 0.131 Test Loss: 3.332 Test Acc: 0.131
Validation loss decreased (-0.129378 --> -0.130555).  Saving model ...
Epoch: 27 cost time: 0.8820266723632812
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.338 Vali Acc: 0.132 Test Loss: 3.338 Test Acc: 0.132
Validation loss decreased (-0.130555 --> -0.131731).  Saving model ...
Epoch: 28 cost time: 0.708031177520752
Epoch: 28, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.349 Vali Acc: 0.134 Test Loss: 3.349 Test Acc: 0.134
Validation loss decreased (-0.131731 --> -0.134084).  Saving model ...
Epoch: 29 cost time: 0.8288662433624268
Epoch: 29, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.355 Vali Acc: 0.133 Test Loss: 3.355 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6776487827301025
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.364 Vali Acc: 0.133 Test Loss: 3.364 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7808210849761963
Epoch: 31, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.370 Vali Acc: 0.134 Test Loss: 3.370 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8302183151245117
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.374 Vali Acc: 0.133 Test Loss: 3.374 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6381897926330566
Epoch: 33, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.379 Vali Acc: 0.132 Test Loss: 3.379 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7790772914886475
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.381 Vali Acc: 0.133 Test Loss: 3.381 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8089861869812012
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.388 Vali Acc: 0.136 Test Loss: 3.388 Test Acc: 0.136
Validation loss decreased (-0.134084 --> -0.136437).  Saving model ...
Epoch: 36 cost time: 0.9294564723968506
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.396 Vali Acc: 0.136 Test Loss: 3.396 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6804754734039307
Epoch: 37, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.398 Vali Acc: 0.135 Test Loss: 3.398 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8950040340423584
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.401 Vali Acc: 0.134 Test Loss: 3.401 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7465641498565674
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.406 Vali Acc: 0.135 Test Loss: 3.406 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7244603633880615
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.409 Vali Acc: 0.131 Test Loss: 3.409 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6745119094848633
Epoch: 41, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.414 Vali Acc: 0.132 Test Loss: 3.414 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6953833103179932
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.419 Vali Acc: 0.134 Test Loss: 3.419 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6580080986022949
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.424 Vali Acc: 0.136 Test Loss: 3.424 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6177017688751221
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.430 Vali Acc: 0.132 Test Loss: 3.430 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7607483863830566
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.434 Vali Acc: 0.129 Test Loss: 3.434 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13647058823529412
model parameter : 168364
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.567519426345825
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.295 Vali Acc: 0.041 Test Loss: 3.295 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.7237343788146973
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.288 Vali Acc: 0.036 Test Loss: 3.288 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4359405040740967
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.280 Vali Acc: 0.045 Test Loss: 3.280 Test Acc: 0.045
Validation loss decreased (-0.041144 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 2.1303436756134033
Epoch: 4, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.273 Vali Acc: 0.056 Test Loss: 3.273 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.3571970462799072
Epoch: 5, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.269 Vali Acc: 0.059 Test Loss: 3.269 Test Acc: 0.059
Validation loss decreased (-0.056438 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 1.6839923858642578
Epoch: 6, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.267 Vali Acc: 0.058 Test Loss: 3.267 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.60184907913208
Epoch: 7, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.268 Vali Acc: 0.065 Test Loss: 3.268 Test Acc: 0.065
Validation loss decreased (-0.058791 --> -0.064673).  Saving model ...
Epoch: 8 cost time: 1.8125157356262207
Epoch: 8, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.266 Vali Acc: 0.066 Test Loss: 3.266 Test Acc: 0.066
Validation loss decreased (-0.064673 --> -0.065850).  Saving model ...
Epoch: 9 cost time: 1.9342141151428223
Epoch: 9, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.265 Vali Acc: 0.066 Test Loss: 3.265 Test Acc: 0.066
Validation loss decreased (-0.065850 --> -0.065850).  Saving model ...
Epoch: 10 cost time: 1.4250221252441406
Epoch: 10, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.262 Vali Acc: 0.073 Test Loss: 3.262 Test Acc: 0.073
Validation loss decreased (-0.065850 --> -0.072909).  Saving model ...
Epoch: 11 cost time: 1.558609962463379
Epoch: 11, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.257 Vali Acc: 0.075 Test Loss: 3.257 Test Acc: 0.075
Validation loss decreased (-0.072909 --> -0.075262).  Saving model ...
Epoch: 12 cost time: 1.8525164127349854
Epoch: 12, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.252 Vali Acc: 0.076 Test Loss: 3.252 Test Acc: 0.076
Validation loss decreased (-0.075262 --> -0.076438).  Saving model ...
Epoch: 13 cost time: 1.9802436828613281
Epoch: 13, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.249 Vali Acc: 0.088 Test Loss: 3.249 Test Acc: 0.088
Validation loss decreased (-0.076438 --> -0.088203).  Saving model ...
Epoch: 14 cost time: 1.780426263809204
Epoch: 14, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.243 Vali Acc: 0.091 Test Loss: 3.243 Test Acc: 0.091
Validation loss decreased (-0.088203 --> -0.090556).  Saving model ...
Epoch: 15 cost time: 1.7832963466644287
Epoch: 15, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.241 Vali Acc: 0.089 Test Loss: 3.241 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6615471839904785
Epoch: 16, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.236 Vali Acc: 0.089 Test Loss: 3.236 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7206931114196777
Epoch: 17, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.232 Vali Acc: 0.099 Test Loss: 3.232 Test Acc: 0.099
Validation loss decreased (-0.090556 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 1.9405980110168457
Epoch: 18, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.224 Vali Acc: 0.105 Test Loss: 3.224 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104674).  Saving model ...
Epoch: 19 cost time: 1.849543809890747
Epoch: 19, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.216 Vali Acc: 0.106 Test Loss: 3.216 Test Acc: 0.106
Validation loss decreased (-0.104674 --> -0.105850).  Saving model ...
Epoch: 20 cost time: 2.0731189250946045
Epoch: 20, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.208 Vali Acc: 0.107 Test Loss: 3.208 Test Acc: 0.107
Validation loss decreased (-0.105850 --> -0.107027).  Saving model ...
Epoch: 21 cost time: 1.6940038204193115
Epoch: 21, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.198 Vali Acc: 0.112 Test Loss: 3.198 Test Acc: 0.112
Validation loss decreased (-0.107027 --> -0.111733).  Saving model ...
Epoch: 22 cost time: 1.6629843711853027
Epoch: 22, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.201 Vali Acc: 0.120 Test Loss: 3.201 Test Acc: 0.120
Validation loss decreased (-0.111733 --> -0.119968).  Saving model ...
Epoch: 23 cost time: 1.5217607021331787
Epoch: 23, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.202 Vali Acc: 0.132 Test Loss: 3.202 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131733).  Saving model ...
Epoch: 24 cost time: 1.62851881980896
Epoch: 24, Steps: 10 | Train Loss: 1.607 Vali Loss: 3.204 Vali Acc: 0.131 Test Loss: 3.204 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7792019844055176
Epoch: 25, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.208 Vali Acc: 0.129 Test Loss: 3.208 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8838934898376465
Epoch: 26, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.212 Vali Acc: 0.132 Test Loss: 3.212 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7704718112945557
Epoch: 27, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.220 Vali Acc: 0.133 Test Loss: 3.220 Test Acc: 0.133
Validation loss decreased (-0.131733 --> -0.132909).  Saving model ...
Epoch: 28 cost time: 1.6356463432312012
Epoch: 28, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.216 Vali Acc: 0.141 Test Loss: 3.216 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 29 cost time: 2.1223056316375732
Epoch: 29, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.214 Vali Acc: 0.136 Test Loss: 3.214 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1733932495117188
Epoch: 30, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.233 Vali Acc: 0.146 Test Loss: 3.233 Test Acc: 0.146
Validation loss decreased (-0.141144 --> -0.145850).  Saving model ...
Epoch: 31 cost time: 1.6283800601959229
Epoch: 31, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.240 Vali Acc: 0.152 Test Loss: 3.240 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 32 cost time: 2.0190930366516113
Epoch: 32, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.250 Vali Acc: 0.156 Test Loss: 3.250 Test Acc: 0.156
Validation loss decreased (-0.151732 --> -0.156438).  Saving model ...
Epoch: 33 cost time: 2.150242328643799
Epoch: 33, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.267 Vali Acc: 0.153 Test Loss: 3.267 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5045621395111084
Epoch: 34, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.281 Vali Acc: 0.155 Test Loss: 3.281 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0650413036346436
Epoch: 35, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.295 Vali Acc: 0.145 Test Loss: 3.295 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.686504602432251
Epoch: 36, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.309 Vali Acc: 0.147 Test Loss: 3.309 Test Acc: 0.147
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9406709671020508
Epoch: 37, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.323 Vali Acc: 0.149 Test Loss: 3.323 Test Acc: 0.149
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7111268043518066
Epoch: 38, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.339 Vali Acc: 0.152 Test Loss: 3.339 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6500442028045654
Epoch: 39, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.353 Vali Acc: 0.151 Test Loss: 3.353 Test Acc: 0.151
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7237756252288818
Epoch: 40, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.372 Vali Acc: 0.151 Test Loss: 3.372 Test Acc: 0.151
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.66782808303833
Epoch: 41, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.387 Vali Acc: 0.151 Test Loss: 3.387 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5746045112609863
Epoch: 42, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.404 Vali Acc: 0.153 Test Loss: 3.404 Test Acc: 0.153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1564705882352941
model parameter : 94926
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7102770805358887
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.341 Vali Acc: 0.041 Test Loss: 3.341 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.3857436180114746
Epoch: 2, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.329 Vali Acc: 0.046 Test Loss: 3.329 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.4214177131652832
Epoch: 3, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.317 Vali Acc: 0.049 Test Loss: 3.317 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.4196898937225342
Epoch: 4, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.304 Vali Acc: 0.054 Test Loss: 3.304 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 1.444603681564331
Epoch: 5, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.290 Vali Acc: 0.058 Test Loss: 3.290 Test Acc: 0.058
Validation loss decreased (-0.054085 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 1.252558708190918
Epoch: 6, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.278 Vali Acc: 0.062 Test Loss: 3.278 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 1.431675910949707
Epoch: 7, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.270 Vali Acc: 0.067 Test Loss: 3.270 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.3266010284423828
Epoch: 8, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.261 Vali Acc: 0.072 Test Loss: 3.261 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 1.341362714767456
Epoch: 9, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.256 Vali Acc: 0.079 Test Loss: 3.256 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 1.3486697673797607
Epoch: 10, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.248 Vali Acc: 0.095 Test Loss: 3.248 Test Acc: 0.095
Validation loss decreased (-0.078791 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 1.5932800769805908
Epoch: 11, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.245 Vali Acc: 0.104 Test Loss: 3.245 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 1.2333195209503174
Epoch: 12, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.242 Vali Acc: 0.107 Test Loss: 3.242 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 1.1589162349700928
Epoch: 13, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.238 Vali Acc: 0.113 Test Loss: 3.238 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 1.2964468002319336
Epoch: 14, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.232 Vali Acc: 0.125 Test Loss: 3.232 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 1.315427303314209
Epoch: 15, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.226 Vali Acc: 0.133 Test Loss: 3.226 Test Acc: 0.133
Validation loss decreased (-0.124674 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 1.3548154830932617
Epoch: 16, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.221 Vali Acc: 0.131 Test Loss: 3.221 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3544559478759766
Epoch: 17, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.211 Vali Acc: 0.131 Test Loss: 3.211 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2554426193237305
Epoch: 18, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.206 Vali Acc: 0.134 Test Loss: 3.206 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134086).  Saving model ...
Epoch: 19 cost time: 1.6516330242156982
Epoch: 19, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.200 Vali Acc: 0.140 Test Loss: 3.200 Test Acc: 0.140
Validation loss decreased (-0.134086 --> -0.139968).  Saving model ...
Epoch: 20 cost time: 1.501432180404663
Epoch: 20, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.196 Vali Acc: 0.139 Test Loss: 3.196 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.557659387588501
Epoch: 21, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.195 Vali Acc: 0.141 Test Loss: 3.195 Test Acc: 0.141
Validation loss decreased (-0.139968 --> -0.141145).  Saving model ...
Epoch: 22 cost time: 1.2756173610687256
Epoch: 22, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.192 Vali Acc: 0.149 Test Loss: 3.192 Test Acc: 0.149
Validation loss decreased (-0.141145 --> -0.149380).  Saving model ...
Epoch: 23 cost time: 1.5236823558807373
Epoch: 23, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.187 Vali Acc: 0.156 Test Loss: 3.187 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156439).  Saving model ...
Epoch: 24 cost time: 1.470163345336914
Epoch: 24, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.189 Vali Acc: 0.153 Test Loss: 3.189 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.684295892715454
Epoch: 25, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.189 Vali Acc: 0.153 Test Loss: 3.189 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3276469707489014
Epoch: 26, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.190 Vali Acc: 0.155 Test Loss: 3.190 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5283839702606201
Epoch: 27, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.193 Vali Acc: 0.156 Test Loss: 3.193 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.499389886856079
Epoch: 28, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.199 Vali Acc: 0.155 Test Loss: 3.199 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7124948501586914
Epoch: 29, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.206 Vali Acc: 0.154 Test Loss: 3.206 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6246800422668457
Epoch: 30, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.206 Vali Acc: 0.153 Test Loss: 3.206 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3281776905059814
Epoch: 31, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.212 Vali Acc: 0.156 Test Loss: 3.212 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.773944616317749
Epoch: 32, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.215 Vali Acc: 0.166 Test Loss: 3.215 Test Acc: 0.166
Validation loss decreased (-0.156439 --> -0.165850).  Saving model ...
Epoch: 33 cost time: 1.6005985736846924
Epoch: 33, Steps: 10 | Train Loss: 0.752 Vali Loss: 3.218 Vali Acc: 0.164 Test Loss: 3.218 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5262629985809326
Epoch: 34, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.228 Vali Acc: 0.160 Test Loss: 3.228 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1938884258270264
Epoch: 35, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.244 Vali Acc: 0.164 Test Loss: 3.244 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4597680568695068
Epoch: 36, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.245 Vali Acc: 0.173 Test Loss: 3.245 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172909).  Saving model ...
Epoch: 37 cost time: 1.3023436069488525
Epoch: 37, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.259 Vali Acc: 0.164 Test Loss: 3.259 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.568819522857666
Epoch: 38, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.260 Vali Acc: 0.171 Test Loss: 3.260 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2682640552520752
Epoch: 39, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.271 Vali Acc: 0.172 Test Loss: 3.271 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.530341625213623
Epoch: 40, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.274 Vali Acc: 0.168 Test Loss: 3.274 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3828628063201904
Epoch: 41, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.293 Vali Acc: 0.168 Test Loss: 3.293 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.534738302230835
Epoch: 42, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.305 Vali Acc: 0.173 Test Loss: 3.305 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2270841598510742
Epoch: 43, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.315 Vali Acc: 0.175 Test Loss: 3.315 Test Acc: 0.175
Validation loss decreased (-0.172909 --> -0.175261).  Saving model ...
Epoch: 44 cost time: 1.3344347476959229
Epoch: 44, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.330 Vali Acc: 0.178 Test Loss: 3.330 Test Acc: 0.178
Validation loss decreased (-0.175261 --> -0.177614).  Saving model ...
Epoch: 45 cost time: 1.568408727645874
Epoch: 45, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.342 Vali Acc: 0.180 Test Loss: 3.342 Test Acc: 0.180
Validation loss decreased (-0.177614 --> -0.179967).  Saving model ...
Epoch: 46 cost time: 1.1356158256530762
Epoch: 46, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.344 Vali Acc: 0.182 Test Loss: 3.344 Test Acc: 0.182
Validation loss decreased (-0.179967 --> -0.182319).  Saving model ...
Epoch: 47 cost time: 1.3278956413269043
Epoch: 47, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.356 Vali Acc: 0.181 Test Loss: 3.356 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5792527198791504
Epoch: 48, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.373 Vali Acc: 0.185 Test Loss: 3.373 Test Acc: 0.185
Validation loss decreased (-0.182319 --> -0.184672).  Saving model ...
Epoch: 49 cost time: 1.51762056350708
Epoch: 49, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.387 Vali Acc: 0.179 Test Loss: 3.387 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3841633796691895
Epoch: 50, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.392 Vali Acc: 0.175 Test Loss: 3.392 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4776525497436523
Epoch: 51, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.407 Vali Acc: 0.176 Test Loss: 3.407 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3687822818756104
Epoch: 52, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.413 Vali Acc: 0.176 Test Loss: 3.413 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5610835552215576
Epoch: 53, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.424 Vali Acc: 0.179 Test Loss: 3.424 Test Acc: 0.179
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.286984920501709
Epoch: 54, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.433 Vali Acc: 0.175 Test Loss: 3.433 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.519019603729248
Epoch: 55, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.441 Vali Acc: 0.185 Test Loss: 3.441 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.3923652172088623
Epoch: 56, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.449 Vali Acc: 0.179 Test Loss: 3.449 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.3662323951721191
Epoch: 57, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.459 Vali Acc: 0.178 Test Loss: 3.459 Test Acc: 0.178
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.2447607517242432
Epoch: 58, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.466 Vali Acc: 0.182 Test Loss: 3.466 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 94158
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.757528781890869
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.308 Vali Acc: 0.047 Test Loss: 3.308 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.4587199687957764
Epoch: 2, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.298 Vali Acc: 0.041 Test Loss: 3.298 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.017575740814209
Epoch: 3, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.286 Vali Acc: 0.048 Test Loss: 3.286 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 1.3702197074890137
Epoch: 4, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.273 Vali Acc: 0.051 Test Loss: 3.273 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 1.494187593460083
Epoch: 5, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.261 Vali Acc: 0.054 Test Loss: 3.261 Test Acc: 0.054
Validation loss decreased (-0.050556 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 1.6647565364837646
Epoch: 6, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.254 Vali Acc: 0.060 Test Loss: 3.254 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.3757107257843018
Epoch: 7, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.247 Vali Acc: 0.067 Test Loss: 3.247 Test Acc: 0.067
Validation loss decreased (-0.059967 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.3355822563171387
Epoch: 8, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.239 Vali Acc: 0.078 Test Loss: 3.239 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077615).  Saving model ...
Epoch: 9 cost time: 1.4775505065917969
Epoch: 9, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.233 Vali Acc: 0.079 Test Loss: 3.233 Test Acc: 0.079
Validation loss decreased (-0.077615 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 1.2247655391693115
Epoch: 10, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.228 Vali Acc: 0.078 Test Loss: 3.228 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.135530948638916
Epoch: 11, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.223 Vali Acc: 0.081 Test Loss: 3.223 Test Acc: 0.081
Validation loss decreased (-0.078791 --> -0.081144).  Saving model ...
Epoch: 12 cost time: 1.1589288711547852
Epoch: 12, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.218 Vali Acc: 0.087 Test Loss: 3.218 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087027).  Saving model ...
Epoch: 13 cost time: 1.3922398090362549
Epoch: 13, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.210 Vali Acc: 0.096 Test Loss: 3.210 Test Acc: 0.096
Validation loss decreased (-0.087027 --> -0.096438).  Saving model ...
Epoch: 14 cost time: 1.4074172973632812
Epoch: 14, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.206 Vali Acc: 0.101 Test Loss: 3.206 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 15 cost time: 1.3248019218444824
Epoch: 15, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.201 Vali Acc: 0.098 Test Loss: 3.201 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3544723987579346
Epoch: 16, Steps: 10 | Train Loss: 2.190 Vali Loss: 3.192 Vali Acc: 0.105 Test Loss: 3.192 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104674).  Saving model ...
Epoch: 17 cost time: 1.4034876823425293
Epoch: 17, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.184 Vali Acc: 0.111 Test Loss: 3.184 Test Acc: 0.111
Validation loss decreased (-0.104674 --> -0.110556).  Saving model ...
Epoch: 18 cost time: 1.3749802112579346
Epoch: 18, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.180 Vali Acc: 0.120 Test Loss: 3.180 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119968).  Saving model ...
Epoch: 19 cost time: 1.6241209506988525
Epoch: 19, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.173 Vali Acc: 0.126 Test Loss: 3.173 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125851).  Saving model ...
Epoch: 20 cost time: 1.3645892143249512
Epoch: 20, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.168 Vali Acc: 0.128 Test Loss: 3.168 Test Acc: 0.128
Validation loss decreased (-0.125851 --> -0.128204).  Saving model ...
Epoch: 21 cost time: 1.6488802433013916
Epoch: 21, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.164 Vali Acc: 0.132 Test Loss: 3.164 Test Acc: 0.132
Validation loss decreased (-0.128204 --> -0.131733).  Saving model ...
Epoch: 22 cost time: 1.2998371124267578
Epoch: 22, Steps: 10 | Train Loss: 1.572 Vali Loss: 3.164 Vali Acc: 0.134 Test Loss: 3.164 Test Acc: 0.134
Validation loss decreased (-0.131733 --> -0.134086).  Saving model ...
Epoch: 23 cost time: 1.1332974433898926
Epoch: 23, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.160 Vali Acc: 0.138 Test Loss: 3.160 Test Acc: 0.138
Validation loss decreased (-0.134086 --> -0.137615).  Saving model ...
Epoch: 24 cost time: 1.2671360969543457
Epoch: 24, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.163 Vali Acc: 0.126 Test Loss: 3.163 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5556728839874268
Epoch: 25, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.158 Vali Acc: 0.136 Test Loss: 3.158 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2893664836883545
Epoch: 26, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.161 Vali Acc: 0.147 Test Loss: 3.161 Test Acc: 0.147
Validation loss decreased (-0.137615 --> -0.147027).  Saving model ...
Epoch: 27 cost time: 1.5290977954864502
Epoch: 27, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.162 Vali Acc: 0.148 Test Loss: 3.162 Test Acc: 0.148
Validation loss decreased (-0.147027 --> -0.148204).  Saving model ...
Epoch: 28 cost time: 1.3949902057647705
Epoch: 28, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.166 Vali Acc: 0.153 Test Loss: 3.166 Test Acc: 0.153
Validation loss decreased (-0.148204 --> -0.152910).  Saving model ...
Epoch: 29 cost time: 1.2591581344604492
Epoch: 29, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.173 Vali Acc: 0.145 Test Loss: 3.173 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2994489669799805
Epoch: 30, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.170 Vali Acc: 0.149 Test Loss: 3.170 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5147254467010498
Epoch: 31, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.185 Vali Acc: 0.149 Test Loss: 3.185 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4039793014526367
Epoch: 32, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.198 Vali Acc: 0.155 Test Loss: 3.198 Test Acc: 0.155
Validation loss decreased (-0.152910 --> -0.155262).  Saving model ...
Epoch: 33 cost time: 1.4098114967346191
Epoch: 33, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.202 Vali Acc: 0.146 Test Loss: 3.202 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7081711292266846
Epoch: 34, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.211 Vali Acc: 0.151 Test Loss: 3.211 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5816688537597656
Epoch: 35, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.218 Vali Acc: 0.159 Test Loss: 3.218 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158791).  Saving model ...
Epoch: 36 cost time: 1.9907314777374268
Epoch: 36, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.230 Vali Acc: 0.162 Test Loss: 3.230 Test Acc: 0.162
Validation loss decreased (-0.158791 --> -0.162321).  Saving model ...
Epoch: 37 cost time: 1.6643950939178467
Epoch: 37, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.242 Vali Acc: 0.156 Test Loss: 3.242 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.622734785079956
Epoch: 38, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.246 Vali Acc: 0.161 Test Loss: 3.246 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6318364143371582
Epoch: 39, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.261 Vali Acc: 0.164 Test Loss: 3.261 Test Acc: 0.164
Validation loss decreased (-0.162321 --> -0.163497).  Saving model ...
Epoch: 40 cost time: 1.2132983207702637
Epoch: 40, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.270 Vali Acc: 0.154 Test Loss: 3.270 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6323442459106445
Epoch: 41, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.279 Vali Acc: 0.162 Test Loss: 3.279 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3640058040618896
Epoch: 42, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.286 Vali Acc: 0.164 Test Loss: 3.286 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4659144878387451
Epoch: 43, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.296 Vali Acc: 0.169 Test Loss: 3.296 Test Acc: 0.169
Validation loss decreased (-0.163497 --> -0.169379).  Saving model ...
Epoch: 44 cost time: 1.4820332527160645
Epoch: 44, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.305 Vali Acc: 0.172 Test Loss: 3.305 Test Acc: 0.172
Validation loss decreased (-0.169379 --> -0.171732).  Saving model ...
Epoch: 45 cost time: 1.3744196891784668
Epoch: 45, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.320 Vali Acc: 0.172 Test Loss: 3.320 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3178000450134277
Epoch: 46, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.330 Vali Acc: 0.172 Test Loss: 3.330 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4774885177612305
Epoch: 47, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.343 Vali Acc: 0.169 Test Loss: 3.343 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2809598445892334
Epoch: 48, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.349 Vali Acc: 0.169 Test Loss: 3.349 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3063628673553467
Epoch: 49, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.358 Vali Acc: 0.174 Test Loss: 3.358 Test Acc: 0.174
Validation loss decreased (-0.171732 --> -0.174084).  Saving model ...
Epoch: 50 cost time: 1.531266212463379
Epoch: 50, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.363 Vali Acc: 0.168 Test Loss: 3.363 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.549532175064087
Epoch: 51, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.371 Vali Acc: 0.167 Test Loss: 3.371 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2293274402618408
Epoch: 52, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.379 Vali Acc: 0.167 Test Loss: 3.379 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.4702520370483398
Epoch: 53, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.385 Vali Acc: 0.169 Test Loss: 3.385 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.4750661849975586
Epoch: 54, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.395 Vali Acc: 0.168 Test Loss: 3.395 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.3575963973999023
Epoch: 55, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.402 Vali Acc: 0.168 Test Loss: 3.402 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.6073918342590332
Epoch: 56, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.410 Vali Acc: 0.171 Test Loss: 3.410 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.1411523818969727
Epoch: 57, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.416 Vali Acc: 0.169 Test Loss: 3.416 Test Acc: 0.169
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.4865548610687256
Epoch: 58, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.424 Vali Acc: 0.172 Test Loss: 3.424 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.347196340560913
Epoch: 59, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.426 Vali Acc: 0.169 Test Loss: 3.426 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17411764705882352
model parameter : 93134
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7232840061187744
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.312 Vali Acc: 0.045 Test Loss: 3.312 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.2449421882629395
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.302 Vali Acc: 0.047 Test Loss: 3.302 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.1715898513793945
Epoch: 3, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.291 Vali Acc: 0.044 Test Loss: 3.291 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2691128253936768
Epoch: 4, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.279 Vali Acc: 0.047 Test Loss: 3.279 Test Acc: 0.047
Validation loss decreased (-0.047026 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 1.2253413200378418
Epoch: 5, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.267 Vali Acc: 0.048 Test Loss: 3.267 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048203).  Saving model ...
Epoch: 6 cost time: 1.5315711498260498
Epoch: 6, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.258 Vali Acc: 0.052 Test Loss: 3.258 Test Acc: 0.052
Validation loss decreased (-0.048203 --> -0.051732).  Saving model ...
Epoch: 7 cost time: 1.0302624702453613
Epoch: 7, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.248 Vali Acc: 0.059 Test Loss: 3.248 Test Acc: 0.059
Validation loss decreased (-0.051732 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 1.0742440223693848
Epoch: 8, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.238 Vali Acc: 0.067 Test Loss: 3.238 Test Acc: 0.067
Validation loss decreased (-0.058791 --> -0.067026).  Saving model ...
Epoch: 9 cost time: 1.342287540435791
Epoch: 9, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.229 Vali Acc: 0.075 Test Loss: 3.229 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075262).  Saving model ...
Epoch: 10 cost time: 1.1305925846099854
Epoch: 10, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.225 Vali Acc: 0.080 Test Loss: 3.225 Test Acc: 0.080
Validation loss decreased (-0.075262 --> -0.079968).  Saving model ...
Epoch: 11 cost time: 1.1328730583190918
Epoch: 11, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.220 Vali Acc: 0.081 Test Loss: 3.220 Test Acc: 0.081
Validation loss decreased (-0.079968 --> -0.081144).  Saving model ...
Epoch: 12 cost time: 1.00994873046875
Epoch: 12, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.216 Vali Acc: 0.080 Test Loss: 3.216 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4637236595153809
Epoch: 13, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.211 Vali Acc: 0.086 Test Loss: 3.211 Test Acc: 0.086
Validation loss decreased (-0.081144 --> -0.085850).  Saving model ...
Epoch: 14 cost time: 1.3300020694732666
Epoch: 14, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.207 Vali Acc: 0.092 Test Loss: 3.207 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091733).  Saving model ...
Epoch: 15 cost time: 1.179351806640625
Epoch: 15, Steps: 10 | Train Loss: 2.058 Vali Loss: 3.204 Vali Acc: 0.102 Test Loss: 3.204 Test Acc: 0.102
Validation loss decreased (-0.091733 --> -0.102321).  Saving model ...
Epoch: 16 cost time: 1.2069380283355713
Epoch: 16, Steps: 10 | Train Loss: 1.964 Vali Loss: 3.206 Vali Acc: 0.115 Test Loss: 3.206 Test Acc: 0.115
Validation loss decreased (-0.102321 --> -0.115262).  Saving model ...
Epoch: 17 cost time: 1.103121280670166
Epoch: 17, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.199 Vali Acc: 0.118 Test Loss: 3.199 Test Acc: 0.118
Validation loss decreased (-0.115262 --> -0.117615).  Saving model ...
Epoch: 18 cost time: 1.1363224983215332
Epoch: 18, Steps: 10 | Train Loss: 1.787 Vali Loss: 3.198 Vali Acc: 0.115 Test Loss: 3.198 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1112093925476074
Epoch: 19, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.196 Vali Acc: 0.119 Test Loss: 3.196 Test Acc: 0.119
Validation loss decreased (-0.117615 --> -0.118792).  Saving model ...
Epoch: 20 cost time: 0.953230619430542
Epoch: 20, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.195 Vali Acc: 0.119 Test Loss: 3.195 Test Acc: 0.119
Validation loss decreased (-0.118792 --> -0.118792).  Saving model ...
Epoch: 21 cost time: 1.2577247619628906
Epoch: 21, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.189 Vali Acc: 0.134 Test Loss: 3.189 Test Acc: 0.134
Validation loss decreased (-0.118792 --> -0.134086).  Saving model ...
Epoch: 22 cost time: 1.4315121173858643
Epoch: 22, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.189 Vali Acc: 0.135 Test Loss: 3.189 Test Acc: 0.135
Validation loss decreased (-0.134086 --> -0.135262).  Saving model ...
Epoch: 23 cost time: 1.4883043766021729
Epoch: 23, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.189 Vali Acc: 0.144 Test Loss: 3.189 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143498).  Saving model ...
Epoch: 24 cost time: 1.206664800643921
Epoch: 24, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.189 Vali Acc: 0.151 Test Loss: 3.189 Test Acc: 0.151
Validation loss decreased (-0.143498 --> -0.150556).  Saving model ...
Epoch: 25 cost time: 1.4099557399749756
Epoch: 25, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.191 Vali Acc: 0.156 Test Loss: 3.191 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156439).  Saving model ...
Epoch: 26 cost time: 1.1029317378997803
Epoch: 26, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.188 Vali Acc: 0.159 Test Loss: 3.188 Test Acc: 0.159
Validation loss decreased (-0.156439 --> -0.158792).  Saving model ...
Epoch: 27 cost time: 1.3584911823272705
Epoch: 27, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.185 Vali Acc: 0.168 Test Loss: 3.185 Test Acc: 0.168
Validation loss decreased (-0.158792 --> -0.168203).  Saving model ...
Epoch: 28 cost time: 1.2819035053253174
Epoch: 28, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.189 Vali Acc: 0.172 Test Loss: 3.189 Test Acc: 0.172
Validation loss decreased (-0.168203 --> -0.171733).  Saving model ...
Epoch: 29 cost time: 1.293893814086914
Epoch: 29, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.191 Vali Acc: 0.164 Test Loss: 3.191 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1463522911071777
Epoch: 30, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.200 Vali Acc: 0.167 Test Loss: 3.200 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9251654148101807
Epoch: 31, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.208 Vali Acc: 0.167 Test Loss: 3.208 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.109095573425293
Epoch: 32, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.214 Vali Acc: 0.175 Test Loss: 3.214 Test Acc: 0.175
Validation loss decreased (-0.171733 --> -0.175262).  Saving model ...
Epoch: 33 cost time: 1.3184597492218018
Epoch: 33, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.225 Vali Acc: 0.174 Test Loss: 3.225 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0747363567352295
Epoch: 34, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.228 Vali Acc: 0.173 Test Loss: 3.228 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.451368808746338
Epoch: 35, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.233 Vali Acc: 0.172 Test Loss: 3.233 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.109518051147461
Epoch: 36, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.242 Vali Acc: 0.173 Test Loss: 3.242 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0793490409851074
Epoch: 37, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.254 Vali Acc: 0.169 Test Loss: 3.254 Test Acc: 0.169
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1927316188812256
Epoch: 38, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.263 Vali Acc: 0.173 Test Loss: 3.263 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0751304626464844
Epoch: 39, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.271 Vali Acc: 0.176 Test Loss: 3.271 Test Acc: 0.176
Validation loss decreased (-0.175262 --> -0.176438).  Saving model ...
Epoch: 40 cost time: 1.1903555393218994
Epoch: 40, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.282 Vali Acc: 0.179 Test Loss: 3.282 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 41 cost time: 1.2943751811981201
Epoch: 41, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.291 Vali Acc: 0.182 Test Loss: 3.291 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 42 cost time: 1.4726002216339111
Epoch: 42, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.293 Vali Acc: 0.179 Test Loss: 3.293 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.425844430923462
Epoch: 43, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.302 Vali Acc: 0.181 Test Loss: 3.302 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.570758581161499
Epoch: 44, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.315 Vali Acc: 0.178 Test Loss: 3.315 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5252649784088135
Epoch: 45, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.323 Vali Acc: 0.176 Test Loss: 3.323 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.271070957183838
Epoch: 46, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.323 Vali Acc: 0.175 Test Loss: 3.323 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4143595695495605
Epoch: 47, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.325 Vali Acc: 0.180 Test Loss: 3.325 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.4894022941589355
Epoch: 48, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.335 Vali Acc: 0.179 Test Loss: 3.335 Test Acc: 0.179
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.7117018699645996
Epoch: 49, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.345 Vali Acc: 0.176 Test Loss: 3.345 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4242355823516846
Epoch: 50, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.349 Vali Acc: 0.176 Test Loss: 3.349 Test Acc: 0.176
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4244792461395264
Epoch: 51, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.354 Vali Acc: 0.181 Test Loss: 3.354 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18235294117647058
model parameter : 92110
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4821853637695312
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.307 Vali Acc: 0.038 Test Loss: 3.307 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8558683395385742
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.300 Vali Acc: 0.040 Test Loss: 3.300 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.8684349060058594
Epoch: 3, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.292 Vali Acc: 0.039 Test Loss: 3.292 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9152388572692871
Epoch: 4, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.285 Vali Acc: 0.038 Test Loss: 3.285 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8655552864074707
Epoch: 5, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.281 Vali Acc: 0.045 Test Loss: 3.281 Test Acc: 0.045
Validation loss decreased (-0.039967 --> -0.044673).  Saving model ...
Epoch: 6 cost time: 0.8950958251953125
Epoch: 6, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.278 Vali Acc: 0.054 Test Loss: 3.278 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 7 cost time: 0.9588878154754639
Epoch: 7, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.278 Vali Acc: 0.060 Test Loss: 3.278 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 0.9684486389160156
Epoch: 8, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.279 Vali Acc: 0.071 Test Loss: 3.279 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 1.1542320251464844
Epoch: 9, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.278 Vali Acc: 0.080 Test Loss: 3.278 Test Acc: 0.080
Validation loss decreased (-0.070555 --> -0.079967).  Saving model ...
Epoch: 10 cost time: 0.9636940956115723
Epoch: 10, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.277 Vali Acc: 0.082 Test Loss: 3.277 Test Acc: 0.082
Validation loss decreased (-0.079967 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 0.8205087184906006
Epoch: 11, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.277 Vali Acc: 0.093 Test Loss: 3.277 Test Acc: 0.093
Validation loss decreased (-0.082320 --> -0.092908).  Saving model ...
Epoch: 12 cost time: 1.034118890762329
Epoch: 12, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.276 Vali Acc: 0.086 Test Loss: 3.276 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0550057888031006
Epoch: 13, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.276 Vali Acc: 0.089 Test Loss: 3.276 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0721309185028076
Epoch: 14, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.271 Vali Acc: 0.095 Test Loss: 3.271 Test Acc: 0.095
Validation loss decreased (-0.092908 --> -0.095261).  Saving model ...
Epoch: 15 cost time: 0.9794411659240723
Epoch: 15, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.268 Vali Acc: 0.091 Test Loss: 3.268 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.963712215423584
Epoch: 16, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.264 Vali Acc: 0.102 Test Loss: 3.264 Test Acc: 0.102
Validation loss decreased (-0.095261 --> -0.102320).  Saving model ...
Epoch: 17 cost time: 1.0151584148406982
Epoch: 17, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.260 Vali Acc: 0.106 Test Loss: 3.260 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 18 cost time: 1.022989273071289
Epoch: 18, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.257 Vali Acc: 0.104 Test Loss: 3.257 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1435737609863281
Epoch: 19, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.253 Vali Acc: 0.108 Test Loss: 3.253 Test Acc: 0.108
Validation loss decreased (-0.105850 --> -0.108203).  Saving model ...
Epoch: 20 cost time: 1.003678798675537
Epoch: 20, Steps: 10 | Train Loss: 1.805 Vali Loss: 3.249 Vali Acc: 0.116 Test Loss: 3.249 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 21 cost time: 0.9137542247772217
Epoch: 21, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.246 Vali Acc: 0.115 Test Loss: 3.246 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9514787197113037
Epoch: 22, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.249 Vali Acc: 0.120 Test Loss: 3.249 Test Acc: 0.120
Validation loss decreased (-0.116438 --> -0.119968).  Saving model ...
Epoch: 23 cost time: 0.8605577945709229
Epoch: 23, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.252 Vali Acc: 0.122 Test Loss: 3.252 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122320).  Saving model ...
Epoch: 24 cost time: 0.9351608753204346
Epoch: 24, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.253 Vali Acc: 0.122 Test Loss: 3.253 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9719288349151611
Epoch: 25, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.258 Vali Acc: 0.128 Test Loss: 3.258 Test Acc: 0.128
Validation loss decreased (-0.122320 --> -0.128203).  Saving model ...
Epoch: 26 cost time: 0.9124031066894531
Epoch: 26, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.251 Vali Acc: 0.132 Test Loss: 3.251 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131732).  Saving model ...
Epoch: 27 cost time: 1.010202169418335
Epoch: 27, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.256 Vali Acc: 0.134 Test Loss: 3.256 Test Acc: 0.134
Validation loss decreased (-0.131732 --> -0.134085).  Saving model ...
Epoch: 28 cost time: 1.0129806995391846
Epoch: 28, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.263 Vali Acc: 0.138 Test Loss: 3.263 Test Acc: 0.138
Validation loss decreased (-0.134085 --> -0.137614).  Saving model ...
Epoch: 29 cost time: 0.9805684089660645
Epoch: 29, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.269 Vali Acc: 0.136 Test Loss: 3.269 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0925421714782715
Epoch: 30, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.278 Vali Acc: 0.136 Test Loss: 3.278 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0977671146392822
Epoch: 31, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.295 Vali Acc: 0.141 Test Loss: 3.295 Test Acc: 0.141
Validation loss decreased (-0.137614 --> -0.141144).  Saving model ...
Epoch: 32 cost time: 0.9864675998687744
Epoch: 32, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.303 Vali Acc: 0.149 Test Loss: 3.303 Test Acc: 0.149
Validation loss decreased (-0.141144 --> -0.149379).  Saving model ...
Epoch: 33 cost time: 0.9639647006988525
Epoch: 33, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.320 Vali Acc: 0.147 Test Loss: 3.320 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0242657661437988
Epoch: 34, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.328 Vali Acc: 0.138 Test Loss: 3.328 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1819283962249756
Epoch: 35, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.344 Vali Acc: 0.141 Test Loss: 3.344 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.368152141571045
Epoch: 36, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.362 Vali Acc: 0.139 Test Loss: 3.362 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.378418207168579
Epoch: 37, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.375 Vali Acc: 0.141 Test Loss: 3.375 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2430419921875
Epoch: 38, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.386 Vali Acc: 0.141 Test Loss: 3.386 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2480058670043945
Epoch: 39, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.403 Vali Acc: 0.136 Test Loss: 3.403 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2138867378234863
Epoch: 40, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.400 Vali Acc: 0.145 Test Loss: 3.400 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1338179111480713
Epoch: 41, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.410 Vali Acc: 0.147 Test Loss: 3.410 Test Acc: 0.147
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3655002117156982
Epoch: 42, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.420 Vali Acc: 0.141 Test Loss: 3.420 Test Acc: 0.141
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 91342
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3162975311279297
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.320 Vali Acc: 0.027 Test Loss: 3.320 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 0.9144556522369385
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.312 Vali Acc: 0.029 Test Loss: 3.312 Test Acc: 0.029
Validation loss decreased (-0.027026 --> -0.029379).  Saving model ...
Epoch: 3 cost time: 0.9650537967681885
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.303 Vali Acc: 0.038 Test Loss: 3.303 Test Acc: 0.038
Validation loss decreased (-0.029379 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.8951928615570068
Epoch: 4, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.294 Vali Acc: 0.042 Test Loss: 3.294 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 0.8947198390960693
Epoch: 5, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.287 Vali Acc: 0.049 Test Loss: 3.287 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.9879360198974609
Epoch: 6, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.280 Vali Acc: 0.055 Test Loss: 3.280 Test Acc: 0.055
Validation loss decreased (-0.049379 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 1.028038740158081
Epoch: 7, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.275 Vali Acc: 0.062 Test Loss: 3.275 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 8 cost time: 0.8818268775939941
Epoch: 8, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.270 Vali Acc: 0.065 Test Loss: 3.270 Test Acc: 0.065
Validation loss decreased (-0.062320 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 0.8864781856536865
Epoch: 9, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.267 Vali Acc: 0.073 Test Loss: 3.267 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072909).  Saving model ...
Epoch: 10 cost time: 0.9490242004394531
Epoch: 10, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.264 Vali Acc: 0.076 Test Loss: 3.264 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 11 cost time: 0.8110470771789551
Epoch: 11, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.262 Vali Acc: 0.079 Test Loss: 3.262 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 12 cost time: 0.8962421417236328
Epoch: 12, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.260 Vali Acc: 0.084 Test Loss: 3.260 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 13 cost time: 0.9843549728393555
Epoch: 13, Steps: 10 | Train Loss: 2.524 Vali Loss: 3.257 Vali Acc: 0.091 Test Loss: 3.257 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 14 cost time: 0.9151082038879395
Epoch: 14, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.251 Vali Acc: 0.094 Test Loss: 3.251 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 15 cost time: 0.9048581123352051
Epoch: 15, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.246 Vali Acc: 0.101 Test Loss: 3.246 Test Acc: 0.101
Validation loss decreased (-0.094085 --> -0.101144).  Saving model ...
Epoch: 16 cost time: 0.915635347366333
Epoch: 16, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.238 Vali Acc: 0.109 Test Loss: 3.238 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109379).  Saving model ...
Epoch: 17 cost time: 0.8578524589538574
Epoch: 17, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.109379 --> -0.110556).  Saving model ...
Epoch: 18 cost time: 1.0362040996551514
Epoch: 18, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.226 Vali Acc: 0.122 Test Loss: 3.226 Test Acc: 0.122
Validation loss decreased (-0.110556 --> -0.122321).  Saving model ...
Epoch: 19 cost time: 0.9374208450317383
Epoch: 19, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.222 Vali Acc: 0.131 Test Loss: 3.222 Test Acc: 0.131
Validation loss decreased (-0.122321 --> -0.130556).  Saving model ...
Epoch: 20 cost time: 0.9169423580169678
Epoch: 20, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.216 Vali Acc: 0.128 Test Loss: 3.216 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9144022464752197
Epoch: 21, Steps: 10 | Train Loss: 1.671 Vali Loss: 3.214 Vali Acc: 0.140 Test Loss: 3.214 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 22 cost time: 0.9568901062011719
Epoch: 22, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.209 Vali Acc: 0.142 Test Loss: 3.209 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 23 cost time: 0.930152416229248
Epoch: 23, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.207 Vali Acc: 0.145 Test Loss: 3.207 Test Acc: 0.145
Validation loss decreased (-0.142321 --> -0.144674).  Saving model ...
Epoch: 24 cost time: 1.049020528793335
Epoch: 24, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.206 Vali Acc: 0.146 Test Loss: 3.206 Test Acc: 0.146
Validation loss decreased (-0.144674 --> -0.145850).  Saving model ...
Epoch: 25 cost time: 0.9244546890258789
Epoch: 25, Steps: 10 | Train Loss: 1.155 Vali Loss: 3.212 Vali Acc: 0.146 Test Loss: 3.212 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9558360576629639
Epoch: 26, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.217 Vali Acc: 0.149 Test Loss: 3.217 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149380).  Saving model ...
Epoch: 27 cost time: 0.9560422897338867
Epoch: 27, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.205 Vali Acc: 0.156 Test Loss: 3.205 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156439).  Saving model ...
Epoch: 28 cost time: 0.9729559421539307
Epoch: 28, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.215 Vali Acc: 0.151 Test Loss: 3.215 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.895653247833252
Epoch: 29, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.216 Vali Acc: 0.156 Test Loss: 3.216 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0057916641235352
Epoch: 30, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.224 Vali Acc: 0.160 Test Loss: 3.224 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 31 cost time: 0.8169233798980713
Epoch: 31, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.231 Vali Acc: 0.165 Test Loss: 3.231 Test Acc: 0.165
Validation loss decreased (-0.159968 --> -0.164674).  Saving model ...
Epoch: 32 cost time: 0.9649229049682617
Epoch: 32, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.237 Vali Acc: 0.162 Test Loss: 3.237 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8228118419647217
Epoch: 33, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.248 Vali Acc: 0.164 Test Loss: 3.248 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8364870548248291
Epoch: 34, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.265 Vali Acc: 0.160 Test Loss: 3.265 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8241212368011475
Epoch: 35, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.266 Vali Acc: 0.164 Test Loss: 3.266 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1348998546600342
Epoch: 36, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.276 Vali Acc: 0.164 Test Loss: 3.276 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0464279651641846
Epoch: 37, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.283 Vali Acc: 0.176 Test Loss: 3.283 Test Acc: 0.176
Validation loss decreased (-0.164674 --> -0.176438).  Saving model ...
Epoch: 38 cost time: 0.945345401763916
Epoch: 38, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.291 Vali Acc: 0.184 Test Loss: 3.291 Test Acc: 0.184
Validation loss decreased (-0.176438 --> -0.183496).  Saving model ...
Epoch: 39 cost time: 0.8413302898406982
Epoch: 39, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.306 Vali Acc: 0.179 Test Loss: 3.306 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8498024940490723
Epoch: 40, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.319 Vali Acc: 0.174 Test Loss: 3.319 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0199196338653564
Epoch: 41, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.321 Vali Acc: 0.171 Test Loss: 3.321 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8002660274505615
Epoch: 42, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.334 Vali Acc: 0.171 Test Loss: 3.334 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0755994319915771
Epoch: 43, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.349 Vali Acc: 0.171 Test Loss: 3.349 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8831057548522949
Epoch: 44, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.354 Vali Acc: 0.174 Test Loss: 3.354 Test Acc: 0.174
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9214808940887451
Epoch: 45, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.361 Vali Acc: 0.173 Test Loss: 3.361 Test Acc: 0.173
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8510220050811768
Epoch: 46, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.362 Vali Acc: 0.175 Test Loss: 3.362 Test Acc: 0.175
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9359090328216553
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.372 Vali Acc: 0.174 Test Loss: 3.372 Test Acc: 0.174
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0316472053527832
Epoch: 48, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.378 Vali Acc: 0.174 Test Loss: 3.378 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18352941176470589
model parameter : 91086
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.526094436645508
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.286 Vali Acc: 0.044 Test Loss: 3.286 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.9510364532470703
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.278 Vali Acc: 0.046 Test Loss: 3.278 Test Acc: 0.046
Validation loss decreased (-0.043497 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 1.0067615509033203
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.270 Vali Acc: 0.044 Test Loss: 3.270 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9336807727813721
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.261 Vali Acc: 0.045 Test Loss: 3.261 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8151099681854248
Epoch: 5, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.253 Vali Acc: 0.049 Test Loss: 3.253 Test Acc: 0.049
Validation loss decreased (-0.045850 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.7877538204193115
Epoch: 6, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.247 Vali Acc: 0.049 Test Loss: 3.247 Test Acc: 0.049
Validation loss decreased (-0.049379 --> -0.049379).  Saving model ...
Epoch: 7 cost time: 0.8772459030151367
Epoch: 7, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.240 Vali Acc: 0.054 Test Loss: 3.240 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054085).  Saving model ...
Epoch: 8 cost time: 0.9628579616546631
Epoch: 8, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.234 Vali Acc: 0.060 Test Loss: 3.234 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059968).  Saving model ...
Epoch: 9 cost time: 0.9973082542419434
Epoch: 9, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.227 Vali Acc: 0.069 Test Loss: 3.227 Test Acc: 0.069
Validation loss decreased (-0.059968 --> -0.069379).  Saving model ...
Epoch: 10 cost time: 0.8143153190612793
Epoch: 10, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.220 Vali Acc: 0.073 Test Loss: 3.220 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072909).  Saving model ...
Epoch: 11 cost time: 0.8611774444580078
Epoch: 11, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.212 Vali Acc: 0.076 Test Loss: 3.212 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 12 cost time: 1.032271385192871
Epoch: 12, Steps: 10 | Train Loss: 2.428 Vali Loss: 3.204 Vali Acc: 0.079 Test Loss: 3.204 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 13 cost time: 1.139434576034546
Epoch: 13, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.198 Vali Acc: 0.089 Test Loss: 3.198 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089380).  Saving model ...
Epoch: 14 cost time: 1.146162509918213
Epoch: 14, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.190 Vali Acc: 0.095 Test Loss: 3.190 Test Acc: 0.095
Validation loss decreased (-0.089380 --> -0.095262).  Saving model ...
Epoch: 15 cost time: 1.0937657356262207
Epoch: 15, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.179 Vali Acc: 0.106 Test Loss: 3.179 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105851).  Saving model ...
Epoch: 16 cost time: 1.0557689666748047
Epoch: 16, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.171 Vali Acc: 0.118 Test Loss: 3.171 Test Acc: 0.118
Validation loss decreased (-0.105851 --> -0.117615).  Saving model ...
Epoch: 17 cost time: 1.1929824352264404
Epoch: 17, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.162 Vali Acc: 0.120 Test Loss: 3.162 Test Acc: 0.120
Validation loss decreased (-0.117615 --> -0.119968).  Saving model ...
Epoch: 18 cost time: 1.4124436378479004
Epoch: 18, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.157 Vali Acc: 0.121 Test Loss: 3.157 Test Acc: 0.121
Validation loss decreased (-0.119968 --> -0.121145).  Saving model ...
Epoch: 19 cost time: 1.1003351211547852
Epoch: 19, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.150 Vali Acc: 0.127 Test Loss: 3.150 Test Acc: 0.127
Validation loss decreased (-0.121145 --> -0.127027).  Saving model ...
Epoch: 20 cost time: 1.2292280197143555
Epoch: 20, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.146 Vali Acc: 0.126 Test Loss: 3.146 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1403319835662842
Epoch: 21, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.139 Vali Acc: 0.133 Test Loss: 3.139 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132910).  Saving model ...
Epoch: 22 cost time: 1.169076681137085
Epoch: 22, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.130 Vali Acc: 0.139 Test Loss: 3.130 Test Acc: 0.139
Validation loss decreased (-0.132910 --> -0.138792).  Saving model ...
Epoch: 23 cost time: 0.9458372592926025
Epoch: 23, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.129 Vali Acc: 0.145 Test Loss: 3.129 Test Acc: 0.145
Validation loss decreased (-0.138792 --> -0.144675).  Saving model ...
Epoch: 24 cost time: 0.9596710205078125
Epoch: 24, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.127 Vali Acc: 0.148 Test Loss: 3.127 Test Acc: 0.148
Validation loss decreased (-0.144675 --> -0.148204).  Saving model ...
Epoch: 25 cost time: 1.1452734470367432
Epoch: 25, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.129 Vali Acc: 0.149 Test Loss: 3.129 Test Acc: 0.149
Validation loss decreased (-0.148204 --> -0.149380).  Saving model ...
Epoch: 26 cost time: 1.2166955471038818
Epoch: 26, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.130 Vali Acc: 0.154 Test Loss: 3.130 Test Acc: 0.154
Validation loss decreased (-0.149380 --> -0.154086).  Saving model ...
Epoch: 27 cost time: 1.137650966644287
Epoch: 27, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.125 Vali Acc: 0.153 Test Loss: 3.125 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0609617233276367
Epoch: 28, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.128 Vali Acc: 0.156 Test Loss: 3.128 Test Acc: 0.156
Validation loss decreased (-0.154086 --> -0.156439).  Saving model ...
Epoch: 29 cost time: 1.0412306785583496
Epoch: 29, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.126 Vali Acc: 0.156 Test Loss: 3.126 Test Acc: 0.156
Validation loss decreased (-0.156439 --> -0.156439).  Saving model ...
Epoch: 30 cost time: 1.144188404083252
Epoch: 30, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.133 Vali Acc: 0.160 Test Loss: 3.133 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159969).  Saving model ...
Epoch: 31 cost time: 1.1009111404418945
Epoch: 31, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.136 Vali Acc: 0.164 Test Loss: 3.136 Test Acc: 0.164
Validation loss decreased (-0.159969 --> -0.163498).  Saving model ...
Epoch: 32 cost time: 1.1027107238769531
Epoch: 32, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.145 Vali Acc: 0.164 Test Loss: 3.145 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.03938889503479
Epoch: 33, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.155 Vali Acc: 0.165 Test Loss: 3.155 Test Acc: 0.165
Validation loss decreased (-0.163498 --> -0.164674).  Saving model ...
Epoch: 34 cost time: 1.0470056533813477
Epoch: 34, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.161 Vali Acc: 0.173 Test Loss: 3.161 Test Acc: 0.173
Validation loss decreased (-0.164674 --> -0.172910).  Saving model ...
Epoch: 35 cost time: 0.9885396957397461
Epoch: 35, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.170 Vali Acc: 0.172 Test Loss: 3.170 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9747304916381836
Epoch: 36, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.175 Vali Acc: 0.179 Test Loss: 3.175 Test Acc: 0.179
Validation loss decreased (-0.172910 --> -0.178792).  Saving model ...
Epoch: 37 cost time: 1.1393280029296875
Epoch: 37, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.184 Vali Acc: 0.175 Test Loss: 3.184 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1666953563690186
Epoch: 38, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.188 Vali Acc: 0.173 Test Loss: 3.188 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2011244297027588
Epoch: 39, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.195 Vali Acc: 0.175 Test Loss: 3.195 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1414623260498047
Epoch: 40, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.202 Vali Acc: 0.179 Test Loss: 3.202 Test Acc: 0.179
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0638713836669922
Epoch: 41, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.216 Vali Acc: 0.176 Test Loss: 3.216 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9053103923797607
Epoch: 42, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.219 Vali Acc: 0.175 Test Loss: 3.219 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.944110631942749
Epoch: 43, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.223 Vali Acc: 0.178 Test Loss: 3.223 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.114839792251587
Epoch: 44, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.229 Vali Acc: 0.180 Test Loss: 3.229 Test Acc: 0.180
Validation loss decreased (-0.178792 --> -0.179968).  Saving model ...
Epoch: 45 cost time: 1.212569236755371
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.236 Vali Acc: 0.181 Test Loss: 3.236 Test Acc: 0.181
Validation loss decreased (-0.179968 --> -0.181144).  Saving model ...
Epoch: 46 cost time: 1.3436691761016846
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.240 Vali Acc: 0.182 Test Loss: 3.240 Test Acc: 0.182
Validation loss decreased (-0.181144 --> -0.182321).  Saving model ...
Epoch: 47 cost time: 1.1700286865234375
Epoch: 47, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.249 Vali Acc: 0.185 Test Loss: 3.249 Test Acc: 0.185
Validation loss decreased (-0.182321 --> -0.184673).  Saving model ...
Epoch: 48 cost time: 1.1866106986999512
Epoch: 48, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.256 Vali Acc: 0.182 Test Loss: 3.256 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.351487398147583
Epoch: 49, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.264 Vali Acc: 0.182 Test Loss: 3.264 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1470227241516113
Epoch: 50, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.269 Vali Acc: 0.186 Test Loss: 3.269 Test Acc: 0.186
Validation loss decreased (-0.184673 --> -0.185850).  Saving model ...
Epoch: 51 cost time: 1.1628940105438232
Epoch: 51, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.275 Vali Acc: 0.185 Test Loss: 3.275 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.245441198348999
Epoch: 52, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.278 Vali Acc: 0.186 Test Loss: 3.278 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1687641143798828
Epoch: 53, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.282 Vali Acc: 0.187 Test Loss: 3.282 Test Acc: 0.187
Validation loss decreased (-0.185850 --> -0.187026).  Saving model ...
Epoch: 54 cost time: 1.190030813217163
Epoch: 54, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.288 Vali Acc: 0.188 Test Loss: 3.288 Test Acc: 0.188
Validation loss decreased (-0.187026 --> -0.188202).  Saving model ...
Epoch: 55 cost time: 1.1863172054290771
Epoch: 55, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.290 Vali Acc: 0.182 Test Loss: 3.290 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2270679473876953
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.295 Vali Acc: 0.184 Test Loss: 3.295 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1314704418182373
Epoch: 57, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.299 Vali Acc: 0.185 Test Loss: 3.299 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.180466890335083
Epoch: 58, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.305 Vali Acc: 0.184 Test Loss: 3.305 Test Acc: 0.184
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.144179344177246
Epoch: 59, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.309 Vali Acc: 0.188 Test Loss: 3.309 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9192802906036377
Epoch: 60, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.314 Vali Acc: 0.187 Test Loss: 3.314 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.187424659729004
Epoch: 61, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.318 Vali Acc: 0.186 Test Loss: 3.318 Test Acc: 0.186
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0587568283081055
Epoch: 62, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.323 Vali Acc: 0.185 Test Loss: 3.323 Test Acc: 0.185
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0957083702087402
Epoch: 63, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.327 Vali Acc: 0.186 Test Loss: 3.327 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.1665127277374268
Epoch: 64, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.334 Vali Acc: 0.187 Test Loss: 3.334 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18823529411764706
model parameter : 90574
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7853267192840576
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.320 Vali Acc: 0.044 Test Loss: 3.320 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.065169334411621
Epoch: 2, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.310 Vali Acc: 0.045 Test Loss: 3.310 Test Acc: 0.045
Validation loss decreased (-0.043496 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.8046715259552002
Epoch: 3, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.298 Vali Acc: 0.048 Test Loss: 3.298 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.7347269058227539
Epoch: 4, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.288 Vali Acc: 0.040 Test Loss: 3.288 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7897725105285645
Epoch: 5, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.279 Vali Acc: 0.036 Test Loss: 3.279 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.679635763168335
Epoch: 6, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.274 Vali Acc: 0.046 Test Loss: 3.274 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.778618335723877
Epoch: 7, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.270 Vali Acc: 0.055 Test Loss: 3.270 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 8 cost time: 0.8469600677490234
Epoch: 8, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.266 Vali Acc: 0.064 Test Loss: 3.266 Test Acc: 0.064
Validation loss decreased (-0.055261 --> -0.063497).  Saving model ...
Epoch: 9 cost time: 0.7940385341644287
Epoch: 9, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.261 Vali Acc: 0.084 Test Loss: 3.261 Test Acc: 0.084
Validation loss decreased (-0.063497 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.6823148727416992
Epoch: 10, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.260 Vali Acc: 0.091 Test Loss: 3.260 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 11 cost time: 0.8338077068328857
Epoch: 11, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.256 Vali Acc: 0.087 Test Loss: 3.256 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6380453109741211
Epoch: 12, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.253 Vali Acc: 0.101 Test Loss: 3.253 Test Acc: 0.101
Validation loss decreased (-0.090556 --> -0.101144).  Saving model ...
Epoch: 13 cost time: 0.8468766212463379
Epoch: 13, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.247 Vali Acc: 0.107 Test Loss: 3.247 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107026).  Saving model ...
Epoch: 14 cost time: 0.8103711605072021
Epoch: 14, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.240 Vali Acc: 0.112 Test Loss: 3.240 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 15 cost time: 0.8645973205566406
Epoch: 15, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.240 Vali Acc: 0.113 Test Loss: 3.240 Test Acc: 0.113
Validation loss decreased (-0.111732 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.6628139019012451
Epoch: 16, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.236 Vali Acc: 0.120 Test Loss: 3.236 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 17 cost time: 0.8626041412353516
Epoch: 17, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.232 Vali Acc: 0.125 Test Loss: 3.232 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124674).  Saving model ...
Epoch: 18 cost time: 0.6317710876464844
Epoch: 18, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.231 Vali Acc: 0.126 Test Loss: 3.231 Test Acc: 0.126
Validation loss decreased (-0.124674 --> -0.125850).  Saving model ...
Epoch: 19 cost time: 0.6526145935058594
Epoch: 19, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.228 Vali Acc: 0.132 Test Loss: 3.228 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131732).  Saving model ...
Epoch: 20 cost time: 0.7854001522064209
Epoch: 20, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.237 Vali Acc: 0.129 Test Loss: 3.237 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7518272399902344
Epoch: 21, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.232 Vali Acc: 0.138 Test Loss: 3.232 Test Acc: 0.138
Validation loss decreased (-0.131732 --> -0.137615).  Saving model ...
Epoch: 22 cost time: 0.6342587471008301
Epoch: 22, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.233 Vali Acc: 0.136 Test Loss: 3.233 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6978507041931152
Epoch: 23, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.235 Vali Acc: 0.145 Test Loss: 3.235 Test Acc: 0.145
Validation loss decreased (-0.137615 --> -0.144674).  Saving model ...
Epoch: 24 cost time: 0.7717983722686768
Epoch: 24, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.245 Vali Acc: 0.153 Test Loss: 3.245 Test Acc: 0.153
Validation loss decreased (-0.144674 --> -0.152909).  Saving model ...
Epoch: 25 cost time: 0.7652778625488281
Epoch: 25, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.254 Vali Acc: 0.148 Test Loss: 3.254 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7646059989929199
Epoch: 26, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.256 Vali Acc: 0.151 Test Loss: 3.256 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8235616683959961
Epoch: 27, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.268 Vali Acc: 0.151 Test Loss: 3.268 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5957896709442139
Epoch: 28, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.279 Vali Acc: 0.152 Test Loss: 3.279 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6873030662536621
Epoch: 29, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.295 Vali Acc: 0.147 Test Loss: 3.295 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7793979644775391
Epoch: 30, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.300 Vali Acc: 0.149 Test Loss: 3.300 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7344894409179688
Epoch: 31, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.315 Vali Acc: 0.145 Test Loss: 3.315 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6847774982452393
Epoch: 32, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.334 Vali Acc: 0.139 Test Loss: 3.334 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8227343559265137
Epoch: 33, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.342 Vali Acc: 0.140 Test Loss: 3.342 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0393767356872559
Epoch: 34, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.360 Vali Acc: 0.141 Test Loss: 3.360 Test Acc: 0.141
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15294117647058825
model parameter : 90318
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.801931381225586
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.318 Vali Acc: 0.022 Test Loss: 3.318 Test Acc: 0.022
Validation loss decreased (inf --> -0.022320).  Saving model ...
Epoch: 2 cost time: 1.2065613269805908
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.313 Vali Acc: 0.029 Test Loss: 3.313 Test Acc: 0.029
Validation loss decreased (-0.022320 --> -0.029379).  Saving model ...
Epoch: 3 cost time: 1.3499653339385986
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.302 Vali Acc: 0.029 Test Loss: 3.302 Test Acc: 0.029
Validation loss decreased (-0.029379 --> -0.029379).  Saving model ...
Epoch: 4 cost time: 1.26206374168396
Epoch: 4, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.294 Vali Acc: 0.034 Test Loss: 3.294 Test Acc: 0.034
Validation loss decreased (-0.029379 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 1.1477134227752686
Epoch: 5, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.289 Vali Acc: 0.042 Test Loss: 3.289 Test Acc: 0.042
Validation loss decreased (-0.034085 --> -0.042320).  Saving model ...
Epoch: 6 cost time: 1.3983232975006104
Epoch: 6, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.287 Vali Acc: 0.052 Test Loss: 3.287 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 7 cost time: 1.2115824222564697
Epoch: 7, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.284 Vali Acc: 0.054 Test Loss: 3.284 Test Acc: 0.054
Validation loss decreased (-0.051732 --> -0.054085).  Saving model ...
Epoch: 8 cost time: 1.2116954326629639
Epoch: 8, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.282 Vali Acc: 0.058 Test Loss: 3.282 Test Acc: 0.058
Validation loss decreased (-0.054085 --> -0.057614).  Saving model ...
Epoch: 9 cost time: 1.1793110370635986
Epoch: 9, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.279 Vali Acc: 0.064 Test Loss: 3.279 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 10 cost time: 1.399568796157837
Epoch: 10, Steps: 10 | Train Loss: 2.334 Vali Loss: 3.280 Vali Acc: 0.062 Test Loss: 3.280 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2603931427001953
Epoch: 11, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.279 Vali Acc: 0.069 Test Loss: 3.279 Test Acc: 0.069
Validation loss decreased (-0.063497 --> -0.069379).  Saving model ...
Epoch: 12 cost time: 1.313826560974121
Epoch: 12, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.273 Vali Acc: 0.067 Test Loss: 3.273 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2231214046478271
Epoch: 13, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.276 Vali Acc: 0.073 Test Loss: 3.276 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072908).  Saving model ...
Epoch: 14 cost time: 1.3171617984771729
Epoch: 14, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.276 Vali Acc: 0.075 Test Loss: 3.276 Test Acc: 0.075
Validation loss decreased (-0.072908 --> -0.075261).  Saving model ...
Epoch: 15 cost time: 1.3529059886932373
Epoch: 15, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.279 Vali Acc: 0.074 Test Loss: 3.279 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3188574314117432
Epoch: 16, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.279 Vali Acc: 0.075 Test Loss: 3.279 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3075506687164307
Epoch: 17, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.279 Vali Acc: 0.084 Test Loss: 3.279 Test Acc: 0.084
Validation loss decreased (-0.075261 --> -0.083497).  Saving model ...
Epoch: 18 cost time: 1.2701966762542725
Epoch: 18, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.278 Vali Acc: 0.079 Test Loss: 3.278 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2642714977264404
Epoch: 19, Steps: 10 | Train Loss: 1.403 Vali Loss: 3.282 Vali Acc: 0.089 Test Loss: 3.282 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089379).  Saving model ...
Epoch: 20 cost time: 1.3113937377929688
Epoch: 20, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.281 Vali Acc: 0.092 Test Loss: 3.281 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 21 cost time: 1.2573928833007812
Epoch: 21, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.285 Vali Acc: 0.094 Test Loss: 3.285 Test Acc: 0.094
Validation loss decreased (-0.091732 --> -0.094085).  Saving model ...
Epoch: 22 cost time: 1.265120267868042
Epoch: 22, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.286 Vali Acc: 0.091 Test Loss: 3.286 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.241459846496582
Epoch: 23, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.291 Vali Acc: 0.095 Test Loss: 3.291 Test Acc: 0.095
Validation loss decreased (-0.094085 --> -0.095261).  Saving model ...
Epoch: 24 cost time: 1.2725944519042969
Epoch: 24, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.305 Vali Acc: 0.096 Test Loss: 3.305 Test Acc: 0.096
Validation loss decreased (-0.095261 --> -0.096438).  Saving model ...
Epoch: 25 cost time: 1.2312779426574707
Epoch: 25, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.300 Vali Acc: 0.091 Test Loss: 3.300 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.052422285079956
Epoch: 26, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.301 Vali Acc: 0.106 Test Loss: 3.301 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105849).  Saving model ...
Epoch: 27 cost time: 1.1379978656768799
Epoch: 27, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.302 Vali Acc: 0.107 Test Loss: 3.302 Test Acc: 0.107
Validation loss decreased (-0.105849 --> -0.107026).  Saving model ...
Epoch: 28 cost time: 1.3011786937713623
Epoch: 28, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.315 Vali Acc: 0.111 Test Loss: 3.315 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110555).  Saving model ...
Epoch: 29 cost time: 1.1595282554626465
Epoch: 29, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.327 Vali Acc: 0.100 Test Loss: 3.327 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3342711925506592
Epoch: 30, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.342 Vali Acc: 0.098 Test Loss: 3.342 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2578778266906738
Epoch: 31, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.350 Vali Acc: 0.102 Test Loss: 3.350 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3409919738769531
Epoch: 32, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.349 Vali Acc: 0.104 Test Loss: 3.349 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3865876197814941
Epoch: 33, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.364 Vali Acc: 0.107 Test Loss: 3.364 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.459369421005249
Epoch: 34, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.390 Vali Acc: 0.107 Test Loss: 3.390 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.248469591140747
Epoch: 35, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.401 Vali Acc: 0.113 Test Loss: 3.401 Test Acc: 0.113
Validation loss decreased (-0.110555 --> -0.112907).  Saving model ...
Epoch: 36 cost time: 1.3973603248596191
Epoch: 36, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.402 Vali Acc: 0.112 Test Loss: 3.402 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3421099185943604
Epoch: 37, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.413 Vali Acc: 0.119 Test Loss: 3.413 Test Acc: 0.119
Validation loss decreased (-0.112907 --> -0.118789).  Saving model ...
Epoch: 38 cost time: 1.3512816429138184
Epoch: 38, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.438 Vali Acc: 0.118 Test Loss: 3.438 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3849902153015137
Epoch: 39, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.449 Vali Acc: 0.114 Test Loss: 3.449 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.177804708480835
Epoch: 40, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.451 Vali Acc: 0.118 Test Loss: 3.451 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.331742286682129
Epoch: 41, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.463 Vali Acc: 0.122 Test Loss: 3.463 Test Acc: 0.122
Validation loss decreased (-0.118789 --> -0.122318).  Saving model ...
Epoch: 42 cost time: 1.2483572959899902
Epoch: 42, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.482 Vali Acc: 0.121 Test Loss: 3.482 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.091388463973999
Epoch: 43, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.497 Vali Acc: 0.127 Test Loss: 3.497 Test Acc: 0.127
Validation loss decreased (-0.122318 --> -0.127024).  Saving model ...
Epoch: 44 cost time: 1.101353406906128
Epoch: 44, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.506 Vali Acc: 0.121 Test Loss: 3.506 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3423166275024414
Epoch: 45, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.518 Vali Acc: 0.119 Test Loss: 3.518 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2923943996429443
Epoch: 46, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.531 Vali Acc: 0.125 Test Loss: 3.531 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3958747386932373
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.539 Vali Acc: 0.124 Test Loss: 3.539 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2826213836669922
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.536 Vali Acc: 0.119 Test Loss: 3.536 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.257910966873169
Epoch: 49, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.544 Vali Acc: 0.126 Test Loss: 3.544 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.322347640991211
Epoch: 50, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.548 Vali Acc: 0.124 Test Loss: 3.548 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.5229744911193848
Epoch: 51, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.556 Vali Acc: 0.120 Test Loss: 3.556 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4909169673919678
Epoch: 52, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.562 Vali Acc: 0.124 Test Loss: 3.562 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.4027817249298096
Epoch: 53, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.566 Vali Acc: 0.120 Test Loss: 3.566 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12705882352941175
model parameter : 94892
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0558085441589355
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.320 Vali Acc: 0.035 Test Loss: 3.320 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.1692700386047363
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.314 Vali Acc: 0.034 Test Loss: 3.314 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4127306938171387
Epoch: 3, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.305 Vali Acc: 0.036 Test Loss: 3.305 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036438).  Saving model ...
Epoch: 4 cost time: 1.0771949291229248
Epoch: 4, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.294 Vali Acc: 0.048 Test Loss: 3.294 Test Acc: 0.048
Validation loss decreased (-0.036438 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.0868685245513916
Epoch: 5, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.283 Vali Acc: 0.059 Test Loss: 3.283 Test Acc: 0.059
Validation loss decreased (-0.048202 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 1.4358339309692383
Epoch: 6, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.274 Vali Acc: 0.059 Test Loss: 3.274 Test Acc: 0.059
Validation loss decreased (-0.058791 --> -0.058791).  Saving model ...
Epoch: 7 cost time: 1.2070651054382324
Epoch: 7, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.268 Vali Acc: 0.059 Test Loss: 3.268 Test Acc: 0.059
Validation loss decreased (-0.058791 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 1.2390592098236084
Epoch: 8, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.263 Vali Acc: 0.062 Test Loss: 3.263 Test Acc: 0.062
Validation loss decreased (-0.058791 --> -0.062320).  Saving model ...
Epoch: 9 cost time: 1.2051935195922852
Epoch: 9, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.260 Vali Acc: 0.066 Test Loss: 3.260 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065850).  Saving model ...
Epoch: 10 cost time: 1.3348243236541748
Epoch: 10, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.257 Vali Acc: 0.068 Test Loss: 3.257 Test Acc: 0.068
Validation loss decreased (-0.065850 --> -0.068203).  Saving model ...
Epoch: 11 cost time: 1.3464012145996094
Epoch: 11, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.258 Vali Acc: 0.078 Test Loss: 3.258 Test Acc: 0.078
Validation loss decreased (-0.068203 --> -0.077614).  Saving model ...
Epoch: 12 cost time: 1.0932402610778809
Epoch: 12, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.257 Vali Acc: 0.085 Test Loss: 3.257 Test Acc: 0.085
Validation loss decreased (-0.077614 --> -0.084673).  Saving model ...
Epoch: 13 cost time: 1.141571283340454
Epoch: 13, Steps: 10 | Train Loss: 2.013 Vali Loss: 3.255 Vali Acc: 0.091 Test Loss: 3.255 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 14 cost time: 1.1837847232818604
Epoch: 14, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.258 Vali Acc: 0.099 Test Loss: 3.258 Test Acc: 0.099
Validation loss decreased (-0.090556 --> -0.098791).  Saving model ...
Epoch: 15 cost time: 1.1467273235321045
Epoch: 15, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.259 Vali Acc: 0.099 Test Loss: 3.259 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2398016452789307
Epoch: 16, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.257 Vali Acc: 0.105 Test Loss: 3.257 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104673).  Saving model ...
Epoch: 17 cost time: 1.1742825508117676
Epoch: 17, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.258 Vali Acc: 0.096 Test Loss: 3.258 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.167008638381958
Epoch: 18, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.260 Vali Acc: 0.106 Test Loss: 3.260 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105850).  Saving model ...
Epoch: 19 cost time: 1.0375609397888184
Epoch: 19, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.263 Vali Acc: 0.106 Test Loss: 3.263 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1702134609222412
Epoch: 20, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.257 Vali Acc: 0.106 Test Loss: 3.257 Test Acc: 0.106
Validation loss decreased (-0.105850 --> -0.105850).  Saving model ...
Epoch: 21 cost time: 1.1485967636108398
Epoch: 21, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.267 Vali Acc: 0.102 Test Loss: 3.267 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0855979919433594
Epoch: 22, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.270 Vali Acc: 0.102 Test Loss: 3.270 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.128791093826294
Epoch: 23, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.282 Vali Acc: 0.106 Test Loss: 3.282 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1359977722167969
Epoch: 24, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.278 Vali Acc: 0.100 Test Loss: 3.278 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.179636001586914
Epoch: 25, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.278 Vali Acc: 0.100 Test Loss: 3.278 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1618382930755615
Epoch: 26, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.294 Vali Acc: 0.113 Test Loss: 3.294 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112908).  Saving model ...
Epoch: 27 cost time: 1.1501803398132324
Epoch: 27, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.306 Vali Acc: 0.105 Test Loss: 3.306 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2346482276916504
Epoch: 28, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.312 Vali Acc: 0.109 Test Loss: 3.312 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3027021884918213
Epoch: 29, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.307 Vali Acc: 0.112 Test Loss: 3.307 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.179966926574707
Epoch: 30, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.320 Vali Acc: 0.109 Test Loss: 3.320 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0168118476867676
Epoch: 31, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.326 Vali Acc: 0.111 Test Loss: 3.326 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1577739715576172
Epoch: 32, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.343 Vali Acc: 0.115 Test Loss: 3.343 Test Acc: 0.115
Validation loss decreased (-0.112908 --> -0.115261).  Saving model ...
Epoch: 33 cost time: 1.2574751377105713
Epoch: 33, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.354 Vali Acc: 0.108 Test Loss: 3.354 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.264418125152588
Epoch: 34, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.365 Vali Acc: 0.113 Test Loss: 3.365 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2782223224639893
Epoch: 35, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.371 Vali Acc: 0.108 Test Loss: 3.371 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2487945556640625
Epoch: 36, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.390 Vali Acc: 0.114 Test Loss: 3.390 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1210968494415283
Epoch: 37, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.403 Vali Acc: 0.116 Test Loss: 3.403 Test Acc: 0.116
Validation loss decreased (-0.115261 --> -0.116437).  Saving model ...
Epoch: 38 cost time: 1.4508075714111328
Epoch: 38, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.418 Vali Acc: 0.118 Test Loss: 3.418 Test Acc: 0.118
Validation loss decreased (-0.116437 --> -0.117613).  Saving model ...
Epoch: 39 cost time: 1.211059331893921
Epoch: 39, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.430 Vali Acc: 0.120 Test Loss: 3.430 Test Acc: 0.120
Validation loss decreased (-0.117613 --> -0.119966).  Saving model ...
Epoch: 40 cost time: 1.0670928955078125
Epoch: 40, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.428 Vali Acc: 0.121 Test Loss: 3.428 Test Acc: 0.121
Validation loss decreased (-0.119966 --> -0.121142).  Saving model ...
Epoch: 41 cost time: 1.2191970348358154
Epoch: 41, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.441 Vali Acc: 0.121 Test Loss: 3.441 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1216545104980469
Epoch: 42, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.466 Vali Acc: 0.119 Test Loss: 3.466 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1336703300476074
Epoch: 43, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.478 Vali Acc: 0.120 Test Loss: 3.478 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2635436058044434
Epoch: 44, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.483 Vali Acc: 0.119 Test Loss: 3.483 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2092971801757812
Epoch: 45, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.487 Vali Acc: 0.118 Test Loss: 3.487 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2553341388702393
Epoch: 46, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.497 Vali Acc: 0.121 Test Loss: 3.497 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2774536609649658
Epoch: 47, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.508 Vali Acc: 0.119 Test Loss: 3.508 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2647476196289062
Epoch: 48, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.515 Vali Acc: 0.120 Test Loss: 3.515 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2957696914672852
Epoch: 49, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.529 Vali Acc: 0.118 Test Loss: 3.529 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2282350063323975
Epoch: 50, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.542 Vali Acc: 0.124 Test Loss: 3.542 Test Acc: 0.124
Validation loss decreased (-0.121142 --> -0.123494).  Saving model ...
Epoch: 51 cost time: 1.3555922508239746
Epoch: 51, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.549 Vali Acc: 0.120 Test Loss: 3.549 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3712143898010254
Epoch: 52, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.559 Vali Acc: 0.129 Test Loss: 3.559 Test Acc: 0.129
Validation loss decreased (-0.123494 --> -0.129376).  Saving model ...
Epoch: 53 cost time: 1.2699370384216309
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.561 Vali Acc: 0.125 Test Loss: 3.561 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.478412389755249
Epoch: 54, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.568 Vali Acc: 0.127 Test Loss: 3.568 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3454747200012207
Epoch: 55, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.576 Vali Acc: 0.128 Test Loss: 3.576 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1805286407470703
Epoch: 56, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.584 Vali Acc: 0.132 Test Loss: 3.584 Test Acc: 0.132
Validation loss decreased (-0.129376 --> -0.131729).  Saving model ...
Epoch: 57 cost time: 1.224844217300415
Epoch: 57, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.593 Vali Acc: 0.132 Test Loss: 3.593 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2433712482452393
Epoch: 58, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.598 Vali Acc: 0.132 Test Loss: 3.598 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.231243371963501
Epoch: 59, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.602 Vali Acc: 0.129 Test Loss: 3.602 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.3437533378601074
Epoch: 60, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.604 Vali Acc: 0.131 Test Loss: 3.604 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.1102187633514404
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.608 Vali Acc: 0.132 Test Loss: 3.608 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.4963390827178955
Epoch: 62, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.616 Vali Acc: 0.135 Test Loss: 3.616 Test Acc: 0.135
Validation loss decreased (-0.131729 --> -0.135258).  Saving model ...
Epoch: 63 cost time: 1.3658580780029297
Epoch: 63, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.619 Vali Acc: 0.129 Test Loss: 3.619 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3433713912963867
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.623 Vali Acc: 0.128 Test Loss: 3.623 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2658085823059082
Epoch: 65, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.626 Vali Acc: 0.135 Test Loss: 3.626 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.5190403461456299
Epoch: 66, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.631 Vali Acc: 0.133 Test Loss: 3.631 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.5051088333129883
Epoch: 67, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.635 Vali Acc: 0.135 Test Loss: 3.635 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.3438060283660889
Epoch: 68, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.641 Vali Acc: 0.138 Test Loss: 3.641 Test Acc: 0.138
Validation loss decreased (-0.135258 --> -0.137611).  Saving model ...
Epoch: 69 cost time: 1.5546424388885498
Epoch: 69, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.644 Vali Acc: 0.133 Test Loss: 3.644 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.4955153465270996
Epoch: 70, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.651 Vali Acc: 0.131 Test Loss: 3.651 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.4289906024932861
Epoch: 71, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.658 Vali Acc: 0.129 Test Loss: 3.658 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.4878292083740234
Epoch: 72, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.661 Vali Acc: 0.128 Test Loss: 3.661 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.3116710186004639
Epoch: 73, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.665 Vali Acc: 0.131 Test Loss: 3.665 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.1741487979888916
Epoch: 74, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.670 Vali Acc: 0.133 Test Loss: 3.670 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.1861586570739746
Epoch: 75, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.674 Vali Acc: 0.129 Test Loss: 3.674 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.3525166511535645
Epoch: 76, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.678 Vali Acc: 0.129 Test Loss: 3.678 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.3769536018371582
Epoch: 77, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.683 Vali Acc: 0.131 Test Loss: 3.683 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.298161506652832
Epoch: 78, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.684 Vali Acc: 0.131 Test Loss: 3.684 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1376470588235294
model parameter : 94124
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.723097085952759
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.329 Vali Acc: 0.048 Test Loss: 3.329 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.9801437854766846
Epoch: 2, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.317 Vali Acc: 0.052 Test Loss: 3.317 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.0433025360107422
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.300 Vali Acc: 0.047 Test Loss: 3.300 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9868428707122803
Epoch: 4, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.286 Vali Acc: 0.045 Test Loss: 3.286 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0609862804412842
Epoch: 5, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.275 Vali Acc: 0.052 Test Loss: 3.275 Test Acc: 0.052
Validation loss decreased (-0.051732 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 1.037144660949707
Epoch: 6, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.264 Vali Acc: 0.056 Test Loss: 3.264 Test Acc: 0.056
Validation loss decreased (-0.051732 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 0.9833493232727051
Epoch: 7, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.256 Vali Acc: 0.065 Test Loss: 3.256 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 8 cost time: 0.9417188167572021
Epoch: 8, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.251 Vali Acc: 0.076 Test Loss: 3.251 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 1.0188026428222656
Epoch: 9, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.249 Vali Acc: 0.078 Test Loss: 3.249 Test Acc: 0.078
Validation loss decreased (-0.076438 --> -0.077615).  Saving model ...
Epoch: 10 cost time: 1.0275304317474365
Epoch: 10, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.249 Vali Acc: 0.084 Test Loss: 3.249 Test Acc: 0.084
Validation loss decreased (-0.077615 --> -0.083497).  Saving model ...
Epoch: 11 cost time: 1.0215320587158203
Epoch: 11, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.246 Vali Acc: 0.087 Test Loss: 3.246 Test Acc: 0.087
Validation loss decreased (-0.083497 --> -0.087026).  Saving model ...
Epoch: 12 cost time: 1.046570062637329
Epoch: 12, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.246 Vali Acc: 0.088 Test Loss: 3.246 Test Acc: 0.088
Validation loss decreased (-0.087026 --> -0.088203).  Saving model ...
Epoch: 13 cost time: 0.9771468639373779
Epoch: 13, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.243 Vali Acc: 0.099 Test Loss: 3.243 Test Acc: 0.099
Validation loss decreased (-0.088203 --> -0.098791).  Saving model ...
Epoch: 14 cost time: 0.9680631160736084
Epoch: 14, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.247 Vali Acc: 0.098 Test Loss: 3.247 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9678745269775391
Epoch: 15, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.246 Vali Acc: 0.100 Test Loss: 3.246 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099968).  Saving model ...
Epoch: 16 cost time: 1.1051392555236816
Epoch: 16, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.252 Vali Acc: 0.101 Test Loss: 3.252 Test Acc: 0.101
Validation loss decreased (-0.099968 --> -0.101144).  Saving model ...
Epoch: 17 cost time: 1.020873785018921
Epoch: 17, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.254 Vali Acc: 0.106 Test Loss: 3.254 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 18 cost time: 0.9819390773773193
Epoch: 18, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.251 Vali Acc: 0.111 Test Loss: 3.251 Test Acc: 0.111
Validation loss decreased (-0.105850 --> -0.110556).  Saving model ...
Epoch: 19 cost time: 1.1537768840789795
Epoch: 19, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.256 Vali Acc: 0.112 Test Loss: 3.256 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111732).  Saving model ...
Epoch: 20 cost time: 1.048091173171997
Epoch: 20, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.259 Vali Acc: 0.120 Test Loss: 3.259 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119967).  Saving model ...
Epoch: 21 cost time: 0.964073657989502
Epoch: 21, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.268 Vali Acc: 0.112 Test Loss: 3.268 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.048696517944336
Epoch: 22, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.265 Vali Acc: 0.124 Test Loss: 3.265 Test Acc: 0.124
Validation loss decreased (-0.119967 --> -0.123497).  Saving model ...
Epoch: 23 cost time: 0.9848651885986328
Epoch: 23, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.265 Vali Acc: 0.115 Test Loss: 3.265 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1008963584899902
Epoch: 24, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.267 Vali Acc: 0.119 Test Loss: 3.267 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9725925922393799
Epoch: 25, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.270 Vali Acc: 0.126 Test Loss: 3.270 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 26 cost time: 1.070915699005127
Epoch: 26, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.276 Vali Acc: 0.118 Test Loss: 3.276 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0887391567230225
Epoch: 27, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.270 Vali Acc: 0.133 Test Loss: 3.270 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132908).  Saving model ...
Epoch: 28 cost time: 0.9176740646362305
Epoch: 28, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.284 Vali Acc: 0.119 Test Loss: 3.284 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9300436973571777
Epoch: 29, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.287 Vali Acc: 0.125 Test Loss: 3.287 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9352247714996338
Epoch: 30, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.308 Vali Acc: 0.126 Test Loss: 3.308 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.173478364944458
Epoch: 31, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.318 Vali Acc: 0.128 Test Loss: 3.318 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.071415901184082
Epoch: 32, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.330 Vali Acc: 0.125 Test Loss: 3.330 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.003124713897705
Epoch: 33, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.335 Vali Acc: 0.129 Test Loss: 3.335 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0837833881378174
Epoch: 34, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.358 Vali Acc: 0.133 Test Loss: 3.358 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9826302528381348
Epoch: 35, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.368 Vali Acc: 0.124 Test Loss: 3.368 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0659170150756836
Epoch: 36, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.367 Vali Acc: 0.129 Test Loss: 3.367 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1364765167236328
Epoch: 37, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.384 Vali Acc: 0.128 Test Loss: 3.384 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13294117647058823
model parameter : 93100
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5265953540802
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.307 Vali Acc: 0.051 Test Loss: 3.307 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.9252841472625732
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.296 Vali Acc: 0.049 Test Loss: 3.296 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0422279834747314
Epoch: 3, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.284 Vali Acc: 0.046 Test Loss: 3.284 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.043135643005371
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.272 Vali Acc: 0.049 Test Loss: 3.272 Test Acc: 0.049
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.19240140914917
Epoch: 5, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.260 Vali Acc: 0.060 Test Loss: 3.260 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.8903312683105469
Epoch: 6, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.250 Vali Acc: 0.069 Test Loss: 3.250 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.0667471885681152
Epoch: 7, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.242 Vali Acc: 0.073 Test Loss: 3.242 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072909).  Saving model ...
Epoch: 8 cost time: 0.9358665943145752
Epoch: 8, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.237 Vali Acc: 0.076 Test Loss: 3.237 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 0.8161518573760986
Epoch: 9, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.232 Vali Acc: 0.079 Test Loss: 3.232 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.8404107093811035
Epoch: 10, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.228 Vali Acc: 0.084 Test Loss: 3.228 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 11 cost time: 0.8337852954864502
Epoch: 11, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.224 Vali Acc: 0.089 Test Loss: 3.224 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089380).  Saving model ...
Epoch: 12 cost time: 0.8479616641998291
Epoch: 12, Steps: 10 | Train Loss: 1.994 Vali Loss: 3.222 Vali Acc: 0.093 Test Loss: 3.222 Test Acc: 0.093
Validation loss decreased (-0.089380 --> -0.092909).  Saving model ...
Epoch: 13 cost time: 0.8422861099243164
Epoch: 13, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.219 Vali Acc: 0.093 Test Loss: 3.219 Test Acc: 0.093
Validation loss decreased (-0.092909 --> -0.092909).  Saving model ...
Epoch: 14 cost time: 0.939969539642334
Epoch: 14, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.219 Vali Acc: 0.102 Test Loss: 3.219 Test Acc: 0.102
Validation loss decreased (-0.092909 --> -0.102321).  Saving model ...
Epoch: 15 cost time: 0.8335347175598145
Epoch: 15, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.215 Vali Acc: 0.113 Test Loss: 3.215 Test Acc: 0.113
Validation loss decreased (-0.102321 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.8830611705780029
Epoch: 16, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.218 Vali Acc: 0.106 Test Loss: 3.218 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0173022747039795
Epoch: 17, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.218 Vali Acc: 0.105 Test Loss: 3.218 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8345835208892822
Epoch: 18, Steps: 10 | Train Loss: 1.322 Vali Loss: 3.223 Vali Acc: 0.109 Test Loss: 3.223 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3190639019012451
Epoch: 19, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.224 Vali Acc: 0.108 Test Loss: 3.224 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8999550342559814
Epoch: 20, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.219 Vali Acc: 0.115 Test Loss: 3.219 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115262).  Saving model ...
Epoch: 21 cost time: 0.9438259601593018
Epoch: 21, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.214 Vali Acc: 0.114 Test Loss: 3.214 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0279583930969238
Epoch: 22, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.214 Vali Acc: 0.122 Test Loss: 3.214 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 23 cost time: 0.9588656425476074
Epoch: 23, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.222 Vali Acc: 0.119 Test Loss: 3.222 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9301550388336182
Epoch: 24, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.228 Vali Acc: 0.120 Test Loss: 3.228 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9107038974761963
Epoch: 25, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.225 Vali Acc: 0.122 Test Loss: 3.225 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9153153896331787
Epoch: 26, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.229 Vali Acc: 0.124 Test Loss: 3.229 Test Acc: 0.124
Validation loss decreased (-0.122321 --> -0.123497).  Saving model ...
Epoch: 27 cost time: 1.026487112045288
Epoch: 27, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.231 Vali Acc: 0.125 Test Loss: 3.231 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124674).  Saving model ...
Epoch: 28 cost time: 0.990607500076294
Epoch: 28, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.245 Vali Acc: 0.132 Test Loss: 3.245 Test Acc: 0.132
Validation loss decreased (-0.124674 --> -0.131732).  Saving model ...
Epoch: 29 cost time: 0.9909160137176514
Epoch: 29, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.260 Vali Acc: 0.136 Test Loss: 3.260 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 30 cost time: 0.8888013362884521
Epoch: 30, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.268 Vali Acc: 0.132 Test Loss: 3.268 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9227898120880127
Epoch: 31, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.275 Vali Acc: 0.142 Test Loss: 3.275 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142320).  Saving model ...
Epoch: 32 cost time: 0.985196590423584
Epoch: 32, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.277 Vali Acc: 0.135 Test Loss: 3.277 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1035897731781006
Epoch: 33, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.283 Vali Acc: 0.139 Test Loss: 3.283 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9518933296203613
Epoch: 34, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.291 Vali Acc: 0.135 Test Loss: 3.291 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8907687664031982
Epoch: 35, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.306 Vali Acc: 0.140 Test Loss: 3.306 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8332030773162842
Epoch: 36, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.310 Vali Acc: 0.145 Test Loss: 3.310 Test Acc: 0.145
Validation loss decreased (-0.142320 --> -0.144673).  Saving model ...
Epoch: 37 cost time: 0.9952318668365479
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.319 Vali Acc: 0.141 Test Loss: 3.319 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9139800071716309
Epoch: 38, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.326 Vali Acc: 0.140 Test Loss: 3.326 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.014622688293457
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.325 Vali Acc: 0.140 Test Loss: 3.325 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0317771434783936
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.333 Vali Acc: 0.140 Test Loss: 3.333 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.760500431060791
Epoch: 41, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.340 Vali Acc: 0.139 Test Loss: 3.340 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8407354354858398
Epoch: 42, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.347 Vali Acc: 0.145 Test Loss: 3.347 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9677934646606445
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.351 Vali Acc: 0.145 Test Loss: 3.351 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8451409339904785
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.360 Vali Acc: 0.148 Test Loss: 3.360 Test Acc: 0.148
Validation loss decreased (-0.144673 --> -0.148202).  Saving model ...
Epoch: 45 cost time: 0.7975192070007324
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.367 Vali Acc: 0.147 Test Loss: 3.367 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0305192470550537
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.373 Vali Acc: 0.148 Test Loss: 3.373 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8523414134979248
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.383 Vali Acc: 0.144 Test Loss: 3.383 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.851963996887207
Epoch: 48, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.387 Vali Acc: 0.142 Test Loss: 3.387 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8691222667694092
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.388 Vali Acc: 0.145 Test Loss: 3.388 Test Acc: 0.145
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8637502193450928
Epoch: 50, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.392 Vali Acc: 0.154 Test Loss: 3.392 Test Acc: 0.154
Validation loss decreased (-0.148202 --> -0.154084).  Saving model ...
Epoch: 51 cost time: 0.822033166885376
Epoch: 51, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.397 Vali Acc: 0.149 Test Loss: 3.397 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8278272151947021
Epoch: 52, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.403 Vali Acc: 0.147 Test Loss: 3.403 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8906033039093018
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.407 Vali Acc: 0.144 Test Loss: 3.407 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.02777099609375
Epoch: 54, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.409 Vali Acc: 0.145 Test Loss: 3.409 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9045248031616211
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.414 Vali Acc: 0.144 Test Loss: 3.414 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9970781803131104
Epoch: 56, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.416 Vali Acc: 0.142 Test Loss: 3.416 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8792815208435059
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.420 Vali Acc: 0.146 Test Loss: 3.420 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.8186805248260498
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.426 Vali Acc: 0.145 Test Loss: 3.426 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8592355251312256
Epoch: 59, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.431 Vali Acc: 0.142 Test Loss: 3.431 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.8134951591491699
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.434 Vali Acc: 0.142 Test Loss: 3.434 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15411764705882353
model parameter : 92076
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.259990930557251
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.283 Vali Acc: 0.052 Test Loss: 3.283 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.7544848918914795
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.274 Vali Acc: 0.052 Test Loss: 3.274 Test Acc: 0.052
Validation loss decreased (-0.051732 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.7282581329345703
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.267 Vali Acc: 0.055 Test Loss: 3.267 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.7459149360656738
Epoch: 4, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.260 Vali Acc: 0.065 Test Loss: 3.260 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.7101256847381592
Epoch: 5, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.253 Vali Acc: 0.074 Test Loss: 3.253 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.7057075500488281
Epoch: 6, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.246 Vali Acc: 0.076 Test Loss: 3.246 Test Acc: 0.076
Validation loss decreased (-0.074085 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.6931824684143066
Epoch: 7, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.242 Vali Acc: 0.084 Test Loss: 3.242 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.7103745937347412
Epoch: 8, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.235 Vali Acc: 0.092 Test Loss: 3.235 Test Acc: 0.092
Validation loss decreased (-0.083497 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.6908011436462402
Epoch: 9, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.234 Vali Acc: 0.101 Test Loss: 3.234 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.767655611038208
Epoch: 10, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.232 Vali Acc: 0.106 Test Loss: 3.232 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.7567484378814697
Epoch: 11, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
Validation loss decreased (-0.105850 --> -0.116438).  Saving model ...
Epoch: 12 cost time: 0.715200662612915
Epoch: 12, Steps: 10 | Train Loss: 1.860 Vali Loss: 3.227 Vali Acc: 0.122 Test Loss: 3.227 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.6884160041809082
Epoch: 13, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.226 Vali Acc: 0.122 Test Loss: 3.226 Test Acc: 0.122
Validation loss decreased (-0.122321 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.8642702102661133
Epoch: 14, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.229 Vali Acc: 0.118 Test Loss: 3.229 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9622752666473389
Epoch: 15, Steps: 10 | Train Loss: 1.464 Vali Loss: 3.225 Vali Acc: 0.119 Test Loss: 3.225 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7900550365447998
Epoch: 16, Steps: 10 | Train Loss: 1.355 Vali Loss: 3.220 Vali Acc: 0.120 Test Loss: 3.220 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7486152648925781
Epoch: 17, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.217 Vali Acc: 0.127 Test Loss: 3.217 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 18 cost time: 0.7101657390594482
Epoch: 18, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.222 Vali Acc: 0.129 Test Loss: 3.222 Test Acc: 0.129
Validation loss decreased (-0.127027 --> -0.129380).  Saving model ...
Epoch: 19 cost time: 0.67510986328125
Epoch: 19, Steps: 10 | Train Loss: 0.989 Vali Loss: 3.222 Vali Acc: 0.127 Test Loss: 3.222 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7235386371612549
Epoch: 20, Steps: 10 | Train Loss: 0.887 Vali Loss: 3.226 Vali Acc: 0.132 Test Loss: 3.226 Test Acc: 0.132
Validation loss decreased (-0.129380 --> -0.131732).  Saving model ...
Epoch: 21 cost time: 0.8126487731933594
Epoch: 21, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.221 Vali Acc: 0.131 Test Loss: 3.221 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8518087863922119
Epoch: 22, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.229 Vali Acc: 0.124 Test Loss: 3.229 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6826260089874268
Epoch: 23, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.233 Vali Acc: 0.128 Test Loss: 3.233 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7766797542572021
Epoch: 24, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.237 Vali Acc: 0.124 Test Loss: 3.237 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7758443355560303
Epoch: 25, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.245 Vali Acc: 0.128 Test Loss: 3.245 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6703526973724365
Epoch: 26, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.247 Vali Acc: 0.136 Test Loss: 3.247 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 27 cost time: 0.8092048168182373
Epoch: 27, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.259 Vali Acc: 0.129 Test Loss: 3.259 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7531626224517822
Epoch: 28, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.269 Vali Acc: 0.131 Test Loss: 3.269 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7277183532714844
Epoch: 29, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.281 Vali Acc: 0.133 Test Loss: 3.281 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8762040138244629
Epoch: 30, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.286 Vali Acc: 0.131 Test Loss: 3.286 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7403106689453125
Epoch: 31, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.292 Vali Acc: 0.135 Test Loss: 3.292 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8332798480987549
Epoch: 32, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.304 Vali Acc: 0.131 Test Loss: 3.304 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7555701732635498
Epoch: 33, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.309 Vali Acc: 0.129 Test Loss: 3.309 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7753522396087646
Epoch: 34, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.317 Vali Acc: 0.129 Test Loss: 3.317 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6676778793334961
Epoch: 35, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.330 Vali Acc: 0.136 Test Loss: 3.330 Test Acc: 0.136
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7122962474822998
Epoch: 36, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.338 Vali Acc: 0.134 Test Loss: 3.338 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13647058823529412
model parameter : 91308
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5696914196014404
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.330 Vali Acc: 0.046 Test Loss: 3.330 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.7734923362731934
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6424140930175781
Epoch: 3, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.316 Vali Acc: 0.041 Test Loss: 3.316 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6800408363342285
Epoch: 4, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.306 Vali Acc: 0.048 Test Loss: 3.306 Test Acc: 0.048
Validation loss decreased (-0.045849 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.7004356384277344
Epoch: 5, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.295 Vali Acc: 0.055 Test Loss: 3.295 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.6837594509124756
Epoch: 6, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.288 Vali Acc: 0.053 Test Loss: 3.288 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7468922138214111
Epoch: 7, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.279 Vali Acc: 0.062 Test Loss: 3.279 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 8 cost time: 0.6347239017486572
Epoch: 8, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.273 Vali Acc: 0.066 Test Loss: 3.273 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065850).  Saving model ...
Epoch: 9 cost time: 0.6596686840057373
Epoch: 9, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.271 Vali Acc: 0.075 Test Loss: 3.271 Test Acc: 0.075
Validation loss decreased (-0.065850 --> -0.075261).  Saving model ...
Epoch: 10 cost time: 0.6911404132843018
Epoch: 10, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.265 Vali Acc: 0.081 Test Loss: 3.265 Test Acc: 0.081
Validation loss decreased (-0.075261 --> -0.081144).  Saving model ...
Epoch: 11 cost time: 0.6759123802185059
Epoch: 11, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.263 Vali Acc: 0.088 Test Loss: 3.263 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 12 cost time: 0.6427667140960693
Epoch: 12, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.259 Vali Acc: 0.095 Test Loss: 3.259 Test Acc: 0.095
Validation loss decreased (-0.088203 --> -0.095262).  Saving model ...
Epoch: 13 cost time: 0.701714277267456
Epoch: 13, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.261 Vali Acc: 0.096 Test Loss: 3.261 Test Acc: 0.096
Validation loss decreased (-0.095262 --> -0.096438).  Saving model ...
Epoch: 14 cost time: 0.6366806030273438
Epoch: 14, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.263 Vali Acc: 0.104 Test Loss: 3.263 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 15 cost time: 0.7061681747436523
Epoch: 15, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.261 Vali Acc: 0.113 Test Loss: 3.261 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 0.6571142673492432
Epoch: 16, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.257 Vali Acc: 0.108 Test Loss: 3.257 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5878503322601318
Epoch: 17, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.266 Vali Acc: 0.101 Test Loss: 3.266 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.652778148651123
Epoch: 18, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.261 Vali Acc: 0.108 Test Loss: 3.261 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6553773880004883
Epoch: 19, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.260 Vali Acc: 0.106 Test Loss: 3.260 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.713641881942749
Epoch: 20, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.269 Vali Acc: 0.108 Test Loss: 3.269 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.768151044845581
Epoch: 21, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.264 Vali Acc: 0.115 Test Loss: 3.264 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115261).  Saving model ...
Epoch: 22 cost time: 0.7721004486083984
Epoch: 22, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.265 Vali Acc: 0.107 Test Loss: 3.265 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8199746608734131
Epoch: 23, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.270 Vali Acc: 0.114 Test Loss: 3.270 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7536797523498535
Epoch: 24, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.277 Vali Acc: 0.108 Test Loss: 3.277 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8310484886169434
Epoch: 25, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.280 Vali Acc: 0.111 Test Loss: 3.280 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6764860153198242
Epoch: 26, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.287 Vali Acc: 0.111 Test Loss: 3.287 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.913116455078125
Epoch: 27, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.295 Vali Acc: 0.119 Test Loss: 3.295 Test Acc: 0.119
Validation loss decreased (-0.115261 --> -0.118791).  Saving model ...
Epoch: 28 cost time: 0.7531683444976807
Epoch: 28, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.308 Vali Acc: 0.119 Test Loss: 3.308 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7589218616485596
Epoch: 29, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.312 Vali Acc: 0.114 Test Loss: 3.312 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7460999488830566
Epoch: 30, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.329 Vali Acc: 0.115 Test Loss: 3.329 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7400405406951904
Epoch: 31, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.320 Vali Acc: 0.119 Test Loss: 3.320 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8022692203521729
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.330 Vali Acc: 0.120 Test Loss: 3.330 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119967).  Saving model ...
Epoch: 33 cost time: 0.7668371200561523
Epoch: 33, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.336 Vali Acc: 0.120 Test Loss: 3.336 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7593803405761719
Epoch: 34, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.342 Vali Acc: 0.124 Test Loss: 3.342 Test Acc: 0.124
Validation loss decreased (-0.119967 --> -0.123496).  Saving model ...
Epoch: 35 cost time: 0.7330665588378906
Epoch: 35, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.352 Vali Acc: 0.124 Test Loss: 3.352 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.878223180770874
Epoch: 36, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.360 Vali Acc: 0.126 Test Loss: 3.360 Test Acc: 0.126
Validation loss decreased (-0.123496 --> -0.125849).  Saving model ...
Epoch: 37 cost time: 0.7954926490783691
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.365 Vali Acc: 0.126 Test Loss: 3.365 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7827229499816895
Epoch: 38, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.369 Vali Acc: 0.126 Test Loss: 3.369 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9251499176025391
Epoch: 39, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.373 Vali Acc: 0.126 Test Loss: 3.373 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7135937213897705
Epoch: 40, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.375 Vali Acc: 0.128 Test Loss: 3.375 Test Acc: 0.128
Validation loss decreased (-0.125849 --> -0.128202).  Saving model ...
Epoch: 41 cost time: 0.711449384689331
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.380 Vali Acc: 0.125 Test Loss: 3.380 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.753084659576416
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.386 Vali Acc: 0.126 Test Loss: 3.386 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7391459941864014
Epoch: 43, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.388 Vali Acc: 0.122 Test Loss: 3.388 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7530510425567627
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.393 Vali Acc: 0.124 Test Loss: 3.393 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8145656585693359
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.399 Vali Acc: 0.120 Test Loss: 3.399 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7137541770935059
Epoch: 46, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.403 Vali Acc: 0.118 Test Loss: 3.403 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7536969184875488
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.405 Vali Acc: 0.122 Test Loss: 3.405 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7611875534057617
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.407 Vali Acc: 0.120 Test Loss: 3.407 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7847445011138916
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.409 Vali Acc: 0.120 Test Loss: 3.409 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7758853435516357
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.413 Vali Acc: 0.121 Test Loss: 3.413 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 91052
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.270951986312866
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.332 Vali Acc: 0.039 Test Loss: 3.332 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.6576871871948242
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.322 Vali Acc: 0.042 Test Loss: 3.322 Test Acc: 0.042
Validation loss decreased (-0.038790 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.6962313652038574
Epoch: 3, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.311 Vali Acc: 0.042 Test Loss: 3.311 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.6871750354766846
Epoch: 4, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.300 Vali Acc: 0.042 Test Loss: 3.300 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 0.6208689212799072
Epoch: 5, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.292 Vali Acc: 0.049 Test Loss: 3.292 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.6510074138641357
Epoch: 6, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.284 Vali Acc: 0.046 Test Loss: 3.284 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6855049133300781
Epoch: 7, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.272 Vali Acc: 0.058 Test Loss: 3.272 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 0.7300338745117188
Epoch: 8, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.265 Vali Acc: 0.055 Test Loss: 3.265 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.697246789932251
Epoch: 9, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.256 Vali Acc: 0.064 Test Loss: 3.256 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 10 cost time: 0.7414121627807617
Epoch: 10, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.250 Vali Acc: 0.067 Test Loss: 3.250 Test Acc: 0.067
Validation loss decreased (-0.063497 --> -0.067026).  Saving model ...
Epoch: 11 cost time: 0.5985829830169678
Epoch: 11, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.249 Vali Acc: 0.076 Test Loss: 3.249 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 12 cost time: 0.5926012992858887
Epoch: 12, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.245 Vali Acc: 0.086 Test Loss: 3.245 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 13 cost time: 0.6378867626190186
Epoch: 13, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.241 Vali Acc: 0.095 Test Loss: 3.241 Test Acc: 0.095
Validation loss decreased (-0.085850 --> -0.095262).  Saving model ...
Epoch: 14 cost time: 0.5511529445648193
Epoch: 14, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.239 Vali Acc: 0.099 Test Loss: 3.239 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 15 cost time: 0.6646199226379395
Epoch: 15, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.237 Vali Acc: 0.101 Test Loss: 3.237 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 16 cost time: 0.6747303009033203
Epoch: 16, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.244 Vali Acc: 0.107 Test Loss: 3.244 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107026).  Saving model ...
Epoch: 17 cost time: 0.5166592597961426
Epoch: 17, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.243 Vali Acc: 0.098 Test Loss: 3.243 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6112825870513916
Epoch: 18, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.246 Vali Acc: 0.108 Test Loss: 3.246 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108203).  Saving model ...
Epoch: 19 cost time: 0.7495400905609131
Epoch: 19, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.245 Vali Acc: 0.096 Test Loss: 3.245 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5805797576904297
Epoch: 20, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.253 Vali Acc: 0.104 Test Loss: 3.253 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6199133396148682
Epoch: 21, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.254 Vali Acc: 0.109 Test Loss: 3.254 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 22 cost time: 0.5754635334014893
Epoch: 22, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.255 Vali Acc: 0.112 Test Loss: 3.255 Test Acc: 0.112
Validation loss decreased (-0.109379 --> -0.111732).  Saving model ...
Epoch: 23 cost time: 0.6718695163726807
Epoch: 23, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.261 Vali Acc: 0.114 Test Loss: 3.261 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 24 cost time: 0.5883603096008301
Epoch: 24, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.276 Vali Acc: 0.109 Test Loss: 3.276 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7781684398651123
Epoch: 25, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.276 Vali Acc: 0.118 Test Loss: 3.276 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117614).  Saving model ...
Epoch: 26 cost time: 0.6651339530944824
Epoch: 26, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.268 Vali Acc: 0.120 Test Loss: 3.268 Test Acc: 0.120
Validation loss decreased (-0.117614 --> -0.119967).  Saving model ...
Epoch: 27 cost time: 0.5659651756286621
Epoch: 27, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.286 Vali Acc: 0.112 Test Loss: 3.286 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6574528217315674
Epoch: 28, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.292 Vali Acc: 0.115 Test Loss: 3.292 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7651588916778564
Epoch: 29, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.299 Vali Acc: 0.118 Test Loss: 3.299 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5898447036743164
Epoch: 30, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.308 Vali Acc: 0.119 Test Loss: 3.308 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7051939964294434
Epoch: 31, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.313 Vali Acc: 0.121 Test Loss: 3.313 Test Acc: 0.121
Validation loss decreased (-0.119967 --> -0.121143).  Saving model ...
Epoch: 32 cost time: 0.5860595703125
Epoch: 32, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.322 Vali Acc: 0.121 Test Loss: 3.322 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5649564266204834
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.324 Vali Acc: 0.120 Test Loss: 3.324 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6870052814483643
Epoch: 34, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.331 Vali Acc: 0.127 Test Loss: 3.331 Test Acc: 0.127
Validation loss decreased (-0.121143 --> -0.127026).  Saving model ...
Epoch: 35 cost time: 0.7775673866271973
Epoch: 35, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.337 Vali Acc: 0.122 Test Loss: 3.337 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7096128463745117
Epoch: 36, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.341 Vali Acc: 0.127 Test Loss: 3.341 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6627137660980225
Epoch: 37, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.346 Vali Acc: 0.128 Test Loss: 3.346 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128202).  Saving model ...
Epoch: 38 cost time: 0.7194726467132568
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.351 Vali Acc: 0.126 Test Loss: 3.351 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6824600696563721
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.358 Vali Acc: 0.129 Test Loss: 3.358 Test Acc: 0.129
Validation loss decreased (-0.128202 --> -0.129378).  Saving model ...
Epoch: 40 cost time: 0.7379090785980225
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.364 Vali Acc: 0.129 Test Loss: 3.364 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7664191722869873
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.367 Vali Acc: 0.127 Test Loss: 3.367 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8183917999267578
Epoch: 42, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.373 Vali Acc: 0.128 Test Loss: 3.373 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6512277126312256
Epoch: 43, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.377 Vali Acc: 0.127 Test Loss: 3.377 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8291013240814209
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.382 Vali Acc: 0.126 Test Loss: 3.382 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7451028823852539
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.386 Vali Acc: 0.126 Test Loss: 3.386 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7851476669311523
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.390 Vali Acc: 0.127 Test Loss: 3.390 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6836438179016113
Epoch: 47, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.395 Vali Acc: 0.126 Test Loss: 3.395 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7808952331542969
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.397 Vali Acc: 0.127 Test Loss: 3.397 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8923826217651367
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.404 Vali Acc: 0.131 Test Loss: 3.404 Test Acc: 0.131
Validation loss decreased (-0.129378 --> -0.130554).  Saving model ...
Epoch: 50 cost time: 0.7139356136322021
Epoch: 50, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.408 Vali Acc: 0.129 Test Loss: 3.408 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7332272529602051
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.412 Vali Acc: 0.127 Test Loss: 3.412 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6142230033874512
Epoch: 52, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.416 Vali Acc: 0.127 Test Loss: 3.416 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.71299147605896
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.421 Vali Acc: 0.128 Test Loss: 3.421 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8296568393707275
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.424 Vali Acc: 0.128 Test Loss: 3.424 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7388653755187988
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.428 Vali Acc: 0.126 Test Loss: 3.428 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8748116493225098
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.431 Vali Acc: 0.129 Test Loss: 3.431 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6771829128265381
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.435 Vali Acc: 0.127 Test Loss: 3.435 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8215255737304688
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.440 Vali Acc: 0.127 Test Loss: 3.440 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6183760166168213
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.443 Vali Acc: 0.128 Test Loss: 3.443 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13058823529411764
model parameter : 90540
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1874759197235107
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.291 Vali Acc: 0.033 Test Loss: 3.291 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.6153573989868164
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.281 Vali Acc: 0.032 Test Loss: 3.281 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.641932487487793
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.269 Vali Acc: 0.041 Test Loss: 3.269 Test Acc: 0.041
Validation loss decreased (-0.032908 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.5978641510009766
Epoch: 4, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.255 Vali Acc: 0.054 Test Loss: 3.255 Test Acc: 0.054
Validation loss decreased (-0.041144 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.6110498905181885
Epoch: 5, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.245 Vali Acc: 0.051 Test Loss: 3.245 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5913369655609131
Epoch: 6, Steps: 10 | Train Loss: 2.657 Vali Loss: 3.234 Vali Acc: 0.064 Test Loss: 3.234 Test Acc: 0.064
Validation loss decreased (-0.054085 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 0.6126012802124023
Epoch: 7, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.229 Vali Acc: 0.061 Test Loss: 3.229 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6379871368408203
Epoch: 8, Steps: 10 | Train Loss: 2.361 Vali Loss: 3.224 Vali Acc: 0.072 Test Loss: 3.224 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 0.5926108360290527
Epoch: 9, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.222 Vali Acc: 0.079 Test Loss: 3.222 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.5895283222198486
Epoch: 10, Steps: 10 | Train Loss: 2.054 Vali Loss: 3.220 Vali Acc: 0.079 Test Loss: 3.220 Test Acc: 0.079
Validation loss decreased (-0.078791 --> -0.078791).  Saving model ...
Epoch: 11 cost time: 0.6210126876831055
Epoch: 11, Steps: 10 | Train Loss: 1.908 Vali Loss: 3.221 Vali Acc: 0.079 Test Loss: 3.221 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8027000427246094
Epoch: 12, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.219 Vali Acc: 0.079 Test Loss: 3.219 Test Acc: 0.079
Validation loss decreased (-0.078791 --> -0.078791).  Saving model ...
Epoch: 13 cost time: 0.6627590656280518
Epoch: 13, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.218 Vali Acc: 0.089 Test Loss: 3.218 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089380).  Saving model ...
Epoch: 14 cost time: 0.6601040363311768
Epoch: 14, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.214 Vali Acc: 0.082 Test Loss: 3.214 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5945732593536377
Epoch: 15, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.222 Vali Acc: 0.082 Test Loss: 3.222 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6570062637329102
Epoch: 16, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.220 Vali Acc: 0.082 Test Loss: 3.220 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6153538227081299
Epoch: 17, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.226 Vali Acc: 0.098 Test Loss: 3.226 Test Acc: 0.098
Validation loss decreased (-0.089380 --> -0.097615).  Saving model ...
Epoch: 18 cost time: 0.6099700927734375
Epoch: 18, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.230 Vali Acc: 0.091 Test Loss: 3.230 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5808031558990479
Epoch: 19, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.231 Vali Acc: 0.098 Test Loss: 3.231 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5808064937591553
Epoch: 20, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.241 Vali Acc: 0.100 Test Loss: 3.241 Test Acc: 0.100
Validation loss decreased (-0.097615 --> -0.099968).  Saving model ...
Epoch: 21 cost time: 0.5627574920654297
Epoch: 21, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.248 Vali Acc: 0.107 Test Loss: 3.248 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107026).  Saving model ...
Epoch: 22 cost time: 0.5937190055847168
Epoch: 22, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.251 Vali Acc: 0.101 Test Loss: 3.251 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5808296203613281
Epoch: 23, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.265 Vali Acc: 0.111 Test Loss: 3.265 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110556).  Saving model ...
Epoch: 24 cost time: 0.619408369064331
Epoch: 24, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.266 Vali Acc: 0.107 Test Loss: 3.266 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5760817527770996
Epoch: 25, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.287 Vali Acc: 0.111 Test Loss: 3.287 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6169543266296387
Epoch: 26, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.301 Vali Acc: 0.114 Test Loss: 3.301 Test Acc: 0.114
Validation loss decreased (-0.110556 --> -0.114085).  Saving model ...
Epoch: 27 cost time: 0.5989382266998291
Epoch: 27, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.307 Vali Acc: 0.108 Test Loss: 3.307 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6338846683502197
Epoch: 28, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.320 Vali Acc: 0.109 Test Loss: 3.320 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6057882308959961
Epoch: 29, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.333 Vali Acc: 0.116 Test Loss: 3.333 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116437).  Saving model ...
Epoch: 30 cost time: 0.5701174736022949
Epoch: 30, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.340 Vali Acc: 0.119 Test Loss: 3.340 Test Acc: 0.119
Validation loss decreased (-0.116437 --> -0.118790).  Saving model ...
Epoch: 31 cost time: 0.5617749691009521
Epoch: 31, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.357 Vali Acc: 0.122 Test Loss: 3.357 Test Acc: 0.122
Validation loss decreased (-0.118790 --> -0.122319).  Saving model ...
Epoch: 32 cost time: 0.6251931190490723
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.361 Vali Acc: 0.121 Test Loss: 3.361 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6114604473114014
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.373 Vali Acc: 0.121 Test Loss: 3.373 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6149106025695801
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.383 Vali Acc: 0.116 Test Loss: 3.383 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6128590106964111
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.392 Vali Acc: 0.118 Test Loss: 3.392 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6168906688690186
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.400 Vali Acc: 0.115 Test Loss: 3.400 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.593876838684082
Epoch: 37, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.405 Vali Acc: 0.116 Test Loss: 3.405 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6443495750427246
Epoch: 38, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.409 Vali Acc: 0.114 Test Loss: 3.409 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6083192825317383
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.415 Vali Acc: 0.118 Test Loss: 3.415 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7274758815765381
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.425 Vali Acc: 0.121 Test Loss: 3.425 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6684303283691406
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.432 Vali Acc: 0.118 Test Loss: 3.432 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_MTSMixer_UEA_ftM_sl152_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1223529411764706
model parameter : 90284
model size : 0.35MB
