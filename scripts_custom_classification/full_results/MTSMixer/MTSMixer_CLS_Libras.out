Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.543065309524536
Epoch: 1, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.689 Vali Acc: 0.106 Test Loss: 2.689 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9350028038024902
Epoch: 2, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.667 Vali Acc: 0.133 Test Loss: 2.667 Test Acc: 0.133
Validation loss decreased (-0.105529 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 1.0507895946502686
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.641 Vali Acc: 0.178 Test Loss: 2.641 Test Acc: 0.178
Validation loss decreased (-0.133307 --> -0.177751).  Saving model ...
Epoch: 4 cost time: 0.7786996364593506
Epoch: 4, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.630 Vali Acc: 0.128 Test Loss: 2.630 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0044658184051514
Epoch: 5, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.629 Vali Acc: 0.150 Test Loss: 2.629 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9545438289642334
Epoch: 6, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.635 Vali Acc: 0.122 Test Loss: 2.635 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9443857669830322
Epoch: 7, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.626 Vali Acc: 0.128 Test Loss: 2.626 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.086721420288086
Epoch: 8, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.603 Vali Acc: 0.122 Test Loss: 2.603 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8209373950958252
Epoch: 9, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.579 Vali Acc: 0.111 Test Loss: 2.579 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.917797327041626
Epoch: 10, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.592 Vali Acc: 0.156 Test Loss: 2.592 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9490499496459961
Epoch: 11, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.574 Vali Acc: 0.161 Test Loss: 2.574 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0907230377197266
Epoch: 12, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.527 Vali Acc: 0.178 Test Loss: 2.527 Test Acc: 0.178
Validation loss decreased (-0.177751 --> -0.177753).  Saving model ...
Epoch: 13 cost time: 0.9914455413818359
Epoch: 13, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.546 Vali Acc: 0.178 Test Loss: 2.546 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.057091236114502
Epoch: 14, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.513 Vali Acc: 0.172 Test Loss: 2.513 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0098240375518799
Epoch: 15, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.485 Vali Acc: 0.222 Test Loss: 2.485 Test Acc: 0.222
Validation loss decreased (-0.177753 --> -0.222197).  Saving model ...
Epoch: 16 cost time: 1.1600172519683838
Epoch: 16, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.438 Vali Acc: 0.217 Test Loss: 2.438 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1252450942993164
Epoch: 17, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.413 Vali Acc: 0.189 Test Loss: 2.413 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8776149749755859
Epoch: 18, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.402 Vali Acc: 0.217 Test Loss: 2.402 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.027785062789917
Epoch: 19, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.394 Vali Acc: 0.206 Test Loss: 2.394 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9792101383209229
Epoch: 20, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.382 Vali Acc: 0.178 Test Loss: 2.382 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1773569583892822
Epoch: 21, Steps: 12 | Train Loss: 2.375 Vali Loss: 2.379 Vali Acc: 0.194 Test Loss: 2.379 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1276705265045166
Epoch: 22, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.386 Vali Acc: 0.217 Test Loss: 2.386 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1959478855133057
Epoch: 23, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.375 Vali Acc: 0.233 Test Loss: 2.375 Test Acc: 0.233
Validation loss decreased (-0.222197 --> -0.233310).  Saving model ...
Epoch: 24 cost time: 1.060593605041504
Epoch: 24, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.352 Vali Acc: 0.233 Test Loss: 2.352 Test Acc: 0.233
Validation loss decreased (-0.233310 --> -0.233310).  Saving model ...
Epoch: 25 cost time: 1.0905325412750244
Epoch: 25, Steps: 12 | Train Loss: 2.325 Vali Loss: 2.320 Vali Acc: 0.256 Test Loss: 2.320 Test Acc: 0.256
Validation loss decreased (-0.233310 --> -0.255532).  Saving model ...
Epoch: 26 cost time: 1.1244618892669678
Epoch: 26, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.311 Vali Acc: 0.250 Test Loss: 2.311 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1053004264831543
Epoch: 27, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.297 Vali Acc: 0.261 Test Loss: 2.297 Test Acc: 0.261
Validation loss decreased (-0.255532 --> -0.261088).  Saving model ...
Epoch: 28 cost time: 1.0524985790252686
Epoch: 28, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.263 Vali Acc: 0.294 Test Loss: 2.263 Test Acc: 0.294
Validation loss decreased (-0.261088 --> -0.294422).  Saving model ...
Epoch: 29 cost time: 1.0188205242156982
Epoch: 29, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.258 Vali Acc: 0.278 Test Loss: 2.258 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0707216262817383
Epoch: 30, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.217 Vali Acc: 0.300 Test Loss: 2.217 Test Acc: 0.300
Validation loss decreased (-0.294422 --> -0.299978).  Saving model ...
Epoch: 31 cost time: 1.0331075191497803
Epoch: 31, Steps: 12 | Train Loss: 2.119 Vali Loss: 2.207 Vali Acc: 0.294 Test Loss: 2.207 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1112139225006104
Epoch: 32, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.191 Vali Acc: 0.283 Test Loss: 2.191 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1635849475860596
Epoch: 33, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.178 Vali Acc: 0.294 Test Loss: 2.178 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1098637580871582
Epoch: 34, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.175 Vali Acc: 0.289 Test Loss: 2.175 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9991395473480225
Epoch: 35, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.185 Vali Acc: 0.294 Test Loss: 2.185 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1326830387115479
Epoch: 36, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.182 Vali Acc: 0.311 Test Loss: 2.182 Test Acc: 0.311
Validation loss decreased (-0.299978 --> -0.311089).  Saving model ...
Epoch: 37 cost time: 1.1979475021362305
Epoch: 37, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.171 Vali Acc: 0.311 Test Loss: 2.171 Test Acc: 0.311
Validation loss decreased (-0.311089 --> -0.311089).  Saving model ...
Epoch: 38 cost time: 0.9990627765655518
Epoch: 38, Steps: 12 | Train Loss: 2.004 Vali Loss: 2.173 Vali Acc: 0.294 Test Loss: 2.173 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9998188018798828
Epoch: 39, Steps: 12 | Train Loss: 2.007 Vali Loss: 2.178 Vali Acc: 0.306 Test Loss: 2.178 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.90692138671875
Epoch: 40, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.165 Vali Acc: 0.294 Test Loss: 2.165 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9903976917266846
Epoch: 41, Steps: 12 | Train Loss: 2.002 Vali Loss: 2.178 Vali Acc: 0.306 Test Loss: 2.178 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0229578018188477
Epoch: 42, Steps: 12 | Train Loss: 2.015 Vali Loss: 2.172 Vali Acc: 0.311 Test Loss: 2.172 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8878223896026611
Epoch: 43, Steps: 12 | Train Loss: 2.000 Vali Loss: 2.162 Vali Acc: 0.311 Test Loss: 2.162 Test Acc: 0.311
Validation loss decreased (-0.311089 --> -0.311089).  Saving model ...
Epoch: 44 cost time: 1.0243260860443115
Epoch: 44, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.148 Vali Acc: 0.311 Test Loss: 2.148 Test Acc: 0.311
Validation loss decreased (-0.311089 --> -0.311090).  Saving model ...
Epoch: 45 cost time: 1.0893611907958984
Epoch: 45, Steps: 12 | Train Loss: 1.933 Vali Loss: 2.164 Vali Acc: 0.289 Test Loss: 2.164 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9959392547607422
Epoch: 46, Steps: 12 | Train Loss: 1.973 Vali Loss: 2.159 Vali Acc: 0.294 Test Loss: 2.159 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1105072498321533
Epoch: 47, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.157 Vali Acc: 0.283 Test Loss: 2.157 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9577498435974121
Epoch: 48, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.156 Vali Acc: 0.283 Test Loss: 2.156 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.991323709487915
Epoch: 49, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.160 Vali Acc: 0.289 Test Loss: 2.160 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5028142929077148
Epoch: 50, Steps: 12 | Train Loss: 1.903 Vali Loss: 2.153 Vali Acc: 0.294 Test Loss: 2.153 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9678285121917725
Epoch: 51, Steps: 12 | Train Loss: 1.948 Vali Loss: 2.144 Vali Acc: 0.294 Test Loss: 2.144 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.016819715499878
Epoch: 52, Steps: 12 | Train Loss: 1.904 Vali Loss: 2.136 Vali Acc: 0.311 Test Loss: 2.136 Test Acc: 0.311
Validation loss decreased (-0.311090 --> -0.311090).  Saving model ...
Epoch: 53 cost time: 1.0029447078704834
Epoch: 53, Steps: 12 | Train Loss: 1.905 Vali Loss: 2.134 Vali Acc: 0.300 Test Loss: 2.134 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9964981079101562
Epoch: 54, Steps: 12 | Train Loss: 1.895 Vali Loss: 2.142 Vali Acc: 0.294 Test Loss: 2.142 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0120055675506592
Epoch: 55, Steps: 12 | Train Loss: 1.890 Vali Loss: 2.136 Vali Acc: 0.294 Test Loss: 2.136 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9878013134002686
Epoch: 56, Steps: 12 | Train Loss: 1.848 Vali Loss: 2.125 Vali Acc: 0.294 Test Loss: 2.125 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0232419967651367
Epoch: 57, Steps: 12 | Train Loss: 1.819 Vali Loss: 2.122 Vali Acc: 0.322 Test Loss: 2.122 Test Acc: 0.322
Validation loss decreased (-0.311090 --> -0.322201).  Saving model ...
Epoch: 58 cost time: 0.921217679977417
Epoch: 58, Steps: 12 | Train Loss: 1.810 Vali Loss: 2.120 Vali Acc: 0.322 Test Loss: 2.120 Test Acc: 0.322
Validation loss decreased (-0.322201 --> -0.322201).  Saving model ...
Epoch: 59 cost time: 0.9729020595550537
Epoch: 59, Steps: 12 | Train Loss: 1.842 Vali Loss: 2.118 Vali Acc: 0.322 Test Loss: 2.118 Test Acc: 0.322
Validation loss decreased (-0.322201 --> -0.322201).  Saving model ...
Epoch: 60 cost time: 0.951819896697998
Epoch: 60, Steps: 12 | Train Loss: 1.849 Vali Loss: 2.116 Vali Acc: 0.311 Test Loss: 2.116 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8594386577606201
Epoch: 61, Steps: 12 | Train Loss: 1.850 Vali Loss: 2.120 Vali Acc: 0.300 Test Loss: 2.120 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9433698654174805
Epoch: 62, Steps: 12 | Train Loss: 1.813 Vali Loss: 2.115 Vali Acc: 0.306 Test Loss: 2.115 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0277304649353027
Epoch: 63, Steps: 12 | Train Loss: 1.851 Vali Loss: 2.110 Vali Acc: 0.300 Test Loss: 2.110 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.943291187286377
Epoch: 64, Steps: 12 | Train Loss: 1.747 Vali Loss: 2.106 Vali Acc: 0.300 Test Loss: 2.106 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.0603868961334229
Epoch: 65, Steps: 12 | Train Loss: 1.715 Vali Loss: 2.108 Vali Acc: 0.300 Test Loss: 2.108 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0672776699066162
Epoch: 66, Steps: 12 | Train Loss: 1.766 Vali Loss: 2.113 Vali Acc: 0.300 Test Loss: 2.113 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1541051864624023
Epoch: 67, Steps: 12 | Train Loss: 1.751 Vali Loss: 2.110 Vali Acc: 0.322 Test Loss: 2.110 Test Acc: 0.322
Validation loss decreased (-0.322201 --> -0.322201).  Saving model ...
Epoch: 68 cost time: 1.158635139465332
Epoch: 68, Steps: 12 | Train Loss: 1.720 Vali Loss: 2.111 Vali Acc: 0.306 Test Loss: 2.111 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.089916467666626
Epoch: 69, Steps: 12 | Train Loss: 1.692 Vali Loss: 2.123 Vali Acc: 0.300 Test Loss: 2.123 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2049808502197266
Epoch: 70, Steps: 12 | Train Loss: 1.740 Vali Loss: 2.122 Vali Acc: 0.300 Test Loss: 2.122 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0215072631835938
Epoch: 71, Steps: 12 | Train Loss: 1.743 Vali Loss: 2.100 Vali Acc: 0.339 Test Loss: 2.100 Test Acc: 0.339
Validation loss decreased (-0.322201 --> -0.338868).  Saving model ...
Epoch: 72 cost time: 1.028205156326294
Epoch: 72, Steps: 12 | Train Loss: 1.765 Vali Loss: 2.121 Vali Acc: 0.322 Test Loss: 2.121 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0645012855529785
Epoch: 73, Steps: 12 | Train Loss: 1.761 Vali Loss: 2.142 Vali Acc: 0.283 Test Loss: 2.142 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2418816089630127
Epoch: 74, Steps: 12 | Train Loss: 1.821 Vali Loss: 2.187 Vali Acc: 0.278 Test Loss: 2.187 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9621009826660156
Epoch: 75, Steps: 12 | Train Loss: 1.816 Vali Loss: 2.149 Vali Acc: 0.306 Test Loss: 2.149 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.0792992115020752
Epoch: 76, Steps: 12 | Train Loss: 1.846 Vali Loss: 2.155 Vali Acc: 0.289 Test Loss: 2.155 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.2823750972747803
Epoch: 77, Steps: 12 | Train Loss: 1.749 Vali Loss: 2.176 Vali Acc: 0.278 Test Loss: 2.176 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.0229136943817139
Epoch: 78, Steps: 12 | Train Loss: 1.801 Vali Loss: 2.165 Vali Acc: 0.289 Test Loss: 2.165 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.9787201881408691
Epoch: 79, Steps: 12 | Train Loss: 1.748 Vali Loss: 2.139 Vali Acc: 0.283 Test Loss: 2.139 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.227365255355835
Epoch: 80, Steps: 12 | Train Loss: 1.763 Vali Loss: 2.125 Vali Acc: 0.333 Test Loss: 2.125 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.1493384838104248
Epoch: 81, Steps: 12 | Train Loss: 1.806 Vali Loss: 2.153 Vali Acc: 0.294 Test Loss: 2.153 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3388888888888889
model parameter : 198075
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.533522367477417
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.740 Vali Acc: 0.028 Test Loss: 2.740 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 0.8891289234161377
Epoch: 2, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.027750 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 0.8795318603515625
Epoch: 3, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.691 Vali Acc: 0.089 Test Loss: 2.691 Test Acc: 0.089
Validation loss decreased (-0.066640 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 0.9537203311920166
Epoch: 4, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.672 Vali Acc: 0.106 Test Loss: 2.672 Test Acc: 0.106
Validation loss decreased (-0.088862 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 0.8372392654418945
Epoch: 5, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.643 Vali Acc: 0.106 Test Loss: 2.643 Test Acc: 0.106
Validation loss decreased (-0.105529 --> -0.105529).  Saving model ...
Epoch: 6 cost time: 0.9489231109619141
Epoch: 6, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.611 Vali Acc: 0.161 Test Loss: 2.611 Test Acc: 0.161
Validation loss decreased (-0.105529 --> -0.161085).  Saving model ...
Epoch: 7 cost time: 0.9616410732269287
Epoch: 7, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.595 Vali Acc: 0.178 Test Loss: 2.595 Test Acc: 0.178
Validation loss decreased (-0.161085 --> -0.177752).  Saving model ...
Epoch: 8 cost time: 0.8465836048126221
Epoch: 8, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.571 Vali Acc: 0.183 Test Loss: 2.571 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183308).  Saving model ...
Epoch: 9 cost time: 0.9648056030273438
Epoch: 9, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.583 Vali Acc: 0.161 Test Loss: 2.583 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9714996814727783
Epoch: 10, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.561 Vali Acc: 0.167 Test Loss: 2.561 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8463695049285889
Epoch: 11, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.525 Vali Acc: 0.194 Test Loss: 2.525 Test Acc: 0.194
Validation loss decreased (-0.183308 --> -0.194419).  Saving model ...
Epoch: 12 cost time: 0.8882107734680176
Epoch: 12, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.505 Vali Acc: 0.217 Test Loss: 2.505 Test Acc: 0.217
Validation loss decreased (-0.194419 --> -0.216642).  Saving model ...
Epoch: 13 cost time: 0.9144744873046875
Epoch: 13, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.488 Vali Acc: 0.178 Test Loss: 2.488 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9687626361846924
Epoch: 14, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.480 Vali Acc: 0.206 Test Loss: 2.480 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9593980312347412
Epoch: 15, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.489 Vali Acc: 0.211 Test Loss: 2.489 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9346957206726074
Epoch: 16, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.468 Vali Acc: 0.206 Test Loss: 2.468 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8378310203552246
Epoch: 17, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.457 Vali Acc: 0.228 Test Loss: 2.457 Test Acc: 0.228
Validation loss decreased (-0.216642 --> -0.227753).  Saving model ...
Epoch: 18 cost time: 0.8451273441314697
Epoch: 18, Steps: 12 | Train Loss: 2.428 Vali Loss: 2.441 Vali Acc: 0.222 Test Loss: 2.441 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9638004302978516
Epoch: 19, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.420 Vali Acc: 0.233 Test Loss: 2.420 Test Acc: 0.233
Validation loss decreased (-0.227753 --> -0.233309).  Saving model ...
Epoch: 20 cost time: 0.7807815074920654
Epoch: 20, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.396 Vali Acc: 0.267 Test Loss: 2.396 Test Acc: 0.267
Validation loss decreased (-0.233309 --> -0.266643).  Saving model ...
Epoch: 21 cost time: 0.9447083473205566
Epoch: 21, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.393 Vali Acc: 0.283 Test Loss: 2.393 Test Acc: 0.283
Validation loss decreased (-0.266643 --> -0.283309).  Saving model ...
Epoch: 22 cost time: 0.786266565322876
Epoch: 22, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.380 Vali Acc: 0.272 Test Loss: 2.380 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9835197925567627
Epoch: 23, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.375 Vali Acc: 0.272 Test Loss: 2.375 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9617629051208496
Epoch: 24, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.369 Vali Acc: 0.244 Test Loss: 2.369 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9927246570587158
Epoch: 25, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.354 Vali Acc: 0.261 Test Loss: 2.354 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7807137966156006
Epoch: 26, Steps: 12 | Train Loss: 2.289 Vali Loss: 2.363 Vali Acc: 0.272 Test Loss: 2.363 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9482147693634033
Epoch: 27, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.374 Vali Acc: 0.250 Test Loss: 2.374 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8614687919616699
Epoch: 28, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.356 Vali Acc: 0.256 Test Loss: 2.356 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8513727188110352
Epoch: 29, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.341 Vali Acc: 0.244 Test Loss: 2.341 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.912043571472168
Epoch: 30, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.346 Vali Acc: 0.244 Test Loss: 2.346 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9774825572967529
Epoch: 31, Steps: 12 | Train Loss: 2.195 Vali Loss: 2.324 Vali Acc: 0.250 Test Loss: 2.324 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2833333333333333
model parameter : 196027
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6903200149536133
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.760 Vali Acc: 0.056 Test Loss: 2.760 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.915642499923706
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.734 Vali Acc: 0.056 Test Loss: 2.734 Test Acc: 0.056
Validation loss decreased (-0.055528 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 1.1145823001861572
Epoch: 3, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.699 Vali Acc: 0.056 Test Loss: 2.699 Test Acc: 0.056
Validation loss decreased (-0.055528 --> -0.055529).  Saving model ...
Epoch: 4 cost time: 1.1143808364868164
Epoch: 4, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.676 Vali Acc: 0.122 Test Loss: 2.676 Test Acc: 0.122
Validation loss decreased (-0.055529 --> -0.122195).  Saving model ...
Epoch: 5 cost time: 0.947944164276123
Epoch: 5, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.663 Vali Acc: 0.094 Test Loss: 2.663 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.127525806427002
Epoch: 6, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.613 Vali Acc: 0.183 Test Loss: 2.613 Test Acc: 0.183
Validation loss decreased (-0.122195 --> -0.183307).  Saving model ...
Epoch: 7 cost time: 1.1094167232513428
Epoch: 7, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.594 Vali Acc: 0.178 Test Loss: 2.594 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3092231750488281
Epoch: 8, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.562 Vali Acc: 0.217 Test Loss: 2.562 Test Acc: 0.217
Validation loss decreased (-0.183307 --> -0.216641).  Saving model ...
Epoch: 9 cost time: 1.003211259841919
Epoch: 9, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.530 Vali Acc: 0.228 Test Loss: 2.530 Test Acc: 0.228
Validation loss decreased (-0.216641 --> -0.227752).  Saving model ...
Epoch: 10 cost time: 0.942500114440918
Epoch: 10, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.532 Vali Acc: 0.178 Test Loss: 2.532 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9705245494842529
Epoch: 11, Steps: 12 | Train Loss: 2.412 Vali Loss: 2.498 Vali Acc: 0.194 Test Loss: 2.498 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9861965179443359
Epoch: 12, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.488 Vali Acc: 0.206 Test Loss: 2.488 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9768834114074707
Epoch: 13, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.476 Vali Acc: 0.217 Test Loss: 2.476 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1134965419769287
Epoch: 14, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.439 Vali Acc: 0.222 Test Loss: 2.439 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9775803089141846
Epoch: 15, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.421 Vali Acc: 0.189 Test Loss: 2.421 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9431838989257812
Epoch: 16, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.425 Vali Acc: 0.211 Test Loss: 2.425 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0848278999328613
Epoch: 17, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.409 Vali Acc: 0.228 Test Loss: 2.409 Test Acc: 0.228
Validation loss decreased (-0.227752 --> -0.227754).  Saving model ...
Epoch: 18 cost time: 1.0814392566680908
Epoch: 18, Steps: 12 | Train Loss: 2.264 Vali Loss: 2.394 Vali Acc: 0.233 Test Loss: 2.394 Test Acc: 0.233
Validation loss decreased (-0.227754 --> -0.233309).  Saving model ...
Epoch: 19 cost time: 1.0313539505004883
Epoch: 19, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.386 Vali Acc: 0.222 Test Loss: 2.386 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9165463447570801
Epoch: 20, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.374 Vali Acc: 0.256 Test Loss: 2.374 Test Acc: 0.256
Validation loss decreased (-0.233309 --> -0.255532).  Saving model ...
Epoch: 21 cost time: 0.9431171417236328
Epoch: 21, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.344 Vali Acc: 0.222 Test Loss: 2.344 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2294905185699463
Epoch: 22, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.309 Vali Acc: 0.233 Test Loss: 2.309 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0595054626464844
Epoch: 23, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.302 Vali Acc: 0.283 Test Loss: 2.302 Test Acc: 0.283
Validation loss decreased (-0.255532 --> -0.283310).  Saving model ...
Epoch: 24 cost time: 1.0104398727416992
Epoch: 24, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.292 Vali Acc: 0.300 Test Loss: 2.292 Test Acc: 0.300
Validation loss decreased (-0.283310 --> -0.299977).  Saving model ...
Epoch: 25 cost time: 1.102715253829956
Epoch: 25, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.278 Vali Acc: 0.250 Test Loss: 2.278 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0744409561157227
Epoch: 26, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.272 Vali Acc: 0.233 Test Loss: 2.272 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0254316329956055
Epoch: 27, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.272 Vali Acc: 0.244 Test Loss: 2.272 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1266429424285889
Epoch: 28, Steps: 12 | Train Loss: 2.118 Vali Loss: 2.273 Vali Acc: 0.222 Test Loss: 2.273 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9940390586853027
Epoch: 29, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.267 Vali Acc: 0.222 Test Loss: 2.267 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9583313465118408
Epoch: 30, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.283 Vali Acc: 0.239 Test Loss: 2.283 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1369566917419434
Epoch: 31, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.261 Vali Acc: 0.267 Test Loss: 2.261 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1009669303894043
Epoch: 32, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.238 Vali Acc: 0.294 Test Loss: 2.238 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0411431789398193
Epoch: 33, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.226 Vali Acc: 0.322 Test Loss: 2.226 Test Acc: 0.322
Validation loss decreased (-0.299977 --> -0.322200).  Saving model ...
Epoch: 34 cost time: 1.0662128925323486
Epoch: 34, Steps: 12 | Train Loss: 2.089 Vali Loss: 2.252 Vali Acc: 0.283 Test Loss: 2.252 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0386362075805664
Epoch: 35, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.226 Vali Acc: 0.294 Test Loss: 2.226 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.049675464630127
Epoch: 36, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.230 Vali Acc: 0.272 Test Loss: 2.230 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9175963401794434
Epoch: 37, Steps: 12 | Train Loss: 2.107 Vali Loss: 2.240 Vali Acc: 0.267 Test Loss: 2.240 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9820437431335449
Epoch: 38, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.236 Vali Acc: 0.267 Test Loss: 2.236 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8895742893218994
Epoch: 39, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.232 Vali Acc: 0.278 Test Loss: 2.232 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9093015193939209
Epoch: 40, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.261 Vali Acc: 0.228 Test Loss: 2.261 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0404388904571533
Epoch: 41, Steps: 12 | Train Loss: 2.084 Vali Loss: 2.255 Vali Acc: 0.239 Test Loss: 2.255 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.129647970199585
Epoch: 42, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.228 Vali Acc: 0.250 Test Loss: 2.228 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9723200798034668
Epoch: 43, Steps: 12 | Train Loss: 2.087 Vali Loss: 2.246 Vali Acc: 0.222 Test Loss: 2.246 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.32222222222222224
model parameter : 193979
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.679564952850342
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.757 Vali Acc: 0.044 Test Loss: 2.757 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.947045087814331
Epoch: 2, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.732 Vali Acc: 0.039 Test Loss: 2.732 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7532413005828857
Epoch: 3, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.681 Vali Acc: 0.067 Test Loss: 2.681 Test Acc: 0.067
Validation loss decreased (-0.044417 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 0.786461353302002
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.659 Vali Acc: 0.106 Test Loss: 2.659 Test Acc: 0.106
Validation loss decreased (-0.066640 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 0.9546058177947998
Epoch: 5, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.626 Vali Acc: 0.117 Test Loss: 2.626 Test Acc: 0.117
Validation loss decreased (-0.105529 --> -0.116640).  Saving model ...
Epoch: 6 cost time: 0.996269702911377
Epoch: 6, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.608 Vali Acc: 0.128 Test Loss: 2.608 Test Acc: 0.128
Validation loss decreased (-0.116640 --> -0.127752).  Saving model ...
Epoch: 7 cost time: 1.0332677364349365
Epoch: 7, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.591 Vali Acc: 0.122 Test Loss: 2.591 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8739509582519531
Epoch: 8, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.528 Vali Acc: 0.200 Test Loss: 2.528 Test Acc: 0.200
Validation loss decreased (-0.127752 --> -0.199975).  Saving model ...
Epoch: 9 cost time: 0.824366569519043
Epoch: 9, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.523 Vali Acc: 0.189 Test Loss: 2.523 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8867702484130859
Epoch: 10, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.522 Vali Acc: 0.172 Test Loss: 2.522 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8922827243804932
Epoch: 11, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.517 Vali Acc: 0.161 Test Loss: 2.517 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7365763187408447
Epoch: 12, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.499 Vali Acc: 0.144 Test Loss: 2.499 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9604437351226807
Epoch: 13, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.477 Vali Acc: 0.183 Test Loss: 2.477 Test Acc: 0.183
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8568282127380371
Epoch: 14, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.502 Vali Acc: 0.156 Test Loss: 2.502 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9428849220275879
Epoch: 15, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.505 Vali Acc: 0.172 Test Loss: 2.505 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0837349891662598
Epoch: 16, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.480 Vali Acc: 0.200 Test Loss: 2.480 Test Acc: 0.200
Validation loss decreased (-0.199975 --> -0.199975).  Saving model ...
Epoch: 17 cost time: 1.040102481842041
Epoch: 17, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.500 Vali Acc: 0.172 Test Loss: 2.500 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7746274471282959
Epoch: 18, Steps: 12 | Train Loss: 2.436 Vali Loss: 2.491 Vali Acc: 0.161 Test Loss: 2.491 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8624887466430664
Epoch: 19, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.469 Vali Acc: 0.156 Test Loss: 2.469 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3519251346588135
Epoch: 20, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.419 Vali Acc: 0.167 Test Loss: 2.419 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9668328762054443
Epoch: 21, Steps: 12 | Train Loss: 2.366 Vali Loss: 2.416 Vali Acc: 0.183 Test Loss: 2.416 Test Acc: 0.183
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.930030345916748
Epoch: 22, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.412 Vali Acc: 0.206 Test Loss: 2.412 Test Acc: 0.206
Validation loss decreased (-0.199975 --> -0.205531).  Saving model ...
Epoch: 23 cost time: 0.9218771457672119
Epoch: 23, Steps: 12 | Train Loss: 2.317 Vali Loss: 2.408 Vali Acc: 0.167 Test Loss: 2.408 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9448928833007812
Epoch: 24, Steps: 12 | Train Loss: 2.327 Vali Loss: 2.377 Vali Acc: 0.206 Test Loss: 2.377 Test Acc: 0.206
Validation loss decreased (-0.205531 --> -0.205532).  Saving model ...
Epoch: 25 cost time: 0.8442823886871338
Epoch: 25, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.334 Vali Acc: 0.244 Test Loss: 2.334 Test Acc: 0.244
Validation loss decreased (-0.205532 --> -0.244421).  Saving model ...
Epoch: 26 cost time: 1.1600947380065918
Epoch: 26, Steps: 12 | Train Loss: 2.302 Vali Loss: 2.320 Vali Acc: 0.261 Test Loss: 2.320 Test Acc: 0.261
Validation loss decreased (-0.244421 --> -0.261088).  Saving model ...
Epoch: 27 cost time: 0.975337028503418
Epoch: 27, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.336 Vali Acc: 0.233 Test Loss: 2.336 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0611896514892578
Epoch: 28, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.308 Vali Acc: 0.244 Test Loss: 2.308 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9665422439575195
Epoch: 29, Steps: 12 | Train Loss: 2.223 Vali Loss: 2.303 Vali Acc: 0.256 Test Loss: 2.303 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9196701049804688
Epoch: 30, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.283 Vali Acc: 0.233 Test Loss: 2.283 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9309277534484863
Epoch: 31, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.287 Vali Acc: 0.233 Test Loss: 2.287 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9965424537658691
Epoch: 32, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.269 Vali Acc: 0.239 Test Loss: 2.269 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9650974273681641
Epoch: 33, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.262 Vali Acc: 0.250 Test Loss: 2.262 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2839574813842773
Epoch: 34, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.269 Vali Acc: 0.256 Test Loss: 2.269 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8411169052124023
Epoch: 35, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.244 Vali Acc: 0.239 Test Loss: 2.244 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8742642402648926
Epoch: 36, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.255 Vali Acc: 0.239 Test Loss: 2.255 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2611111111111111
model parameter : 191931
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.564567804336548
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.648 Vali Acc: 0.072 Test Loss: 2.648 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 0.9007110595703125
Epoch: 2, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.640 Vali Acc: 0.094 Test Loss: 2.640 Test Acc: 0.094
Validation loss decreased (-0.072196 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 0.9583418369293213
Epoch: 3, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.611 Vali Acc: 0.100 Test Loss: 2.611 Test Acc: 0.100
Validation loss decreased (-0.094418 --> -0.099974).  Saving model ...
Epoch: 4 cost time: 0.8779458999633789
Epoch: 4, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.586 Vali Acc: 0.150 Test Loss: 2.586 Test Acc: 0.150
Validation loss decreased (-0.099974 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 0.9240763187408447
Epoch: 5, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.574 Vali Acc: 0.156 Test Loss: 2.574 Test Acc: 0.156
Validation loss decreased (-0.149974 --> -0.155530).  Saving model ...
Epoch: 6 cost time: 1.0753414630889893
Epoch: 6, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.543 Vali Acc: 0.128 Test Loss: 2.543 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8317828178405762
Epoch: 7, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.550 Vali Acc: 0.094 Test Loss: 2.550 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.055910587310791
Epoch: 8, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.535 Vali Acc: 0.139 Test Loss: 2.535 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0801382064819336
Epoch: 9, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.542 Vali Acc: 0.100 Test Loss: 2.542 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0584828853607178
Epoch: 10, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.523 Vali Acc: 0.117 Test Loss: 2.523 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9222073554992676
Epoch: 11, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.532 Vali Acc: 0.133 Test Loss: 2.532 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0811691284179688
Epoch: 12, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.572 Vali Acc: 0.100 Test Loss: 2.572 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.063776969909668
Epoch: 13, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.565 Vali Acc: 0.111 Test Loss: 2.565 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8238506317138672
Epoch: 14, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.519 Vali Acc: 0.133 Test Loss: 2.519 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1415278911590576
Epoch: 15, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.507 Vali Acc: 0.161 Test Loss: 2.507 Test Acc: 0.161
Validation loss decreased (-0.155530 --> -0.161086).  Saving model ...
Epoch: 16 cost time: 0.9898614883422852
Epoch: 16, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.482 Vali Acc: 0.161 Test Loss: 2.482 Test Acc: 0.161
Validation loss decreased (-0.161086 --> -0.161086).  Saving model ...
Epoch: 17 cost time: 0.9359424114227295
Epoch: 17, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.454 Vali Acc: 0.178 Test Loss: 2.454 Test Acc: 0.178
Validation loss decreased (-0.161086 --> -0.177753).  Saving model ...
Epoch: 18 cost time: 0.8356702327728271
Epoch: 18, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.411 Vali Acc: 0.172 Test Loss: 2.411 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1080145835876465
Epoch: 19, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.393 Vali Acc: 0.200 Test Loss: 2.393 Test Acc: 0.200
Validation loss decreased (-0.177753 --> -0.199976).  Saving model ...
Epoch: 20 cost time: 0.8395195007324219
Epoch: 20, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.389 Vali Acc: 0.211 Test Loss: 2.389 Test Acc: 0.211
Validation loss decreased (-0.199976 --> -0.211087).  Saving model ...
Epoch: 21 cost time: 0.831378698348999
Epoch: 21, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.402 Vali Acc: 0.200 Test Loss: 2.402 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.988616943359375
Epoch: 22, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.371 Vali Acc: 0.222 Test Loss: 2.371 Test Acc: 0.222
Validation loss decreased (-0.211087 --> -0.222199).  Saving model ...
Epoch: 23 cost time: 0.8301165103912354
Epoch: 23, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.355 Vali Acc: 0.200 Test Loss: 2.355 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8079538345336914
Epoch: 24, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.332 Vali Acc: 0.206 Test Loss: 2.332 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9178147315979004
Epoch: 25, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.322 Vali Acc: 0.222 Test Loss: 2.322 Test Acc: 0.222
Validation loss decreased (-0.222199 --> -0.222199).  Saving model ...
Epoch: 26 cost time: 1.0739288330078125
Epoch: 26, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.323 Vali Acc: 0.267 Test Loss: 2.323 Test Acc: 0.267
Validation loss decreased (-0.222199 --> -0.266643).  Saving model ...
Epoch: 27 cost time: 0.9431042671203613
Epoch: 27, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.308 Vali Acc: 0.256 Test Loss: 2.308 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.032527208328247
Epoch: 28, Steps: 12 | Train Loss: 2.176 Vali Loss: 2.311 Vali Acc: 0.228 Test Loss: 2.311 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8060030937194824
Epoch: 29, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.314 Vali Acc: 0.222 Test Loss: 2.314 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8154728412628174
Epoch: 30, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.300 Vali Acc: 0.256 Test Loss: 2.300 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.867943286895752
Epoch: 31, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.281 Vali Acc: 0.256 Test Loss: 2.281 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.927945613861084
Epoch: 32, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.280 Vali Acc: 0.256 Test Loss: 2.280 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.873924732208252
Epoch: 33, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.293 Vali Acc: 0.217 Test Loss: 2.293 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.77890944480896
Epoch: 34, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.283 Vali Acc: 0.211 Test Loss: 2.283 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8171019554138184
Epoch: 35, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.270 Vali Acc: 0.228 Test Loss: 2.270 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7589402198791504
Epoch: 36, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.255 Vali Acc: 0.256 Test Loss: 2.255 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.26666666666666666
model parameter : 189883
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.522454023361206
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.703 Vali Acc: 0.117 Test Loss: 2.703 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.8874449729919434
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.695 Vali Acc: 0.089 Test Loss: 2.695 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8098821640014648
Epoch: 3, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.646 Vali Acc: 0.106 Test Loss: 2.646 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9006335735321045
Epoch: 4, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.595 Vali Acc: 0.139 Test Loss: 2.595 Test Acc: 0.139
Validation loss decreased (-0.116640 --> -0.138863).  Saving model ...
Epoch: 5 cost time: 0.9542446136474609
Epoch: 5, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.555 Vali Acc: 0.189 Test Loss: 2.555 Test Acc: 0.189
Validation loss decreased (-0.138863 --> -0.188863).  Saving model ...
Epoch: 6 cost time: 0.9418604373931885
Epoch: 6, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.557 Vali Acc: 0.178 Test Loss: 2.557 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8453671932220459
Epoch: 7, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.564 Vali Acc: 0.167 Test Loss: 2.564 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7613730430603027
Epoch: 8, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.555 Vali Acc: 0.156 Test Loss: 2.555 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.790306806564331
Epoch: 9, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.526 Vali Acc: 0.194 Test Loss: 2.526 Test Acc: 0.194
Validation loss decreased (-0.188863 --> -0.194419).  Saving model ...
Epoch: 10 cost time: 0.8329684734344482
Epoch: 10, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.501 Vali Acc: 0.233 Test Loss: 2.501 Test Acc: 0.233
Validation loss decreased (-0.194419 --> -0.233308).  Saving model ...
Epoch: 11 cost time: 0.7446606159210205
Epoch: 11, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.452 Vali Acc: 0.239 Test Loss: 2.452 Test Acc: 0.239
Validation loss decreased (-0.233308 --> -0.238864).  Saving model ...
Epoch: 12 cost time: 0.9532959461212158
Epoch: 12, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.451 Vali Acc: 0.189 Test Loss: 2.451 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.865257740020752
Epoch: 13, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.454 Vali Acc: 0.217 Test Loss: 2.454 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8689305782318115
Epoch: 14, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.445 Vali Acc: 0.206 Test Loss: 2.445 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9240455627441406
Epoch: 15, Steps: 12 | Train Loss: 2.321 Vali Loss: 2.427 Vali Acc: 0.189 Test Loss: 2.427 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8347809314727783
Epoch: 16, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.411 Vali Acc: 0.194 Test Loss: 2.411 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0870842933654785
Epoch: 17, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.392 Vali Acc: 0.222 Test Loss: 2.392 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7380399703979492
Epoch: 18, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.380 Vali Acc: 0.228 Test Loss: 2.380 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8520891666412354
Epoch: 19, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.347 Vali Acc: 0.244 Test Loss: 2.347 Test Acc: 0.244
Validation loss decreased (-0.238864 --> -0.244421).  Saving model ...
Epoch: 20 cost time: 1.0610992908477783
Epoch: 20, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.334 Vali Acc: 0.267 Test Loss: 2.334 Test Acc: 0.267
Validation loss decreased (-0.244421 --> -0.266643).  Saving model ...
Epoch: 21 cost time: 0.9732224941253662
Epoch: 21, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.313 Vali Acc: 0.256 Test Loss: 2.313 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8989574909210205
Epoch: 22, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.324 Vali Acc: 0.278 Test Loss: 2.324 Test Acc: 0.278
Validation loss decreased (-0.266643 --> -0.277755).  Saving model ...
Epoch: 23 cost time: 0.7804925441741943
Epoch: 23, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.305 Vali Acc: 0.272 Test Loss: 2.305 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9086649417877197
Epoch: 24, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.276 Vali Acc: 0.294 Test Loss: 2.276 Test Acc: 0.294
Validation loss decreased (-0.277755 --> -0.294422).  Saving model ...
Epoch: 25 cost time: 0.879805326461792
Epoch: 25, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.278 Vali Acc: 0.278 Test Loss: 2.278 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9708735942840576
Epoch: 26, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.260 Vali Acc: 0.278 Test Loss: 2.260 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9822216033935547
Epoch: 27, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.238 Vali Acc: 0.283 Test Loss: 2.238 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9741020202636719
Epoch: 28, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.238 Vali Acc: 0.289 Test Loss: 2.238 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7885222434997559
Epoch: 29, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.247 Vali Acc: 0.294 Test Loss: 2.247 Test Acc: 0.294
Validation loss decreased (-0.294422 --> -0.294422).  Saving model ...
Epoch: 30 cost time: 0.7865936756134033
Epoch: 30, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.242 Vali Acc: 0.278 Test Loss: 2.242 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9173867702484131
Epoch: 31, Steps: 12 | Train Loss: 2.059 Vali Loss: 2.216 Vali Acc: 0.322 Test Loss: 2.216 Test Acc: 0.322
Validation loss decreased (-0.294422 --> -0.322200).  Saving model ...
Epoch: 32 cost time: 0.9266445636749268
Epoch: 32, Steps: 12 | Train Loss: 2.046 Vali Loss: 2.187 Vali Acc: 0.328 Test Loss: 2.187 Test Acc: 0.328
Validation loss decreased (-0.322200 --> -0.327756).  Saving model ...
Epoch: 33 cost time: 0.8587977886199951
Epoch: 33, Steps: 12 | Train Loss: 2.029 Vali Loss: 2.186 Vali Acc: 0.272 Test Loss: 2.186 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1555149555206299
Epoch: 34, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.211 Vali Acc: 0.239 Test Loss: 2.211 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7957556247711182
Epoch: 35, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.197 Vali Acc: 0.267 Test Loss: 2.197 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7892582416534424
Epoch: 36, Steps: 12 | Train Loss: 2.006 Vali Loss: 2.195 Vali Acc: 0.278 Test Loss: 2.195 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9168915748596191
Epoch: 37, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.201 Vali Acc: 0.306 Test Loss: 2.201 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8055615425109863
Epoch: 38, Steps: 12 | Train Loss: 1.985 Vali Loss: 2.203 Vali Acc: 0.272 Test Loss: 2.203 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7624921798706055
Epoch: 39, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.192 Vali Acc: 0.256 Test Loss: 2.192 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7499558925628662
Epoch: 40, Steps: 12 | Train Loss: 1.977 Vali Loss: 2.179 Vali Acc: 0.294 Test Loss: 2.179 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8621273040771484
Epoch: 41, Steps: 12 | Train Loss: 1.969 Vali Loss: 2.201 Vali Acc: 0.289 Test Loss: 2.201 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8453030586242676
Epoch: 42, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.175 Vali Acc: 0.306 Test Loss: 2.175 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3277777777777778
model parameter : 187835
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.320556640625
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.703 Vali Acc: 0.117 Test Loss: 2.703 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.7852997779846191
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.695 Vali Acc: 0.089 Test Loss: 2.695 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7411465644836426
Epoch: 3, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.646 Vali Acc: 0.106 Test Loss: 2.646 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9727449417114258
Epoch: 4, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.595 Vali Acc: 0.139 Test Loss: 2.595 Test Acc: 0.139
Validation loss decreased (-0.116640 --> -0.138863).  Saving model ...
Epoch: 5 cost time: 0.6990466117858887
Epoch: 5, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.555 Vali Acc: 0.189 Test Loss: 2.555 Test Acc: 0.189
Validation loss decreased (-0.138863 --> -0.188863).  Saving model ...
Epoch: 6 cost time: 0.9955379962921143
Epoch: 6, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.557 Vali Acc: 0.178 Test Loss: 2.557 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8502016067504883
Epoch: 7, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.564 Vali Acc: 0.167 Test Loss: 2.564 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2285475730895996
Epoch: 8, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.555 Vali Acc: 0.156 Test Loss: 2.555 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9449350833892822
Epoch: 9, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.526 Vali Acc: 0.194 Test Loss: 2.526 Test Acc: 0.194
Validation loss decreased (-0.188863 --> -0.194419).  Saving model ...
Epoch: 10 cost time: 0.8219645023345947
Epoch: 10, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.501 Vali Acc: 0.233 Test Loss: 2.501 Test Acc: 0.233
Validation loss decreased (-0.194419 --> -0.233308).  Saving model ...
Epoch: 11 cost time: 0.7198116779327393
Epoch: 11, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.452 Vali Acc: 0.239 Test Loss: 2.452 Test Acc: 0.239
Validation loss decreased (-0.233308 --> -0.238864).  Saving model ...
Epoch: 12 cost time: 0.9425852298736572
Epoch: 12, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.451 Vali Acc: 0.189 Test Loss: 2.451 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9478421211242676
Epoch: 13, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.454 Vali Acc: 0.217 Test Loss: 2.454 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9951701164245605
Epoch: 14, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.445 Vali Acc: 0.206 Test Loss: 2.445 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8135418891906738
Epoch: 15, Steps: 12 | Train Loss: 2.321 Vali Loss: 2.427 Vali Acc: 0.189 Test Loss: 2.427 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7845408916473389
Epoch: 16, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.411 Vali Acc: 0.194 Test Loss: 2.411 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8029725551605225
Epoch: 17, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.392 Vali Acc: 0.222 Test Loss: 2.392 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7473833560943604
Epoch: 18, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.380 Vali Acc: 0.228 Test Loss: 2.380 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7882289886474609
Epoch: 19, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.347 Vali Acc: 0.244 Test Loss: 2.347 Test Acc: 0.244
Validation loss decreased (-0.238864 --> -0.244421).  Saving model ...
Epoch: 20 cost time: 0.9075720310211182
Epoch: 20, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.334 Vali Acc: 0.267 Test Loss: 2.334 Test Acc: 0.267
Validation loss decreased (-0.244421 --> -0.266643).  Saving model ...
Epoch: 21 cost time: 0.8078298568725586
Epoch: 21, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.313 Vali Acc: 0.256 Test Loss: 2.313 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9394230842590332
Epoch: 22, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.324 Vali Acc: 0.278 Test Loss: 2.324 Test Acc: 0.278
Validation loss decreased (-0.266643 --> -0.277755).  Saving model ...
Epoch: 23 cost time: 0.83573317527771
Epoch: 23, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.305 Vali Acc: 0.272 Test Loss: 2.305 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7482278347015381
Epoch: 24, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.276 Vali Acc: 0.294 Test Loss: 2.276 Test Acc: 0.294
Validation loss decreased (-0.277755 --> -0.294422).  Saving model ...
Epoch: 25 cost time: 0.9483613967895508
Epoch: 25, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.278 Vali Acc: 0.278 Test Loss: 2.278 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7693154811859131
Epoch: 26, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.260 Vali Acc: 0.278 Test Loss: 2.260 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1156370639801025
Epoch: 27, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.238 Vali Acc: 0.283 Test Loss: 2.238 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0610322952270508
Epoch: 28, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.238 Vali Acc: 0.289 Test Loss: 2.238 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1161341667175293
Epoch: 29, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.247 Vali Acc: 0.294 Test Loss: 2.247 Test Acc: 0.294
Validation loss decreased (-0.294422 --> -0.294422).  Saving model ...
Epoch: 30 cost time: 0.7225313186645508
Epoch: 30, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.242 Vali Acc: 0.278 Test Loss: 2.242 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7126405239105225
Epoch: 31, Steps: 12 | Train Loss: 2.059 Vali Loss: 2.216 Vali Acc: 0.322 Test Loss: 2.216 Test Acc: 0.322
Validation loss decreased (-0.294422 --> -0.322200).  Saving model ...
Epoch: 32 cost time: 0.9617371559143066
Epoch: 32, Steps: 12 | Train Loss: 2.046 Vali Loss: 2.187 Vali Acc: 0.328 Test Loss: 2.187 Test Acc: 0.328
Validation loss decreased (-0.322200 --> -0.327756).  Saving model ...
Epoch: 33 cost time: 0.7667820453643799
Epoch: 33, Steps: 12 | Train Loss: 2.029 Vali Loss: 2.186 Vali Acc: 0.272 Test Loss: 2.186 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.841242790222168
Epoch: 34, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.211 Vali Acc: 0.239 Test Loss: 2.211 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7614955902099609
Epoch: 35, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.197 Vali Acc: 0.267 Test Loss: 2.197 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8791294097900391
Epoch: 36, Steps: 12 | Train Loss: 2.006 Vali Loss: 2.195 Vali Acc: 0.278 Test Loss: 2.195 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.113736629486084
Epoch: 37, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.201 Vali Acc: 0.306 Test Loss: 2.201 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7992556095123291
Epoch: 38, Steps: 12 | Train Loss: 1.985 Vali Loss: 2.203 Vali Acc: 0.272 Test Loss: 2.203 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.070197343826294
Epoch: 39, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.192 Vali Acc: 0.256 Test Loss: 2.192 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7664225101470947
Epoch: 40, Steps: 12 | Train Loss: 1.977 Vali Loss: 2.179 Vali Acc: 0.294 Test Loss: 2.179 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9295816421508789
Epoch: 41, Steps: 12 | Train Loss: 1.969 Vali Loss: 2.201 Vali Acc: 0.289 Test Loss: 2.201 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9512250423431396
Epoch: 42, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.175 Vali Acc: 0.306 Test Loss: 2.175 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3277777777777778
model parameter : 187835
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9757330417633057
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.840 Vali Acc: 0.044 Test Loss: 2.840 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 1.1957283020019531
Epoch: 2, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.802 Vali Acc: 0.067 Test Loss: 2.802 Test Acc: 0.067
Validation loss decreased (-0.044416 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 1.1649279594421387
Epoch: 3, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.781 Vali Acc: 0.056 Test Loss: 2.781 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4222214221954346
Epoch: 4, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.762 Vali Acc: 0.078 Test Loss: 2.762 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077750).  Saving model ...
Epoch: 5 cost time: 1.0724384784698486
Epoch: 5, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.746 Vali Acc: 0.072 Test Loss: 2.746 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0613255500793457
Epoch: 6, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.728 Vali Acc: 0.083 Test Loss: 2.728 Test Acc: 0.083
Validation loss decreased (-0.077750 --> -0.083306).  Saving model ...
Epoch: 7 cost time: 0.8222718238830566
Epoch: 7, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.706 Vali Acc: 0.089 Test Loss: 2.706 Test Acc: 0.089
Validation loss decreased (-0.083306 --> -0.088862).  Saving model ...
Epoch: 8 cost time: 0.9298925399780273
Epoch: 8, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.704 Vali Acc: 0.094 Test Loss: 2.704 Test Acc: 0.094
Validation loss decreased (-0.088862 --> -0.094417).  Saving model ...
Epoch: 9 cost time: 0.9141404628753662
Epoch: 9, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.677 Vali Acc: 0.117 Test Loss: 2.677 Test Acc: 0.117
Validation loss decreased (-0.094417 --> -0.116640).  Saving model ...
Epoch: 10 cost time: 1.0067837238311768
Epoch: 10, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.682 Vali Acc: 0.111 Test Loss: 2.682 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0731868743896484
Epoch: 11, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.673 Vali Acc: 0.100 Test Loss: 2.673 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1308820247650146
Epoch: 12, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.653 Vali Acc: 0.122 Test Loss: 2.653 Test Acc: 0.122
Validation loss decreased (-0.116640 --> -0.122196).  Saving model ...
Epoch: 13 cost time: 0.9830596446990967
Epoch: 13, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.616 Vali Acc: 0.156 Test Loss: 2.616 Test Acc: 0.156
Validation loss decreased (-0.122196 --> -0.155529).  Saving model ...
Epoch: 14 cost time: 1.5232791900634766
Epoch: 14, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.606 Vali Acc: 0.156 Test Loss: 2.606 Test Acc: 0.156
Validation loss decreased (-0.155529 --> -0.155529).  Saving model ...
Epoch: 15 cost time: 1.3085803985595703
Epoch: 15, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.594 Vali Acc: 0.189 Test Loss: 2.594 Test Acc: 0.189
Validation loss decreased (-0.155529 --> -0.188863).  Saving model ...
Epoch: 16 cost time: 1.026792287826538
Epoch: 16, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.588 Vali Acc: 0.150 Test Loss: 2.588 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.11275315284729
Epoch: 17, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.574 Vali Acc: 0.167 Test Loss: 2.574 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4372389316558838
Epoch: 18, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.549 Vali Acc: 0.172 Test Loss: 2.549 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5417604446411133
Epoch: 19, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.539 Vali Acc: 0.189 Test Loss: 2.539 Test Acc: 0.189
Validation loss decreased (-0.188863 --> -0.188863).  Saving model ...
Epoch: 20 cost time: 1.2470130920410156
Epoch: 20, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.503 Vali Acc: 0.211 Test Loss: 2.503 Test Acc: 0.211
Validation loss decreased (-0.188863 --> -0.211086).  Saving model ...
Epoch: 21 cost time: 1.4753532409667969
Epoch: 21, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.498 Vali Acc: 0.211 Test Loss: 2.498 Test Acc: 0.211
Validation loss decreased (-0.211086 --> -0.211086).  Saving model ...
Epoch: 22 cost time: 1.159080982208252
Epoch: 22, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.475 Vali Acc: 0.228 Test Loss: 2.475 Test Acc: 0.228
Validation loss decreased (-0.211086 --> -0.227753).  Saving model ...
Epoch: 23 cost time: 1.1694080829620361
Epoch: 23, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.456 Vali Acc: 0.233 Test Loss: 2.456 Test Acc: 0.233
Validation loss decreased (-0.227753 --> -0.233309).  Saving model ...
Epoch: 24 cost time: 1.234243392944336
Epoch: 24, Steps: 12 | Train Loss: 2.314 Vali Loss: 2.418 Vali Acc: 0.222 Test Loss: 2.418 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1775267124176025
Epoch: 25, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.397 Vali Acc: 0.239 Test Loss: 2.397 Test Acc: 0.239
Validation loss decreased (-0.233309 --> -0.238865).  Saving model ...
Epoch: 26 cost time: 1.2775754928588867
Epoch: 26, Steps: 12 | Train Loss: 2.265 Vali Loss: 2.383 Vali Acc: 0.228 Test Loss: 2.383 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2909891605377197
Epoch: 27, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.357 Vali Acc: 0.261 Test Loss: 2.357 Test Acc: 0.261
Validation loss decreased (-0.238865 --> -0.261088).  Saving model ...
Epoch: 28 cost time: 1.0588281154632568
Epoch: 28, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.367 Vali Acc: 0.222 Test Loss: 2.367 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9468739032745361
Epoch: 29, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.349 Vali Acc: 0.211 Test Loss: 2.349 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2609288692474365
Epoch: 30, Steps: 12 | Train Loss: 2.173 Vali Loss: 2.338 Vali Acc: 0.239 Test Loss: 2.338 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4690778255462646
Epoch: 31, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.321 Vali Acc: 0.239 Test Loss: 2.321 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.238861322402954
Epoch: 32, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.308 Vali Acc: 0.250 Test Loss: 2.308 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9958486557006836
Epoch: 33, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.299 Vali Acc: 0.239 Test Loss: 2.299 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1794507503509521
Epoch: 34, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.282 Vali Acc: 0.233 Test Loss: 2.282 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3963885307312012
Epoch: 35, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.262 Vali Acc: 0.233 Test Loss: 2.262 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1342527866363525
Epoch: 36, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.273 Vali Acc: 0.233 Test Loss: 2.273 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1818265914916992
Epoch: 37, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.243 Vali Acc: 0.256 Test Loss: 2.243 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2611111111111111
model parameter : 99771
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.479222297668457
Epoch: 1, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.754 Vali Acc: 0.128 Test Loss: 2.754 Test Acc: 0.128
Validation loss decreased (inf --> -0.127750).  Saving model ...
Epoch: 2 cost time: 1.1025657653808594
Epoch: 2, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.725 Vali Acc: 0.106 Test Loss: 2.725 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9466862678527832
Epoch: 3, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.701 Vali Acc: 0.106 Test Loss: 2.701 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9924495220184326
Epoch: 4, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.685 Vali Acc: 0.111 Test Loss: 2.685 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0982625484466553
Epoch: 5, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.667 Vali Acc: 0.128 Test Loss: 2.667 Test Acc: 0.128
Validation loss decreased (-0.127750 --> -0.127751).  Saving model ...
Epoch: 6 cost time: 0.9442703723907471
Epoch: 6, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.646 Vali Acc: 0.128 Test Loss: 2.646 Test Acc: 0.128
Validation loss decreased (-0.127751 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.1095170974731445
Epoch: 7, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.611 Vali Acc: 0.139 Test Loss: 2.611 Test Acc: 0.139
Validation loss decreased (-0.127751 --> -0.138863).  Saving model ...
Epoch: 8 cost time: 0.8725533485412598
Epoch: 8, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.607 Vali Acc: 0.139 Test Loss: 2.607 Test Acc: 0.139
Validation loss decreased (-0.138863 --> -0.138863).  Saving model ...
Epoch: 9 cost time: 1.0204675197601318
Epoch: 9, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.595 Vali Acc: 0.156 Test Loss: 2.595 Test Acc: 0.156
Validation loss decreased (-0.138863 --> -0.155530).  Saving model ...
Epoch: 10 cost time: 0.9819645881652832
Epoch: 10, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.583 Vali Acc: 0.189 Test Loss: 2.583 Test Acc: 0.189
Validation loss decreased (-0.155530 --> -0.188863).  Saving model ...
Epoch: 11 cost time: 1.022796392440796
Epoch: 11, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.575 Vali Acc: 0.183 Test Loss: 2.575 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.339031457901001
Epoch: 12, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.551 Vali Acc: 0.183 Test Loss: 2.551 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1280221939086914
Epoch: 13, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.525 Vali Acc: 0.183 Test Loss: 2.525 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1090490818023682
Epoch: 14, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.506 Vali Acc: 0.178 Test Loss: 2.506 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3686707019805908
Epoch: 15, Steps: 12 | Train Loss: 2.390 Vali Loss: 2.513 Vali Acc: 0.144 Test Loss: 2.513 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2283096313476562
Epoch: 16, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.507 Vali Acc: 0.183 Test Loss: 2.507 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.106602668762207
Epoch: 17, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.511 Vali Acc: 0.172 Test Loss: 2.511 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0245647430419922
Epoch: 18, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.486 Vali Acc: 0.183 Test Loss: 2.486 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2603261470794678
Epoch: 19, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.476 Vali Acc: 0.161 Test Loss: 2.476 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0180449485778809
Epoch: 20, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.460 Vali Acc: 0.161 Test Loss: 2.460 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.18888888888888888
model parameter : 98747
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9489409923553467
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.744 Vali Acc: 0.122 Test Loss: 2.744 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 1.0791041851043701
Epoch: 2, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.727 Vali Acc: 0.106 Test Loss: 2.727 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9591832160949707
Epoch: 3, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.709 Vali Acc: 0.133 Test Loss: 2.709 Test Acc: 0.133
Validation loss decreased (-0.122195 --> -0.133306).  Saving model ...
Epoch: 4 cost time: 0.9873888492584229
Epoch: 4, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.690 Vali Acc: 0.133 Test Loss: 2.690 Test Acc: 0.133
Validation loss decreased (-0.133306 --> -0.133306).  Saving model ...
Epoch: 5 cost time: 0.9592766761779785
Epoch: 5, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.649 Vali Acc: 0.172 Test Loss: 2.649 Test Acc: 0.172
Validation loss decreased (-0.133306 --> -0.172196).  Saving model ...
Epoch: 6 cost time: 1.0793635845184326
Epoch: 6, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.653 Vali Acc: 0.144 Test Loss: 2.653 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1575934886932373
Epoch: 7, Steps: 12 | Train Loss: 2.546 Vali Loss: 2.610 Vali Acc: 0.156 Test Loss: 2.610 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0516068935394287
Epoch: 8, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.578 Vali Acc: 0.189 Test Loss: 2.578 Test Acc: 0.189
Validation loss decreased (-0.172196 --> -0.188863).  Saving model ...
Epoch: 9 cost time: 1.1460938453674316
Epoch: 9, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.569 Vali Acc: 0.194 Test Loss: 2.569 Test Acc: 0.194
Validation loss decreased (-0.188863 --> -0.194419).  Saving model ...
Epoch: 10 cost time: 1.088257074356079
Epoch: 10, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.543 Vali Acc: 0.178 Test Loss: 2.543 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0145139694213867
Epoch: 11, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.526 Vali Acc: 0.211 Test Loss: 2.526 Test Acc: 0.211
Validation loss decreased (-0.194419 --> -0.211086).  Saving model ...
Epoch: 12 cost time: 0.8929929733276367
Epoch: 12, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.491 Vali Acc: 0.200 Test Loss: 2.491 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.411137580871582
Epoch: 13, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.491 Vali Acc: 0.206 Test Loss: 2.491 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2454125881195068
Epoch: 14, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.458 Vali Acc: 0.267 Test Loss: 2.458 Test Acc: 0.267
Validation loss decreased (-0.211086 --> -0.266642).  Saving model ...
Epoch: 15 cost time: 1.264801025390625
Epoch: 15, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.441 Vali Acc: 0.256 Test Loss: 2.441 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1676220893859863
Epoch: 16, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.428 Vali Acc: 0.233 Test Loss: 2.428 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9270086288452148
Epoch: 17, Steps: 12 | Train Loss: 2.302 Vali Loss: 2.404 Vali Acc: 0.222 Test Loss: 2.404 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1235911846160889
Epoch: 18, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.391 Vali Acc: 0.250 Test Loss: 2.391 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.122856855392456
Epoch: 19, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.384 Vali Acc: 0.206 Test Loss: 2.384 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8679854869842529
Epoch: 20, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.363 Vali Acc: 0.250 Test Loss: 2.363 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0837466716766357
Epoch: 21, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.343 Vali Acc: 0.300 Test Loss: 2.343 Test Acc: 0.300
Validation loss decreased (-0.266642 --> -0.299977).  Saving model ...
Epoch: 22 cost time: 0.9619243144989014
Epoch: 22, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.337 Vali Acc: 0.283 Test Loss: 2.337 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3373956680297852
Epoch: 23, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.343 Vali Acc: 0.283 Test Loss: 2.343 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0630242824554443
Epoch: 24, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.321 Vali Acc: 0.272 Test Loss: 2.321 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0840563774108887
Epoch: 25, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.336 Vali Acc: 0.261 Test Loss: 2.336 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1038572788238525
Epoch: 26, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.310 Vali Acc: 0.267 Test Loss: 2.310 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1433093547821045
Epoch: 27, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.289 Vali Acc: 0.256 Test Loss: 2.289 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1695351600646973
Epoch: 28, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.280 Vali Acc: 0.250 Test Loss: 2.280 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0449762344360352
Epoch: 29, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.264 Vali Acc: 0.250 Test Loss: 2.264 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8775849342346191
Epoch: 30, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.274 Vali Acc: 0.294 Test Loss: 2.274 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.002366304397583
Epoch: 31, Steps: 12 | Train Loss: 2.138 Vali Loss: 2.263 Vali Acc: 0.300 Test Loss: 2.263 Test Acc: 0.300
Validation loss decreased (-0.299977 --> -0.299977).  Saving model ...
Epoch: 32 cost time: 0.9703726768493652
Epoch: 32, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.257 Vali Acc: 0.228 Test Loss: 2.257 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0733721256256104
Epoch: 33, Steps: 12 | Train Loss: 2.059 Vali Loss: 2.228 Vali Acc: 0.261 Test Loss: 2.228 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8308165073394775
Epoch: 34, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.214 Vali Acc: 0.267 Test Loss: 2.214 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9224586486816406
Epoch: 35, Steps: 12 | Train Loss: 2.117 Vali Loss: 2.205 Vali Acc: 0.272 Test Loss: 2.205 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.949068546295166
Epoch: 36, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.208 Vali Acc: 0.317 Test Loss: 2.208 Test Acc: 0.317
Validation loss decreased (-0.299977 --> -0.316645).  Saving model ...
Epoch: 37 cost time: 1.1847054958343506
Epoch: 37, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.213 Vali Acc: 0.311 Test Loss: 2.213 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0091280937194824
Epoch: 38, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.206 Vali Acc: 0.294 Test Loss: 2.206 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0483975410461426
Epoch: 39, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.235 Vali Acc: 0.294 Test Loss: 2.235 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0313847064971924
Epoch: 40, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.221 Vali Acc: 0.328 Test Loss: 2.221 Test Acc: 0.328
Validation loss decreased (-0.316645 --> -0.327756).  Saving model ...
Epoch: 41 cost time: 1.0014185905456543
Epoch: 41, Steps: 12 | Train Loss: 2.063 Vali Loss: 2.219 Vali Acc: 0.317 Test Loss: 2.219 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0567121505737305
Epoch: 42, Steps: 12 | Train Loss: 2.000 Vali Loss: 2.204 Vali Acc: 0.322 Test Loss: 2.204 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1258845329284668
Epoch: 43, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.204 Vali Acc: 0.300 Test Loss: 2.204 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1406185626983643
Epoch: 44, Steps: 12 | Train Loss: 2.047 Vali Loss: 2.201 Vali Acc: 0.333 Test Loss: 2.201 Test Acc: 0.333
Validation loss decreased (-0.327756 --> -0.333311).  Saving model ...
Epoch: 45 cost time: 1.1693203449249268
Epoch: 45, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.174 Vali Acc: 0.317 Test Loss: 2.174 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0422146320343018
Epoch: 46, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.168 Vali Acc: 0.322 Test Loss: 2.168 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9971156120300293
Epoch: 47, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.203 Vali Acc: 0.306 Test Loss: 2.203 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.131453037261963
Epoch: 48, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.191 Vali Acc: 0.322 Test Loss: 2.191 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2022209167480469
Epoch: 49, Steps: 12 | Train Loss: 2.007 Vali Loss: 2.175 Vali Acc: 0.339 Test Loss: 2.175 Test Acc: 0.339
Validation loss decreased (-0.333311 --> -0.338867).  Saving model ...
Epoch: 50 cost time: 1.0878441333770752
Epoch: 50, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.145 Vali Acc: 0.344 Test Loss: 2.145 Test Acc: 0.344
Validation loss decreased (-0.338867 --> -0.344423).  Saving model ...
Epoch: 51 cost time: 1.2404389381408691
Epoch: 51, Steps: 12 | Train Loss: 2.027 Vali Loss: 2.132 Vali Acc: 0.317 Test Loss: 2.132 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2519612312316895
Epoch: 52, Steps: 12 | Train Loss: 1.983 Vali Loss: 2.126 Vali Acc: 0.300 Test Loss: 2.126 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.28597092628479
Epoch: 53, Steps: 12 | Train Loss: 1.982 Vali Loss: 2.134 Vali Acc: 0.278 Test Loss: 2.134 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0932302474975586
Epoch: 54, Steps: 12 | Train Loss: 1.927 Vali Loss: 2.132 Vali Acc: 0.328 Test Loss: 2.132 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1777067184448242
Epoch: 55, Steps: 12 | Train Loss: 1.944 Vali Loss: 2.146 Vali Acc: 0.300 Test Loss: 2.146 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9428143501281738
Epoch: 56, Steps: 12 | Train Loss: 1.952 Vali Loss: 2.173 Vali Acc: 0.278 Test Loss: 2.173 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2101378440856934
Epoch: 57, Steps: 12 | Train Loss: 1.901 Vali Loss: 2.182 Vali Acc: 0.294 Test Loss: 2.182 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1147820949554443
Epoch: 58, Steps: 12 | Train Loss: 1.952 Vali Loss: 2.149 Vali Acc: 0.317 Test Loss: 2.149 Test Acc: 0.317
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.9213788509368896
Epoch: 59, Steps: 12 | Train Loss: 1.938 Vali Loss: 2.113 Vali Acc: 0.339 Test Loss: 2.113 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1573700904846191
Epoch: 60, Steps: 12 | Train Loss: 1.902 Vali Loss: 2.109 Vali Acc: 0.328 Test Loss: 2.109 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.34444444444444444
model parameter : 97723
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.611438751220703
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.710 Vali Acc: 0.056 Test Loss: 2.710 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.976360559463501
Epoch: 2, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.685 Vali Acc: 0.072 Test Loss: 2.685 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 1.1090784072875977
Epoch: 3, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.644 Vali Acc: 0.150 Test Loss: 2.644 Test Acc: 0.150
Validation loss decreased (-0.072195 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 0.9284987449645996
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.636 Vali Acc: 0.156 Test Loss: 2.636 Test Acc: 0.156
Validation loss decreased (-0.149974 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 0.8828747272491455
Epoch: 5, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.626 Vali Acc: 0.167 Test Loss: 2.626 Test Acc: 0.167
Validation loss decreased (-0.155529 --> -0.166640).  Saving model ...
Epoch: 6 cost time: 1.150921106338501
Epoch: 6, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.600 Vali Acc: 0.139 Test Loss: 2.600 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1036090850830078
Epoch: 7, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.608 Vali Acc: 0.150 Test Loss: 2.608 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8918421268463135
Epoch: 8, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.621 Vali Acc: 0.106 Test Loss: 2.621 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0368621349334717
Epoch: 9, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.570 Vali Acc: 0.133 Test Loss: 2.570 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1136515140533447
Epoch: 10, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.557 Vali Acc: 0.122 Test Loss: 2.557 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9101078510284424
Epoch: 11, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.544 Vali Acc: 0.167 Test Loss: 2.544 Test Acc: 0.167
Validation loss decreased (-0.166640 --> -0.166641).  Saving model ...
Epoch: 12 cost time: 0.8886032104492188
Epoch: 12, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.532 Vali Acc: 0.156 Test Loss: 2.532 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9854824542999268
Epoch: 13, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.503 Vali Acc: 0.161 Test Loss: 2.503 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9381029605865479
Epoch: 14, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.511 Vali Acc: 0.194 Test Loss: 2.511 Test Acc: 0.194
Validation loss decreased (-0.166641 --> -0.194419).  Saving model ...
Epoch: 15 cost time: 0.8265185356140137
Epoch: 15, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.495 Vali Acc: 0.222 Test Loss: 2.495 Test Acc: 0.222
Validation loss decreased (-0.194419 --> -0.222197).  Saving model ...
Epoch: 16 cost time: 0.8049843311309814
Epoch: 16, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.483 Vali Acc: 0.194 Test Loss: 2.483 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8167269229888916
Epoch: 17, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.477 Vali Acc: 0.178 Test Loss: 2.477 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.000899076461792
Epoch: 18, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.480 Vali Acc: 0.189 Test Loss: 2.480 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9065895080566406
Epoch: 19, Steps: 12 | Train Loss: 2.328 Vali Loss: 2.466 Vali Acc: 0.194 Test Loss: 2.466 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.972480297088623
Epoch: 20, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.455 Vali Acc: 0.194 Test Loss: 2.455 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8981587886810303
Epoch: 21, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.432 Vali Acc: 0.189 Test Loss: 2.432 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9150071144104004
Epoch: 22, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.417 Vali Acc: 0.194 Test Loss: 2.417 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0357987880706787
Epoch: 23, Steps: 12 | Train Loss: 2.313 Vali Loss: 2.419 Vali Acc: 0.189 Test Loss: 2.419 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.006744384765625
Epoch: 24, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.442 Vali Acc: 0.189 Test Loss: 2.442 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.956047773361206
Epoch: 25, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.415 Vali Acc: 0.244 Test Loss: 2.415 Test Acc: 0.244
Validation loss decreased (-0.222197 --> -0.244420).  Saving model ...
Epoch: 26 cost time: 1.079108715057373
Epoch: 26, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.406 Vali Acc: 0.222 Test Loss: 2.406 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8859083652496338
Epoch: 27, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.375 Vali Acc: 0.256 Test Loss: 2.375 Test Acc: 0.256
Validation loss decreased (-0.244420 --> -0.255532).  Saving model ...
Epoch: 28 cost time: 0.8679604530334473
Epoch: 28, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.339 Vali Acc: 0.250 Test Loss: 2.339 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0234484672546387
Epoch: 29, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.323 Vali Acc: 0.267 Test Loss: 2.323 Test Acc: 0.267
Validation loss decreased (-0.255532 --> -0.266643).  Saving model ...
Epoch: 30 cost time: 1.031038761138916
Epoch: 30, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.305 Vali Acc: 0.206 Test Loss: 2.305 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0008721351623535
Epoch: 31, Steps: 12 | Train Loss: 2.106 Vali Loss: 2.288 Vali Acc: 0.244 Test Loss: 2.288 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0972275733947754
Epoch: 32, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.280 Vali Acc: 0.267 Test Loss: 2.280 Test Acc: 0.267
Validation loss decreased (-0.266643 --> -0.266644).  Saving model ...
Epoch: 33 cost time: 1.0992152690887451
Epoch: 33, Steps: 12 | Train Loss: 2.068 Vali Loss: 2.248 Vali Acc: 0.311 Test Loss: 2.248 Test Acc: 0.311
Validation loss decreased (-0.266644 --> -0.311089).  Saving model ...
Epoch: 34 cost time: 1.0169095993041992
Epoch: 34, Steps: 12 | Train Loss: 2.114 Vali Loss: 2.228 Vali Acc: 0.294 Test Loss: 2.228 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9170334339141846
Epoch: 35, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.210 Vali Acc: 0.333 Test Loss: 2.210 Test Acc: 0.333
Validation loss decreased (-0.311089 --> -0.333311).  Saving model ...
Epoch: 36 cost time: 1.0092227458953857
Epoch: 36, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.225 Vali Acc: 0.328 Test Loss: 2.225 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9534878730773926
Epoch: 37, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.214 Vali Acc: 0.317 Test Loss: 2.214 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9453122615814209
Epoch: 38, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.184 Vali Acc: 0.328 Test Loss: 2.184 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1980228424072266
Epoch: 39, Steps: 12 | Train Loss: 2.005 Vali Loss: 2.181 Vali Acc: 0.333 Test Loss: 2.181 Test Acc: 0.333
Validation loss decreased (-0.333311 --> -0.333312).  Saving model ...
Epoch: 40 cost time: 1.0573701858520508
Epoch: 40, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.202 Vali Acc: 0.283 Test Loss: 2.202 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4266104698181152
Epoch: 41, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.198 Vali Acc: 0.278 Test Loss: 2.198 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0284221172332764
Epoch: 42, Steps: 12 | Train Loss: 2.062 Vali Loss: 2.205 Vali Acc: 0.289 Test Loss: 2.205 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0079069137573242
Epoch: 43, Steps: 12 | Train Loss: 2.063 Vali Loss: 2.178 Vali Acc: 0.244 Test Loss: 2.178 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.130218505859375
Epoch: 44, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.175 Vali Acc: 0.244 Test Loss: 2.175 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0005836486816406
Epoch: 45, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.196 Vali Acc: 0.294 Test Loss: 2.196 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9306392669677734
Epoch: 46, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.182 Vali Acc: 0.317 Test Loss: 2.182 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.195460557937622
Epoch: 47, Steps: 12 | Train Loss: 2.016 Vali Loss: 2.166 Vali Acc: 0.317 Test Loss: 2.166 Test Acc: 0.317
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0383644104003906
Epoch: 48, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.131 Vali Acc: 0.328 Test Loss: 2.131 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1360149383544922
Epoch: 49, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.117 Vali Acc: 0.322 Test Loss: 2.117 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3333333333333333
model parameter : 96699
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.215717077255249
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.668 Vali Acc: 0.106 Test Loss: 2.668 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.1491782665252686
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.676 Vali Acc: 0.111 Test Loss: 2.676 Test Acc: 0.111
Validation loss decreased (-0.105529 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.0073707103729248
Epoch: 3, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.653 Vali Acc: 0.117 Test Loss: 2.653 Test Acc: 0.117
Validation loss decreased (-0.111084 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.0071313381195068
Epoch: 4, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.632 Vali Acc: 0.156 Test Loss: 2.632 Test Acc: 0.156
Validation loss decreased (-0.116640 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 1.1382017135620117
Epoch: 5, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.612 Vali Acc: 0.144 Test Loss: 2.612 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0093274116516113
Epoch: 6, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.590 Vali Acc: 0.139 Test Loss: 2.590 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2482290267944336
Epoch: 7, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.550 Vali Acc: 0.200 Test Loss: 2.550 Test Acc: 0.200
Validation loss decreased (-0.155529 --> -0.199974).  Saving model ...
Epoch: 8 cost time: 1.0239713191986084
Epoch: 8, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.510 Vali Acc: 0.183 Test Loss: 2.510 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8318779468536377
Epoch: 9, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.473 Vali Acc: 0.206 Test Loss: 2.473 Test Acc: 0.206
Validation loss decreased (-0.199974 --> -0.205531).  Saving model ...
Epoch: 10 cost time: 1.1671323776245117
Epoch: 10, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.457 Vali Acc: 0.183 Test Loss: 2.457 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.064720869064331
Epoch: 11, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.442 Vali Acc: 0.233 Test Loss: 2.442 Test Acc: 0.233
Validation loss decreased (-0.205531 --> -0.233309).  Saving model ...
Epoch: 12 cost time: 1.1299002170562744
Epoch: 12, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.443 Vali Acc: 0.233 Test Loss: 2.443 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.053720235824585
Epoch: 13, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.422 Vali Acc: 0.217 Test Loss: 2.422 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9574482440948486
Epoch: 14, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.408 Vali Acc: 0.228 Test Loss: 2.408 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9725356101989746
Epoch: 15, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.397 Vali Acc: 0.250 Test Loss: 2.397 Test Acc: 0.250
Validation loss decreased (-0.233309 --> -0.249976).  Saving model ...
Epoch: 16 cost time: 0.8695521354675293
Epoch: 16, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.389 Vali Acc: 0.278 Test Loss: 2.389 Test Acc: 0.278
Validation loss decreased (-0.249976 --> -0.277754).  Saving model ...
Epoch: 17 cost time: 1.030015230178833
Epoch: 17, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.392 Vali Acc: 0.239 Test Loss: 2.392 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0525789260864258
Epoch: 18, Steps: 12 | Train Loss: 2.362 Vali Loss: 2.391 Vali Acc: 0.206 Test Loss: 2.391 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1219534873962402
Epoch: 19, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.382 Vali Acc: 0.233 Test Loss: 2.382 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1716020107269287
Epoch: 20, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.377 Vali Acc: 0.250 Test Loss: 2.377 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1396780014038086
Epoch: 21, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.369 Vali Acc: 0.228 Test Loss: 2.369 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1484014987945557
Epoch: 22, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.330 Vali Acc: 0.250 Test Loss: 2.330 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1337857246398926
Epoch: 23, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.304 Vali Acc: 0.267 Test Loss: 2.304 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0110738277435303
Epoch: 24, Steps: 12 | Train Loss: 2.265 Vali Loss: 2.280 Vali Acc: 0.278 Test Loss: 2.280 Test Acc: 0.278
Validation loss decreased (-0.277754 --> -0.277755).  Saving model ...
Epoch: 25 cost time: 0.9925491809844971
Epoch: 25, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.273 Vali Acc: 0.272 Test Loss: 2.273 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.361255168914795
Epoch: 26, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.278 Vali Acc: 0.244 Test Loss: 2.278 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0135588645935059
Epoch: 27, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.255 Vali Acc: 0.283 Test Loss: 2.255 Test Acc: 0.283
Validation loss decreased (-0.277755 --> -0.283311).  Saving model ...
Epoch: 28 cost time: 0.9585556983947754
Epoch: 28, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.244 Vali Acc: 0.267 Test Loss: 2.244 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9787964820861816
Epoch: 29, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.222 Vali Acc: 0.267 Test Loss: 2.222 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.448023796081543
Epoch: 30, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.242 Vali Acc: 0.239 Test Loss: 2.242 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9291932582855225
Epoch: 31, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.234 Vali Acc: 0.250 Test Loss: 2.234 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9756679534912109
Epoch: 32, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.246 Vali Acc: 0.239 Test Loss: 2.246 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.125577449798584
Epoch: 33, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.220 Vali Acc: 0.278 Test Loss: 2.220 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3017253875732422
Epoch: 34, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.221 Vali Acc: 0.311 Test Loss: 2.221 Test Acc: 0.311
Validation loss decreased (-0.283311 --> -0.311089).  Saving model ...
Epoch: 35 cost time: 1.0241882801055908
Epoch: 35, Steps: 12 | Train Loss: 2.017 Vali Loss: 2.217 Vali Acc: 0.267 Test Loss: 2.217 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0161857604980469
Epoch: 36, Steps: 12 | Train Loss: 2.018 Vali Loss: 2.213 Vali Acc: 0.289 Test Loss: 2.213 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8269064426422119
Epoch: 37, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.197 Vali Acc: 0.333 Test Loss: 2.197 Test Acc: 0.333
Validation loss decreased (-0.311089 --> -0.333311).  Saving model ...
Epoch: 38 cost time: 1.1465792655944824
Epoch: 38, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.209 Vali Acc: 0.289 Test Loss: 2.209 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.174414873123169
Epoch: 39, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.213 Vali Acc: 0.300 Test Loss: 2.213 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2284061908721924
Epoch: 40, Steps: 12 | Train Loss: 1.995 Vali Loss: 2.216 Vali Acc: 0.289 Test Loss: 2.216 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2017016410827637
Epoch: 41, Steps: 12 | Train Loss: 1.984 Vali Loss: 2.205 Vali Acc: 0.283 Test Loss: 2.205 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0415544509887695
Epoch: 42, Steps: 12 | Train Loss: 1.916 Vali Loss: 2.188 Vali Acc: 0.289 Test Loss: 2.188 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0238046646118164
Epoch: 43, Steps: 12 | Train Loss: 1.975 Vali Loss: 2.177 Vali Acc: 0.283 Test Loss: 2.177 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0889277458190918
Epoch: 44, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.181 Vali Acc: 0.311 Test Loss: 2.181 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8373119831085205
Epoch: 45, Steps: 12 | Train Loss: 1.912 Vali Loss: 2.189 Vali Acc: 0.289 Test Loss: 2.189 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0452277660369873
Epoch: 46, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.183 Vali Acc: 0.283 Test Loss: 2.183 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1421380043029785
Epoch: 47, Steps: 12 | Train Loss: 1.919 Vali Loss: 2.183 Vali Acc: 0.289 Test Loss: 2.183 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3333333333333333
model parameter : 95675
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.710771322250366
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.801 Vali Acc: 0.039 Test Loss: 2.801 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 1.0019588470458984
Epoch: 2, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.758 Vali Acc: 0.039 Test Loss: 2.758 Test Acc: 0.039
Validation loss decreased (-0.038861 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 0.7942867279052734
Epoch: 3, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.715 Vali Acc: 0.028 Test Loss: 2.715 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0615224838256836
Epoch: 4, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.692 Vali Acc: 0.067 Test Loss: 2.692 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 0.9142370223999023
Epoch: 5, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.621 Vali Acc: 0.106 Test Loss: 2.621 Test Acc: 0.106
Validation loss decreased (-0.066640 --> -0.105529).  Saving model ...
Epoch: 6 cost time: 0.8949949741363525
Epoch: 6, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.605 Vali Acc: 0.144 Test Loss: 2.605 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144418).  Saving model ...
Epoch: 7 cost time: 0.8368117809295654
Epoch: 7, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.568 Vali Acc: 0.178 Test Loss: 2.568 Test Acc: 0.178
Validation loss decreased (-0.144418 --> -0.177752).  Saving model ...
Epoch: 8 cost time: 1.0667059421539307
Epoch: 8, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.579 Vali Acc: 0.156 Test Loss: 2.579 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8295557498931885
Epoch: 9, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.536 Vali Acc: 0.150 Test Loss: 2.536 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0778181552886963
Epoch: 10, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.518 Vali Acc: 0.139 Test Loss: 2.518 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.033642292022705
Epoch: 11, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.481 Vali Acc: 0.150 Test Loss: 2.481 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0225191116333008
Epoch: 12, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.471 Vali Acc: 0.144 Test Loss: 2.471 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9088249206542969
Epoch: 13, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.505 Vali Acc: 0.161 Test Loss: 2.505 Test Acc: 0.161
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0958025455474854
Epoch: 14, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.481 Vali Acc: 0.183 Test Loss: 2.481 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183309).  Saving model ...
Epoch: 15 cost time: 1.2567076683044434
Epoch: 15, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.463 Vali Acc: 0.183 Test Loss: 2.463 Test Acc: 0.183
Validation loss decreased (-0.183309 --> -0.183309).  Saving model ...
Epoch: 16 cost time: 0.9479982852935791
Epoch: 16, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.463 Vali Acc: 0.200 Test Loss: 2.463 Test Acc: 0.200
Validation loss decreased (-0.183309 --> -0.199975).  Saving model ...
Epoch: 17 cost time: 0.890528678894043
Epoch: 17, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.424 Vali Acc: 0.200 Test Loss: 2.424 Test Acc: 0.200
Validation loss decreased (-0.199975 --> -0.199976).  Saving model ...
Epoch: 18 cost time: 1.0873618125915527
Epoch: 18, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.430 Vali Acc: 0.178 Test Loss: 2.430 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1481330394744873
Epoch: 19, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.403 Vali Acc: 0.194 Test Loss: 2.403 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8560836315155029
Epoch: 20, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.385 Vali Acc: 0.206 Test Loss: 2.385 Test Acc: 0.206
Validation loss decreased (-0.199976 --> -0.205532).  Saving model ...
Epoch: 21 cost time: 0.9849948883056641
Epoch: 21, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.352 Vali Acc: 0.244 Test Loss: 2.352 Test Acc: 0.244
Validation loss decreased (-0.205532 --> -0.244421).  Saving model ...
Epoch: 22 cost time: 0.9594223499298096
Epoch: 22, Steps: 12 | Train Loss: 2.252 Vali Loss: 2.334 Vali Acc: 0.267 Test Loss: 2.334 Test Acc: 0.267
Validation loss decreased (-0.244421 --> -0.266643).  Saving model ...
Epoch: 23 cost time: 1.1753170490264893
Epoch: 23, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.328 Vali Acc: 0.233 Test Loss: 2.328 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1029553413391113
Epoch: 24, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.309 Vali Acc: 0.244 Test Loss: 2.309 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1124119758605957
Epoch: 25, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.294 Vali Acc: 0.211 Test Loss: 2.294 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2013707160949707
Epoch: 26, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.281 Vali Acc: 0.244 Test Loss: 2.281 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9625954627990723
Epoch: 27, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.264 Vali Acc: 0.289 Test Loss: 2.264 Test Acc: 0.289
Validation loss decreased (-0.266643 --> -0.288866).  Saving model ...
Epoch: 28 cost time: 0.8731303215026855
Epoch: 28, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.267 Vali Acc: 0.239 Test Loss: 2.267 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.018251895904541
Epoch: 29, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.245 Vali Acc: 0.267 Test Loss: 2.245 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1469058990478516
Epoch: 30, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.264 Vali Acc: 0.250 Test Loss: 2.264 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1293883323669434
Epoch: 31, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.249 Vali Acc: 0.250 Test Loss: 2.249 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1971549987792969
Epoch: 32, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.236 Vali Acc: 0.256 Test Loss: 2.236 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9557039737701416
Epoch: 33, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.250 Vali Acc: 0.261 Test Loss: 2.250 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0417189598083496
Epoch: 34, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.254 Vali Acc: 0.267 Test Loss: 2.254 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1372206211090088
Epoch: 35, Steps: 12 | Train Loss: 2.055 Vali Loss: 2.245 Vali Acc: 0.283 Test Loss: 2.245 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0111677646636963
Epoch: 36, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.208 Vali Acc: 0.306 Test Loss: 2.208 Test Acc: 0.306
Validation loss decreased (-0.288866 --> -0.305533).  Saving model ...
Epoch: 37 cost time: 0.8733508586883545
Epoch: 37, Steps: 12 | Train Loss: 2.053 Vali Loss: 2.218 Vali Acc: 0.278 Test Loss: 2.218 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.128272294998169
Epoch: 38, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.197 Vali Acc: 0.289 Test Loss: 2.197 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1904728412628174
Epoch: 39, Steps: 12 | Train Loss: 2.035 Vali Loss: 2.185 Vali Acc: 0.283 Test Loss: 2.185 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0504868030548096
Epoch: 40, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.170 Vali Acc: 0.261 Test Loss: 2.170 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8216922283172607
Epoch: 41, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.173 Vali Acc: 0.317 Test Loss: 2.173 Test Acc: 0.317
Validation loss decreased (-0.305533 --> -0.316645).  Saving model ...
Epoch: 42 cost time: 1.0209619998931885
Epoch: 42, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.182 Vali Acc: 0.306 Test Loss: 2.182 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0788753032684326
Epoch: 43, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.172 Vali Acc: 0.306 Test Loss: 2.172 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8672506809234619
Epoch: 44, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.152 Vali Acc: 0.306 Test Loss: 2.152 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1150987148284912
Epoch: 45, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.144 Vali Acc: 0.272 Test Loss: 2.144 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9057629108428955
Epoch: 46, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.184 Vali Acc: 0.267 Test Loss: 2.184 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9788732528686523
Epoch: 47, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.190 Vali Acc: 0.267 Test Loss: 2.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7248971462249756
Epoch: 48, Steps: 12 | Train Loss: 1.940 Vali Loss: 2.174 Vali Acc: 0.278 Test Loss: 2.174 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8220386505126953
Epoch: 49, Steps: 12 | Train Loss: 1.929 Vali Loss: 2.167 Vali Acc: 0.272 Test Loss: 2.167 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0437867641448975
Epoch: 50, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.172 Vali Acc: 0.267 Test Loss: 2.172 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8872087001800537
Epoch: 51, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.155 Vali Acc: 0.317 Test Loss: 2.155 Test Acc: 0.317
Validation loss decreased (-0.316645 --> -0.316645).  Saving model ...
Epoch: 52 cost time: 1.0303633213043213
Epoch: 52, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.217 Vali Acc: 0.272 Test Loss: 2.217 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9343531131744385
Epoch: 53, Steps: 12 | Train Loss: 2.005 Vali Loss: 2.223 Vali Acc: 0.250 Test Loss: 2.223 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.108818769454956
Epoch: 54, Steps: 12 | Train Loss: 1.923 Vali Loss: 2.199 Vali Acc: 0.283 Test Loss: 2.199 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0555071830749512
Epoch: 55, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.192 Vali Acc: 0.278 Test Loss: 2.192 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8836667537689209
Epoch: 56, Steps: 12 | Train Loss: 1.956 Vali Loss: 2.186 Vali Acc: 0.239 Test Loss: 2.186 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9630513191223145
Epoch: 57, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.192 Vali Acc: 0.272 Test Loss: 2.192 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9409630298614502
Epoch: 58, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.185 Vali Acc: 0.272 Test Loss: 2.185 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.1271777153015137
Epoch: 59, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.167 Vali Acc: 0.278 Test Loss: 2.167 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.1912930011749268
Epoch: 60, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.150 Vali Acc: 0.278 Test Loss: 2.150 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.2375664710998535
Epoch: 61, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.161 Vali Acc: 0.261 Test Loss: 2.161 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.31666666666666665
model parameter : 94651
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.863314151763916
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.801 Vali Acc: 0.039 Test Loss: 2.801 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 1.3183324337005615
Epoch: 2, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.758 Vali Acc: 0.039 Test Loss: 2.758 Test Acc: 0.039
Validation loss decreased (-0.038861 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 1.0452988147735596
Epoch: 3, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.715 Vali Acc: 0.028 Test Loss: 2.715 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1940951347351074
Epoch: 4, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.692 Vali Acc: 0.067 Test Loss: 2.692 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 0.9884991645812988
Epoch: 5, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.621 Vali Acc: 0.106 Test Loss: 2.621 Test Acc: 0.106
Validation loss decreased (-0.066640 --> -0.105529).  Saving model ...
Epoch: 6 cost time: 0.8651535511016846
Epoch: 6, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.605 Vali Acc: 0.144 Test Loss: 2.605 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144418).  Saving model ...
Epoch: 7 cost time: 0.9658718109130859
Epoch: 7, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.568 Vali Acc: 0.178 Test Loss: 2.568 Test Acc: 0.178
Validation loss decreased (-0.144418 --> -0.177752).  Saving model ...
Epoch: 8 cost time: 1.0912964344024658
Epoch: 8, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.579 Vali Acc: 0.156 Test Loss: 2.579 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9665954113006592
Epoch: 9, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.536 Vali Acc: 0.150 Test Loss: 2.536 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.86737060546875
Epoch: 10, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.518 Vali Acc: 0.139 Test Loss: 2.518 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9014973640441895
Epoch: 11, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.481 Vali Acc: 0.150 Test Loss: 2.481 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9420883655548096
Epoch: 12, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.471 Vali Acc: 0.144 Test Loss: 2.471 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0925722122192383
Epoch: 13, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.505 Vali Acc: 0.161 Test Loss: 2.505 Test Acc: 0.161
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.250044345855713
Epoch: 14, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.481 Vali Acc: 0.183 Test Loss: 2.481 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183309).  Saving model ...
Epoch: 15 cost time: 0.9289381504058838
Epoch: 15, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.463 Vali Acc: 0.183 Test Loss: 2.463 Test Acc: 0.183
Validation loss decreased (-0.183309 --> -0.183309).  Saving model ...
Epoch: 16 cost time: 0.8503787517547607
Epoch: 16, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.463 Vali Acc: 0.200 Test Loss: 2.463 Test Acc: 0.200
Validation loss decreased (-0.183309 --> -0.199975).  Saving model ...
Epoch: 17 cost time: 0.8172709941864014
Epoch: 17, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.424 Vali Acc: 0.200 Test Loss: 2.424 Test Acc: 0.200
Validation loss decreased (-0.199975 --> -0.199976).  Saving model ...
Epoch: 18 cost time: 1.0461187362670898
Epoch: 18, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.430 Vali Acc: 0.178 Test Loss: 2.430 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9239997863769531
Epoch: 19, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.403 Vali Acc: 0.194 Test Loss: 2.403 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0529778003692627
Epoch: 20, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.385 Vali Acc: 0.206 Test Loss: 2.385 Test Acc: 0.206
Validation loss decreased (-0.199976 --> -0.205532).  Saving model ...
Epoch: 21 cost time: 0.9650180339813232
Epoch: 21, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.352 Vali Acc: 0.244 Test Loss: 2.352 Test Acc: 0.244
Validation loss decreased (-0.205532 --> -0.244421).  Saving model ...
Epoch: 22 cost time: 0.9550793170928955
Epoch: 22, Steps: 12 | Train Loss: 2.252 Vali Loss: 2.334 Vali Acc: 0.267 Test Loss: 2.334 Test Acc: 0.267
Validation loss decreased (-0.244421 --> -0.266643).  Saving model ...
Epoch: 23 cost time: 1.088890790939331
Epoch: 23, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.328 Vali Acc: 0.233 Test Loss: 2.328 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1555731296539307
Epoch: 24, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.309 Vali Acc: 0.244 Test Loss: 2.309 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7773973941802979
Epoch: 25, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.294 Vali Acc: 0.211 Test Loss: 2.294 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9968526363372803
Epoch: 26, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.281 Vali Acc: 0.244 Test Loss: 2.281 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9481210708618164
Epoch: 27, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.264 Vali Acc: 0.289 Test Loss: 2.264 Test Acc: 0.289
Validation loss decreased (-0.266643 --> -0.288866).  Saving model ...
Epoch: 28 cost time: 0.8553624153137207
Epoch: 28, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.267 Vali Acc: 0.239 Test Loss: 2.267 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8096833229064941
Epoch: 29, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.245 Vali Acc: 0.267 Test Loss: 2.245 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1852400302886963
Epoch: 30, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.264 Vali Acc: 0.250 Test Loss: 2.264 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8797805309295654
Epoch: 31, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.249 Vali Acc: 0.250 Test Loss: 2.249 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0074245929718018
Epoch: 32, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.236 Vali Acc: 0.256 Test Loss: 2.236 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9178242683410645
Epoch: 33, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.250 Vali Acc: 0.261 Test Loss: 2.250 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7861123085021973
Epoch: 34, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.254 Vali Acc: 0.267 Test Loss: 2.254 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0861647129058838
Epoch: 35, Steps: 12 | Train Loss: 2.055 Vali Loss: 2.245 Vali Acc: 0.283 Test Loss: 2.245 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0089349746704102
Epoch: 36, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.208 Vali Acc: 0.306 Test Loss: 2.208 Test Acc: 0.306
Validation loss decreased (-0.288866 --> -0.305533).  Saving model ...
Epoch: 37 cost time: 0.8810856342315674
Epoch: 37, Steps: 12 | Train Loss: 2.053 Vali Loss: 2.218 Vali Acc: 0.278 Test Loss: 2.218 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.237837553024292
Epoch: 38, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.197 Vali Acc: 0.289 Test Loss: 2.197 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7988922595977783
Epoch: 39, Steps: 12 | Train Loss: 2.035 Vali Loss: 2.185 Vali Acc: 0.283 Test Loss: 2.185 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9423477649688721
Epoch: 40, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.170 Vali Acc: 0.261 Test Loss: 2.170 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8606336116790771
Epoch: 41, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.173 Vali Acc: 0.317 Test Loss: 2.173 Test Acc: 0.317
Validation loss decreased (-0.305533 --> -0.316645).  Saving model ...
Epoch: 42 cost time: 1.0419163703918457
Epoch: 42, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.182 Vali Acc: 0.306 Test Loss: 2.182 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.159010887145996
Epoch: 43, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.172 Vali Acc: 0.306 Test Loss: 2.172 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2432312965393066
Epoch: 44, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.152 Vali Acc: 0.306 Test Loss: 2.152 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.874211311340332
Epoch: 45, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.144 Vali Acc: 0.272 Test Loss: 2.144 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6917939186096191
Epoch: 46, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.184 Vali Acc: 0.267 Test Loss: 2.184 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7410776615142822
Epoch: 47, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.190 Vali Acc: 0.267 Test Loss: 2.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7644250392913818
Epoch: 48, Steps: 12 | Train Loss: 1.940 Vali Loss: 2.174 Vali Acc: 0.278 Test Loss: 2.174 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8745641708374023
Epoch: 49, Steps: 12 | Train Loss: 1.929 Vali Loss: 2.167 Vali Acc: 0.272 Test Loss: 2.167 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9748632907867432
Epoch: 50, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.172 Vali Acc: 0.267 Test Loss: 2.172 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.1947875022888184
Epoch: 51, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.155 Vali Acc: 0.317 Test Loss: 2.155 Test Acc: 0.317
Validation loss decreased (-0.316645 --> -0.316645).  Saving model ...
Epoch: 52 cost time: 0.9535191059112549
Epoch: 52, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.217 Vali Acc: 0.272 Test Loss: 2.217 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.081899642944336
Epoch: 53, Steps: 12 | Train Loss: 2.005 Vali Loss: 2.223 Vali Acc: 0.250 Test Loss: 2.223 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8373630046844482
Epoch: 54, Steps: 12 | Train Loss: 1.923 Vali Loss: 2.199 Vali Acc: 0.283 Test Loss: 2.199 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2460758686065674
Epoch: 55, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.192 Vali Acc: 0.278 Test Loss: 2.192 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9195516109466553
Epoch: 56, Steps: 12 | Train Loss: 1.956 Vali Loss: 2.186 Vali Acc: 0.239 Test Loss: 2.186 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9469039440155029
Epoch: 57, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.192 Vali Acc: 0.272 Test Loss: 2.192 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9454739093780518
Epoch: 58, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.185 Vali Acc: 0.272 Test Loss: 2.185 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.139045000076294
Epoch: 59, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.167 Vali Acc: 0.278 Test Loss: 2.167 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9926152229309082
Epoch: 60, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.150 Vali Acc: 0.278 Test Loss: 2.150 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8960106372833252
Epoch: 61, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.161 Vali Acc: 0.261 Test Loss: 2.161 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.31666666666666665
model parameter : 94651
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.285275936126709
Epoch: 1, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.780 Vali Acc: 0.061 Test Loss: 2.780 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.3086304664611816
Epoch: 2, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.764 Vali Acc: 0.061 Test Loss: 2.764 Test Acc: 0.061
Validation loss decreased (-0.061083 --> -0.061083).  Saving model ...
Epoch: 3 cost time: 1.1260614395141602
Epoch: 3, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.744 Vali Acc: 0.078 Test Loss: 2.744 Test Acc: 0.078
Validation loss decreased (-0.061083 --> -0.077750).  Saving model ...
Epoch: 4 cost time: 0.9080607891082764
Epoch: 4, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.734 Vali Acc: 0.056 Test Loss: 2.734 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9467642307281494
Epoch: 5, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.724 Vali Acc: 0.061 Test Loss: 2.724 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2901513576507568
Epoch: 6, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.694 Vali Acc: 0.072 Test Loss: 2.694 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.161639928817749
Epoch: 7, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.679 Vali Acc: 0.078 Test Loss: 2.679 Test Acc: 0.078
Validation loss decreased (-0.077750 --> -0.077751).  Saving model ...
Epoch: 8 cost time: 0.9813084602355957
Epoch: 8, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.668 Vali Acc: 0.083 Test Loss: 2.668 Test Acc: 0.083
Validation loss decreased (-0.077751 --> -0.083307).  Saving model ...
Epoch: 9 cost time: 1.2455074787139893
Epoch: 9, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.647 Vali Acc: 0.078 Test Loss: 2.647 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9822177886962891
Epoch: 10, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.634 Vali Acc: 0.156 Test Loss: 2.634 Test Acc: 0.156
Validation loss decreased (-0.083307 --> -0.155529).  Saving model ...
Epoch: 11 cost time: 1.212794542312622
Epoch: 11, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.616 Vali Acc: 0.161 Test Loss: 2.616 Test Acc: 0.161
Validation loss decreased (-0.155529 --> -0.161085).  Saving model ...
Epoch: 12 cost time: 1.1200964450836182
Epoch: 12, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.594 Vali Acc: 0.150 Test Loss: 2.594 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0671513080596924
Epoch: 13, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.576 Vali Acc: 0.161 Test Loss: 2.576 Test Acc: 0.161
Validation loss decreased (-0.161085 --> -0.161085).  Saving model ...
Epoch: 14 cost time: 0.9644463062286377
Epoch: 14, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.558 Vali Acc: 0.161 Test Loss: 2.558 Test Acc: 0.161
Validation loss decreased (-0.161085 --> -0.161086).  Saving model ...
Epoch: 15 cost time: 0.9504094123840332
Epoch: 15, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.543 Vali Acc: 0.194 Test Loss: 2.543 Test Acc: 0.194
Validation loss decreased (-0.161086 --> -0.194419).  Saving model ...
Epoch: 16 cost time: 1.0342602729797363
Epoch: 16, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.532 Vali Acc: 0.194 Test Loss: 2.532 Test Acc: 0.194
Validation loss decreased (-0.194419 --> -0.194419).  Saving model ...
Epoch: 17 cost time: 1.2263150215148926
Epoch: 17, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.513 Vali Acc: 0.167 Test Loss: 2.513 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8694243431091309
Epoch: 18, Steps: 12 | Train Loss: 2.375 Vali Loss: 2.490 Vali Acc: 0.156 Test Loss: 2.490 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8645329475402832
Epoch: 19, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.468 Vali Acc: 0.150 Test Loss: 2.468 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1851661205291748
Epoch: 20, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.451 Vali Acc: 0.183 Test Loss: 2.451 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9414136409759521
Epoch: 21, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.431 Vali Acc: 0.194 Test Loss: 2.431 Test Acc: 0.194
Validation loss decreased (-0.194419 --> -0.194420).  Saving model ...
Epoch: 22 cost time: 1.3512139320373535
Epoch: 22, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.409 Vali Acc: 0.206 Test Loss: 2.409 Test Acc: 0.206
Validation loss decreased (-0.194420 --> -0.205531).  Saving model ...
Epoch: 23 cost time: 1.308213233947754
Epoch: 23, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.398 Vali Acc: 0.239 Test Loss: 2.398 Test Acc: 0.239
Validation loss decreased (-0.205531 --> -0.238865).  Saving model ...
Epoch: 24 cost time: 1.1778571605682373
Epoch: 24, Steps: 12 | Train Loss: 2.266 Vali Loss: 2.398 Vali Acc: 0.217 Test Loss: 2.398 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2351601123809814
Epoch: 25, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.377 Vali Acc: 0.189 Test Loss: 2.377 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.161818504333496
Epoch: 26, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.385 Vali Acc: 0.161 Test Loss: 2.385 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.039778709411621
Epoch: 27, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.372 Vali Acc: 0.183 Test Loss: 2.372 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0698754787445068
Epoch: 28, Steps: 12 | Train Loss: 2.216 Vali Loss: 2.371 Vali Acc: 0.189 Test Loss: 2.371 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1987557411193848
Epoch: 29, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.366 Vali Acc: 0.172 Test Loss: 2.366 Test Acc: 0.172
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0752973556518555
Epoch: 30, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.354 Vali Acc: 0.200 Test Loss: 2.354 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1480820178985596
Epoch: 31, Steps: 12 | Train Loss: 2.147 Vali Loss: 2.339 Vali Acc: 0.211 Test Loss: 2.339 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3126990795135498
Epoch: 32, Steps: 12 | Train Loss: 2.162 Vali Loss: 2.322 Vali Acc: 0.206 Test Loss: 2.322 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4692282676696777
Epoch: 33, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.305 Vali Acc: 0.200 Test Loss: 2.305 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2388888888888889
model parameter : 50619
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4467997550964355
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.772 Vali Acc: 0.050 Test Loss: 2.772 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.1983044147491455
Epoch: 2, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.754 Vali Acc: 0.039 Test Loss: 2.754 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2557642459869385
Epoch: 3, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.754 Vali Acc: 0.050 Test Loss: 2.754 Test Acc: 0.050
Validation loss decreased (-0.049972 --> -0.049972).  Saving model ...
Epoch: 4 cost time: 1.1870543956756592
Epoch: 4, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.730 Vali Acc: 0.056 Test Loss: 2.730 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 5 cost time: 1.3208098411560059
Epoch: 5, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.718 Vali Acc: 0.050 Test Loss: 2.718 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3280479907989502
Epoch: 6, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.704 Vali Acc: 0.033 Test Loss: 2.704 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3254890441894531
Epoch: 7, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.689 Vali Acc: 0.100 Test Loss: 2.689 Test Acc: 0.100
Validation loss decreased (-0.055528 --> -0.099973).  Saving model ...
Epoch: 8 cost time: 1.1796910762786865
Epoch: 8, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.659 Vali Acc: 0.078 Test Loss: 2.659 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4043209552764893
Epoch: 9, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.631 Vali Acc: 0.100 Test Loss: 2.631 Test Acc: 0.100
Validation loss decreased (-0.099973 --> -0.099974).  Saving model ...
Epoch: 10 cost time: 1.127530574798584
Epoch: 10, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.624 Vali Acc: 0.083 Test Loss: 2.624 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.036010980606079
Epoch: 11, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.615 Vali Acc: 0.106 Test Loss: 2.615 Test Acc: 0.106
Validation loss decreased (-0.099974 --> -0.105529).  Saving model ...
Epoch: 12 cost time: 1.3951311111450195
Epoch: 12, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.599 Vali Acc: 0.128 Test Loss: 2.599 Test Acc: 0.128
Validation loss decreased (-0.105529 --> -0.127752).  Saving model ...
Epoch: 13 cost time: 1.2734873294830322
Epoch: 13, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.577 Vali Acc: 0.139 Test Loss: 2.577 Test Acc: 0.139
Validation loss decreased (-0.127752 --> -0.138863).  Saving model ...
Epoch: 14 cost time: 1.5509672164916992
Epoch: 14, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.561 Vali Acc: 0.167 Test Loss: 2.561 Test Acc: 0.167
Validation loss decreased (-0.138863 --> -0.166641).  Saving model ...
Epoch: 15 cost time: 1.2732012271881104
Epoch: 15, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.558 Vali Acc: 0.156 Test Loss: 2.558 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0710997581481934
Epoch: 16, Steps: 12 | Train Loss: 2.436 Vali Loss: 2.543 Vali Acc: 0.144 Test Loss: 2.543 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0846507549285889
Epoch: 17, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.545 Vali Acc: 0.161 Test Loss: 2.545 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2513089179992676
Epoch: 18, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.544 Vali Acc: 0.156 Test Loss: 2.544 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2312438488006592
Epoch: 19, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.511 Vali Acc: 0.167 Test Loss: 2.511 Test Acc: 0.167
Validation loss decreased (-0.166641 --> -0.166642).  Saving model ...
Epoch: 20 cost time: 1.3071839809417725
Epoch: 20, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.467 Vali Acc: 0.167 Test Loss: 2.467 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166642).  Saving model ...
Epoch: 21 cost time: 1.3117637634277344
Epoch: 21, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.422 Vali Acc: 0.222 Test Loss: 2.422 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222198).  Saving model ...
Epoch: 22 cost time: 1.4059534072875977
Epoch: 22, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.418 Vali Acc: 0.222 Test Loss: 2.418 Test Acc: 0.222
Validation loss decreased (-0.222198 --> -0.222198).  Saving model ...
Epoch: 23 cost time: 1.1780931949615479
Epoch: 23, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.407 Vali Acc: 0.211 Test Loss: 2.407 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.233443021774292
Epoch: 24, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.399 Vali Acc: 0.217 Test Loss: 2.399 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0019903182983398
Epoch: 25, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.407 Vali Acc: 0.233 Test Loss: 2.407 Test Acc: 0.233
Validation loss decreased (-0.222198 --> -0.233309).  Saving model ...
Epoch: 26 cost time: 1.143019199371338
Epoch: 26, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.385 Vali Acc: 0.239 Test Loss: 2.385 Test Acc: 0.239
Validation loss decreased (-0.233309 --> -0.238865).  Saving model ...
Epoch: 27 cost time: 1.262728214263916
Epoch: 27, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.365 Vali Acc: 0.239 Test Loss: 2.365 Test Acc: 0.239
Validation loss decreased (-0.238865 --> -0.238865).  Saving model ...
Epoch: 28 cost time: 1.3419420719146729
Epoch: 28, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.349 Vali Acc: 0.256 Test Loss: 2.349 Test Acc: 0.256
Validation loss decreased (-0.238865 --> -0.255532).  Saving model ...
Epoch: 29 cost time: 1.2036945819854736
Epoch: 29, Steps: 12 | Train Loss: 2.179 Vali Loss: 2.316 Vali Acc: 0.289 Test Loss: 2.316 Test Acc: 0.289
Validation loss decreased (-0.255532 --> -0.288866).  Saving model ...
Epoch: 30 cost time: 1.0479190349578857
Epoch: 30, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.303 Vali Acc: 0.283 Test Loss: 2.303 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2592885494232178
Epoch: 31, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.291 Vali Acc: 0.289 Test Loss: 2.291 Test Acc: 0.289
Validation loss decreased (-0.288866 --> -0.288866).  Saving model ...
Epoch: 32 cost time: 1.0701522827148438
Epoch: 32, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.259 Vali Acc: 0.278 Test Loss: 2.259 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3727121353149414
Epoch: 33, Steps: 12 | Train Loss: 2.091 Vali Loss: 2.243 Vali Acc: 0.261 Test Loss: 2.243 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.289170265197754
Epoch: 34, Steps: 12 | Train Loss: 2.035 Vali Loss: 2.226 Vali Acc: 0.272 Test Loss: 2.226 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1829781532287598
Epoch: 35, Steps: 12 | Train Loss: 2.000 Vali Loss: 2.218 Vali Acc: 0.267 Test Loss: 2.218 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2631428241729736
Epoch: 36, Steps: 12 | Train Loss: 2.023 Vali Loss: 2.202 Vali Acc: 0.261 Test Loss: 2.202 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3791720867156982
Epoch: 37, Steps: 12 | Train Loss: 1.967 Vali Loss: 2.190 Vali Acc: 0.278 Test Loss: 2.190 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3774528503417969
Epoch: 38, Steps: 12 | Train Loss: 1.983 Vali Loss: 2.176 Vali Acc: 0.322 Test Loss: 2.176 Test Acc: 0.322
Validation loss decreased (-0.288866 --> -0.322200).  Saving model ...
Epoch: 39 cost time: 1.4986467361450195
Epoch: 39, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.168 Vali Acc: 0.311 Test Loss: 2.168 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1945903301239014
Epoch: 40, Steps: 12 | Train Loss: 1.922 Vali Loss: 2.155 Vali Acc: 0.306 Test Loss: 2.155 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2984280586242676
Epoch: 41, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.145 Vali Acc: 0.311 Test Loss: 2.145 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1255300045013428
Epoch: 42, Steps: 12 | Train Loss: 1.920 Vali Loss: 2.139 Vali Acc: 0.289 Test Loss: 2.139 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2246894836425781
Epoch: 43, Steps: 12 | Train Loss: 1.908 Vali Loss: 2.125 Vali Acc: 0.306 Test Loss: 2.125 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5451552867889404
Epoch: 44, Steps: 12 | Train Loss: 1.925 Vali Loss: 2.115 Vali Acc: 0.311 Test Loss: 2.115 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5747675895690918
Epoch: 45, Steps: 12 | Train Loss: 1.949 Vali Loss: 2.092 Vali Acc: 0.311 Test Loss: 2.092 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3529033660888672
Epoch: 46, Steps: 12 | Train Loss: 1.868 Vali Loss: 2.081 Vali Acc: 0.322 Test Loss: 2.081 Test Acc: 0.322
Validation loss decreased (-0.322200 --> -0.322201).  Saving model ...
Epoch: 47 cost time: 1.1324138641357422
Epoch: 47, Steps: 12 | Train Loss: 1.838 Vali Loss: 2.080 Vali Acc: 0.306 Test Loss: 2.080 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.413041353225708
Epoch: 48, Steps: 12 | Train Loss: 1.843 Vali Loss: 2.074 Vali Acc: 0.300 Test Loss: 2.074 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3893768787384033
Epoch: 49, Steps: 12 | Train Loss: 1.848 Vali Loss: 2.074 Vali Acc: 0.306 Test Loss: 2.074 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1209328174591064
Epoch: 50, Steps: 12 | Train Loss: 1.889 Vali Loss: 2.073 Vali Acc: 0.300 Test Loss: 2.073 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.214463710784912
Epoch: 51, Steps: 12 | Train Loss: 1.846 Vali Loss: 2.070 Vali Acc: 0.294 Test Loss: 2.070 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.3844876289367676
Epoch: 52, Steps: 12 | Train Loss: 1.758 Vali Loss: 2.067 Vali Acc: 0.317 Test Loss: 2.067 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3315470218658447
Epoch: 53, Steps: 12 | Train Loss: 1.808 Vali Loss: 2.103 Vali Acc: 0.294 Test Loss: 2.103 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.3706467151641846
Epoch: 54, Steps: 12 | Train Loss: 1.794 Vali Loss: 2.097 Vali Acc: 0.311 Test Loss: 2.097 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.4088630676269531
Epoch: 55, Steps: 12 | Train Loss: 1.761 Vali Loss: 2.089 Vali Acc: 0.300 Test Loss: 2.089 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1821231842041016
Epoch: 56, Steps: 12 | Train Loss: 1.771 Vali Loss: 2.081 Vali Acc: 0.294 Test Loss: 2.081 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.32222222222222224
model parameter : 50107
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.254338026046753
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.783 Vali Acc: 0.050 Test Loss: 2.783 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.0427374839782715
Epoch: 2, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.755 Vali Acc: 0.061 Test Loss: 2.755 Test Acc: 0.061
Validation loss decreased (-0.049972 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 1.1118271350860596
Epoch: 3, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.762 Vali Acc: 0.061 Test Loss: 2.762 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.304643154144287
Epoch: 4, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.735 Vali Acc: 0.067 Test Loss: 2.735 Test Acc: 0.067
Validation loss decreased (-0.061084 --> -0.066639).  Saving model ...
Epoch: 5 cost time: 1.278705358505249
Epoch: 5, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.703 Vali Acc: 0.072 Test Loss: 2.703 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 6 cost time: 0.9935836791992188
Epoch: 6, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.686 Vali Acc: 0.089 Test Loss: 2.686 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 7 cost time: 1.1188833713531494
Epoch: 7, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.668 Vali Acc: 0.122 Test Loss: 2.668 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 8 cost time: 0.9205942153930664
Epoch: 8, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.652 Vali Acc: 0.128 Test Loss: 2.652 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 9 cost time: 1.1931512355804443
Epoch: 9, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.601 Vali Acc: 0.117 Test Loss: 2.601 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2668745517730713
Epoch: 10, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.574 Vali Acc: 0.150 Test Loss: 2.574 Test Acc: 0.150
Validation loss decreased (-0.127751 --> -0.149974).  Saving model ...
Epoch: 11 cost time: 1.1915042400360107
Epoch: 11, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.553 Vali Acc: 0.167 Test Loss: 2.553 Test Acc: 0.167
Validation loss decreased (-0.149974 --> -0.166641).  Saving model ...
Epoch: 12 cost time: 1.2806999683380127
Epoch: 12, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.530 Vali Acc: 0.167 Test Loss: 2.530 Test Acc: 0.167
Validation loss decreased (-0.166641 --> -0.166641).  Saving model ...
Epoch: 13 cost time: 1.17706298828125
Epoch: 13, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.509 Vali Acc: 0.217 Test Loss: 2.509 Test Acc: 0.217
Validation loss decreased (-0.166641 --> -0.216642).  Saving model ...
Epoch: 14 cost time: 0.9731988906860352
Epoch: 14, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.497 Vali Acc: 0.239 Test Loss: 2.497 Test Acc: 0.239
Validation loss decreased (-0.216642 --> -0.238864).  Saving model ...
Epoch: 15 cost time: 1.2391371726989746
Epoch: 15, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.502 Vali Acc: 0.250 Test Loss: 2.502 Test Acc: 0.250
Validation loss decreased (-0.238864 --> -0.249975).  Saving model ...
Epoch: 16 cost time: 1.2291693687438965
Epoch: 16, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.500 Vali Acc: 0.217 Test Loss: 2.500 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3154098987579346
Epoch: 17, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.482 Vali Acc: 0.211 Test Loss: 2.482 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0352001190185547
Epoch: 18, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.470 Vali Acc: 0.244 Test Loss: 2.470 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4061834812164307
Epoch: 19, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.455 Vali Acc: 0.217 Test Loss: 2.455 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2669463157653809
Epoch: 20, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.451 Vali Acc: 0.256 Test Loss: 2.451 Test Acc: 0.256
Validation loss decreased (-0.249975 --> -0.255531).  Saving model ...
Epoch: 21 cost time: 1.2971506118774414
Epoch: 21, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.435 Vali Acc: 0.222 Test Loss: 2.435 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9608345031738281
Epoch: 22, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.432 Vali Acc: 0.222 Test Loss: 2.432 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4057090282440186
Epoch: 23, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.421 Vali Acc: 0.222 Test Loss: 2.421 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0301475524902344
Epoch: 24, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.418 Vali Acc: 0.194 Test Loss: 2.418 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.189936876296997
Epoch: 25, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.418 Vali Acc: 0.228 Test Loss: 2.418 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.210486888885498
Epoch: 26, Steps: 12 | Train Loss: 2.265 Vali Loss: 2.411 Vali Acc: 0.206 Test Loss: 2.411 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3363323211669922
Epoch: 27, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.391 Vali Acc: 0.261 Test Loss: 2.391 Test Acc: 0.261
Validation loss decreased (-0.255531 --> -0.261087).  Saving model ...
Epoch: 28 cost time: 1.2056560516357422
Epoch: 28, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.375 Vali Acc: 0.261 Test Loss: 2.375 Test Acc: 0.261
Validation loss decreased (-0.261087 --> -0.261087).  Saving model ...
Epoch: 29 cost time: 1.264439344406128
Epoch: 29, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.384 Vali Acc: 0.233 Test Loss: 2.384 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.046910047531128
Epoch: 30, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.369 Vali Acc: 0.217 Test Loss: 2.369 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.230759859085083
Epoch: 31, Steps: 12 | Train Loss: 2.207 Vali Loss: 2.353 Vali Acc: 0.233 Test Loss: 2.353 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.023606300354004
Epoch: 32, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.328 Vali Acc: 0.228 Test Loss: 2.328 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.114319086074829
Epoch: 33, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.318 Vali Acc: 0.222 Test Loss: 2.318 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2772414684295654
Epoch: 34, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.288 Vali Acc: 0.239 Test Loss: 2.288 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0573110580444336
Epoch: 35, Steps: 12 | Train Loss: 2.048 Vali Loss: 2.297 Vali Acc: 0.222 Test Loss: 2.297 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9686329364776611
Epoch: 36, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.255 Vali Acc: 0.228 Test Loss: 2.255 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9734647274017334
Epoch: 37, Steps: 12 | Train Loss: 2.084 Vali Loss: 2.248 Vali Acc: 0.217 Test Loss: 2.248 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.24418044090271
Epoch: 38, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.250 Vali Acc: 0.222 Test Loss: 2.250 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2611111111111111
model parameter : 49595
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.958120822906494
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.807 Vali Acc: 0.039 Test Loss: 2.807 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 1.0539543628692627
Epoch: 2, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.767 Vali Acc: 0.028 Test Loss: 2.767 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0658392906188965
Epoch: 3, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.747 Vali Acc: 0.033 Test Loss: 2.747 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0532519817352295
Epoch: 4, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.717 Vali Acc: 0.044 Test Loss: 2.717 Test Acc: 0.044
Validation loss decreased (-0.038861 --> -0.044417).  Saving model ...
Epoch: 5 cost time: 1.1956689357757568
Epoch: 5, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.687 Vali Acc: 0.078 Test Loss: 2.687 Test Acc: 0.078
Validation loss decreased (-0.044417 --> -0.077751).  Saving model ...
Epoch: 6 cost time: 1.157609224319458
Epoch: 6, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.668 Vali Acc: 0.094 Test Loss: 2.668 Test Acc: 0.094
Validation loss decreased (-0.077751 --> -0.094418).  Saving model ...
Epoch: 7 cost time: 1.0930376052856445
Epoch: 7, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.667 Vali Acc: 0.128 Test Loss: 2.667 Test Acc: 0.128
Validation loss decreased (-0.094418 --> -0.127751).  Saving model ...
Epoch: 8 cost time: 1.101473331451416
Epoch: 8, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.633 Vali Acc: 0.133 Test Loss: 2.633 Test Acc: 0.133
Validation loss decreased (-0.127751 --> -0.133307).  Saving model ...
Epoch: 9 cost time: 1.1749253273010254
Epoch: 9, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.598 Vali Acc: 0.161 Test Loss: 2.598 Test Acc: 0.161
Validation loss decreased (-0.133307 --> -0.161085).  Saving model ...
Epoch: 10 cost time: 1.1024196147918701
Epoch: 10, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.598 Vali Acc: 0.133 Test Loss: 2.598 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4303135871887207
Epoch: 11, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.569 Vali Acc: 0.167 Test Loss: 2.569 Test Acc: 0.167
Validation loss decreased (-0.161085 --> -0.166641).  Saving model ...
Epoch: 12 cost time: 1.0469377040863037
Epoch: 12, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.531 Vali Acc: 0.167 Test Loss: 2.531 Test Acc: 0.167
Validation loss decreased (-0.166641 --> -0.166641).  Saving model ...
Epoch: 13 cost time: 1.2186710834503174
Epoch: 13, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.513 Vali Acc: 0.172 Test Loss: 2.513 Test Acc: 0.172
Validation loss decreased (-0.166641 --> -0.172197).  Saving model ...
Epoch: 14 cost time: 0.9689731597900391
Epoch: 14, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.495 Vali Acc: 0.194 Test Loss: 2.495 Test Acc: 0.194
Validation loss decreased (-0.172197 --> -0.194419).  Saving model ...
Epoch: 15 cost time: 1.5443520545959473
Epoch: 15, Steps: 12 | Train Loss: 2.385 Vali Loss: 2.488 Vali Acc: 0.189 Test Loss: 2.488 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.987809419631958
Epoch: 16, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.479 Vali Acc: 0.178 Test Loss: 2.479 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0471646785736084
Epoch: 17, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.481 Vali Acc: 0.211 Test Loss: 2.481 Test Acc: 0.211
Validation loss decreased (-0.194419 --> -0.211086).  Saving model ...
Epoch: 18 cost time: 1.091933250427246
Epoch: 18, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.480 Vali Acc: 0.206 Test Loss: 2.480 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1416170597076416
Epoch: 19, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.467 Vali Acc: 0.228 Test Loss: 2.467 Test Acc: 0.228
Validation loss decreased (-0.211086 --> -0.227753).  Saving model ...
Epoch: 20 cost time: 1.0032203197479248
Epoch: 20, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.452 Vali Acc: 0.206 Test Loss: 2.452 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1767408847808838
Epoch: 21, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.445 Vali Acc: 0.194 Test Loss: 2.445 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0136184692382812
Epoch: 22, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.401 Vali Acc: 0.211 Test Loss: 2.401 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2115495204925537
Epoch: 23, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.370 Vali Acc: 0.217 Test Loss: 2.370 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1890723705291748
Epoch: 24, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.355 Vali Acc: 0.200 Test Loss: 2.355 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.014958381652832
Epoch: 25, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.339 Vali Acc: 0.250 Test Loss: 2.339 Test Acc: 0.250
Validation loss decreased (-0.227753 --> -0.249977).  Saving model ...
Epoch: 26 cost time: 0.9560353755950928
Epoch: 26, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.308 Vali Acc: 0.244 Test Loss: 2.308 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.155811071395874
Epoch: 27, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.298 Vali Acc: 0.250 Test Loss: 2.298 Test Acc: 0.250
Validation loss decreased (-0.249977 --> -0.249977).  Saving model ...
Epoch: 28 cost time: 1.0852785110473633
Epoch: 28, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.313 Vali Acc: 0.261 Test Loss: 2.313 Test Acc: 0.261
Validation loss decreased (-0.249977 --> -0.261088).  Saving model ...
Epoch: 29 cost time: 0.8915987014770508
Epoch: 29, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.312 Vali Acc: 0.256 Test Loss: 2.312 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1464126110076904
Epoch: 30, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.291 Vali Acc: 0.217 Test Loss: 2.291 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3951733112335205
Epoch: 31, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.280 Vali Acc: 0.233 Test Loss: 2.280 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2921297550201416
Epoch: 32, Steps: 12 | Train Loss: 2.062 Vali Loss: 2.301 Vali Acc: 0.228 Test Loss: 2.301 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1623623371124268
Epoch: 33, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.303 Vali Acc: 0.211 Test Loss: 2.303 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2430243492126465
Epoch: 34, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.284 Vali Acc: 0.211 Test Loss: 2.284 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9235637187957764
Epoch: 35, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.271 Vali Acc: 0.267 Test Loss: 2.271 Test Acc: 0.267
Validation loss decreased (-0.261088 --> -0.266644).  Saving model ...
Epoch: 36 cost time: 1.106503963470459
Epoch: 36, Steps: 12 | Train Loss: 2.059 Vali Loss: 2.272 Vali Acc: 0.239 Test Loss: 2.272 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1219162940979004
Epoch: 37, Steps: 12 | Train Loss: 2.038 Vali Loss: 2.269 Vali Acc: 0.261 Test Loss: 2.269 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1416783332824707
Epoch: 38, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.260 Vali Acc: 0.233 Test Loss: 2.260 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3186986446380615
Epoch: 39, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.231 Vali Acc: 0.267 Test Loss: 2.231 Test Acc: 0.267
Validation loss decreased (-0.266644 --> -0.266644).  Saving model ...
Epoch: 40 cost time: 1.0303080081939697
Epoch: 40, Steps: 12 | Train Loss: 2.054 Vali Loss: 2.216 Vali Acc: 0.256 Test Loss: 2.216 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1154627799987793
Epoch: 41, Steps: 12 | Train Loss: 2.054 Vali Loss: 2.223 Vali Acc: 0.272 Test Loss: 2.223 Test Acc: 0.272
Validation loss decreased (-0.266644 --> -0.272200).  Saving model ...
Epoch: 42 cost time: 1.0894713401794434
Epoch: 42, Steps: 12 | Train Loss: 2.006 Vali Loss: 2.216 Vali Acc: 0.311 Test Loss: 2.216 Test Acc: 0.311
Validation loss decreased (-0.272200 --> -0.311089).  Saving model ...
Epoch: 43 cost time: 0.9687118530273438
Epoch: 43, Steps: 12 | Train Loss: 2.017 Vali Loss: 2.228 Vali Acc: 0.294 Test Loss: 2.228 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.989011287689209
Epoch: 44, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.229 Vali Acc: 0.272 Test Loss: 2.229 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4673566818237305
Epoch: 45, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.226 Vali Acc: 0.300 Test Loss: 2.226 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3036551475524902
Epoch: 46, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.210 Vali Acc: 0.300 Test Loss: 2.210 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.011549472808838
Epoch: 47, Steps: 12 | Train Loss: 1.989 Vali Loss: 2.213 Vali Acc: 0.294 Test Loss: 2.213 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2703330516815186
Epoch: 48, Steps: 12 | Train Loss: 1.954 Vali Loss: 2.198 Vali Acc: 0.328 Test Loss: 2.198 Test Acc: 0.328
Validation loss decreased (-0.311089 --> -0.327756).  Saving model ...
Epoch: 49 cost time: 1.2139387130737305
Epoch: 49, Steps: 12 | Train Loss: 1.948 Vali Loss: 2.181 Vali Acc: 0.333 Test Loss: 2.181 Test Acc: 0.333
Validation loss decreased (-0.327756 --> -0.333312).  Saving model ...
Epoch: 50 cost time: 0.9570090770721436
Epoch: 50, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.199 Vali Acc: 0.322 Test Loss: 2.199 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0558545589447021
Epoch: 51, Steps: 12 | Train Loss: 1.917 Vali Loss: 2.193 Vali Acc: 0.311 Test Loss: 2.193 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.08131742477417
Epoch: 52, Steps: 12 | Train Loss: 1.918 Vali Loss: 2.176 Vali Acc: 0.317 Test Loss: 2.176 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0751876831054688
Epoch: 53, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.156 Vali Acc: 0.339 Test Loss: 2.156 Test Acc: 0.339
Validation loss decreased (-0.333312 --> -0.338867).  Saving model ...
Epoch: 54 cost time: 1.077695369720459
Epoch: 54, Steps: 12 | Train Loss: 1.892 Vali Loss: 2.179 Vali Acc: 0.311 Test Loss: 2.179 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0546824932098389
Epoch: 55, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.173 Vali Acc: 0.294 Test Loss: 2.173 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.130056381225586
Epoch: 56, Steps: 12 | Train Loss: 1.914 Vali Loss: 2.159 Vali Acc: 0.261 Test Loss: 2.159 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.047708511352539
Epoch: 57, Steps: 12 | Train Loss: 1.888 Vali Loss: 2.127 Vali Acc: 0.250 Test Loss: 2.127 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0858738422393799
Epoch: 58, Steps: 12 | Train Loss: 1.939 Vali Loss: 2.125 Vali Acc: 0.272 Test Loss: 2.125 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.2786428928375244
Epoch: 59, Steps: 12 | Train Loss: 1.941 Vali Loss: 2.139 Vali Acc: 0.283 Test Loss: 2.139 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.1905531883239746
Epoch: 60, Steps: 12 | Train Loss: 1.866 Vali Loss: 2.134 Vali Acc: 0.306 Test Loss: 2.134 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1672587394714355
Epoch: 61, Steps: 12 | Train Loss: 1.898 Vali Loss: 2.142 Vali Acc: 0.300 Test Loss: 2.142 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.11800217628479
Epoch: 62, Steps: 12 | Train Loss: 1.877 Vali Loss: 2.147 Vali Acc: 0.294 Test Loss: 2.147 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.0541324615478516
Epoch: 63, Steps: 12 | Train Loss: 1.880 Vali Loss: 2.171 Vali Acc: 0.267 Test Loss: 2.171 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3388888888888889
model parameter : 49083
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.928232431411743
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.738 Vali Acc: 0.061 Test Loss: 2.738 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.0120158195495605
Epoch: 2, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.728 Vali Acc: 0.067 Test Loss: 2.728 Test Acc: 0.067
Validation loss decreased (-0.061084 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 1.139197826385498
Epoch: 3, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.710 Vali Acc: 0.061 Test Loss: 2.710 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0162959098815918
Epoch: 4, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.664 Vali Acc: 0.072 Test Loss: 2.664 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072196).  Saving model ...
Epoch: 5 cost time: 1.159477949142456
Epoch: 5, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.670 Vali Acc: 0.078 Test Loss: 2.670 Test Acc: 0.078
Validation loss decreased (-0.072196 --> -0.077751).  Saving model ...
Epoch: 6 cost time: 0.9477028846740723
Epoch: 6, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.656 Vali Acc: 0.106 Test Loss: 2.656 Test Acc: 0.106
Validation loss decreased (-0.077751 --> -0.105529).  Saving model ...
Epoch: 7 cost time: 1.1106534004211426
Epoch: 7, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.623 Vali Acc: 0.106 Test Loss: 2.623 Test Acc: 0.106
Validation loss decreased (-0.105529 --> -0.105529).  Saving model ...
Epoch: 8 cost time: 0.9412708282470703
Epoch: 8, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.609 Vali Acc: 0.144 Test Loss: 2.609 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144418).  Saving model ...
Epoch: 9 cost time: 0.9504084587097168
Epoch: 9, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.589 Vali Acc: 0.139 Test Loss: 2.589 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1783876419067383
Epoch: 10, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.588 Vali Acc: 0.122 Test Loss: 2.588 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9446074962615967
Epoch: 11, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.559 Vali Acc: 0.133 Test Loss: 2.559 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9283604621887207
Epoch: 12, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.542 Vali Acc: 0.128 Test Loss: 2.542 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0555830001831055
Epoch: 13, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.522 Vali Acc: 0.156 Test Loss: 2.522 Test Acc: 0.156
Validation loss decreased (-0.144418 --> -0.155530).  Saving model ...
Epoch: 14 cost time: 0.9573864936828613
Epoch: 14, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.512 Vali Acc: 0.183 Test Loss: 2.512 Test Acc: 0.183
Validation loss decreased (-0.155530 --> -0.183308).  Saving model ...
Epoch: 15 cost time: 0.9722237586975098
Epoch: 15, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.499 Vali Acc: 0.178 Test Loss: 2.499 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9460704326629639
Epoch: 16, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.476 Vali Acc: 0.167 Test Loss: 2.476 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0941085815429688
Epoch: 17, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.460 Vali Acc: 0.194 Test Loss: 2.460 Test Acc: 0.194
Validation loss decreased (-0.183308 --> -0.194420).  Saving model ...
Epoch: 18 cost time: 1.0388715267181396
Epoch: 18, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.448 Vali Acc: 0.183 Test Loss: 2.448 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.916384220123291
Epoch: 19, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.409 Vali Acc: 0.183 Test Loss: 2.409 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.099367618560791
Epoch: 20, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.397 Vali Acc: 0.183 Test Loss: 2.397 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0096642971038818
Epoch: 21, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.369 Vali Acc: 0.200 Test Loss: 2.369 Test Acc: 0.200
Validation loss decreased (-0.194420 --> -0.199976).  Saving model ...
Epoch: 22 cost time: 0.9483146667480469
Epoch: 22, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.365 Vali Acc: 0.167 Test Loss: 2.365 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9672584533691406
Epoch: 23, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.359 Vali Acc: 0.189 Test Loss: 2.359 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.002495527267456
Epoch: 24, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.345 Vali Acc: 0.194 Test Loss: 2.345 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9588165283203125
Epoch: 25, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.352 Vali Acc: 0.217 Test Loss: 2.352 Test Acc: 0.217
Validation loss decreased (-0.199976 --> -0.216643).  Saving model ...
Epoch: 26 cost time: 0.8773541450500488
Epoch: 26, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.362 Vali Acc: 0.206 Test Loss: 2.362 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9798340797424316
Epoch: 27, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.347 Vali Acc: 0.189 Test Loss: 2.347 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.02901291847229
Epoch: 28, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.323 Vali Acc: 0.194 Test Loss: 2.323 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0529181957244873
Epoch: 29, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.303 Vali Acc: 0.194 Test Loss: 2.303 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8260924816131592
Epoch: 30, Steps: 12 | Train Loss: 2.172 Vali Loss: 2.289 Vali Acc: 0.172 Test Loss: 2.289 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8605291843414307
Epoch: 31, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.253 Vali Acc: 0.222 Test Loss: 2.253 Test Acc: 0.222
Validation loss decreased (-0.216643 --> -0.222200).  Saving model ...
Epoch: 32 cost time: 0.9820964336395264
Epoch: 32, Steps: 12 | Train Loss: 2.075 Vali Loss: 2.248 Vali Acc: 0.228 Test Loss: 2.248 Test Acc: 0.228
Validation loss decreased (-0.222200 --> -0.227755).  Saving model ...
Epoch: 33 cost time: 1.009643793106079
Epoch: 33, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.252 Vali Acc: 0.233 Test Loss: 2.252 Test Acc: 0.233
Validation loss decreased (-0.227755 --> -0.233311).  Saving model ...
Epoch: 34 cost time: 1.0576395988464355
Epoch: 34, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.254 Vali Acc: 0.217 Test Loss: 2.254 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9652202129364014
Epoch: 35, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.245 Vali Acc: 0.222 Test Loss: 2.245 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.923525333404541
Epoch: 36, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.225 Vali Acc: 0.217 Test Loss: 2.225 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0472750663757324
Epoch: 37, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.224 Vali Acc: 0.211 Test Loss: 2.224 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2223656177520752
Epoch: 38, Steps: 12 | Train Loss: 1.956 Vali Loss: 2.210 Vali Acc: 0.261 Test Loss: 2.210 Test Acc: 0.261
Validation loss decreased (-0.233311 --> -0.261089).  Saving model ...
Epoch: 39 cost time: 1.3192291259765625
Epoch: 39, Steps: 12 | Train Loss: 1.952 Vali Loss: 2.201 Vali Acc: 0.244 Test Loss: 2.201 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1509225368499756
Epoch: 40, Steps: 12 | Train Loss: 1.974 Vali Loss: 2.182 Vali Acc: 0.222 Test Loss: 2.182 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.406672716140747
Epoch: 41, Steps: 12 | Train Loss: 1.957 Vali Loss: 2.167 Vali Acc: 0.233 Test Loss: 2.167 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1783053874969482
Epoch: 42, Steps: 12 | Train Loss: 2.003 Vali Loss: 2.201 Vali Acc: 0.233 Test Loss: 2.201 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1109304428100586
Epoch: 43, Steps: 12 | Train Loss: 1.971 Vali Loss: 2.190 Vali Acc: 0.228 Test Loss: 2.190 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0572874546051025
Epoch: 44, Steps: 12 | Train Loss: 1.907 Vali Loss: 2.182 Vali Acc: 0.244 Test Loss: 2.182 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2153172492980957
Epoch: 45, Steps: 12 | Train Loss: 1.952 Vali Loss: 2.195 Vali Acc: 0.233 Test Loss: 2.195 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1692898273468018
Epoch: 46, Steps: 12 | Train Loss: 1.965 Vali Loss: 2.193 Vali Acc: 0.228 Test Loss: 2.193 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.995551347732544
Epoch: 47, Steps: 12 | Train Loss: 1.954 Vali Loss: 2.168 Vali Acc: 0.244 Test Loss: 2.168 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3141248226165771
Epoch: 48, Steps: 12 | Train Loss: 1.920 Vali Loss: 2.206 Vali Acc: 0.244 Test Loss: 2.206 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2611111111111111
model parameter : 48571
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.943955659866333
Epoch: 1, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.709 Vali Acc: 0.122 Test Loss: 2.709 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 1.1938977241516113
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.689 Vali Acc: 0.128 Test Loss: 2.689 Test Acc: 0.128
Validation loss decreased (-0.122195 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.8526692390441895
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.644 Vali Acc: 0.144 Test Loss: 2.644 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.9417436122894287
Epoch: 4, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.656 Vali Acc: 0.111 Test Loss: 2.656 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0418760776519775
Epoch: 5, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0471808910369873
Epoch: 6, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.618 Vali Acc: 0.133 Test Loss: 2.618 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0184326171875
Epoch: 7, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.590 Vali Acc: 0.133 Test Loss: 2.590 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.153343677520752
Epoch: 8, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.575 Vali Acc: 0.150 Test Loss: 2.575 Test Acc: 0.150
Validation loss decreased (-0.144418 --> -0.149974).  Saving model ...
Epoch: 9 cost time: 0.8758187294006348
Epoch: 9, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.545 Vali Acc: 0.206 Test Loss: 2.545 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205530).  Saving model ...
Epoch: 10 cost time: 1.0050830841064453
Epoch: 10, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.537 Vali Acc: 0.194 Test Loss: 2.537 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9545156955718994
Epoch: 11, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.521 Vali Acc: 0.189 Test Loss: 2.521 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9422690868377686
Epoch: 12, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.498 Vali Acc: 0.206 Test Loss: 2.498 Test Acc: 0.206
Validation loss decreased (-0.205530 --> -0.205531).  Saving model ...
Epoch: 13 cost time: 0.8655383586883545
Epoch: 13, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.486 Vali Acc: 0.194 Test Loss: 2.486 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9017677307128906
Epoch: 14, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.467 Vali Acc: 0.156 Test Loss: 2.467 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8583934307098389
Epoch: 15, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.444 Vali Acc: 0.189 Test Loss: 2.444 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0556249618530273
Epoch: 16, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.421 Vali Acc: 0.194 Test Loss: 2.421 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6636784076690674
Epoch: 17, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.406 Vali Acc: 0.228 Test Loss: 2.406 Test Acc: 0.228
Validation loss decreased (-0.205531 --> -0.227754).  Saving model ...
Epoch: 18 cost time: 0.7326421737670898
Epoch: 18, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.380 Vali Acc: 0.244 Test Loss: 2.380 Test Acc: 0.244
Validation loss decreased (-0.227754 --> -0.244421).  Saving model ...
Epoch: 19 cost time: 0.6977145671844482
Epoch: 19, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.375 Vali Acc: 0.239 Test Loss: 2.375 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9724335670471191
Epoch: 20, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.362 Vali Acc: 0.261 Test Loss: 2.362 Test Acc: 0.261
Validation loss decreased (-0.244421 --> -0.261087).  Saving model ...
Epoch: 21 cost time: 0.8659486770629883
Epoch: 21, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.344 Vali Acc: 0.256 Test Loss: 2.344 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8844194412231445
Epoch: 22, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.356 Vali Acc: 0.233 Test Loss: 2.356 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8357830047607422
Epoch: 23, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.318 Vali Acc: 0.228 Test Loss: 2.318 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9407036304473877
Epoch: 24, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.311 Vali Acc: 0.250 Test Loss: 2.311 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.198556900024414
Epoch: 25, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.271 Vali Acc: 0.278 Test Loss: 2.271 Test Acc: 0.278
Validation loss decreased (-0.261087 --> -0.277755).  Saving model ...
Epoch: 26 cost time: 0.8585054874420166
Epoch: 26, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.255 Vali Acc: 0.261 Test Loss: 2.255 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7000374794006348
Epoch: 27, Steps: 12 | Train Loss: 2.073 Vali Loss: 2.227 Vali Acc: 0.283 Test Loss: 2.227 Test Acc: 0.283
Validation loss decreased (-0.277755 --> -0.283311).  Saving model ...
Epoch: 28 cost time: 0.7253868579864502
Epoch: 28, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.226 Vali Acc: 0.244 Test Loss: 2.226 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8890280723571777
Epoch: 29, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.198 Vali Acc: 0.306 Test Loss: 2.198 Test Acc: 0.306
Validation loss decreased (-0.283311 --> -0.305534).  Saving model ...
Epoch: 30 cost time: 1.0886013507843018
Epoch: 30, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.202 Vali Acc: 0.256 Test Loss: 2.202 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9779887199401855
Epoch: 31, Steps: 12 | Train Loss: 2.049 Vali Loss: 2.218 Vali Acc: 0.289 Test Loss: 2.218 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7536725997924805
Epoch: 32, Steps: 12 | Train Loss: 2.066 Vali Loss: 2.208 Vali Acc: 0.267 Test Loss: 2.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9099459648132324
Epoch: 33, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.196 Vali Acc: 0.294 Test Loss: 2.196 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8482973575592041
Epoch: 34, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.189 Vali Acc: 0.256 Test Loss: 2.189 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7718169689178467
Epoch: 35, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.194 Vali Acc: 0.278 Test Loss: 2.194 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9512350559234619
Epoch: 36, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.192 Vali Acc: 0.283 Test Loss: 2.192 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7909812927246094
Epoch: 37, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.180 Vali Acc: 0.283 Test Loss: 2.180 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9175186157226562
Epoch: 38, Steps: 12 | Train Loss: 1.977 Vali Loss: 2.158 Vali Acc: 0.306 Test Loss: 2.158 Test Acc: 0.306
Validation loss decreased (-0.305534 --> -0.305534).  Saving model ...
Epoch: 39 cost time: 1.0060348510742188
Epoch: 39, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.142 Vali Acc: 0.306 Test Loss: 2.142 Test Acc: 0.306
Validation loss decreased (-0.305534 --> -0.305534).  Saving model ...
Epoch: 40 cost time: 0.7738640308380127
Epoch: 40, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.154 Vali Acc: 0.289 Test Loss: 2.154 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7539312839508057
Epoch: 41, Steps: 12 | Train Loss: 1.958 Vali Loss: 2.137 Vali Acc: 0.256 Test Loss: 2.137 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9548494815826416
Epoch: 42, Steps: 12 | Train Loss: 1.929 Vali Loss: 2.154 Vali Acc: 0.272 Test Loss: 2.154 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9951272010803223
Epoch: 43, Steps: 12 | Train Loss: 1.931 Vali Loss: 2.137 Vali Acc: 0.311 Test Loss: 2.137 Test Acc: 0.311
Validation loss decreased (-0.305534 --> -0.311090).  Saving model ...
Epoch: 44 cost time: 0.9467878341674805
Epoch: 44, Steps: 12 | Train Loss: 1.918 Vali Loss: 2.115 Vali Acc: 0.261 Test Loss: 2.115 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8544490337371826
Epoch: 45, Steps: 12 | Train Loss: 1.972 Vali Loss: 2.120 Vali Acc: 0.272 Test Loss: 2.120 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8596556186676025
Epoch: 46, Steps: 12 | Train Loss: 1.885 Vali Loss: 2.120 Vali Acc: 0.283 Test Loss: 2.120 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8064515590667725
Epoch: 47, Steps: 12 | Train Loss: 1.944 Vali Loss: 2.109 Vali Acc: 0.306 Test Loss: 2.109 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8554787635803223
Epoch: 48, Steps: 12 | Train Loss: 1.898 Vali Loss: 2.119 Vali Acc: 0.311 Test Loss: 2.119 Test Acc: 0.311
Validation loss decreased (-0.311090 --> -0.311090).  Saving model ...
Epoch: 49 cost time: 0.9437704086303711
Epoch: 49, Steps: 12 | Train Loss: 1.927 Vali Loss: 2.112 Vali Acc: 0.283 Test Loss: 2.112 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1441612243652344
Epoch: 50, Steps: 12 | Train Loss: 1.865 Vali Loss: 2.102 Vali Acc: 0.311 Test Loss: 2.102 Test Acc: 0.311
Validation loss decreased (-0.311090 --> -0.311090).  Saving model ...
Epoch: 51 cost time: 0.966158390045166
Epoch: 51, Steps: 12 | Train Loss: 1.939 Vali Loss: 2.117 Vali Acc: 0.289 Test Loss: 2.117 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.954453706741333
Epoch: 52, Steps: 12 | Train Loss: 1.866 Vali Loss: 2.097 Vali Acc: 0.283 Test Loss: 2.097 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9748826026916504
Epoch: 53, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.101 Vali Acc: 0.256 Test Loss: 2.101 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9140517711639404
Epoch: 54, Steps: 12 | Train Loss: 1.916 Vali Loss: 2.085 Vali Acc: 0.294 Test Loss: 2.085 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9118058681488037
Epoch: 55, Steps: 12 | Train Loss: 1.844 Vali Loss: 2.077 Vali Acc: 0.306 Test Loss: 2.077 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.8756837844848633
Epoch: 56, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.089 Vali Acc: 0.294 Test Loss: 2.089 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9329373836517334
Epoch: 57, Steps: 12 | Train Loss: 1.908 Vali Loss: 2.077 Vali Acc: 0.283 Test Loss: 2.077 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9674158096313477
Epoch: 58, Steps: 12 | Train Loss: 1.890 Vali Loss: 2.102 Vali Acc: 0.250 Test Loss: 2.102 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8739883899688721
Epoch: 59, Steps: 12 | Train Loss: 1.870 Vali Loss: 2.101 Vali Acc: 0.272 Test Loss: 2.101 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.8883204460144043
Epoch: 60, Steps: 12 | Train Loss: 1.835 Vali Loss: 2.200 Vali Acc: 0.267 Test Loss: 2.200 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3111111111111111
model parameter : 48059
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.497213125228882
Epoch: 1, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.709 Vali Acc: 0.122 Test Loss: 2.709 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.7261393070220947
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.689 Vali Acc: 0.128 Test Loss: 2.689 Test Acc: 0.128
Validation loss decreased (-0.122195 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.9071102142333984
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.644 Vali Acc: 0.144 Test Loss: 2.644 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.7472836971282959
Epoch: 4, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.656 Vali Acc: 0.111 Test Loss: 2.656 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8076584339141846
Epoch: 5, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8083429336547852
Epoch: 6, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.618 Vali Acc: 0.133 Test Loss: 2.618 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9771935939788818
Epoch: 7, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.590 Vali Acc: 0.133 Test Loss: 2.590 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0881586074829102
Epoch: 8, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.575 Vali Acc: 0.150 Test Loss: 2.575 Test Acc: 0.150
Validation loss decreased (-0.144418 --> -0.149974).  Saving model ...
Epoch: 9 cost time: 1.025076150894165
Epoch: 9, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.545 Vali Acc: 0.206 Test Loss: 2.545 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205530).  Saving model ...
Epoch: 10 cost time: 0.8412189483642578
Epoch: 10, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.537 Vali Acc: 0.194 Test Loss: 2.537 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9655900001525879
Epoch: 11, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.521 Vali Acc: 0.189 Test Loss: 2.521 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8469898700714111
Epoch: 12, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.498 Vali Acc: 0.206 Test Loss: 2.498 Test Acc: 0.206
Validation loss decreased (-0.205530 --> -0.205531).  Saving model ...
Epoch: 13 cost time: 1.0364387035369873
Epoch: 13, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.486 Vali Acc: 0.194 Test Loss: 2.486 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9042088985443115
Epoch: 14, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.467 Vali Acc: 0.156 Test Loss: 2.467 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7625298500061035
Epoch: 15, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.444 Vali Acc: 0.189 Test Loss: 2.444 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.920928955078125
Epoch: 16, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.421 Vali Acc: 0.194 Test Loss: 2.421 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7312281131744385
Epoch: 17, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.406 Vali Acc: 0.228 Test Loss: 2.406 Test Acc: 0.228
Validation loss decreased (-0.205531 --> -0.227754).  Saving model ...
Epoch: 18 cost time: 0.818523645401001
Epoch: 18, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.380 Vali Acc: 0.244 Test Loss: 2.380 Test Acc: 0.244
Validation loss decreased (-0.227754 --> -0.244421).  Saving model ...
Epoch: 19 cost time: 0.9828662872314453
Epoch: 19, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.375 Vali Acc: 0.239 Test Loss: 2.375 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3809545040130615
Epoch: 20, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.362 Vali Acc: 0.261 Test Loss: 2.362 Test Acc: 0.261
Validation loss decreased (-0.244421 --> -0.261087).  Saving model ...
Epoch: 21 cost time: 1.1029059886932373
Epoch: 21, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.344 Vali Acc: 0.256 Test Loss: 2.344 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.807166576385498
Epoch: 22, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.356 Vali Acc: 0.233 Test Loss: 2.356 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8242001533508301
Epoch: 23, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.318 Vali Acc: 0.228 Test Loss: 2.318 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8713700771331787
Epoch: 24, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.311 Vali Acc: 0.250 Test Loss: 2.311 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0424697399139404
Epoch: 25, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.271 Vali Acc: 0.278 Test Loss: 2.271 Test Acc: 0.278
Validation loss decreased (-0.261087 --> -0.277755).  Saving model ...
Epoch: 26 cost time: 0.8509142398834229
Epoch: 26, Steps: 12 | Train Loss: 2.100 Vali Loss: 2.255 Vali Acc: 0.261 Test Loss: 2.255 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9870409965515137
Epoch: 27, Steps: 12 | Train Loss: 2.073 Vali Loss: 2.227 Vali Acc: 0.283 Test Loss: 2.227 Test Acc: 0.283
Validation loss decreased (-0.277755 --> -0.283311).  Saving model ...
Epoch: 28 cost time: 0.8706498146057129
Epoch: 28, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.226 Vali Acc: 0.244 Test Loss: 2.226 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9727768898010254
Epoch: 29, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.198 Vali Acc: 0.306 Test Loss: 2.198 Test Acc: 0.306
Validation loss decreased (-0.283311 --> -0.305534).  Saving model ...
Epoch: 30 cost time: 0.8427865505218506
Epoch: 30, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.202 Vali Acc: 0.256 Test Loss: 2.202 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.937645673751831
Epoch: 31, Steps: 12 | Train Loss: 2.049 Vali Loss: 2.218 Vali Acc: 0.289 Test Loss: 2.218 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7412970066070557
Epoch: 32, Steps: 12 | Train Loss: 2.066 Vali Loss: 2.208 Vali Acc: 0.267 Test Loss: 2.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0775291919708252
Epoch: 33, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.196 Vali Acc: 0.294 Test Loss: 2.196 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8704254627227783
Epoch: 34, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.189 Vali Acc: 0.256 Test Loss: 2.189 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0758514404296875
Epoch: 35, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.194 Vali Acc: 0.278 Test Loss: 2.194 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1695027351379395
Epoch: 36, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.192 Vali Acc: 0.283 Test Loss: 2.192 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8743646144866943
Epoch: 37, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.180 Vali Acc: 0.283 Test Loss: 2.180 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8797242641448975
Epoch: 38, Steps: 12 | Train Loss: 1.977 Vali Loss: 2.158 Vali Acc: 0.306 Test Loss: 2.158 Test Acc: 0.306
Validation loss decreased (-0.305534 --> -0.305534).  Saving model ...
Epoch: 39 cost time: 0.865058422088623
Epoch: 39, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.142 Vali Acc: 0.306 Test Loss: 2.142 Test Acc: 0.306
Validation loss decreased (-0.305534 --> -0.305534).  Saving model ...
Epoch: 40 cost time: 0.8083674907684326
Epoch: 40, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.154 Vali Acc: 0.289 Test Loss: 2.154 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9066689014434814
Epoch: 41, Steps: 12 | Train Loss: 1.958 Vali Loss: 2.137 Vali Acc: 0.256 Test Loss: 2.137 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0477547645568848
Epoch: 42, Steps: 12 | Train Loss: 1.929 Vali Loss: 2.154 Vali Acc: 0.272 Test Loss: 2.154 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7692966461181641
Epoch: 43, Steps: 12 | Train Loss: 1.931 Vali Loss: 2.137 Vali Acc: 0.311 Test Loss: 2.137 Test Acc: 0.311
Validation loss decreased (-0.305534 --> -0.311090).  Saving model ...
Epoch: 44 cost time: 0.9101274013519287
Epoch: 44, Steps: 12 | Train Loss: 1.918 Vali Loss: 2.115 Vali Acc: 0.261 Test Loss: 2.115 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9585006237030029
Epoch: 45, Steps: 12 | Train Loss: 1.972 Vali Loss: 2.120 Vali Acc: 0.272 Test Loss: 2.120 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0816619396209717
Epoch: 46, Steps: 12 | Train Loss: 1.885 Vali Loss: 2.120 Vali Acc: 0.283 Test Loss: 2.120 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9588968753814697
Epoch: 47, Steps: 12 | Train Loss: 1.944 Vali Loss: 2.109 Vali Acc: 0.306 Test Loss: 2.109 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9154098033905029
Epoch: 48, Steps: 12 | Train Loss: 1.898 Vali Loss: 2.119 Vali Acc: 0.311 Test Loss: 2.119 Test Acc: 0.311
Validation loss decreased (-0.311090 --> -0.311090).  Saving model ...
Epoch: 49 cost time: 0.8052384853363037
Epoch: 49, Steps: 12 | Train Loss: 1.927 Vali Loss: 2.112 Vali Acc: 0.283 Test Loss: 2.112 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.086611032485962
Epoch: 50, Steps: 12 | Train Loss: 1.865 Vali Loss: 2.102 Vali Acc: 0.311 Test Loss: 2.102 Test Acc: 0.311
Validation loss decreased (-0.311090 --> -0.311090).  Saving model ...
Epoch: 51 cost time: 0.8376402854919434
Epoch: 51, Steps: 12 | Train Loss: 1.939 Vali Loss: 2.117 Vali Acc: 0.289 Test Loss: 2.117 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9064080715179443
Epoch: 52, Steps: 12 | Train Loss: 1.866 Vali Loss: 2.097 Vali Acc: 0.283 Test Loss: 2.097 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.002676248550415
Epoch: 53, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.101 Vali Acc: 0.256 Test Loss: 2.101 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1836097240447998
Epoch: 54, Steps: 12 | Train Loss: 1.916 Vali Loss: 2.085 Vali Acc: 0.294 Test Loss: 2.085 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1618905067443848
Epoch: 55, Steps: 12 | Train Loss: 1.844 Vali Loss: 2.077 Vali Acc: 0.306 Test Loss: 2.077 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.186906099319458
Epoch: 56, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.089 Vali Acc: 0.294 Test Loss: 2.089 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.1077284812927246
Epoch: 57, Steps: 12 | Train Loss: 1.908 Vali Loss: 2.077 Vali Acc: 0.283 Test Loss: 2.077 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0940272808074951
Epoch: 58, Steps: 12 | Train Loss: 1.890 Vali Loss: 2.102 Vali Acc: 0.250 Test Loss: 2.102 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.2033236026763916
Epoch: 59, Steps: 12 | Train Loss: 1.870 Vali Loss: 2.101 Vali Acc: 0.272 Test Loss: 2.101 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.999420166015625
Epoch: 60, Steps: 12 | Train Loss: 1.835 Vali Loss: 2.200 Vali Acc: 0.267 Test Loss: 2.200 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3111111111111111
model parameter : 48059
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.160217046737671
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.764 Vali Acc: 0.061 Test Loss: 2.764 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.117384672164917
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.750 Vali Acc: 0.072 Test Loss: 2.750 Test Acc: 0.072
Validation loss decreased (-0.061083 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 1.030583381652832
Epoch: 3, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.732 Vali Acc: 0.067 Test Loss: 2.732 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4265930652618408
Epoch: 4, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.720 Vali Acc: 0.106 Test Loss: 2.720 Test Acc: 0.106
Validation loss decreased (-0.072195 --> -0.105528).  Saving model ...
Epoch: 5 cost time: 1.3966588973999023
Epoch: 5, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.713 Vali Acc: 0.139 Test Loss: 2.713 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138862).  Saving model ...
Epoch: 6 cost time: 1.1764183044433594
Epoch: 6, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.699 Vali Acc: 0.144 Test Loss: 2.699 Test Acc: 0.144
Validation loss decreased (-0.138862 --> -0.144417).  Saving model ...
Epoch: 7 cost time: 1.37042236328125
Epoch: 7, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.665 Vali Acc: 0.150 Test Loss: 2.665 Test Acc: 0.150
Validation loss decreased (-0.144417 --> -0.149973).  Saving model ...
Epoch: 8 cost time: 1.1626272201538086
Epoch: 8, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.659 Vali Acc: 0.122 Test Loss: 2.659 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5439696311950684
Epoch: 9, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.641 Vali Acc: 0.128 Test Loss: 2.641 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0996711254119873
Epoch: 10, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.614 Vali Acc: 0.128 Test Loss: 2.614 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2017083168029785
Epoch: 11, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.593 Vali Acc: 0.167 Test Loss: 2.593 Test Acc: 0.167
Validation loss decreased (-0.149973 --> -0.166641).  Saving model ...
Epoch: 12 cost time: 1.3115122318267822
Epoch: 12, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.576 Vali Acc: 0.178 Test Loss: 2.576 Test Acc: 0.178
Validation loss decreased (-0.166641 --> -0.177752).  Saving model ...
Epoch: 13 cost time: 1.1920444965362549
Epoch: 13, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.562 Vali Acc: 0.172 Test Loss: 2.562 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0887792110443115
Epoch: 14, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.551 Vali Acc: 0.167 Test Loss: 2.551 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1871070861816406
Epoch: 15, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.531 Vali Acc: 0.211 Test Loss: 2.531 Test Acc: 0.211
Validation loss decreased (-0.177752 --> -0.211086).  Saving model ...
Epoch: 16 cost time: 1.5346450805664062
Epoch: 16, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.519 Vali Acc: 0.183 Test Loss: 2.519 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3641812801361084
Epoch: 17, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.523 Vali Acc: 0.167 Test Loss: 2.523 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.11961030960083
Epoch: 18, Steps: 12 | Train Loss: 2.375 Vali Loss: 2.509 Vali Acc: 0.161 Test Loss: 2.509 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3217148780822754
Epoch: 19, Steps: 12 | Train Loss: 2.307 Vali Loss: 2.496 Vali Acc: 0.161 Test Loss: 2.496 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0522618293762207
Epoch: 20, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.476 Vali Acc: 0.206 Test Loss: 2.476 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.420954704284668
Epoch: 21, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.455 Vali Acc: 0.211 Test Loss: 2.455 Test Acc: 0.211
Validation loss decreased (-0.211086 --> -0.211087).  Saving model ...
Epoch: 22 cost time: 0.957277774810791
Epoch: 22, Steps: 12 | Train Loss: 2.269 Vali Loss: 2.435 Vali Acc: 0.228 Test Loss: 2.435 Test Acc: 0.228
Validation loss decreased (-0.211087 --> -0.227753).  Saving model ...
Epoch: 23 cost time: 1.1457643508911133
Epoch: 23, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.421 Vali Acc: 0.250 Test Loss: 2.421 Test Acc: 0.250
Validation loss decreased (-0.227753 --> -0.249976).  Saving model ...
Epoch: 24 cost time: 1.09639573097229
Epoch: 24, Steps: 12 | Train Loss: 2.242 Vali Loss: 2.406 Vali Acc: 0.261 Test Loss: 2.406 Test Acc: 0.261
Validation loss decreased (-0.249976 --> -0.261087).  Saving model ...
Epoch: 25 cost time: 1.146003007888794
Epoch: 25, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.379 Vali Acc: 0.267 Test Loss: 2.379 Test Acc: 0.267
Validation loss decreased (-0.261087 --> -0.266643).  Saving model ...
Epoch: 26 cost time: 1.1322970390319824
Epoch: 26, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.360 Vali Acc: 0.261 Test Loss: 2.360 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4299731254577637
Epoch: 27, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.342 Vali Acc: 0.250 Test Loss: 2.342 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9875986576080322
Epoch: 28, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.322 Vali Acc: 0.244 Test Loss: 2.322 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9610223770141602
Epoch: 29, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.308 Vali Acc: 0.233 Test Loss: 2.308 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3224072456359863
Epoch: 30, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.307 Vali Acc: 0.250 Test Loss: 2.307 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.323974847793579
Epoch: 31, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.291 Vali Acc: 0.261 Test Loss: 2.291 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2398090362548828
Epoch: 32, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.283 Vali Acc: 0.244 Test Loss: 2.283 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9522566795349121
Epoch: 33, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.269 Vali Acc: 0.239 Test Loss: 2.269 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9988243579864502
Epoch: 34, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.254 Vali Acc: 0.239 Test Loss: 2.254 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2697200775146484
Epoch: 35, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.242 Vali Acc: 0.233 Test Loss: 2.242 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.26666666666666666
model parameter : 26043
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.575389862060547
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.705 Vali Acc: 0.072 Test Loss: 2.705 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.8312702178955078
Epoch: 2, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.689 Vali Acc: 0.072 Test Loss: 2.689 Test Acc: 0.072
Validation loss decreased (-0.072195 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.9558539390563965
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.677 Vali Acc: 0.072 Test Loss: 2.677 Test Acc: 0.072
Validation loss decreased (-0.072195 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 0.837181806564331
Epoch: 4, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.661 Vali Acc: 0.122 Test Loss: 2.661 Test Acc: 0.122
Validation loss decreased (-0.072195 --> -0.122196).  Saving model ...
Epoch: 5 cost time: 1.1919715404510498
Epoch: 5, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.646 Vali Acc: 0.133 Test Loss: 2.646 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 1.2159550189971924
Epoch: 6, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.614 Vali Acc: 0.128 Test Loss: 2.614 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.101571798324585
Epoch: 7, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.615 Vali Acc: 0.117 Test Loss: 2.615 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3865771293640137
Epoch: 8, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.596 Vali Acc: 0.122 Test Loss: 2.596 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.106224536895752
Epoch: 9, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.582 Vali Acc: 0.122 Test Loss: 2.582 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1706736087799072
Epoch: 10, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.577 Vali Acc: 0.144 Test Loss: 2.577 Test Acc: 0.144
Validation loss decreased (-0.133307 --> -0.144419).  Saving model ...
Epoch: 11 cost time: 1.0809988975524902
Epoch: 11, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.549 Vali Acc: 0.156 Test Loss: 2.549 Test Acc: 0.156
Validation loss decreased (-0.144419 --> -0.155530).  Saving model ...
Epoch: 12 cost time: 0.8644864559173584
Epoch: 12, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.531 Vali Acc: 0.167 Test Loss: 2.531 Test Acc: 0.167
Validation loss decreased (-0.155530 --> -0.166641).  Saving model ...
Epoch: 13 cost time: 1.1832761764526367
Epoch: 13, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.524 Vali Acc: 0.183 Test Loss: 2.524 Test Acc: 0.183
Validation loss decreased (-0.166641 --> -0.183308).  Saving model ...
Epoch: 14 cost time: 1.0274455547332764
Epoch: 14, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.504 Vali Acc: 0.200 Test Loss: 2.504 Test Acc: 0.200
Validation loss decreased (-0.183308 --> -0.199975).  Saving model ...
Epoch: 15 cost time: 1.1229918003082275
Epoch: 15, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.478 Vali Acc: 0.183 Test Loss: 2.478 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8974437713623047
Epoch: 16, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.454 Vali Acc: 0.222 Test Loss: 2.454 Test Acc: 0.222
Validation loss decreased (-0.199975 --> -0.222198).  Saving model ...
Epoch: 17 cost time: 0.9248733520507812
Epoch: 17, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.434 Vali Acc: 0.222 Test Loss: 2.434 Test Acc: 0.222
Validation loss decreased (-0.222198 --> -0.222198).  Saving model ...
Epoch: 18 cost time: 0.9911558628082275
Epoch: 18, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.428 Vali Acc: 0.250 Test Loss: 2.428 Test Acc: 0.250
Validation loss decreased (-0.222198 --> -0.249976).  Saving model ...
Epoch: 19 cost time: 1.0363585948944092
Epoch: 19, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.413 Vali Acc: 0.239 Test Loss: 2.413 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.218548059463501
Epoch: 20, Steps: 12 | Train Loss: 2.266 Vali Loss: 2.408 Vali Acc: 0.233 Test Loss: 2.408 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1938161849975586
Epoch: 21, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.395 Vali Acc: 0.256 Test Loss: 2.395 Test Acc: 0.256
Validation loss decreased (-0.249976 --> -0.255532).  Saving model ...
Epoch: 22 cost time: 1.1379573345184326
Epoch: 22, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.383 Vali Acc: 0.244 Test Loss: 2.383 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1461927890777588
Epoch: 23, Steps: 12 | Train Loss: 2.244 Vali Loss: 2.371 Vali Acc: 0.211 Test Loss: 2.371 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0998823642730713
Epoch: 24, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.360 Vali Acc: 0.217 Test Loss: 2.360 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2867095470428467
Epoch: 25, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.342 Vali Acc: 0.239 Test Loss: 2.342 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1358773708343506
Epoch: 26, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.334 Vali Acc: 0.222 Test Loss: 2.334 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0942609310150146
Epoch: 27, Steps: 12 | Train Loss: 2.144 Vali Loss: 2.314 Vali Acc: 0.222 Test Loss: 2.314 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2327685356140137
Epoch: 28, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.311 Vali Acc: 0.222 Test Loss: 2.311 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0694737434387207
Epoch: 29, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.292 Vali Acc: 0.228 Test Loss: 2.292 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1857936382293701
Epoch: 30, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.288 Vali Acc: 0.200 Test Loss: 2.288 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3373970985412598
Epoch: 31, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.291 Vali Acc: 0.211 Test Loss: 2.291 Test Acc: 0.211
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.25555555555555554
model parameter : 25787
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4336330890655518
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.737 Vali Acc: 0.050 Test Loss: 2.737 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.6424980163574219
Epoch: 2, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.721 Vali Acc: 0.056 Test Loss: 2.721 Test Acc: 0.056
Validation loss decreased (-0.049973 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 1.0686376094818115
Epoch: 3, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.700 Vali Acc: 0.072 Test Loss: 2.700 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 1.0364596843719482
Epoch: 4, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.681 Vali Acc: 0.089 Test Loss: 2.681 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 5 cost time: 1.1359713077545166
Epoch: 5, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.666 Vali Acc: 0.083 Test Loss: 2.666 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1045775413513184
Epoch: 6, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.648 Vali Acc: 0.094 Test Loss: 2.648 Test Acc: 0.094
Validation loss decreased (-0.088862 --> -0.094418).  Saving model ...
Epoch: 7 cost time: 1.2700777053833008
Epoch: 7, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.634 Vali Acc: 0.128 Test Loss: 2.634 Test Acc: 0.128
Validation loss decreased (-0.094418 --> -0.127751).  Saving model ...
Epoch: 8 cost time: 0.9733247756958008
Epoch: 8, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.618 Vali Acc: 0.122 Test Loss: 2.618 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1766204833984375
Epoch: 9, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.612 Vali Acc: 0.144 Test Loss: 2.612 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 10 cost time: 0.9034624099731445
Epoch: 10, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.593 Vali Acc: 0.133 Test Loss: 2.593 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9326052665710449
Epoch: 11, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.573 Vali Acc: 0.150 Test Loss: 2.573 Test Acc: 0.150
Validation loss decreased (-0.144418 --> -0.149974).  Saving model ...
Epoch: 12 cost time: 1.0513479709625244
Epoch: 12, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.555 Vali Acc: 0.178 Test Loss: 2.555 Test Acc: 0.178
Validation loss decreased (-0.149974 --> -0.177752).  Saving model ...
Epoch: 13 cost time: 0.9991991519927979
Epoch: 13, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.547 Vali Acc: 0.161 Test Loss: 2.547 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1753208637237549
Epoch: 14, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.533 Vali Acc: 0.133 Test Loss: 2.533 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.058746099472046
Epoch: 15, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.511 Vali Acc: 0.139 Test Loss: 2.511 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0461466312408447
Epoch: 16, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.496 Vali Acc: 0.183 Test Loss: 2.496 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183308).  Saving model ...
Epoch: 17 cost time: 1.1251561641693115
Epoch: 17, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.481 Vali Acc: 0.167 Test Loss: 2.481 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0559155941009521
Epoch: 18, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.466 Vali Acc: 0.189 Test Loss: 2.466 Test Acc: 0.189
Validation loss decreased (-0.183308 --> -0.188864).  Saving model ...
Epoch: 19 cost time: 1.0833110809326172
Epoch: 19, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.453 Vali Acc: 0.172 Test Loss: 2.453 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1656599044799805
Epoch: 20, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.442 Vali Acc: 0.183 Test Loss: 2.442 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.336932897567749
Epoch: 21, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.432 Vali Acc: 0.194 Test Loss: 2.432 Test Acc: 0.194
Validation loss decreased (-0.188864 --> -0.194420).  Saving model ...
Epoch: 22 cost time: 0.987403154373169
Epoch: 22, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.407 Vali Acc: 0.222 Test Loss: 2.407 Test Acc: 0.222
Validation loss decreased (-0.194420 --> -0.222198).  Saving model ...
Epoch: 23 cost time: 1.1096138954162598
Epoch: 23, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.396 Vali Acc: 0.222 Test Loss: 2.396 Test Acc: 0.222
Validation loss decreased (-0.222198 --> -0.222198).  Saving model ...
Epoch: 24 cost time: 1.3590826988220215
Epoch: 24, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.369 Vali Acc: 0.244 Test Loss: 2.369 Test Acc: 0.244
Validation loss decreased (-0.222198 --> -0.244421).  Saving model ...
Epoch: 25 cost time: 1.0928645133972168
Epoch: 25, Steps: 12 | Train Loss: 2.252 Vali Loss: 2.356 Vali Acc: 0.261 Test Loss: 2.356 Test Acc: 0.261
Validation loss decreased (-0.244421 --> -0.261088).  Saving model ...
Epoch: 26 cost time: 0.9405601024627686
Epoch: 26, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.356 Vali Acc: 0.250 Test Loss: 2.356 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3026416301727295
Epoch: 27, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.346 Vali Acc: 0.233 Test Loss: 2.346 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2401151657104492
Epoch: 28, Steps: 12 | Train Loss: 2.208 Vali Loss: 2.322 Vali Acc: 0.261 Test Loss: 2.322 Test Acc: 0.261
Validation loss decreased (-0.261088 --> -0.261088).  Saving model ...
Epoch: 29 cost time: 1.2029576301574707
Epoch: 29, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.318 Vali Acc: 0.283 Test Loss: 2.318 Test Acc: 0.283
Validation loss decreased (-0.261088 --> -0.283310).  Saving model ...
Epoch: 30 cost time: 1.2292976379394531
Epoch: 30, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.316 Vali Acc: 0.278 Test Loss: 2.316 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4850037097930908
Epoch: 31, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.290 Vali Acc: 0.283 Test Loss: 2.290 Test Acc: 0.283
Validation loss decreased (-0.283310 --> -0.283310).  Saving model ...
Epoch: 32 cost time: 0.9112653732299805
Epoch: 32, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.257 Vali Acc: 0.272 Test Loss: 2.257 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0866789817810059
Epoch: 33, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.253 Vali Acc: 0.289 Test Loss: 2.253 Test Acc: 0.289
Validation loss decreased (-0.283310 --> -0.288866).  Saving model ...
Epoch: 34 cost time: 1.0869369506835938
Epoch: 34, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.247 Vali Acc: 0.283 Test Loss: 2.247 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.096083164215088
Epoch: 35, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.241 Vali Acc: 0.294 Test Loss: 2.241 Test Acc: 0.294
Validation loss decreased (-0.288866 --> -0.294422).  Saving model ...
Epoch: 36 cost time: 1.2187185287475586
Epoch: 36, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.248 Vali Acc: 0.289 Test Loss: 2.248 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2196216583251953
Epoch: 37, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.250 Vali Acc: 0.278 Test Loss: 2.250 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2450149059295654
Epoch: 38, Steps: 12 | Train Loss: 2.009 Vali Loss: 2.248 Vali Acc: 0.289 Test Loss: 2.248 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2007393836975098
Epoch: 39, Steps: 12 | Train Loss: 1.983 Vali Loss: 2.237 Vali Acc: 0.300 Test Loss: 2.237 Test Acc: 0.300
Validation loss decreased (-0.294422 --> -0.299978).  Saving model ...
Epoch: 40 cost time: 1.083369255065918
Epoch: 40, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.243 Vali Acc: 0.306 Test Loss: 2.243 Test Acc: 0.306
Validation loss decreased (-0.299978 --> -0.305533).  Saving model ...
Epoch: 41 cost time: 1.0305731296539307
Epoch: 41, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.249 Vali Acc: 0.294 Test Loss: 2.249 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9295039176940918
Epoch: 42, Steps: 12 | Train Loss: 2.009 Vali Loss: 2.236 Vali Acc: 0.283 Test Loss: 2.236 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0846827030181885
Epoch: 43, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.223 Vali Acc: 0.300 Test Loss: 2.223 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2502164840698242
Epoch: 44, Steps: 12 | Train Loss: 1.956 Vali Loss: 2.208 Vali Acc: 0.294 Test Loss: 2.208 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.369746208190918
Epoch: 45, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.209 Vali Acc: 0.272 Test Loss: 2.209 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0767240524291992
Epoch: 46, Steps: 12 | Train Loss: 1.940 Vali Loss: 2.209 Vali Acc: 0.267 Test Loss: 2.209 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2044174671173096
Epoch: 47, Steps: 12 | Train Loss: 1.943 Vali Loss: 2.218 Vali Acc: 0.256 Test Loss: 2.218 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.131596565246582
Epoch: 48, Steps: 12 | Train Loss: 1.922 Vali Loss: 2.219 Vali Acc: 0.239 Test Loss: 2.219 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0841870307922363
Epoch: 49, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.190 Vali Acc: 0.278 Test Loss: 2.190 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.30240797996521
Epoch: 50, Steps: 12 | Train Loss: 1.917 Vali Loss: 2.153 Vali Acc: 0.272 Test Loss: 2.153 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3055555555555556
model parameter : 25531
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3315858840942383
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.726 Vali Acc: 0.083 Test Loss: 2.726 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.179591417312622
Epoch: 2, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.714 Vali Acc: 0.078 Test Loss: 2.714 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3122937679290771
Epoch: 3, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.696 Vali Acc: 0.094 Test Loss: 2.696 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 4 cost time: 1.0636179447174072
Epoch: 4, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.688 Vali Acc: 0.094 Test Loss: 2.688 Test Acc: 0.094
Validation loss decreased (-0.094417 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.9315385818481445
Epoch: 5, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.674 Vali Acc: 0.083 Test Loss: 2.674 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1070950031280518
Epoch: 6, Steps: 12 | Train Loss: 2.611 Vali Loss: 2.663 Vali Acc: 0.072 Test Loss: 2.663 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.156618595123291
Epoch: 7, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.643 Vali Acc: 0.072 Test Loss: 2.643 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2298994064331055
Epoch: 8, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.633 Vali Acc: 0.100 Test Loss: 2.633 Test Acc: 0.100
Validation loss decreased (-0.094418 --> -0.099974).  Saving model ...
Epoch: 9 cost time: 1.1827456951141357
Epoch: 9, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.620 Vali Acc: 0.133 Test Loss: 2.620 Test Acc: 0.133
Validation loss decreased (-0.099974 --> -0.133307).  Saving model ...
Epoch: 10 cost time: 1.1440849304199219
Epoch: 10, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.604 Vali Acc: 0.122 Test Loss: 2.604 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.479264736175537
Epoch: 11, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.583 Vali Acc: 0.128 Test Loss: 2.583 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2308812141418457
Epoch: 12, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.566 Vali Acc: 0.161 Test Loss: 2.566 Test Acc: 0.161
Validation loss decreased (-0.133307 --> -0.161085).  Saving model ...
Epoch: 13 cost time: 0.8866326808929443
Epoch: 13, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.567 Vali Acc: 0.128 Test Loss: 2.567 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.364076852798462
Epoch: 14, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.554 Vali Acc: 0.144 Test Loss: 2.554 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0536844730377197
Epoch: 15, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.536 Vali Acc: 0.139 Test Loss: 2.536 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1712329387664795
Epoch: 16, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.526 Vali Acc: 0.156 Test Loss: 2.526 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9086625576019287
Epoch: 17, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.500 Vali Acc: 0.228 Test Loss: 2.500 Test Acc: 0.228
Validation loss decreased (-0.161085 --> -0.227753).  Saving model ...
Epoch: 18 cost time: 1.048645257949829
Epoch: 18, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.478 Vali Acc: 0.189 Test Loss: 2.478 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0195605754852295
Epoch: 19, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.470 Vali Acc: 0.194 Test Loss: 2.470 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0220818519592285
Epoch: 20, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.449 Vali Acc: 0.228 Test Loss: 2.449 Test Acc: 0.228
Validation loss decreased (-0.227753 --> -0.227753).  Saving model ...
Epoch: 21 cost time: 0.9615654945373535
Epoch: 21, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.431 Vali Acc: 0.228 Test Loss: 2.431 Test Acc: 0.228
Validation loss decreased (-0.227753 --> -0.227753).  Saving model ...
Epoch: 22 cost time: 0.9499514102935791
Epoch: 22, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.412 Vali Acc: 0.217 Test Loss: 2.412 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1899123191833496
Epoch: 23, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.387 Vali Acc: 0.239 Test Loss: 2.387 Test Acc: 0.239
Validation loss decreased (-0.227753 --> -0.238865).  Saving model ...
Epoch: 24 cost time: 1.298396348953247
Epoch: 24, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.371 Vali Acc: 0.256 Test Loss: 2.371 Test Acc: 0.256
Validation loss decreased (-0.238865 --> -0.255532).  Saving model ...
Epoch: 25 cost time: 1.0289721488952637
Epoch: 25, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.362 Vali Acc: 0.250 Test Loss: 2.362 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2698478698730469
Epoch: 26, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.358 Vali Acc: 0.206 Test Loss: 2.358 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.089261531829834
Epoch: 27, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.351 Vali Acc: 0.250 Test Loss: 2.351 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8697552680969238
Epoch: 28, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.334 Vali Acc: 0.261 Test Loss: 2.334 Test Acc: 0.261
Validation loss decreased (-0.255532 --> -0.261088).  Saving model ...
Epoch: 29 cost time: 1.3119943141937256
Epoch: 29, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.322 Vali Acc: 0.272 Test Loss: 2.322 Test Acc: 0.272
Validation loss decreased (-0.261088 --> -0.272199).  Saving model ...
Epoch: 30 cost time: 1.2572710514068604
Epoch: 30, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.318 Vali Acc: 0.233 Test Loss: 2.318 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1865363121032715
Epoch: 31, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.298 Vali Acc: 0.211 Test Loss: 2.298 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.198167085647583
Epoch: 32, Steps: 12 | Train Loss: 2.144 Vali Loss: 2.295 Vali Acc: 0.228 Test Loss: 2.295 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0456204414367676
Epoch: 33, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.296 Vali Acc: 0.228 Test Loss: 2.296 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0800552368164062
Epoch: 34, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.274 Vali Acc: 0.244 Test Loss: 2.274 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9887030124664307
Epoch: 35, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.298 Vali Acc: 0.211 Test Loss: 2.298 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.188002109527588
Epoch: 36, Steps: 12 | Train Loss: 2.045 Vali Loss: 2.282 Vali Acc: 0.222 Test Loss: 2.282 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3236050605773926
Epoch: 37, Steps: 12 | Train Loss: 2.063 Vali Loss: 2.300 Vali Acc: 0.228 Test Loss: 2.300 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0075113773345947
Epoch: 38, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.315 Vali Acc: 0.244 Test Loss: 2.315 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3545372486114502
Epoch: 39, Steps: 12 | Train Loss: 2.004 Vali Loss: 2.295 Vali Acc: 0.261 Test Loss: 2.295 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2722222222222222
model parameter : 25275
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5412073135375977
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.786 Vali Acc: 0.122 Test Loss: 2.786 Test Acc: 0.122
Validation loss decreased (inf --> -0.122194).  Saving model ...
Epoch: 2 cost time: 0.8457589149475098
Epoch: 2, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.779 Vali Acc: 0.106 Test Loss: 2.779 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8258953094482422
Epoch: 3, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.762 Vali Acc: 0.117 Test Loss: 2.762 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8450593948364258
Epoch: 4, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.747 Vali Acc: 0.117 Test Loss: 2.747 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0051534175872803
Epoch: 5, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.728 Vali Acc: 0.150 Test Loss: 2.728 Test Acc: 0.150
Validation loss decreased (-0.122194 --> -0.149973).  Saving model ...
Epoch: 6 cost time: 0.7810590267181396
Epoch: 6, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.719 Vali Acc: 0.144 Test Loss: 2.719 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0373575687408447
Epoch: 7, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.718 Vali Acc: 0.094 Test Loss: 2.718 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9930105209350586
Epoch: 8, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.704 Vali Acc: 0.128 Test Loss: 2.704 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0654094219207764
Epoch: 9, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.695 Vali Acc: 0.156 Test Loss: 2.695 Test Acc: 0.156
Validation loss decreased (-0.149973 --> -0.155529).  Saving model ...
Epoch: 10 cost time: 0.9894604682922363
Epoch: 10, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.673 Vali Acc: 0.150 Test Loss: 2.673 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8950502872467041
Epoch: 11, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.664 Vali Acc: 0.128 Test Loss: 2.664 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9992890357971191
Epoch: 12, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.644 Vali Acc: 0.128 Test Loss: 2.644 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8570868968963623
Epoch: 13, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.614 Vali Acc: 0.144 Test Loss: 2.614 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9623384475708008
Epoch: 14, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.601 Vali Acc: 0.183 Test Loss: 2.601 Test Acc: 0.183
Validation loss decreased (-0.155529 --> -0.183307).  Saving model ...
Epoch: 15 cost time: 0.8719480037689209
Epoch: 15, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.601 Vali Acc: 0.150 Test Loss: 2.601 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8441672325134277
Epoch: 16, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.582 Vali Acc: 0.172 Test Loss: 2.582 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.781550407409668
Epoch: 17, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.573 Vali Acc: 0.122 Test Loss: 2.573 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9522104263305664
Epoch: 18, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.562 Vali Acc: 0.150 Test Loss: 2.562 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.094604253768921
Epoch: 19, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.552 Vali Acc: 0.167 Test Loss: 2.552 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0443344116210938
Epoch: 20, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.527 Vali Acc: 0.133 Test Loss: 2.527 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8232684135437012
Epoch: 21, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.518 Vali Acc: 0.178 Test Loss: 2.518 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.214473009109497
Epoch: 22, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.509 Vali Acc: 0.172 Test Loss: 2.509 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9181370735168457
Epoch: 23, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.477 Vali Acc: 0.194 Test Loss: 2.477 Test Acc: 0.194
Validation loss decreased (-0.183307 --> -0.194420).  Saving model ...
Epoch: 24 cost time: 1.0349547863006592
Epoch: 24, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.487 Vali Acc: 0.200 Test Loss: 2.487 Test Acc: 0.200
Validation loss decreased (-0.194420 --> -0.199975).  Saving model ...
Epoch: 25 cost time: 0.8267850875854492
Epoch: 25, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.459 Vali Acc: 0.200 Test Loss: 2.459 Test Acc: 0.200
Validation loss decreased (-0.199975 --> -0.199975).  Saving model ...
Epoch: 26 cost time: 0.9031906127929688
Epoch: 26, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.438 Vali Acc: 0.222 Test Loss: 2.438 Test Acc: 0.222
Validation loss decreased (-0.199975 --> -0.222198).  Saving model ...
Epoch: 27 cost time: 0.8428134918212891
Epoch: 27, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.417 Vali Acc: 0.239 Test Loss: 2.417 Test Acc: 0.239
Validation loss decreased (-0.222198 --> -0.238865).  Saving model ...
Epoch: 28 cost time: 1.1157546043395996
Epoch: 28, Steps: 12 | Train Loss: 2.237 Vali Loss: 2.402 Vali Acc: 0.256 Test Loss: 2.402 Test Acc: 0.256
Validation loss decreased (-0.238865 --> -0.255532).  Saving model ...
Epoch: 29 cost time: 1.1271004676818848
Epoch: 29, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.401 Vali Acc: 0.239 Test Loss: 2.401 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0044331550598145
Epoch: 30, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.386 Vali Acc: 0.233 Test Loss: 2.386 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9867806434631348
Epoch: 31, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.378 Vali Acc: 0.206 Test Loss: 2.378 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9129154682159424
Epoch: 32, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.373 Vali Acc: 0.233 Test Loss: 2.373 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0775630474090576
Epoch: 33, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.352 Vali Acc: 0.272 Test Loss: 2.352 Test Acc: 0.272
Validation loss decreased (-0.255532 --> -0.272199).  Saving model ...
Epoch: 34 cost time: 0.9077949523925781
Epoch: 34, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.377 Vali Acc: 0.228 Test Loss: 2.377 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1224026679992676
Epoch: 35, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.372 Vali Acc: 0.189 Test Loss: 2.372 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.111816167831421
Epoch: 36, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.367 Vali Acc: 0.206 Test Loss: 2.367 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.139979600906372
Epoch: 37, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.371 Vali Acc: 0.172 Test Loss: 2.371 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.20957612991333
Epoch: 38, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.360 Vali Acc: 0.189 Test Loss: 2.360 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0363855361938477
Epoch: 39, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.326 Vali Acc: 0.211 Test Loss: 2.326 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1526389122009277
Epoch: 40, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.295 Vali Acc: 0.228 Test Loss: 2.295 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.068204641342163
Epoch: 41, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.298 Vali Acc: 0.206 Test Loss: 2.298 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.363309383392334
Epoch: 42, Steps: 12 | Train Loss: 2.002 Vali Loss: 2.282 Vali Acc: 0.194 Test Loss: 2.282 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1056358814239502
Epoch: 43, Steps: 12 | Train Loss: 2.014 Vali Loss: 2.260 Vali Acc: 0.228 Test Loss: 2.260 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.2722222222222222
model parameter : 25019
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4798038005828857
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.772 Vali Acc: 0.106 Test Loss: 2.772 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 0.9604165554046631
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.763 Vali Acc: 0.094 Test Loss: 2.763 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9186441898345947
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.763 Vali Acc: 0.106 Test Loss: 2.763 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.0706300735473633
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.754 Vali Acc: 0.089 Test Loss: 2.754 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0923054218292236
Epoch: 5, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.724 Vali Acc: 0.117 Test Loss: 2.724 Test Acc: 0.117
Validation loss decreased (-0.105528 --> -0.116639).  Saving model ...
Epoch: 6 cost time: 0.9057600498199463
Epoch: 6, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.710 Vali Acc: 0.122 Test Loss: 2.710 Test Acc: 0.122
Validation loss decreased (-0.116639 --> -0.122195).  Saving model ...
Epoch: 7 cost time: 0.9517672061920166
Epoch: 7, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.688 Vali Acc: 0.144 Test Loss: 2.688 Test Acc: 0.144
Validation loss decreased (-0.122195 --> -0.144418).  Saving model ...
Epoch: 8 cost time: 0.9133989810943604
Epoch: 8, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.657 Vali Acc: 0.172 Test Loss: 2.657 Test Acc: 0.172
Validation loss decreased (-0.144418 --> -0.172196).  Saving model ...
Epoch: 9 cost time: 0.9450981616973877
Epoch: 9, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.627 Vali Acc: 0.172 Test Loss: 2.627 Test Acc: 0.172
Validation loss decreased (-0.172196 --> -0.172196).  Saving model ...
Epoch: 10 cost time: 0.8807482719421387
Epoch: 10, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.608 Vali Acc: 0.194 Test Loss: 2.608 Test Acc: 0.194
Validation loss decreased (-0.172196 --> -0.194418).  Saving model ...
Epoch: 11 cost time: 0.8720502853393555
Epoch: 11, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.596 Vali Acc: 0.167 Test Loss: 2.596 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0957062244415283
Epoch: 12, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.574 Vali Acc: 0.167 Test Loss: 2.574 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8565397262573242
Epoch: 13, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.554 Vali Acc: 0.178 Test Loss: 2.554 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8650107383728027
Epoch: 14, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.526 Vali Acc: 0.211 Test Loss: 2.526 Test Acc: 0.211
Validation loss decreased (-0.194418 --> -0.211086).  Saving model ...
Epoch: 15 cost time: 0.7531616687774658
Epoch: 15, Steps: 12 | Train Loss: 2.428 Vali Loss: 2.507 Vali Acc: 0.156 Test Loss: 2.507 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.133148193359375
Epoch: 16, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.480 Vali Acc: 0.183 Test Loss: 2.480 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.903301477432251
Epoch: 17, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.458 Vali Acc: 0.189 Test Loss: 2.458 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8812823295593262
Epoch: 18, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.429 Vali Acc: 0.217 Test Loss: 2.429 Test Acc: 0.217
Validation loss decreased (-0.211086 --> -0.216642).  Saving model ...
Epoch: 19 cost time: 0.8526699542999268
Epoch: 19, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.409 Vali Acc: 0.228 Test Loss: 2.409 Test Acc: 0.228
Validation loss decreased (-0.216642 --> -0.227754).  Saving model ...
Epoch: 20 cost time: 0.932506799697876
Epoch: 20, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.390 Vali Acc: 0.228 Test Loss: 2.390 Test Acc: 0.228
Validation loss decreased (-0.227754 --> -0.227754).  Saving model ...
Epoch: 21 cost time: 0.8296103477478027
Epoch: 21, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.381 Vali Acc: 0.222 Test Loss: 2.381 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8652772903442383
Epoch: 22, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.351 Vali Acc: 0.222 Test Loss: 2.351 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8868758678436279
Epoch: 23, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.355 Vali Acc: 0.200 Test Loss: 2.355 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.12178373336792
Epoch: 24, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.353 Vali Acc: 0.206 Test Loss: 2.353 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0928382873535156
Epoch: 25, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.331 Vali Acc: 0.211 Test Loss: 2.331 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9078071117401123
Epoch: 26, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.322 Vali Acc: 0.228 Test Loss: 2.322 Test Acc: 0.228
Validation loss decreased (-0.227754 --> -0.227755).  Saving model ...
Epoch: 27 cost time: 1.019317865371704
Epoch: 27, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.320 Vali Acc: 0.222 Test Loss: 2.320 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9752392768859863
Epoch: 28, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.308 Vali Acc: 0.233 Test Loss: 2.308 Test Acc: 0.233
Validation loss decreased (-0.227755 --> -0.233310).  Saving model ...
Epoch: 29 cost time: 0.8765304088592529
Epoch: 29, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.294 Vali Acc: 0.239 Test Loss: 2.294 Test Acc: 0.239
Validation loss decreased (-0.233310 --> -0.238866).  Saving model ...
Epoch: 30 cost time: 0.8406505584716797
Epoch: 30, Steps: 12 | Train Loss: 2.112 Vali Loss: 2.298 Vali Acc: 0.233 Test Loss: 2.298 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1705751419067383
Epoch: 31, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.263 Vali Acc: 0.233 Test Loss: 2.263 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.989954948425293
Epoch: 32, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.269 Vali Acc: 0.256 Test Loss: 2.269 Test Acc: 0.256
Validation loss decreased (-0.238866 --> -0.255533).  Saving model ...
Epoch: 33 cost time: 1.0394573211669922
Epoch: 33, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.248 Vali Acc: 0.239 Test Loss: 2.248 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9486677646636963
Epoch: 34, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.232 Vali Acc: 0.294 Test Loss: 2.232 Test Acc: 0.294
Validation loss decreased (-0.255533 --> -0.294422).  Saving model ...
Epoch: 35 cost time: 0.9930217266082764
Epoch: 35, Steps: 12 | Train Loss: 2.089 Vali Loss: 2.253 Vali Acc: 0.272 Test Loss: 2.253 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2125391960144043
Epoch: 36, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.269 Vali Acc: 0.272 Test Loss: 2.269 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3798747062683105
Epoch: 37, Steps: 12 | Train Loss: 2.028 Vali Loss: 2.253 Vali Acc: 0.278 Test Loss: 2.253 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.048112392425537
Epoch: 38, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.243 Vali Acc: 0.306 Test Loss: 2.243 Test Acc: 0.306
Validation loss decreased (-0.294422 --> -0.305533).  Saving model ...
Epoch: 39 cost time: 1.0036487579345703
Epoch: 39, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.239 Vali Acc: 0.300 Test Loss: 2.239 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9832608699798584
Epoch: 40, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.245 Vali Acc: 0.300 Test Loss: 2.245 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1097691059112549
Epoch: 41, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.233 Vali Acc: 0.278 Test Loss: 2.233 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9467933177947998
Epoch: 42, Steps: 12 | Train Loss: 1.999 Vali Loss: 2.196 Vali Acc: 0.272 Test Loss: 2.196 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2352113723754883
Epoch: 43, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.160 Vali Acc: 0.311 Test Loss: 2.160 Test Acc: 0.311
Validation loss decreased (-0.305533 --> -0.311090).  Saving model ...
Epoch: 44 cost time: 1.0701088905334473
Epoch: 44, Steps: 12 | Train Loss: 2.011 Vali Loss: 2.186 Vali Acc: 0.300 Test Loss: 2.186 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8871207237243652
Epoch: 45, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.164 Vali Acc: 0.283 Test Loss: 2.164 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0811614990234375
Epoch: 46, Steps: 12 | Train Loss: 1.965 Vali Loss: 2.129 Vali Acc: 0.300 Test Loss: 2.129 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2264204025268555
Epoch: 47, Steps: 12 | Train Loss: 1.951 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
Validation loss decreased (-0.311090 --> -0.333312).  Saving model ...
Epoch: 48 cost time: 1.054879903793335
Epoch: 48, Steps: 12 | Train Loss: 1.960 Vali Loss: 2.151 Vali Acc: 0.256 Test Loss: 2.151 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0414037704467773
Epoch: 49, Steps: 12 | Train Loss: 1.922 Vali Loss: 2.150 Vali Acc: 0.250 Test Loss: 2.150 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1994297504425049
Epoch: 50, Steps: 12 | Train Loss: 1.879 Vali Loss: 2.144 Vali Acc: 0.261 Test Loss: 2.144 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0978543758392334
Epoch: 51, Steps: 12 | Train Loss: 1.916 Vali Loss: 2.148 Vali Acc: 0.250 Test Loss: 2.148 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9851229190826416
Epoch: 52, Steps: 12 | Train Loss: 1.907 Vali Loss: 2.170 Vali Acc: 0.283 Test Loss: 2.170 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.079120397567749
Epoch: 53, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.149 Vali Acc: 0.289 Test Loss: 2.149 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0038268566131592
Epoch: 54, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.146 Vali Acc: 0.267 Test Loss: 2.146 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2615509033203125
Epoch: 55, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.173 Vali Acc: 0.244 Test Loss: 2.173 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9473593235015869
Epoch: 56, Steps: 12 | Train Loss: 1.880 Vali Loss: 2.155 Vali Acc: 0.300 Test Loss: 2.155 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9771223068237305
Epoch: 57, Steps: 12 | Train Loss: 1.843 Vali Loss: 2.136 Vali Acc: 0.272 Test Loss: 2.136 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3333333333333333
model parameter : 24763
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.257556200027466
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.772 Vali Acc: 0.106 Test Loss: 2.772 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 0.6730663776397705
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.763 Vali Acc: 0.094 Test Loss: 2.763 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7010941505432129
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.763 Vali Acc: 0.106 Test Loss: 2.763 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 0.7298297882080078
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.754 Vali Acc: 0.089 Test Loss: 2.754 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9015822410583496
Epoch: 5, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.724 Vali Acc: 0.117 Test Loss: 2.724 Test Acc: 0.117
Validation loss decreased (-0.105528 --> -0.116639).  Saving model ...
Epoch: 6 cost time: 0.9234399795532227
Epoch: 6, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.710 Vali Acc: 0.122 Test Loss: 2.710 Test Acc: 0.122
Validation loss decreased (-0.116639 --> -0.122195).  Saving model ...
Epoch: 7 cost time: 0.7740931510925293
Epoch: 7, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.688 Vali Acc: 0.144 Test Loss: 2.688 Test Acc: 0.144
Validation loss decreased (-0.122195 --> -0.144418).  Saving model ...
Epoch: 8 cost time: 0.6992182731628418
Epoch: 8, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.657 Vali Acc: 0.172 Test Loss: 2.657 Test Acc: 0.172
Validation loss decreased (-0.144418 --> -0.172196).  Saving model ...
Epoch: 9 cost time: 0.9192891120910645
Epoch: 9, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.627 Vali Acc: 0.172 Test Loss: 2.627 Test Acc: 0.172
Validation loss decreased (-0.172196 --> -0.172196).  Saving model ...
Epoch: 10 cost time: 0.7626419067382812
Epoch: 10, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.608 Vali Acc: 0.194 Test Loss: 2.608 Test Acc: 0.194
Validation loss decreased (-0.172196 --> -0.194418).  Saving model ...
Epoch: 11 cost time: 0.7468681335449219
Epoch: 11, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.596 Vali Acc: 0.167 Test Loss: 2.596 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8390758037567139
Epoch: 12, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.574 Vali Acc: 0.167 Test Loss: 2.574 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1176984310150146
Epoch: 13, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.554 Vali Acc: 0.178 Test Loss: 2.554 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7302341461181641
Epoch: 14, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.526 Vali Acc: 0.211 Test Loss: 2.526 Test Acc: 0.211
Validation loss decreased (-0.194418 --> -0.211086).  Saving model ...
Epoch: 15 cost time: 0.8075740337371826
Epoch: 15, Steps: 12 | Train Loss: 2.428 Vali Loss: 2.507 Vali Acc: 0.156 Test Loss: 2.507 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0016164779663086
Epoch: 16, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.480 Vali Acc: 0.183 Test Loss: 2.480 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8971917629241943
Epoch: 17, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.458 Vali Acc: 0.189 Test Loss: 2.458 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8826720714569092
Epoch: 18, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.429 Vali Acc: 0.217 Test Loss: 2.429 Test Acc: 0.217
Validation loss decreased (-0.211086 --> -0.216642).  Saving model ...
Epoch: 19 cost time: 1.2111804485321045
Epoch: 19, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.409 Vali Acc: 0.228 Test Loss: 2.409 Test Acc: 0.228
Validation loss decreased (-0.216642 --> -0.227754).  Saving model ...
Epoch: 20 cost time: 0.8389537334442139
Epoch: 20, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.390 Vali Acc: 0.228 Test Loss: 2.390 Test Acc: 0.228
Validation loss decreased (-0.227754 --> -0.227754).  Saving model ...
Epoch: 21 cost time: 0.7756383419036865
Epoch: 21, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.381 Vali Acc: 0.222 Test Loss: 2.381 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9123153686523438
Epoch: 22, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.351 Vali Acc: 0.222 Test Loss: 2.351 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.951007604598999
Epoch: 23, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.355 Vali Acc: 0.200 Test Loss: 2.355 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8824276924133301
Epoch: 24, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.353 Vali Acc: 0.206 Test Loss: 2.353 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8752555847167969
Epoch: 25, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.331 Vali Acc: 0.211 Test Loss: 2.331 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9717178344726562
Epoch: 26, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.322 Vali Acc: 0.228 Test Loss: 2.322 Test Acc: 0.228
Validation loss decreased (-0.227754 --> -0.227755).  Saving model ...
Epoch: 27 cost time: 0.8308641910552979
Epoch: 27, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.320 Vali Acc: 0.222 Test Loss: 2.320 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7791190147399902
Epoch: 28, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.308 Vali Acc: 0.233 Test Loss: 2.308 Test Acc: 0.233
Validation loss decreased (-0.227755 --> -0.233310).  Saving model ...
Epoch: 29 cost time: 0.8129122257232666
Epoch: 29, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.294 Vali Acc: 0.239 Test Loss: 2.294 Test Acc: 0.239
Validation loss decreased (-0.233310 --> -0.238866).  Saving model ...
Epoch: 30 cost time: 1.1668167114257812
Epoch: 30, Steps: 12 | Train Loss: 2.112 Vali Loss: 2.298 Vali Acc: 0.233 Test Loss: 2.298 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0812790393829346
Epoch: 31, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.263 Vali Acc: 0.233 Test Loss: 2.263 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8384928703308105
Epoch: 32, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.269 Vali Acc: 0.256 Test Loss: 2.269 Test Acc: 0.256
Validation loss decreased (-0.238866 --> -0.255533).  Saving model ...
Epoch: 33 cost time: 0.8913862705230713
Epoch: 33, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.248 Vali Acc: 0.239 Test Loss: 2.248 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9210937023162842
Epoch: 34, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.232 Vali Acc: 0.294 Test Loss: 2.232 Test Acc: 0.294
Validation loss decreased (-0.255533 --> -0.294422).  Saving model ...
Epoch: 35 cost time: 0.8151979446411133
Epoch: 35, Steps: 12 | Train Loss: 2.089 Vali Loss: 2.253 Vali Acc: 0.272 Test Loss: 2.253 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8746809959411621
Epoch: 36, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.269 Vali Acc: 0.272 Test Loss: 2.269 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7309024333953857
Epoch: 37, Steps: 12 | Train Loss: 2.028 Vali Loss: 2.253 Vali Acc: 0.278 Test Loss: 2.253 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9730167388916016
Epoch: 38, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.243 Vali Acc: 0.306 Test Loss: 2.243 Test Acc: 0.306
Validation loss decreased (-0.294422 --> -0.305533).  Saving model ...
Epoch: 39 cost time: 0.8272204399108887
Epoch: 39, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.239 Vali Acc: 0.300 Test Loss: 2.239 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.746129035949707
Epoch: 40, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.245 Vali Acc: 0.300 Test Loss: 2.245 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8024628162384033
Epoch: 41, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.233 Vali Acc: 0.278 Test Loss: 2.233 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8348970413208008
Epoch: 42, Steps: 12 | Train Loss: 1.999 Vali Loss: 2.196 Vali Acc: 0.272 Test Loss: 2.196 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8281044960021973
Epoch: 43, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.160 Vali Acc: 0.311 Test Loss: 2.160 Test Acc: 0.311
Validation loss decreased (-0.305533 --> -0.311090).  Saving model ...
Epoch: 44 cost time: 0.9313547611236572
Epoch: 44, Steps: 12 | Train Loss: 2.011 Vali Loss: 2.186 Vali Acc: 0.300 Test Loss: 2.186 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9206159114837646
Epoch: 45, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.164 Vali Acc: 0.283 Test Loss: 2.164 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9820554256439209
Epoch: 46, Steps: 12 | Train Loss: 1.965 Vali Loss: 2.129 Vali Acc: 0.300 Test Loss: 2.129 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.791374921798706
Epoch: 47, Steps: 12 | Train Loss: 1.951 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
Validation loss decreased (-0.311090 --> -0.333312).  Saving model ...
Epoch: 48 cost time: 0.8937387466430664
Epoch: 48, Steps: 12 | Train Loss: 1.960 Vali Loss: 2.151 Vali Acc: 0.256 Test Loss: 2.151 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9396145343780518
Epoch: 49, Steps: 12 | Train Loss: 1.922 Vali Loss: 2.150 Vali Acc: 0.250 Test Loss: 2.150 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8315649032592773
Epoch: 50, Steps: 12 | Train Loss: 1.879 Vali Loss: 2.144 Vali Acc: 0.261 Test Loss: 2.144 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7716150283813477
Epoch: 51, Steps: 12 | Train Loss: 1.916 Vali Loss: 2.148 Vali Acc: 0.250 Test Loss: 2.148 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7312519550323486
Epoch: 52, Steps: 12 | Train Loss: 1.907 Vali Loss: 2.170 Vali Acc: 0.283 Test Loss: 2.170 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.858759880065918
Epoch: 53, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.149 Vali Acc: 0.289 Test Loss: 2.149 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7759127616882324
Epoch: 54, Steps: 12 | Train Loss: 1.926 Vali Loss: 2.146 Vali Acc: 0.267 Test Loss: 2.146 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8191406726837158
Epoch: 55, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.173 Vali Acc: 0.244 Test Loss: 2.173 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0513081550598145
Epoch: 56, Steps: 12 | Train Loss: 1.880 Vali Loss: 2.155 Vali Acc: 0.300 Test Loss: 2.155 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0317003726959229
Epoch: 57, Steps: 12 | Train Loss: 1.843 Vali Loss: 2.136 Vali Acc: 0.272 Test Loss: 2.136 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_MTSMixer_UEA_ftM_sl45_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.3333333333333333
model parameter : 24763
model size : 0.10MB
