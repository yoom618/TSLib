Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.492364883422852
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 13.060363292694092
Epoch: 2, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.447 Vali Acc: 0.236 Test Loss: 1.447 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.33047366142273
Epoch: 3, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.459 Vali Acc: 0.251 Test Loss: 1.459 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.123881816864014
Epoch: 4, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.508 Vali Acc: 0.240 Test Loss: 1.508 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.204819679260254
Epoch: 5, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.527 Vali Acc: 0.209 Test Loss: 1.527 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.873007535934448
Epoch: 6, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.540 Vali Acc: 0.243 Test Loss: 1.540 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.25868034362793
Epoch: 7, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.544 Vali Acc: 0.224 Test Loss: 1.544 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.338561534881592
Epoch: 8, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.558 Vali Acc: 0.255 Test Loss: 1.558 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.208269834518433
Epoch: 9, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.613 Vali Acc: 0.232 Test Loss: 1.613 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.463515281677246
Epoch: 10, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.654 Vali Acc: 0.213 Test Loss: 1.654 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.685182332992554
Epoch: 11, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.719 Vali Acc: 0.213 Test Loss: 1.719 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 7645178
model size : 29.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.65976071357727
Epoch: 1, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 14.91204309463501
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.469 Vali Acc: 0.194 Test Loss: 1.469 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.99144959449768
Epoch: 3, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.483 Vali Acc: 0.228 Test Loss: 1.483 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.061036109924316
Epoch: 4, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.510 Vali Acc: 0.221 Test Loss: 1.510 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.017532587051392
Epoch: 5, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.573 Vali Acc: 0.224 Test Loss: 1.573 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.177795648574829
Epoch: 6, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.607 Vali Acc: 0.224 Test Loss: 1.607 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.453535079956055
Epoch: 7, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.630 Vali Acc: 0.221 Test Loss: 1.630 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.56455945968628
Epoch: 8, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.664 Vali Acc: 0.247 Test Loss: 1.664 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.98875880241394
Epoch: 9, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.638 Vali Acc: 0.274 Test Loss: 1.638 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273748).  Saving model ...
Epoch: 10 cost time: 12.534953355789185
Epoch: 10, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.642 Vali Acc: 0.251 Test Loss: 1.642 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.314434051513672
Epoch: 11, Steps: 17 | Train Loss: 0.736 Vali Loss: 1.779 Vali Acc: 0.240 Test Loss: 1.779 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.021360397338867
Epoch: 12, Steps: 17 | Train Loss: 0.693 Vali Loss: 1.720 Vali Acc: 0.217 Test Loss: 1.720 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.868966102600098
Epoch: 13, Steps: 17 | Train Loss: 0.634 Vali Loss: 1.756 Vali Acc: 0.251 Test Loss: 1.756 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.300380945205688
Epoch: 14, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.871 Vali Acc: 0.221 Test Loss: 1.871 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.362833976745605
Epoch: 15, Steps: 17 | Train Loss: 0.532 Vali Loss: 1.780 Vali Acc: 0.255 Test Loss: 1.780 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.702001094818115
Epoch: 16, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.937 Vali Acc: 0.278 Test Loss: 1.937 Test Acc: 0.278
Validation loss decreased (-0.273748 --> -0.277547).  Saving model ...
Epoch: 17 cost time: 15.267323732376099
Epoch: 17, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.983 Vali Acc: 0.240 Test Loss: 1.983 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.10685396194458
Epoch: 18, Steps: 17 | Train Loss: 0.458 Vali Loss: 1.950 Vali Acc: 0.259 Test Loss: 1.950 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.764134645462036
Epoch: 19, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.964 Vali Acc: 0.259 Test Loss: 1.964 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.916204929351807
Epoch: 20, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.005 Vali Acc: 0.262 Test Loss: 2.005 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 13.684000492095947
Epoch: 21, Steps: 17 | Train Loss: 0.351 Vali Loss: 2.215 Vali Acc: 0.259 Test Loss: 2.215 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 14.25089693069458
Epoch: 22, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.108 Vali Acc: 0.255 Test Loss: 2.108 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.583645582199097
Epoch: 23, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.226 Vali Acc: 0.243 Test Loss: 2.226 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 15.178636312484741
Epoch: 24, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.352 Vali Acc: 0.228 Test Loss: 2.352 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 14.955925703048706
Epoch: 25, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.451 Vali Acc: 0.266 Test Loss: 2.451 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 14.608607053756714
Epoch: 26, Steps: 17 | Train Loss: 0.254 Vali Loss: 2.205 Vali Acc: 0.247 Test Loss: 2.205 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 7557114
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.50745415687561
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.426 Vali Acc: 0.213 Test Loss: 1.426 Test Acc: 0.213
Validation loss decreased (inf --> -0.212913).  Saving model ...
Epoch: 2 cost time: 11.3362877368927
Epoch: 2, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.460 Vali Acc: 0.198 Test Loss: 1.460 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.380466222763062
Epoch: 3, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.497 Vali Acc: 0.205 Test Loss: 1.497 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.90502381324768
Epoch: 4, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.570 Vali Acc: 0.262 Test Loss: 1.570 Test Acc: 0.262
Validation loss decreased (-0.212913 --> -0.262342).  Saving model ...
Epoch: 5 cost time: 10.077285051345825
Epoch: 5, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.559 Vali Acc: 0.236 Test Loss: 1.559 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.220789194107056
Epoch: 6, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.535 Vali Acc: 0.228 Test Loss: 1.535 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.921422481536865
Epoch: 7, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.584 Vali Acc: 0.224 Test Loss: 1.584 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.808417558670044
Epoch: 8, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.643 Vali Acc: 0.243 Test Loss: 1.643 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.59564733505249
Epoch: 9, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.565 Vali Acc: 0.221 Test Loss: 1.565 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.90114426612854
Epoch: 10, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.674 Vali Acc: 0.236 Test Loss: 1.674 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.13043475151062
Epoch: 11, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.666 Vali Acc: 0.247 Test Loss: 1.666 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.328076839447021
Epoch: 12, Steps: 17 | Train Loss: 0.736 Vali Loss: 1.716 Vali Acc: 0.255 Test Loss: 1.716 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.908652544021606
Epoch: 13, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.903 Vali Acc: 0.217 Test Loss: 1.903 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.451530694961548
Epoch: 14, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.691 Vali Acc: 0.289 Test Loss: 1.691 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288956).  Saving model ...
Epoch: 15 cost time: 10.696663856506348
Epoch: 15, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.823 Vali Acc: 0.228 Test Loss: 1.823 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.085077047348022
Epoch: 16, Steps: 17 | Train Loss: 0.577 Vali Loss: 1.920 Vali Acc: 0.251 Test Loss: 1.920 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.220967054367065
Epoch: 17, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.869 Vali Acc: 0.255 Test Loss: 1.869 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.637714385986328
Epoch: 18, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.966 Vali Acc: 0.228 Test Loss: 1.966 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.814075708389282
Epoch: 19, Steps: 17 | Train Loss: 0.426 Vali Loss: 1.987 Vali Acc: 0.259 Test Loss: 1.987 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.852700233459473
Epoch: 20, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.120 Vali Acc: 0.236 Test Loss: 2.120 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.840018033981323
Epoch: 21, Steps: 17 | Train Loss: 0.375 Vali Loss: 1.982 Vali Acc: 0.308 Test Loss: 1.982 Test Acc: 0.308
Validation loss decreased (-0.288956 --> -0.307965).  Saving model ...
Epoch: 22 cost time: 11.860562324523926
Epoch: 22, Steps: 17 | Train Loss: 0.371 Vali Loss: 2.136 Vali Acc: 0.270 Test Loss: 2.136 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.737598896026611
Epoch: 23, Steps: 17 | Train Loss: 0.337 Vali Loss: 2.222 Vali Acc: 0.232 Test Loss: 2.222 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.737113952636719
Epoch: 24, Steps: 17 | Train Loss: 0.302 Vali Loss: 2.183 Vali Acc: 0.228 Test Loss: 2.183 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.305248498916626
Epoch: 25, Steps: 17 | Train Loss: 0.280 Vali Loss: 2.143 Vali Acc: 0.259 Test Loss: 2.143 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 12.6188645362854
Epoch: 26, Steps: 17 | Train Loss: 0.260 Vali Loss: 2.209 Vali Acc: 0.259 Test Loss: 2.209 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.057126522064209
Epoch: 27, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.202 Vali Acc: 0.289 Test Loss: 2.202 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 11.989513158798218
Epoch: 28, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.361 Vali Acc: 0.232 Test Loss: 2.361 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.55643081665039
Epoch: 29, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.432 Vali Acc: 0.247 Test Loss: 2.432 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 12.85593295097351
Epoch: 30, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.485 Vali Acc: 0.262 Test Loss: 2.485 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 11.470391511917114
Epoch: 31, Steps: 17 | Train Loss: 0.304 Vali Loss: 2.604 Vali Acc: 0.255 Test Loss: 2.604 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 7467002
model size : 28.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.000170230865479
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.435 Vali Acc: 0.236 Test Loss: 1.435 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 9.07930850982666
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.468 Vali Acc: 0.213 Test Loss: 1.468 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.153045892715454
Epoch: 3, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.473 Vali Acc: 0.213 Test Loss: 1.473 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.156421899795532
Epoch: 4, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.503 Vali Acc: 0.213 Test Loss: 1.503 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.885310173034668
Epoch: 5, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258540).  Saving model ...
Epoch: 6 cost time: 8.282232999801636
Epoch: 6, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.565 Vali Acc: 0.190 Test Loss: 1.565 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.606212377548218
Epoch: 7, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.606 Vali Acc: 0.255 Test Loss: 1.606 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.9577858448028564
Epoch: 8, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.269819974899292
Epoch: 9, Steps: 17 | Train Loss: 0.809 Vali Loss: 1.634 Vali Acc: 0.243 Test Loss: 1.634 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.5954389572143555
Epoch: 10, Steps: 17 | Train Loss: 0.809 Vali Loss: 1.638 Vali Acc: 0.281 Test Loss: 1.638 Test Acc: 0.281
Validation loss decreased (-0.258540 --> -0.281352).  Saving model ...
Epoch: 11 cost time: 7.6915271282196045
Epoch: 11, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.616 Vali Acc: 0.228 Test Loss: 1.616 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.368114471435547
Epoch: 12, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.794 Vali Acc: 0.186 Test Loss: 1.794 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.8680877685546875
Epoch: 13, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.720 Vali Acc: 0.251 Test Loss: 1.720 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.118715524673462
Epoch: 14, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.817 Vali Acc: 0.255 Test Loss: 1.817 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.654228210449219
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.875 Vali Acc: 0.217 Test Loss: 1.875 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.103405475616455
Epoch: 16, Steps: 17 | Train Loss: 0.496 Vali Loss: 1.966 Vali Acc: 0.228 Test Loss: 1.966 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.513012170791626
Epoch: 17, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.850 Vali Acc: 0.259 Test Loss: 1.850 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.432008981704712
Epoch: 18, Steps: 17 | Train Loss: 0.496 Vali Loss: 1.897 Vali Acc: 0.209 Test Loss: 1.897 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.452195405960083
Epoch: 19, Steps: 17 | Train Loss: 0.413 Vali Loss: 1.997 Vali Acc: 0.217 Test Loss: 1.997 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.520092010498047
Epoch: 20, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.017 Vali Acc: 0.274 Test Loss: 2.017 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 7376890
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.970576286315918
Epoch: 1, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.426 Vali Acc: 0.228 Test Loss: 1.426 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 5.785510778427124
Epoch: 2, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.463 Vali Acc: 0.198 Test Loss: 1.463 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.640300512313843
Epoch: 3, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.474 Vali Acc: 0.221 Test Loss: 1.474 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.111979246139526
Epoch: 4, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.502 Vali Acc: 0.202 Test Loss: 1.502 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.470215797424316
Epoch: 5, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.536 Vali Acc: 0.198 Test Loss: 1.536 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.355709791183472
Epoch: 6, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.632 Vali Acc: 0.202 Test Loss: 1.632 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.628756761550903
Epoch: 7, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.662 Vali Acc: 0.209 Test Loss: 1.662 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.547862529754639
Epoch: 8, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.714 Vali Acc: 0.183 Test Loss: 1.714 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.244754791259766
Epoch: 9, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.610 Vali Acc: 0.251 Test Loss: 1.610 Test Acc: 0.251
Validation loss decreased (-0.228123 --> -0.250934).  Saving model ...
Epoch: 10 cost time: 7.49112343788147
Epoch: 10, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.775 Vali Acc: 0.190 Test Loss: 1.775 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.988550901412964
Epoch: 11, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.681 Vali Acc: 0.213 Test Loss: 1.681 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.935853719711304
Epoch: 12, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.803 Vali Acc: 0.228 Test Loss: 1.803 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.834254503250122
Epoch: 13, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.709 Vali Acc: 0.209 Test Loss: 1.709 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.398829936981201
Epoch: 14, Steps: 17 | Train Loss: 0.637 Vali Loss: 1.826 Vali Acc: 0.217 Test Loss: 1.826 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.5873401165008545
Epoch: 15, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.857 Vali Acc: 0.236 Test Loss: 1.857 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.945793867111206
Epoch: 16, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.867 Vali Acc: 0.236 Test Loss: 1.867 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.362314939498901
Epoch: 17, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.943 Vali Acc: 0.236 Test Loss: 1.943 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.962913990020752
Epoch: 18, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.913 Vali Acc: 0.232 Test Loss: 1.913 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.7168028354644775
Epoch: 19, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.980 Vali Acc: 0.213 Test Loss: 1.980 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 7305210
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.243843078613281
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.437 Vali Acc: 0.240 Test Loss: 1.437 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 3.825562000274658
Epoch: 2, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.464 Vali Acc: 0.251 Test Loss: 1.464 Test Acc: 0.251
Validation loss decreased (-0.239529 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 4.120702028274536
Epoch: 3, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.467 Vali Acc: 0.213 Test Loss: 1.467 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.63468599319458
Epoch: 4, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.531 Vali Acc: 0.251 Test Loss: 1.531 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.219658851623535
Epoch: 5, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.523 Vali Acc: 0.251 Test Loss: 1.523 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.387643337249756
Epoch: 6, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.627 Vali Acc: 0.224 Test Loss: 1.627 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.16161847114563
Epoch: 7, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.570 Vali Acc: 0.243 Test Loss: 1.570 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.488608121871948
Epoch: 8, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.594 Vali Acc: 0.247 Test Loss: 1.594 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.892479419708252
Epoch: 9, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273748).  Saving model ...
Epoch: 10 cost time: 3.988421678543091
Epoch: 10, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8865559101104736
Epoch: 11, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.663 Vali Acc: 0.221 Test Loss: 1.663 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.085604906082153
Epoch: 12, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.789 Vali Acc: 0.236 Test Loss: 1.789 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4571094512939453
Epoch: 13, Steps: 17 | Train Loss: 0.734 Vali Loss: 1.788 Vali Acc: 0.262 Test Loss: 1.788 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.6451287269592285
Epoch: 14, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.718 Vali Acc: 0.274 Test Loss: 1.718 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.483232259750366
Epoch: 15, Steps: 17 | Train Loss: 0.637 Vali Loss: 1.794 Vali Acc: 0.236 Test Loss: 1.794 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.223555088043213
Epoch: 16, Steps: 17 | Train Loss: 0.605 Vali Loss: 1.795 Vali Acc: 0.251 Test Loss: 1.795 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.676097393035889
Epoch: 17, Steps: 17 | Train Loss: 0.592 Vali Loss: 1.819 Vali Acc: 0.255 Test Loss: 1.819 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.873810052871704
Epoch: 18, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.943 Vali Acc: 0.232 Test Loss: 1.943 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.349897146224976
Epoch: 19, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.875 Vali Acc: 0.262 Test Loss: 1.875 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 7270394
model size : 27.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.556072950363159
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.7073516845703125
Epoch: 2, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.480 Vali Acc: 0.205 Test Loss: 1.480 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.044768810272217
Epoch: 3, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.511 Vali Acc: 0.221 Test Loss: 1.511 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5044190883636475
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.512 Vali Acc: 0.240 Test Loss: 1.512 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5295536518096924
Epoch: 5, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.592 Vali Acc: 0.228 Test Loss: 1.592 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.976789712905884
Epoch: 6, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7356138229370117
Epoch: 7, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.586 Vali Acc: 0.251 Test Loss: 1.586 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.246870279312134
Epoch: 8, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.733 Vali Acc: 0.251 Test Loss: 1.733 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.570641279220581
Epoch: 9, Steps: 17 | Train Loss: 0.792 Vali Loss: 1.655 Vali Acc: 0.217 Test Loss: 1.655 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7966396808624268
Epoch: 10, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.758 Vali Acc: 0.217 Test Loss: 1.758 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.978212594985962
Epoch: 11, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.769 Vali Acc: 0.217 Test Loss: 1.769 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 7233530
model size : 27.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6345021724700928
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.444 Vali Acc: 0.236 Test Loss: 1.444 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.032707691192627
Epoch: 2, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.468 Vali Acc: 0.175 Test Loss: 1.468 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6051359176635742
Epoch: 3, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.532 Vali Acc: 0.224 Test Loss: 1.532 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2101945877075195
Epoch: 4, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.498 Vali Acc: 0.259 Test Loss: 1.498 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 1.378868579864502
Epoch: 5, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.604 Vali Acc: 0.228 Test Loss: 1.604 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3021769523620605
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.583 Vali Acc: 0.251 Test Loss: 1.583 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2025468349456787
Epoch: 7, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.511 Vali Acc: 0.243 Test Loss: 1.511 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1923449039459229
Epoch: 8, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.615 Vali Acc: 0.270 Test Loss: 1.615 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269946).  Saving model ...
Epoch: 9 cost time: 1.3130841255187988
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.612 Vali Acc: 0.228 Test Loss: 1.612 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1753559112548828
Epoch: 10, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.745 Vali Acc: 0.228 Test Loss: 1.745 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0016999244689941
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.604 Vali Acc: 0.251 Test Loss: 1.604 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.201432704925537
Epoch: 12, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.653 Vali Acc: 0.217 Test Loss: 1.653 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2007019519805908
Epoch: 13, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.629 Vali Acc: 0.255 Test Loss: 1.629 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.178434133529663
Epoch: 14, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.828 Vali Acc: 0.259 Test Loss: 1.828 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2027809619903564
Epoch: 15, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.680 Vali Acc: 0.232 Test Loss: 1.680 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3672919273376465
Epoch: 16, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.686 Vali Acc: 0.255 Test Loss: 1.686 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4400084018707275
Epoch: 17, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.714 Vali Acc: 0.285 Test Loss: 1.714 Test Acc: 0.285
Validation loss decreased (-0.269946 --> -0.285154).  Saving model ...
Epoch: 18 cost time: 1.3298547267913818
Epoch: 18, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.955 Vali Acc: 0.232 Test Loss: 1.955 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2350163459777832
Epoch: 19, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.994 Vali Acc: 0.247 Test Loss: 1.994 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2626843452453613
Epoch: 20, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.889 Vali Acc: 0.228 Test Loss: 1.889 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1972289085388184
Epoch: 21, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.917 Vali Acc: 0.240 Test Loss: 1.917 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2759504318237305
Epoch: 22, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.930 Vali Acc: 0.224 Test Loss: 1.930 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.170363187789917
Epoch: 23, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.902 Vali Acc: 0.247 Test Loss: 1.902 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2154643535614014
Epoch: 24, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.254 Vali Acc: 0.232 Test Loss: 2.254 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9945206642150879
Epoch: 25, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.172 Vali Acc: 0.251 Test Loss: 2.172 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1979124546051025
Epoch: 26, Steps: 17 | Train Loss: 0.691 Vali Loss: 2.177 Vali Acc: 0.270 Test Loss: 2.177 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3170146942138672
Epoch: 27, Steps: 17 | Train Loss: 0.653 Vali Loss: 2.323 Vali Acc: 0.251 Test Loss: 2.323 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 7198714
model size : 27.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.368401050567627
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.486 Vali Acc: 0.255 Test Loss: 1.486 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 20.32126474380493
Epoch: 2, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.836387872695923
Epoch: 3, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.495 Vali Acc: 0.270 Test Loss: 1.495 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 19.49592089653015
Epoch: 4, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.556 Vali Acc: 0.198 Test Loss: 1.556 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.5666606426239
Epoch: 5, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.018797874450684
Epoch: 6, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.573 Vali Acc: 0.228 Test Loss: 1.573 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.18955397605896
Epoch: 7, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.310399293899536
Epoch: 8, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.649 Vali Acc: 0.251 Test Loss: 1.649 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.54770827293396
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.701 Vali Acc: 0.236 Test Loss: 1.701 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.501884698867798
Epoch: 10, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.730973482131958
Epoch: 11, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.692 Vali Acc: 0.221 Test Loss: 1.692 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.300434350967407
Epoch: 12, Steps: 17 | Train Loss: 0.797 Vali Loss: 1.775 Vali Acc: 0.243 Test Loss: 1.775 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.133798122406006
Epoch: 13, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.866 Vali Acc: 0.240 Test Loss: 1.866 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 7645144
model size : 29.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.025758981704712
Epoch: 1, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.494 Vali Acc: 0.205 Test Loss: 1.494 Test Acc: 0.205
Validation loss decreased (inf --> -0.205308).  Saving model ...
Epoch: 2 cost time: 17.081359148025513
Epoch: 2, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.515 Vali Acc: 0.232 Test Loss: 1.515 Test Acc: 0.232
Validation loss decreased (-0.205308 --> -0.231924).  Saving model ...
Epoch: 3 cost time: 17.53342366218567
Epoch: 3, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.518 Vali Acc: 0.274 Test Loss: 1.518 Test Acc: 0.274
Validation loss decreased (-0.231924 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 17.919437885284424
Epoch: 4, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.557 Vali Acc: 0.247 Test Loss: 1.557 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.6945481300354
Epoch: 5, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.575 Vali Acc: 0.205 Test Loss: 1.575 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.141974210739136
Epoch: 6, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.615 Vali Acc: 0.262 Test Loss: 1.615 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.1361985206604
Epoch: 7, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.678 Vali Acc: 0.236 Test Loss: 1.678 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.79855465888977
Epoch: 8, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.727 Vali Acc: 0.228 Test Loss: 1.727 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.74540638923645
Epoch: 9, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.653 Vali Acc: 0.240 Test Loss: 1.653 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.182576179504395
Epoch: 10, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.785 Vali Acc: 0.209 Test Loss: 1.785 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.71959948539734
Epoch: 11, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.679 Vali Acc: 0.224 Test Loss: 1.679 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.9227032661438
Epoch: 12, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.750 Vali Acc: 0.228 Test Loss: 1.750 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.466729640960693
Epoch: 13, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.816 Vali Acc: 0.228 Test Loss: 1.816 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 7557080
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.397642374038696
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.488 Vali Acc: 0.205 Test Loss: 1.488 Test Acc: 0.205
Validation loss decreased (inf --> -0.205308).  Saving model ...
Epoch: 2 cost time: 13.300080060958862
Epoch: 2, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.496 Vali Acc: 0.213 Test Loss: 1.496 Test Acc: 0.213
Validation loss decreased (-0.205308 --> -0.212913).  Saving model ...
Epoch: 3 cost time: 13.31349229812622
Epoch: 3, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.548 Vali Acc: 0.251 Test Loss: 1.548 Test Acc: 0.251
Validation loss decreased (-0.212913 --> -0.250935).  Saving model ...
Epoch: 4 cost time: 14.148912191390991
Epoch: 4, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.563 Vali Acc: 0.228 Test Loss: 1.563 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.21552324295044
Epoch: 5, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.590841293334961
Epoch: 6, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.617 Vali Acc: 0.228 Test Loss: 1.617 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.153800010681152
Epoch: 7, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.683 Vali Acc: 0.247 Test Loss: 1.683 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.177465438842773
Epoch: 8, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.668 Vali Acc: 0.228 Test Loss: 1.668 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.044577836990356
Epoch: 9, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.740 Vali Acc: 0.228 Test Loss: 1.740 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.669498682022095
Epoch: 10, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.645 Vali Acc: 0.247 Test Loss: 1.645 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.608399868011475
Epoch: 11, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.741 Vali Acc: 0.236 Test Loss: 1.741 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.718187093734741
Epoch: 12, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.692 Vali Acc: 0.209 Test Loss: 1.692 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.054558038711548
Epoch: 13, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.791 Vali Acc: 0.240 Test Loss: 1.791 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 7466968
model size : 28.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.451161623001099
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.438 Vali Acc: 0.259 Test Loss: 1.438 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 9.497778415679932
Epoch: 2, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.512 Vali Acc: 0.236 Test Loss: 1.512 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.168745279312134
Epoch: 3, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.393562078475952
Epoch: 4, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.563 Vali Acc: 0.205 Test Loss: 1.563 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.775279760360718
Epoch: 5, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.621 Vali Acc: 0.217 Test Loss: 1.621 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.170464038848877
Epoch: 6, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.591 Vali Acc: 0.224 Test Loss: 1.591 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.698412418365479
Epoch: 7, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.582 Vali Acc: 0.221 Test Loss: 1.582 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.472878456115723
Epoch: 8, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.031436681747437
Epoch: 9, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.707 Vali Acc: 0.202 Test Loss: 1.707 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.988843202590942
Epoch: 10, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.709 Vali Acc: 0.202 Test Loss: 1.709 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.346973896026611
Epoch: 11, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.749 Vali Acc: 0.236 Test Loss: 1.749 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 7376856
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.860836982727051
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.488 Vali Acc: 0.190 Test Loss: 1.488 Test Acc: 0.190
Validation loss decreased (inf --> -0.190099).  Saving model ...
Epoch: 2 cost time: 5.217955827713013
Epoch: 2, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.489 Vali Acc: 0.224 Test Loss: 1.489 Test Acc: 0.224
Validation loss decreased (-0.190099 --> -0.224320).  Saving model ...
Epoch: 3 cost time: 5.91072416305542
Epoch: 3, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.538 Vali Acc: 0.198 Test Loss: 1.538 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.683041095733643
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.586 Vali Acc: 0.247 Test Loss: 1.586 Test Acc: 0.247
Validation loss decreased (-0.224320 --> -0.247132).  Saving model ...
Epoch: 5 cost time: 5.44627571105957
Epoch: 5, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.587 Vali Acc: 0.217 Test Loss: 1.587 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.774934768676758
Epoch: 6, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.724 Vali Acc: 0.221 Test Loss: 1.724 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0713770389556885
Epoch: 7, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.579 Vali Acc: 0.270 Test Loss: 1.579 Test Acc: 0.270
Validation loss decreased (-0.247132 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 5.360357761383057
Epoch: 8, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.775 Vali Acc: 0.243 Test Loss: 1.775 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.312525749206543
Epoch: 9, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.625 Vali Acc: 0.179 Test Loss: 1.625 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.8060173988342285
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.680 Vali Acc: 0.224 Test Loss: 1.680 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.2944440841674805
Epoch: 11, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.707 Vali Acc: 0.224 Test Loss: 1.707 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.20446252822876
Epoch: 12, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.660 Vali Acc: 0.251 Test Loss: 1.660 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.1458845138549805
Epoch: 13, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.807 Vali Acc: 0.247 Test Loss: 1.807 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.732784748077393
Epoch: 14, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.980 Vali Acc: 0.209 Test Loss: 1.980 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.550912857055664
Epoch: 15, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.821 Vali Acc: 0.255 Test Loss: 1.821 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.794338941574097
Epoch: 16, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.038 Vali Acc: 0.251 Test Loss: 2.038 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.4202775955200195
Epoch: 17, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.897 Vali Acc: 0.232 Test Loss: 1.897 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 7305176
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.743883848190308
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.469 Vali Acc: 0.221 Test Loss: 1.469 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 3.7304880619049072
Epoch: 2, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.461 Vali Acc: 0.285 Test Loss: 1.461 Test Acc: 0.285
Validation loss decreased (-0.220518 --> -0.285156).  Saving model ...
Epoch: 3 cost time: 4.48844051361084
Epoch: 3, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.485 Vali Acc: 0.236 Test Loss: 1.485 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.216200828552246
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.538 Vali Acc: 0.221 Test Loss: 1.538 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8855161666870117
Epoch: 5, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.618 Vali Acc: 0.205 Test Loss: 1.618 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.237050294876099
Epoch: 6, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.617 Vali Acc: 0.262 Test Loss: 1.617 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.68636417388916
Epoch: 7, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.608 Vali Acc: 0.266 Test Loss: 1.608 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.403262138366699
Epoch: 8, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.592 Vali Acc: 0.240 Test Loss: 1.592 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.6751928329467773
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.757 Vali Acc: 0.259 Test Loss: 1.757 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.437445402145386
Epoch: 10, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.735 Vali Acc: 0.243 Test Loss: 1.735 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.4117259979248047
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.728 Vali Acc: 0.217 Test Loss: 1.728 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.673901319503784
Epoch: 12, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 7270360
model size : 27.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.156280517578125
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.457 Vali Acc: 0.217 Test Loss: 1.457 Test Acc: 0.217
Validation loss decreased (inf --> -0.216715).  Saving model ...
Epoch: 2 cost time: 2.2105236053466797
Epoch: 2, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
Validation loss decreased (-0.216715 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 2.3991849422454834
Epoch: 3, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.535 Vali Acc: 0.224 Test Loss: 1.535 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0737314224243164
Epoch: 4, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.647 Vali Acc: 0.243 Test Loss: 1.647 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2651634216308594
Epoch: 5, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.517 Vali Acc: 0.221 Test Loss: 1.517 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.343688726425171
Epoch: 6, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.615 Vali Acc: 0.243 Test Loss: 1.615 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.434636354446411
Epoch: 7, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.704 Vali Acc: 0.221 Test Loss: 1.704 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.380340814590454
Epoch: 8, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.620 Vali Acc: 0.221 Test Loss: 1.620 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.215325355529785
Epoch: 9, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.818 Vali Acc: 0.224 Test Loss: 1.818 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0343096256256104
Epoch: 10, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.758 Vali Acc: 0.247 Test Loss: 1.758 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.479417562484741
Epoch: 11, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.783 Vali Acc: 0.259 Test Loss: 1.783 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.193068265914917
Epoch: 12, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.651 Vali Acc: 0.255 Test Loss: 1.651 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 7233496
model size : 27.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.149411916732788
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.249000072479248
Epoch: 2, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.491 Vali Acc: 0.274 Test Loss: 1.491 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 1.3947980403900146
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.567 Vali Acc: 0.243 Test Loss: 1.567 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3764240741729736
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.539 Vali Acc: 0.209 Test Loss: 1.539 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.178358554840088
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.589 Vali Acc: 0.224 Test Loss: 1.589 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0889322757720947
Epoch: 6, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.639 Vali Acc: 0.194 Test Loss: 1.639 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2663836479187012
Epoch: 7, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.549 Vali Acc: 0.251 Test Loss: 1.549 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.44063401222229
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.549 Vali Acc: 0.209 Test Loss: 1.549 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0406100749969482
Epoch: 9, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.571 Vali Acc: 0.221 Test Loss: 1.571 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2752151489257812
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.697 Vali Acc: 0.259 Test Loss: 1.697 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1253306865692139
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.687 Vali Acc: 0.243 Test Loss: 1.687 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2649898529052734
Epoch: 12, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.630 Vali Acc: 0.228 Test Loss: 1.630 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 7198680
model size : 27.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.95051622390747
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 22.140063285827637
Epoch: 2, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.443 Vali Acc: 0.274 Test Loss: 1.443 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 21.020025968551636
Epoch: 3, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.586503505706787
Epoch: 4, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.448 Vali Acc: 0.281 Test Loss: 1.448 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 20.66260266304016
Epoch: 5, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.456 Vali Acc: 0.247 Test Loss: 1.456 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.99521565437317
Epoch: 6, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.501 Vali Acc: 0.221 Test Loss: 1.501 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.207393169403076
Epoch: 7, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.519 Vali Acc: 0.240 Test Loss: 1.519 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 21.554840087890625
Epoch: 8, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.548 Vali Acc: 0.262 Test Loss: 1.548 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.497495651245117
Epoch: 9, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.545 Vali Acc: 0.262 Test Loss: 1.545 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.51963520050049
Epoch: 10, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.589 Vali Acc: 0.213 Test Loss: 1.589 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 20.608781814575195
Epoch: 11, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.626 Vali Acc: 0.251 Test Loss: 1.626 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 20.89689612388611
Epoch: 12, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.679 Vali Acc: 0.255 Test Loss: 1.679 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 20.0091290473938
Epoch: 13, Steps: 17 | Train Loss: 0.757 Vali Loss: 1.685 Vali Acc: 0.278 Test Loss: 1.685 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 20.396312713623047
Epoch: 14, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3834874
model size : 15.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.436543464660645
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.442 Vali Acc: 0.236 Test Loss: 1.442 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 16.354021549224854
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.446 Vali Acc: 0.236 Test Loss: 1.446 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.84919548034668
Epoch: 3, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.479 Vali Acc: 0.270 Test Loss: 1.479 Test Acc: 0.270
Validation loss decreased (-0.235727 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 16.88303279876709
Epoch: 4, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.468 Vali Acc: 0.236 Test Loss: 1.468 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.731658935546875
Epoch: 5, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.501 Vali Acc: 0.251 Test Loss: 1.501 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.956693410873413
Epoch: 6, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.535 Vali Acc: 0.247 Test Loss: 1.535 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.65200638771057
Epoch: 7, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.634 Vali Acc: 0.251 Test Loss: 1.634 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.655935764312744
Epoch: 8, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.576 Vali Acc: 0.270 Test Loss: 1.576 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.79466962814331
Epoch: 9, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.543 Vali Acc: 0.247 Test Loss: 1.543 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.388864755630493
Epoch: 10, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273748).  Saving model ...
Epoch: 11 cost time: 16.95250678062439
Epoch: 11, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.632 Vali Acc: 0.232 Test Loss: 1.632 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.580107927322388
Epoch: 12, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.642 Vali Acc: 0.281 Test Loss: 1.642 Test Acc: 0.281
Validation loss decreased (-0.273748 --> -0.281352).  Saving model ...
Epoch: 13 cost time: 16.73501491546631
Epoch: 13, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.637 Vali Acc: 0.259 Test Loss: 1.637 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.15973448753357
Epoch: 14, Steps: 17 | Train Loss: 0.742 Vali Loss: 1.673 Vali Acc: 0.270 Test Loss: 1.673 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.458232879638672
Epoch: 15, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.683 Vali Acc: 0.240 Test Loss: 1.683 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.219995975494385
Epoch: 16, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.767 Vali Acc: 0.259 Test Loss: 1.767 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.765220403671265
Epoch: 17, Steps: 17 | Train Loss: 0.619 Vali Loss: 1.793 Vali Acc: 0.251 Test Loss: 1.793 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.900540113449097
Epoch: 18, Steps: 17 | Train Loss: 0.577 Vali Loss: 1.768 Vali Acc: 0.259 Test Loss: 1.768 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 15.718931913375854
Epoch: 19, Steps: 17 | Train Loss: 0.553 Vali Loss: 1.866 Vali Acc: 0.217 Test Loss: 1.866 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.380111694335938
Epoch: 20, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.850441217422485
Epoch: 21, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.957 Vali Acc: 0.262 Test Loss: 1.957 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.170661449432373
Epoch: 22, Steps: 17 | Train Loss: 0.480 Vali Loss: 2.030 Vali Acc: 0.259 Test Loss: 2.030 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3790842
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.940733194351196
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.410 Vali Acc: 0.194 Test Loss: 1.410 Test Acc: 0.194
Validation loss decreased (inf --> -0.193902).  Saving model ...
Epoch: 2 cost time: 11.809773683547974
Epoch: 2, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
Validation loss decreased (-0.193902 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 11.22934603691101
Epoch: 3, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.474 Vali Acc: 0.198 Test Loss: 1.474 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.712764501571655
Epoch: 4, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.485 Vali Acc: 0.171 Test Loss: 1.485 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.437572240829468
Epoch: 5, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.512 Vali Acc: 0.198 Test Loss: 1.512 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.37418270111084
Epoch: 6, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.512 Vali Acc: 0.217 Test Loss: 1.512 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.57667875289917
Epoch: 7, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.569 Vali Acc: 0.221 Test Loss: 1.569 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.487903833389282
Epoch: 8, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.581 Vali Acc: 0.221 Test Loss: 1.581 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.70733380317688
Epoch: 9, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.645 Vali Acc: 0.198 Test Loss: 1.645 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.521977663040161
Epoch: 10, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258539).  Saving model ...
Epoch: 11 cost time: 11.775484085083008
Epoch: 11, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.720 Vali Acc: 0.183 Test Loss: 1.720 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.0228271484375
Epoch: 12, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.764 Vali Acc: 0.255 Test Loss: 1.764 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.302404642105103
Epoch: 13, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.710 Vali Acc: 0.221 Test Loss: 1.710 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.036625623703003
Epoch: 14, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.785 Vali Acc: 0.240 Test Loss: 1.785 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.303916454315186
Epoch: 15, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.769 Vali Acc: 0.232 Test Loss: 1.769 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.8186674118042
Epoch: 16, Steps: 17 | Train Loss: 0.625 Vali Loss: 1.849 Vali Acc: 0.213 Test Loss: 1.849 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.430518388748169
Epoch: 17, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.886 Vali Acc: 0.224 Test Loss: 1.886 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.941730737686157
Epoch: 18, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.822 Vali Acc: 0.259 Test Loss: 1.822 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.581145286560059
Epoch: 19, Steps: 17 | Train Loss: 0.529 Vali Loss: 1.906 Vali Acc: 0.221 Test Loss: 1.906 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.024232387542725
Epoch: 20, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.995 Vali Acc: 0.232 Test Loss: 1.995 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 3745786
model size : 14.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.462537050247192
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.415 Vali Acc: 0.221 Test Loss: 1.415 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 7.225779056549072
Epoch: 2, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.450 Vali Acc: 0.247 Test Loss: 1.450 Test Acc: 0.247
Validation loss decreased (-0.220518 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 7.445227146148682
Epoch: 3, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.459 Vali Acc: 0.247 Test Loss: 1.459 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.907015085220337
Epoch: 4, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.461 Vali Acc: 0.251 Test Loss: 1.461 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 6.868786096572876
Epoch: 5, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.486 Vali Acc: 0.217 Test Loss: 1.486 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.371970653533936
Epoch: 6, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.504 Vali Acc: 0.228 Test Loss: 1.504 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.65721321105957
Epoch: 7, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.517 Vali Acc: 0.243 Test Loss: 1.517 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.202085971832275
Epoch: 8, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.533 Vali Acc: 0.266 Test Loss: 1.533 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266144).  Saving model ...
Epoch: 9 cost time: 6.726367473602295
Epoch: 9, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.554 Vali Acc: 0.247 Test Loss: 1.554 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.812167644500732
Epoch: 10, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.574 Vali Acc: 0.232 Test Loss: 1.574 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.175074577331543
Epoch: 11, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.614 Vali Acc: 0.255 Test Loss: 1.614 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.50660490989685
Epoch: 12, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.634 Vali Acc: 0.243 Test Loss: 1.634 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.4195051193237305
Epoch: 13, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.656 Vali Acc: 0.228 Test Loss: 1.656 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.93152379989624
Epoch: 14, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.735 Vali Acc: 0.251 Test Loss: 1.735 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.303217649459839
Epoch: 15, Steps: 17 | Train Loss: 0.707 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.8629631996154785
Epoch: 16, Steps: 17 | Train Loss: 0.607 Vali Loss: 1.732 Vali Acc: 0.255 Test Loss: 1.732 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.285072088241577
Epoch: 17, Steps: 17 | Train Loss: 0.604 Vali Loss: 1.774 Vali Acc: 0.259 Test Loss: 1.774 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.934164047241211
Epoch: 18, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.791 Vali Acc: 0.232 Test Loss: 1.791 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 3700730
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.2128942012786865
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.404 Vali Acc: 0.270 Test Loss: 1.404 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 5.330286979675293
Epoch: 2, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.06761908531189
Epoch: 3, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.444 Vali Acc: 0.274 Test Loss: 1.444 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 4.4744532108306885
Epoch: 4, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.483 Vali Acc: 0.236 Test Loss: 1.483 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.218284845352173
Epoch: 5, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.490 Vali Acc: 0.255 Test Loss: 1.490 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.181383848190308
Epoch: 6, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.547 Vali Acc: 0.228 Test Loss: 1.547 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.574403524398804
Epoch: 7, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.962397336959839
Epoch: 8, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.547 Vali Acc: 0.243 Test Loss: 1.547 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.282648324966431
Epoch: 9, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.576 Vali Acc: 0.228 Test Loss: 1.576 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.621638774871826
Epoch: 10, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.675 Vali Acc: 0.274 Test Loss: 1.675 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.867944240570068
Epoch: 11, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.600 Vali Acc: 0.221 Test Loss: 1.600 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.488419532775879
Epoch: 12, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.701 Vali Acc: 0.262 Test Loss: 1.701 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.653814077377319
Epoch: 13, Steps: 17 | Train Loss: 0.674 Vali Loss: 1.734 Vali Acc: 0.240 Test Loss: 1.734 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3664890
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.200420618057251
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 3.053912401199341
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.460 Vali Acc: 0.236 Test Loss: 1.460 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0540616512298584
Epoch: 3, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.483 Vali Acc: 0.247 Test Loss: 1.483 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247133).  Saving model ...
Epoch: 4 cost time: 3.06282901763916
Epoch: 4, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.484 Vali Acc: 0.213 Test Loss: 1.484 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.322575807571411
Epoch: 5, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.515 Vali Acc: 0.217 Test Loss: 1.515 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.941805362701416
Epoch: 6, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.599 Vali Acc: 0.198 Test Loss: 1.599 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4765267372131348
Epoch: 7, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.576 Vali Acc: 0.228 Test Loss: 1.576 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4421303272247314
Epoch: 8, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.635 Vali Acc: 0.213 Test Loss: 1.635 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.686641216278076
Epoch: 9, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.667 Vali Acc: 0.224 Test Loss: 1.667 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.234826326370239
Epoch: 10, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.686 Vali Acc: 0.205 Test Loss: 1.686 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.289621829986572
Epoch: 11, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.707 Vali Acc: 0.209 Test Loss: 1.707 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.023517847061157
Epoch: 12, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.768 Vali Acc: 0.228 Test Loss: 1.768 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.171306133270264
Epoch: 13, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.828 Vali Acc: 0.213 Test Loss: 1.828 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.24714828897338403
model parameter : 3647482
model size : 14.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.5063066482543945
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.5557966232299805
Epoch: 2, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.485 Vali Acc: 0.209 Test Loss: 1.485 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.985344886779785
Epoch: 3, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.485 Vali Acc: 0.232 Test Loss: 1.485 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6076180934906006
Epoch: 4, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.502 Vali Acc: 0.247 Test Loss: 1.502 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.16621732711792
Epoch: 5, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.541 Vali Acc: 0.209 Test Loss: 1.541 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.611734390258789
Epoch: 6, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.545 Vali Acc: 0.243 Test Loss: 1.545 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.333662509918213
Epoch: 7, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.649 Vali Acc: 0.183 Test Loss: 1.649 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7731947898864746
Epoch: 8, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.633 Vali Acc: 0.213 Test Loss: 1.633 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8653781414031982
Epoch: 9, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.682 Vali Acc: 0.217 Test Loss: 1.682 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4040799140930176
Epoch: 10, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.713 Vali Acc: 0.240 Test Loss: 1.713 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.450516939163208
Epoch: 11, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.707 Vali Acc: 0.205 Test Loss: 1.707 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 3629050
model size : 13.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.185802698135376
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.9476578235626221
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.493 Vali Acc: 0.232 Test Loss: 1.493 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.145326852798462
Epoch: 3, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.456 Vali Acc: 0.224 Test Loss: 1.456 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.911163330078125
Epoch: 4, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.547 Vali Acc: 0.221 Test Loss: 1.547 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2082157135009766
Epoch: 5, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.464 Vali Acc: 0.266 Test Loss: 1.464 Test Acc: 0.266
Validation loss decreased (-0.243332 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.0348248481750488
Epoch: 6, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.546 Vali Acc: 0.224 Test Loss: 1.546 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3042335510253906
Epoch: 7, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.538 Vali Acc: 0.255 Test Loss: 1.538 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1098008155822754
Epoch: 8, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.119882583618164
Epoch: 9, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.574 Vali Acc: 0.213 Test Loss: 1.574 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0714576244354248
Epoch: 10, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.652 Vali Acc: 0.281 Test Loss: 1.652 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281352).  Saving model ...
Epoch: 11 cost time: 0.9103021621704102
Epoch: 11, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.603 Vali Acc: 0.281 Test Loss: 1.603 Test Acc: 0.281
Validation loss decreased (-0.281352 --> -0.281353).  Saving model ...
Epoch: 12 cost time: 0.9370388984680176
Epoch: 12, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.630 Vali Acc: 0.224 Test Loss: 1.630 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9504790306091309
Epoch: 13, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.720 Vali Acc: 0.247 Test Loss: 1.720 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0757498741149902
Epoch: 14, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.689 Vali Acc: 0.259 Test Loss: 1.689 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2625768184661865
Epoch: 15, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.696 Vali Acc: 0.228 Test Loss: 1.696 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0001153945922852
Epoch: 16, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.771 Vali Acc: 0.213 Test Loss: 1.771 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.059877872467041
Epoch: 17, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.841 Vali Acc: 0.278 Test Loss: 1.841 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1228806972503662
Epoch: 18, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.825 Vali Acc: 0.255 Test Loss: 1.825 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.842022180557251
Epoch: 19, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.916 Vali Acc: 0.232 Test Loss: 1.916 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9453389644622803
Epoch: 20, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.959 Vali Acc: 0.293 Test Loss: 1.959 Test Acc: 0.293
Validation loss decreased (-0.281353 --> -0.292756).  Saving model ...
Epoch: 21 cost time: 1.0546283721923828
Epoch: 21, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.964 Vali Acc: 0.274 Test Loss: 1.964 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9891002178192139
Epoch: 22, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.885 Vali Acc: 0.278 Test Loss: 1.885 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0644218921661377
Epoch: 23, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.058 Vali Acc: 0.236 Test Loss: 2.058 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0225346088409424
Epoch: 24, Steps: 17 | Train Loss: 0.705 Vali Loss: 2.198 Vali Acc: 0.259 Test Loss: 2.198 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8739104270935059
Epoch: 25, Steps: 17 | Train Loss: 0.584 Vali Loss: 2.121 Vali Acc: 0.274 Test Loss: 2.121 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9718184471130371
Epoch: 26, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.129 Vali Acc: 0.274 Test Loss: 2.129 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9066002368927002
Epoch: 27, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.310 Vali Acc: 0.274 Test Loss: 2.310 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.014949083328247
Epoch: 28, Steps: 17 | Train Loss: 0.503 Vali Loss: 2.220 Vali Acc: 0.289 Test Loss: 2.220 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9558470249176025
Epoch: 29, Steps: 17 | Train Loss: 0.584 Vali Loss: 2.513 Vali Acc: 0.300 Test Loss: 2.513 Test Acc: 0.300
Validation loss decreased (-0.292756 --> -0.300355).  Saving model ...
Epoch: 30 cost time: 1.0154237747192383
Epoch: 30, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.747 Vali Acc: 0.278 Test Loss: 2.747 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9307937622070312
Epoch: 31, Steps: 17 | Train Loss: 0.505 Vali Loss: 2.614 Vali Acc: 0.236 Test Loss: 2.614 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9647881984710693
Epoch: 32, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.634 Vali Acc: 0.293 Test Loss: 2.634 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9278824329376221
Epoch: 33, Steps: 17 | Train Loss: 0.439 Vali Loss: 3.016 Vali Acc: 0.262 Test Loss: 3.016 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0553483963012695
Epoch: 34, Steps: 17 | Train Loss: 0.365 Vali Loss: 2.818 Vali Acc: 0.247 Test Loss: 2.818 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.085700511932373
Epoch: 35, Steps: 17 | Train Loss: 0.310 Vali Loss: 3.149 Vali Acc: 0.243 Test Loss: 3.149 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.216855764389038
Epoch: 36, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.847 Vali Acc: 0.243 Test Loss: 2.847 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1120812892913818
Epoch: 37, Steps: 17 | Train Loss: 0.317 Vali Loss: 3.143 Vali Acc: 0.240 Test Loss: 3.143 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.200683355331421
Epoch: 38, Steps: 17 | Train Loss: 0.319 Vali Loss: 3.412 Vali Acc: 0.266 Test Loss: 3.412 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2595913410186768
Epoch: 39, Steps: 17 | Train Loss: 0.327 Vali Loss: 3.427 Vali Acc: 0.266 Test Loss: 3.427 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3611642
model size : 13.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.71592092514038
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.439 Vali Acc: 0.236 Test Loss: 1.439 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 18.260464191436768
Epoch: 2, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.501 Vali Acc: 0.266 Test Loss: 1.501 Test Acc: 0.266
Validation loss decreased (-0.235727 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 16.724072217941284
Epoch: 3, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.504 Vali Acc: 0.251 Test Loss: 1.504 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.259830236434937
Epoch: 4, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.572 Vali Acc: 0.247 Test Loss: 1.572 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.638481616973877
Epoch: 5, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.578 Vali Acc: 0.205 Test Loss: 1.578 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.347248554229736
Epoch: 6, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.650 Vali Acc: 0.243 Test Loss: 1.650 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.90328073501587
Epoch: 7, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.699 Vali Acc: 0.243 Test Loss: 1.699 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.554903268814087
Epoch: 8, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.656 Vali Acc: 0.251 Test Loss: 1.656 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.82795739173889
Epoch: 9, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.702 Vali Acc: 0.217 Test Loss: 1.702 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.80112934112549
Epoch: 10, Steps: 17 | Train Loss: 0.777 Vali Loss: 1.752 Vali Acc: 0.274 Test Loss: 1.752 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273747).  Saving model ...
Epoch: 11 cost time: 17.80474615097046
Epoch: 11, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.760 Vali Acc: 0.255 Test Loss: 1.760 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.870952129364014
Epoch: 12, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.896 Vali Acc: 0.266 Test Loss: 1.896 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.545615434646606
Epoch: 13, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.825 Vali Acc: 0.240 Test Loss: 1.825 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.850075244903564
Epoch: 14, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.806 Vali Acc: 0.240 Test Loss: 1.806 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.263784646987915
Epoch: 15, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.056 Vali Acc: 0.243 Test Loss: 2.056 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 18.535632133483887
Epoch: 16, Steps: 17 | Train Loss: 0.653 Vali Loss: 1.772 Vali Acc: 0.240 Test Loss: 1.772 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 18.27577018737793
Epoch: 17, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.933 Vali Acc: 0.266 Test Loss: 1.933 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.038936138153076
Epoch: 18, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.004 Vali Acc: 0.247 Test Loss: 2.004 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.945668697357178
Epoch: 19, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.004 Vali Acc: 0.255 Test Loss: 2.004 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 19.50441884994507
Epoch: 20, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.051 Vali Acc: 0.251 Test Loss: 2.051 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3834840
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.69379758834839
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 15.413635492324829
Epoch: 2, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.490 Vali Acc: 0.228 Test Loss: 1.490 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.064470291137695
Epoch: 3, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.529 Vali Acc: 0.205 Test Loss: 1.529 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.095736026763916
Epoch: 4, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.514 Vali Acc: 0.224 Test Loss: 1.514 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.32687473297119
Epoch: 5, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.561 Vali Acc: 0.247 Test Loss: 1.561 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247133).  Saving model ...
Epoch: 6 cost time: 16.025527477264404
Epoch: 6, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.14208197593689
Epoch: 7, Steps: 17 | Train Loss: 0.837 Vali Loss: 1.626 Vali Acc: 0.251 Test Loss: 1.626 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250934).  Saving model ...
Epoch: 8 cost time: 15.428691625595093
Epoch: 8, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.675 Vali Acc: 0.209 Test Loss: 1.675 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.313678503036499
Epoch: 9, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.685 Vali Acc: 0.221 Test Loss: 1.685 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.07517671585083
Epoch: 10, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.678 Vali Acc: 0.224 Test Loss: 1.678 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.912955284118652
Epoch: 11, Steps: 17 | Train Loss: 0.741 Vali Loss: 1.767 Vali Acc: 0.247 Test Loss: 1.767 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.913648843765259
Epoch: 12, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.732 Vali Acc: 0.266 Test Loss: 1.732 Test Acc: 0.266
Validation loss decreased (-0.250934 --> -0.266142).  Saving model ...
Epoch: 13 cost time: 14.105334997177124
Epoch: 13, Steps: 17 | Train Loss: 0.655 Vali Loss: 1.777 Vali Acc: 0.236 Test Loss: 1.777 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.31110143661499
Epoch: 14, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.734 Vali Acc: 0.270 Test Loss: 1.734 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269945).  Saving model ...
Epoch: 15 cost time: 15.834333181381226
Epoch: 15, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.937 Vali Acc: 0.232 Test Loss: 1.937 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.812851428985596
Epoch: 16, Steps: 17 | Train Loss: 0.588 Vali Loss: 1.933 Vali Acc: 0.209 Test Loss: 1.933 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 16.498860120773315
Epoch: 17, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.983 Vali Acc: 0.202 Test Loss: 1.983 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.45247173309326
Epoch: 18, Steps: 17 | Train Loss: 0.591 Vali Loss: 2.026 Vali Acc: 0.224 Test Loss: 2.026 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.08052086830139
Epoch: 19, Steps: 17 | Train Loss: 0.509 Vali Loss: 2.039 Vali Acc: 0.243 Test Loss: 2.039 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.280680656433105
Epoch: 20, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.071 Vali Acc: 0.243 Test Loss: 2.071 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.649956464767456
Epoch: 21, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.970 Vali Acc: 0.285 Test Loss: 1.970 Test Acc: 0.285
Validation loss decreased (-0.269945 --> -0.285151).  Saving model ...
Epoch: 22 cost time: 16.368953943252563
Epoch: 22, Steps: 17 | Train Loss: 0.438 Vali Loss: 2.124 Vali Acc: 0.243 Test Loss: 2.124 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 16.2587468624115
Epoch: 23, Steps: 17 | Train Loss: 0.398 Vali Loss: 2.104 Vali Acc: 0.205 Test Loss: 2.104 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.610371351242065
Epoch: 24, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.098 Vali Acc: 0.259 Test Loss: 2.098 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 16.543113946914673
Epoch: 25, Steps: 17 | Train Loss: 0.421 Vali Loss: 2.117 Vali Acc: 0.236 Test Loss: 2.117 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.537096738815308
Epoch: 26, Steps: 17 | Train Loss: 0.346 Vali Loss: 2.360 Vali Acc: 0.236 Test Loss: 2.360 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.795125007629395
Epoch: 27, Steps: 17 | Train Loss: 0.357 Vali Loss: 2.424 Vali Acc: 0.228 Test Loss: 2.424 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.70633578300476
Epoch: 28, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.544 Vali Acc: 0.232 Test Loss: 2.544 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 15.414312839508057
Epoch: 29, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.608 Vali Acc: 0.247 Test Loss: 2.608 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 15.683579206466675
Epoch: 30, Steps: 17 | Train Loss: 0.429 Vali Loss: 2.640 Vali Acc: 0.262 Test Loss: 2.640 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 15.798816442489624
Epoch: 31, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.566 Vali Acc: 0.213 Test Loss: 2.566 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3790808
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.850444793701172
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.452 Vali Acc: 0.240 Test Loss: 1.452 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 11.327168464660645
Epoch: 2, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.485 Vali Acc: 0.186 Test Loss: 1.485 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.792251110076904
Epoch: 3, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.517 Vali Acc: 0.209 Test Loss: 1.517 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.291214227676392
Epoch: 4, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.559 Vali Acc: 0.224 Test Loss: 1.559 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.650482416152954
Epoch: 5, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.578 Vali Acc: 0.236 Test Loss: 1.578 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.563491344451904
Epoch: 6, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.622 Vali Acc: 0.232 Test Loss: 1.622 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.801760911941528
Epoch: 7, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.670 Vali Acc: 0.247 Test Loss: 1.670 Test Acc: 0.247
Validation loss decreased (-0.239529 --> -0.247132).  Saving model ...
Epoch: 8 cost time: 10.746793985366821
Epoch: 8, Steps: 17 | Train Loss: 0.750 Vali Loss: 1.633 Vali Acc: 0.251 Test Loss: 1.633 Test Acc: 0.251
Validation loss decreased (-0.247132 --> -0.250934).  Saving model ...
Epoch: 9 cost time: 11.899266719818115
Epoch: 9, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.727 Vali Acc: 0.255 Test Loss: 1.727 Test Acc: 0.255
Validation loss decreased (-0.250934 --> -0.254736).  Saving model ...
Epoch: 10 cost time: 12.52347707748413
Epoch: 10, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.693 Vali Acc: 0.224 Test Loss: 1.693 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.548395872116089
Epoch: 11, Steps: 17 | Train Loss: 0.692 Vali Loss: 1.793 Vali Acc: 0.278 Test Loss: 1.793 Test Acc: 0.278
Validation loss decreased (-0.254736 --> -0.277549).  Saving model ...
Epoch: 12 cost time: 11.181267499923706
Epoch: 12, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.716 Vali Acc: 0.274 Test Loss: 1.716 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.450889825820923
Epoch: 13, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.822 Vali Acc: 0.198 Test Loss: 1.822 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.592595100402832
Epoch: 14, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.810 Vali Acc: 0.270 Test Loss: 1.810 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.43399977684021
Epoch: 15, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.919 Vali Acc: 0.259 Test Loss: 1.919 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.251813173294067
Epoch: 16, Steps: 17 | Train Loss: 0.608 Vali Loss: 1.971 Vali Acc: 0.224 Test Loss: 1.971 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.324449300765991
Epoch: 17, Steps: 17 | Train Loss: 0.608 Vali Loss: 1.887 Vali Acc: 0.266 Test Loss: 1.887 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.090800285339355
Epoch: 18, Steps: 17 | Train Loss: 0.532 Vali Loss: 1.968 Vali Acc: 0.251 Test Loss: 1.968 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.019121170043945
Epoch: 19, Steps: 17 | Train Loss: 0.541 Vali Loss: 2.038 Vali Acc: 0.236 Test Loss: 2.038 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.623950242996216
Epoch: 20, Steps: 17 | Train Loss: 0.512 Vali Loss: 2.156 Vali Acc: 0.228 Test Loss: 2.156 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.27365231513977
Epoch: 21, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.154 Vali Acc: 0.247 Test Loss: 2.154 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3745752
model size : 14.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.720217227935791
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 7.510859489440918
Epoch: 2, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.501 Vali Acc: 0.217 Test Loss: 1.501 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.88745641708374
Epoch: 3, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.532 Vali Acc: 0.209 Test Loss: 1.532 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.9705095291137695
Epoch: 4, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.549 Vali Acc: 0.217 Test Loss: 1.549 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.41663408279419
Epoch: 5, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.570 Vali Acc: 0.259 Test Loss: 1.570 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258539).  Saving model ...
Epoch: 6 cost time: 8.378429651260376
Epoch: 6, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.642 Vali Acc: 0.270 Test Loss: 1.642 Test Acc: 0.270
Validation loss decreased (-0.258539 --> -0.269946).  Saving model ...
Epoch: 7 cost time: 8.346455097198486
Epoch: 7, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.654 Vali Acc: 0.259 Test Loss: 1.654 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.369044542312622
Epoch: 8, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.667 Vali Acc: 0.232 Test Loss: 1.667 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.90872573852539
Epoch: 9, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.681 Vali Acc: 0.278 Test Loss: 1.681 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 10 cost time: 6.345569610595703
Epoch: 10, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.775 Vali Acc: 0.240 Test Loss: 1.775 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.946558952331543
Epoch: 11, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.763 Vali Acc: 0.236 Test Loss: 1.763 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.408941030502319
Epoch: 12, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.789 Vali Acc: 0.255 Test Loss: 1.789 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.3187220096588135
Epoch: 13, Steps: 17 | Train Loss: 0.678 Vali Loss: 1.823 Vali Acc: 0.236 Test Loss: 1.823 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.408590793609619
Epoch: 14, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.881 Vali Acc: 0.228 Test Loss: 1.881 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.834149122238159
Epoch: 15, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.058 Vali Acc: 0.221 Test Loss: 2.058 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.583725929260254
Epoch: 16, Steps: 17 | Train Loss: 0.567 Vali Loss: 1.974 Vali Acc: 0.251 Test Loss: 1.974 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.315091848373413
Epoch: 17, Steps: 17 | Train Loss: 0.591 Vali Loss: 2.109 Vali Acc: 0.247 Test Loss: 2.109 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.040079832077026
Epoch: 18, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.048 Vali Acc: 0.259 Test Loss: 2.048 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.490813970565796
Epoch: 19, Steps: 17 | Train Loss: 0.541 Vali Loss: 1.988 Vali Acc: 0.274 Test Loss: 1.988 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3700696
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.6436567306518555
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 5.387084484100342
Epoch: 2, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.485 Vali Acc: 0.221 Test Loss: 1.485 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.107211589813232
Epoch: 3, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.491 Vali Acc: 0.236 Test Loss: 1.491 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.741844177246094
Epoch: 4, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.560 Vali Acc: 0.232 Test Loss: 1.560 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.653072357177734
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.608 Vali Acc: 0.232 Test Loss: 1.608 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.878715515136719
Epoch: 6, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.641 Vali Acc: 0.213 Test Loss: 1.641 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.914338827133179
Epoch: 7, Steps: 17 | Train Loss: 0.761 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.311511993408203
Epoch: 8, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.730 Vali Acc: 0.243 Test Loss: 1.730 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.470197439193726
Epoch: 9, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.651 Vali Acc: 0.251 Test Loss: 1.651 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.835954904556274
Epoch: 10, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.755 Vali Acc: 0.255 Test Loss: 1.755 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254735).  Saving model ...
Epoch: 11 cost time: 5.198854684829712
Epoch: 11, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.790 Vali Acc: 0.224 Test Loss: 1.790 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.209363222122192
Epoch: 12, Steps: 17 | Train Loss: 0.685 Vali Loss: 1.786 Vali Acc: 0.262 Test Loss: 1.786 Test Acc: 0.262
Validation loss decreased (-0.254735 --> -0.262340).  Saving model ...
Epoch: 13 cost time: 5.657957077026367
Epoch: 13, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.939 Vali Acc: 0.236 Test Loss: 1.939 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.642017364501953
Epoch: 14, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.869 Vali Acc: 0.236 Test Loss: 1.869 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.411574602127075
Epoch: 15, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.831 Vali Acc: 0.255 Test Loss: 1.831 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.732170581817627
Epoch: 16, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.945 Vali Acc: 0.224 Test Loss: 1.945 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.8172478675842285
Epoch: 17, Steps: 17 | Train Loss: 0.549 Vali Loss: 1.997 Vali Acc: 0.247 Test Loss: 1.997 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.853896141052246
Epoch: 18, Steps: 17 | Train Loss: 0.557 Vali Loss: 2.041 Vali Acc: 0.255 Test Loss: 2.041 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.528973340988159
Epoch: 19, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.014 Vali Acc: 0.259 Test Loss: 2.014 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.193950176239014
Epoch: 20, Steps: 17 | Train Loss: 0.633 Vali Loss: 2.217 Vali Acc: 0.224 Test Loss: 2.217 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.253056526184082
Epoch: 21, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.186 Vali Acc: 0.240 Test Loss: 2.186 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.2008819580078125
Epoch: 22, Steps: 17 | Train Loss: 0.547 Vali Loss: 2.253 Vali Acc: 0.232 Test Loss: 2.253 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 3664856
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.051481485366821
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.149343252182007
Epoch: 2, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.485 Vali Acc: 0.202 Test Loss: 1.485 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7981371879577637
Epoch: 3, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.501 Vali Acc: 0.285 Test Loss: 1.501 Test Acc: 0.285
Validation loss decreased (-0.250936 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 3.8551297187805176
Epoch: 4, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.518 Vali Acc: 0.259 Test Loss: 1.518 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.04592752456665
Epoch: 5, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.619 Vali Acc: 0.243 Test Loss: 1.619 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.524742364883423
Epoch: 6, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.524 Vali Acc: 0.281 Test Loss: 1.524 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.25837254524231
Epoch: 7, Steps: 17 | Train Loss: 0.813 Vali Loss: 1.611 Vali Acc: 0.278 Test Loss: 1.611 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.675259590148926
Epoch: 8, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.636 Vali Acc: 0.228 Test Loss: 1.636 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9610044956207275
Epoch: 9, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.644 Vali Acc: 0.236 Test Loss: 1.644 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1631433963775635
Epoch: 10, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.819 Vali Acc: 0.240 Test Loss: 1.819 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.664567708969116
Epoch: 11, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.702 Vali Acc: 0.266 Test Loss: 1.702 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.645318031311035
Epoch: 12, Steps: 17 | Train Loss: 0.669 Vali Loss: 1.835 Vali Acc: 0.194 Test Loss: 1.835 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9428927898406982
Epoch: 13, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.939 Vali Acc: 0.243 Test Loss: 1.939 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3647448
model size : 14.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.255668878555298
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.471 Vali Acc: 0.194 Test Loss: 1.471 Test Acc: 0.194
Validation loss decreased (inf --> -0.193902).  Saving model ...
Epoch: 2 cost time: 2.2007241249084473
Epoch: 2, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.484 Vali Acc: 0.232 Test Loss: 1.484 Test Acc: 0.232
Validation loss decreased (-0.193902 --> -0.231924).  Saving model ...
Epoch: 3 cost time: 2.4624555110931396
Epoch: 3, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.503 Vali Acc: 0.236 Test Loss: 1.503 Test Acc: 0.236
Validation loss decreased (-0.231924 --> -0.235726).  Saving model ...
Epoch: 4 cost time: 2.422227144241333
Epoch: 4, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.573 Vali Acc: 0.259 Test Loss: 1.573 Test Acc: 0.259
Validation loss decreased (-0.235726 --> -0.258539).  Saving model ...
Epoch: 5 cost time: 2.697175979614258
Epoch: 5, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.557 Vali Acc: 0.232 Test Loss: 1.557 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.739644765853882
Epoch: 6, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.984229326248169
Epoch: 7, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3650615215301514
Epoch: 8, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.714 Vali Acc: 0.255 Test Loss: 1.714 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.842329740524292
Epoch: 9, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.634 Vali Acc: 0.251 Test Loss: 1.634 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4598138332366943
Epoch: 10, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.791 Vali Acc: 0.274 Test Loss: 1.791 Test Acc: 0.274
Validation loss decreased (-0.258539 --> -0.273746).  Saving model ...
Epoch: 11 cost time: 2.025698184967041
Epoch: 11, Steps: 17 | Train Loss: 0.856 Vali Loss: 1.806 Vali Acc: 0.213 Test Loss: 1.806 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.107013463973999
Epoch: 12, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.700 Vali Acc: 0.266 Test Loss: 1.700 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.349233627319336
Epoch: 13, Steps: 17 | Train Loss: 0.724 Vali Loss: 1.887 Vali Acc: 0.255 Test Loss: 1.887 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0783941745758057
Epoch: 14, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.845 Vali Acc: 0.255 Test Loss: 1.845 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5360076427459717
Epoch: 15, Steps: 17 | Train Loss: 0.712 Vali Loss: 2.027 Vali Acc: 0.232 Test Loss: 2.027 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.110783100128174
Epoch: 16, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.889 Vali Acc: 0.259 Test Loss: 1.889 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.373234272003174
Epoch: 17, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.982 Vali Acc: 0.278 Test Loss: 1.982 Test Acc: 0.278
Validation loss decreased (-0.273746 --> -0.277547).  Saving model ...
Epoch: 18 cost time: 2.3365049362182617
Epoch: 18, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.896 Vali Acc: 0.255 Test Loss: 1.896 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.80971622467041
Epoch: 19, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.226 Vali Acc: 0.262 Test Loss: 2.226 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3077006340026855
Epoch: 20, Steps: 17 | Train Loss: 0.688 Vali Loss: 2.232 Vali Acc: 0.213 Test Loss: 2.232 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.965381145477295
Epoch: 21, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.169 Vali Acc: 0.251 Test Loss: 2.169 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.203188180923462
Epoch: 22, Steps: 17 | Train Loss: 0.638 Vali Loss: 2.356 Vali Acc: 0.262 Test Loss: 2.356 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.711238384246826
Epoch: 23, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.204 Vali Acc: 0.232 Test Loss: 2.204 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.838977336883545
Epoch: 24, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.418 Vali Acc: 0.243 Test Loss: 2.418 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.229416847229004
Epoch: 25, Steps: 17 | Train Loss: 0.592 Vali Loss: 2.454 Vali Acc: 0.262 Test Loss: 2.454 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.656320571899414
Epoch: 26, Steps: 17 | Train Loss: 0.585 Vali Loss: 2.245 Vali Acc: 0.205 Test Loss: 2.245 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.558073043823242
Epoch: 27, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.435 Vali Acc: 0.232 Test Loss: 2.435 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3629016
model size : 13.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.200342893600464
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.1493682861328125
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.486 Vali Acc: 0.232 Test Loss: 1.486 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0687780380249023
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.473 Vali Acc: 0.228 Test Loss: 1.473 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0943028926849365
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.568 Vali Acc: 0.209 Test Loss: 1.568 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0749986171722412
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.547 Vali Acc: 0.236 Test Loss: 1.547 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1010501384735107
Epoch: 6, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.487 Vali Acc: 0.228 Test Loss: 1.487 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0199947357177734
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.654 Vali Acc: 0.194 Test Loss: 1.654 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8715348243713379
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.590 Vali Acc: 0.232 Test Loss: 1.590 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0823769569396973
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.555 Vali Acc: 0.247 Test Loss: 1.555 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2555468082427979
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.675 Vali Acc: 0.224 Test Loss: 1.675 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.059990406036377
Epoch: 11, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.734 Vali Acc: 0.236 Test Loss: 1.734 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 3611608
model size : 13.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.854973554611206
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 19.149633407592773
Epoch: 2, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.450 Vali Acc: 0.217 Test Loss: 1.450 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.116851091384888
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.447 Vali Acc: 0.221 Test Loss: 1.447 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.99740982055664
Epoch: 4, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.474 Vali Acc: 0.221 Test Loss: 1.474 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.750726222991943
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.59850311279297
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.511 Vali Acc: 0.221 Test Loss: 1.511 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.69716501235962
Epoch: 7, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.518 Vali Acc: 0.228 Test Loss: 1.518 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.033098220825195
Epoch: 8, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.566 Vali Acc: 0.224 Test Loss: 1.566 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 21.32267141342163
Epoch: 9, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.589 Vali Acc: 0.217 Test Loss: 1.589 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.974819660186768
Epoch: 10, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.611 Vali Acc: 0.209 Test Loss: 1.611 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 19.205793619155884
Epoch: 11, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.643 Vali Acc: 0.224 Test Loss: 1.643 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.24714828897338403
model parameter : 1929722
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.205718994140625
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 14.233709335327148
Epoch: 2, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.456 Vali Acc: 0.232 Test Loss: 1.456 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.053581476211548
Epoch: 3, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.468 Vali Acc: 0.217 Test Loss: 1.468 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.054112195968628
Epoch: 4, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.458 Vali Acc: 0.194 Test Loss: 1.458 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.050045013427734
Epoch: 5, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.492 Vali Acc: 0.232 Test Loss: 1.492 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.933446645736694
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.511 Vali Acc: 0.217 Test Loss: 1.511 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.937745809555054
Epoch: 7, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.557 Vali Acc: 0.232 Test Loss: 1.557 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.0823814868927
Epoch: 8, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.506 Vali Acc: 0.236 Test Loss: 1.506 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.458841323852539
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.565 Vali Acc: 0.221 Test Loss: 1.565 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.700053453445435
Epoch: 10, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.583 Vali Acc: 0.232 Test Loss: 1.583 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.658432722091675
Epoch: 11, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.617 Vali Acc: 0.236 Test Loss: 1.617 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 1907706
model size : 7.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.475049257278442
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 9.947836637496948
Epoch: 2, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.444 Vali Acc: 0.281 Test Loss: 1.444 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 10.117966890335083
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.448 Vali Acc: 0.205 Test Loss: 1.448 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.2783203125
Epoch: 4, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.477 Vali Acc: 0.236 Test Loss: 1.477 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.908597469329834
Epoch: 5, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.477 Vali Acc: 0.179 Test Loss: 1.477 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.730979919433594
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.543 Vali Acc: 0.217 Test Loss: 1.543 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.895520448684692
Epoch: 7, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.538 Vali Acc: 0.224 Test Loss: 1.538 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.351560592651367
Epoch: 8, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.560 Vali Acc: 0.224 Test Loss: 1.560 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.271656036376953
Epoch: 9, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.640 Vali Acc: 0.224 Test Loss: 1.640 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.331008195877075
Epoch: 10, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.866015195846558
Epoch: 11, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.684 Vali Acc: 0.217 Test Loss: 1.684 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.203513860702515
Epoch: 12, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.692 Vali Acc: 0.232 Test Loss: 1.692 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1885178
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.608375549316406
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.446 Vali Acc: 0.236 Test Loss: 1.446 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 8.024898767471313
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.462 Vali Acc: 0.266 Test Loss: 1.462 Test Acc: 0.266
Validation loss decreased (-0.235727 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 7.556946754455566
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.442 Vali Acc: 0.236 Test Loss: 1.442 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.7630839347839355
Epoch: 4, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.493 Vali Acc: 0.221 Test Loss: 1.493 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.116865634918213
Epoch: 5, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.464 Vali Acc: 0.232 Test Loss: 1.464 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.70034384727478
Epoch: 6, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.539 Vali Acc: 0.205 Test Loss: 1.539 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.439302206039429
Epoch: 7, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.567 Vali Acc: 0.205 Test Loss: 1.567 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.352488279342651
Epoch: 8, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.612 Vali Acc: 0.202 Test Loss: 1.612 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.642294645309448
Epoch: 9, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.585 Vali Acc: 0.213 Test Loss: 1.585 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.5368428230285645
Epoch: 10, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.609 Vali Acc: 0.232 Test Loss: 1.609 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.69363260269165
Epoch: 11, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.739 Vali Acc: 0.198 Test Loss: 1.739 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.974032402038574
Epoch: 12, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.680 Vali Acc: 0.224 Test Loss: 1.680 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1862650
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.289492130279541
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.429 Vali Acc: 0.236 Test Loss: 1.429 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 6.405101537704468
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.444 Vali Acc: 0.259 Test Loss: 1.444 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 6.476278066635132
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.439 Vali Acc: 0.213 Test Loss: 1.439 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.7022998332977295
Epoch: 4, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.484 Vali Acc: 0.232 Test Loss: 1.484 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.568928480148315
Epoch: 5, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.533 Vali Acc: 0.221 Test Loss: 1.533 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.940790891647339
Epoch: 6, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.515 Vali Acc: 0.228 Test Loss: 1.515 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.616533994674683
Epoch: 7, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.622 Vali Acc: 0.228 Test Loss: 1.622 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.505248308181763
Epoch: 8, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.627 Vali Acc: 0.217 Test Loss: 1.627 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.171618700027466
Epoch: 9, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.693 Vali Acc: 0.224 Test Loss: 1.693 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.116492986679077
Epoch: 10, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.596 Vali Acc: 0.255 Test Loss: 1.596 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.161975860595703
Epoch: 11, Steps: 17 | Train Loss: 0.827 Vali Loss: 1.671 Vali Acc: 0.259 Test Loss: 1.671 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.367952585220337
Epoch: 12, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.762 Vali Acc: 0.247 Test Loss: 1.762 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 1844730
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.5610597133636475
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.709054470062256
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.462 Vali Acc: 0.221 Test Loss: 1.462 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5117452144622803
Epoch: 3, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.471 Vali Acc: 0.243 Test Loss: 1.471 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.298654079437256
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.484 Vali Acc: 0.232 Test Loss: 1.484 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4448297023773193
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.484 Vali Acc: 0.175 Test Loss: 1.484 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.070069074630737
Epoch: 6, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.509 Vali Acc: 0.205 Test Loss: 1.509 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.166688442230225
Epoch: 7, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.568 Vali Acc: 0.209 Test Loss: 1.568 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6409764289855957
Epoch: 8, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.599 Vali Acc: 0.194 Test Loss: 1.599 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.3786401748657227
Epoch: 9, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.579 Vali Acc: 0.217 Test Loss: 1.579 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4755430221557617
Epoch: 10, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.598 Vali Acc: 0.247 Test Loss: 1.598 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.028687000274658
Epoch: 11, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.735 Vali Acc: 0.240 Test Loss: 1.735 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 1836026
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.413978099822998
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.434 Vali Acc: 0.236 Test Loss: 1.434 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 2.34455943107605
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.457 Vali Acc: 0.202 Test Loss: 1.457 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.209157943725586
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.470 Vali Acc: 0.236 Test Loss: 1.470 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.612811803817749
Epoch: 4, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.474 Vali Acc: 0.224 Test Loss: 1.474 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3750805854797363
Epoch: 5, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.483 Vali Acc: 0.232 Test Loss: 1.483 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0709645748138428
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.512 Vali Acc: 0.205 Test Loss: 1.512 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4112389087677
Epoch: 7, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.552 Vali Acc: 0.213 Test Loss: 1.552 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0454165935516357
Epoch: 8, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.547 Vali Acc: 0.202 Test Loss: 1.547 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2872421741485596
Epoch: 9, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.564 Vali Acc: 0.202 Test Loss: 1.564 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3364789485931396
Epoch: 10, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.600 Vali Acc: 0.213 Test Loss: 1.600 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.700195074081421
Epoch: 11, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.612 Vali Acc: 0.213 Test Loss: 1.612 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.23574144486692014
model parameter : 1826810
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4035048484802246
Epoch: 1, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.434 Vali Acc: 0.236 Test Loss: 1.434 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.1337921619415283
Epoch: 2, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.453 Vali Acc: 0.224 Test Loss: 1.453 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.37664794921875
Epoch: 3, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.461 Vali Acc: 0.213 Test Loss: 1.461 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3408422470092773
Epoch: 4, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.485 Vali Acc: 0.198 Test Loss: 1.485 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1871812343597412
Epoch: 5, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.558 Vali Acc: 0.221 Test Loss: 1.558 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.270770788192749
Epoch: 6, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.530 Vali Acc: 0.202 Test Loss: 1.530 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2926301956176758
Epoch: 7, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.541 Vali Acc: 0.202 Test Loss: 1.541 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.355384111404419
Epoch: 8, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.592 Vali Acc: 0.198 Test Loss: 1.592 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5682258605957031
Epoch: 9, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.666 Vali Acc: 0.213 Test Loss: 1.666 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4057893753051758
Epoch: 10, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.685 Vali Acc: 0.202 Test Loss: 1.685 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1814024448394775
Epoch: 11, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.741 Vali Acc: 0.221 Test Loss: 1.741 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.23574144486692014
model parameter : 1818106
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.346339464187622
Epoch: 1, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.443 Vali Acc: 0.255 Test Loss: 1.443 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 19.56761384010315
Epoch: 2, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.468 Vali Acc: 0.221 Test Loss: 1.468 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.946330547332764
Epoch: 3, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.504 Vali Acc: 0.224 Test Loss: 1.504 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.56667995452881
Epoch: 4, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.532 Vali Acc: 0.209 Test Loss: 1.532 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.363351583480835
Epoch: 5, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.594 Vali Acc: 0.217 Test Loss: 1.594 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.609397649765015
Epoch: 6, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.626 Vali Acc: 0.224 Test Loss: 1.626 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.49128246307373
Epoch: 7, Steps: 17 | Train Loss: 0.727 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262341).  Saving model ...
Epoch: 8 cost time: 16.52792453765869
Epoch: 8, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.706 Vali Acc: 0.205 Test Loss: 1.706 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.4022536277771
Epoch: 9, Steps: 17 | Train Loss: 0.577 Vali Loss: 1.717 Vali Acc: 0.247 Test Loss: 1.717 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.025770902633667
Epoch: 10, Steps: 17 | Train Loss: 0.549 Vali Loss: 1.740 Vali Acc: 0.213 Test Loss: 1.740 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.238036155700684
Epoch: 11, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.925 Vali Acc: 0.228 Test Loss: 1.925 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.251938581466675
Epoch: 12, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (-0.262341 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 17.307082653045654
Epoch: 13, Steps: 17 | Train Loss: 0.490 Vali Loss: 1.873 Vali Acc: 0.270 Test Loss: 1.873 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.27909803390503
Epoch: 14, Steps: 17 | Train Loss: 0.488 Vali Loss: 2.043 Vali Acc: 0.247 Test Loss: 2.043 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 15.536444664001465
Epoch: 15, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.855 Vali Acc: 0.266 Test Loss: 1.855 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.747973203659058
Epoch: 16, Steps: 17 | Train Loss: 0.420 Vali Loss: 2.059 Vali Acc: 0.232 Test Loss: 2.059 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.487349271774292
Epoch: 17, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.086 Vali Acc: 0.209 Test Loss: 2.086 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 16.82870054244995
Epoch: 18, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.054 Vali Acc: 0.251 Test Loss: 2.054 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.890758514404297
Epoch: 19, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.235 Vali Acc: 0.232 Test Loss: 2.235 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.396666049957275
Epoch: 20, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.279 Vali Acc: 0.221 Test Loss: 2.279 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.421512842178345
Epoch: 21, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.239 Vali Acc: 0.243 Test Loss: 2.239 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.414765119552612
Epoch: 22, Steps: 17 | Train Loss: 0.340 Vali Loss: 2.239 Vali Acc: 0.262 Test Loss: 2.239 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1929688
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.603249549865723
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.440 Vali Acc: 0.221 Test Loss: 1.440 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 13.471808195114136
Epoch: 2, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.502 Vali Acc: 0.224 Test Loss: 1.502 Test Acc: 0.224
Validation loss decreased (-0.220518 --> -0.224320).  Saving model ...
Epoch: 3 cost time: 14.7305748462677
Epoch: 3, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.499 Vali Acc: 0.221 Test Loss: 1.499 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.045904159545898
Epoch: 4, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.520 Vali Acc: 0.228 Test Loss: 1.520 Test Acc: 0.228
Validation loss decreased (-0.224320 --> -0.228122).  Saving model ...
Epoch: 5 cost time: 14.547341346740723
Epoch: 5, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.577 Vali Acc: 0.213 Test Loss: 1.577 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.030705213546753
Epoch: 6, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.648 Vali Acc: 0.194 Test Loss: 1.648 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.535215616226196
Epoch: 7, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.641 Vali Acc: 0.205 Test Loss: 1.641 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.566150903701782
Epoch: 8, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.685 Vali Acc: 0.247 Test Loss: 1.685 Test Acc: 0.247
Validation loss decreased (-0.228122 --> -0.247131).  Saving model ...
Epoch: 9 cost time: 13.755889892578125
Epoch: 9, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.656 Vali Acc: 0.247 Test Loss: 1.656 Test Acc: 0.247
Validation loss decreased (-0.247131 --> -0.247132).  Saving model ...
Epoch: 10 cost time: 14.434038639068604
Epoch: 10, Steps: 17 | Train Loss: 0.546 Vali Loss: 1.793 Vali Acc: 0.240 Test Loss: 1.793 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.915886402130127
Epoch: 11, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.842 Vali Acc: 0.243 Test Loss: 1.842 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.95430612564087
Epoch: 12, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.827 Vali Acc: 0.243 Test Loss: 1.827 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.857948541641235
Epoch: 13, Steps: 17 | Train Loss: 0.464 Vali Loss: 1.881 Vali Acc: 0.262 Test Loss: 1.881 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262339).  Saving model ...
Epoch: 14 cost time: 14.791017532348633
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 2.001 Vali Acc: 0.247 Test Loss: 2.001 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.707635641098022
Epoch: 15, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.998 Vali Acc: 0.259 Test Loss: 1.998 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.9960036277771
Epoch: 16, Steps: 17 | Train Loss: 0.372 Vali Loss: 2.034 Vali Acc: 0.259 Test Loss: 2.034 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.274679899215698
Epoch: 17, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.003 Vali Acc: 0.232 Test Loss: 2.003 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.372843027114868
Epoch: 18, Steps: 17 | Train Loss: 0.335 Vali Loss: 2.018 Vali Acc: 0.274 Test Loss: 2.018 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273744).  Saving model ...
Epoch: 19 cost time: 13.881740093231201
Epoch: 19, Steps: 17 | Train Loss: 0.353 Vali Loss: 2.194 Vali Acc: 0.251 Test Loss: 2.194 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.658374309539795
Epoch: 20, Steps: 17 | Train Loss: 0.290 Vali Loss: 2.121 Vali Acc: 0.255 Test Loss: 2.121 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.300286293029785
Epoch: 21, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.175 Vali Acc: 0.228 Test Loss: 2.175 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.514737129211426
Epoch: 22, Steps: 17 | Train Loss: 0.275 Vali Loss: 2.361 Vali Acc: 0.255 Test Loss: 2.361 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 12.856806516647339
Epoch: 23, Steps: 17 | Train Loss: 0.260 Vali Loss: 2.359 Vali Acc: 0.217 Test Loss: 2.359 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 15.526460647583008
Epoch: 24, Steps: 17 | Train Loss: 0.277 Vali Loss: 2.379 Vali Acc: 0.205 Test Loss: 2.379 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 15.907190322875977
Epoch: 25, Steps: 17 | Train Loss: 0.268 Vali Loss: 2.347 Vali Acc: 0.232 Test Loss: 2.347 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 16.749431610107422
Epoch: 26, Steps: 17 | Train Loss: 0.271 Vali Loss: 2.557 Vali Acc: 0.255 Test Loss: 2.557 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 16.19218921661377
Epoch: 27, Steps: 17 | Train Loss: 0.253 Vali Loss: 2.634 Vali Acc: 0.255 Test Loss: 2.634 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 12.071671485900879
Epoch: 28, Steps: 17 | Train Loss: 0.284 Vali Loss: 2.609 Vali Acc: 0.270 Test Loss: 2.609 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1907672
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.810853719711304
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 11.018723249435425
Epoch: 2, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.471 Vali Acc: 0.198 Test Loss: 1.471 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.679369926452637
Epoch: 3, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.522 Vali Acc: 0.205 Test Loss: 1.522 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.973222732543945
Epoch: 4, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.540 Vali Acc: 0.251 Test Loss: 1.540 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.832234621047974
Epoch: 5, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.576 Vali Acc: 0.221 Test Loss: 1.576 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.39721393585205
Epoch: 6, Steps: 17 | Train Loss: 0.711 Vali Loss: 1.627 Vali Acc: 0.243 Test Loss: 1.627 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.450748682022095
Epoch: 7, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.652 Vali Acc: 0.228 Test Loss: 1.652 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.011737823486328
Epoch: 8, Steps: 17 | Train Loss: 0.560 Vali Loss: 1.693 Vali Acc: 0.262 Test Loss: 1.693 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262340).  Saving model ...
Epoch: 9 cost time: 9.803944826126099
Epoch: 9, Steps: 17 | Train Loss: 0.510 Vali Loss: 1.721 Vali Acc: 0.217 Test Loss: 1.721 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.323748111724854
Epoch: 10, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.729 Vali Acc: 0.232 Test Loss: 1.729 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.649955034255981
Epoch: 11, Steps: 17 | Train Loss: 0.439 Vali Loss: 1.783 Vali Acc: 0.224 Test Loss: 1.783 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.401841878890991
Epoch: 12, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.989 Vali Acc: 0.236 Test Loss: 1.989 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.441583633422852
Epoch: 13, Steps: 17 | Train Loss: 0.387 Vali Loss: 1.984 Vali Acc: 0.243 Test Loss: 1.984 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.893274068832397
Epoch: 14, Steps: 17 | Train Loss: 0.359 Vali Loss: 2.117 Vali Acc: 0.251 Test Loss: 2.117 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.713446140289307
Epoch: 15, Steps: 17 | Train Loss: 0.399 Vali Loss: 2.028 Vali Acc: 0.240 Test Loss: 2.028 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.19797945022583
Epoch: 16, Steps: 17 | Train Loss: 0.377 Vali Loss: 2.001 Vali Acc: 0.274 Test Loss: 2.001 Test Acc: 0.274
Validation loss decreased (-0.262340 --> -0.273744).  Saving model ...
Epoch: 17 cost time: 10.221479177474976
Epoch: 17, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.266 Vali Acc: 0.278 Test Loss: 2.266 Test Acc: 0.278
Validation loss decreased (-0.273744 --> -0.277544).  Saving model ...
Epoch: 18 cost time: 10.60285234451294
Epoch: 18, Steps: 17 | Train Loss: 0.321 Vali Loss: 2.186 Vali Acc: 0.236 Test Loss: 2.186 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.797081232070923
Epoch: 19, Steps: 17 | Train Loss: 0.281 Vali Loss: 2.139 Vali Acc: 0.255 Test Loss: 2.139 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.658613443374634
Epoch: 20, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.367 Vali Acc: 0.209 Test Loss: 2.367 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.047386169433594
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 2.256 Vali Acc: 0.232 Test Loss: 2.256 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.719549894332886
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 2.420 Vali Acc: 0.236 Test Loss: 2.420 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.60531997680664
Epoch: 23, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.347 Vali Acc: 0.255 Test Loss: 2.347 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.446776390075684
Epoch: 24, Steps: 17 | Train Loss: 0.324 Vali Loss: 2.329 Vali Acc: 0.247 Test Loss: 2.329 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.841949939727783
Epoch: 25, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.420 Vali Acc: 0.243 Test Loss: 2.420 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.878482341766357
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.594 Vali Acc: 0.232 Test Loss: 2.594 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.375584840774536
Epoch: 27, Steps: 17 | Train Loss: 0.247 Vali Loss: 2.593 Vali Acc: 0.217 Test Loss: 2.593 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1885144
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.437291860580444
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 6.92670202255249
Epoch: 2, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.459 Vali Acc: 0.236 Test Loss: 1.459 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.0631935596466064
Epoch: 3, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.490 Vali Acc: 0.232 Test Loss: 1.490 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.578924894332886
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.516 Vali Acc: 0.240 Test Loss: 1.516 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.370525598526001
Epoch: 5, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.561 Vali Acc: 0.243 Test Loss: 1.561 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.886525392532349
Epoch: 6, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.542 Vali Acc: 0.251 Test Loss: 1.542 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.440094470977783
Epoch: 7, Steps: 17 | Train Loss: 0.601 Vali Loss: 1.635 Vali Acc: 0.228 Test Loss: 1.635 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.9036545753479
Epoch: 8, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.647 Vali Acc: 0.274 Test Loss: 1.647 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273748).  Saving model ...
Epoch: 9 cost time: 7.780381202697754
Epoch: 9, Steps: 17 | Train Loss: 0.476 Vali Loss: 1.691 Vali Acc: 0.255 Test Loss: 1.691 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.226701498031616
Epoch: 10, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.705 Vali Acc: 0.278 Test Loss: 1.705 Test Acc: 0.278
Validation loss decreased (-0.273748 --> -0.277549).  Saving model ...
Epoch: 11 cost time: 7.405151128768921
Epoch: 11, Steps: 17 | Train Loss: 0.423 Vali Loss: 1.741 Vali Acc: 0.266 Test Loss: 1.741 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.783223867416382
Epoch: 12, Steps: 17 | Train Loss: 0.376 Vali Loss: 1.784 Vali Acc: 0.281 Test Loss: 1.784 Test Acc: 0.281
Validation loss decreased (-0.277549 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 6.215644121170044
Epoch: 13, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.937 Vali Acc: 0.259 Test Loss: 1.937 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.706941843032837
Epoch: 14, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.993 Vali Acc: 0.251 Test Loss: 1.993 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.990408420562744
Epoch: 15, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.928 Vali Acc: 0.236 Test Loss: 1.928 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.725846767425537
Epoch: 16, Steps: 17 | Train Loss: 0.394 Vali Loss: 1.988 Vali Acc: 0.255 Test Loss: 1.988 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.531559228897095
Epoch: 17, Steps: 17 | Train Loss: 0.336 Vali Loss: 2.083 Vali Acc: 0.251 Test Loss: 2.083 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.050837516784668
Epoch: 18, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.074 Vali Acc: 0.259 Test Loss: 2.074 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.406826496124268
Epoch: 19, Steps: 17 | Train Loss: 0.308 Vali Loss: 2.126 Vali Acc: 0.255 Test Loss: 2.126 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.045082330703735
Epoch: 20, Steps: 17 | Train Loss: 0.275 Vali Loss: 2.199 Vali Acc: 0.221 Test Loss: 2.199 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.340152025222778
Epoch: 21, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.296 Vali Acc: 0.270 Test Loss: 2.296 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.539143323898315
Epoch: 22, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.105 Vali Acc: 0.293 Test Loss: 2.105 Test Acc: 0.293
Validation loss decreased (-0.281351 --> -0.292755).  Saving model ...
Epoch: 23 cost time: 7.084777355194092
Epoch: 23, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.284 Vali Acc: 0.262 Test Loss: 2.284 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.53399395942688
Epoch: 24, Steps: 17 | Train Loss: 0.277 Vali Loss: 2.407 Vali Acc: 0.228 Test Loss: 2.407 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.895225286483765
Epoch: 25, Steps: 17 | Train Loss: 0.284 Vali Loss: 2.344 Vali Acc: 0.266 Test Loss: 2.344 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.498530864715576
Epoch: 26, Steps: 17 | Train Loss: 0.245 Vali Loss: 2.732 Vali Acc: 0.243 Test Loss: 2.732 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.839749813079834
Epoch: 27, Steps: 17 | Train Loss: 0.309 Vali Loss: 2.643 Vali Acc: 0.255 Test Loss: 2.643 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.388496160507202
Epoch: 28, Steps: 17 | Train Loss: 0.304 Vali Loss: 2.567 Vali Acc: 0.243 Test Loss: 2.567 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.181957721710205
Epoch: 29, Steps: 17 | Train Loss: 0.344 Vali Loss: 2.530 Vali Acc: 0.236 Test Loss: 2.530 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.622982978820801
Epoch: 30, Steps: 17 | Train Loss: 0.285 Vali Loss: 2.404 Vali Acc: 0.255 Test Loss: 2.404 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.398343563079834
Epoch: 31, Steps: 17 | Train Loss: 0.226 Vali Loss: 2.576 Vali Acc: 0.247 Test Loss: 2.576 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.830975532531738
Epoch: 32, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.640 Vali Acc: 0.266 Test Loss: 2.640 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1862616
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.205986022949219
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.449 Vali Acc: 0.224 Test Loss: 1.449 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 4.841909646987915
Epoch: 2, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.480 Vali Acc: 0.221 Test Loss: 1.480 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.532303810119629
Epoch: 3, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.493 Vali Acc: 0.217 Test Loss: 1.493 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7874650955200195
Epoch: 4, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.556 Vali Acc: 0.205 Test Loss: 1.556 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6539998054504395
Epoch: 5, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.567 Vali Acc: 0.247 Test Loss: 1.567 Test Acc: 0.247
Validation loss decreased (-0.224320 --> -0.247133).  Saving model ...
Epoch: 6 cost time: 5.372709035873413
Epoch: 6, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.622 Vali Acc: 0.270 Test Loss: 1.622 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269946).  Saving model ...
Epoch: 7 cost time: 5.219373941421509
Epoch: 7, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.717 Vali Acc: 0.228 Test Loss: 1.717 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.680185556411743
Epoch: 8, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.370001792907715
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 1.773 Vali Acc: 0.232 Test Loss: 1.773 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.02269172668457
Epoch: 10, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.725 Vali Acc: 0.240 Test Loss: 1.725 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.9719414710998535
Epoch: 11, Steps: 17 | Train Loss: 0.432 Vali Loss: 1.901 Vali Acc: 0.228 Test Loss: 1.901 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.181646347045898
Epoch: 12, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.867 Vali Acc: 0.240 Test Loss: 1.867 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.694206476211548
Epoch: 13, Steps: 17 | Train Loss: 0.442 Vali Loss: 2.033 Vali Acc: 0.247 Test Loss: 2.033 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.949398040771484
Epoch: 14, Steps: 17 | Train Loss: 0.463 Vali Loss: 2.005 Vali Acc: 0.262 Test Loss: 2.005 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.459643125534058
Epoch: 15, Steps: 17 | Train Loss: 0.428 Vali Loss: 1.841 Vali Acc: 0.274 Test Loss: 1.841 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273746).  Saving model ...
Epoch: 16 cost time: 4.804242372512817
Epoch: 16, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.060 Vali Acc: 0.236 Test Loss: 2.060 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.979589223861694
Epoch: 17, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.085 Vali Acc: 0.266 Test Loss: 2.085 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.573915243148804
Epoch: 18, Steps: 17 | Train Loss: 0.401 Vali Loss: 2.034 Vali Acc: 0.266 Test Loss: 2.034 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.430438995361328
Epoch: 19, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.212 Vali Acc: 0.232 Test Loss: 2.212 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.913812875747681
Epoch: 20, Steps: 17 | Train Loss: 0.384 Vali Loss: 2.219 Vali Acc: 0.224 Test Loss: 2.219 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.517319679260254
Epoch: 21, Steps: 17 | Train Loss: 0.358 Vali Loss: 2.285 Vali Acc: 0.240 Test Loss: 2.285 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.664074659347534
Epoch: 22, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.318 Vali Acc: 0.247 Test Loss: 2.318 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.844986438751221
Epoch: 23, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.513072490692139
Epoch: 24, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.349 Vali Acc: 0.243 Test Loss: 2.349 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.336694002151489
Epoch: 25, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.365 Vali Acc: 0.217 Test Loss: 2.365 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1844696
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.9845805168151855
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.458 Vali Acc: 0.251 Test Loss: 1.458 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.141777753829956
Epoch: 2, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.477 Vali Acc: 0.224 Test Loss: 1.477 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2731001377105713
Epoch: 3, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.495 Vali Acc: 0.224 Test Loss: 1.495 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4904494285583496
Epoch: 4, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.539 Vali Acc: 0.228 Test Loss: 1.539 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6464431285858154
Epoch: 5, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.540 Vali Acc: 0.232 Test Loss: 1.540 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.289541721343994
Epoch: 6, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.600 Vali Acc: 0.262 Test Loss: 1.600 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262341).  Saving model ...
Epoch: 7 cost time: 3.091566801071167
Epoch: 7, Steps: 17 | Train Loss: 0.598 Vali Loss: 1.609 Vali Acc: 0.247 Test Loss: 1.609 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.08468770980835
Epoch: 8, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.772 Vali Acc: 0.213 Test Loss: 1.772 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6465580463409424
Epoch: 9, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5499303340911865
Epoch: 10, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.803 Vali Acc: 0.228 Test Loss: 1.803 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3697550296783447
Epoch: 11, Steps: 17 | Train Loss: 0.453 Vali Loss: 1.867 Vali Acc: 0.217 Test Loss: 1.867 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.561499834060669
Epoch: 12, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.915 Vali Acc: 0.205 Test Loss: 1.915 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.902627944946289
Epoch: 13, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.947 Vali Acc: 0.236 Test Loss: 1.947 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.6546175479888916
Epoch: 14, Steps: 17 | Train Loss: 0.420 Vali Loss: 1.940 Vali Acc: 0.240 Test Loss: 1.940 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.461883306503296
Epoch: 15, Steps: 17 | Train Loss: 0.377 Vali Loss: 2.010 Vali Acc: 0.262 Test Loss: 2.010 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2324066162109375
Epoch: 16, Steps: 17 | Train Loss: 0.401 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 1835992
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.129126787185669
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.452 Vali Acc: 0.198 Test Loss: 1.452 Test Acc: 0.198
Validation loss decreased (inf --> -0.197704).  Saving model ...
Epoch: 2 cost time: 2.2642288208007812
Epoch: 2, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.482 Vali Acc: 0.202 Test Loss: 1.482 Test Acc: 0.202
Validation loss decreased (-0.197704 --> -0.201506).  Saving model ...
Epoch: 3 cost time: 2.0608978271484375
Epoch: 3, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.484 Vali Acc: 0.243 Test Loss: 1.484 Test Acc: 0.243
Validation loss decreased (-0.201506 --> -0.243331).  Saving model ...
Epoch: 4 cost time: 2.5677261352539062
Epoch: 4, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.519 Vali Acc: 0.243 Test Loss: 1.519 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2908341884613037
Epoch: 5, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.580 Vali Acc: 0.255 Test Loss: 1.580 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254737).  Saving model ...
Epoch: 6 cost time: 2.497108221054077
Epoch: 6, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258540).  Saving model ...
Epoch: 7 cost time: 2.157674789428711
Epoch: 7, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4423646926879883
Epoch: 8, Steps: 17 | Train Loss: 0.633 Vali Loss: 1.674 Vali Acc: 0.240 Test Loss: 1.674 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4440042972564697
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 1.666 Vali Acc: 0.213 Test Loss: 1.666 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.751147508621216
Epoch: 10, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.764 Vali Acc: 0.251 Test Loss: 1.764 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.342698574066162
Epoch: 11, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.787 Vali Acc: 0.224 Test Loss: 1.787 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7987825870513916
Epoch: 12, Steps: 17 | Train Loss: 0.514 Vali Loss: 1.765 Vali Acc: 0.259 Test Loss: 1.765 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.49690842628479
Epoch: 13, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.883 Vali Acc: 0.232 Test Loss: 1.883 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2305688858032227
Epoch: 14, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.870 Vali Acc: 0.285 Test Loss: 1.870 Test Acc: 0.285
Validation loss decreased (-0.258540 --> -0.285152).  Saving model ...
Epoch: 15 cost time: 2.7211692333221436
Epoch: 15, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.907 Vali Acc: 0.255 Test Loss: 1.907 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.264782190322876
Epoch: 16, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.049 Vali Acc: 0.243 Test Loss: 2.049 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3115005493164062
Epoch: 17, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.069 Vali Acc: 0.247 Test Loss: 2.069 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4462997913360596
Epoch: 18, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.084 Vali Acc: 0.270 Test Loss: 2.084 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3754494190216064
Epoch: 19, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.216 Vali Acc: 0.247 Test Loss: 2.216 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.861640691757202
Epoch: 20, Steps: 17 | Train Loss: 0.427 Vali Loss: 2.253 Vali Acc: 0.255 Test Loss: 2.253 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3825016021728516
Epoch: 21, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.235 Vali Acc: 0.217 Test Loss: 2.235 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5878748893737793
Epoch: 22, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.433 Vali Acc: 0.221 Test Loss: 2.433 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4331624507904053
Epoch: 23, Steps: 17 | Train Loss: 0.471 Vali Loss: 2.504 Vali Acc: 0.259 Test Loss: 2.504 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4622349739074707
Epoch: 24, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.477 Vali Acc: 0.251 Test Loss: 2.477 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1826776
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.886686086654663
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.477 Vali Acc: 0.202 Test Loss: 1.477 Test Acc: 0.202
Validation loss decreased (inf --> -0.201506).  Saving model ...
Epoch: 2 cost time: 1.1518089771270752
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.486 Vali Acc: 0.236 Test Loss: 1.486 Test Acc: 0.236
Validation loss decreased (-0.201506 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 1.1981821060180664
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.496 Vali Acc: 0.243 Test Loss: 1.496 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 4 cost time: 1.084216833114624
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.472 Vali Acc: 0.247 Test Loss: 1.472 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247134).  Saving model ...
Epoch: 5 cost time: 0.962766170501709
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.557 Vali Acc: 0.266 Test Loss: 1.557 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266144).  Saving model ...
Epoch: 6 cost time: 1.0537018775939941
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.542 Vali Acc: 0.240 Test Loss: 1.542 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1806273460388184
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.513 Vali Acc: 0.243 Test Loss: 1.513 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3118901252746582
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.675 Vali Acc: 0.224 Test Loss: 1.675 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2472586631774902
Epoch: 9, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.592 Vali Acc: 0.266 Test Loss: 1.592 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2494912147521973
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.799 Vali Acc: 0.240 Test Loss: 1.799 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3596749305725098
Epoch: 11, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.770 Vali Acc: 0.240 Test Loss: 1.770 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0701589584350586
Epoch: 12, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.680 Vali Acc: 0.255 Test Loss: 1.680 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0565807819366455
Epoch: 13, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.824 Vali Acc: 0.243 Test Loss: 1.824 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9823691844940186
Epoch: 14, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.730 Vali Acc: 0.247 Test Loss: 1.730 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9560868740081787
Epoch: 15, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.794 Vali Acc: 0.247 Test Loss: 1.794 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1818072
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.713757038116455
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 20.151970148086548
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.453 Vali Acc: 0.262 Test Loss: 1.453 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 18.787559747695923
Epoch: 3, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.448 Vali Acc: 0.217 Test Loss: 1.448 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.491926908493042
Epoch: 4, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.869282722473145
Epoch: 5, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.472 Vali Acc: 0.228 Test Loss: 1.472 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.750643014907837
Epoch: 6, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.468 Vali Acc: 0.232 Test Loss: 1.468 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.24474048614502
Epoch: 7, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.543726205825806
Epoch: 8, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.520 Vali Acc: 0.224 Test Loss: 1.520 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.17532205581665
Epoch: 9, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.582 Vali Acc: 0.194 Test Loss: 1.582 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.64493465423584
Epoch: 10, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.624755144119263
Epoch: 11, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.609 Vali Acc: 0.221 Test Loss: 1.609 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.984244108200073
Epoch: 12, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.614 Vali Acc: 0.270 Test Loss: 1.614 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269946).  Saving model ...
Epoch: 13 cost time: 18.241844177246094
Epoch: 13, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.670 Vali Acc: 0.224 Test Loss: 1.670 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.3929545879364
Epoch: 14, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.602 Vali Acc: 0.213 Test Loss: 1.602 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.54263424873352
Epoch: 15, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.682 Vali Acc: 0.217 Test Loss: 1.682 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.965761184692383
Epoch: 16, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.660 Vali Acc: 0.262 Test Loss: 1.660 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 17.05245566368103
Epoch: 17, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.724 Vali Acc: 0.213 Test Loss: 1.724 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 19.382019519805908
Epoch: 18, Steps: 17 | Train Loss: 0.643 Vali Loss: 1.758 Vali Acc: 0.247 Test Loss: 1.758 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 18.09996247291565
Epoch: 19, Steps: 17 | Train Loss: 0.605 Vali Loss: 1.830 Vali Acc: 0.236 Test Loss: 1.830 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 20.00449800491333
Epoch: 20, Steps: 17 | Train Loss: 0.542 Vali Loss: 1.847 Vali Acc: 0.232 Test Loss: 1.847 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 18.858559370040894
Epoch: 21, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.852 Vali Acc: 0.262 Test Loss: 1.852 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 16.77953290939331
Epoch: 22, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.909 Vali Acc: 0.236 Test Loss: 1.909 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w219_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 977146
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.940980672836304
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.401 Vali Acc: 0.285 Test Loss: 1.401 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 17.646512508392334
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.446 Vali Acc: 0.213 Test Loss: 1.446 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.736332654953003
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.435 Vali Acc: 0.251 Test Loss: 1.435 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.87120270729065
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.440 Vali Acc: 0.240 Test Loss: 1.440 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.776724100112915
Epoch: 5, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.486 Vali Acc: 0.224 Test Loss: 1.486 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.486283779144287
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.478 Vali Acc: 0.236 Test Loss: 1.478 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.879426956176758
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.499 Vali Acc: 0.232 Test Loss: 1.499 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.752693176269531
Epoch: 8, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.518 Vali Acc: 0.228 Test Loss: 1.518 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.347272157669067
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.579 Vali Acc: 0.247 Test Loss: 1.579 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.179174184799194
Epoch: 10, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.559 Vali Acc: 0.251 Test Loss: 1.559 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.780731916427612
Epoch: 11, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.552 Vali Acc: 0.224 Test Loss: 1.552 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w176_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 966138
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.395411252975464
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.426 Vali Acc: 0.224 Test Loss: 1.426 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 12.099625587463379
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (-0.224320 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 12.87004566192627
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.458 Vali Acc: 0.228 Test Loss: 1.458 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.939650774002075
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.454 Vali Acc: 0.217 Test Loss: 1.454 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.70723271369934
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.73218059539795
Epoch: 6, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.453 Vali Acc: 0.217 Test Loss: 1.453 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.099526405334473
Epoch: 7, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.481 Vali Acc: 0.240 Test Loss: 1.481 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.155369281768799
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.568 Vali Acc: 0.259 Test Loss: 1.568 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258539).  Saving model ...
Epoch: 9 cost time: 10.833422660827637
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.550 Vali Acc: 0.228 Test Loss: 1.550 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.378165006637573
Epoch: 10, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.617 Vali Acc: 0.259 Test Loss: 1.617 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.272524118423462
Epoch: 11, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.630 Vali Acc: 0.228 Test Loss: 1.630 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.836845636367798
Epoch: 12, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.635 Vali Acc: 0.205 Test Loss: 1.635 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.540246963500977
Epoch: 13, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.632 Vali Acc: 0.259 Test Loss: 1.632 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.388691425323486
Epoch: 14, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.657 Vali Acc: 0.262 Test Loss: 1.657 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262341).  Saving model ...
Epoch: 15 cost time: 11.978086233139038
Epoch: 15, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.702 Vali Acc: 0.198 Test Loss: 1.702 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.046108722686768
Epoch: 16, Steps: 17 | Train Loss: 0.760 Vali Loss: 1.710 Vali Acc: 0.221 Test Loss: 1.710 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.423069477081299
Epoch: 17, Steps: 17 | Train Loss: 0.710 Vali Loss: 1.751 Vali Acc: 0.259 Test Loss: 1.751 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.364394187927246
Epoch: 18, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.815 Vali Acc: 0.209 Test Loss: 1.815 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.333590507507324
Epoch: 19, Steps: 17 | Train Loss: 0.606 Vali Loss: 1.787 Vali Acc: 0.221 Test Loss: 1.787 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.43699836730957
Epoch: 20, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.819 Vali Acc: 0.221 Test Loss: 1.819 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.739996433258057
Epoch: 21, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.907 Vali Acc: 0.236 Test Loss: 1.907 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.786505699157715
Epoch: 22, Steps: 17 | Train Loss: 0.490 Vali Loss: 1.916 Vali Acc: 0.236 Test Loss: 1.916 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.144382238388062
Epoch: 23, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.926 Vali Acc: 0.221 Test Loss: 1.926 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.730638980865479
Epoch: 24, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.105 Vali Acc: 0.232 Test Loss: 2.105 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w132_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 954874
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.504825830459595
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 8.783742666244507
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.514157772064209
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 8.36414623260498
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.460 Vali Acc: 0.243 Test Loss: 1.460 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.797181129455566
Epoch: 5, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.454 Vali Acc: 0.259 Test Loss: 1.454 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.47953462600708
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.450 Vali Acc: 0.236 Test Loss: 1.450 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.500304460525513
Epoch: 7, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.521 Vali Acc: 0.243 Test Loss: 1.521 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.449084520339966
Epoch: 8, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.532 Vali Acc: 0.232 Test Loss: 1.532 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.507860898971558
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.549 Vali Acc: 0.217 Test Loss: 1.549 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.222526788711548
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.540 Vali Acc: 0.255 Test Loss: 1.540 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.483326435089111
Epoch: 11, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.730 Vali Acc: 0.213 Test Loss: 1.730 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.889886379241943
Epoch: 12, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.630 Vali Acc: 0.232 Test Loss: 1.630 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.084691524505615
Epoch: 13, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.667 Vali Acc: 0.224 Test Loss: 1.667 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w88_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 943610
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.449782848358154
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 4.814299821853638
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.433 Vali Acc: 0.221 Test Loss: 1.433 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4948859214782715
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.445 Vali Acc: 0.213 Test Loss: 1.445 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.857431411743164
Epoch: 4, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.457 Vali Acc: 0.221 Test Loss: 1.457 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.084455728530884
Epoch: 5, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.477 Vali Acc: 0.243 Test Loss: 1.477 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 6 cost time: 5.197434186935425
Epoch: 6, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.499 Vali Acc: 0.213 Test Loss: 1.499 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.464562654495239
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.517 Vali Acc: 0.236 Test Loss: 1.517 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.022064924240112
Epoch: 8, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.516 Vali Acc: 0.243 Test Loss: 1.516 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.674529552459717
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.561 Vali Acc: 0.251 Test Loss: 1.561 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250935).  Saving model ...
Epoch: 10 cost time: 4.842287063598633
Epoch: 10, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.587 Vali Acc: 0.194 Test Loss: 1.587 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.521108388900757
Epoch: 11, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.586 Vali Acc: 0.224 Test Loss: 1.586 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.310200929641724
Epoch: 12, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.600 Vali Acc: 0.262 Test Loss: 1.600 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262341).  Saving model ...
Epoch: 13 cost time: 4.785652160644531
Epoch: 13, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.703 Vali Acc: 0.240 Test Loss: 1.703 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.379637718200684
Epoch: 14, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.705 Vali Acc: 0.243 Test Loss: 1.705 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.50371527671814
Epoch: 15, Steps: 17 | Train Loss: 0.761 Vali Loss: 1.701 Vali Acc: 0.213 Test Loss: 1.701 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.295334100723267
Epoch: 16, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.764 Vali Acc: 0.236 Test Loss: 1.764 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.228318452835083
Epoch: 17, Steps: 17 | Train Loss: 0.656 Vali Loss: 1.868 Vali Acc: 0.228 Test Loss: 1.868 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.01034951210022
Epoch: 18, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.887 Vali Acc: 0.221 Test Loss: 1.887 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.9338274002075195
Epoch: 19, Steps: 17 | Train Loss: 0.563 Vali Loss: 2.032 Vali Acc: 0.247 Test Loss: 2.032 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.36006498336792
Epoch: 20, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.994 Vali Acc: 0.243 Test Loss: 1.994 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.852734088897705
Epoch: 21, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.012 Vali Acc: 0.236 Test Loss: 2.012 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.282908916473389
Epoch: 22, Steps: 17 | Train Loss: 0.365 Vali Loss: 2.195 Vali Acc: 0.228 Test Loss: 2.195 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w53_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 934650
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.712303400039673
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.408 Vali Acc: 0.217 Test Loss: 1.408 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 3.3349761962890625
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.431 Vali Acc: 0.209 Test Loss: 1.431 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.225490093231201
Epoch: 3, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.457 Vali Acc: 0.209 Test Loss: 1.457 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1981101036071777
Epoch: 4, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.461 Vali Acc: 0.209 Test Loss: 1.461 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6843461990356445
Epoch: 5, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.472 Vali Acc: 0.205 Test Loss: 1.472 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.153339147567749
Epoch: 6, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.500 Vali Acc: 0.194 Test Loss: 1.500 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.363879442214966
Epoch: 7, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.545 Vali Acc: 0.217 Test Loss: 1.545 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.899832010269165
Epoch: 8, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.621 Vali Acc: 0.198 Test Loss: 1.621 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2925827503204346
Epoch: 9, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.627 Vali Acc: 0.247 Test Loss: 1.627 Test Acc: 0.247
Validation loss decreased (-0.216716 --> -0.247132).  Saving model ...
Epoch: 10 cost time: 3.2261440753936768
Epoch: 10, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.649 Vali Acc: 0.221 Test Loss: 1.649 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.610264539718628
Epoch: 11, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.606 Vali Acc: 0.205 Test Loss: 1.606 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.405794858932495
Epoch: 12, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.663 Vali Acc: 0.198 Test Loss: 1.663 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.139918565750122
Epoch: 13, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.671 Vali Acc: 0.198 Test Loss: 1.671 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0918548107147217
Epoch: 14, Steps: 17 | Train Loss: 0.784 Vali Loss: 1.682 Vali Acc: 0.217 Test Loss: 1.682 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.259199619293213
Epoch: 15, Steps: 17 | Train Loss: 0.742 Vali Loss: 1.802 Vali Acc: 0.179 Test Loss: 1.802 Test Acc: 0.179
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.730452299118042
Epoch: 16, Steps: 17 | Train Loss: 0.694 Vali Loss: 1.734 Vali Acc: 0.240 Test Loss: 1.734 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.558289051055908
Epoch: 17, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.812 Vali Acc: 0.243 Test Loss: 1.812 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.074340581893921
Epoch: 18, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.929 Vali Acc: 0.224 Test Loss: 1.929 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5834786891937256
Epoch: 19, Steps: 17 | Train Loss: 0.641 Vali Loss: 1.913 Vali Acc: 0.209 Test Loss: 1.913 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w36_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.24714828897338403
model parameter : 930298
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.221063852310181
Epoch: 1, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.468 Vali Acc: 0.213 Test Loss: 1.468 Test Acc: 0.213
Validation loss decreased (inf --> -0.212913).  Saving model ...
Epoch: 2 cost time: 2.266510248184204
Epoch: 2, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.447 Vali Acc: 0.232 Test Loss: 1.447 Test Acc: 0.232
Validation loss decreased (-0.212913 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 2.7750134468078613
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.488 Vali Acc: 0.213 Test Loss: 1.488 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.477968215942383
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.473 Vali Acc: 0.202 Test Loss: 1.473 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2138383388519287
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.501 Vali Acc: 0.209 Test Loss: 1.501 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3011510372161865
Epoch: 6, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.543 Vali Acc: 0.221 Test Loss: 1.543 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0180604457855225
Epoch: 7, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.510 Vali Acc: 0.232 Test Loss: 1.510 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.814790964126587
Epoch: 8, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.558 Vali Acc: 0.240 Test Loss: 1.558 Test Acc: 0.240
Validation loss decreased (-0.231925 --> -0.239528).  Saving model ...
Epoch: 9 cost time: 2.552947521209717
Epoch: 9, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.594 Vali Acc: 0.251 Test Loss: 1.594 Test Acc: 0.251
Validation loss decreased (-0.239528 --> -0.250935).  Saving model ...
Epoch: 10 cost time: 2.2096617221832275
Epoch: 10, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.696 Vali Acc: 0.228 Test Loss: 1.696 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.132047414779663
Epoch: 11, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4258360862731934
Epoch: 12, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.669 Vali Acc: 0.232 Test Loss: 1.669 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3979578018188477
Epoch: 13, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.742 Vali Acc: 0.243 Test Loss: 1.742 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.253211736679077
Epoch: 14, Steps: 17 | Train Loss: 0.712 Vali Loss: 1.714 Vali Acc: 0.243 Test Loss: 1.714 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.006622076034546
Epoch: 15, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.778 Vali Acc: 0.236 Test Loss: 1.778 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.075162649154663
Epoch: 16, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
Validation loss decreased (-0.250935 --> -0.258538).  Saving model ...
Epoch: 17 cost time: 2.1509249210357666
Epoch: 17, Steps: 17 | Train Loss: 0.505 Vali Loss: 1.804 Vali Acc: 0.262 Test Loss: 1.804 Test Acc: 0.262
Validation loss decreased (-0.258538 --> -0.262339).  Saving model ...
Epoch: 18 cost time: 2.164813995361328
Epoch: 18, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.953 Vali Acc: 0.285 Test Loss: 1.953 Test Acc: 0.285
Validation loss decreased (-0.262339 --> -0.285152).  Saving model ...
Epoch: 19 cost time: 2.1985726356506348
Epoch: 19, Steps: 17 | Train Loss: 0.394 Vali Loss: 1.889 Vali Acc: 0.274 Test Loss: 1.889 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.54125714302063
Epoch: 20, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.982 Vali Acc: 0.243 Test Loss: 1.982 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9264976978302
Epoch: 21, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.980 Vali Acc: 0.270 Test Loss: 1.980 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.430588722229004
Epoch: 22, Steps: 17 | Train Loss: 0.259 Vali Loss: 2.124 Vali Acc: 0.243 Test Loss: 2.124 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1738808155059814
Epoch: 23, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.190 Vali Acc: 0.270 Test Loss: 2.190 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6861608028411865
Epoch: 24, Steps: 17 | Train Loss: 0.214 Vali Loss: 2.211 Vali Acc: 0.247 Test Loss: 2.211 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3316712379455566
Epoch: 25, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.334 Vali Acc: 0.255 Test Loss: 2.334 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6067886352539062
Epoch: 26, Steps: 17 | Train Loss: 0.152 Vali Loss: 2.331 Vali Acc: 0.289 Test Loss: 2.331 Test Acc: 0.289
Validation loss decreased (-0.285152 --> -0.288950).  Saving model ...
Epoch: 27 cost time: 2.504453659057617
Epoch: 27, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.400 Vali Acc: 0.266 Test Loss: 2.400 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3649914264678955
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.481 Vali Acc: 0.255 Test Loss: 2.481 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6952669620513916
Epoch: 29, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.491 Vali Acc: 0.304 Test Loss: 2.491 Test Acc: 0.304
Validation loss decreased (-0.288950 --> -0.304158).  Saving model ...
Epoch: 30 cost time: 2.6700143814086914
Epoch: 30, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.447 Vali Acc: 0.251 Test Loss: 2.447 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.521841287612915
Epoch: 31, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.498 Vali Acc: 0.281 Test Loss: 2.498 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.5874416828155518
Epoch: 32, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.624 Vali Acc: 0.274 Test Loss: 2.624 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.613051176071167
Epoch: 33, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.686 Vali Acc: 0.240 Test Loss: 2.686 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.8366806507110596
Epoch: 34, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.733 Vali Acc: 0.270 Test Loss: 2.733 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.6747446060180664
Epoch: 35, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.737 Vali Acc: 0.255 Test Loss: 2.737 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.6431431770324707
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.768 Vali Acc: 0.262 Test Loss: 2.768 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.323727607727051
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.797 Vali Acc: 0.236 Test Loss: 2.797 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.01542067527771
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.831 Vali Acc: 0.270 Test Loss: 2.831 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.2618231773376465
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.870 Vali Acc: 0.255 Test Loss: 2.870 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 925690
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.855999708175659
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.436 Vali Acc: 0.224 Test Loss: 1.436 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 1.0292840003967285
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.450 Vali Acc: 0.224 Test Loss: 1.450 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1618213653564453
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
Validation loss decreased (-0.224320 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 1.0638434886932373
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.457 Vali Acc: 0.232 Test Loss: 1.457 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2130656242370605
Epoch: 5, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.480 Vali Acc: 0.228 Test Loss: 1.480 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.209563970565796
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.497 Vali Acc: 0.198 Test Loss: 1.497 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3349921703338623
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.493 Vali Acc: 0.251 Test Loss: 1.493 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 8 cost time: 1.0228614807128906
Epoch: 8, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.513 Vali Acc: 0.194 Test Loss: 1.513 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3778762817382812
Epoch: 9, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.563 Vali Acc: 0.209 Test Loss: 1.563 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1065614223480225
Epoch: 10, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.558 Vali Acc: 0.213 Test Loss: 1.558 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0014071464538574
Epoch: 11, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.610 Vali Acc: 0.202 Test Loss: 1.610 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.319563627243042
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.683 Vali Acc: 0.209 Test Loss: 1.683 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3259556293487549
Epoch: 13, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.641 Vali Acc: 0.236 Test Loss: 1.641 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2422053813934326
Epoch: 14, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.652 Vali Acc: 0.209 Test Loss: 1.652 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.35078763961792
Epoch: 15, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.686 Vali Acc: 0.198 Test Loss: 1.686 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2954049110412598
Epoch: 16, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.711 Vali Acc: 0.209 Test Loss: 1.711 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6388390064239502
Epoch: 17, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.675 Vali Acc: 0.247 Test Loss: 1.675 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 921338
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.683069705963135
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.441 Vali Acc: 0.213 Test Loss: 1.441 Test Acc: 0.213
Validation loss decreased (inf --> -0.212913).  Saving model ...
Epoch: 2 cost time: 16.296995878219604
Epoch: 2, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.473 Vali Acc: 0.224 Test Loss: 1.473 Test Acc: 0.224
Validation loss decreased (-0.212913 --> -0.224320).  Saving model ...
Epoch: 3 cost time: 15.693773746490479
Epoch: 3, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
Validation loss decreased (-0.224320 --> -0.239529).  Saving model ...
Epoch: 4 cost time: 15.506635665893555
Epoch: 4, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.514 Vali Acc: 0.213 Test Loss: 1.514 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.030917644500732
Epoch: 5, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.540 Vali Acc: 0.217 Test Loss: 1.540 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.03547430038452
Epoch: 6, Steps: 17 | Train Loss: 0.750 Vali Loss: 1.590 Vali Acc: 0.243 Test Loss: 1.590 Test Acc: 0.243
Validation loss decreased (-0.239529 --> -0.243330).  Saving model ...
Epoch: 7 cost time: 16.614871501922607
Epoch: 7, Steps: 17 | Train Loss: 0.647 Vali Loss: 1.607 Vali Acc: 0.213 Test Loss: 1.607 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.00874924659729
Epoch: 8, Steps: 17 | Train Loss: 0.590 Vali Loss: 1.700 Vali Acc: 0.228 Test Loss: 1.700 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.875866651535034
Epoch: 9, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.691 Vali Acc: 0.232 Test Loss: 1.691 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.343345642089844
Epoch: 10, Steps: 17 | Train Loss: 0.439 Vali Loss: 1.729 Vali Acc: 0.213 Test Loss: 1.729 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.527750253677368
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.878 Vali Acc: 0.228 Test Loss: 1.878 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.18381428718567
Epoch: 12, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.844 Vali Acc: 0.240 Test Loss: 1.844 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.910110235214233
Epoch: 13, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.946 Vali Acc: 0.247 Test Loss: 1.946 Test Acc: 0.247
Validation loss decreased (-0.243330 --> -0.247129).  Saving model ...
Epoch: 14 cost time: 15.88368535041809
Epoch: 14, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.026 Vali Acc: 0.247 Test Loss: 2.026 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.996651887893677
Epoch: 15, Steps: 17 | Train Loss: 0.284 Vali Loss: 2.083 Vali Acc: 0.232 Test Loss: 2.083 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.80986976623535
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 2.134 Vali Acc: 0.194 Test Loss: 2.134 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.33177900314331
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.179 Vali Acc: 0.243 Test Loss: 2.179 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.801732301712036
Epoch: 18, Steps: 17 | Train Loss: 0.195 Vali Loss: 2.212 Vali Acc: 0.243 Test Loss: 2.212 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 16.231654405593872
Epoch: 19, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.348 Vali Acc: 0.221 Test Loss: 2.348 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 15.61416745185852
Epoch: 20, Steps: 17 | Train Loss: 0.188 Vali Loss: 2.440 Vali Acc: 0.259 Test Loss: 2.440 Test Acc: 0.259
Validation loss decreased (-0.247129 --> -0.258531).  Saving model ...
Epoch: 21 cost time: 15.880805253982544
Epoch: 21, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.373 Vali Acc: 0.255 Test Loss: 2.373 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.927101850509644
Epoch: 22, Steps: 17 | Train Loss: 0.132 Vali Loss: 2.520 Vali Acc: 0.228 Test Loss: 2.520 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.14294695854187
Epoch: 23, Steps: 17 | Train Loss: 0.126 Vali Loss: 2.453 Vali Acc: 0.217 Test Loss: 2.453 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.43273138999939
Epoch: 24, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.653 Vali Acc: 0.194 Test Loss: 2.653 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 18.006186485290527
Epoch: 25, Steps: 17 | Train Loss: 0.136 Vali Loss: 2.614 Vali Acc: 0.266 Test Loss: 2.614 Test Acc: 0.266
Validation loss decreased (-0.258531 --> -0.266134).  Saving model ...
Epoch: 26 cost time: 21.741044521331787
Epoch: 26, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.576 Vali Acc: 0.236 Test Loss: 2.576 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 19.85021996498108
Epoch: 27, Steps: 17 | Train Loss: 0.097 Vali Loss: 2.665 Vali Acc: 0.270 Test Loss: 2.665 Test Acc: 0.270
Validation loss decreased (-0.266134 --> -0.269935).  Saving model ...
Epoch: 28 cost time: 20.654725313186646
Epoch: 28, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.659 Vali Acc: 0.247 Test Loss: 2.659 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 17.393843173980713
Epoch: 29, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.964 Vali Acc: 0.232 Test Loss: 2.964 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 18.503628253936768
Epoch: 30, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.675 Vali Acc: 0.243 Test Loss: 2.675 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 21.40289330482483
Epoch: 31, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.942 Vali Acc: 0.221 Test Loss: 2.942 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 19.42923355102539
Epoch: 32, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.794 Vali Acc: 0.251 Test Loss: 2.794 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 20.03479290008545
Epoch: 33, Steps: 17 | Train Loss: 0.093 Vali Loss: 3.014 Vali Acc: 0.228 Test Loss: 3.014 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 18.747726917266846
Epoch: 34, Steps: 17 | Train Loss: 0.101 Vali Loss: 2.839 Vali Acc: 0.255 Test Loss: 2.839 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 19.423054218292236
Epoch: 35, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.995 Vali Acc: 0.262 Test Loss: 2.995 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 20.273252248764038
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 3.116 Vali Acc: 0.259 Test Loss: 3.116 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 20.739792823791504
Epoch: 37, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.171 Vali Acc: 0.251 Test Loss: 3.171 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w219_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 977112
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.01197648048401
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.446 Vali Acc: 0.247 Test Loss: 1.446 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 14.686858415603638
Epoch: 2, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.497 Vali Acc: 0.213 Test Loss: 1.497 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.970743656158447
Epoch: 3, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.519 Vali Acc: 0.209 Test Loss: 1.519 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.124489784240723
Epoch: 4, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.526 Vali Acc: 0.198 Test Loss: 1.526 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.667134046554565
Epoch: 5, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.591 Vali Acc: 0.224 Test Loss: 1.591 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.563998222351074
Epoch: 6, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.566 Vali Acc: 0.213 Test Loss: 1.566 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.844796895980835
Epoch: 7, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.629 Vali Acc: 0.217 Test Loss: 1.629 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.749494791030884
Epoch: 8, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.693 Vali Acc: 0.217 Test Loss: 1.693 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.648832559585571
Epoch: 9, Steps: 17 | Train Loss: 0.494 Vali Loss: 1.688 Vali Acc: 0.270 Test Loss: 1.688 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269945).  Saving model ...
Epoch: 10 cost time: 12.81920337677002
Epoch: 10, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.763 Vali Acc: 0.236 Test Loss: 1.763 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.35612678527832
Epoch: 11, Steps: 17 | Train Loss: 0.369 Vali Loss: 1.801 Vali Acc: 0.217 Test Loss: 1.801 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.138330936431885
Epoch: 12, Steps: 17 | Train Loss: 0.314 Vali Loss: 1.820 Vali Acc: 0.262 Test Loss: 1.820 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.852423191070557
Epoch: 13, Steps: 17 | Train Loss: 0.300 Vali Loss: 1.955 Vali Acc: 0.205 Test Loss: 1.955 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.282649040222168
Epoch: 14, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.939 Vali Acc: 0.243 Test Loss: 1.939 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.2264084815979
Epoch: 15, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.913 Vali Acc: 0.262 Test Loss: 1.913 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.403598546981812
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.046 Vali Acc: 0.243 Test Loss: 2.046 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.570657968521118
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.101 Vali Acc: 0.236 Test Loss: 2.101 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.974997520446777
Epoch: 18, Steps: 17 | Train Loss: 0.181 Vali Loss: 2.120 Vali Acc: 0.247 Test Loss: 2.120 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 14.362207412719727
Epoch: 19, Steps: 17 | Train Loss: 0.168 Vali Loss: 2.130 Vali Acc: 0.243 Test Loss: 2.130 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w176_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 966104
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.614206075668335
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.425 Vali Acc: 0.255 Test Loss: 1.425 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 11.36598801612854
Epoch: 2, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.453 Vali Acc: 0.243 Test Loss: 1.453 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.413530588150024
Epoch: 3, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.499 Vali Acc: 0.221 Test Loss: 1.499 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.80858564376831
Epoch: 4, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.492 Vali Acc: 0.209 Test Loss: 1.492 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.834367990493774
Epoch: 5, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.522 Vali Acc: 0.247 Test Loss: 1.522 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.351611852645874
Epoch: 6, Steps: 17 | Train Loss: 0.684 Vali Loss: 1.539 Vali Acc: 0.240 Test Loss: 1.539 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.638638019561768
Epoch: 7, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.602 Vali Acc: 0.270 Test Loss: 1.602 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 11.102016687393188
Epoch: 8, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.609 Vali Acc: 0.236 Test Loss: 1.609 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.995615482330322
Epoch: 9, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.706 Vali Acc: 0.255 Test Loss: 1.706 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.386474609375
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.745 Vali Acc: 0.232 Test Loss: 1.745 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.628098726272583
Epoch: 11, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.737 Vali Acc: 0.247 Test Loss: 1.737 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.771880149841309
Epoch: 12, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.887 Vali Acc: 0.243 Test Loss: 1.887 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.995277643203735
Epoch: 13, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.972 Vali Acc: 0.243 Test Loss: 1.972 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.03812289237976
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 2.011 Vali Acc: 0.270 Test Loss: 2.011 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.86796259880066
Epoch: 15, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.981 Vali Acc: 0.240 Test Loss: 1.981 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.108557939529419
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.107 Vali Acc: 0.243 Test Loss: 2.107 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.268584966659546
Epoch: 17, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.179 Vali Acc: 0.224 Test Loss: 2.179 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w132_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 954840
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.95815134048462
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.423 Vali Acc: 0.262 Test Loss: 1.423 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 9.662855863571167
Epoch: 2, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.466 Vali Acc: 0.221 Test Loss: 1.466 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.264801025390625
Epoch: 3, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.490 Vali Acc: 0.232 Test Loss: 1.490 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.506043434143066
Epoch: 4, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.489 Vali Acc: 0.247 Test Loss: 1.489 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.231241464614868
Epoch: 5, Steps: 17 | Train Loss: 0.826 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.0572052001953125
Epoch: 6, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.569 Vali Acc: 0.232 Test Loss: 1.569 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.313939332962036
Epoch: 7, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.597 Vali Acc: 0.240 Test Loss: 1.597 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.33157467842102
Epoch: 8, Steps: 17 | Train Loss: 0.496 Vali Loss: 1.693 Vali Acc: 0.255 Test Loss: 1.693 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.473766803741455
Epoch: 9, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.736 Vali Acc: 0.221 Test Loss: 1.736 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.636274814605713
Epoch: 10, Steps: 17 | Train Loss: 0.375 Vali Loss: 1.745 Vali Acc: 0.251 Test Loss: 1.745 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.555634498596191
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.797 Vali Acc: 0.262 Test Loss: 1.797 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w88_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 943576
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.587000608444214
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.445 Vali Acc: 0.190 Test Loss: 1.445 Test Acc: 0.190
Validation loss decreased (inf --> -0.190100).  Saving model ...
Epoch: 2 cost time: 4.610548257827759
Epoch: 2, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.469 Vali Acc: 0.190 Test Loss: 1.469 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.388484716415405
Epoch: 3, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.498 Vali Acc: 0.171 Test Loss: 1.498 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.866199254989624
Epoch: 4, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.501 Vali Acc: 0.217 Test Loss: 1.501 Test Acc: 0.217
Validation loss decreased (-0.190100 --> -0.216715).  Saving model ...
Epoch: 5 cost time: 4.583784103393555
Epoch: 5, Steps: 17 | Train Loss: 0.780 Vali Loss: 1.519 Vali Acc: 0.228 Test Loss: 1.519 Test Acc: 0.228
Validation loss decreased (-0.216715 --> -0.228122).  Saving model ...
Epoch: 6 cost time: 4.101474761962891
Epoch: 6, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.550 Vali Acc: 0.236 Test Loss: 1.550 Test Acc: 0.236
Validation loss decreased (-0.228122 --> -0.235726).  Saving model ...
Epoch: 7 cost time: 5.111575603485107
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.589 Vali Acc: 0.251 Test Loss: 1.589 Test Acc: 0.251
Validation loss decreased (-0.235726 --> -0.250935).  Saving model ...
Epoch: 8 cost time: 4.223513603210449
Epoch: 8, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.642 Vali Acc: 0.247 Test Loss: 1.642 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.374502420425415
Epoch: 9, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.654 Vali Acc: 0.247 Test Loss: 1.654 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.828982591629028
Epoch: 10, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.759 Vali Acc: 0.232 Test Loss: 1.759 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.0719990730285645
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.775 Vali Acc: 0.240 Test Loss: 1.775 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.088221549987793
Epoch: 12, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.927 Vali Acc: 0.228 Test Loss: 1.927 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.4450156688690186
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.869 Vali Acc: 0.262 Test Loss: 1.869 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262339).  Saving model ...
Epoch: 14 cost time: 5.051327466964722
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.933 Vali Acc: 0.240 Test Loss: 1.933 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.4108664989471436
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 2.070 Vali Acc: 0.255 Test Loss: 2.070 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.091026067733765
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 2.068 Vali Acc: 0.251 Test Loss: 2.068 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.206570386886597
Epoch: 17, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.163 Vali Acc: 0.247 Test Loss: 2.163 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.860717058181763
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.132 Vali Acc: 0.247 Test Loss: 2.132 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.649080276489258
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 2.131 Vali Acc: 0.251 Test Loss: 2.131 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.880131483078003
Epoch: 20, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.344 Vali Acc: 0.251 Test Loss: 2.344 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.4380269050598145
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.192 Vali Acc: 0.266 Test Loss: 2.192 Test Acc: 0.266
Validation loss decreased (-0.262339 --> -0.266138).  Saving model ...
Epoch: 22 cost time: 4.068717956542969
Epoch: 22, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.370 Vali Acc: 0.247 Test Loss: 2.370 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.465170860290527
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.581 Vali Acc: 0.221 Test Loss: 2.581 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.805240631103516
Epoch: 24, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.528 Vali Acc: 0.224 Test Loss: 2.528 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.40546727180481
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.551 Vali Acc: 0.221 Test Loss: 2.551 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.5951926708221436
Epoch: 26, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.572 Vali Acc: 0.243 Test Loss: 2.572 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.7530131340026855
Epoch: 27, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.715 Vali Acc: 0.259 Test Loss: 2.715 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.795858383178711
Epoch: 28, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.761 Vali Acc: 0.224 Test Loss: 2.761 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.686694383621216
Epoch: 29, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.865 Vali Acc: 0.240 Test Loss: 2.865 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.81649112701416
Epoch: 30, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.864 Vali Acc: 0.281 Test Loss: 2.864 Test Acc: 0.281
Validation loss decreased (-0.266138 --> -0.281340).  Saving model ...
Epoch: 31 cost time: 4.654699087142944
Epoch: 31, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.985 Vali Acc: 0.202 Test Loss: 2.985 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.249018669128418
Epoch: 32, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.925 Vali Acc: 0.236 Test Loss: 2.925 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.171467304229736
Epoch: 33, Steps: 17 | Train Loss: 0.111 Vali Loss: 3.080 Vali Acc: 0.255 Test Loss: 3.080 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.650128126144409
Epoch: 34, Steps: 17 | Train Loss: 0.122 Vali Loss: 3.209 Vali Acc: 0.251 Test Loss: 3.209 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.826966047286987
Epoch: 35, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.924 Vali Acc: 0.270 Test Loss: 2.924 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.189966440200806
Epoch: 36, Steps: 17 | Train Loss: 0.097 Vali Loss: 2.968 Vali Acc: 0.293 Test Loss: 2.968 Test Acc: 0.293
Validation loss decreased (-0.281340 --> -0.292746).  Saving model ...
Epoch: 37 cost time: 4.960371255874634
Epoch: 37, Steps: 17 | Train Loss: 0.157 Vali Loss: 3.037 Vali Acc: 0.255 Test Loss: 3.037 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.002751350402832
Epoch: 38, Steps: 17 | Train Loss: 0.174 Vali Loss: 2.961 Vali Acc: 0.247 Test Loss: 2.961 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.719449758529663
Epoch: 39, Steps: 17 | Train Loss: 0.130 Vali Loss: 3.128 Vali Acc: 0.289 Test Loss: 3.128 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.511925220489502
Epoch: 40, Steps: 17 | Train Loss: 0.143 Vali Loss: 3.220 Vali Acc: 0.251 Test Loss: 3.220 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.709760904312134
Epoch: 41, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.404 Vali Acc: 0.224 Test Loss: 3.404 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 4.585105895996094
Epoch: 42, Steps: 17 | Train Loss: 0.168 Vali Loss: 3.011 Vali Acc: 0.247 Test Loss: 3.011 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.641656160354614
Epoch: 43, Steps: 17 | Train Loss: 0.193 Vali Loss: 3.264 Vali Acc: 0.255 Test Loss: 3.264 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 5.023364543914795
Epoch: 44, Steps: 17 | Train Loss: 0.137 Vali Loss: 3.155 Vali Acc: 0.281 Test Loss: 3.155 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 4.574030160903931
Epoch: 45, Steps: 17 | Train Loss: 0.169 Vali Loss: 3.242 Vali Acc: 0.262 Test Loss: 3.242 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 4.548222780227661
Epoch: 46, Steps: 17 | Train Loss: 0.144 Vali Loss: 3.444 Vali Acc: 0.224 Test Loss: 3.444 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w53_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 934616
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.907948732376099
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.419 Vali Acc: 0.259 Test Loss: 1.419 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 3.5765488147735596
Epoch: 2, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.452 Vali Acc: 0.221 Test Loss: 1.452 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.539348602294922
Epoch: 3, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.457 Vali Acc: 0.240 Test Loss: 1.457 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6096980571746826
Epoch: 4, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.502 Vali Acc: 0.228 Test Loss: 1.502 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.118985652923584
Epoch: 5, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.516 Vali Acc: 0.228 Test Loss: 1.516 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2031044960021973
Epoch: 6, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.554 Vali Acc: 0.217 Test Loss: 1.554 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4578347206115723
Epoch: 7, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.583 Vali Acc: 0.270 Test Loss: 1.583 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 4.044778347015381
Epoch: 8, Steps: 17 | Train Loss: 0.456 Vali Loss: 1.623 Vali Acc: 0.262 Test Loss: 1.623 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.268831968307495
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 1.646 Vali Acc: 0.243 Test Loss: 1.646 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5197572708129883
Epoch: 10, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.762 Vali Acc: 0.221 Test Loss: 1.762 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4336023330688477
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.736 Vali Acc: 0.266 Test Loss: 1.736 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2409746646881104
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.857 Vali Acc: 0.297 Test Loss: 1.857 Test Acc: 0.297
Validation loss decreased (-0.269946 --> -0.296559).  Saving model ...
Epoch: 13 cost time: 3.3243095874786377
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.890 Vali Acc: 0.251 Test Loss: 1.890 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.059457302093506
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 2.026 Vali Acc: 0.274 Test Loss: 2.026 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5012168884277344
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.025 Vali Acc: 0.228 Test Loss: 2.025 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.180858850479126
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.145 Vali Acc: 0.247 Test Loss: 2.145 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2215263843536377
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 2.137 Vali Acc: 0.240 Test Loss: 2.137 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.876828193664551
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.192 Vali Acc: 0.259 Test Loss: 2.192 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4629194736480713
Epoch: 19, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.297 Vali Acc: 0.232 Test Loss: 2.297 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.161271810531616
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 2.433 Vali Acc: 0.281 Test Loss: 2.433 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.576784133911133
Epoch: 21, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.386 Vali Acc: 0.259 Test Loss: 2.386 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9393112659454346
Epoch: 22, Steps: 17 | Train Loss: 0.173 Vali Loss: 2.502 Vali Acc: 0.240 Test Loss: 2.502 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w36_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 930264
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.402167797088623
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.444 Vali Acc: 0.259 Test Loss: 1.444 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.3266618251800537
Epoch: 2, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.480 Vali Acc: 0.209 Test Loss: 1.480 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7101235389709473
Epoch: 3, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.487 Vali Acc: 0.190 Test Loss: 1.487 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5921061038970947
Epoch: 4, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.520 Vali Acc: 0.232 Test Loss: 1.520 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2895264625549316
Epoch: 5, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.518 Vali Acc: 0.209 Test Loss: 1.518 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.45471453666687
Epoch: 6, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.550 Vali Acc: 0.221 Test Loss: 1.550 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0226428508758545
Epoch: 7, Steps: 17 | Train Loss: 0.596 Vali Loss: 1.629 Vali Acc: 0.251 Test Loss: 1.629 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.256575107574463
Epoch: 8, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.622 Vali Acc: 0.247 Test Loss: 1.622 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1458630561828613
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.716 Vali Acc: 0.251 Test Loss: 1.716 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.419145345687866
Epoch: 10, Steps: 17 | Train Loss: 0.415 Vali Loss: 1.756 Vali Acc: 0.232 Test Loss: 1.756 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6921541690826416
Epoch: 11, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.786 Vali Acc: 0.240 Test Loss: 1.786 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 925656
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8475708961486816
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.463 Vali Acc: 0.232 Test Loss: 1.463 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.749842643737793
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.475 Vali Acc: 0.202 Test Loss: 1.475 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0690827369689941
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.466 Vali Acc: 0.190 Test Loss: 1.466 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.974400520324707
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.473 Vali Acc: 0.232 Test Loss: 1.473 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9217972755432129
Epoch: 5, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.528 Vali Acc: 0.186 Test Loss: 1.528 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9647741317749023
Epoch: 6, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.495 Vali Acc: 0.255 Test Loss: 1.495 Test Acc: 0.255
Validation loss decreased (-0.231925 --> -0.254738).  Saving model ...
Epoch: 7 cost time: 0.8673827648162842
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.541 Vali Acc: 0.236 Test Loss: 1.541 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8880650997161865
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.579 Vali Acc: 0.175 Test Loss: 1.579 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9313077926635742
Epoch: 9, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.670 Vali Acc: 0.243 Test Loss: 1.670 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9315648078918457
Epoch: 10, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.618 Vali Acc: 0.232 Test Loss: 1.618 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9470419883728027
Epoch: 11, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.688 Vali Acc: 0.228 Test Loss: 1.688 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8936014175415039
Epoch: 12, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.644 Vali Acc: 0.209 Test Loss: 1.644 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8068411350250244
Epoch: 13, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.646 Vali Acc: 0.247 Test Loss: 1.646 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8525388240814209
Epoch: 14, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.722 Vali Acc: 0.186 Test Loss: 1.722 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0044589042663574
Epoch: 15, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.833 Vali Acc: 0.243 Test Loss: 1.833 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9951200485229492
Epoch: 16, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.793 Vali Acc: 0.232 Test Loss: 1.793 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_MTSMixer_UEA_ftM_sl1751_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.25475285171102663
model parameter : 921304
model size : 3.52MB
