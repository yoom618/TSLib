Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.263152837753296
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.685 Vali Acc: 0.556 Test Loss: 0.685 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 6.3377416133880615
Epoch: 2, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.627 Vali Acc: 0.642 Test Loss: 0.627 Test Acc: 0.642
Validation loss decreased (-0.556307 --> -0.641632).  Saving model ...
Epoch: 3 cost time: 6.578282833099365
Epoch: 3, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.592 Vali Acc: 0.683 Test Loss: 0.592 Test Acc: 0.683
Validation loss decreased (-0.641632 --> -0.682588).  Saving model ...
Epoch: 4 cost time: 6.383421897888184
Epoch: 4, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.563 Vali Acc: 0.713 Test Loss: 0.563 Test Acc: 0.713
Validation loss decreased (-0.682588 --> -0.713305).  Saving model ...
Epoch: 5 cost time: 7.145935297012329
Epoch: 5, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.550 Vali Acc: 0.710 Test Loss: 0.550 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.953763723373413
Epoch: 6, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.552 Vali Acc: 0.706 Test Loss: 0.552 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.606045484542847
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.541 Vali Acc: 0.720 Test Loss: 0.541 Test Acc: 0.720
Validation loss decreased (-0.713305 --> -0.720131).  Saving model ...
Epoch: 8 cost time: 6.1720805168151855
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.713 Test Loss: 0.536 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.122362375259399
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.713 Test Loss: 0.540 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.809933185577393
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.713 Test Loss: 0.543 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.206604957580566
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.717 Test Loss: 0.543 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.0452821254730225
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.710 Test Loss: 0.550 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.403080463409424
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
Validation loss decreased (-0.720131 --> -0.726957).  Saving model ...
Epoch: 14 cost time: 6.938329696655273
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.720 Test Loss: 0.547 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.826335191726685
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.724 Test Loss: 0.545 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.524804592132568
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.543286323547363
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.724 Test Loss: 0.548 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.9121832847595215
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.720 Test Loss: 0.550 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.369888067245483
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.730 Test Loss: 0.552 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 20 cost time: 6.290097951889038
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.936236619949341
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.724 Test Loss: 0.554 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.2592997550964355
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.024385452270508
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.724 Test Loss: 0.555 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.031129837036133
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.727 Test Loss: 0.558 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.676936388015747
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.945338010787964
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.839974880218506
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.720 Test Loss: 0.562 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.932779312133789
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.977189540863037
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7303754266211604
model parameter : 3912090
model size : 15.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.1328113079071045
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.670 Vali Acc: 0.584 Test Loss: 0.670 Test Acc: 0.584
Validation loss decreased (inf --> -0.583611).  Saving model ...
Epoch: 2 cost time: 4.685312271118164
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.597 Vali Acc: 0.659 Test Loss: 0.597 Test Acc: 0.659
Validation loss decreased (-0.583611 --> -0.658697).  Saving model ...
Epoch: 3 cost time: 4.789156436920166
Epoch: 3, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.546 Vali Acc: 0.706 Test Loss: 0.546 Test Acc: 0.706
Validation loss decreased (-0.658697 --> -0.706479).  Saving model ...
Epoch: 4 cost time: 4.719337463378906
Epoch: 4, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.706479 --> -0.740609).  Saving model ...
Epoch: 5 cost time: 4.9339845180511475
Epoch: 5, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.515 Vali Acc: 0.747 Test Loss: 0.515 Test Acc: 0.747
Validation loss decreased (-0.740609 --> -0.747435).  Saving model ...
Epoch: 6 cost time: 4.823843955993652
Epoch: 6, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.754 Test Loss: 0.515 Test Acc: 0.754
Validation loss decreased (-0.747435 --> -0.754261).  Saving model ...
Epoch: 7 cost time: 5.795067548751831
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.532 Vali Acc: 0.747 Test Loss: 0.532 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.155720949172974
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.521 Vali Acc: 0.775 Test Loss: 0.521 Test Acc: 0.775
Validation loss decreased (-0.754261 --> -0.774739).  Saving model ...
Epoch: 9 cost time: 4.883314371109009
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
Validation loss decreased (-0.774739 --> -0.778152).  Saving model ...
Epoch: 10 cost time: 4.885382890701294
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.778 Test Loss: 0.529 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.828528642654419
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.758 Test Loss: 0.546 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.538459062576294
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.778 Test Loss: 0.540 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.89080023765564
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.765 Test Loss: 0.557 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.8683881759643555
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.555 Vali Acc: 0.768 Test Loss: 0.555 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.872125864028931
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.765 Test Loss: 0.561 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.917728424072266
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.063574314117432
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.775 Test Loss: 0.562 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.894734621047974
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.051143407821655
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.775 Test Loss: 0.572 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7781569965870307
model parameter : 3867034
model size : 15.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0975182056427
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.708 Vali Acc: 0.526 Test Loss: 0.708 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 3.5328245162963867
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.702 Vali Acc: 0.573 Test Loss: 0.702 Test Acc: 0.573
Validation loss decreased (-0.525590 --> -0.573372).  Saving model ...
Epoch: 3 cost time: 3.9539356231689453
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.680 Vali Acc: 0.608 Test Loss: 0.680 Test Acc: 0.608
Validation loss decreased (-0.573372 --> -0.607502).  Saving model ...
Epoch: 4 cost time: 3.4372708797454834
Epoch: 4, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.684 Vali Acc: 0.611 Test Loss: 0.684 Test Acc: 0.611
Validation loss decreased (-0.607502 --> -0.610915).  Saving model ...
Epoch: 5 cost time: 3.840261936187744
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.677 Vali Acc: 0.614 Test Loss: 0.677 Test Acc: 0.614
Validation loss decreased (-0.610915 --> -0.614328).  Saving model ...
Epoch: 6 cost time: 3.735262155532837
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.697 Vali Acc: 0.625 Test Loss: 0.697 Test Acc: 0.625
Validation loss decreased (-0.614328 --> -0.624566).  Saving model ...
Epoch: 7 cost time: 3.478564500808716
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.721 Vali Acc: 0.621 Test Loss: 0.721 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7120611667633057
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.721 Vali Acc: 0.614 Test Loss: 0.721 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.000948905944824
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.611 Test Loss: 0.740 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.834603786468506
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.611 Test Loss: 0.753 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7529847621917725
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.608 Test Loss: 0.760 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8141214847564697
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.608 Test Loss: 0.771 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7603068351745605
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.608 Test Loss: 0.772 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7903401851654053
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.611 Test Loss: 0.785 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6141927242279053
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.608 Test Loss: 0.790 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.824174642562866
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.608 Test Loss: 0.789 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 3821978
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.831993579864502
Epoch: 1, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.708 Vali Acc: 0.488 Test Loss: 0.708 Test Acc: 0.488
Validation loss decreased (inf --> -0.488048).  Saving model ...
Epoch: 2 cost time: 2.3671774864196777
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.684 Vali Acc: 0.556 Test Loss: 0.684 Test Acc: 0.556
Validation loss decreased (-0.488048 --> -0.556307).  Saving model ...
Epoch: 3 cost time: 2.93540096282959
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.647 Vali Acc: 0.614 Test Loss: 0.647 Test Acc: 0.614
Validation loss decreased (-0.556307 --> -0.614328).  Saving model ...
Epoch: 4 cost time: 3.3234639167785645
Epoch: 4, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.652 Vali Acc: 0.621 Test Loss: 0.652 Test Acc: 0.621
Validation loss decreased (-0.614328 --> -0.621154).  Saving model ...
Epoch: 5 cost time: 2.740323066711426
Epoch: 5, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.642 Vali Acc: 0.642 Test Loss: 0.642 Test Acc: 0.642
Validation loss decreased (-0.621154 --> -0.641632).  Saving model ...
Epoch: 6 cost time: 2.7472522258758545
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.649 Vali Acc: 0.652 Test Loss: 0.649 Test Acc: 0.652
Validation loss decreased (-0.641632 --> -0.651871).  Saving model ...
Epoch: 7 cost time: 2.9663541316986084
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.681 Vali Acc: 0.642 Test Loss: 0.681 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6964271068573
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.689 Vali Acc: 0.659 Test Loss: 0.689 Test Acc: 0.659
Validation loss decreased (-0.651871 --> -0.658696).  Saving model ...
Epoch: 9 cost time: 2.508361339569092
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.704 Vali Acc: 0.642 Test Loss: 0.704 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.406419277191162
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.638 Test Loss: 0.715 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6724860668182373
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.645 Test Loss: 0.727 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7058215141296387
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.734 Vali Acc: 0.635 Test Loss: 0.734 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.054533004760742
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.652 Test Loss: 0.742 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.683897018432617
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.652 Test Loss: 0.751 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8877105712890625
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.638 Test Loss: 0.756 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8356714248657227
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.648 Test Loss: 0.764 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.737513303756714
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.652 Test Loss: 0.771 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.715186595916748
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.659 Test Loss: 0.776 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 3774874
model size : 14.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3183484077453613
Epoch: 1, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.680 Vali Acc: 0.570 Test Loss: 0.680 Test Acc: 0.570
Validation loss decreased (inf --> -0.569959).  Saving model ...
Epoch: 2 cost time: 1.9481256008148193
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.633 Vali Acc: 0.635 Test Loss: 0.633 Test Acc: 0.635
Validation loss decreased (-0.569959 --> -0.634806).  Saving model ...
Epoch: 3 cost time: 2.009758949279785
Epoch: 3, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.589 Vali Acc: 0.683 Test Loss: 0.589 Test Acc: 0.683
Validation loss decreased (-0.634806 --> -0.682588).  Saving model ...
Epoch: 4 cost time: 2.00296688079834
Epoch: 4, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.565 Vali Acc: 0.700 Test Loss: 0.565 Test Acc: 0.700
Validation loss decreased (-0.682588 --> -0.699653).  Saving model ...
Epoch: 5 cost time: 1.8652925491333008
Epoch: 5, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.533 Vali Acc: 0.727 Test Loss: 0.533 Test Acc: 0.727
Validation loss decreased (-0.699653 --> -0.726957).  Saving model ...
Epoch: 6 cost time: 1.863152265548706
Epoch: 6, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.607 Vali Acc: 0.696 Test Loss: 0.607 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.966552495956421
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.726957 --> -0.740609).  Saving model ...
Epoch: 8 cost time: 2.2452571392059326
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2170772552490234
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1732728481292725
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.720 Test Loss: 0.558 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9380404949188232
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.724 Test Loss: 0.560 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9481329917907715
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2642464637756348
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.322309970855713
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.164486885070801
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.734 Test Loss: 0.579 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0058090686798096
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.734 Test Loss: 0.581 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8312747478485107
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.730 Test Loss: 0.587 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 3738010
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.558797597885132
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.688 Vali Acc: 0.577 Test Loss: 0.688 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 1.445951223373413
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.644 Vali Acc: 0.625 Test Loss: 0.644 Test Acc: 0.625
Validation loss decreased (-0.576785 --> -0.624567).  Saving model ...
Epoch: 3 cost time: 1.4072797298431396
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.603 Vali Acc: 0.689 Test Loss: 0.603 Test Acc: 0.689
Validation loss decreased (-0.624567 --> -0.689414).  Saving model ...
Epoch: 4 cost time: 1.5266079902648926
Epoch: 4, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.581 Vali Acc: 0.686 Test Loss: 0.581 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.422647476196289
Epoch: 5, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.595 Vali Acc: 0.689 Test Loss: 0.595 Test Acc: 0.689
Validation loss decreased (-0.689414 --> -0.689414).  Saving model ...
Epoch: 6 cost time: 1.5916199684143066
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.578 Vali Acc: 0.713 Test Loss: 0.578 Test Acc: 0.713
Validation loss decreased (-0.689414 --> -0.713305).  Saving model ...
Epoch: 7 cost time: 1.5074505805969238
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.579 Vali Acc: 0.706 Test Loss: 0.579 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.453883409500122
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.706 Test Loss: 0.585 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5386524200439453
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.706 Test Loss: 0.589 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.519796371459961
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.706 Test Loss: 0.595 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5846340656280518
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.710 Test Loss: 0.599 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4791264533996582
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.706 Test Loss: 0.603 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4440240859985352
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.720 Test Loss: 0.607 Test Acc: 0.720
Validation loss decreased (-0.713305 --> -0.720130).  Saving model ...
Epoch: 14 cost time: 1.5978283882141113
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4732465744018555
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.720 Test Loss: 0.614 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.496657371520996
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.720 Test Loss: 0.617 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6042077541351318
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.727 Test Loss: 0.620 Test Acc: 0.727
Validation loss decreased (-0.720130 --> -0.726956).  Saving model ...
Epoch: 18 cost time: 1.5558090209960938
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.724 Test Loss: 0.622 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.462390661239624
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.724 Test Loss: 0.624 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.494943618774414
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.724 Test Loss: 0.627 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6299612522125244
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.724 Test Loss: 0.630 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6149978637695312
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5029261112213135
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5205538272857666
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4129164218902588
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4462103843688965
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4807238578796387
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.727 Test Loss: 0.645 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.726962457337884
model parameter : 3719578
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.4984381198883057
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.651 Vali Acc: 0.625 Test Loss: 0.651 Test Acc: 0.625
Validation loss decreased (inf --> -0.624567).  Saving model ...
Epoch: 2 cost time: 1.2693688869476318
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.597 Vali Acc: 0.710 Test Loss: 0.597 Test Acc: 0.710
Validation loss decreased (-0.624567 --> -0.709892).  Saving model ...
Epoch: 3 cost time: 1.127089500427246
Epoch: 3, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.523 Vali Acc: 0.744 Test Loss: 0.523 Test Acc: 0.744
Validation loss decreased (-0.709892 --> -0.744022).  Saving model ...
Epoch: 4 cost time: 1.1739232540130615
Epoch: 4, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.487 Vali Acc: 0.768 Test Loss: 0.487 Test Acc: 0.768
Validation loss decreased (-0.744022 --> -0.767913).  Saving model ...
Epoch: 5 cost time: 1.1602706909179688
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.488 Vali Acc: 0.765 Test Loss: 0.488 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2352473735809326
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.496 Vali Acc: 0.761 Test Loss: 0.496 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1621763706207275
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.505 Vali Acc: 0.768 Test Loss: 0.505 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.189457654953003
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.771 Test Loss: 0.515 Test Acc: 0.771
Validation loss decreased (-0.767913 --> -0.771326).  Saving model ...
Epoch: 9 cost time: 1.1703393459320068
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.775 Test Loss: 0.529 Test Acc: 0.775
Validation loss decreased (-0.771326 --> -0.774739).  Saving model ...
Epoch: 10 cost time: 1.0505180358886719
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1346285343170166
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.782 Test Loss: 0.540 Test Acc: 0.782
Validation loss decreased (-0.774739 --> -0.781565).  Saving model ...
Epoch: 12 cost time: 1.292677402496338
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.782 Test Loss: 0.548 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1612718105316162
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.782 Test Loss: 0.554 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.214165210723877
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.782 Test Loss: 0.559 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2124433517456055
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.775 Test Loss: 0.563 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0816903114318848
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.778 Test Loss: 0.568 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1204886436462402
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.778 Test Loss: 0.573 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.098778486251831
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2226486206054688
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.176023006439209
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1720402240753174
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.771 Test Loss: 0.594 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7815699658703071
model parameter : 3701146
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.9057936668395996
Epoch: 1, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.679 Vali Acc: 0.543 Test Loss: 0.679 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 0.7059330940246582
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.634 Vali Acc: 0.621 Test Loss: 0.634 Test Acc: 0.621
Validation loss decreased (-0.542655 --> -0.621154).  Saving model ...
Epoch: 3 cost time: 0.7469537258148193
Epoch: 3, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.592 Vali Acc: 0.659 Test Loss: 0.592 Test Acc: 0.659
Validation loss decreased (-0.621154 --> -0.658697).  Saving model ...
Epoch: 4 cost time: 0.6399295330047607
Epoch: 4, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.569 Vali Acc: 0.693 Test Loss: 0.569 Test Acc: 0.693
Validation loss decreased (-0.658697 --> -0.692827).  Saving model ...
Epoch: 5 cost time: 0.6555337905883789
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.730 Test Loss: 0.586 Test Acc: 0.730
Validation loss decreased (-0.692827 --> -0.730370).  Saving model ...
Epoch: 6 cost time: 0.7843046188354492
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7161762714385986
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.741 Test Loss: 0.606 Test Acc: 0.741
Validation loss decreased (-0.730370 --> -0.740608).  Saving model ...
Epoch: 8 cost time: 0.6979482173919678
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.720 Test Loss: 0.604 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5913496017456055
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7749927043914795
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.724 Test Loss: 0.622 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.765972375869751
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.724 Test Loss: 0.629 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7336199283599854
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6600422859191895
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.730 Test Loss: 0.646 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6690754890441895
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6729328632354736
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6577370166778564
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.730 Test Loss: 0.662 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6721458435058594
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.730 Test Loss: 0.667 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 3684762
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.7974841594696045
Epoch: 1, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.679 Vali Acc: 0.567 Test Loss: 0.679 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 6.626453399658203
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.645 Vali Acc: 0.621 Test Loss: 0.645 Test Acc: 0.621
Validation loss decreased (-0.566546 --> -0.621154).  Saving model ...
Epoch: 3 cost time: 7.125458240509033
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.624 Vali Acc: 0.659 Test Loss: 0.624 Test Acc: 0.659
Validation loss decreased (-0.621154 --> -0.658697).  Saving model ...
Epoch: 4 cost time: 7.044572830200195
Epoch: 4, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.569 Vali Acc: 0.710 Test Loss: 0.569 Test Acc: 0.710
Validation loss decreased (-0.658697 --> -0.709892).  Saving model ...
Epoch: 5 cost time: 7.083557367324829
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
Validation loss decreased (-0.709892 --> -0.740609).  Saving model ...
Epoch: 6 cost time: 6.872502565383911
Epoch: 6, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.163352012634277
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.552 Vali Acc: 0.744 Test Loss: 0.552 Test Acc: 0.744
Validation loss decreased (-0.740609 --> -0.744022).  Saving model ...
Epoch: 8 cost time: 5.674474239349365
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.992117881774902
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.250893831253052
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.407665252685547
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.742041349411011
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
Validation loss decreased (-0.744022 --> -0.750847).  Saving model ...
Epoch: 13 cost time: 6.017825603485107
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.744 Test Loss: 0.579 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.442580461502075
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.747 Test Loss: 0.583 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.324424743652344
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.747 Test Loss: 0.588 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.418104887008667
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.005786657333374
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.744 Test Loss: 0.596 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.370877265930176
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.747 Test Loss: 0.599 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.093760013580322
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.747 Test Loss: 0.605 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.8064963817596436
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.975656509399414
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.744 Test Loss: 0.609 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.0142951011657715
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.741 Test Loss: 0.614 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7508532423208191
model parameter : 3912038
model size : 15.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.9289562702178955
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.711 Vali Acc: 0.519 Test Loss: 0.711 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 4.715256690979004
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.678 Vali Acc: 0.580 Test Loss: 0.678 Test Acc: 0.580
Validation loss decreased (-0.518764 --> -0.580198).  Saving model ...
Epoch: 3 cost time: 5.008400201797485
Epoch: 3, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.646 Vali Acc: 0.621 Test Loss: 0.646 Test Acc: 0.621
Validation loss decreased (-0.580198 --> -0.621154).  Saving model ...
Epoch: 4 cost time: 4.854399681091309
Epoch: 4, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.651 Vali Acc: 0.631 Test Loss: 0.651 Test Acc: 0.631
Validation loss decreased (-0.621154 --> -0.631393).  Saving model ...
Epoch: 5 cost time: 4.88029408454895
Epoch: 5, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.655 Vali Acc: 0.642 Test Loss: 0.655 Test Acc: 0.642
Validation loss decreased (-0.631393 --> -0.641632).  Saving model ...
Epoch: 6 cost time: 4.629328012466431
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.675 Vali Acc: 0.655 Test Loss: 0.675 Test Acc: 0.655
Validation loss decreased (-0.641632 --> -0.655283).  Saving model ...
Epoch: 7 cost time: 5.390676021575928
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.676 Vali Acc: 0.648 Test Loss: 0.676 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.063857555389404
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.669 Vali Acc: 0.662 Test Loss: 0.669 Test Acc: 0.662
Validation loss decreased (-0.655283 --> -0.662109).  Saving model ...
Epoch: 9 cost time: 4.623626947402954
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.659 Test Loss: 0.693 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.534517765045166
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.687 Vali Acc: 0.666 Test Loss: 0.687 Test Acc: 0.666
Validation loss decreased (-0.662109 --> -0.665522).  Saving model ...
Epoch: 11 cost time: 4.9407806396484375
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.662 Test Loss: 0.713 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.842125415802002
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.672 Test Loss: 0.704 Test Acc: 0.672
Validation loss decreased (-0.665522 --> -0.672348).  Saving model ...
Epoch: 13 cost time: 4.960275650024414
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.672 Test Loss: 0.707 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.81960654258728
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.672 Test Loss: 0.715 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.93044114112854
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.683 Test Loss: 0.716 Test Acc: 0.683
Validation loss decreased (-0.672348 --> -0.682587).  Saving model ...
Epoch: 16 cost time: 4.744379997253418
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.683 Test Loss: 0.719 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.266411542892456
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.683 Test Loss: 0.725 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.091118574142456
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.689 Test Loss: 0.729 Test Acc: 0.689
Validation loss decreased (-0.682587 --> -0.689413).  Saving model ...
Epoch: 19 cost time: 4.955529451370239
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.686 Test Loss: 0.736 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.990607261657715
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.686 Test Loss: 0.738 Test Acc: 0.686
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.856600284576416
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.689 Test Loss: 0.742 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.943661689758301
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.689 Test Loss: 0.740 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.079677581787109
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.693 Test Loss: 0.746 Test Acc: 0.693
Validation loss decreased (-0.689413 --> -0.692825).  Saving model ...
Epoch: 24 cost time: 4.985651254653931
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.693 Test Loss: 0.748 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.009934186935425
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.693 Test Loss: 0.751 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.33878755569458
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.686 Test Loss: 0.755 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.6674206256866455
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.689 Test Loss: 0.756 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.997301816940308
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.686 Test Loss: 0.760 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.836599111557007
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.689 Test Loss: 0.760 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.437595367431641
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.686 Test Loss: 0.762 Test Acc: 0.686
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.478172540664673
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.686 Test Loss: 0.768 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.558340072631836
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.689 Test Loss: 0.773 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.973055362701416
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.689 Test Loss: 0.774 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6928327645051194
model parameter : 3866982
model size : 15.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.172037839889526
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.673 Vali Acc: 0.573 Test Loss: 0.673 Test Acc: 0.573
Validation loss decreased (inf --> -0.573372).  Saving model ...
Epoch: 2 cost time: 3.9392309188842773
Epoch: 2, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.689 Vali Acc: 0.563 Test Loss: 0.689 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.282517671585083
Epoch: 3, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.635 Vali Acc: 0.642 Test Loss: 0.635 Test Acc: 0.642
Validation loss decreased (-0.573372 --> -0.641632).  Saving model ...
Epoch: 4 cost time: 3.8012046813964844
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.613 Vali Acc: 0.676 Test Loss: 0.613 Test Acc: 0.676
Validation loss decreased (-0.641632 --> -0.675762).  Saving model ...
Epoch: 5 cost time: 3.8040754795074463
Epoch: 5, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.589 Vali Acc: 0.706 Test Loss: 0.589 Test Acc: 0.706
Validation loss decreased (-0.675762 --> -0.706479).  Saving model ...
Epoch: 6 cost time: 4.237368106842041
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.587 Vali Acc: 0.696 Test Loss: 0.587 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.125129222869873
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.622 Vali Acc: 0.676 Test Loss: 0.622 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.513845920562744
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.623 Vali Acc: 0.676 Test Loss: 0.623 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.311079978942871
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.689 Test Loss: 0.627 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.4535956382751465
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.693 Test Loss: 0.636 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.214804172515869
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.689 Test Loss: 0.645 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.284806251525879
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.696 Test Loss: 0.650 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.427489519119263
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.696 Test Loss: 0.656 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.346061944961548
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.700 Test Loss: 0.659 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.281327486038208
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.700 Test Loss: 0.665 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7064846416382252
model parameter : 3821926
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.222886323928833
Epoch: 1, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.697 Vali Acc: 0.519 Test Loss: 0.697 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 2.8446128368377686
Epoch: 2, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.631 Vali Acc: 0.655 Test Loss: 0.631 Test Acc: 0.655
Validation loss decreased (-0.518764 --> -0.655284).  Saving model ...
Epoch: 3 cost time: 3.1980173587799072
Epoch: 3, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.574 Vali Acc: 0.713 Test Loss: 0.574 Test Acc: 0.713
Validation loss decreased (-0.655284 --> -0.713305).  Saving model ...
Epoch: 4 cost time: 3.469567060470581
Epoch: 4, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.548 Vali Acc: 0.724 Test Loss: 0.548 Test Acc: 0.724
Validation loss decreased (-0.713305 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 3.0893142223358154
Epoch: 5, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.539 Vali Acc: 0.754 Test Loss: 0.539 Test Acc: 0.754
Validation loss decreased (-0.723544 --> -0.754261).  Saving model ...
Epoch: 6 cost time: 3.0696442127227783
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2037928104400635
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.754 Test Loss: 0.534 Test Acc: 0.754
Validation loss decreased (-0.754261 --> -0.754261).  Saving model ...
Epoch: 8 cost time: 3.0518743991851807
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.316974639892578
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.747 Test Loss: 0.548 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1447055339813232
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.754 Test Loss: 0.553 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.097259283065796
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.754 Test Loss: 0.556 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.081211566925049
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.747 Test Loss: 0.558 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3812448978424072
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.758 Test Loss: 0.561 Test Acc: 0.758
Validation loss decreased (-0.754261 --> -0.757674).  Saving model ...
Epoch: 14 cost time: 3.178403377532959
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2195677757263184
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.758 Test Loss: 0.568 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1061155796051025
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.754 Test Loss: 0.573 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6904633045196533
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1225507259368896
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.754 Test Loss: 0.577 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.825502634048462
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.754 Test Loss: 0.580 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7992215156555176
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5551235675811768
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.747 Test Loss: 0.589 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0275118350982666
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.758 Test Loss: 0.586 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3846800327301025
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.757679180887372
model parameter : 3774822
model size : 14.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4833593368530273
Epoch: 1, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.656 Vali Acc: 0.611 Test Loss: 0.656 Test Acc: 0.611
Validation loss decreased (inf --> -0.610915).  Saving model ...
Epoch: 2 cost time: 1.991347312927246
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.594 Vali Acc: 0.696 Test Loss: 0.594 Test Acc: 0.696
Validation loss decreased (-0.610915 --> -0.696240).  Saving model ...
Epoch: 3 cost time: 2.0681872367858887
Epoch: 3, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.571 Vali Acc: 0.713 Test Loss: 0.571 Test Acc: 0.713
Validation loss decreased (-0.696240 --> -0.713305).  Saving model ...
Epoch: 4 cost time: 2.169447898864746
Epoch: 4, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.532 Vali Acc: 0.717 Test Loss: 0.532 Test Acc: 0.717
Validation loss decreased (-0.713305 --> -0.716718).  Saving model ...
Epoch: 5 cost time: 2.0477893352508545
Epoch: 5, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
Validation loss decreased (-0.716718 --> -0.750848).  Saving model ...
Epoch: 6 cost time: 1.795346736907959
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.545 Vali Acc: 0.734 Test Loss: 0.545 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.817664623260498
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.724 Test Loss: 0.544 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.894313097000122
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.784942865371704
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.730 Test Loss: 0.556 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7603423595428467
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.744 Test Loss: 0.559 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.015986204147339
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.744 Test Loss: 0.565 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8378899097442627
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9334256649017334
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.744 Test Loss: 0.574 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.014143466949463
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.747 Test Loss: 0.579 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.085864782333374
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7508532423208191
model parameter : 3737958
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.926787853240967
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.729 Vali Acc: 0.495 Test Loss: 0.729 Test Acc: 0.495
Validation loss decreased (inf --> -0.494873).  Saving model ...
Epoch: 2 cost time: 1.4302139282226562
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.664 Vali Acc: 0.580 Test Loss: 0.664 Test Acc: 0.580
Validation loss decreased (-0.494873 --> -0.580198).  Saving model ...
Epoch: 3 cost time: 1.3835606575012207
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.594 Vali Acc: 0.686 Test Loss: 0.594 Test Acc: 0.686
Validation loss decreased (-0.580198 --> -0.686001).  Saving model ...
Epoch: 4 cost time: 1.474879503250122
Epoch: 4, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.573 Vali Acc: 0.696 Test Loss: 0.573 Test Acc: 0.696
Validation loss decreased (-0.686001 --> -0.696240).  Saving model ...
Epoch: 5 cost time: 1.4788293838500977
Epoch: 5, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.585 Vali Acc: 0.713 Test Loss: 0.585 Test Acc: 0.713
Validation loss decreased (-0.696240 --> -0.713305).  Saving model ...
Epoch: 6 cost time: 1.7193903923034668
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.627 Vali Acc: 0.720 Test Loss: 0.627 Test Acc: 0.720
Validation loss decreased (-0.713305 --> -0.720130).  Saving model ...
Epoch: 7 cost time: 1.4464170932769775
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.730 Test Loss: 0.627 Test Acc: 0.730
Validation loss decreased (-0.720130 --> -0.730369).  Saving model ...
Epoch: 8 cost time: 1.6236755847930908
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4600579738616943
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.724 Test Loss: 0.661 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3810508251190186
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.673 Vali Acc: 0.720 Test Loss: 0.673 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3486964702606201
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.734 Test Loss: 0.682 Test Acc: 0.734
Validation loss decreased (-0.730369 --> -0.733782).  Saving model ...
Epoch: 12 cost time: 1.5055763721466064
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.730 Test Loss: 0.691 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3386433124542236
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.741 Test Loss: 0.702 Test Acc: 0.741
Validation loss decreased (-0.733782 --> -0.740607).  Saving model ...
Epoch: 14 cost time: 1.4377989768981934
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.734 Test Loss: 0.707 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6311149597167969
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.734 Test Loss: 0.714 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5581557750701904
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.741 Test Loss: 0.720 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6597120761871338
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.680798053741455
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.737 Test Loss: 0.733 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.627638578414917
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.550842046737671
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.737 Test Loss: 0.745 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5535507202148438
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.741 Test Loss: 0.750 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.606696605682373
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.702761173248291
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.741 Test Loss: 0.760 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 3719526
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.649817705154419
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.645 Vali Acc: 0.611 Test Loss: 0.645 Test Acc: 0.611
Validation loss decreased (inf --> -0.610915).  Saving model ...
Epoch: 2 cost time: 1.2646458148956299
Epoch: 2, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (-0.610915 --> -0.716718).  Saving model ...
Epoch: 3 cost time: 1.3294899463653564
Epoch: 3, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.506 Vali Acc: 0.754 Test Loss: 0.506 Test Acc: 0.754
Validation loss decreased (-0.716718 --> -0.754261).  Saving model ...
Epoch: 4 cost time: 1.2505853176116943
Epoch: 4, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.461 Vali Acc: 0.771 Test Loss: 0.461 Test Acc: 0.771
Validation loss decreased (-0.754261 --> -0.771326).  Saving model ...
Epoch: 5 cost time: 1.2049686908721924
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.496 Vali Acc: 0.765 Test Loss: 0.496 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3360426425933838
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.758 Test Loss: 0.477 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2143404483795166
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.765 Test Loss: 0.504 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.266810655593872
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.758 Test Loss: 0.517 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2069802284240723
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.765 Test Loss: 0.531 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2321128845214844
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.758 Test Loss: 0.529 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1799075603485107
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.768 Test Loss: 0.539 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2167434692382812
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.768 Test Loss: 0.539 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0922937393188477
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.768 Test Loss: 0.552 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2061285972595215
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.768 Test Loss: 0.553 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7713310580204779
model parameter : 3701094
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.8363168239593506
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (inf --> -0.559720).  Saving model ...
Epoch: 2 cost time: 0.7041103839874268
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.681 Vali Acc: 0.590 Test Loss: 0.681 Test Acc: 0.590
Validation loss decreased (-0.559720 --> -0.590437).  Saving model ...
Epoch: 3 cost time: 0.8637773990631104
Epoch: 3, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.588 Vali Acc: 0.693 Test Loss: 0.588 Test Acc: 0.693
Validation loss decreased (-0.590437 --> -0.692827).  Saving model ...
Epoch: 4 cost time: 0.802819013595581
Epoch: 4, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.620 Vali Acc: 0.693 Test Loss: 0.620 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8142282962799072
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.706 Test Loss: 0.626 Test Acc: 0.706
Validation loss decreased (-0.692827 --> -0.706478).  Saving model ...
Epoch: 6 cost time: 0.7258832454681396
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.713 Test Loss: 0.652 Test Acc: 0.713
Validation loss decreased (-0.706478 --> -0.713304).  Saving model ...
Epoch: 7 cost time: 0.7061276435852051
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.713 Test Loss: 0.671 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7622954845428467
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.713304 --> -0.716717).  Saving model ...
Epoch: 9 cost time: 0.7351565361022949
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8128113746643066
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.720 Test Loss: 0.711 Test Acc: 0.720
Validation loss decreased (-0.716717 --> -0.720129).  Saving model ...
Epoch: 11 cost time: 0.8670263290405273
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.713 Test Loss: 0.723 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8272998332977295
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.720 Test Loss: 0.734 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6802043914794922
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.720 Test Loss: 0.746 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9177162647247314
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.720 Test Loss: 0.756 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8490808010101318
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.720 Test Loss: 0.766 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7423639297485352
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.724 Test Loss: 0.777 Test Acc: 0.724
Validation loss decreased (-0.720129 --> -0.723542).  Saving model ...
Epoch: 17 cost time: 0.9488041400909424
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.720 Test Loss: 0.786 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8999714851379395
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.706 Test Loss: 0.794 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7210507392883301
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.706 Test Loss: 0.803 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7383990287780762
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.713 Test Loss: 0.812 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6964542865753174
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.710 Test Loss: 0.820 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5598108768463135
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.710 Test Loss: 0.827 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7078378200531006
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.710 Test Loss: 0.835 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7055375576019287
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.710 Test Loss: 0.842 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8170900344848633
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.710 Test Loss: 0.849 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8345458507537842
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.710 Test Loss: 0.857 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7235494880546075
model parameter : 3684710
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.659380197525024
Epoch: 1, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (inf --> -0.559720).  Saving model ...
Epoch: 2 cost time: 6.286316156387329
Epoch: 2, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.650 Vali Acc: 0.638 Test Loss: 0.650 Test Acc: 0.638
Validation loss decreased (-0.559720 --> -0.638219).  Saving model ...
Epoch: 3 cost time: 5.848419427871704
Epoch: 3, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.616 Vali Acc: 0.642 Test Loss: 0.616 Test Acc: 0.642
Validation loss decreased (-0.638219 --> -0.641632).  Saving model ...
Epoch: 4 cost time: 6.307218790054321
Epoch: 4, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.617 Vali Acc: 0.642 Test Loss: 0.617 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.007742643356323
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.629 Vali Acc: 0.662 Test Loss: 0.629 Test Acc: 0.662
Validation loss decreased (-0.641632 --> -0.662110).  Saving model ...
Epoch: 6 cost time: 5.9227166175842285
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.605 Vali Acc: 0.683 Test Loss: 0.605 Test Acc: 0.683
Validation loss decreased (-0.662110 --> -0.682588).  Saving model ...
Epoch: 7 cost time: 5.919294595718384
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.628 Vali Acc: 0.645 Test Loss: 0.628 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.360997915267944
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.669 Test Loss: 0.623 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.2581682205200195
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.672 Test Loss: 0.632 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.494579076766968
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.669 Test Loss: 0.638 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.065020322799683
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.659 Test Loss: 0.640 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.835769176483154
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.662 Test Loss: 0.647 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.867879152297974
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.659 Test Loss: 0.645 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.990379571914673
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.666 Test Loss: 0.650 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.5017712116241455
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.666 Test Loss: 0.657 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.738648176193237
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.662 Test Loss: 0.660 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6825938566552902
model parameter : 3911974
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.038309335708618
Epoch: 1, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.688 Vali Acc: 0.529 Test Loss: 0.688 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 4.928346872329712
Epoch: 2, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.627 Vali Acc: 0.631 Test Loss: 0.627 Test Acc: 0.631
Validation loss decreased (-0.529003 --> -0.631393).  Saving model ...
Epoch: 3 cost time: 4.837016344070435
Epoch: 3, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.602 Vali Acc: 0.672 Test Loss: 0.602 Test Acc: 0.672
Validation loss decreased (-0.631393 --> -0.672349).  Saving model ...
Epoch: 4 cost time: 4.7246012687683105
Epoch: 4, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.581 Vali Acc: 0.700 Test Loss: 0.581 Test Acc: 0.700
Validation loss decreased (-0.672349 --> -0.699653).  Saving model ...
Epoch: 5 cost time: 4.783682346343994
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.591 Vali Acc: 0.686 Test Loss: 0.591 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.833072662353516
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.689 Test Loss: 0.591 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.044647216796875
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.693 Test Loss: 0.596 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.5966503620147705
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.693 Test Loss: 0.591 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.12391209602356
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.689 Test Loss: 0.593 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.6620118618011475
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.693 Test Loss: 0.596 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.912113428115845
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.686 Test Loss: 0.596 Test Acc: 0.686
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.841444492340088
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.700 Test Loss: 0.601 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.331896066665649
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.700 Test Loss: 0.602 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.555973291397095
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.696 Test Loss: 0.605 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 3866918
model size : 15.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.4032957553863525
Epoch: 1, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.678 Vali Acc: 0.509 Test Loss: 0.678 Test Acc: 0.509
Validation loss decreased (inf --> -0.508526).  Saving model ...
Epoch: 2 cost time: 4.265907049179077
Epoch: 2, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.622 Vali Acc: 0.621 Test Loss: 0.622 Test Acc: 0.621
Validation loss decreased (-0.508526 --> -0.621154).  Saving model ...
Epoch: 3 cost time: 4.249673843383789
Epoch: 3, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.607 Vali Acc: 0.676 Test Loss: 0.607 Test Acc: 0.676
Validation loss decreased (-0.621154 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 4.293982028961182
Epoch: 4, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.609 Vali Acc: 0.700 Test Loss: 0.609 Test Acc: 0.700
Validation loss decreased (-0.675762 --> -0.699653).  Saving model ...
Epoch: 5 cost time: 4.4908998012542725
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.618 Vali Acc: 0.693 Test Loss: 0.618 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.290104389190674
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.689 Test Loss: 0.621 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.110459089279175
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.693 Test Loss: 0.624 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.1201934814453125
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.696 Test Loss: 0.625 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1176323890686035
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.700 Test Loss: 0.629 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1718785762786865
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.700 Test Loss: 0.635 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.094336271286011
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.696 Test Loss: 0.642 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.373002767562866
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.689 Test Loss: 0.644 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.431982040405273
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.693 Test Loss: 0.645 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.056168794631958
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.693 Test Loss: 0.648 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 3821862
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.449947118759155
Epoch: 1, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.693 Vali Acc: 0.539 Test Loss: 0.693 Test Acc: 0.539
Validation loss decreased (inf --> -0.539242).  Saving model ...
Epoch: 2 cost time: 2.976720094680786
Epoch: 2, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.632 Vali Acc: 0.642 Test Loss: 0.632 Test Acc: 0.642
Validation loss decreased (-0.539242 --> -0.641632).  Saving model ...
Epoch: 3 cost time: 3.0997116565704346
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.598 Vali Acc: 0.703 Test Loss: 0.598 Test Acc: 0.703
Validation loss decreased (-0.641632 --> -0.703066).  Saving model ...
Epoch: 4 cost time: 2.9984724521636963
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.586 Vali Acc: 0.713 Test Loss: 0.586 Test Acc: 0.713
Validation loss decreased (-0.703066 --> -0.713305).  Saving model ...
Epoch: 5 cost time: 2.927701711654663
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (-0.713305 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 2.745577573776245
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (-0.716718 --> -0.716718).  Saving model ...
Epoch: 7 cost time: 2.825228214263916
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.730 Test Loss: 0.598 Test Acc: 0.730
Validation loss decreased (-0.716718 --> -0.730369).  Saving model ...
Epoch: 8 cost time: 2.648355722427368
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.572122812271118
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.730 Test Loss: 0.602 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.411402702331543
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
Validation loss decreased (-0.730369 --> -0.733782).  Saving model ...
Epoch: 11 cost time: 2.6780269145965576
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.734 Test Loss: 0.606 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.78596830368042
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.734 Test Loss: 0.609 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0198068618774414
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.730 Test Loss: 0.610 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.899348735809326
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.734 Test Loss: 0.613 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.860426187515259
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.733782 --> -0.737195).  Saving model ...
Epoch: 16 cost time: 2.6843864917755127
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.024700164794922
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.983577013015747
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7801473140716553
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9379498958587646
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.737 Test Loss: 0.623 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.687551736831665
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
Validation loss decreased (-0.737195 --> -0.740608).  Saving model ...
Epoch: 22 cost time: 2.878216028213501
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9171953201293945
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.734 Test Loss: 0.627 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7680513858795166
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.734 Test Loss: 0.627 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.665473699569702
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.734 Test Loss: 0.629 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.669288158416748
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.734 Test Loss: 0.630 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.973752737045288
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.730 Test Loss: 0.632 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.861060857772827
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.9378037452697754
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.8472466468811035
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.734 Test Loss: 0.636 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.7842094898223877
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.730 Test Loss: 0.637 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 3774758
model size : 14.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4099154472351074
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.686 Vali Acc: 0.577 Test Loss: 0.686 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 1.7235302925109863
Epoch: 2, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.632 Vali Acc: 0.648 Test Loss: 0.632 Test Acc: 0.648
Validation loss decreased (-0.576785 --> -0.648458).  Saving model ...
Epoch: 3 cost time: 1.6727309226989746
Epoch: 3, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.614 Vali Acc: 0.676 Test Loss: 0.614 Test Acc: 0.676
Validation loss decreased (-0.648458 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 1.8911724090576172
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.608 Vali Acc: 0.683 Test Loss: 0.608 Test Acc: 0.683
Validation loss decreased (-0.675762 --> -0.682588).  Saving model ...
Epoch: 5 cost time: 1.678720235824585
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.672 Test Loss: 0.610 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8690061569213867
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.672 Test Loss: 0.611 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8400473594665527
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.676 Test Loss: 0.612 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7072956562042236
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.669 Test Loss: 0.609 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8639602661132812
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.676 Test Loss: 0.612 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8849201202392578
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.679 Test Loss: 0.615 Test Acc: 0.679
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9880077838897705
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.689 Test Loss: 0.614 Test Acc: 0.689
Validation loss decreased (-0.682588 --> -0.689414).  Saving model ...
Epoch: 12 cost time: 2.075424909591675
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.693 Test Loss: 0.617 Test Acc: 0.693
Validation loss decreased (-0.689414 --> -0.692827).  Saving model ...
Epoch: 13 cost time: 1.8623392581939697
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.689 Test Loss: 0.619 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6556692123413086
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.689 Test Loss: 0.621 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.821779727935791
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.689 Test Loss: 0.622 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9893712997436523
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.689 Test Loss: 0.623 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.085214138031006
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.693 Test Loss: 0.623 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0532689094543457
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.689 Test Loss: 0.625 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9964487552642822
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7840847969055176
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.696 Test Loss: 0.628 Test Acc: 0.696
Validation loss decreased (-0.692827 --> -0.696239).  Saving model ...
Epoch: 21 cost time: 1.8227150440216064
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.700 Test Loss: 0.629 Test Acc: 0.700
Validation loss decreased (-0.696239 --> -0.699652).  Saving model ...
Epoch: 22 cost time: 2.1688528060913086
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.700 Test Loss: 0.630 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8873004913330078
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.696 Test Loss: 0.631 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9355430603027344
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.700 Test Loss: 0.633 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.784576416015625
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.700 Test Loss: 0.634 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.006446599960327
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.700 Test Loss: 0.636 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.01729679107666
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.700 Test Loss: 0.637 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1799042224884033
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.696 Test Loss: 0.638 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9932386875152588
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.696 Test Loss: 0.639 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.941392421722412
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.696 Test Loss: 0.641 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9997482299804688
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.696 Test Loss: 0.642 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 3737894
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1424660682678223
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.683 Vali Acc: 0.584 Test Loss: 0.683 Test Acc: 0.584
Validation loss decreased (inf --> -0.583611).  Saving model ...
Epoch: 2 cost time: 1.6797034740447998
Epoch: 2, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.626 Vali Acc: 0.672 Test Loss: 0.626 Test Acc: 0.672
Validation loss decreased (-0.583611 --> -0.672349).  Saving model ...
Epoch: 3 cost time: 1.5158677101135254
Epoch: 3, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.607 Vali Acc: 0.693 Test Loss: 0.607 Test Acc: 0.693
Validation loss decreased (-0.672349 --> -0.692827).  Saving model ...
Epoch: 4 cost time: 1.6802074909210205
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.689 Test Loss: 0.602 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7521324157714844
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.689 Test Loss: 0.604 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5807628631591797
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.693 Test Loss: 0.610 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5744001865386963
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.693 Test Loss: 0.612 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.533940076828003
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.700 Test Loss: 0.618 Test Acc: 0.700
Validation loss decreased (-0.692827 --> -0.699653).  Saving model ...
Epoch: 9 cost time: 1.671053409576416
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.696 Test Loss: 0.621 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.396679401397705
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.696 Test Loss: 0.622 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4499468803405762
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.696 Test Loss: 0.627 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6206855773925781
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.696 Test Loss: 0.631 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.504575490951538
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.689 Test Loss: 0.634 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6518709659576416
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.696 Test Loss: 0.636 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4948434829711914
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.696 Test Loss: 0.638 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5412676334381104
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.689 Test Loss: 0.641 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5502824783325195
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.696 Test Loss: 0.644 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6191275119781494
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.693 Test Loss: 0.647 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 3719462
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.424607276916504
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.688 Vali Acc: 0.536 Test Loss: 0.688 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 0.9629538059234619
Epoch: 2, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.609 Vali Acc: 0.652 Test Loss: 0.609 Test Acc: 0.652
Validation loss decreased (-0.535829 --> -0.651871).  Saving model ...
Epoch: 3 cost time: 1.2130186557769775
Epoch: 3, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.603 Vali Acc: 0.666 Test Loss: 0.603 Test Acc: 0.666
Validation loss decreased (-0.651871 --> -0.665523).  Saving model ...
Epoch: 4 cost time: 1.1086010932922363
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.693 Test Loss: 0.602 Test Acc: 0.693
Validation loss decreased (-0.665523 --> -0.692827).  Saving model ...
Epoch: 5 cost time: 1.166741132736206
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.696 Test Loss: 0.596 Test Acc: 0.696
Validation loss decreased (-0.692827 --> -0.696240).  Saving model ...
Epoch: 6 cost time: 1.1838133335113525
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.689 Test Loss: 0.597 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0876379013061523
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.686 Test Loss: 0.596 Test Acc: 0.686
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0990431308746338
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.686 Test Loss: 0.599 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.062110424041748
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.689 Test Loss: 0.602 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0829358100891113
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.693 Test Loss: 0.603 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0764572620391846
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.696 Test Loss: 0.605 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0163204669952393
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.700 Test Loss: 0.606 Test Acc: 0.700
Validation loss decreased (-0.696240 --> -0.699653).  Saving model ...
Epoch: 13 cost time: 1.1280007362365723
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.696 Test Loss: 0.609 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.103222131729126
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.703 Test Loss: 0.610 Test Acc: 0.703
Validation loss decreased (-0.699653 --> -0.703066).  Saving model ...
Epoch: 15 cost time: 1.067542552947998
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.706 Test Loss: 0.614 Test Acc: 0.706
Validation loss decreased (-0.703066 --> -0.706479).  Saving model ...
Epoch: 16 cost time: 1.0449492931365967
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.706 Test Loss: 0.614 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0898308753967285
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.710 Test Loss: 0.616 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709891).  Saving model ...
Epoch: 18 cost time: 1.1266074180603027
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.710 Test Loss: 0.618 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.047931432723999
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.706 Test Loss: 0.620 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.15924072265625
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.710 Test Loss: 0.621 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1672313213348389
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.706 Test Loss: 0.624 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3055744171142578
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.710 Test Loss: 0.625 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.138723611831665
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (-0.709891 --> -0.716717).  Saving model ...
Epoch: 24 cost time: 1.059358835220337
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0927848815917969
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.185793399810791
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1256804466247559
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2016491889953613
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.713 Test Loss: 0.636 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2089157104492188
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.713 Test Loss: 0.637 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9571893215179443
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0067250728607178
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0856847763061523
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.060523509979248
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7167235494880546
model parameter : 3701030
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.7262508869171143
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.642 Vali Acc: 0.635 Test Loss: 0.642 Test Acc: 0.635
Validation loss decreased (inf --> -0.634806).  Saving model ...
Epoch: 2 cost time: 0.6289384365081787
Epoch: 2, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.579 Vali Acc: 0.703 Test Loss: 0.579 Test Acc: 0.703
Validation loss decreased (-0.634806 --> -0.703066).  Saving model ...
Epoch: 3 cost time: 0.5874931812286377
Epoch: 3, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.679 Test Loss: 0.584 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6815371513366699
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.669 Test Loss: 0.599 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.544658899307251
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.672 Test Loss: 0.597 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6464297771453857
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.679 Test Loss: 0.597 Test Acc: 0.679
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5571234226226807
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.679 Test Loss: 0.600 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6429996490478516
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.679 Test Loss: 0.601 Test Acc: 0.679
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.598912239074707
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.686 Test Loss: 0.602 Test Acc: 0.686
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5625395774841309
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.689 Test Loss: 0.603 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5839951038360596
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.686 Test Loss: 0.606 Test Acc: 0.686
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6389985084533691
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.689 Test Loss: 0.608 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7030716723549488
model parameter : 3684646
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.261687517166138
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.711 Vali Acc: 0.509 Test Loss: 0.711 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.939789772033691
Epoch: 2, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.685 Vali Acc: 0.570 Test Loss: 0.685 Test Acc: 0.570
Validation loss decreased (-0.508525 --> -0.569959).  Saving model ...
Epoch: 3 cost time: 6.254331111907959
Epoch: 3, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.669 Vali Acc: 0.573 Test Loss: 0.669 Test Acc: 0.573
Validation loss decreased (-0.569959 --> -0.573372).  Saving model ...
Epoch: 4 cost time: 6.481051921844482
Epoch: 4, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.629 Vali Acc: 0.662 Test Loss: 0.629 Test Acc: 0.662
Validation loss decreased (-0.573372 --> -0.662110).  Saving model ...
Epoch: 5 cost time: 6.711657762527466
Epoch: 5, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.625 Vali Acc: 0.638 Test Loss: 0.625 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.923518896102905
Epoch: 6, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.618 Vali Acc: 0.659 Test Loss: 0.618 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.459160327911377
Epoch: 7, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.620 Vali Acc: 0.676 Test Loss: 0.620 Test Acc: 0.676
Validation loss decreased (-0.662110 --> -0.675762).  Saving model ...
Epoch: 8 cost time: 5.7968244552612305
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.626 Vali Acc: 0.683 Test Loss: 0.626 Test Acc: 0.683
Validation loss decreased (-0.675762 --> -0.682588).  Saving model ...
Epoch: 9 cost time: 6.41309666633606
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.696 Test Loss: 0.625 Test Acc: 0.696
Validation loss decreased (-0.682588 --> -0.696239).  Saving model ...
Epoch: 10 cost time: 6.568412780761719
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.638 Vali Acc: 0.683 Test Loss: 0.638 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.293546438217163
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.693 Test Loss: 0.638 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.250664234161377
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.700 Test Loss: 0.648 Test Acc: 0.700
Validation loss decreased (-0.696239 --> -0.699652).  Saving model ...
Epoch: 13 cost time: 6.643632888793945
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.693 Test Loss: 0.653 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.569159507751465
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.696 Test Loss: 0.657 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.286184787750244
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.696 Test Loss: 0.663 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.757936954498291
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.703 Test Loss: 0.667 Test Acc: 0.703
Validation loss decreased (-0.699652 --> -0.703065).  Saving model ...
Epoch: 17 cost time: 5.923668146133423
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.696 Test Loss: 0.668 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.388248443603516
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.696 Test Loss: 0.673 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.141338586807251
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.693 Test Loss: 0.675 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.511334419250488
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.693 Test Loss: 0.678 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.019063949584961
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.696 Test Loss: 0.680 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.153275012969971
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.689 Test Loss: 0.684 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.518239259719849
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.689 Test Loss: 0.686 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.389224052429199
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.686 Test Loss: 0.691 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.596185207366943
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.686 Test Loss: 0.693 Test Acc: 0.686
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.9016571044921875
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.689 Test Loss: 0.694 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7030716723549488
model parameter : 1962394
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.206484794616699
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.704 Vali Acc: 0.519 Test Loss: 0.704 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 5.046298027038574
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.746 Vali Acc: 0.519 Test Loss: 0.746 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7828216552734375
Epoch: 3, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.625 Vali Acc: 0.659 Test Loss: 0.625 Test Acc: 0.659
Validation loss decreased (-0.518764 --> -0.658697).  Saving model ...
Epoch: 4 cost time: 5.490785598754883
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.605 Vali Acc: 0.669 Test Loss: 0.605 Test Acc: 0.669
Validation loss decreased (-0.658697 --> -0.668936).  Saving model ...
Epoch: 5 cost time: 4.884887456893921
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.591 Vali Acc: 0.696 Test Loss: 0.591 Test Acc: 0.696
Validation loss decreased (-0.668936 --> -0.696240).  Saving model ...
Epoch: 6 cost time: 5.131639003753662
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.575 Vali Acc: 0.710 Test Loss: 0.575 Test Acc: 0.710
Validation loss decreased (-0.696240 --> -0.709892).  Saving model ...
Epoch: 7 cost time: 4.995959281921387
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.580 Vali Acc: 0.703 Test Loss: 0.580 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.613406181335449
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.593 Vali Acc: 0.703 Test Loss: 0.593 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.057715177536011
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.589 Vali Acc: 0.720 Test Loss: 0.589 Test Acc: 0.720
Validation loss decreased (-0.709892 --> -0.720131).  Saving model ...
Epoch: 10 cost time: 4.968390703201294
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.710 Test Loss: 0.594 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.196435213088989
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.706 Test Loss: 0.600 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.137324094772339
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.606 Vali Acc: 0.703 Test Loss: 0.606 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.892476558685303
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.703 Test Loss: 0.609 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.732177734375
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.703 Test Loss: 0.613 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.9035484790802
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.703 Test Loss: 0.619 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.06774640083313
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.710 Test Loss: 0.622 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.167769432067871
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.710 Test Loss: 0.626 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.262784481048584
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.710 Test Loss: 0.630 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.966181039810181
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.713 Test Loss: 0.632 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7201365187713311
model parameter : 1939866
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.314807415008545
Epoch: 1, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.724 Vali Acc: 0.515 Test Loss: 0.724 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 3.6076745986938477
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.694 Vali Acc: 0.536 Test Loss: 0.694 Test Acc: 0.536
Validation loss decreased (-0.515351 --> -0.535829).  Saving model ...
Epoch: 3 cost time: 4.025346994400024
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.643 Vali Acc: 0.608 Test Loss: 0.643 Test Acc: 0.608
Validation loss decreased (-0.535829 --> -0.607502).  Saving model ...
Epoch: 4 cost time: 4.067487955093384
Epoch: 4, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.590 Vali Acc: 0.686 Test Loss: 0.590 Test Acc: 0.686
Validation loss decreased (-0.607502 --> -0.686001).  Saving model ...
Epoch: 5 cost time: 4.19350528717041
Epoch: 5, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
Validation loss decreased (-0.686001 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 4.396099805831909
Epoch: 6, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.548 Vali Acc: 0.720 Test Loss: 0.548 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720131).  Saving model ...
Epoch: 7 cost time: 4.004051446914673
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
Validation loss decreased (-0.720131 --> -0.726957).  Saving model ...
Epoch: 8 cost time: 4.130033731460571
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.801219940185547
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.549 Vali Acc: 0.730 Test Loss: 0.549 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 10 cost time: 4.2139060497283936
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.552 Vali Acc: 0.713 Test Loss: 0.552 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.529334783554077
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.720 Test Loss: 0.551 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.363548994064331
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.724 Test Loss: 0.555 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.44425892829895
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.558 Vali Acc: 0.727 Test Loss: 0.558 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.635265111923218
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.364252328872681
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.730 Test Loss: 0.562 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.09670352935791
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.51948618888855
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.730 Test Loss: 0.565 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.515202522277832
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.692526340484619
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7303754266211604
model parameter : 1917338
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.338238954544067
Epoch: 1, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.683 Vali Acc: 0.573 Test Loss: 0.683 Test Acc: 0.573
Validation loss decreased (inf --> -0.573372).  Saving model ...
Epoch: 2 cost time: 2.7837975025177
Epoch: 2, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.637 Vali Acc: 0.631 Test Loss: 0.637 Test Acc: 0.631
Validation loss decreased (-0.573372 --> -0.631393).  Saving model ...
Epoch: 3 cost time: 2.9591188430786133
Epoch: 3, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.589 Vali Acc: 0.693 Test Loss: 0.589 Test Acc: 0.693
Validation loss decreased (-0.631393 --> -0.692827).  Saving model ...
Epoch: 4 cost time: 2.9335129261016846
Epoch: 4, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.550 Vali Acc: 0.724 Test Loss: 0.550 Test Acc: 0.724
Validation loss decreased (-0.692827 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 2.713735818862915
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.552 Vali Acc: 0.730 Test Loss: 0.552 Test Acc: 0.730
Validation loss decreased (-0.723544 --> -0.730370).  Saving model ...
Epoch: 6 cost time: 2.9614670276641846
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
Validation loss decreased (-0.730370 --> -0.737196).  Saving model ...
Epoch: 7 cost time: 3.041375160217285
Epoch: 7, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.526 Vali Acc: 0.758 Test Loss: 0.526 Test Acc: 0.758
Validation loss decreased (-0.737196 --> -0.757674).  Saving model ...
Epoch: 8 cost time: 2.899035930633545
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.529 Vali Acc: 0.758 Test Loss: 0.529 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9521400928497314
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.757674 --> -0.761087).  Saving model ...
Epoch: 10 cost time: 3.1193385124206543
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.665907382965088
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.765 Test Loss: 0.534 Test Acc: 0.765
Validation loss decreased (-0.761087 --> -0.764500).  Saving model ...
Epoch: 12 cost time: 3.0686757564544678
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.761 Test Loss: 0.539 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.260169744491577
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.765 Test Loss: 0.539 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7004730701446533
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.754 Test Loss: 0.543 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.987865447998047
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.754 Test Loss: 0.545 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2369065284729004
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.758 Test Loss: 0.546 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.142677068710327
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.758 Test Loss: 0.550 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8493542671203613
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.758 Test Loss: 0.555 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.032378911972046
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.758 Test Loss: 0.557 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0231122970581055
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.758 Test Loss: 0.559 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0616533756256104
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.764505119453925
model parameter : 1893786
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3838393688201904
Epoch: 1, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.698 Vali Acc: 0.509 Test Loss: 0.698 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 2.075009822845459
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (-0.508525 --> -0.559720).  Saving model ...
Epoch: 3 cost time: 2.0882465839385986
Epoch: 3, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.559720 --> -0.590437).  Saving model ...
Epoch: 4 cost time: 2.244436025619507
Epoch: 4, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.773 Vali Acc: 0.563 Test Loss: 0.773 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.055215835571289
Epoch: 5, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.734 Vali Acc: 0.618 Test Loss: 0.734 Test Acc: 0.618
Validation loss decreased (-0.590437 --> -0.617740).  Saving model ...
Epoch: 6 cost time: 2.133976936340332
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.739 Vali Acc: 0.631 Test Loss: 0.739 Test Acc: 0.631
Validation loss decreased (-0.617740 --> -0.631392).  Saving model ...
Epoch: 7 cost time: 2.0603415966033936
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.729 Vali Acc: 0.642 Test Loss: 0.729 Test Acc: 0.642
Validation loss decreased (-0.631392 --> -0.641631).  Saving model ...
Epoch: 8 cost time: 2.32342529296875
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.744 Vali Acc: 0.652 Test Loss: 0.744 Test Acc: 0.652
Validation loss decreased (-0.641631 --> -0.651870).  Saving model ...
Epoch: 9 cost time: 2.1255178451538086
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.765 Vali Acc: 0.655 Test Loss: 0.765 Test Acc: 0.655
Validation loss decreased (-0.651870 --> -0.655282).  Saving model ...
Epoch: 10 cost time: 2.2878668308258057
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.784 Vali Acc: 0.645 Test Loss: 0.784 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0753886699676514
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.796 Vali Acc: 0.652 Test Loss: 0.796 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4500179290771484
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.652 Test Loss: 0.810 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1002402305603027
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.815 Vali Acc: 0.662 Test Loss: 0.815 Test Acc: 0.662
Validation loss decreased (-0.655282 --> -0.662108).  Saving model ...
Epoch: 14 cost time: 2.0481808185577393
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.833 Vali Acc: 0.655 Test Loss: 0.833 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2506699562072754
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.662 Test Loss: 0.841 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1729352474212646
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.659 Test Loss: 0.851 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.183999538421631
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.662 Test Loss: 0.859 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.018751621246338
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.659 Test Loss: 0.871 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0042009353637695
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.659 Test Loss: 0.878 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5097858905792236
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.662 Test Loss: 0.883 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0908021926879883
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.662 Test Loss: 0.891 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2606635093688965
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.659 Test Loss: 0.899 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.226060152053833
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.659 Test Loss: 0.906 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 1875354
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1516873836517334
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.700 Vali Acc: 0.536 Test Loss: 0.700 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 1.5341689586639404
Epoch: 2, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.684 Vali Acc: 0.567 Test Loss: 0.684 Test Acc: 0.567
Validation loss decreased (-0.535829 --> -0.566546).  Saving model ...
Epoch: 3 cost time: 1.5449659824371338
Epoch: 3, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.675 Vali Acc: 0.567 Test Loss: 0.675 Test Acc: 0.567
Validation loss decreased (-0.566546 --> -0.566546).  Saving model ...
Epoch: 4 cost time: 1.6534385681152344
Epoch: 4, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.688 Vali Acc: 0.577 Test Loss: 0.688 Test Acc: 0.577
Validation loss decreased (-0.566546 --> -0.576785).  Saving model ...
Epoch: 5 cost time: 1.6803226470947266
Epoch: 5, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.667 Vali Acc: 0.608 Test Loss: 0.667 Test Acc: 0.608
Validation loss decreased (-0.576785 --> -0.607502).  Saving model ...
Epoch: 6 cost time: 1.7061612606048584
Epoch: 6, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.668 Vali Acc: 0.611 Test Loss: 0.668 Test Acc: 0.611
Validation loss decreased (-0.607502 --> -0.610915).  Saving model ...
Epoch: 7 cost time: 1.5303266048431396
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.684 Vali Acc: 0.635 Test Loss: 0.684 Test Acc: 0.635
Validation loss decreased (-0.610915 --> -0.634805).  Saving model ...
Epoch: 8 cost time: 1.6417791843414307
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.704 Vali Acc: 0.631 Test Loss: 0.704 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6989009380340576
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.718 Vali Acc: 0.638 Test Loss: 0.718 Test Acc: 0.638
Validation loss decreased (-0.634805 --> -0.638218).  Saving model ...
Epoch: 10 cost time: 1.6209979057312012
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.734 Vali Acc: 0.635 Test Loss: 0.734 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6432981491088867
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.744 Vali Acc: 0.635 Test Loss: 0.744 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5315577983856201
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.635 Test Loss: 0.753 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.714714765548706
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.762 Vali Acc: 0.635 Test Loss: 0.762 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.368959903717041
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.638 Test Loss: 0.765 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4567055702209473
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.635 Test Loss: 0.775 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5245771408081055
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.631 Test Loss: 0.782 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6837141513824463
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.642 Test Loss: 0.786 Test Acc: 0.642
Validation loss decreased (-0.638218 --> -0.641630).  Saving model ...
Epoch: 18 cost time: 1.712151050567627
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.642 Test Loss: 0.791 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.542816162109375
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.645 Test Loss: 0.799 Test Acc: 0.645
Validation loss decreased (-0.641630 --> -0.645043).  Saving model ...
Epoch: 20 cost time: 1.5259146690368652
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.642 Test Loss: 0.806 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.491520643234253
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.645 Test Loss: 0.809 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.664747953414917
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.648 Test Loss: 0.814 Test Acc: 0.648
Validation loss decreased (-0.645043 --> -0.648456).  Saving model ...
Epoch: 23 cost time: 1.5557830333709717
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.645 Test Loss: 0.818 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4288783073425293
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.648 Test Loss: 0.824 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6113245487213135
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.648 Test Loss: 0.829 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7147541046142578
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.645 Test Loss: 0.832 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5579073429107666
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.642 Test Loss: 0.835 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5524969100952148
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.648 Test Loss: 0.840 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5555856227874756
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.645 Test Loss: 0.844 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.66876220703125
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.652 Test Loss: 0.848 Test Acc: 0.652
Validation loss decreased (-0.648456 --> -0.651869).  Saving model ...
Epoch: 31 cost time: 1.693596363067627
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.645 Test Loss: 0.853 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3116381168365479
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.652 Test Loss: 0.855 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5826256275177002
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.652 Test Loss: 0.858 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5025954246520996
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.652 Test Loss: 0.861 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5664379596710205
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.652 Test Loss: 0.864 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3835985660552979
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.652 Test Loss: 0.867 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4516868591308594
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.652 Test Loss: 0.871 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7452654838562012
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.652 Test Loss: 0.872 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6287176609039307
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.652 Test Loss: 0.875 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4114651679992676
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.652 Test Loss: 0.879 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 1866138
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5780227184295654
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.682 Vali Acc: 0.553 Test Loss: 0.682 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 1.0344734191894531
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.649 Vali Acc: 0.625 Test Loss: 0.649 Test Acc: 0.625
Validation loss decreased (-0.552894 --> -0.624567).  Saving model ...
Epoch: 3 cost time: 1.0865130424499512
Epoch: 3, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.597 Vali Acc: 0.669 Test Loss: 0.597 Test Acc: 0.669
Validation loss decreased (-0.624567 --> -0.668936).  Saving model ...
Epoch: 4 cost time: 1.1043996810913086
Epoch: 4, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.577 Vali Acc: 0.676 Test Loss: 0.577 Test Acc: 0.676
Validation loss decreased (-0.668936 --> -0.675762).  Saving model ...
Epoch: 5 cost time: 1.1025443077087402
Epoch: 5, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.555 Vali Acc: 0.720 Test Loss: 0.555 Test Acc: 0.720
Validation loss decreased (-0.675762 --> -0.720131).  Saving model ...
Epoch: 6 cost time: 1.1648337841033936
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.528 Vali Acc: 0.768 Test Loss: 0.528 Test Acc: 0.768
Validation loss decreased (-0.720131 --> -0.767913).  Saving model ...
Epoch: 7 cost time: 1.1526007652282715
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2848033905029297
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.531 Vali Acc: 0.758 Test Loss: 0.531 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2958693504333496
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.765 Test Loss: 0.527 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.098682165145874
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.754 Test Loss: 0.531 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1799941062927246
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.754 Test Loss: 0.535 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2105762958526611
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.146798849105835
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.765 Test Loss: 0.536 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2015957832336426
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.079883337020874
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.758 Test Loss: 0.542 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.186387300491333
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.758 Test Loss: 0.544 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 1856922
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3458666801452637
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.724 Vali Acc: 0.491 Test Loss: 0.724 Test Acc: 0.491
Validation loss decreased (inf --> -0.491460).  Saving model ...
Epoch: 2 cost time: 0.7502329349517822
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.715 Vali Acc: 0.546 Test Loss: 0.715 Test Acc: 0.546
Validation loss decreased (-0.491460 --> -0.546068).  Saving model ...
Epoch: 3 cost time: 0.7379665374755859
Epoch: 3, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.609 Vali Acc: 0.652 Test Loss: 0.609 Test Acc: 0.652
Validation loss decreased (-0.546068 --> -0.651871).  Saving model ...
Epoch: 4 cost time: 0.826056957244873
Epoch: 4, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.577 Vali Acc: 0.696 Test Loss: 0.577 Test Acc: 0.696
Validation loss decreased (-0.651871 --> -0.696240).  Saving model ...
Epoch: 5 cost time: 0.8086850643157959
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.724 Test Loss: 0.561 Test Acc: 0.724
Validation loss decreased (-0.696240 --> -0.723544).  Saving model ...
Epoch: 6 cost time: 0.90899658203125
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.703 Test Loss: 0.560 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9057595729827881
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.713 Test Loss: 0.561 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7738668918609619
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.720 Test Loss: 0.563 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.809438943862915
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.713 Test Loss: 0.567 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7227411270141602
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.720 Test Loss: 0.574 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8114943504333496
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.720 Test Loss: 0.577 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8361766338348389
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9947021007537842
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
Validation loss decreased (-0.723544 --> -0.726957).  Saving model ...
Epoch: 14 cost time: 0.7950446605682373
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8522899150848389
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9058401584625244
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.720 Test Loss: 0.596 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7332906723022461
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.724 Test Loss: 0.599 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8361480236053467
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7568333148956299
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8290500640869141
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.724 Test Loss: 0.611 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7166547775268555
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.724 Test Loss: 0.614 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8538107872009277
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.724 Test Loss: 0.617 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7667040824890137
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.724 Test Loss: 0.621 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.726962457337884
model parameter : 1848730
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.366950511932373
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.724 Vali Acc: 0.505 Test Loss: 0.724 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 6.029712677001953
Epoch: 2, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.709 Vali Acc: 0.519 Test Loss: 0.709 Test Acc: 0.519
Validation loss decreased (-0.505112 --> -0.518764).  Saving model ...
Epoch: 3 cost time: 6.28433084487915
Epoch: 3, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.672 Vali Acc: 0.563 Test Loss: 0.672 Test Acc: 0.563
Validation loss decreased (-0.518764 --> -0.563133).  Saving model ...
Epoch: 4 cost time: 6.252180576324463
Epoch: 4, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.606 Vali Acc: 0.703 Test Loss: 0.606 Test Acc: 0.703
Validation loss decreased (-0.563133 --> -0.703066).  Saving model ...
Epoch: 5 cost time: 5.504627227783203
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.582 Vali Acc: 0.720 Test Loss: 0.582 Test Acc: 0.720
Validation loss decreased (-0.703066 --> -0.720131).  Saving model ...
Epoch: 6 cost time: 6.781249523162842
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (-0.720131 --> -0.726957).  Saving model ...
Epoch: 7 cost time: 5.953284025192261
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.554 Vali Acc: 0.717 Test Loss: 0.554 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.208815574645996
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.551 Vali Acc: 0.768 Test Loss: 0.551 Test Acc: 0.768
Validation loss decreased (-0.726957 --> -0.767913).  Saving model ...
Epoch: 9 cost time: 6.244469881057739
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.452321767807007
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.2678844928741455
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.754 Test Loss: 0.566 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.622540473937988
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.573 Vali Acc: 0.758 Test Loss: 0.573 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.590306282043457
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.572 Vali Acc: 0.754 Test Loss: 0.572 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.249742746353149
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.754 Test Loss: 0.577 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.528369665145874
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.0410683155059814
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.754 Test Loss: 0.590 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.711106300354004
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.751 Test Loss: 0.596 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.158920049667358
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.758 Test Loss: 0.601 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 1962342
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.394809007644653
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.690 Vali Acc: 0.515 Test Loss: 0.690 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 4.757339239120483
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.677 Vali Acc: 0.532 Test Loss: 0.677 Test Acc: 0.532
Validation loss decreased (-0.515351 --> -0.532416).  Saving model ...
Epoch: 3 cost time: 5.026736736297607
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.646 Vali Acc: 0.587 Test Loss: 0.646 Test Acc: 0.587
Validation loss decreased (-0.532416 --> -0.587024).  Saving model ...
Epoch: 4 cost time: 5.227338790893555
Epoch: 4, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.575 Vali Acc: 0.724 Test Loss: 0.575 Test Acc: 0.724
Validation loss decreased (-0.587024 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 4.916629314422607
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.551 Vali Acc: 0.734 Test Loss: 0.551 Test Acc: 0.734
Validation loss decreased (-0.723544 --> -0.733783).  Saving model ...
Epoch: 6 cost time: 5.005774736404419
Epoch: 6, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.733783 --> -0.750848).  Saving model ...
Epoch: 7 cost time: 5.948228597640991
Epoch: 7, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
Validation loss decreased (-0.750848 --> -0.774739).  Saving model ...
Epoch: 8 cost time: 5.120344400405884
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.100193977355957
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.937081336975098
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.024843692779541
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.782 Test Loss: 0.548 Test Acc: 0.782
Validation loss decreased (-0.774739 --> -0.781564).  Saving model ...
Epoch: 12 cost time: 4.98004412651062
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.771 Test Loss: 0.558 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.916503190994263
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.586231708526611
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.566 Vali Acc: 0.782 Test Loss: 0.566 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.8639137744903564
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.876388788223267
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.771 Test Loss: 0.581 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.64200234413147
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.02198338508606
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.326577186584473
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.969300031661987
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.04587984085083
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7815699658703071
model parameter : 1939814
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.6337807178497314
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.683 Vali Acc: 0.553 Test Loss: 0.683 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 4.35909628868103
Epoch: 2, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.678 Vali Acc: 0.526 Test Loss: 0.678 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.154720306396484
Epoch: 3, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.744 Vali Acc: 0.519 Test Loss: 0.744 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.517287015914917
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.635 Vali Acc: 0.645 Test Loss: 0.635 Test Acc: 0.645
Validation loss decreased (-0.552894 --> -0.645045).  Saving model ...
Epoch: 5 cost time: 4.018342971801758
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.581 Vali Acc: 0.672 Test Loss: 0.581 Test Acc: 0.672
Validation loss decreased (-0.645045 --> -0.672349).  Saving model ...
Epoch: 6 cost time: 3.926806688308716
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.606 Vali Acc: 0.686 Test Loss: 0.606 Test Acc: 0.686
Validation loss decreased (-0.672349 --> -0.686001).  Saving model ...
Epoch: 7 cost time: 3.989471673965454
Epoch: 7, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.573 Vali Acc: 0.703 Test Loss: 0.573 Test Acc: 0.703
Validation loss decreased (-0.686001 --> -0.703066).  Saving model ...
Epoch: 8 cost time: 3.857994318008423
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.562 Vali Acc: 0.734 Test Loss: 0.562 Test Acc: 0.734
Validation loss decreased (-0.703066 --> -0.733783).  Saving model ...
Epoch: 9 cost time: 4.024891138076782
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.724 Test Loss: 0.595 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.145159959793091
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (-0.733783 --> -0.740609).  Saving model ...
Epoch: 11 cost time: 4.280224800109863
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
Validation loss decreased (-0.740609 --> -0.761086).  Saving model ...
Epoch: 12 cost time: 3.8124375343322754
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.928868532180786
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.754 Test Loss: 0.579 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.605598211288452
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.264298677444458
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.765 Test Loss: 0.589 Test Acc: 0.765
Validation loss decreased (-0.761086 --> -0.764499).  Saving model ...
Epoch: 16 cost time: 4.331313133239746
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
Validation loss decreased (-0.764499 --> -0.767912).  Saving model ...
Epoch: 17 cost time: 5.7018046379089355
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.765 Test Loss: 0.598 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.658315896987915
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.765 Test Loss: 0.604 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7221901416778564
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.771 Test Loss: 0.608 Test Acc: 0.771
Validation loss decreased (-0.767912 --> -0.771325).  Saving model ...
Epoch: 20 cost time: 4.6061224937438965
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.768 Test Loss: 0.613 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.461610794067383
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.768 Test Loss: 0.618 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.640155553817749
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.765 Test Loss: 0.621 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.569361448287964
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.768 Test Loss: 0.624 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.530547857284546
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.768 Test Loss: 0.627 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.577663898468018
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.447717905044556
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.765 Test Loss: 0.636 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.292198419570923
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.410202980041504
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.765 Test Loss: 0.642 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.379232406616211
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.765 Test Loss: 0.645 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7713310580204779
model parameter : 1917286
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.480800151824951
Epoch: 1, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.679 Vali Acc: 0.570 Test Loss: 0.679 Test Acc: 0.570
Validation loss decreased (inf --> -0.569959).  Saving model ...
Epoch: 2 cost time: 2.8167061805725098
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.636 Vali Acc: 0.686 Test Loss: 0.636 Test Acc: 0.686
Validation loss decreased (-0.569959 --> -0.686000).  Saving model ...
Epoch: 3 cost time: 3.0678956508636475
Epoch: 3, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.601 Vali Acc: 0.706 Test Loss: 0.601 Test Acc: 0.706
Validation loss decreased (-0.686000 --> -0.706479).  Saving model ...
Epoch: 4 cost time: 2.916086196899414
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.574 Vali Acc: 0.700 Test Loss: 0.574 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.851097822189331
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.706479 --> -0.750848).  Saving model ...
Epoch: 6 cost time: 3.1954355239868164
Epoch: 6, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.529 Vali Acc: 0.754 Test Loss: 0.529 Test Acc: 0.754
Validation loss decreased (-0.750848 --> -0.754261).  Saving model ...
Epoch: 7 cost time: 3.0111513137817383
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.552 Vali Acc: 0.734 Test Loss: 0.552 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.861170768737793
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.546 Vali Acc: 0.758 Test Loss: 0.546 Test Acc: 0.758
Validation loss decreased (-0.754261 --> -0.757674).  Saving model ...
Epoch: 9 cost time: 2.833590507507324
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.543 Vali Acc: 0.771 Test Loss: 0.543 Test Acc: 0.771
Validation loss decreased (-0.757674 --> -0.771326).  Saving model ...
Epoch: 10 cost time: 2.893486261367798
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.550 Vali Acc: 0.758 Test Loss: 0.550 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.033315896987915
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.554 Vali Acc: 0.768 Test Loss: 0.554 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.295156717300415
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.765 Test Loss: 0.555 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.913163900375366
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.758 Test Loss: 0.562 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9831736087799072
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.768 Test Loss: 0.566 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9546315670013428
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7880730628967285
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.725607395172119
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.758 Test Loss: 0.580 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.774327039718628
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7253150939941406
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7713310580204779
model parameter : 1893734
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.611250162124634
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.709 Vali Acc: 0.532 Test Loss: 0.709 Test Acc: 0.532
Validation loss decreased (inf --> -0.532416).  Saving model ...
Epoch: 2 cost time: 2.09201979637146
Epoch: 2, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.652 Vali Acc: 0.604 Test Loss: 0.652 Test Acc: 0.604
Validation loss decreased (-0.532416 --> -0.604089).  Saving model ...
Epoch: 3 cost time: 2.028163194656372
Epoch: 3, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.630 Vali Acc: 0.655 Test Loss: 0.630 Test Acc: 0.655
Validation loss decreased (-0.604089 --> -0.655284).  Saving model ...
Epoch: 4 cost time: 2.0769264698028564
Epoch: 4, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.597 Vali Acc: 0.679 Test Loss: 0.597 Test Acc: 0.679
Validation loss decreased (-0.655284 --> -0.679175).  Saving model ...
Epoch: 5 cost time: 2.17327880859375
Epoch: 5, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
Validation loss decreased (-0.679175 --> -0.726957).  Saving model ...
Epoch: 6 cost time: 1.9793086051940918
Epoch: 6, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.693 Test Loss: 0.574 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.076173782348633
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.575 Vali Acc: 0.724 Test Loss: 0.575 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8600592613220215
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 9 cost time: 1.9067530632019043
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.720 Test Loss: 0.587 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.057011127471924
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.730 Test Loss: 0.589 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.226303815841675
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
Validation loss decreased (-0.730370 --> -0.737195).  Saving model ...
Epoch: 12 cost time: 2.2328622341156006
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.730 Test Loss: 0.601 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1904444694519043
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1417431831359863
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.727 Test Loss: 0.610 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1544454097747803
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.727 Test Loss: 0.614 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.199127197265625
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.730 Test Loss: 0.619 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0256965160369873
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.730 Test Loss: 0.624 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9968349933624268
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.730 Test Loss: 0.628 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0317094326019287
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.730 Test Loss: 0.632 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9104728698730469
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.724 Test Loss: 0.635 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8948843479156494
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.730 Test Loss: 0.639 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7372013651877133
model parameter : 1875302
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8568501472473145
Epoch: 1, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.691 Vali Acc: 0.543 Test Loss: 0.691 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 1.7234821319580078
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.657 Vali Acc: 0.604 Test Loss: 0.657 Test Acc: 0.604
Validation loss decreased (-0.542655 --> -0.604089).  Saving model ...
Epoch: 3 cost time: 1.5482847690582275
Epoch: 3, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.637 Vali Acc: 0.655 Test Loss: 0.637 Test Acc: 0.655
Validation loss decreased (-0.604089 --> -0.655284).  Saving model ...
Epoch: 4 cost time: 1.4818041324615479
Epoch: 4, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.586 Vali Acc: 0.689 Test Loss: 0.586 Test Acc: 0.689
Validation loss decreased (-0.655284 --> -0.689414).  Saving model ...
Epoch: 5 cost time: 1.5546245574951172
Epoch: 5, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.569 Vali Acc: 0.703 Test Loss: 0.569 Test Acc: 0.703
Validation loss decreased (-0.689414 --> -0.703066).  Saving model ...
Epoch: 6 cost time: 1.4532344341278076
Epoch: 6, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.713 Test Loss: 0.553 Test Acc: 0.713
Validation loss decreased (-0.703066 --> -0.713305).  Saving model ...
Epoch: 7 cost time: 1.305675983428955
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.561 Vali Acc: 0.710 Test Loss: 0.561 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5544781684875488
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.566 Vali Acc: 0.706 Test Loss: 0.566 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.816572666168213
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
Validation loss decreased (-0.713305 --> -0.737196).  Saving model ...
Epoch: 10 cost time: 1.634782314300537
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6373851299285889
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.734 Test Loss: 0.576 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.568662166595459
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.720 Test Loss: 0.579 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4841139316558838
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.724 Test Loss: 0.583 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4700932502746582
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7720913887023926
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.730 Test Loss: 0.593 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5583698749542236
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.734 Test Loss: 0.597 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6854898929595947
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.730 Test Loss: 0.600 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7646286487579346
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.730 Test Loss: 0.604 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7598469257354736
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.730 Test Loss: 0.606 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7372013651877133
model parameter : 1866086
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.711472272872925
Epoch: 1, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.699 Vali Acc: 0.515 Test Loss: 0.699 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 1.2500629425048828
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.664 Vali Acc: 0.597 Test Loss: 0.664 Test Acc: 0.597
Validation loss decreased (-0.515351 --> -0.597263).  Saving model ...
Epoch: 3 cost time: 1.1989753246307373
Epoch: 3, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.651 Vali Acc: 0.618 Test Loss: 0.651 Test Acc: 0.618
Validation loss decreased (-0.597263 --> -0.617741).  Saving model ...
Epoch: 4 cost time: 1.0765109062194824
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.621 Vali Acc: 0.645 Test Loss: 0.621 Test Acc: 0.645
Validation loss decreased (-0.617741 --> -0.645045).  Saving model ...
Epoch: 5 cost time: 1.085970163345337
Epoch: 5, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.598 Vali Acc: 0.689 Test Loss: 0.598 Test Acc: 0.689
Validation loss decreased (-0.645045 --> -0.689414).  Saving model ...
Epoch: 6 cost time: 1.2295544147491455
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.635 Vali Acc: 0.659 Test Loss: 0.635 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1644113063812256
Epoch: 7, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
Validation loss decreased (-0.689414 --> -0.737196).  Saving model ...
Epoch: 8 cost time: 1.2811787128448486
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.260439395904541
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.608 Vali Acc: 0.730 Test Loss: 0.608 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2882394790649414
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
Validation loss decreased (-0.737196 --> -0.740608).  Saving model ...
Epoch: 11 cost time: 1.1573913097381592
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.741 Test Loss: 0.628 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1034915447235107
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.730 Test Loss: 0.638 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.306091547012329
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1944549083709717
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
Validation loss decreased (-0.740608 --> -0.750847).  Saving model ...
Epoch: 15 cost time: 1.2233965396881104
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.747 Test Loss: 0.659 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2550902366638184
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1530020236968994
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1036114692687988
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.747 Test Loss: 0.683 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.190406322479248
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1313464641571045
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.744 Test Loss: 0.695 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.19635009765625
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.747 Test Loss: 0.697 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.097942590713501
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1443836688995361
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.744 Test Loss: 0.710 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.104421854019165
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.747 Test Loss: 0.714 Test Acc: 0.747
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7508532423208191
model parameter : 1856870
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.9015936851501465
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.669 Vali Acc: 0.584 Test Loss: 0.669 Test Acc: 0.584
Validation loss decreased (inf --> -0.583611).  Saving model ...
Epoch: 2 cost time: 0.6375429630279541
Epoch: 2, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.620 Vali Acc: 0.655 Test Loss: 0.620 Test Acc: 0.655
Validation loss decreased (-0.583611 --> -0.655284).  Saving model ...
Epoch: 3 cost time: 0.6502890586853027
Epoch: 3, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.592 Vali Acc: 0.679 Test Loss: 0.592 Test Acc: 0.679
Validation loss decreased (-0.655284 --> -0.679175).  Saving model ...
Epoch: 4 cost time: 0.700554370880127
Epoch: 4, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.561 Vali Acc: 0.713 Test Loss: 0.561 Test Acc: 0.713
Validation loss decreased (-0.679175 --> -0.713305).  Saving model ...
Epoch: 5 cost time: 0.704517126083374
Epoch: 5, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.713305 --> -0.726957).  Saving model ...
Epoch: 6 cost time: 0.7340471744537354
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.578 Vali Acc: 0.730 Test Loss: 0.578 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 7 cost time: 0.6358809471130371
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.710759162902832
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.724 Test Loss: 0.596 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7377300262451172
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733782).  Saving model ...
Epoch: 10 cost time: 0.7468850612640381
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.734 Test Loss: 0.613 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.853675127029419
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.741 Test Loss: 0.620 Test Acc: 0.741
Validation loss decreased (-0.733782 --> -0.740608).  Saving model ...
Epoch: 12 cost time: 0.6789991855621338
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6264617443084717
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6962082386016846
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.744 Test Loss: 0.640 Test Acc: 0.744
Validation loss decreased (-0.740608 --> -0.744021).  Saving model ...
Epoch: 15 cost time: 0.7555239200592041
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.727867841720581
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.741 Test Loss: 0.652 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7392442226409912
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6655778884887695
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.741 Test Loss: 0.667 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7423915863037109
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8040049076080322
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.744 Test Loss: 0.680 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7969279289245605
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.744 Test Loss: 0.687 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6959629058837891
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.747 Test Loss: 0.691 Test Acc: 0.747
Validation loss decreased (-0.744021 --> -0.747433).  Saving model ...
Epoch: 23 cost time: 0.8449833393096924
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9648408889770508
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
Validation loss decreased (-0.747433 --> -0.750846).  Saving model ...
Epoch: 25 cost time: 0.7554161548614502
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.751 Test Loss: 0.707 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7686731815338135
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7637367248535156
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.747 Test Loss: 0.717 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8628344535827637
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.837099552154541
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.754 Test Loss: 0.727 Test Acc: 0.754
Validation loss decreased (-0.750846 --> -0.754259).  Saving model ...
Epoch: 30 cost time: 0.8785696029663086
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.754 Test Loss: 0.731 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8579933643341064
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.754 Test Loss: 0.735 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7723126411437988
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.754 Test Loss: 0.740 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7003467082977295
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.754 Test Loss: 0.743 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7191493511199951
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.754 Test Loss: 0.747 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.754880428314209
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.754 Test Loss: 0.751 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.728304386138916
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.754 Test Loss: 0.756 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7828612327575684
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.754 Test Loss: 0.759 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7820956707000732
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.747 Test Loss: 0.762 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7876410484313965
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.747 Test Loss: 0.766 Test Acc: 0.747
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7542662116040956
model parameter : 1848678
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.856509685516357
Epoch: 1, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.681 Vali Acc: 0.573 Test Loss: 0.681 Test Acc: 0.573
Validation loss decreased (inf --> -0.573372).  Saving model ...
Epoch: 2 cost time: 6.584234237670898
Epoch: 2, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.611 Vali Acc: 0.679 Test Loss: 0.611 Test Acc: 0.679
Validation loss decreased (-0.573372 --> -0.679175).  Saving model ...
Epoch: 3 cost time: 6.353757858276367
Epoch: 3, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.578 Vali Acc: 0.710 Test Loss: 0.578 Test Acc: 0.710
Validation loss decreased (-0.679175 --> -0.709892).  Saving model ...
Epoch: 4 cost time: 6.622768878936768
Epoch: 4, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.547 Vali Acc: 0.724 Test Loss: 0.547 Test Acc: 0.724
Validation loss decreased (-0.709892 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 6.162336111068726
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.541 Vali Acc: 0.710 Test Loss: 0.541 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.30013108253479
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.539 Vali Acc: 0.710 Test Loss: 0.539 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.708360433578491
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.710 Test Loss: 0.539 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.661369323730469
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.540 Vali Acc: 0.706 Test Loss: 0.540 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.1665003299713135
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.541 Vali Acc: 0.713 Test Loss: 0.541 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.229817152023315
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.706 Test Loss: 0.543 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.3443214893341064
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.706 Test Loss: 0.544 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.11555290222168
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.710 Test Loss: 0.550 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.811083555221558
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.713 Test Loss: 0.554 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.475311517715454
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.710 Test Loss: 0.554 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7235494880546075
model parameter : 1962278
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.923120021820068
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.681 Vali Acc: 0.570 Test Loss: 0.681 Test Acc: 0.570
Validation loss decreased (inf --> -0.569959).  Saving model ...
Epoch: 2 cost time: 5.132710695266724
Epoch: 2, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.629 Vali Acc: 0.666 Test Loss: 0.629 Test Acc: 0.666
Validation loss decreased (-0.569959 --> -0.665523).  Saving model ...
Epoch: 3 cost time: 4.860487699508667
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.596 Vali Acc: 0.666 Test Loss: 0.596 Test Acc: 0.666
Validation loss decreased (-0.665523 --> -0.665523).  Saving model ...
Epoch: 4 cost time: 5.002212762832642
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.574 Vali Acc: 0.659 Test Loss: 0.574 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.330345392227173
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.672 Test Loss: 0.588 Test Acc: 0.672
Validation loss decreased (-0.665523 --> -0.672349).  Saving model ...
Epoch: 6 cost time: 5.476157903671265
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.700 Test Loss: 0.573 Test Acc: 0.700
Validation loss decreased (-0.672349 --> -0.699653).  Saving model ...
Epoch: 7 cost time: 5.647342920303345
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.686 Test Loss: 0.582 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.820102691650391
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.581 Vali Acc: 0.683 Test Loss: 0.581 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.493283987045288
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.579 Vali Acc: 0.679 Test Loss: 0.579 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.60544490814209
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.683 Test Loss: 0.584 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.191731691360474
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.686 Test Loss: 0.583 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.319904565811157
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.683 Test Loss: 0.586 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.135883808135986
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.693 Test Loss: 0.590 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.336789608001709
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.683 Test Loss: 0.594 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.649519920349121
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.693 Test Loss: 0.594 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.90677285194397
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.693 Test Loss: 0.597 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 1939750
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.214630842208862
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.711 Vali Acc: 0.509 Test Loss: 0.711 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 3.8654818534851074
Epoch: 2, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.660 Vali Acc: 0.590 Test Loss: 0.660 Test Acc: 0.590
Validation loss decreased (-0.508525 --> -0.590437).  Saving model ...
Epoch: 3 cost time: 3.8276302814483643
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.629 Vali Acc: 0.638 Test Loss: 0.629 Test Acc: 0.638
Validation loss decreased (-0.590437 --> -0.638219).  Saving model ...
Epoch: 4 cost time: 3.9299352169036865
Epoch: 4, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.604 Vali Acc: 0.696 Test Loss: 0.604 Test Acc: 0.696
Validation loss decreased (-0.638219 --> -0.696240).  Saving model ...
Epoch: 5 cost time: 4.06161904335022
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.606 Vali Acc: 0.669 Test Loss: 0.606 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.109317064285278
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.608 Vali Acc: 0.669 Test Loss: 0.608 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.09997296333313
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.609 Vali Acc: 0.666 Test Loss: 0.609 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8836729526519775
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.666 Test Loss: 0.610 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8043816089630127
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.666 Test Loss: 0.613 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.007220506668091
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.617 Vali Acc: 0.676 Test Loss: 0.617 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.072064399719238
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.669 Test Loss: 0.619 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.849665641784668
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.683 Test Loss: 0.622 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.9902143478393555
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.683 Test Loss: 0.624 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.897428512573242
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.686 Test Loss: 0.628 Test Acc: 0.686
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6962457337883959
model parameter : 1917222
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.010329484939575
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.647 Vali Acc: 0.608 Test Loss: 0.647 Test Acc: 0.608
Validation loss decreased (inf --> -0.607502).  Saving model ...
Epoch: 2 cost time: 2.838996171951294
Epoch: 2, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.597 Vali Acc: 0.693 Test Loss: 0.597 Test Acc: 0.693
Validation loss decreased (-0.607502 --> -0.692827).  Saving model ...
Epoch: 3 cost time: 2.641230344772339
Epoch: 3, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.561 Vali Acc: 0.713 Test Loss: 0.561 Test Acc: 0.713
Validation loss decreased (-0.692827 --> -0.713305).  Saving model ...
Epoch: 4 cost time: 2.698453664779663
Epoch: 4, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.564 Vali Acc: 0.724 Test Loss: 0.564 Test Acc: 0.724
Validation loss decreased (-0.713305 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 2.7298896312713623
Epoch: 5, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.723544 --> -0.737196).  Saving model ...
Epoch: 6 cost time: 2.729897975921631
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.541 Vali Acc: 0.744 Test Loss: 0.541 Test Acc: 0.744
Validation loss decreased (-0.737196 --> -0.744022).  Saving model ...
Epoch: 7 cost time: 2.8879096508026123
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.545 Vali Acc: 0.734 Test Loss: 0.545 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9625024795532227
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7183823585510254
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.880826473236084
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.924029588699341
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.730 Test Loss: 0.549 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9890294075012207
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9968559741973877
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0421876907348633
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.730 Test Loss: 0.555 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7807843685150146
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.734 Test Loss: 0.557 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0630369186401367
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.734 Test Loss: 0.559 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7440273037542662
model parameter : 1893670
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.192239999771118
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.688 Vali Acc: 0.543 Test Loss: 0.688 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 1.9564201831817627
Epoch: 2, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.629 Vali Acc: 0.666 Test Loss: 0.629 Test Acc: 0.666
Validation loss decreased (-0.542655 --> -0.665523).  Saving model ...
Epoch: 3 cost time: 2.213796377182007
Epoch: 3, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.583 Vali Acc: 0.676 Test Loss: 0.583 Test Acc: 0.676
Validation loss decreased (-0.665523 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 2.0604889392852783
Epoch: 4, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
Validation loss decreased (-0.675762 --> -0.716718).  Saving model ...
Epoch: 5 cost time: 1.8666102886199951
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.706 Test Loss: 0.563 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.788196086883545
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.713 Test Loss: 0.563 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7388451099395752
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.710 Test Loss: 0.566 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8160104751586914
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.713 Test Loss: 0.565 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9181239604949951
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.720 Test Loss: 0.564 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720131).  Saving model ...
Epoch: 10 cost time: 1.9151287078857422
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.713 Test Loss: 0.566 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9982898235321045
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8600513935089111
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9026424884796143
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.724 Test Loss: 0.571 Test Acc: 0.724
Validation loss decreased (-0.720131 --> -0.723544).  Saving model ...
Epoch: 14 cost time: 1.9047369956970215
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.723544 --> -0.726957).  Saving model ...
Epoch: 15 cost time: 1.7723157405853271
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.720 Test Loss: 0.575 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9983327388763428
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.724 Test Loss: 0.577 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9260523319244385
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.724 Test Loss: 0.578 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.041123151779175
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9594964981079102
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.724 Test Loss: 0.581 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.912926435470581
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.724 Test Loss: 0.582 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.953484058380127
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 22 cost time: 1.8987386226654053
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9812545776367188
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.724 Test Loss: 0.587 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9441051483154297
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.724 Test Loss: 0.588 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8933145999908447
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.724 Test Loss: 0.589 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8447766304016113
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.874626874923706
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.730 Test Loss: 0.591 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.125506639480591
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.730 Test Loss: 0.592 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9300310611724854
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.734 Test Loss: 0.593 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733782).  Saving model ...
Epoch: 30 cost time: 2.0085229873657227
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0277962684631348
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.730 Test Loss: 0.596 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.984790325164795
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.194331169128418
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.046628475189209
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.730 Test Loss: 0.599 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9043796062469482
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.730 Test Loss: 0.601 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.098193883895874
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.730 Test Loss: 0.602 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.101059913635254
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.730 Test Loss: 0.603 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.114701509475708
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.730 Test Loss: 0.604 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.9814846515655518
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.730 Test Loss: 0.604 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7337883959044369
model parameter : 1875238
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0024912357330322
Epoch: 1, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.712 Vali Acc: 0.529 Test Loss: 0.712 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 1.5581812858581543
Epoch: 2, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.658 Vali Acc: 0.631 Test Loss: 0.658 Test Acc: 0.631
Validation loss decreased (-0.529003 --> -0.631393).  Saving model ...
Epoch: 3 cost time: 1.5937974452972412
Epoch: 3, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.615 Vali Acc: 0.669 Test Loss: 0.615 Test Acc: 0.669
Validation loss decreased (-0.631393 --> -0.668936).  Saving model ...
Epoch: 4 cost time: 1.4919378757476807
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.596 Vali Acc: 0.683 Test Loss: 0.596 Test Acc: 0.683
Validation loss decreased (-0.668936 --> -0.682588).  Saving model ...
Epoch: 5 cost time: 1.6407275199890137
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.592 Vali Acc: 0.679 Test Loss: 0.592 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6062498092651367
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.594 Vali Acc: 0.669 Test Loss: 0.594 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6422431468963623
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.676 Test Loss: 0.596 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4029524326324463
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.686 Test Loss: 0.598 Test Acc: 0.686
Validation loss decreased (-0.682588 --> -0.686001).  Saving model ...
Epoch: 9 cost time: 1.4289393424987793
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.686 Test Loss: 0.599 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5768542289733887
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.689 Test Loss: 0.600 Test Acc: 0.689
Validation loss decreased (-0.686001 --> -0.689414).  Saving model ...
Epoch: 11 cost time: 1.5764455795288086
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.696 Test Loss: 0.602 Test Acc: 0.696
Validation loss decreased (-0.689414 --> -0.696240).  Saving model ...
Epoch: 12 cost time: 1.580047607421875
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.703 Test Loss: 0.605 Test Acc: 0.703
Validation loss decreased (-0.696240 --> -0.703066).  Saving model ...
Epoch: 13 cost time: 1.3294103145599365
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.700 Test Loss: 0.606 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5357203483581543
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.700 Test Loss: 0.607 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6170482635498047
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.696 Test Loss: 0.611 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.714501142501831
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.703 Test Loss: 0.613 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.501918077468872
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.703 Test Loss: 0.614 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4138050079345703
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.703 Test Loss: 0.616 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.609130620956421
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.703 Test Loss: 0.618 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.552520990371704
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.703 Test Loss: 0.620 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6421077251434326
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.706 Test Loss: 0.622 Test Acc: 0.706
Validation loss decreased (-0.703066 --> -0.706478).  Saving model ...
Epoch: 22 cost time: 1.540748119354248
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.710 Test Loss: 0.623 Test Acc: 0.710
Validation loss decreased (-0.706478 --> -0.709891).  Saving model ...
Epoch: 23 cost time: 1.4295382499694824
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.710 Test Loss: 0.625 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7226035594940186
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.710 Test Loss: 0.627 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7384929656982422
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.706 Test Loss: 0.629 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5686519145965576
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.706 Test Loss: 0.631 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4771430492401123
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.710 Test Loss: 0.633 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3562431335449219
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.710 Test Loss: 0.634 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4511511325836182
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.710 Test Loss: 0.635 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5252792835235596
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.710 Test Loss: 0.637 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4270563125610352
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.713 Test Loss: 0.639 Test Acc: 0.713
Validation loss decreased (-0.709891 --> -0.713304).  Saving model ...
Epoch: 32 cost time: 1.6314749717712402
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.713 Test Loss: 0.641 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5358498096466064
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.713 Test Loss: 0.642 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.637843370437622
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.713 Test Loss: 0.644 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.568047046661377
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.713 Test Loss: 0.645 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4091145992279053
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.713 Test Loss: 0.646 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4933829307556152
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.713 Test Loss: 0.648 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4668850898742676
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6402091979980469
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.710 Test Loss: 0.650 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5955331325531006
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.710 Test Loss: 0.651 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4339978694915771
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.710 Test Loss: 0.653 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7133105802047781
model parameter : 1866022
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.1553397178649902
Epoch: 1, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.694 Vali Acc: 0.512 Test Loss: 0.694 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 1.011796236038208
Epoch: 2, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.643 Vali Acc: 0.645 Test Loss: 0.643 Test Acc: 0.645
Validation loss decreased (-0.511938 --> -0.645045).  Saving model ...
Epoch: 3 cost time: 1.0310280323028564
Epoch: 3, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.604 Vali Acc: 0.696 Test Loss: 0.604 Test Acc: 0.696
Validation loss decreased (-0.645045 --> -0.696240).  Saving model ...
Epoch: 4 cost time: 1.0968379974365234
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.586 Vali Acc: 0.724 Test Loss: 0.586 Test Acc: 0.724
Validation loss decreased (-0.696240 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 1.0304632186889648
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.700 Test Loss: 0.591 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2127957344055176
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
Validation loss decreased (-0.723544 --> -0.726957).  Saving model ...
Epoch: 7 cost time: 1.0954725742340088
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.730 Test Loss: 0.591 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 8 cost time: 1.091897964477539
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1933202743530273
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.720 Test Loss: 0.595 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0697197914123535
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1175026893615723
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.720 Test Loss: 0.600 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1490418910980225
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.720 Test Loss: 0.603 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1600117683410645
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.724 Test Loss: 0.606 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1674232482910156
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.724 Test Loss: 0.609 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2007315158843994
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.720 Test Loss: 0.611 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.173635721206665
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.720 Test Loss: 0.613 Test Acc: 0.720
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1818246841430664
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.720 Test Loss: 0.615 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7303754266211604
model parameter : 1856806
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.1060290336608887
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.661 Vali Acc: 0.628 Test Loss: 0.661 Test Acc: 0.628
Validation loss decreased (inf --> -0.627980).  Saving model ...
Epoch: 2 cost time: 0.7047405242919922
Epoch: 2, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.595 Vali Acc: 0.686 Test Loss: 0.595 Test Acc: 0.686
Validation loss decreased (-0.627980 --> -0.686001).  Saving model ...
Epoch: 3 cost time: 0.6881616115570068
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.580 Vali Acc: 0.693 Test Loss: 0.580 Test Acc: 0.693
Validation loss decreased (-0.686001 --> -0.692827).  Saving model ...
Epoch: 4 cost time: 0.7012403011322021
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.586 Vali Acc: 0.710 Test Loss: 0.586 Test Acc: 0.710
Validation loss decreased (-0.692827 --> -0.709892).  Saving model ...
Epoch: 5 cost time: 0.7614312171936035
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (-0.709892 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 0.7622361183166504
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.720 Test Loss: 0.583 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720131).  Saving model ...
Epoch: 7 cost time: 0.6855788230895996
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.724 Test Loss: 0.591 Test Acc: 0.724
Validation loss decreased (-0.720131 --> -0.723544).  Saving model ...
Epoch: 8 cost time: 0.732621431350708
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.724 Test Loss: 0.594 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.681394100189209
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
Validation loss decreased (-0.723544 --> -0.730369).  Saving model ...
Epoch: 10 cost time: 0.7038547992706299
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.730 Test Loss: 0.601 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.67645263671875
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (-0.730369 --> -0.737195).  Saving model ...
Epoch: 12 cost time: 0.6598556041717529
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7638769149780273
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.747 Test Loss: 0.614 Test Acc: 0.747
Validation loss decreased (-0.737195 --> -0.747434).  Saving model ...
Epoch: 14 cost time: 0.6689417362213135
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.747 Test Loss: 0.616 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6429924964904785
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.747 Test Loss: 0.622 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7188892364501953
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.747 Test Loss: 0.625 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6920664310455322
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.747 Test Loss: 0.628 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6209123134613037
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.747 Test Loss: 0.631 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7347614765167236
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
Validation loss decreased (-0.747434 --> -0.750847).  Saving model ...
Epoch: 20 cost time: 0.6002984046936035
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6421236991882324
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.754 Test Loss: 0.642 Test Acc: 0.754
Validation loss decreased (-0.750847 --> -0.754260).  Saving model ...
Epoch: 22 cost time: 0.7418491840362549
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.758 Test Loss: 0.645 Test Acc: 0.758
Validation loss decreased (-0.754260 --> -0.757673).  Saving model ...
Epoch: 23 cost time: 0.6132042407989502
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.754 Test Loss: 0.649 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6771886348724365
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.758 Test Loss: 0.651 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7048001289367676
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.754 Test Loss: 0.654 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6823515892028809
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.754 Test Loss: 0.658 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6088831424713135
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.754 Test Loss: 0.662 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6452548503875732
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.754 Test Loss: 0.664 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8025093078613281
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.754 Test Loss: 0.667 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6669769287109375
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.754 Test Loss: 0.669 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6118230819702148
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.754 Test Loss: 0.672 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7780356407165527
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.754 Test Loss: 0.674 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.757679180887372
model parameter : 1848614
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.236408233642578
Epoch: 1, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.683 Vali Acc: 0.590 Test Loss: 0.683 Test Acc: 0.590
Validation loss decreased (inf --> -0.590437).  Saving model ...
Epoch: 2 cost time: 6.44505763053894
Epoch: 2, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.665 Vali Acc: 0.614 Test Loss: 0.665 Test Acc: 0.614
Validation loss decreased (-0.590437 --> -0.614328).  Saving model ...
Epoch: 3 cost time: 6.53069281578064
Epoch: 3, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.661 Vali Acc: 0.556 Test Loss: 0.661 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.655424118041992
Epoch: 4, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.619 Vali Acc: 0.666 Test Loss: 0.619 Test Acc: 0.666
Validation loss decreased (-0.614328 --> -0.665523).  Saving model ...
Epoch: 5 cost time: 7.505666494369507
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.604 Vali Acc: 0.679 Test Loss: 0.604 Test Acc: 0.679
Validation loss decreased (-0.665523 --> -0.679175).  Saving model ...
Epoch: 6 cost time: 6.771753549575806
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (-0.679175 --> -0.726957).  Saving model ...
Epoch: 7 cost time: 6.6293394565582275
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.577 Vali Acc: 0.713 Test Loss: 0.577 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.243027210235596
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.726957 --> -0.740609).  Saving model ...
Epoch: 9 cost time: 6.003159523010254
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.559 Vali Acc: 0.744 Test Loss: 0.559 Test Acc: 0.744
Validation loss decreased (-0.740609 --> -0.744022).  Saving model ...
Epoch: 10 cost time: 6.395824193954468
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.524592638015747
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.852482080459595
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.294848203659058
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.591 Vali Acc: 0.744 Test Loss: 0.591 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.1630859375
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.602 Vali Acc: 0.747 Test Loss: 0.602 Test Acc: 0.747
Validation loss decreased (-0.744022 --> -0.747434).  Saving model ...
Epoch: 15 cost time: 6.434756517410278
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.608 Vali Acc: 0.747 Test Loss: 0.608 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.46763014793396
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.754 Test Loss: 0.608 Test Acc: 0.754
Validation loss decreased (-0.747434 --> -0.754260).  Saving model ...
Epoch: 17 cost time: 6.378621339797974
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.754 Test Loss: 0.613 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.898723602294922
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.747 Test Loss: 0.619 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.324969291687012
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.620 Vali Acc: 0.758 Test Loss: 0.620 Test Acc: 0.758
Validation loss decreased (-0.754260 --> -0.757673).  Saving model ...
Epoch: 20 cost time: 6.633168935775757
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.758 Test Loss: 0.626 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.198044061660767
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.021968364715576
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.758 Test Loss: 0.635 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.3891119956970215
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.799415111541748
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.758 Test Loss: 0.640 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.305912494659424
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.758 Test Loss: 0.642 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.073540687561035
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.747 Test Loss: 0.647 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.722292900085449
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.754 Test Loss: 0.653 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.541985988616943
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.754 Test Loss: 0.655 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.715036630630493
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.758 Test Loss: 0.657 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.757679180887372
model parameter : 987546
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.004546165466309
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.686 Vali Acc: 0.570 Test Loss: 0.686 Test Acc: 0.570
Validation loss decreased (inf --> -0.569959).  Saving model ...
Epoch: 2 cost time: 5.1170654296875
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.682 Vali Acc: 0.536 Test Loss: 0.682 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.088360548019409
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.663 Vali Acc: 0.601 Test Loss: 0.663 Test Acc: 0.601
Validation loss decreased (-0.569959 --> -0.600676).  Saving model ...
Epoch: 4 cost time: 5.2851667404174805
Epoch: 4, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.671 Vali Acc: 0.560 Test Loss: 0.671 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.130944728851318
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.676 Vali Acc: 0.580 Test Loss: 0.676 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.615975618362427
Epoch: 6, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.633 Vali Acc: 0.614 Test Loss: 0.633 Test Acc: 0.614
Validation loss decreased (-0.600676 --> -0.614328).  Saving model ...
Epoch: 7 cost time: 5.284260034561157
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.651 Vali Acc: 0.645 Test Loss: 0.651 Test Acc: 0.645
Validation loss decreased (-0.614328 --> -0.645045).  Saving model ...
Epoch: 8 cost time: 5.2363903522491455
Epoch: 8, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.626 Vali Acc: 0.631 Test Loss: 0.626 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.131634712219238
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.622 Vali Acc: 0.628 Test Loss: 0.622 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.161108016967773
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.631 Vali Acc: 0.642 Test Loss: 0.631 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.738702058792114
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.625 Test Loss: 0.633 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.040244102478027
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.636 Vali Acc: 0.631 Test Loss: 0.636 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.159229755401611
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.635 Test Loss: 0.642 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.870882749557495
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.635 Test Loss: 0.645 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.6636083126068115
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.635 Test Loss: 0.647 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.086440563201904
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.642 Test Loss: 0.652 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.035041570663452
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.635 Test Loss: 0.654 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 976282
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.3183557987213135
Epoch: 1, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.676 Vali Acc: 0.580 Test Loss: 0.676 Test Acc: 0.580
Validation loss decreased (inf --> -0.580198).  Saving model ...
Epoch: 2 cost time: 3.8543365001678467
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.635 Vali Acc: 0.608 Test Loss: 0.635 Test Acc: 0.608
Validation loss decreased (-0.580198 --> -0.607502).  Saving model ...
Epoch: 3 cost time: 3.833794116973877
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.603 Vali Acc: 0.669 Test Loss: 0.603 Test Acc: 0.669
Validation loss decreased (-0.607502 --> -0.668936).  Saving model ...
Epoch: 4 cost time: 3.8501839637756348
Epoch: 4, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.588 Vali Acc: 0.672 Test Loss: 0.588 Test Acc: 0.672
Validation loss decreased (-0.668936 --> -0.672349).  Saving model ...
Epoch: 5 cost time: 3.7155628204345703
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.569 Vali Acc: 0.706 Test Loss: 0.569 Test Acc: 0.706
Validation loss decreased (-0.672349 --> -0.706479).  Saving model ...
Epoch: 6 cost time: 4.131575107574463
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
Validation loss decreased (-0.706479 --> -0.726957).  Saving model ...
Epoch: 7 cost time: 4.010634422302246
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.545 Vali Acc: 0.696 Test Loss: 0.545 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.088761568069458
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.713 Test Loss: 0.563 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.820183277130127
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.549 Vali Acc: 0.713 Test Loss: 0.549 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.081309080123901
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.558 Vali Acc: 0.703 Test Loss: 0.558 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.295641183853149
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.556 Vali Acc: 0.724 Test Loss: 0.556 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9417691230773926
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.720 Test Loss: 0.563 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.83577823638916
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.070460557937622
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.720 Test Loss: 0.574 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.471824407577515
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.724 Test Loss: 0.578 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.354308843612671
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.720 Test Loss: 0.581 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.726962457337884
model parameter : 965018
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.36297345161438
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.681 Vali Acc: 0.597 Test Loss: 0.681 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 3.001997470855713
Epoch: 2, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.665 Vali Acc: 0.597 Test Loss: 0.665 Test Acc: 0.597
Validation loss decreased (-0.597263 --> -0.597263).  Saving model ...
Epoch: 3 cost time: 2.8437793254852295
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.635 Vali Acc: 0.648 Test Loss: 0.635 Test Acc: 0.648
Validation loss decreased (-0.597263 --> -0.648458).  Saving model ...
Epoch: 4 cost time: 2.8172731399536133
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.623 Vali Acc: 0.659 Test Loss: 0.623 Test Acc: 0.659
Validation loss decreased (-0.648458 --> -0.658697).  Saving model ...
Epoch: 5 cost time: 2.605441093444824
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.600 Vali Acc: 0.669 Test Loss: 0.600 Test Acc: 0.669
Validation loss decreased (-0.658697 --> -0.668936).  Saving model ...
Epoch: 6 cost time: 2.750385284423828
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.610 Vali Acc: 0.676 Test Loss: 0.610 Test Acc: 0.676
Validation loss decreased (-0.668936 --> -0.675762).  Saving model ...
Epoch: 7 cost time: 2.6031594276428223
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.590 Vali Acc: 0.700 Test Loss: 0.590 Test Acc: 0.700
Validation loss decreased (-0.675762 --> -0.699653).  Saving model ...
Epoch: 8 cost time: 2.758837938308716
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.594 Vali Acc: 0.696 Test Loss: 0.594 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7907252311706543
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.608 Vali Acc: 0.686 Test Loss: 0.608 Test Acc: 0.686
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5780768394470215
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.613 Vali Acc: 0.700 Test Loss: 0.613 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7609784603118896
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.617 Vali Acc: 0.710 Test Loss: 0.617 Test Acc: 0.710
Validation loss decreased (-0.699653 --> -0.709891).  Saving model ...
Epoch: 12 cost time: 2.7881577014923096
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6077120304107666
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.628 Vali Acc: 0.706 Test Loss: 0.628 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7017252445220947
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.710 Test Loss: 0.633 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7297587394714355
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.700 Test Loss: 0.643 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.647050142288208
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5801520347595215
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.706 Test Loss: 0.654 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6264357566833496
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.703 Test Loss: 0.659 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.8735854625701904
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.700 Test Loss: 0.664 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0869364738464355
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.706 Test Loss: 0.668 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0773062705993652
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.703 Test Loss: 0.673 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7098976109215017
model parameter : 953242
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1560726165771484
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.707 Vali Acc: 0.509 Test Loss: 0.707 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 1.9011847972869873
Epoch: 2, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.698 Vali Acc: 0.526 Test Loss: 0.698 Test Acc: 0.526
Validation loss decreased (-0.508525 --> -0.525590).  Saving model ...
Epoch: 3 cost time: 2.066725492477417
Epoch: 3, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.709 Vali Acc: 0.526 Test Loss: 0.709 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.08943772315979
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.678 Vali Acc: 0.567 Test Loss: 0.678 Test Acc: 0.567
Validation loss decreased (-0.525590 --> -0.566546).  Saving model ...
Epoch: 5 cost time: 2.0488388538360596
Epoch: 5, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.667 Vali Acc: 0.590 Test Loss: 0.667 Test Acc: 0.590
Validation loss decreased (-0.566546 --> -0.590437).  Saving model ...
Epoch: 6 cost time: 1.9885175228118896
Epoch: 6, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.680 Vali Acc: 0.618 Test Loss: 0.680 Test Acc: 0.618
Validation loss decreased (-0.590437 --> -0.617741).  Saving model ...
Epoch: 7 cost time: 1.9151930809020996
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.696 Vali Acc: 0.618 Test Loss: 0.696 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9674503803253174
Epoch: 8, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.689 Vali Acc: 0.635 Test Loss: 0.689 Test Acc: 0.635
Validation loss decreased (-0.617741 --> -0.634805).  Saving model ...
Epoch: 9 cost time: 2.0784902572631836
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.665 Vali Acc: 0.648 Test Loss: 0.665 Test Acc: 0.648
Validation loss decreased (-0.634805 --> -0.648458).  Saving model ...
Epoch: 10 cost time: 1.8522138595581055
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.660 Vali Acc: 0.659 Test Loss: 0.660 Test Acc: 0.659
Validation loss decreased (-0.648458 --> -0.658696).  Saving model ...
Epoch: 11 cost time: 2.090827226638794
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.676 Vali Acc: 0.655 Test Loss: 0.676 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9840846061706543
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.672 Vali Acc: 0.645 Test Loss: 0.672 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9056222438812256
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.684 Vali Acc: 0.659 Test Loss: 0.684 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0993595123291016
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.662 Test Loss: 0.682 Test Acc: 0.662
Validation loss decreased (-0.658696 --> -0.662109).  Saving model ...
Epoch: 15 cost time: 2.0200531482696533
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.693 Vali Acc: 0.666 Test Loss: 0.693 Test Acc: 0.666
Validation loss decreased (-0.662109 --> -0.665522).  Saving model ...
Epoch: 16 cost time: 1.902092456817627
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.666 Test Loss: 0.693 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9502551555633545
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.669 Test Loss: 0.700 Test Acc: 0.669
Validation loss decreased (-0.665522 --> -0.668935).  Saving model ...
Epoch: 18 cost time: 1.9610748291015625
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.669 Test Loss: 0.706 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.078540325164795
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.669 Test Loss: 0.709 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1411020755767822
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.669 Test Loss: 0.712 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9426441192626953
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.672 Test Loss: 0.717 Test Acc: 0.672
Validation loss decreased (-0.668935 --> -0.672348).  Saving model ...
Epoch: 22 cost time: 2.0559630393981934
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.676 Test Loss: 0.717 Test Acc: 0.676
Validation loss decreased (-0.672348 --> -0.675761).  Saving model ...
Epoch: 23 cost time: 2.088308095932007
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.672 Test Loss: 0.724 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9825398921966553
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.676 Test Loss: 0.729 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2022454738616943
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.679 Test Loss: 0.731 Test Acc: 0.679
Validation loss decreased (-0.675761 --> -0.679174).  Saving model ...
Epoch: 26 cost time: 1.91861891746521
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.672 Test Loss: 0.736 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0484907627105713
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.672 Test Loss: 0.738 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.926877498626709
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.679 Test Loss: 0.745 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1044108867645264
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.676 Test Loss: 0.744 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.017789602279663
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.676 Test Loss: 0.749 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.041125774383545
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.676 Test Loss: 0.748 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9219942092895508
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.676 Test Loss: 0.752 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9190499782562256
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.672 Test Loss: 0.755 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.025113582611084
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.679 Test Loss: 0.756 Test Acc: 0.679
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.115560531616211
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.679 Test Loss: 0.760 Test Acc: 0.679
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 944026
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9134459495544434
Epoch: 1, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.721 Vali Acc: 0.461 Test Loss: 0.721 Test Acc: 0.461
Validation loss decreased (inf --> -0.460744).  Saving model ...
Epoch: 2 cost time: 1.5333244800567627
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.678 Vali Acc: 0.553 Test Loss: 0.678 Test Acc: 0.553
Validation loss decreased (-0.460744 --> -0.552894).  Saving model ...
Epoch: 3 cost time: 1.4585490226745605
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.634 Vali Acc: 0.648 Test Loss: 0.634 Test Acc: 0.648
Validation loss decreased (-0.552894 --> -0.648458).  Saving model ...
Epoch: 4 cost time: 1.4829926490783691
Epoch: 4, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.602 Vali Acc: 0.672 Test Loss: 0.602 Test Acc: 0.672
Validation loss decreased (-0.648458 --> -0.672349).  Saving model ...
Epoch: 5 cost time: 1.5857079029083252
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.580 Vali Acc: 0.693 Test Loss: 0.580 Test Acc: 0.693
Validation loss decreased (-0.672349 --> -0.692827).  Saving model ...
Epoch: 6 cost time: 1.5151126384735107
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.576 Vali Acc: 0.703 Test Loss: 0.576 Test Acc: 0.703
Validation loss decreased (-0.692827 --> -0.703066).  Saving model ...
Epoch: 7 cost time: 1.4776206016540527
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.724 Test Loss: 0.564 Test Acc: 0.724
Validation loss decreased (-0.703066 --> -0.723544).  Saving model ...
Epoch: 8 cost time: 1.4377150535583496
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.724 Test Loss: 0.570 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.499499797821045
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.723544 --> -0.726957).  Saving model ...
Epoch: 10 cost time: 1.4887099266052246
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.578 Vali Acc: 0.730 Test Loss: 0.578 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730370).  Saving model ...
Epoch: 11 cost time: 1.3375115394592285
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5430896282196045
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5079891681671143
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.724 Test Loss: 0.594 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5399494171142578
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6429462432861328
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.730 Test Loss: 0.602 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6338002681732178
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.730 Test Loss: 0.606 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5426099300384521
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.730 Test Loss: 0.609 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.537229061126709
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.730 Test Loss: 0.610 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5951361656188965
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.734 Test Loss: 0.620 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733782).  Saving model ...
Epoch: 20 cost time: 1.6536471843719482
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.734 Test Loss: 0.622 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6405415534973145
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.730 Test Loss: 0.629 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.602079153060913
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.734 Test Loss: 0.627 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.639129400253296
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6001968383789062
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.701030969619751
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.733782 --> -0.737195).  Saving model ...
Epoch: 26 cost time: 1.7503480911254883
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5870590209960938
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5587894916534424
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.734 Test Loss: 0.649 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4907238483428955
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.734 Test Loss: 0.651 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.605337381362915
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.730 Test Loss: 0.654 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6686663627624512
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8313417434692383
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.734 Test Loss: 0.658 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6942684650421143
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.792358636856079
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5422790050506592
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.730 Test Loss: 0.666 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7372013651877133
model parameter : 939418
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.241328239440918
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.683 Vali Acc: 0.546 Test Loss: 0.683 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 1.0792412757873535
Epoch: 2, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.649 Vali Acc: 0.628 Test Loss: 0.649 Test Acc: 0.628
Validation loss decreased (-0.546068 --> -0.627980).  Saving model ...
Epoch: 3 cost time: 1.0309772491455078
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.630 Vali Acc: 0.666 Test Loss: 0.630 Test Acc: 0.666
Validation loss decreased (-0.627980 --> -0.665523).  Saving model ...
Epoch: 4 cost time: 1.120586633682251
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (-0.665523 --> -0.716718).  Saving model ...
Epoch: 5 cost time: 0.9071683883666992
Epoch: 5, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.569 Vali Acc: 0.713 Test Loss: 0.569 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0443487167358398
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.533 Vali Acc: 0.758 Test Loss: 0.533 Test Acc: 0.758
Validation loss decreased (-0.716718 --> -0.757674).  Saving model ...
Epoch: 7 cost time: 1.1243610382080078
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.536 Vali Acc: 0.768 Test Loss: 0.536 Test Acc: 0.768
Validation loss decreased (-0.757674 --> -0.767913).  Saving model ...
Epoch: 8 cost time: 1.0481188297271729
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0589044094085693
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9514539241790771
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0122623443603516
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.747 Test Loss: 0.552 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0307106971740723
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.758 Test Loss: 0.552 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0478637218475342
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.754 Test Loss: 0.565 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.155573844909668
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.758 Test Loss: 0.568 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0597407817840576
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.768 Test Loss: 0.571 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9792129993438721
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.758 Test Loss: 0.583 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9823226928710938
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.758 Test Loss: 0.588 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 934810
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.8322219848632812
Epoch: 1, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.694 Vali Acc: 0.549 Test Loss: 0.694 Test Acc: 0.549
Validation loss decreased (inf --> -0.549481).  Saving model ...
Epoch: 2 cost time: 0.8920643329620361
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.628 Vali Acc: 0.648 Test Loss: 0.628 Test Acc: 0.648
Validation loss decreased (-0.549481 --> -0.648458).  Saving model ...
Epoch: 3 cost time: 0.6850714683532715
Epoch: 3, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.579 Vali Acc: 0.700 Test Loss: 0.579 Test Acc: 0.700
Validation loss decreased (-0.648458 --> -0.699653).  Saving model ...
Epoch: 4 cost time: 0.8130803108215332
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.543 Vali Acc: 0.724 Test Loss: 0.543 Test Acc: 0.724
Validation loss decreased (-0.699653 --> -0.723544).  Saving model ...
Epoch: 5 cost time: 0.6700751781463623
Epoch: 5, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.519 Vali Acc: 0.730 Test Loss: 0.519 Test Acc: 0.730
Validation loss decreased (-0.723544 --> -0.730370).  Saving model ...
Epoch: 6 cost time: 0.6567785739898682
Epoch: 6, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.730370 --> -0.737196).  Saving model ...
Epoch: 7 cost time: 0.6215276718139648
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.734 Test Loss: 0.545 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7315142154693604
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.747 Test Loss: 0.553 Test Acc: 0.747
Validation loss decreased (-0.737196 --> -0.747435).  Saving model ...
Epoch: 9 cost time: 0.7314362525939941
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.747 Test Loss: 0.583 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7281589508056641
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7221629619598389
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.744 Test Loss: 0.607 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7807600498199463
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.744 Test Loss: 0.621 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6246709823608398
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.741 Test Loss: 0.634 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7406363487243652
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.747 Test Loss: 0.646 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6541919708251953
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.744 Test Loss: 0.657 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7784273624420166
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7748000621795654
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7269604206085205
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.744 Test Loss: 0.689 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7474402730375427
model parameter : 930714
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.428851366043091
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.709 Vali Acc: 0.478 Test Loss: 0.709 Test Acc: 0.478
Validation loss decreased (inf --> -0.477809).  Saving model ...
Epoch: 2 cost time: 6.262291431427002
Epoch: 2, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.693 Vali Acc: 0.522 Test Loss: 0.693 Test Acc: 0.522
Validation loss decreased (-0.477809 --> -0.522177).  Saving model ...
Epoch: 3 cost time: 6.455497741699219
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.669 Vali Acc: 0.608 Test Loss: 0.669 Test Acc: 0.608
Validation loss decreased (-0.522177 --> -0.607502).  Saving model ...
Epoch: 4 cost time: 6.465906858444214
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.645 Vali Acc: 0.642 Test Loss: 0.645 Test Acc: 0.642
Validation loss decreased (-0.607502 --> -0.641632).  Saving model ...
Epoch: 5 cost time: 6.405272483825684
Epoch: 5, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.627 Vali Acc: 0.683 Test Loss: 0.627 Test Acc: 0.683
Validation loss decreased (-0.641632 --> -0.682588).  Saving model ...
Epoch: 6 cost time: 7.230560779571533
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.624 Vali Acc: 0.669 Test Loss: 0.624 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.92846417427063
Epoch: 7, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.619 Vali Acc: 0.700 Test Loss: 0.619 Test Acc: 0.700
Validation loss decreased (-0.682588 --> -0.699653).  Saving model ...
Epoch: 8 cost time: 6.395427703857422
Epoch: 8, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.621 Vali Acc: 0.686 Test Loss: 0.621 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.221055269241333
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.629 Vali Acc: 0.683 Test Loss: 0.629 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.000870943069458
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.636 Vali Acc: 0.679 Test Loss: 0.636 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.219871520996094
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.646 Vali Acc: 0.669 Test Loss: 0.646 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.944486856460571
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.656 Vali Acc: 0.686 Test Loss: 0.656 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.831894397735596
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.656 Vali Acc: 0.679 Test Loss: 0.656 Test Acc: 0.679
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.819670677185059
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.668 Vali Acc: 0.686 Test Loss: 0.668 Test Acc: 0.686
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.629215478897095
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.683 Test Loss: 0.680 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.0677103996276855
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.679 Test Loss: 0.684 Test Acc: 0.679
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.4033520221710205
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.676 Test Loss: 0.689 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 987494
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.209692478179932
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.701 Vali Acc: 0.543 Test Loss: 0.701 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 5.174267530441284
Epoch: 2, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.667 Vali Acc: 0.580 Test Loss: 0.667 Test Acc: 0.580
Validation loss decreased (-0.542655 --> -0.580198).  Saving model ...
Epoch: 3 cost time: 5.9502012729644775
Epoch: 3, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.634 Vali Acc: 0.635 Test Loss: 0.634 Test Acc: 0.635
Validation loss decreased (-0.580198 --> -0.634806).  Saving model ...
Epoch: 4 cost time: 5.4322755336761475
Epoch: 4, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.611 Vali Acc: 0.659 Test Loss: 0.611 Test Acc: 0.659
Validation loss decreased (-0.634806 --> -0.658697).  Saving model ...
Epoch: 5 cost time: 5.302856922149658
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.610 Vali Acc: 0.628 Test Loss: 0.610 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.979444742202759
Epoch: 6, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.537 Vali Acc: 0.730 Test Loss: 0.537 Test Acc: 0.730
Validation loss decreased (-0.658697 --> -0.730370).  Saving model ...
Epoch: 7 cost time: 5.275461673736572
Epoch: 7, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.545 Vali Acc: 0.734 Test Loss: 0.545 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733783).  Saving model ...
Epoch: 8 cost time: 5.095188617706299
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
Validation loss decreased (-0.733783 --> -0.740609).  Saving model ...
Epoch: 9 cost time: 4.699619770050049
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.507 Vali Acc: 0.747 Test Loss: 0.507 Test Acc: 0.747
Validation loss decreased (-0.740609 --> -0.747435).  Saving model ...
Epoch: 10 cost time: 4.962024688720703
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.758 Test Loss: 0.509 Test Acc: 0.758
Validation loss decreased (-0.747435 --> -0.757674).  Saving model ...
Epoch: 11 cost time: 5.093684911727905
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.527 Vali Acc: 0.765 Test Loss: 0.527 Test Acc: 0.765
Validation loss decreased (-0.757674 --> -0.764500).  Saving model ...
Epoch: 12 cost time: 4.900348663330078
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.668964862823486
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.559 Vali Acc: 0.744 Test Loss: 0.559 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.584805488586426
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.754 Test Loss: 0.543 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.763715505599976
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.722458362579346
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.919408559799194
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.005726337432861
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.338879823684692
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.744 Test Loss: 0.581 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.374334812164307
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.526773691177368
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.764505119453925
model parameter : 976230
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.353556871414185
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.708 Vali Acc: 0.512 Test Loss: 0.708 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 4.021330833435059
Epoch: 2, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.654 Vali Acc: 0.604 Test Loss: 0.654 Test Acc: 0.604
Validation loss decreased (-0.511938 --> -0.604089).  Saving model ...
Epoch: 3 cost time: 3.9230382442474365
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.616 Vali Acc: 0.676 Test Loss: 0.616 Test Acc: 0.676
Validation loss decreased (-0.604089 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 3.821646213531494
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.582 Vali Acc: 0.706 Test Loss: 0.582 Test Acc: 0.706
Validation loss decreased (-0.675762 --> -0.706479).  Saving model ...
Epoch: 5 cost time: 4.035488605499268
Epoch: 5, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.561 Vali Acc: 0.703 Test Loss: 0.561 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8428843021392822
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.706479 --> -0.726957).  Saving model ...
Epoch: 7 cost time: 3.8983657360076904
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.530 Vali Acc: 0.720 Test Loss: 0.530 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.986910820007324
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.549 Vali Acc: 0.754 Test Loss: 0.549 Test Acc: 0.754
Validation loss decreased (-0.726957 --> -0.754261).  Saving model ...
Epoch: 9 cost time: 3.9481093883514404
Epoch: 9, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.601 Vali Acc: 0.747 Test Loss: 0.601 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7977001667022705
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.552 Vali Acc: 0.724 Test Loss: 0.552 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.916443347930908
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.960137367248535
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.724975824356079
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.734 Test Loss: 0.584 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9222800731658936
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.265148878097534
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.734 Test Loss: 0.594 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.0785603523254395
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.603 Vali Acc: 0.730 Test Loss: 0.603 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.9612138271331787
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.180349349975586
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.734 Test Loss: 0.616 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7542662116040956
model parameter : 964966
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8734395503997803
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.699 Vali Acc: 0.529 Test Loss: 0.699 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 3.019284725189209
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.664 Vali Acc: 0.590 Test Loss: 0.664 Test Acc: 0.590
Validation loss decreased (-0.529003 --> -0.590437).  Saving model ...
Epoch: 3 cost time: 3.150207042694092
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.611 Vali Acc: 0.686 Test Loss: 0.611 Test Acc: 0.686
Validation loss decreased (-0.590437 --> -0.686001).  Saving model ...
Epoch: 4 cost time: 2.927476644515991
Epoch: 4, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.569 Vali Acc: 0.703 Test Loss: 0.569 Test Acc: 0.703
Validation loss decreased (-0.686001 --> -0.703066).  Saving model ...
Epoch: 5 cost time: 2.7447054386138916
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.703066 --> -0.737196).  Saving model ...
Epoch: 6 cost time: 2.958627700805664
Epoch: 6, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.553 Vali Acc: 0.744 Test Loss: 0.553 Test Acc: 0.744
Validation loss decreased (-0.737196 --> -0.744022).  Saving model ...
Epoch: 7 cost time: 2.9317996501922607
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.522 Vali Acc: 0.734 Test Loss: 0.522 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.923501968383789
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.523 Vali Acc: 0.727 Test Loss: 0.523 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8021702766418457
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.515 Vali Acc: 0.737 Test Loss: 0.515 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.923623561859131
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.519 Vali Acc: 0.741 Test Loss: 0.519 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.849799156188965
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.521 Vali Acc: 0.744 Test Loss: 0.521 Test Acc: 0.744
Validation loss decreased (-0.744022 --> -0.744022).  Saving model ...
Epoch: 12 cost time: 2.9819345474243164
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3449110984802246
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.744022 --> -0.750848).  Saving model ...
Epoch: 14 cost time: 2.6711127758026123
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.754 Test Loss: 0.522 Test Acc: 0.754
Validation loss decreased (-0.750848 --> -0.754261).  Saving model ...
Epoch: 15 cost time: 2.917578935623169
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.526 Vali Acc: 0.754 Test Loss: 0.526 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.102421760559082
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.691817045211792
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.754 Test Loss: 0.528 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7998859882354736
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.758 Test Loss: 0.527 Test Acc: 0.758
Validation loss decreased (-0.754261 --> -0.757674).  Saving model ...
Epoch: 19 cost time: 2.5890204906463623
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.758 Test Loss: 0.531 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7838289737701416
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.758 Test Loss: 0.534 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8448808193206787
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.758 Test Loss: 0.537 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6709892749786377
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.754 Test Loss: 0.537 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9210126399993896
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.754 Test Loss: 0.539 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5460541248321533
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.758 Test Loss: 0.540 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6851840019226074
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.758 Test Loss: 0.542 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.296865701675415
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.758 Test Loss: 0.545 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.970097541809082
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.754 Test Loss: 0.548 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7041802406311035
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.758 Test Loss: 0.546 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.757679180887372
model parameter : 953190
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8984413146972656
Epoch: 1, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.691 Vali Acc: 0.509 Test Loss: 0.691 Test Acc: 0.509
Validation loss decreased (inf --> -0.508526).  Saving model ...
Epoch: 2 cost time: 1.7492353916168213
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.664 Vali Acc: 0.597 Test Loss: 0.664 Test Acc: 0.597
Validation loss decreased (-0.508526 --> -0.597263).  Saving model ...
Epoch: 3 cost time: 1.8656246662139893
Epoch: 3, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.646 Vali Acc: 0.642 Test Loss: 0.646 Test Acc: 0.642
Validation loss decreased (-0.597263 --> -0.641632).  Saving model ...
Epoch: 4 cost time: 1.821711778640747
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.621 Vali Acc: 0.669 Test Loss: 0.621 Test Acc: 0.669
Validation loss decreased (-0.641632 --> -0.668936).  Saving model ...
Epoch: 5 cost time: 1.9833042621612549
Epoch: 5, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.592 Vali Acc: 0.669 Test Loss: 0.592 Test Acc: 0.669
Validation loss decreased (-0.668936 --> -0.668936).  Saving model ...
Epoch: 6 cost time: 2.1805484294891357
Epoch: 6, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.574 Vali Acc: 0.672 Test Loss: 0.574 Test Acc: 0.672
Validation loss decreased (-0.668936 --> -0.672349).  Saving model ...
Epoch: 7 cost time: 2.4412307739257812
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.562 Vali Acc: 0.686 Test Loss: 0.562 Test Acc: 0.686
Validation loss decreased (-0.672349 --> -0.686001).  Saving model ...
Epoch: 8 cost time: 2.145601511001587
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.570 Vali Acc: 0.672 Test Loss: 0.570 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.197435140609741
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.567 Vali Acc: 0.713 Test Loss: 0.567 Test Acc: 0.713
Validation loss decreased (-0.686001 --> -0.713305).  Saving model ...
Epoch: 10 cost time: 2.691807746887207
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.576 Vali Acc: 0.693 Test Loss: 0.576 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.408024311065674
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.569 Vali Acc: 0.703 Test Loss: 0.569 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.185661554336548
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.710 Test Loss: 0.573 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1328084468841553
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.577 Vali Acc: 0.703 Test Loss: 0.577 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1545236110687256
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.713 Test Loss: 0.577 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.061310291290283
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.706 Test Loss: 0.583 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.224245548248291
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.703 Test Loss: 0.585 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0993056297302246
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.710 Test Loss: 0.586 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.171706438064575
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.706 Test Loss: 0.590 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.093740463256836
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.706 Test Loss: 0.594 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7133105802047781
model parameter : 943974
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9874966144561768
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.668 Vali Acc: 0.625 Test Loss: 0.668 Test Acc: 0.625
Validation loss decreased (inf --> -0.624567).  Saving model ...
Epoch: 2 cost time: 1.546678066253662
Epoch: 2, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.654 Vali Acc: 0.631 Test Loss: 0.654 Test Acc: 0.631
Validation loss decreased (-0.624567 --> -0.631393).  Saving model ...
Epoch: 3 cost time: 1.2701151371002197
Epoch: 3, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.632 Vali Acc: 0.642 Test Loss: 0.632 Test Acc: 0.642
Validation loss decreased (-0.631393 --> -0.641632).  Saving model ...
Epoch: 4 cost time: 1.406956672668457
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.642 Vali Acc: 0.604 Test Loss: 0.642 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3596389293670654
Epoch: 5, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.602 Vali Acc: 0.669 Test Loss: 0.602 Test Acc: 0.669
Validation loss decreased (-0.641632 --> -0.668936).  Saving model ...
Epoch: 6 cost time: 1.340580701828003
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.571 Vali Acc: 0.713 Test Loss: 0.571 Test Acc: 0.713
Validation loss decreased (-0.668936 --> -0.713305).  Saving model ...
Epoch: 7 cost time: 1.3777875900268555
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.566 Vali Acc: 0.720 Test Loss: 0.566 Test Acc: 0.720
Validation loss decreased (-0.713305 --> -0.720131).  Saving model ...
Epoch: 8 cost time: 1.349395990371704
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.565 Vali Acc: 0.730 Test Loss: 0.565 Test Acc: 0.730
Validation loss decreased (-0.720131 --> -0.730370).  Saving model ...
Epoch: 9 cost time: 1.371509075164795
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.730 Test Loss: 0.573 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4767284393310547
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3834824562072754
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3716659545898438
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.492255687713623
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2720654010772705
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.730 Test Loss: 0.602 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4821105003356934
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.730 Test Loss: 0.609 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3176629543304443
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3199198246002197
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733782).  Saving model ...
Epoch: 18 cost time: 1.4333667755126953
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.730 Test Loss: 0.624 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4946837425231934
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4700970649719238
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4654664993286133
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.734 Test Loss: 0.637 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3850986957550049
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.724 Test Loss: 0.641 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3480021953582764
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.720 Test Loss: 0.645 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5188789367675781
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5348732471466064
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.724 Test Loss: 0.652 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3942468166351318
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.656 Vali Acc: 0.724 Test Loss: 0.656 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2752540111541748
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.724 Test Loss: 0.660 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7337883959044369
model parameter : 939366
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.153751850128174
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.696 Vali Acc: 0.519 Test Loss: 0.696 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 0.9381632804870605
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.659 Vali Acc: 0.594 Test Loss: 0.659 Test Acc: 0.594
Validation loss decreased (-0.518764 --> -0.593850).  Saving model ...
Epoch: 3 cost time: 1.1363775730133057
Epoch: 3, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.603 Vali Acc: 0.645 Test Loss: 0.603 Test Acc: 0.645
Validation loss decreased (-0.593850 --> -0.645045).  Saving model ...
Epoch: 4 cost time: 1.1928396224975586
Epoch: 4, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.555 Vali Acc: 0.700 Test Loss: 0.555 Test Acc: 0.700
Validation loss decreased (-0.645045 --> -0.699653).  Saving model ...
Epoch: 5 cost time: 1.1765482425689697
Epoch: 5, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.541 Vali Acc: 0.717 Test Loss: 0.541 Test Acc: 0.717
Validation loss decreased (-0.699653 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 1.1841561794281006
Epoch: 6, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.526 Vali Acc: 0.730 Test Loss: 0.526 Test Acc: 0.730
Validation loss decreased (-0.716718 --> -0.730370).  Saving model ...
Epoch: 7 cost time: 1.0211400985717773
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.518 Vali Acc: 0.734 Test Loss: 0.518 Test Acc: 0.734
Validation loss decreased (-0.730370 --> -0.733783).  Saving model ...
Epoch: 8 cost time: 1.000877857208252
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
Validation loss decreased (-0.733783 --> -0.737196).  Saving model ...
Epoch: 9 cost time: 1.256394624710083
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.747 Test Loss: 0.524 Test Acc: 0.747
Validation loss decreased (-0.737196 --> -0.747435).  Saving model ...
Epoch: 10 cost time: 1.1371042728424072
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.133065938949585
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0423624515533447
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.159977674484253
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0209202766418457
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1073594093322754
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0083897113800049
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.744 Test Loss: 0.546 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0359447002410889
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.744 Test Loss: 0.549 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.046325922012329
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.744 Test Loss: 0.551 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.030043601989746
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7474402730375427
model parameter : 934758
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.9032173156738281
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.697 Vali Acc: 0.536 Test Loss: 0.697 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 0.7898476123809814
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.620 Vali Acc: 0.669 Test Loss: 0.620 Test Acc: 0.669
Validation loss decreased (-0.535829 --> -0.668936).  Saving model ...
Epoch: 3 cost time: 0.7396471500396729
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.668936 --> -0.737196).  Saving model ...
Epoch: 4 cost time: 0.778273344039917
Epoch: 4, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
Validation loss decreased (-0.737196 --> -0.761087).  Saving model ...
Epoch: 5 cost time: 0.8117344379425049
Epoch: 5, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.490 Vali Acc: 0.771 Test Loss: 0.490 Test Acc: 0.771
Validation loss decreased (-0.761087 --> -0.771326).  Saving model ...
Epoch: 6 cost time: 0.7144105434417725
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.788 Test Loss: 0.486 Test Acc: 0.788
Validation loss decreased (-0.771326 --> -0.788391).  Saving model ...
Epoch: 7 cost time: 0.5912461280822754
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5751805305480957
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.771 Test Loss: 0.525 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6315903663635254
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.771 Test Loss: 0.538 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5748958587646484
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.782 Test Loss: 0.553 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6006009578704834
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6629111766815186
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.782 Test Loss: 0.582 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5681641101837158
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.778 Test Loss: 0.591 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6236357688903809
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.778 Test Loss: 0.607 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6015713214874268
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.782 Test Loss: 0.610 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6467859745025635
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.778 Test Loss: 0.622 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.78839590443686
model parameter : 930662
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.793318510055542
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.654 Vali Acc: 0.614 Test Loss: 0.654 Test Acc: 0.614
Validation loss decreased (inf --> -0.614328).  Saving model ...
Epoch: 2 cost time: 6.039981842041016
Epoch: 2, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.617 Vali Acc: 0.679 Test Loss: 0.617 Test Acc: 0.679
Validation loss decreased (-0.614328 --> -0.679175).  Saving model ...
Epoch: 3 cost time: 5.760196685791016
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.591 Vali Acc: 0.686 Test Loss: 0.591 Test Acc: 0.686
Validation loss decreased (-0.679175 --> -0.686001).  Saving model ...
Epoch: 4 cost time: 5.7457849979400635
Epoch: 4, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.568 Vali Acc: 0.706 Test Loss: 0.568 Test Acc: 0.706
Validation loss decreased (-0.686001 --> -0.706479).  Saving model ...
Epoch: 5 cost time: 5.929722547531128
Epoch: 5, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.564 Vali Acc: 0.689 Test Loss: 0.564 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.938389778137207
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.562 Vali Acc: 0.710 Test Loss: 0.562 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709892).  Saving model ...
Epoch: 7 cost time: 6.348944187164307
Epoch: 7, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.564 Vali Acc: 0.696 Test Loss: 0.564 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.36910605430603
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.562 Vali Acc: 0.706 Test Loss: 0.562 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.970848798751831
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.696 Test Loss: 0.562 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.227546453475952
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.703 Test Loss: 0.566 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.274071216583252
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.574 Vali Acc: 0.696 Test Loss: 0.574 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.454830646514893
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.710 Test Loss: 0.574 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.28741455078125
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.706 Test Loss: 0.577 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.7481160163879395
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.706 Test Loss: 0.577 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.427052021026611
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.706 Test Loss: 0.579 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.328033924102783
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.703 Test Loss: 0.578 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7098976109215017
model parameter : 987430
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.271970987319946
Epoch: 1, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (inf --> -0.580198).  Saving model ...
Epoch: 2 cost time: 4.9505579471588135
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.648 Vali Acc: 0.628 Test Loss: 0.648 Test Acc: 0.628
Validation loss decreased (-0.580198 --> -0.627980).  Saving model ...
Epoch: 3 cost time: 4.664244174957275
Epoch: 3, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.602 Vali Acc: 0.676 Test Loss: 0.602 Test Acc: 0.676
Validation loss decreased (-0.627980 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 5.252912759780884
Epoch: 4, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.576 Vali Acc: 0.693 Test Loss: 0.576 Test Acc: 0.693
Validation loss decreased (-0.675762 --> -0.692827).  Saving model ...
Epoch: 5 cost time: 4.892072916030884
Epoch: 5, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (-0.692827 --> -0.726957).  Saving model ...
Epoch: 6 cost time: 5.341334342956543
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.559 Vali Acc: 0.734 Test Loss: 0.559 Test Acc: 0.734
Validation loss decreased (-0.726957 --> -0.733783).  Saving model ...
Epoch: 7 cost time: 5.27365779876709
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.562 Vali Acc: 0.720 Test Loss: 0.562 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.308511972427368
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.188259601593018
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.563 Vali Acc: 0.703 Test Loss: 0.563 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.140914678573608
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.565 Vali Acc: 0.706 Test Loss: 0.565 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.367295265197754
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.262482166290283
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.571 Vali Acc: 0.713 Test Loss: 0.571 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.438966274261475
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.980391025543213
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.706 Test Loss: 0.577 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.8383965492248535
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.706 Test Loss: 0.579 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.9085211753845215
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.703 Test Loss: 0.583 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7337883959044369
model parameter : 976166
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.53886342048645
Epoch: 1, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.720 Vali Acc: 0.536 Test Loss: 0.720 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 3.819810628890991
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.681 Vali Acc: 0.584 Test Loss: 0.681 Test Acc: 0.584
Validation loss decreased (-0.535829 --> -0.583611).  Saving model ...
Epoch: 3 cost time: 3.6521358489990234
Epoch: 3, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.651 Vali Acc: 0.625 Test Loss: 0.651 Test Acc: 0.625
Validation loss decreased (-0.583611 --> -0.624567).  Saving model ...
Epoch: 4 cost time: 3.585625410079956
Epoch: 4, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.627 Vali Acc: 0.638 Test Loss: 0.627 Test Acc: 0.638
Validation loss decreased (-0.624567 --> -0.638219).  Saving model ...
Epoch: 5 cost time: 3.7617969512939453
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.621 Vali Acc: 0.679 Test Loss: 0.621 Test Acc: 0.679
Validation loss decreased (-0.638219 --> -0.679175).  Saving model ...
Epoch: 6 cost time: 3.7561845779418945
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.627 Vali Acc: 0.700 Test Loss: 0.627 Test Acc: 0.700
Validation loss decreased (-0.679175 --> -0.699652).  Saving model ...
Epoch: 7 cost time: 4.145341157913208
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.620 Vali Acc: 0.700 Test Loss: 0.620 Test Acc: 0.700
Validation loss decreased (-0.699652 --> -0.699652).  Saving model ...
Epoch: 8 cost time: 3.92927622795105
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.623 Vali Acc: 0.693 Test Loss: 0.623 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.125797748565674
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.631 Vali Acc: 0.703 Test Loss: 0.631 Test Acc: 0.703
Validation loss decreased (-0.699652 --> -0.703065).  Saving model ...
Epoch: 10 cost time: 3.8564226627349854
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.632 Vali Acc: 0.693 Test Loss: 0.632 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8543715476989746
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.693 Test Loss: 0.633 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.465341567993164
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.686 Test Loss: 0.636 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.843040704727173
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.686 Test Loss: 0.640 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.301133871078491
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.683 Test Loss: 0.643 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.146965265274048
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.683 Test Loss: 0.646 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.204845428466797
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.689 Test Loss: 0.648 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.04754638671875
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.686 Test Loss: 0.652 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.015238046646118
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.693 Test Loss: 0.654 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.966953277587891
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.700 Test Loss: 0.655 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7030716723549488
model parameter : 964902
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8607943058013916
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.674 Vali Acc: 0.577 Test Loss: 0.674 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 2.8545706272125244
Epoch: 2, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.645 Vali Acc: 0.614 Test Loss: 0.645 Test Acc: 0.614
Validation loss decreased (-0.576785 --> -0.614328).  Saving model ...
Epoch: 3 cost time: 2.7055745124816895
Epoch: 3, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.617 Vali Acc: 0.662 Test Loss: 0.617 Test Acc: 0.662
Validation loss decreased (-0.614328 --> -0.662110).  Saving model ...
Epoch: 4 cost time: 2.724071502685547
Epoch: 4, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.599 Vali Acc: 0.648 Test Loss: 0.599 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6150729656219482
Epoch: 5, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.597 Vali Acc: 0.689 Test Loss: 0.597 Test Acc: 0.689
Validation loss decreased (-0.662110 --> -0.689414).  Saving model ...
Epoch: 6 cost time: 2.6907567977905273
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.592 Vali Acc: 0.689 Test Loss: 0.592 Test Acc: 0.689
Validation loss decreased (-0.689414 --> -0.689414).  Saving model ...
Epoch: 7 cost time: 2.5912210941314697
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.596 Vali Acc: 0.689 Test Loss: 0.596 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.423715114593506
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.598 Vali Acc: 0.706 Test Loss: 0.598 Test Acc: 0.706
Validation loss decreased (-0.689414 --> -0.706479).  Saving model ...
Epoch: 9 cost time: 2.8225131034851074
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.703 Test Loss: 0.603 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.610520124435425
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.706 Test Loss: 0.606 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6756064891815186
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.710 Test Loss: 0.606 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709892).  Saving model ...
Epoch: 12 cost time: 2.6649038791656494
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.700 Test Loss: 0.609 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7349185943603516
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.706 Test Loss: 0.612 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8695199489593506
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.706 Test Loss: 0.616 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9331843852996826
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.703 Test Loss: 0.620 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0069591999053955
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.706 Test Loss: 0.621 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6752827167510986
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.706 Test Loss: 0.623 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.860384464263916
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.703 Test Loss: 0.626 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5345630645751953
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.700 Test Loss: 0.628 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6604104042053223
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.700 Test Loss: 0.632 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0014686584472656
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.703 Test Loss: 0.634 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7098976109215017
model parameter : 953126
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8888230323791504
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (inf --> -0.580198).  Saving model ...
Epoch: 2 cost time: 1.9142935276031494
Epoch: 2, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.655 Vali Acc: 0.601 Test Loss: 0.655 Test Acc: 0.601
Validation loss decreased (-0.580198 --> -0.600676).  Saving model ...
Epoch: 3 cost time: 1.7608137130737305
Epoch: 3, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.623 Vali Acc: 0.655 Test Loss: 0.623 Test Acc: 0.655
Validation loss decreased (-0.600676 --> -0.655284).  Saving model ...
Epoch: 4 cost time: 1.8806111812591553
Epoch: 4, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.607 Vali Acc: 0.679 Test Loss: 0.607 Test Acc: 0.679
Validation loss decreased (-0.655284 --> -0.679175).  Saving model ...
Epoch: 5 cost time: 1.8818747997283936
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.592 Vali Acc: 0.689 Test Loss: 0.592 Test Acc: 0.689
Validation loss decreased (-0.679175 --> -0.689414).  Saving model ...
Epoch: 6 cost time: 1.7496120929718018
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.587 Vali Acc: 0.696 Test Loss: 0.587 Test Acc: 0.696
Validation loss decreased (-0.689414 --> -0.696240).  Saving model ...
Epoch: 7 cost time: 1.874786615371704
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.595 Vali Acc: 0.689 Test Loss: 0.595 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6607592105865479
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.700 Test Loss: 0.592 Test Acc: 0.700
Validation loss decreased (-0.696240 --> -0.699653).  Saving model ...
Epoch: 9 cost time: 1.7215111255645752
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (-0.699653 --> -0.716718).  Saving model ...
Epoch: 10 cost time: 1.821403980255127
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.592 Vali Acc: 0.713 Test Loss: 0.592 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.789849042892456
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.713 Test Loss: 0.594 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.819413185119629
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.700 Test Loss: 0.597 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7366375923156738
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.713 Test Loss: 0.598 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.81602144241333
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.706 Test Loss: 0.601 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7923853397369385
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.713 Test Loss: 0.603 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7932655811309814
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.713 Test Loss: 0.604 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8871946334838867
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.710 Test Loss: 0.607 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.714752435684204
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.720 Test Loss: 0.606 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720130).  Saving model ...
Epoch: 19 cost time: 1.8459749221801758
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0421528816223145
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9485080242156982
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9207804203033447
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.720 Test Loss: 0.615 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.985990285873413
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.720 Test Loss: 0.616 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9093871116638184
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8629262447357178
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.720 Test Loss: 0.619 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.977301836013794
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.720 Test Loss: 0.621 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.019258737564087
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.720 Test Loss: 0.623 Test Acc: 0.720
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.137112855911255
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7201365187713311
model parameter : 943910
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8952431678771973
Epoch: 1, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.707 Vali Acc: 0.532 Test Loss: 0.707 Test Acc: 0.532
Validation loss decreased (inf --> -0.532416).  Saving model ...
Epoch: 2 cost time: 1.4818074703216553
Epoch: 2, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.663 Vali Acc: 0.604 Test Loss: 0.663 Test Acc: 0.604
Validation loss decreased (-0.532416 --> -0.604089).  Saving model ...
Epoch: 3 cost time: 1.4257025718688965
Epoch: 3, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.635 Vali Acc: 0.628 Test Loss: 0.635 Test Acc: 0.628
Validation loss decreased (-0.604089 --> -0.627980).  Saving model ...
Epoch: 4 cost time: 1.519223690032959
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.625 Vali Acc: 0.666 Test Loss: 0.625 Test Acc: 0.666
Validation loss decreased (-0.627980 --> -0.665523).  Saving model ...
Epoch: 5 cost time: 1.4273107051849365
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.612 Vali Acc: 0.676 Test Loss: 0.612 Test Acc: 0.676
Validation loss decreased (-0.665523 --> -0.675762).  Saving model ...
Epoch: 6 cost time: 1.4617600440979004
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.612 Vali Acc: 0.666 Test Loss: 0.612 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6044104099273682
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.615 Vali Acc: 0.693 Test Loss: 0.615 Test Acc: 0.693
Validation loss decreased (-0.675762 --> -0.692827).  Saving model ...
Epoch: 8 cost time: 1.388012409210205
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.686 Test Loss: 0.619 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4485270977020264
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.693 Test Loss: 0.623 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.430323839187622
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.696 Test Loss: 0.625 Test Acc: 0.696
Validation loss decreased (-0.692827 --> -0.696239).  Saving model ...
Epoch: 11 cost time: 1.4369001388549805
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.696 Test Loss: 0.627 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4416396617889404
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.700 Test Loss: 0.630 Test Acc: 0.700
Validation loss decreased (-0.696239 --> -0.699652).  Saving model ...
Epoch: 13 cost time: 1.3930516242980957
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.693 Test Loss: 0.633 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3881924152374268
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.693 Test Loss: 0.636 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.340613842010498
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.696 Test Loss: 0.640 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4124858379364014
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.693 Test Loss: 0.642 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3626878261566162
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.693 Test Loss: 0.645 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3745040893554688
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.696 Test Loss: 0.647 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4630863666534424
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.696 Test Loss: 0.650 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3356497287750244
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.706 Test Loss: 0.652 Test Acc: 0.706
Validation loss decreased (-0.699652 --> -0.706478).  Saving model ...
Epoch: 21 cost time: 1.3299236297607422
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.703 Test Loss: 0.655 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4440207481384277
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.703 Test Loss: 0.657 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4288311004638672
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.696 Test Loss: 0.660 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5017590522766113
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.700 Test Loss: 0.662 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.568695306777954
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.700 Test Loss: 0.664 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6022381782531738
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.703 Test Loss: 0.665 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4152655601501465
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.706 Test Loss: 0.667 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3709328174591064
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.706 Test Loss: 0.669 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4122788906097412
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.700 Test Loss: 0.671 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3919882774353027
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.703 Test Loss: 0.673 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7064846416382252
model parameter : 939302
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.1488964557647705
Epoch: 1, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.687 Vali Acc: 0.543 Test Loss: 0.687 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 0.9341738224029541
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.653 Vali Acc: 0.635 Test Loss: 0.653 Test Acc: 0.635
Validation loss decreased (-0.542655 --> -0.634806).  Saving model ...
Epoch: 3 cost time: 0.9375360012054443
Epoch: 3, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.627 Vali Acc: 0.662 Test Loss: 0.627 Test Acc: 0.662
Validation loss decreased (-0.634806 --> -0.662110).  Saving model ...
Epoch: 4 cost time: 0.9128916263580322
Epoch: 4, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.609 Vali Acc: 0.638 Test Loss: 0.609 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9271395206451416
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.598 Vali Acc: 0.662 Test Loss: 0.598 Test Acc: 0.662
Validation loss decreased (-0.662110 --> -0.662110).  Saving model ...
Epoch: 6 cost time: 0.8664896488189697
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.591 Vali Acc: 0.666 Test Loss: 0.591 Test Acc: 0.666
Validation loss decreased (-0.662110 --> -0.665523).  Saving model ...
Epoch: 7 cost time: 0.9728155136108398
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.662 Test Loss: 0.594 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9794316291809082
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.672 Test Loss: 0.595 Test Acc: 0.672
Validation loss decreased (-0.665523 --> -0.672349).  Saving model ...
Epoch: 9 cost time: 0.9517271518707275
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.596 Vali Acc: 0.672 Test Loss: 0.596 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9600884914398193
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.672 Test Loss: 0.599 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.952195405960083
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.672 Test Loss: 0.599 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9765496253967285
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.672 Test Loss: 0.599 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8704845905303955
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.679 Test Loss: 0.602 Test Acc: 0.679
Validation loss decreased (-0.672349 --> -0.679175).  Saving model ...
Epoch: 14 cost time: 0.9446232318878174
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.676 Test Loss: 0.606 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.878136157989502
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.683 Test Loss: 0.607 Test Acc: 0.683
Validation loss decreased (-0.679175 --> -0.682588).  Saving model ...
Epoch: 16 cost time: 0.9391939640045166
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.683 Test Loss: 0.608 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.94870924949646
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.686 Test Loss: 0.610 Test Acc: 0.686
Validation loss decreased (-0.682588 --> -0.686001).  Saving model ...
Epoch: 18 cost time: 0.9495205879211426
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.689 Test Loss: 0.612 Test Acc: 0.689
Validation loss decreased (-0.686001 --> -0.689414).  Saving model ...
Epoch: 19 cost time: 0.9127156734466553
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.689 Test Loss: 0.614 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9269967079162598
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.689 Test Loss: 0.617 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9378936290740967
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.696 Test Loss: 0.617 Test Acc: 0.696
Validation loss decreased (-0.689414 --> -0.696240).  Saving model ...
Epoch: 22 cost time: 0.8165102005004883
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.696 Test Loss: 0.619 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0057697296142578
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.696 Test Loss: 0.621 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9991137981414795
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.696 Test Loss: 0.623 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8915400505065918
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8723616600036621
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9193544387817383
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.696 Test Loss: 0.627 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8587982654571533
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.700 Test Loss: 0.629 Test Acc: 0.700
Validation loss decreased (-0.696240 --> -0.699652).  Saving model ...
Epoch: 29 cost time: 0.8842127323150635
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.700 Test Loss: 0.631 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9040067195892334
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.700 Test Loss: 0.632 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9868853092193604
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.700 Test Loss: 0.633 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9935500621795654
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.700 Test Loss: 0.635 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9591512680053711
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.700 Test Loss: 0.637 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9954555034637451
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.700 Test Loss: 0.638 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0156481266021729
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.700 Test Loss: 0.639 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0212063789367676
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.700 Test Loss: 0.641 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0631513595581055
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.700 Test Loss: 0.642 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0307042598724365
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.700 Test Loss: 0.643 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 934694
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.8227109909057617
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.686 Vali Acc: 0.546 Test Loss: 0.686 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 0.5341877937316895
Epoch: 2, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.648 Vali Acc: 0.594 Test Loss: 0.648 Test Acc: 0.594
Validation loss decreased (-0.546068 --> -0.593850).  Saving model ...
Epoch: 3 cost time: 0.6403274536132812
Epoch: 3, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.602 Vali Acc: 0.635 Test Loss: 0.602 Test Acc: 0.635
Validation loss decreased (-0.593850 --> -0.634806).  Saving model ...
Epoch: 4 cost time: 0.6178135871887207
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.584 Vali Acc: 0.672 Test Loss: 0.584 Test Acc: 0.672
Validation loss decreased (-0.634806 --> -0.672349).  Saving model ...
Epoch: 5 cost time: 0.6497945785522461
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.672 Test Loss: 0.597 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6047158241271973
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.693 Test Loss: 0.601 Test Acc: 0.693
Validation loss decreased (-0.672349 --> -0.692827).  Saving model ...
Epoch: 7 cost time: 0.5091652870178223
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.700 Test Loss: 0.606 Test Acc: 0.700
Validation loss decreased (-0.692827 --> -0.699653).  Saving model ...
Epoch: 8 cost time: 0.6117298603057861
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.696 Test Loss: 0.609 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6556310653686523
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.710 Test Loss: 0.617 Test Acc: 0.710
Validation loss decreased (-0.699653 --> -0.709891).  Saving model ...
Epoch: 10 cost time: 0.6203358173370361
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.710 Test Loss: 0.621 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6564183235168457
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.713 Test Loss: 0.627 Test Acc: 0.713
Validation loss decreased (-0.709891 --> -0.713304).  Saving model ...
Epoch: 12 cost time: 0.5446052551269531
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.710 Test Loss: 0.631 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6843056678771973
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.713 Test Loss: 0.638 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5459549427032471
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.710 Test Loss: 0.643 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4818570613861084
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.720 Test Loss: 0.648 Test Acc: 0.720
Validation loss decreased (-0.713304 --> -0.720130).  Saving model ...
Epoch: 16 cost time: 0.4719209671020508
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.570237398147583
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.720 Test Loss: 0.658 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5064594745635986
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.720 Test Loss: 0.662 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5392100811004639
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.720 Test Loss: 0.667 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.553663969039917
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.720 Test Loss: 0.670 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5749003887176514
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.720 Test Loss: 0.674 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5424370765686035
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.724 Test Loss: 0.677 Test Acc: 0.724
Validation loss decreased (-0.720130 --> -0.723543).  Saving model ...
Epoch: 23 cost time: 0.512202262878418
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.724 Test Loss: 0.680 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5743811130523682
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.724 Test Loss: 0.684 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5577399730682373
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.724 Test Loss: 0.689 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6425685882568359
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.724 Test Loss: 0.691 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6776440143585205
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.724 Test Loss: 0.696 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.537029504776001
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.730 Test Loss: 0.700 Test Acc: 0.730
Validation loss decreased (-0.723543 --> -0.730368).  Saving model ...
Epoch: 29 cost time: 0.5171623229980469
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.727 Test Loss: 0.703 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5428435802459717
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.730 Test Loss: 0.705 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5575966835021973
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.727 Test Loss: 0.709 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6754343509674072
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5668864250183105
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.730 Test Loss: 0.714 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5455026626586914
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.730 Test Loss: 0.718 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5724165439605713
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.730 Test Loss: 0.720 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5732903480529785
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6393640041351318
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.727 Test Loss: 0.727 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5824630260467529
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.730 Test Loss: 0.729 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7303754266211604
model parameter : 930598
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.898367643356323
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.731 Vali Acc: 0.485 Test Loss: 0.731 Test Acc: 0.485
Validation loss decreased (inf --> -0.484634).  Saving model ...
Epoch: 2 cost time: 6.219343185424805
Epoch: 2, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.684 Vali Acc: 0.543 Test Loss: 0.684 Test Acc: 0.543
Validation loss decreased (-0.484634 --> -0.542655).  Saving model ...
Epoch: 3 cost time: 5.832628965377808
Epoch: 3, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.678 Vali Acc: 0.560 Test Loss: 0.678 Test Acc: 0.560
Validation loss decreased (-0.542655 --> -0.559720).  Saving model ...
Epoch: 4 cost time: 6.4352850914001465
Epoch: 4, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.650 Vali Acc: 0.577 Test Loss: 0.650 Test Acc: 0.577
Validation loss decreased (-0.559720 --> -0.576785).  Saving model ...
Epoch: 5 cost time: 6.132236480712891
Epoch: 5, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.597 Vali Acc: 0.720 Test Loss: 0.597 Test Acc: 0.720
Validation loss decreased (-0.576785 --> -0.720131).  Saving model ...
Epoch: 6 cost time: 6.950521469116211
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.568 Vali Acc: 0.730 Test Loss: 0.568 Test Acc: 0.730
Validation loss decreased (-0.720131 --> -0.730370).  Saving model ...
Epoch: 7 cost time: 6.524854898452759
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.567 Vali Acc: 0.710 Test Loss: 0.567 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.211212158203125
Epoch: 8, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.519 Vali Acc: 0.758 Test Loss: 0.519 Test Acc: 0.758
Validation loss decreased (-0.730370 --> -0.757674).  Saving model ...
Epoch: 9 cost time: 5.895311117172241
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.521 Vali Acc: 0.758 Test Loss: 0.521 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.087815284729004
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.508 Vali Acc: 0.758 Test Loss: 0.508 Test Acc: 0.758
Validation loss decreased (-0.757674 --> -0.757674).  Saving model ...
Epoch: 11 cost time: 5.909171104431152
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.505 Vali Acc: 0.771 Test Loss: 0.505 Test Acc: 0.771
Validation loss decreased (-0.757674 --> -0.771326).  Saving model ...
Epoch: 12 cost time: 5.776682138442993
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.507 Vali Acc: 0.765 Test Loss: 0.507 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.148020267486572
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.512 Vali Acc: 0.775 Test Loss: 0.512 Test Acc: 0.775
Validation loss decreased (-0.771326 --> -0.774739).  Saving model ...
Epoch: 14 cost time: 5.932745695114136
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.462834119796753
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.771 Test Loss: 0.517 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.953597068786621
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.778 Test Loss: 0.526 Test Acc: 0.778
Validation loss decreased (-0.774739 --> -0.778152).  Saving model ...
Epoch: 17 cost time: 6.591610670089722
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.813632249832153
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.778 Test Loss: 0.532 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.762689590454102
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.768 Test Loss: 0.539 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.041106224060059
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.771 Test Loss: 0.540 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.908259153366089
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.545 Vali Acc: 0.771 Test Loss: 0.545 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.0492095947265625
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.768 Test Loss: 0.547 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.2028968334198
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.768 Test Loss: 0.552 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.178614139556885
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.765 Test Loss: 0.555 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.502664804458618
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.765 Test Loss: 0.559 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.823745489120483
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.768 Test Loss: 0.564 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7781569965870307
model parameter : 500122
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.9795989990234375
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.700 Vali Acc: 0.522 Test Loss: 0.700 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 5.136778116226196
Epoch: 2, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.679 Vali Acc: 0.563 Test Loss: 0.679 Test Acc: 0.563
Validation loss decreased (-0.522177 --> -0.563133).  Saving model ...
Epoch: 3 cost time: 4.660171985626221
Epoch: 3, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.667 Vali Acc: 0.573 Test Loss: 0.667 Test Acc: 0.573
Validation loss decreased (-0.563133 --> -0.573372).  Saving model ...
Epoch: 4 cost time: 4.866374969482422
Epoch: 4, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.653 Vali Acc: 0.621 Test Loss: 0.653 Test Acc: 0.621
Validation loss decreased (-0.573372 --> -0.621154).  Saving model ...
Epoch: 5 cost time: 4.918849945068359
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.631 Vali Acc: 0.676 Test Loss: 0.631 Test Acc: 0.676
Validation loss decreased (-0.621154 --> -0.675762).  Saving model ...
Epoch: 6 cost time: 5.288554668426514
Epoch: 6, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.613 Vali Acc: 0.693 Test Loss: 0.613 Test Acc: 0.693
Validation loss decreased (-0.675762 --> -0.692827).  Saving model ...
Epoch: 7 cost time: 5.481531381607056
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.601 Vali Acc: 0.710 Test Loss: 0.601 Test Acc: 0.710
Validation loss decreased (-0.692827 --> -0.709892).  Saving model ...
Epoch: 8 cost time: 5.085453987121582
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.599 Vali Acc: 0.703 Test Loss: 0.599 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.805495500564575
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (-0.709892 --> -0.716718).  Saving model ...
Epoch: 10 cost time: 4.8383471965789795
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.710 Test Loss: 0.599 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.954469203948975
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.589 Vali Acc: 0.720 Test Loss: 0.589 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720131).  Saving model ...
Epoch: 12 cost time: 4.798118829727173
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.724 Test Loss: 0.595 Test Acc: 0.724
Validation loss decreased (-0.720131 --> -0.723544).  Saving model ...
Epoch: 13 cost time: 4.936328887939453
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.598 Vali Acc: 0.724 Test Loss: 0.598 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.333469867706299
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.598 Vali Acc: 0.724 Test Loss: 0.598 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.908642530441284
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.720 Test Loss: 0.602 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.919399261474609
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.738994836807251
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.720 Test Loss: 0.610 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.754789352416992
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.613 Vali Acc: 0.730 Test Loss: 0.613 Test Acc: 0.730
Validation loss decreased (-0.723544 --> -0.730369).  Saving model ...
Epoch: 19 cost time: 5.3525331020355225
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.724 Test Loss: 0.615 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.980659484863281
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.617 Vali Acc: 0.724 Test Loss: 0.617 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.030605792999268
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.620 Vali Acc: 0.724 Test Loss: 0.620 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.367172002792358
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.35561203956604
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.724 Test Loss: 0.626 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.900733232498169
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.1221842765808105
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.377318620681763
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.724 Test Loss: 0.631 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.5672900676727295
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.853739500045776
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7303754266211604
model parameter : 494490
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.826183319091797
Epoch: 1, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.687 Vali Acc: 0.543 Test Loss: 0.687 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 3.8887407779693604
Epoch: 2, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.668 Vali Acc: 0.580 Test Loss: 0.668 Test Acc: 0.580
Validation loss decreased (-0.542655 --> -0.580198).  Saving model ...
Epoch: 3 cost time: 3.4396579265594482
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.639 Vali Acc: 0.628 Test Loss: 0.639 Test Acc: 0.628
Validation loss decreased (-0.580198 --> -0.627980).  Saving model ...
Epoch: 4 cost time: 3.515596389770508
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.618 Vali Acc: 0.652 Test Loss: 0.618 Test Acc: 0.652
Validation loss decreased (-0.627980 --> -0.651871).  Saving model ...
Epoch: 5 cost time: 4.336395502090454
Epoch: 5, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.600 Vali Acc: 0.686 Test Loss: 0.600 Test Acc: 0.686
Validation loss decreased (-0.651871 --> -0.686001).  Saving model ...
Epoch: 6 cost time: 3.943185567855835
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.578 Vali Acc: 0.686 Test Loss: 0.578 Test Acc: 0.686
Validation loss decreased (-0.686001 --> -0.686001).  Saving model ...
Epoch: 7 cost time: 3.961111307144165
Epoch: 7, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.576 Vali Acc: 0.713 Test Loss: 0.576 Test Acc: 0.713
Validation loss decreased (-0.686001 --> -0.713305).  Saving model ...
Epoch: 8 cost time: 4.138166904449463
Epoch: 8, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.569 Vali Acc: 0.710 Test Loss: 0.569 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1307127475738525
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.573 Vali Acc: 0.713 Test Loss: 0.573 Test Acc: 0.713
Validation loss decreased (-0.713305 --> -0.713305).  Saving model ...
Epoch: 10 cost time: 4.163742542266846
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.571 Vali Acc: 0.713 Test Loss: 0.571 Test Acc: 0.713
Validation loss decreased (-0.713305 --> -0.713305).  Saving model ...
Epoch: 11 cost time: 4.3497536182403564
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.577 Vali Acc: 0.713 Test Loss: 0.577 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.110081195831299
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.580 Vali Acc: 0.724 Test Loss: 0.580 Test Acc: 0.724
Validation loss decreased (-0.713305 --> -0.723544).  Saving model ...
Epoch: 13 cost time: 4.351219415664673
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
Validation loss decreased (-0.723544 --> -0.726957).  Saving model ...
Epoch: 14 cost time: 3.989811658859253
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8600974082946777
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.592 Vali Acc: 0.720 Test Loss: 0.592 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.708385944366455
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.136721134185791
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.004165887832642
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.730 Test Loss: 0.602 Test Acc: 0.730
Validation loss decreased (-0.726957 --> -0.730369).  Saving model ...
Epoch: 19 cost time: 4.096660137176514
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.730 Test Loss: 0.607 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.986849546432495
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.730 Test Loss: 0.611 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.93967342376709
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.730 Test Loss: 0.613 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.2732977867126465
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.079381227493286
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
Validation loss decreased (-0.730369 --> -0.733782).  Saving model ...
Epoch: 24 cost time: 3.923764944076538
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.734 Test Loss: 0.620 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.3403661251068115
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
Validation loss decreased (-0.733782 --> -0.740608).  Saving model ...
Epoch: 26 cost time: 4.21722149848938
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.734 Test Loss: 0.628 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.478092432022095
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.734 Test Loss: 0.630 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8469655513763428
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.734 Test Loss: 0.631 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.4102747440338135
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.493762731552124
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.183842420578003
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.190712213516235
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.511974811553955
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.081270456314087
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.13354229927063
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.741 Test Loss: 0.648 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 488858
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.906327486038208
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.697 Vali Acc: 0.543 Test Loss: 0.697 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 2.8684215545654297
Epoch: 2, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.679 Vali Acc: 0.546 Test Loss: 0.679 Test Acc: 0.546
Validation loss decreased (-0.542655 --> -0.546068).  Saving model ...
Epoch: 3 cost time: 2.711228370666504
Epoch: 3, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.684 Vali Acc: 0.577 Test Loss: 0.684 Test Acc: 0.577
Validation loss decreased (-0.546068 --> -0.576785).  Saving model ...
Epoch: 4 cost time: 2.726623058319092
Epoch: 4, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.646 Vali Acc: 0.608 Test Loss: 0.646 Test Acc: 0.608
Validation loss decreased (-0.576785 --> -0.607502).  Saving model ...
Epoch: 5 cost time: 2.752448797225952
Epoch: 5, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.656 Vali Acc: 0.631 Test Loss: 0.656 Test Acc: 0.631
Validation loss decreased (-0.607502 --> -0.631393).  Saving model ...
Epoch: 6 cost time: 2.992154598236084
Epoch: 6, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.631 Vali Acc: 0.638 Test Loss: 0.631 Test Acc: 0.638
Validation loss decreased (-0.631393 --> -0.638219).  Saving model ...
Epoch: 7 cost time: 2.7755022048950195
Epoch: 7, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.631 Vali Acc: 0.638 Test Loss: 0.631 Test Acc: 0.638
Validation loss decreased (-0.638219 --> -0.638219).  Saving model ...
Epoch: 8 cost time: 2.8245301246643066
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.649 Vali Acc: 0.635 Test Loss: 0.649 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.876000165939331
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.650 Vali Acc: 0.666 Test Loss: 0.650 Test Acc: 0.666
Validation loss decreased (-0.638219 --> -0.665523).  Saving model ...
Epoch: 10 cost time: 2.7902274131774902
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.653 Vali Acc: 0.666 Test Loss: 0.653 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0155909061431885
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.659 Vali Acc: 0.669 Test Loss: 0.659 Test Acc: 0.669
Validation loss decreased (-0.665523 --> -0.668935).  Saving model ...
Epoch: 12 cost time: 2.956757068634033
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.669 Test Loss: 0.669 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6923959255218506
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.674 Vali Acc: 0.666 Test Loss: 0.674 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7844221591949463
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.681 Vali Acc: 0.666 Test Loss: 0.681 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.851635456085205
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.688 Vali Acc: 0.659 Test Loss: 0.688 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8286755084991455
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.696 Vali Acc: 0.669 Test Loss: 0.696 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9345431327819824
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.701 Vali Acc: 0.662 Test Loss: 0.701 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.251337766647339
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.706 Vali Acc: 0.666 Test Loss: 0.706 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9070165157318115
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.662 Test Loss: 0.712 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9199349880218506
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.666 Test Loss: 0.716 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.374791145324707
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.662 Test Loss: 0.722 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6689419795221843
model parameter : 482970
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.081386089324951
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.704 Vali Acc: 0.505 Test Loss: 0.704 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 2.0255820751190186
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.675 Vali Acc: 0.584 Test Loss: 0.675 Test Acc: 0.584
Validation loss decreased (-0.505112 --> -0.583611).  Saving model ...
Epoch: 3 cost time: 1.986018419265747
Epoch: 3, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.659 Vali Acc: 0.597 Test Loss: 0.659 Test Acc: 0.597
Validation loss decreased (-0.583611 --> -0.597263).  Saving model ...
Epoch: 4 cost time: 1.8621034622192383
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.643 Vali Acc: 0.614 Test Loss: 0.643 Test Acc: 0.614
Validation loss decreased (-0.597263 --> -0.614328).  Saving model ...
Epoch: 5 cost time: 1.8452460765838623
Epoch: 5, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.607 Vali Acc: 0.666 Test Loss: 0.607 Test Acc: 0.666
Validation loss decreased (-0.614328 --> -0.665523).  Saving model ...
Epoch: 6 cost time: 1.7969801425933838
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.593 Vali Acc: 0.683 Test Loss: 0.593 Test Acc: 0.683
Validation loss decreased (-0.665523 --> -0.682588).  Saving model ...
Epoch: 7 cost time: 1.854032278060913
Epoch: 7, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.575 Vali Acc: 0.693 Test Loss: 0.575 Test Acc: 0.693
Validation loss decreased (-0.682588 --> -0.692827).  Saving model ...
Epoch: 8 cost time: 1.825143575668335
Epoch: 8, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.572 Vali Acc: 0.689 Test Loss: 0.572 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6403205394744873
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.573 Vali Acc: 0.706 Test Loss: 0.573 Test Acc: 0.706
Validation loss decreased (-0.692827 --> -0.706479).  Saving model ...
Epoch: 10 cost time: 1.7763023376464844
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.700 Test Loss: 0.575 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.923163890838623
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.580 Vali Acc: 0.703 Test Loss: 0.580 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.906808853149414
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.700 Test Loss: 0.581 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.04355525970459
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.700 Test Loss: 0.583 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.000762939453125
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.710 Test Loss: 0.585 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709892).  Saving model ...
Epoch: 15 cost time: 1.8592321872711182
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.587 Vali Acc: 0.710 Test Loss: 0.587 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.111008644104004
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.590 Vali Acc: 0.710 Test Loss: 0.590 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9065089225769043
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.710 Test Loss: 0.592 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.99336576461792
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
Validation loss decreased (-0.709892 --> -0.716718).  Saving model ...
Epoch: 19 cost time: 1.8767812252044678
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0362062454223633
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9501333236694336
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.720 Test Loss: 0.602 Test Acc: 0.720
Validation loss decreased (-0.716718 --> -0.720130).  Saving model ...
Epoch: 22 cost time: 1.8594658374786377
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.710 Test Loss: 0.604 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.882261037826538
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.720 Test Loss: 0.608 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9315288066864014
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9041314125061035
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.720 Test Loss: 0.614 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.070648431777954
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9609622955322266
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.720 Test Loss: 0.617 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0733277797698975
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.879321813583374
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.051076650619507
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9003994464874268
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.720 Test Loss: 0.625 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7201365187713311
model parameter : 478362
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.642003297805786
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.715 Vali Acc: 0.474 Test Loss: 0.715 Test Acc: 0.474
Validation loss decreased (inf --> -0.474396).  Saving model ...
Epoch: 2 cost time: 1.4502463340759277
Epoch: 2, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.690 Vali Acc: 0.526 Test Loss: 0.690 Test Acc: 0.526
Validation loss decreased (-0.474396 --> -0.525590).  Saving model ...
Epoch: 3 cost time: 1.3430266380310059
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.660 Vali Acc: 0.590 Test Loss: 0.660 Test Acc: 0.590
Validation loss decreased (-0.525590 --> -0.590437).  Saving model ...
Epoch: 4 cost time: 1.3889074325561523
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.639 Vali Acc: 0.625 Test Loss: 0.639 Test Acc: 0.625
Validation loss decreased (-0.590437 --> -0.624567).  Saving model ...
Epoch: 5 cost time: 1.4996631145477295
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.625 Vali Acc: 0.645 Test Loss: 0.625 Test Acc: 0.645
Validation loss decreased (-0.624567 --> -0.645045).  Saving model ...
Epoch: 6 cost time: 1.5509414672851562
Epoch: 6, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.613 Vali Acc: 0.666 Test Loss: 0.613 Test Acc: 0.666
Validation loss decreased (-0.645045 --> -0.665523).  Saving model ...
Epoch: 7 cost time: 1.4318451881408691
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.609 Vali Acc: 0.693 Test Loss: 0.609 Test Acc: 0.693
Validation loss decreased (-0.665523 --> -0.692827).  Saving model ...
Epoch: 8 cost time: 1.4365618228912354
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.619 Vali Acc: 0.683 Test Loss: 0.619 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4244625568389893
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.626 Vali Acc: 0.689 Test Loss: 0.626 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5378987789154053
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.642 Vali Acc: 0.689 Test Loss: 0.642 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4852344989776611
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.657 Vali Acc: 0.686 Test Loss: 0.657 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5094842910766602
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.669 Vali Acc: 0.693 Test Loss: 0.669 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6669232845306396
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.686 Test Loss: 0.679 Test Acc: 0.686
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3794033527374268
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.693 Test Loss: 0.692 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.295278787612915
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.689 Test Loss: 0.704 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5089852809906006
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.689 Test Loss: 0.713 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.41756272315979
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.686 Test Loss: 0.724 Test Acc: 0.686
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6928327645051194
model parameter : 476058
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.260540723800659
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.710 Vali Acc: 0.505 Test Loss: 0.710 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 0.9969274997711182
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.687 Vali Acc: 0.546 Test Loss: 0.687 Test Acc: 0.546
Validation loss decreased (-0.505112 --> -0.546068).  Saving model ...
Epoch: 3 cost time: 0.9977664947509766
Epoch: 3, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.669 Vali Acc: 0.567 Test Loss: 0.669 Test Acc: 0.567
Validation loss decreased (-0.546068 --> -0.566546).  Saving model ...
Epoch: 4 cost time: 1.170172929763794
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.629 Vali Acc: 0.645 Test Loss: 0.629 Test Acc: 0.645
Validation loss decreased (-0.566546 --> -0.645045).  Saving model ...
Epoch: 5 cost time: 1.1158206462860107
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.600 Vali Acc: 0.683 Test Loss: 0.600 Test Acc: 0.683
Validation loss decreased (-0.645045 --> -0.682588).  Saving model ...
Epoch: 6 cost time: 0.9700188636779785
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.574 Vali Acc: 0.689 Test Loss: 0.574 Test Acc: 0.689
Validation loss decreased (-0.682588 --> -0.689414).  Saving model ...
Epoch: 7 cost time: 1.1491270065307617
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.576 Vali Acc: 0.696 Test Loss: 0.576 Test Acc: 0.696
Validation loss decreased (-0.689414 --> -0.696240).  Saving model ...
Epoch: 8 cost time: 1.1262321472167969
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.570 Vali Acc: 0.706 Test Loss: 0.570 Test Acc: 0.706
Validation loss decreased (-0.696240 --> -0.706479).  Saving model ...
Epoch: 9 cost time: 1.169593095779419
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.561 Vali Acc: 0.734 Test Loss: 0.561 Test Acc: 0.734
Validation loss decreased (-0.706479 --> -0.733783).  Saving model ...
Epoch: 10 cost time: 1.1460793018341064
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.569 Vali Acc: 0.724 Test Loss: 0.569 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0938365459442139
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.563 Vali Acc: 0.730 Test Loss: 0.563 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2417778968811035
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.734 Test Loss: 0.569 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2652249336242676
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.734 Test Loss: 0.573 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9688706398010254
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.734 Test Loss: 0.574 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0784451961517334
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.730 Test Loss: 0.579 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1773045063018799
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.730 Test Loss: 0.583 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.001924991607666
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.733783 --> -0.737196).  Saving model ...
Epoch: 18 cost time: 1.2544641494750977
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.730 Test Loss: 0.589 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0983169078826904
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.730 Test Loss: 0.592 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0813424587249756
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
Validation loss decreased (-0.737196 --> -0.740608).  Saving model ...
Epoch: 21 cost time: 0.9921958446502686
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9814085960388184
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.038717269897461
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.734 Test Loss: 0.605 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.013922929763794
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0765268802642822
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.737 Test Loss: 0.611 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0611648559570312
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.741 Test Loss: 0.615 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1388170719146729
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1484766006469727
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.741 Test Loss: 0.620 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.104950189590454
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.741 Test Loss: 0.622 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2881035804748535
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7406143344709898
model parameter : 473754
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.9032320976257324
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.719 Vali Acc: 0.433 Test Loss: 0.719 Test Acc: 0.433
Validation loss decreased (inf --> -0.433440).  Saving model ...
Epoch: 2 cost time: 0.6822640895843506
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.668 Vali Acc: 0.556 Test Loss: 0.668 Test Acc: 0.556
Validation loss decreased (-0.433440 --> -0.556307).  Saving model ...
Epoch: 3 cost time: 0.5878391265869141
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.608 Vali Acc: 0.676 Test Loss: 0.608 Test Acc: 0.676
Validation loss decreased (-0.556307 --> -0.675762).  Saving model ...
Epoch: 4 cost time: 0.5805180072784424
Epoch: 4, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.552 Vali Acc: 0.703 Test Loss: 0.552 Test Acc: 0.703
Validation loss decreased (-0.675762 --> -0.703066).  Saving model ...
Epoch: 5 cost time: 0.5866513252258301
Epoch: 5, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.535 Vali Acc: 0.717 Test Loss: 0.535 Test Acc: 0.717
Validation loss decreased (-0.703066 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 0.6323728561401367
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.716718 --> -0.737196).  Saving model ...
Epoch: 7 cost time: 0.6096386909484863
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.546 Vali Acc: 0.758 Test Loss: 0.546 Test Acc: 0.758
Validation loss decreased (-0.737196 --> -0.757674).  Saving model ...
Epoch: 8 cost time: 0.679518461227417
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.606896162033081
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.754 Test Loss: 0.581 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7013685703277588
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6598317623138428
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6813244819641113
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.768 Test Loss: 0.612 Test Acc: 0.768
Validation loss decreased (-0.757674 --> -0.767912).  Saving model ...
Epoch: 13 cost time: 0.6087942123413086
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.765 Test Loss: 0.622 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6953504085540771
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.765 Test Loss: 0.632 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6125547885894775
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.765 Test Loss: 0.644 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7126679420471191
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.656712532043457
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.765 Test Loss: 0.660 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6745059490203857
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.765 Test Loss: 0.669 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6873965263366699
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.768 Test Loss: 0.678 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7641656398773193
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.768 Test Loss: 0.687 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6567840576171875
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.768 Test Loss: 0.695 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6688544750213623
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.768 Test Loss: 0.701 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 471706
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.26508092880249
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.706 Vali Acc: 0.502 Test Loss: 0.706 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 6.361952781677246
Epoch: 2, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.688 Vali Acc: 0.546 Test Loss: 0.688 Test Acc: 0.546
Validation loss decreased (-0.501699 --> -0.546068).  Saving model ...
Epoch: 3 cost time: 6.192673444747925
Epoch: 3, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.654 Vali Acc: 0.584 Test Loss: 0.654 Test Acc: 0.584
Validation loss decreased (-0.546068 --> -0.583611).  Saving model ...
Epoch: 4 cost time: 6.023179769515991
Epoch: 4, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.665 Vali Acc: 0.611 Test Loss: 0.665 Test Acc: 0.611
Validation loss decreased (-0.583611 --> -0.610915).  Saving model ...
Epoch: 5 cost time: 6.647879362106323
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.609 Vali Acc: 0.655 Test Loss: 0.609 Test Acc: 0.655
Validation loss decreased (-0.610915 --> -0.655284).  Saving model ...
Epoch: 6 cost time: 7.936523675918579
Epoch: 6, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.585 Vali Acc: 0.696 Test Loss: 0.585 Test Acc: 0.696
Validation loss decreased (-0.655284 --> -0.696240).  Saving model ...
Epoch: 7 cost time: 6.498025894165039
Epoch: 7, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.565 Vali Acc: 0.700 Test Loss: 0.565 Test Acc: 0.700
Validation loss decreased (-0.696240 --> -0.699653).  Saving model ...
Epoch: 8 cost time: 5.9454100131988525
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.553 Vali Acc: 0.703 Test Loss: 0.553 Test Acc: 0.703
Validation loss decreased (-0.699653 --> -0.703066).  Saving model ...
Epoch: 9 cost time: 6.33601450920105
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.720 Test Loss: 0.547 Test Acc: 0.720
Validation loss decreased (-0.703066 --> -0.720131).  Saving model ...
Epoch: 10 cost time: 6.461293697357178
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.547 Vali Acc: 0.713 Test Loss: 0.547 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.909590482711792
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.713 Test Loss: 0.556 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.626758098602295
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.539 Vali Acc: 0.730 Test Loss: 0.539 Test Acc: 0.730
Validation loss decreased (-0.720131 --> -0.730370).  Saving model ...
Epoch: 13 cost time: 6.563366174697876
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.730370 --> -0.737196).  Saving model ...
Epoch: 14 cost time: 6.335204362869263
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.543 Vali Acc: 0.734 Test Loss: 0.543 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.331956386566162
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.724 Test Loss: 0.548 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.636454105377197
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.730 Test Loss: 0.547 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.511882781982422
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.203019142150879
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.730 Test Loss: 0.549 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.552783966064453
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.854734659194946
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.724 Test Loss: 0.560 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.8660502433776855
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.730 Test Loss: 0.557 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.355583906173706
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.730 Test Loss: 0.560 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.613925218582153
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.734 Test Loss: 0.561 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7372013651877133
model parameter : 500070
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.61957311630249
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.680 Vali Acc: 0.567 Test Loss: 0.680 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 4.628570318222046
Epoch: 2, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.662 Vali Acc: 0.618 Test Loss: 0.662 Test Acc: 0.618
Validation loss decreased (-0.566546 --> -0.617741).  Saving model ...
Epoch: 3 cost time: 4.573789358139038
Epoch: 3, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.643 Vali Acc: 0.648 Test Loss: 0.643 Test Acc: 0.648
Validation loss decreased (-0.617741 --> -0.648458).  Saving model ...
Epoch: 4 cost time: 4.534346103668213
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.625 Vali Acc: 0.679 Test Loss: 0.625 Test Acc: 0.679
Validation loss decreased (-0.648458 --> -0.679175).  Saving model ...
Epoch: 5 cost time: 4.809441566467285
Epoch: 5, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.599 Vali Acc: 0.730 Test Loss: 0.599 Test Acc: 0.730
Validation loss decreased (-0.679175 --> -0.730369).  Saving model ...
Epoch: 6 cost time: 4.591399908065796
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.641 Vali Acc: 0.628 Test Loss: 0.641 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.5180299282073975
Epoch: 7, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.567 Vali Acc: 0.693 Test Loss: 0.567 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.507465839385986
Epoch: 8, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.544 Vali Acc: 0.720 Test Loss: 0.544 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.968229532241821
Epoch: 9, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.540 Vali Acc: 0.768 Test Loss: 0.540 Test Acc: 0.768
Validation loss decreased (-0.730369 --> -0.767913).  Saving model ...
Epoch: 10 cost time: 5.035580635070801
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.530 Vali Acc: 0.754 Test Loss: 0.530 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.2733845710754395
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.765 Test Loss: 0.528 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.864478588104248
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.744 Test Loss: 0.526 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.995953559875488
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.526 Vali Acc: 0.758 Test Loss: 0.526 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.670750141143799
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.518280982971191
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.575878858566284
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.242884635925293
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.747 Test Loss: 0.536 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.704110860824585
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.747 Test Loss: 0.538 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.8223254680633545
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.754 Test Loss: 0.541 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 494438
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.237082481384277
Epoch: 1, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.703 Vali Acc: 0.509 Test Loss: 0.703 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 3.689089775085449
Epoch: 2, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.715 Vali Acc: 0.505 Test Loss: 0.715 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9062373638153076
Epoch: 3, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.696 Vali Acc: 0.529 Test Loss: 0.696 Test Acc: 0.529
Validation loss decreased (-0.508525 --> -0.529003).  Saving model ...
Epoch: 4 cost time: 3.8271780014038086
Epoch: 4, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.661 Vali Acc: 0.587 Test Loss: 0.661 Test Acc: 0.587
Validation loss decreased (-0.529003 --> -0.587024).  Saving model ...
Epoch: 5 cost time: 3.8486435413360596
Epoch: 5, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.641 Vali Acc: 0.621 Test Loss: 0.641 Test Acc: 0.621
Validation loss decreased (-0.587024 --> -0.621154).  Saving model ...
Epoch: 6 cost time: 4.212918043136597
Epoch: 6, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.678 Vali Acc: 0.573 Test Loss: 0.678 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0950987339019775
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.586 Vali Acc: 0.730 Test Loss: 0.586 Test Acc: 0.730
Validation loss decreased (-0.621154 --> -0.730370).  Saving model ...
Epoch: 8 cost time: 4.286823272705078
Epoch: 8, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.572 Vali Acc: 0.724 Test Loss: 0.572 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.427566289901733
Epoch: 9, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.570 Vali Acc: 0.713 Test Loss: 0.570 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.359677076339722
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.596 Vali Acc: 0.689 Test Loss: 0.596 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8446829319000244
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.577 Vali Acc: 0.706 Test Loss: 0.577 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.371612787246704
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.581 Vali Acc: 0.747 Test Loss: 0.581 Test Acc: 0.747
Validation loss decreased (-0.730370 --> -0.747434).  Saving model ...
Epoch: 13 cost time: 3.94065523147583
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.584 Vali Acc: 0.758 Test Loss: 0.584 Test Acc: 0.758
Validation loss decreased (-0.747434 --> -0.757673).  Saving model ...
Epoch: 14 cost time: 4.162565231323242
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.595 Vali Acc: 0.758 Test Loss: 0.595 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5075881481170654
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.758 Test Loss: 0.605 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8621819019317627
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
Validation loss decreased (-0.757673 --> -0.761086).  Saving model ...
Epoch: 17 cost time: 3.7617359161376953
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.2890305519104
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.754 Test Loss: 0.634 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.16582465171814
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.768 Test Loss: 0.640 Test Acc: 0.768
Validation loss decreased (-0.761086 --> -0.767912).  Saving model ...
Epoch: 20 cost time: 3.877197742462158
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.765 Test Loss: 0.647 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.377715349197388
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.765 Test Loss: 0.655 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.105834245681763
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.765 Test Loss: 0.661 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.025214195251465
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.666 Vali Acc: 0.765 Test Loss: 0.666 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.425915241241455
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.671 Vali Acc: 0.765 Test Loss: 0.671 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.401000022888184
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.765 Test Loss: 0.678 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.971069097518921
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.765 Test Loss: 0.684 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.190696477890015
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.148307800292969
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.765 Test Loss: 0.693 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.197506904602051
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.768 Test Loss: 0.696 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7679180887372014
model parameter : 488806
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.659571886062622
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.679 Vali Acc: 0.546 Test Loss: 0.679 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 2.5139527320861816
Epoch: 2, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.636 Vali Acc: 0.628 Test Loss: 0.636 Test Acc: 0.628
Validation loss decreased (-0.546068 --> -0.627980).  Saving model ...
Epoch: 3 cost time: 2.901637554168701
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.597 Vali Acc: 0.706 Test Loss: 0.597 Test Acc: 0.706
Validation loss decreased (-0.627980 --> -0.706479).  Saving model ...
Epoch: 4 cost time: 2.7746050357818604
Epoch: 4, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.557 Vali Acc: 0.720 Test Loss: 0.557 Test Acc: 0.720
Validation loss decreased (-0.706479 --> -0.720131).  Saving model ...
Epoch: 5 cost time: 2.520418405532837
Epoch: 5, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.530 Vali Acc: 0.734 Test Loss: 0.530 Test Acc: 0.734
Validation loss decreased (-0.720131 --> -0.733783).  Saving model ...
Epoch: 6 cost time: 2.5701520442962646
Epoch: 6, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.521 Vali Acc: 0.734 Test Loss: 0.521 Test Acc: 0.734
Validation loss decreased (-0.733783 --> -0.733783).  Saving model ...
Epoch: 7 cost time: 2.741851329803467
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.501 Vali Acc: 0.754 Test Loss: 0.501 Test Acc: 0.754
Validation loss decreased (-0.733783 --> -0.754261).  Saving model ...
Epoch: 8 cost time: 3.050682306289673
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.754261 --> -0.761087).  Saving model ...
Epoch: 9 cost time: 2.7730467319488525
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.494 Vali Acc: 0.785 Test Loss: 0.494 Test Acc: 0.785
Validation loss decreased (-0.761087 --> -0.784978).  Saving model ...
Epoch: 10 cost time: 3.025259256362915
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.494 Vali Acc: 0.778 Test Loss: 0.494 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.964777708053589
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.496 Vali Acc: 0.782 Test Loss: 0.496 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0436911582946777
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.504 Vali Acc: 0.771 Test Loss: 0.504 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0543107986450195
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.778 Test Loss: 0.498 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7395594120025635
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.775 Test Loss: 0.506 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9219329357147217
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.506 Vali Acc: 0.778 Test Loss: 0.506 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.798213481903076
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.782 Test Loss: 0.512 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.919218063354492
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.782 Test Loss: 0.514 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0090935230255127
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.782 Test Loss: 0.514 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5708529949188232
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.782 Test Loss: 0.517 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7849829351535836
model parameter : 482918
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1456174850463867
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.512 Test Loss: 0.699 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 1.6929337978363037
Epoch: 2, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.679 Vali Acc: 0.587 Test Loss: 0.679 Test Acc: 0.587
Validation loss decreased (-0.511938 --> -0.587024).  Saving model ...
Epoch: 3 cost time: 1.6173088550567627
Epoch: 3, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.660 Vali Acc: 0.638 Test Loss: 0.660 Test Acc: 0.638
Validation loss decreased (-0.587024 --> -0.638219).  Saving model ...
Epoch: 4 cost time: 1.801769495010376
Epoch: 4, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.641 Vali Acc: 0.655 Test Loss: 0.641 Test Acc: 0.655
Validation loss decreased (-0.638219 --> -0.655284).  Saving model ...
Epoch: 5 cost time: 1.9735989570617676
Epoch: 5, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.625 Vali Acc: 0.648 Test Loss: 0.625 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.770326852798462
Epoch: 6, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.602 Vali Acc: 0.672 Test Loss: 0.602 Test Acc: 0.672
Validation loss decreased (-0.655284 --> -0.672349).  Saving model ...
Epoch: 7 cost time: 2.049408197402954
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.586 Vali Acc: 0.689 Test Loss: 0.586 Test Acc: 0.689
Validation loss decreased (-0.672349 --> -0.689414).  Saving model ...
Epoch: 8 cost time: 2.0200843811035156
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.575 Vali Acc: 0.713 Test Loss: 0.575 Test Acc: 0.713
Validation loss decreased (-0.689414 --> -0.713305).  Saving model ...
Epoch: 9 cost time: 1.741182565689087
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.582 Vali Acc: 0.693 Test Loss: 0.582 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.899914264678955
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.706 Test Loss: 0.576 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.816070318222046
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.582 Vali Acc: 0.700 Test Loss: 0.582 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9279615879058838
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.585 Vali Acc: 0.734 Test Loss: 0.585 Test Acc: 0.734
Validation loss decreased (-0.713305 --> -0.733783).  Saving model ...
Epoch: 13 cost time: 1.9183602333068848
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.597 Vali Acc: 0.703 Test Loss: 0.597 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0009894371032715
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.602 Vali Acc: 0.734 Test Loss: 0.602 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.925882339477539
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.700 Test Loss: 0.611 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8723115921020508
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9095258712768555
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.720 Test Loss: 0.619 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.039759397506714
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.724 Test Loss: 0.625 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6650505065917969
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.850057601928711
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.860194444656372
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7915821075439453
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7337883959044369
model parameter : 478310
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6891143321990967
Epoch: 1, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.688 Vali Acc: 0.553 Test Loss: 0.688 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 1.6046886444091797
Epoch: 2, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.656 Vali Acc: 0.648 Test Loss: 0.656 Test Acc: 0.648
Validation loss decreased (-0.552894 --> -0.648458).  Saving model ...
Epoch: 3 cost time: 1.4757025241851807
Epoch: 3, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.621 Vali Acc: 0.696 Test Loss: 0.621 Test Acc: 0.696
Validation loss decreased (-0.648458 --> -0.696240).  Saving model ...
Epoch: 4 cost time: 1.5335392951965332
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.598 Vali Acc: 0.706 Test Loss: 0.598 Test Acc: 0.706
Validation loss decreased (-0.696240 --> -0.706479).  Saving model ...
Epoch: 5 cost time: 1.6865646839141846
Epoch: 5, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.569 Vali Acc: 0.710 Test Loss: 0.569 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709892).  Saving model ...
Epoch: 6 cost time: 1.483630657196045
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
Validation loss decreased (-0.709892 --> -0.750848).  Saving model ...
Epoch: 7 cost time: 1.457834005355835
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.521 Vali Acc: 0.747 Test Loss: 0.521 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6330347061157227
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.750848 --> -0.761087).  Saving model ...
Epoch: 9 cost time: 1.496706247329712
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.521 Vali Acc: 0.758 Test Loss: 0.521 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5015618801116943
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.512 Vali Acc: 0.765 Test Loss: 0.512 Test Acc: 0.765
Validation loss decreased (-0.761087 --> -0.764500).  Saving model ...
Epoch: 11 cost time: 1.3980114459991455
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.517 Vali Acc: 0.754 Test Loss: 0.517 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4711430072784424
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3966655731201172
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.768 Test Loss: 0.527 Test Acc: 0.768
Validation loss decreased (-0.764500 --> -0.767913).  Saving model ...
Epoch: 14 cost time: 1.4219260215759277
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.533 Vali Acc: 0.758 Test Loss: 0.533 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4087872505187988
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4882612228393555
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.765 Test Loss: 0.544 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4546287059783936
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.771 Test Loss: 0.549 Test Acc: 0.771
Validation loss decreased (-0.767913 --> -0.771326).  Saving model ...
Epoch: 18 cost time: 1.4455959796905518
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.771 Test Loss: 0.553 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3089468479156494
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.771 Test Loss: 0.561 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3410649299621582
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
Validation loss decreased (-0.771326 --> -0.774738).  Saving model ...
Epoch: 21 cost time: 1.240323781967163
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3923630714416504
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.778 Test Loss: 0.575 Test Acc: 0.778
Validation loss decreased (-0.774738 --> -0.778151).  Saving model ...
Epoch: 23 cost time: 1.3772633075714111
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3185882568359375
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3018720149993896
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3145344257354736
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.778 Test Loss: 0.588 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2674407958984375
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.778 Test Loss: 0.593 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2310352325439453
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.778 Test Loss: 0.597 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5062720775604248
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5501184463500977
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5004723072052002
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4565844535827637
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7781569965870307
model parameter : 476006
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.185324192047119
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.682 Vali Acc: 0.556 Test Loss: 0.682 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 1.1409900188446045
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.648 Vali Acc: 0.608 Test Loss: 0.648 Test Acc: 0.608
Validation loss decreased (-0.556307 --> -0.607502).  Saving model ...
Epoch: 3 cost time: 1.0380659103393555
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.613 Vali Acc: 0.666 Test Loss: 0.613 Test Acc: 0.666
Validation loss decreased (-0.607502 --> -0.665523).  Saving model ...
Epoch: 4 cost time: 1.068321704864502
Epoch: 4, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.591 Vali Acc: 0.659 Test Loss: 0.591 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0849707126617432
Epoch: 5, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.584 Vali Acc: 0.655 Test Loss: 0.584 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1063354015350342
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.557 Vali Acc: 0.706 Test Loss: 0.557 Test Acc: 0.706
Validation loss decreased (-0.665523 --> -0.706479).  Saving model ...
Epoch: 7 cost time: 1.15580153465271
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.521 Vali Acc: 0.727 Test Loss: 0.521 Test Acc: 0.727
Validation loss decreased (-0.706479 --> -0.726957).  Saving model ...
Epoch: 8 cost time: 1.1518604755401611
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.512 Vali Acc: 0.737 Test Loss: 0.512 Test Acc: 0.737
Validation loss decreased (-0.726957 --> -0.737196).  Saving model ...
Epoch: 9 cost time: 1.1324505805969238
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.727 Test Loss: 0.521 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0354094505310059
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.512 Vali Acc: 0.744 Test Loss: 0.512 Test Acc: 0.744
Validation loss decreased (-0.737196 --> -0.744022).  Saving model ...
Epoch: 11 cost time: 1.043393850326538
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.030815601348877
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.527 Vali Acc: 0.744 Test Loss: 0.527 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9158604145050049
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.744022 --> -0.750848).  Saving model ...
Epoch: 14 cost time: 1.1001918315887451
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.744 Test Loss: 0.538 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0339734554290771
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.747 Test Loss: 0.545 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.032245397567749
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.744 Test Loss: 0.544 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0271685123443604
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.744 Test Loss: 0.553 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9529225826263428
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.747 Test Loss: 0.554 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8826372623443604
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9038774967193604
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.744 Test Loss: 0.567 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9794216156005859
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.747 Test Loss: 0.576 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.009329080581665
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.744 Test Loss: 0.574 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.058223009109497
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.747 Test Loss: 0.581 Test Acc: 0.747
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7508532423208191
model parameter : 473702
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.880232572555542
Epoch: 1, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.693 Vali Acc: 0.536 Test Loss: 0.693 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 0.7211055755615234
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.664 Vali Acc: 0.549 Test Loss: 0.664 Test Acc: 0.549
Validation loss decreased (-0.535829 --> -0.549481).  Saving model ...
Epoch: 3 cost time: 0.6775400638580322
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.569 Vali Acc: 0.706 Test Loss: 0.569 Test Acc: 0.706
Validation loss decreased (-0.549481 --> -0.706479).  Saving model ...
Epoch: 4 cost time: 0.6239559650421143
Epoch: 4, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.508 Vali Acc: 0.737 Test Loss: 0.508 Test Acc: 0.737
Validation loss decreased (-0.706479 --> -0.737196).  Saving model ...
Epoch: 5 cost time: 0.6055495738983154
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.492 Vali Acc: 0.761 Test Loss: 0.492 Test Acc: 0.761
Validation loss decreased (-0.737196 --> -0.761087).  Saving model ...
Epoch: 6 cost time: 0.7254946231842041
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.527 Vali Acc: 0.771 Test Loss: 0.527 Test Acc: 0.771
Validation loss decreased (-0.761087 --> -0.771326).  Saving model ...
Epoch: 7 cost time: 0.5923516750335693
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.561 Vali Acc: 0.775 Test Loss: 0.561 Test Acc: 0.775
Validation loss decreased (-0.771326 --> -0.774738).  Saving model ...
Epoch: 8 cost time: 0.8265886306762695
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.586 Vali Acc: 0.778 Test Loss: 0.586 Test Acc: 0.778
Validation loss decreased (-0.774738 --> -0.778151).  Saving model ...
Epoch: 9 cost time: 0.6551446914672852
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.771 Test Loss: 0.636 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6646482944488525
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.768 Test Loss: 0.659 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6710295677185059
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.775 Test Loss: 0.669 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6928603649139404
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.768 Test Loss: 0.698 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7481746673583984
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6859252452850342
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.782 Test Loss: 0.717 Test Acc: 0.782
Validation loss decreased (-0.778151 --> -0.781563).  Saving model ...
Epoch: 15 cost time: 0.7042586803436279
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.771 Test Loss: 0.737 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6398303508758545
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.771 Test Loss: 0.748 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6515507698059082
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6514699459075928
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.771 Test Loss: 0.771 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6589300632476807
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.771 Test Loss: 0.785 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6950898170471191
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.778 Test Loss: 0.790 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6803467273712158
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.73775315284729
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.778 Test Loss: 0.813 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7757537364959717
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6611747741699219
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.771 Test Loss: 0.832 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7815699658703071
model parameter : 471654
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.003974676132202
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.706 Vali Acc: 0.526 Test Loss: 0.706 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 6.223810434341431
Epoch: 2, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.677 Vali Acc: 0.577 Test Loss: 0.677 Test Acc: 0.577
Validation loss decreased (-0.525590 --> -0.576785).  Saving model ...
Epoch: 3 cost time: 6.251622200012207
Epoch: 3, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.652 Vali Acc: 0.635 Test Loss: 0.652 Test Acc: 0.635
Validation loss decreased (-0.576785 --> -0.634806).  Saving model ...
Epoch: 4 cost time: 6.440122127532959
Epoch: 4, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.630 Vali Acc: 0.662 Test Loss: 0.630 Test Acc: 0.662
Validation loss decreased (-0.634806 --> -0.662110).  Saving model ...
Epoch: 5 cost time: 6.516273498535156
Epoch: 5, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.618 Vali Acc: 0.662 Test Loss: 0.618 Test Acc: 0.662
Validation loss decreased (-0.662110 --> -0.662110).  Saving model ...
Epoch: 6 cost time: 5.972919702529907
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.629 Vali Acc: 0.645 Test Loss: 0.629 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.765795707702637
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.616 Vali Acc: 0.683 Test Loss: 0.616 Test Acc: 0.683
Validation loss decreased (-0.662110 --> -0.682588).  Saving model ...
Epoch: 8 cost time: 5.86191463470459
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.632 Vali Acc: 0.655 Test Loss: 0.632 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.082535028457642
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.629 Vali Acc: 0.662 Test Loss: 0.629 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.654257297515869
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.633 Vali Acc: 0.659 Test Loss: 0.633 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.471550703048706
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.636 Vali Acc: 0.662 Test Loss: 0.636 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.783963680267334
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.641 Vali Acc: 0.666 Test Loss: 0.641 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.723383188247681
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.666 Test Loss: 0.647 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.668168306350708
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.666 Test Loss: 0.650 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.594164133071899
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.662 Test Loss: 0.656 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.921229839324951
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.666 Test Loss: 0.661 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.1110124588012695
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.667 Vali Acc: 0.669 Test Loss: 0.667 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w112_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6825938566552902
model parameter : 500006
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.6247828006744385
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.703 Vali Acc: 0.543 Test Loss: 0.703 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 4.896620750427246
Epoch: 2, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.664 Vali Acc: 0.594 Test Loss: 0.664 Test Acc: 0.594
Validation loss decreased (-0.542655 --> -0.593850).  Saving model ...
Epoch: 3 cost time: 4.588905096054077
Epoch: 3, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.636 Vali Acc: 0.618 Test Loss: 0.636 Test Acc: 0.618
Validation loss decreased (-0.593850 --> -0.617741).  Saving model ...
Epoch: 4 cost time: 5.101312160491943
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.605 Vali Acc: 0.655 Test Loss: 0.605 Test Acc: 0.655
Validation loss decreased (-0.617741 --> -0.655284).  Saving model ...
Epoch: 5 cost time: 4.919896602630615
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.601 Vali Acc: 0.672 Test Loss: 0.601 Test Acc: 0.672
Validation loss decreased (-0.655284 --> -0.672349).  Saving model ...
Epoch: 6 cost time: 5.255301237106323
Epoch: 6, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.587 Vali Acc: 0.706 Test Loss: 0.587 Test Acc: 0.706
Validation loss decreased (-0.672349 --> -0.706479).  Saving model ...
Epoch: 7 cost time: 5.039948463439941
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.591 Vali Acc: 0.696 Test Loss: 0.591 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.406592845916748
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.584 Vali Acc: 0.696 Test Loss: 0.584 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.194612503051758
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.587 Vali Acc: 0.683 Test Loss: 0.587 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.36107325553894
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.588 Vali Acc: 0.686 Test Loss: 0.588 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.970985651016235
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.679 Test Loss: 0.592 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.156490802764893
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.689 Test Loss: 0.599 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.09974479675293
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.679 Test Loss: 0.600 Test Acc: 0.679
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.972330331802368
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.689 Test Loss: 0.601 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.854342460632324
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.604 Vali Acc: 0.689 Test Loss: 0.604 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.8193676471710205
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.693 Test Loss: 0.607 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7064846416382252
model parameter : 494374
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.233795166015625
Epoch: 1, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.698 Vali Acc: 0.512 Test Loss: 0.698 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 3.7605416774749756
Epoch: 2, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.666 Vali Acc: 0.597 Test Loss: 0.666 Test Acc: 0.597
Validation loss decreased (-0.511938 --> -0.597263).  Saving model ...
Epoch: 3 cost time: 3.9816458225250244
Epoch: 3, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.637 Vali Acc: 0.628 Test Loss: 0.637 Test Acc: 0.628
Validation loss decreased (-0.597263 --> -0.627980).  Saving model ...
Epoch: 4 cost time: 3.803447961807251
Epoch: 4, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.619 Vali Acc: 0.662 Test Loss: 0.619 Test Acc: 0.662
Validation loss decreased (-0.627980 --> -0.662110).  Saving model ...
Epoch: 5 cost time: 3.807870626449585
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.608 Vali Acc: 0.659 Test Loss: 0.608 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.076751470565796
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.617 Vali Acc: 0.683 Test Loss: 0.617 Test Acc: 0.683
Validation loss decreased (-0.662110 --> -0.682588).  Saving model ...
Epoch: 7 cost time: 3.9502968788146973
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.602 Vali Acc: 0.679 Test Loss: 0.602 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.297439098358154
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.602 Vali Acc: 0.710 Test Loss: 0.602 Test Acc: 0.710
Validation loss decreased (-0.682588 --> -0.709892).  Saving model ...
Epoch: 9 cost time: 3.989999294281006
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.602 Vali Acc: 0.703 Test Loss: 0.602 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.5987982749938965
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.606 Vali Acc: 0.703 Test Loss: 0.606 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.600107908248901
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.611 Vali Acc: 0.700 Test Loss: 0.611 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.422732830047607
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.614 Vali Acc: 0.713 Test Loss: 0.614 Test Acc: 0.713
Validation loss decreased (-0.709892 --> -0.713304).  Saving model ...
Epoch: 13 cost time: 4.261465787887573
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.618 Vali Acc: 0.713 Test Loss: 0.618 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.501429080963135
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.706 Test Loss: 0.622 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.180609941482544
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.706 Test Loss: 0.627 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6581242084503174
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.706 Test Loss: 0.630 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.2783448696136475
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.703 Test Loss: 0.634 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.072853088378906
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.700 Test Loss: 0.637 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.859443426132202
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.700 Test Loss: 0.640 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.287890434265137
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.706 Test Loss: 0.643 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.388403415679932
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.703 Test Loss: 0.646 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.38083028793335
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.703 Test Loss: 0.649 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w68_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7133105802047781
model parameter : 488742
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.84592342376709
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.739 Vali Acc: 0.457 Test Loss: 0.739 Test Acc: 0.457
Validation loss decreased (inf --> -0.457330).  Saving model ...
Epoch: 2 cost time: 2.908729076385498
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.457330 --> -0.569959).  Saving model ...
Epoch: 3 cost time: 2.8841192722320557
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.677 Vali Acc: 0.608 Test Loss: 0.677 Test Acc: 0.608
Validation loss decreased (-0.569959 --> -0.607502).  Saving model ...
Epoch: 4 cost time: 2.8806755542755127
Epoch: 4, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.653 Vali Acc: 0.648 Test Loss: 0.653 Test Acc: 0.648
Validation loss decreased (-0.607502 --> -0.648458).  Saving model ...
Epoch: 5 cost time: 2.4952220916748047
Epoch: 5, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.630 Vali Acc: 0.648 Test Loss: 0.630 Test Acc: 0.648
Validation loss decreased (-0.648458 --> -0.648458).  Saving model ...
Epoch: 6 cost time: 2.5777344703674316
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.616 Vali Acc: 0.672 Test Loss: 0.616 Test Acc: 0.672
Validation loss decreased (-0.648458 --> -0.672349).  Saving model ...
Epoch: 7 cost time: 2.505251169204712
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.614 Vali Acc: 0.686 Test Loss: 0.614 Test Acc: 0.686
Validation loss decreased (-0.672349 --> -0.686001).  Saving model ...
Epoch: 8 cost time: 2.6442148685455322
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.611 Vali Acc: 0.672 Test Loss: 0.611 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6632394790649414
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.610 Vali Acc: 0.669 Test Loss: 0.610 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.802011728286743
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.679 Test Loss: 0.611 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4715161323547363
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.696 Test Loss: 0.611 Test Acc: 0.696
Validation loss decreased (-0.686001 --> -0.696240).  Saving model ...
Epoch: 12 cost time: 2.6013636589050293
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.686 Test Loss: 0.613 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5501437187194824
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.693 Test Loss: 0.616 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6878983974456787
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.686 Test Loss: 0.619 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7307345867156982
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.683 Test Loss: 0.621 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7438042163848877
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.689 Test Loss: 0.623 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.721796989440918
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7917912006378174
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6213440895080566
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.696 Test Loss: 0.628 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.477512836456299
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.693 Test Loss: 0.630 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5893449783325195
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.693 Test Loss: 0.634 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w45_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6962457337883959
model parameter : 482854
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.899691343307495
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.692 Vali Acc: 0.532 Test Loss: 0.692 Test Acc: 0.532
Validation loss decreased (inf --> -0.532416).  Saving model ...
Epoch: 2 cost time: 1.733903408050537
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.665 Vali Acc: 0.563 Test Loss: 0.665 Test Acc: 0.563
Validation loss decreased (-0.532416 --> -0.563133).  Saving model ...
Epoch: 3 cost time: 1.6258487701416016
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.636 Vali Acc: 0.611 Test Loss: 0.636 Test Acc: 0.611
Validation loss decreased (-0.563133 --> -0.610915).  Saving model ...
Epoch: 4 cost time: 1.8926193714141846
Epoch: 4, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.613 Vali Acc: 0.672 Test Loss: 0.613 Test Acc: 0.672
Validation loss decreased (-0.610915 --> -0.672349).  Saving model ...
Epoch: 5 cost time: 1.8307018280029297
Epoch: 5, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.599 Vali Acc: 0.686 Test Loss: 0.599 Test Acc: 0.686
Validation loss decreased (-0.672349 --> -0.686001).  Saving model ...
Epoch: 6 cost time: 1.8707506656646729
Epoch: 6, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.666 Test Loss: 0.594 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7794959545135498
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.595 Vali Acc: 0.669 Test Loss: 0.595 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9159982204437256
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.593 Vali Acc: 0.672 Test Loss: 0.593 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8665783405303955
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.693 Test Loss: 0.596 Test Acc: 0.693
Validation loss decreased (-0.686001 --> -0.692827).  Saving model ...
Epoch: 10 cost time: 1.8077540397644043
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.595 Vali Acc: 0.689 Test Loss: 0.595 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7751288414001465
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.693 Test Loss: 0.596 Test Acc: 0.693
Validation loss decreased (-0.692827 --> -0.692827).  Saving model ...
Epoch: 12 cost time: 1.8668537139892578
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.700 Test Loss: 0.601 Test Acc: 0.700
Validation loss decreased (-0.692827 --> -0.699653).  Saving model ...
Epoch: 13 cost time: 1.9426922798156738
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.703 Test Loss: 0.603 Test Acc: 0.703
Validation loss decreased (-0.699653 --> -0.703066).  Saving model ...
Epoch: 14 cost time: 1.855757713317871
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.700 Test Loss: 0.601 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8542661666870117
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.706 Test Loss: 0.604 Test Acc: 0.706
Validation loss decreased (-0.703066 --> -0.706479).  Saving model ...
Epoch: 16 cost time: 1.924039602279663
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.710 Test Loss: 0.608 Test Acc: 0.710
Validation loss decreased (-0.706479 --> -0.709892).  Saving model ...
Epoch: 17 cost time: 1.7313108444213867
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.710 Test Loss: 0.610 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7134730815887451
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.706 Test Loss: 0.611 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0079762935638428
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.706 Test Loss: 0.611 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8598194122314453
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.710 Test Loss: 0.614 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8953559398651123
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.706 Test Loss: 0.615 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7899622917175293
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.713 Test Loss: 0.619 Test Acc: 0.713
Validation loss decreased (-0.709892 --> -0.713304).  Saving model ...
Epoch: 23 cost time: 1.8710672855377197
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.710 Test Loss: 0.621 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.741830825805664
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.710 Test Loss: 0.621 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.611302375793457
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.710 Test Loss: 0.624 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.722567081451416
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.710 Test Loss: 0.626 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.806140422821045
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.713 Test Loss: 0.627 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6882247924804688
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.713304 --> -0.716717).  Saving model ...
Epoch: 29 cost time: 1.7479000091552734
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.713 Test Loss: 0.632 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.845926284790039
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.713 Test Loss: 0.634 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7923133373260498
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.710 Test Loss: 0.635 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7528858184814453
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.710 Test Loss: 0.636 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7306673526763916
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.710 Test Loss: 0.637 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.91725492477417
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.706 Test Loss: 0.639 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8027222156524658
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.706 Test Loss: 0.640 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7856309413909912
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.706 Test Loss: 0.643 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8426835536956787
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.706 Test Loss: 0.644 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9443044662475586
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.706 Test Loss: 0.646 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7167235494880546
model parameter : 478246
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.61006236076355
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.714 Vali Acc: 0.491 Test Loss: 0.714 Test Acc: 0.491
Validation loss decreased (inf --> -0.491460).  Saving model ...
Epoch: 2 cost time: 1.4501848220825195
Epoch: 2, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.683 Vali Acc: 0.536 Test Loss: 0.683 Test Acc: 0.536
Validation loss decreased (-0.491460 --> -0.535829).  Saving model ...
Epoch: 3 cost time: 1.5168192386627197
Epoch: 3, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.657 Vali Acc: 0.587 Test Loss: 0.657 Test Acc: 0.587
Validation loss decreased (-0.535829 --> -0.587024).  Saving model ...
Epoch: 4 cost time: 1.5196361541748047
Epoch: 4, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.635 Vali Acc: 0.614 Test Loss: 0.635 Test Acc: 0.614
Validation loss decreased (-0.587024 --> -0.614328).  Saving model ...
Epoch: 5 cost time: 1.3850491046905518
Epoch: 5, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.627 Vali Acc: 0.645 Test Loss: 0.627 Test Acc: 0.645
Validation loss decreased (-0.614328 --> -0.645045).  Saving model ...
Epoch: 6 cost time: 1.4503633975982666
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.626 Vali Acc: 0.648 Test Loss: 0.626 Test Acc: 0.648
Validation loss decreased (-0.645045 --> -0.648458).  Saving model ...
Epoch: 7 cost time: 1.4391305446624756
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.624 Vali Acc: 0.655 Test Loss: 0.624 Test Acc: 0.655
Validation loss decreased (-0.648458 --> -0.655284).  Saving model ...
Epoch: 8 cost time: 1.5825610160827637
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.676 Test Loss: 0.627 Test Acc: 0.676
Validation loss decreased (-0.655284 --> -0.675762).  Saving model ...
Epoch: 9 cost time: 1.5481772422790527
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.686 Test Loss: 0.630 Test Acc: 0.686
Validation loss decreased (-0.675762 --> -0.686001).  Saving model ...
Epoch: 10 cost time: 1.492577075958252
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.686 Test Loss: 0.631 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.645862340927124
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.686 Test Loss: 0.635 Test Acc: 0.686
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7288146018981934
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.683 Test Loss: 0.639 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5786676406860352
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.641 Vali Acc: 0.686 Test Loss: 0.641 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.637028455734253
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.689 Test Loss: 0.644 Test Acc: 0.689
Validation loss decreased (-0.686001 --> -0.689413).  Saving model ...
Epoch: 15 cost time: 1.618457317352295
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.689 Test Loss: 0.648 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5454132556915283
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.689 Test Loss: 0.650 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4698140621185303
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.696 Test Loss: 0.652 Test Acc: 0.696
Validation loss decreased (-0.689413 --> -0.696239).  Saving model ...
Epoch: 18 cost time: 1.5015697479248047
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.693 Test Loss: 0.655 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6158711910247803
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.693 Test Loss: 0.657 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7646160125732422
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.686 Test Loss: 0.660 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5206222534179688
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.689 Test Loss: 0.663 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.499737024307251
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.686 Test Loss: 0.664 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4416306018829346
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.689 Test Loss: 0.667 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4530954360961914
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.689 Test Loss: 0.670 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3651337623596191
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.693 Test Loss: 0.672 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4974381923675537
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.689 Test Loss: 0.675 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3766493797302246
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.689 Test Loss: 0.678 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6962457337883959
model parameter : 475942
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.9123618602752686
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.670 Vali Acc: 0.553 Test Loss: 0.670 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 0.9652304649353027
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.641 Vali Acc: 0.648 Test Loss: 0.641 Test Acc: 0.648
Validation loss decreased (-0.552894 --> -0.648458).  Saving model ...
Epoch: 3 cost time: 0.9050724506378174
Epoch: 3, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.613 Vali Acc: 0.700 Test Loss: 0.613 Test Acc: 0.700
Validation loss decreased (-0.648458 --> -0.699653).  Saving model ...
Epoch: 4 cost time: 0.8246445655822754
Epoch: 4, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.594 Vali Acc: 0.689 Test Loss: 0.594 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.933751106262207
Epoch: 5, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.584 Vali Acc: 0.724 Test Loss: 0.584 Test Acc: 0.724
Validation loss decreased (-0.699653 --> -0.723544).  Saving model ...
Epoch: 6 cost time: 0.8964190483093262
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.579 Vali Acc: 0.696 Test Loss: 0.579 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9174470901489258
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.580 Vali Acc: 0.720 Test Loss: 0.580 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0630273818969727
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.713 Test Loss: 0.580 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8543145656585693
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.583 Vali Acc: 0.710 Test Loss: 0.583 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7699551582336426
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.713 Test Loss: 0.583 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1874549388885498
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.586 Vali Acc: 0.710 Test Loss: 0.586 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9675285816192627
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.724 Test Loss: 0.588 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9908647537231445
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.713 Test Loss: 0.592 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9188063144683838
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.713 Test Loss: 0.595 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1392130851745605
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.713 Test Loss: 0.597 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7235494880546075
model parameter : 473638
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 1.8327112197875977
Epoch: 1, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.714 Vali Acc: 0.519 Test Loss: 0.714 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 0.6753129959106445
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.653 Vali Acc: 0.625 Test Loss: 0.653 Test Acc: 0.625
Validation loss decreased (-0.518764 --> -0.624567).  Saving model ...
Epoch: 3 cost time: 0.6508524417877197
Epoch: 3, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.602 Vali Acc: 0.686 Test Loss: 0.602 Test Acc: 0.686
Validation loss decreased (-0.624567 --> -0.686001).  Saving model ...
Epoch: 4 cost time: 0.6129510402679443
Epoch: 4, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.590 Vali Acc: 0.706 Test Loss: 0.590 Test Acc: 0.706
Validation loss decreased (-0.686001 --> -0.706479).  Saving model ...
Epoch: 5 cost time: 0.5810723304748535
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (-0.706479 --> -0.716718).  Saving model ...
Epoch: 6 cost time: 0.629084587097168
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.716718 --> -0.737195).  Saving model ...
Epoch: 7 cost time: 0.606229305267334
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.741 Test Loss: 0.585 Test Acc: 0.741
Validation loss decreased (-0.737195 --> -0.740608).  Saving model ...
Epoch: 8 cost time: 0.5744502544403076
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.747 Test Loss: 0.605 Test Acc: 0.747
Validation loss decreased (-0.740608 --> -0.747434).  Saving model ...
Epoch: 9 cost time: 0.6562554836273193
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5626692771911621
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6113269329071045
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49791622161865234
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.741 Test Loss: 0.634 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7005634307861328
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.747 Test Loss: 0.639 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5440032482147217
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.747 Test Loss: 0.645 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6713588237762451
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
Validation loss decreased (-0.747434 --> -0.750847).  Saving model ...
Epoch: 16 cost time: 0.5680177211761475
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.754 Test Loss: 0.654 Test Acc: 0.754
Validation loss decreased (-0.750847 --> -0.754260).  Saving model ...
Epoch: 17 cost time: 0.5996694564819336
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.754 Test Loss: 0.662 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6154539585113525
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.758 Test Loss: 0.668 Test Acc: 0.758
Validation loss decreased (-0.754260 --> -0.757672).  Saving model ...
Epoch: 19 cost time: 0.5810933113098145
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.751 Test Loss: 0.674 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6576943397521973
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.751 Test Loss: 0.681 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5914773941040039
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.751 Test Loss: 0.685 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6835484504699707
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.754 Test Loss: 0.689 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6628031730651855
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6833245754241943
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.46566057205200195
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.758 Test Loss: 0.698 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5450015068054199
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.758 Test Loss: 0.704 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5909206867218018
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.758 Test Loss: 0.709 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6466968059539795
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.754 Test Loss: 0.713 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_MTSMixer_UEA_ftM_sl896_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.757679180887372
model parameter : 471590
model size : 1.80MB
