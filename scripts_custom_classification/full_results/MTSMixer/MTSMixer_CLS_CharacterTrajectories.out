Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.446489334106445
Epoch: 1, Steps: 89 | Train Loss: 2.638 Vali Loss: 2.106 Vali Acc: 0.721 Test Loss: 2.106 Test Acc: 0.721
Validation loss decreased (inf --> -0.721427).  Saving model ...
Epoch: 2 cost time: 8.541428089141846
Epoch: 2, Steps: 89 | Train Loss: 1.655 Vali Loss: 1.214 Vali Acc: 0.853 Test Loss: 1.214 Test Acc: 0.853
Validation loss decreased (-0.721427 --> -0.853052).  Saving model ...
Epoch: 3 cost time: 7.651087522506714
Epoch: 3, Steps: 89 | Train Loss: 0.894 Vali Loss: 0.649 Vali Acc: 0.905 Test Loss: 0.649 Test Acc: 0.905
Validation loss decreased (-0.853052 --> -0.905286).  Saving model ...
Epoch: 4 cost time: 7.838207960128784
Epoch: 4, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.409 Vali Acc: 0.929 Test Loss: 0.409 Test Acc: 0.929
Validation loss decreased (-0.905286 --> -0.928965).  Saving model ...
Epoch: 5 cost time: 8.482233047485352
Epoch: 5, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.307 Vali Acc: 0.948 Test Loss: 0.307 Test Acc: 0.948
Validation loss decreased (-0.928965 --> -0.948465).  Saving model ...
Epoch: 6 cost time: 8.089582920074463
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.249 Vali Acc: 0.954 Test Loss: 0.249 Test Acc: 0.954
Validation loss decreased (-0.948465 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 8.199273347854614
Epoch: 7, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
Validation loss decreased (-0.954037 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 8.428570032119751
Epoch: 8, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
Validation loss decreased (-0.954037 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 8.027811527252197
Epoch: 9, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.958912 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 7.8157429695129395
Epoch: 10, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 8.1010103225708
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970054).  Saving model ...
Epoch: 12 cost time: 7.882905006408691
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.968348264694214
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.748212099075317
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.021296501159668
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.394891738891602
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.464965105056763
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.087055683135986
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.549726963043213
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.72302508354187
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.914160251617432
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 803932
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.272610902786255
Epoch: 1, Steps: 89 | Train Loss: 2.659 Vali Loss: 2.074 Vali Acc: 0.699 Test Loss: 2.074 Test Acc: 0.699
Validation loss decreased (inf --> -0.699144).  Saving model ...
Epoch: 2 cost time: 7.0021607875823975
Epoch: 2, Steps: 89 | Train Loss: 1.585 Vali Loss: 1.168 Vali Acc: 0.820 Test Loss: 1.168 Test Acc: 0.820
Validation loss decreased (-0.699144 --> -0.820323).  Saving model ...
Epoch: 3 cost time: 7.489408731460571
Epoch: 3, Steps: 89 | Train Loss: 0.841 Vali Loss: 0.643 Vali Acc: 0.886 Test Loss: 0.643 Test Acc: 0.886
Validation loss decreased (-0.820323 --> -0.885787).  Saving model ...
Epoch: 4 cost time: 7.106649398803711
Epoch: 4, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.409 Vali Acc: 0.931 Test Loss: 0.409 Test Acc: 0.931
Validation loss decreased (-0.885787 --> -0.931054).  Saving model ...
Epoch: 5 cost time: 7.103726625442505
Epoch: 5, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.931054 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 7.173654079437256
Epoch: 6, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.254 Vali Acc: 0.953 Test Loss: 0.254 Test Acc: 0.953
Validation loss decreased (-0.944287 --> -0.953340).  Saving model ...
Epoch: 7 cost time: 7.6237123012542725
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
Validation loss decreased (-0.953340 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 7.3912153244018555
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.954037 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 7.219511032104492
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961697).  Saving model ...
Epoch: 10 cost time: 6.936251163482666
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.961697 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 7.261784315109253
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.199333190917969
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 7.134236574172974
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 6.764547348022461
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 15 cost time: 7.30279278755188
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.198638916015625
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 17 cost time: 7.177202463150024
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.850916147232056
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.101722955703735
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.094464063644409
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 21 cost time: 7.447016954421997
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 22 cost time: 6.799566984176636
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.722900152206421
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.148029565811157
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.9398033618927
Epoch: 25, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.123733997344971
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.825329303741455
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.4746034145355225
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.860010623931885
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.92734694480896
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.235393047332764
Epoch: 31, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 795740
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.768963575363159
Epoch: 1, Steps: 89 | Train Loss: 2.552 Vali Loss: 1.905 Vali Acc: 0.811 Test Loss: 1.905 Test Acc: 0.811
Validation loss decreased (inf --> -0.811262).  Saving model ...
Epoch: 2 cost time: 6.031283855438232
Epoch: 2, Steps: 89 | Train Loss: 1.372 Vali Loss: 0.930 Vali Acc: 0.910 Test Loss: 0.930 Test Acc: 0.910
Validation loss decreased (-0.811262 --> -0.910158).  Saving model ...
Epoch: 3 cost time: 5.470057964324951
Epoch: 3, Steps: 89 | Train Loss: 0.662 Vali Loss: 0.513 Vali Acc: 0.928 Test Loss: 0.513 Test Acc: 0.928
Validation loss decreased (-0.910158 --> -0.927571).  Saving model ...
Epoch: 4 cost time: 5.340957164764404
Epoch: 4, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.353 Vali Acc: 0.939 Test Loss: 0.353 Test Acc: 0.939
Validation loss decreased (-0.927571 --> -0.939412).  Saving model ...
Epoch: 5 cost time: 6.03241229057312
Epoch: 5, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.275 Vali Acc: 0.949 Test Loss: 0.275 Test Acc: 0.949
Validation loss decreased (-0.939412 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 5.785429239273071
Epoch: 6, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
Validation loss decreased (-0.949162 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 5.701639890670776
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.6855292320251465
Epoch: 8, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 5.647890567779541
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 5.3131208419799805
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.033748626708984
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 5.528242826461792
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.088441610336304
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.170823097229004
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.398782730102539
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.467742443084717
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 5.647777080535889
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.393275022506714
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.632469654083252
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.694014549255371
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 21 cost time: 5.597500801086426
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.557248830795288
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.829222202301025
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.656829833984375
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.496478319168091
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.203773498535156
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.195627927780151
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.333798408508301
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.362607955932617
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.413702487945557
Epoch: 30, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 785500
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.781344652175903
Epoch: 1, Steps: 89 | Train Loss: 2.608 Vali Loss: 2.024 Vali Acc: 0.687 Test Loss: 2.024 Test Acc: 0.687
Validation loss decreased (inf --> -0.687306).  Saving model ...
Epoch: 2 cost time: 4.277781248092651
Epoch: 2, Steps: 89 | Train Loss: 1.559 Vali Loss: 1.160 Vali Acc: 0.834 Test Loss: 1.160 Test Acc: 0.834
Validation loss decreased (-0.687306 --> -0.834250).  Saving model ...
Epoch: 3 cost time: 4.414475917816162
Epoch: 3, Steps: 89 | Train Loss: 0.853 Vali Loss: 0.691 Vali Acc: 0.868 Test Loss: 0.691 Test Acc: 0.868
Validation loss decreased (-0.834250 --> -0.867681).  Saving model ...
Epoch: 4 cost time: 4.160376071929932
Epoch: 4, Steps: 89 | Train Loss: 0.506 Vali Loss: 0.452 Vali Acc: 0.909 Test Loss: 0.452 Test Acc: 0.909
Validation loss decreased (-0.867681 --> -0.909466).  Saving model ...
Epoch: 5 cost time: 4.500983715057373
Epoch: 5, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.909466 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 4.551876544952393
Epoch: 6, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.262 Vali Acc: 0.946 Test Loss: 0.262 Test Acc: 0.946
Validation loss decreased (-0.935234 --> -0.945680).  Saving model ...
Epoch: 7 cost time: 4.405940055847168
Epoch: 7, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
Validation loss decreased (-0.945680 --> -0.952644).  Saving model ...
Epoch: 8 cost time: 4.254973411560059
Epoch: 8, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 4.241643905639648
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 3.7729854583740234
Epoch: 10, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.378510236740112
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 4.297896385192871
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 13 cost time: 4.372877359390259
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970055).  Saving model ...
Epoch: 14 cost time: 4.3678138256073
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.154414415359497
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.254603385925293
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 3.907536745071411
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 4.153929948806763
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.3520472049713135
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.56041955947876
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.521198749542236
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.521287202835083
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.52971339225769
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.58188533782959
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.702588796615601
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.804712295532227
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.58401894569397
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 28 cost time: 4.434812545776367
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.524112939834595
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.275261163711548
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.956 Test Loss: 0.134 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.144706964492798
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.285124778747559
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.523591995239258
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.353227376937866
Epoch: 34, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.584745645523071
Epoch: 35, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.826269865036011
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.599724292755127
Epoch: 37, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 777308
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.022636413574219
Epoch: 1, Steps: 89 | Train Loss: 2.513 Vali Loss: 1.874 Vali Acc: 0.736 Test Loss: 1.874 Test Acc: 0.736
Validation loss decreased (inf --> -0.736054).  Saving model ...
Epoch: 2 cost time: 3.68575119972229
Epoch: 2, Steps: 89 | Train Loss: 1.367 Vali Loss: 0.954 Vali Acc: 0.880 Test Loss: 0.954 Test Acc: 0.880
Validation loss decreased (-0.736054 --> -0.880213).  Saving model ...
Epoch: 3 cost time: 3.610780954360962
Epoch: 3, Steps: 89 | Train Loss: 0.643 Vali Loss: 0.488 Vali Acc: 0.920 Test Loss: 0.488 Test Acc: 0.920
Validation loss decreased (-0.880213 --> -0.919912).  Saving model ...
Epoch: 4 cost time: 3.6410741806030273
Epoch: 4, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
Validation loss decreased (-0.919912 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 3.525223970413208
Epoch: 5, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.235 Vali Acc: 0.955 Test Loss: 0.235 Test Acc: 0.955
Validation loss decreased (-0.940805 --> -0.955429).  Saving model ...
Epoch: 6 cost time: 3.2975966930389404
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.172 Vali Acc: 0.966 Test Loss: 0.172 Test Acc: 0.966
Validation loss decreased (-0.955429 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 3.4324772357940674
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968661).  Saving model ...
Epoch: 8 cost time: 3.48158597946167
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 3.5875325202941895
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.19618558883667
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2311811447143555
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.316190719604492
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2060530185699463
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2355716228485107
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.679778575897217
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.72946834564209
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 3.2967677116394043
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.094974994659424
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4456732273101807
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1942806243896484
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2949323654174805
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.274308919906616
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6284103393554688
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.4480998516082764
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.164060115814209
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.215153694152832
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 769116
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.795722484588623
Epoch: 1, Steps: 89 | Train Loss: 2.639 Vali Loss: 2.046 Vali Acc: 0.714 Test Loss: 2.046 Test Acc: 0.714
Validation loss decreased (inf --> -0.713768).  Saving model ...
Epoch: 2 cost time: 2.8619465827941895
Epoch: 2, Steps: 89 | Train Loss: 1.463 Vali Loss: 0.992 Vali Acc: 0.874 Test Loss: 0.992 Test Acc: 0.874
Validation loss decreased (-0.713768 --> -0.873946).  Saving model ...
Epoch: 3 cost time: 2.5353543758392334
Epoch: 3, Steps: 89 | Train Loss: 0.678 Vali Loss: 0.492 Vali Acc: 0.923 Test Loss: 0.492 Test Acc: 0.923
Validation loss decreased (-0.873946 --> -0.922697).  Saving model ...
Epoch: 4 cost time: 2.670562505722046
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
Validation loss decreased (-0.922697 --> -0.948465).  Saving model ...
Epoch: 5 cost time: 2.492884397506714
Epoch: 5, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.948465 --> -0.956822).  Saving model ...
Epoch: 6 cost time: 2.7351157665252686
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.956822 --> -0.961697).  Saving model ...
Epoch: 7 cost time: 3.050837278366089
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.961697 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 3.070683717727661
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.71201491355896
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6952953338623047
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 2.5889644622802734
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.900937795639038
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 2.801048994064331
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973537 --> -0.977019).  Saving model ...
Epoch: 14 cost time: 2.6753346920013428
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8556087017059326
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9552085399627686
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4876320362091064
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3336169719696045
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2159085273742676
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2790865898132324
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.447587251663208
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.500605821609497
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7053873538970947
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 765020
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.080582618713379
Epoch: 1, Steps: 89 | Train Loss: 2.421 Vali Loss: 1.767 Vali Acc: 0.804 Test Loss: 1.767 Test Acc: 0.804
Validation loss decreased (inf --> -0.803604).  Saving model ...
Epoch: 2 cost time: 2.2430579662323
Epoch: 2, Steps: 89 | Train Loss: 1.248 Vali Loss: 0.832 Vali Acc: 0.890 Test Loss: 0.832 Test Acc: 0.890
Validation loss decreased (-0.803604 --> -0.889964).  Saving model ...
Epoch: 3 cost time: 2.0060794353485107
Epoch: 3, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.435 Vali Acc: 0.939 Test Loss: 0.435 Test Acc: 0.939
Validation loss decreased (-0.889964 --> -0.938714).  Saving model ...
Epoch: 4 cost time: 2.388622522354126
Epoch: 4, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.270 Vali Acc: 0.959 Test Loss: 0.270 Test Acc: 0.959
Validation loss decreased (-0.938714 --> -0.958911).  Saving model ...
Epoch: 5 cost time: 2.3835878372192383
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.958911 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 2.5668587684631348
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 2.3556127548217773
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 2.406811475753784
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.275108575820923
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3631558418273926
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.318385601043701
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4456372261047363
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4937520027160645
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1693689823150635
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.960 Test Loss: 0.116 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.966719627380371
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7985620498657227
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9643363952636719
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2484495639801025
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 760924
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9835524559020996
Epoch: 1, Steps: 89 | Train Loss: 2.630 Vali Loss: 1.972 Vali Acc: 0.717 Test Loss: 1.972 Test Acc: 0.717
Validation loss decreased (inf --> -0.717250).  Saving model ...
Epoch: 2 cost time: 1.5425450801849365
Epoch: 2, Steps: 89 | Train Loss: 1.412 Vali Loss: 0.964 Vali Acc: 0.868 Test Loss: 0.964 Test Acc: 0.868
Validation loss decreased (-0.717250 --> -0.868375).  Saving model ...
Epoch: 3 cost time: 1.795562982559204
Epoch: 3, Steps: 89 | Train Loss: 0.643 Vali Loss: 0.474 Vali Acc: 0.941 Test Loss: 0.474 Test Acc: 0.941
Validation loss decreased (-0.868375 --> -0.940803).  Saving model ...
Epoch: 4 cost time: 2.045036554336548
Epoch: 4, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
Validation loss decreased (-0.940803 --> -0.953340).  Saving model ...
Epoch: 5 cost time: 1.5382442474365234
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.953340 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 1.8354222774505615
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.957519 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 1.631450891494751
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9026756286621094
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 1.737091064453125
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.845506191253662
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6875691413879395
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.434192419052124
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 1.268035650253296
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3789334297180176
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4647936820983887
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.526444673538208
Epoch: 16, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6852211952209473
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7107038497924805
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6911964416503906
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6841137409210205
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6097912788391113
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5374000072479248
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 758876
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.016660928726196
Epoch: 1, Steps: 89 | Train Loss: 2.249 Vali Loss: 1.606 Vali Acc: 0.816 Test Loss: 1.606 Test Acc: 0.816
Validation loss decreased (inf --> -0.816140).  Saving model ...
Epoch: 2 cost time: 7.955425262451172
Epoch: 2, Steps: 89 | Train Loss: 1.173 Vali Loss: 0.850 Vali Acc: 0.867 Test Loss: 0.850 Test Acc: 0.867
Validation loss decreased (-0.816140 --> -0.866983).  Saving model ...
Epoch: 3 cost time: 7.974060535430908
Epoch: 3, Steps: 89 | Train Loss: 0.623 Vali Loss: 0.517 Vali Acc: 0.902 Test Loss: 0.517 Test Acc: 0.902
Validation loss decreased (-0.866983 --> -0.901805).  Saving model ...
Epoch: 4 cost time: 8.908482074737549
Epoch: 4, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.901805 --> -0.925484).  Saving model ...
Epoch: 5 cost time: 8.40113115310669
Epoch: 5, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.925484 --> -0.927574).  Saving model ...
Epoch: 6 cost time: 8.596155881881714
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.927574 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 7.865985155105591
Epoch: 7, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.943591 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 8.121010065078735
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.30899953842163
Epoch: 9, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.956126 --> -0.956126).  Saving model ...
Epoch: 10 cost time: 7.986755132675171
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.667858362197876
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.032168626785278
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.956126 --> -0.956823).  Saving model ...
Epoch: 13 cost time: 8.077581882476807
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.415588140487671
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.957519).  Saving model ...
Epoch: 15 cost time: 8.1821768283844
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958216).  Saving model ...
Epoch: 16 cost time: 8.00146198272705
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 17 cost time: 7.076416730880737
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.989051342010498
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 19 cost time: 7.555049657821655
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.967879056930542
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.215243816375732
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.962394 --> -0.963090).  Saving model ...
Epoch: 22 cost time: 7.210987091064453
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963787).  Saving model ...
Epoch: 23 cost time: 7.462811708450317
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.220136642456055
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.94609808921814
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.661502361297607
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.556655406951904
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.335554838180542
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.900193691253662
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 30 cost time: 7.4127726554870605
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.1719748973846436
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.663095235824585
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 8.000165224075317
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 8.268639087677002
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 7.830797910690308
Epoch: 35, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.819833755493164
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 7.604050159454346
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 7.489529371261597
Epoch: 38, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 7.7110490798950195
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 803898
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.003659725189209
Epoch: 1, Steps: 89 | Train Loss: 2.210 Vali Loss: 1.563 Vali Acc: 0.775 Test Loss: 1.563 Test Acc: 0.775
Validation loss decreased (inf --> -0.775054).  Saving model ...
Epoch: 2 cost time: 6.9050679206848145
Epoch: 2, Steps: 89 | Train Loss: 1.133 Vali Loss: 0.817 Vali Acc: 0.855 Test Loss: 0.817 Test Acc: 0.855
Validation loss decreased (-0.775054 --> -0.855145).  Saving model ...
Epoch: 3 cost time: 6.90160059928894
Epoch: 3, Steps: 89 | Train Loss: 0.609 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.855145 --> -0.892752).  Saving model ...
Epoch: 4 cost time: 6.229542016983032
Epoch: 4, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
Validation loss decreased (-0.892752 --> -0.927573).  Saving model ...
Epoch: 5 cost time: 6.572392463684082
Epoch: 5, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.927573 --> -0.933145).  Saving model ...
Epoch: 6 cost time: 6.712192535400391
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.257 Vali Acc: 0.934 Test Loss: 0.257 Test Acc: 0.934
Validation loss decreased (-0.933145 --> -0.933841).  Saving model ...
Epoch: 7 cost time: 5.993364334106445
Epoch: 7, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.933841 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 6.192524194717407
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 6.2976367473602295
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.957519).  Saving model ...
Epoch: 10 cost time: 6.301803827285767
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.059607028961182
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.3581860065460205
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.421606063842773
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.630564451217651
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.97248649597168
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.701951742172241
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.711518287658691
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.586278200149536
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.631069660186768
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958216).  Saving model ...
Epoch: 20 cost time: 6.416921615600586
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.673221588134766
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.937966585159302
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958216 --> -0.958216).  Saving model ...
Epoch: 23 cost time: 7.068873882293701
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.033189535140991
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.958216 --> -0.965180).  Saving model ...
Epoch: 25 cost time: 7.077119588851929
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.963016748428345
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.8375115394592285
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 28 cost time: 6.53757119178772
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 29 cost time: 6.689600467681885
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970054).  Saving model ...
Epoch: 30 cost time: 6.38742208480835
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.844194173812866
Epoch: 31, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.683657646179199
Epoch: 32, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.138996362686157
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.965855121612549
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.603208065032959
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.399567127227783
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.6401872634887695
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.724823236465454
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.205756425857544
Epoch: 39, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 795706
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.462894439697266
Epoch: 1, Steps: 89 | Train Loss: 2.215 Vali Loss: 1.540 Vali Acc: 0.811 Test Loss: 1.540 Test Acc: 0.811
Validation loss decreased (inf --> -0.810570).  Saving model ...
Epoch: 2 cost time: 4.824281454086304
Epoch: 2, Steps: 89 | Train Loss: 1.115 Vali Loss: 0.801 Vali Acc: 0.864 Test Loss: 0.801 Test Acc: 0.864
Validation loss decreased (-0.810570 --> -0.863502).  Saving model ...
Epoch: 3 cost time: 5.133586406707764
Epoch: 3, Steps: 89 | Train Loss: 0.594 Vali Loss: 0.474 Vali Acc: 0.892 Test Loss: 0.474 Test Acc: 0.892
Validation loss decreased (-0.863502 --> -0.892057).  Saving model ...
Epoch: 4 cost time: 5.095434188842773
Epoch: 4, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
Validation loss decreased (-0.892057 --> -0.918520).  Saving model ...
Epoch: 5 cost time: 4.876770973205566
Epoch: 5, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.288 Vali Acc: 0.936 Test Loss: 0.288 Test Acc: 0.936
Validation loss decreased (-0.918520 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 4.899805307388306
Epoch: 6, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
Validation loss decreased (-0.935930 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 4.707093000411987
Epoch: 7, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.947073 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 5.127779245376587
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.954733).  Saving model ...
Epoch: 9 cost time: 5.149536371231079
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.235556364059448
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.954733 --> -0.956127).  Saving model ...
Epoch: 11 cost time: 5.31951117515564
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.956127 --> -0.959608).  Saving model ...
Epoch: 12 cost time: 5.216993570327759
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.474334239959717
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
Validation loss decreased (-0.959608 --> -0.961001).  Saving model ...
Epoch: 14 cost time: 4.9687206745147705
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.810178279876709
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.019745111465454
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.115833282470703
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 18 cost time: 4.946815490722656
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.7701780796051025
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 20 cost time: 5.212337493896484
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.586314916610718
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.168607234954834
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.0046539306640625
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.755035877227783
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.736758470535278
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.759796142578125
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.858046054840088
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.9004387855529785
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.855488538742065
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 785466
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.117556810379028
Epoch: 1, Steps: 89 | Train Loss: 2.260 Vali Loss: 1.533 Vali Acc: 0.811 Test Loss: 1.533 Test Acc: 0.811
Validation loss decreased (inf --> -0.811266).  Saving model ...
Epoch: 2 cost time: 3.6573173999786377
Epoch: 2, Steps: 89 | Train Loss: 1.084 Vali Loss: 0.766 Vali Acc: 0.882 Test Loss: 0.766 Test Acc: 0.882
Validation loss decreased (-0.811266 --> -0.882304).  Saving model ...
Epoch: 3 cost time: 4.442787170410156
Epoch: 3, Steps: 89 | Train Loss: 0.547 Vali Loss: 0.426 Vali Acc: 0.908 Test Loss: 0.426 Test Acc: 0.908
Validation loss decreased (-0.882304 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 3.9980080127716064
Epoch: 4, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.908074 --> -0.918520).  Saving model ...
Epoch: 5 cost time: 4.148011684417725
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.257 Vali Acc: 0.936 Test Loss: 0.257 Test Acc: 0.936
Validation loss decreased (-0.918520 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 4.501025438308716
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.218 Vali Acc: 0.945 Test Loss: 0.218 Test Acc: 0.945
Validation loss decreased (-0.935931 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 4.492894887924194
Epoch: 7, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.250621318817139
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.944984 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 4.303624629974365
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.158865451812744
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.012408971786499
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.953341 --> -0.954037).  Saving model ...
Epoch: 12 cost time: 4.044700622558594
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.142859935760498
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (-0.954037 --> -0.965876).  Saving model ...
Epoch: 14 cost time: 4.036574125289917
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.092795133590698
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.159060001373291
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.118322849273682
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.010505437850952
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.029940366744995
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.2236316204071045
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9852283000946045
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.212821006774902
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.379353761672974
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 777274
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.3774213790893555
Epoch: 1, Steps: 89 | Train Loss: 2.228 Vali Loss: 1.438 Vali Acc: 0.822 Test Loss: 1.438 Test Acc: 0.822
Validation loss decreased (inf --> -0.822409).  Saving model ...
Epoch: 2 cost time: 2.8781192302703857
Epoch: 2, Steps: 89 | Train Loss: 1.016 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.822409 --> -0.900411).  Saving model ...
Epoch: 3 cost time: 2.9260189533233643
Epoch: 3, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.414 Vali Acc: 0.916 Test Loss: 0.414 Test Acc: 0.916
Validation loss decreased (-0.900411 --> -0.915734).  Saving model ...
Epoch: 4 cost time: 2.8492422103881836
Epoch: 4, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.346 Vali Acc: 0.901 Test Loss: 0.346 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9560906887054443
Epoch: 5, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
Validation loss decreased (-0.915734 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 2.7750022411346436
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8558197021484375
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.893387794494629
Epoch: 8, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
Validation loss decreased (-0.938716 --> -0.941502).  Saving model ...
Epoch: 9 cost time: 2.940248489379883
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.941502 --> -0.959609).  Saving model ...
Epoch: 10 cost time: 3.0076777935028076
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1040995121002197
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
Validation loss decreased (-0.959609 --> -0.959609).  Saving model ...
Epoch: 12 cost time: 3.0901951789855957
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 3.0189929008483887
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9507272243499756
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1414806842803955
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 16 cost time: 2.9421932697296143
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.837578296661377
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.927 Test Loss: 0.208 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7213187217712402
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8467929363250732
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.666121006011963
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0513217449188232
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.960926055908203
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.0776233673095703
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.762117624282837
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.1790201663970947
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 769082
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.936002254486084
Epoch: 1, Steps: 89 | Train Loss: 2.206 Vali Loss: 1.412 Vali Acc: 0.814 Test Loss: 1.412 Test Acc: 0.814
Validation loss decreased (inf --> -0.814053).  Saving model ...
Epoch: 2 cost time: 2.4894585609436035
Epoch: 2, Steps: 89 | Train Loss: 0.940 Vali Loss: 0.658 Vali Acc: 0.893 Test Loss: 0.658 Test Acc: 0.893
Validation loss decreased (-0.814053 --> -0.893447).  Saving model ...
Epoch: 3 cost time: 2.3188998699188232
Epoch: 3, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.426 Vali Acc: 0.896 Test Loss: 0.426 Test Acc: 0.896
Validation loss decreased (-0.893447 --> -0.896235).  Saving model ...
Epoch: 4 cost time: 2.4832332134246826
Epoch: 4, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
Validation loss decreased (-0.896235 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 2.5930910110473633
Epoch: 5, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
Validation loss decreased (-0.931752 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 2.6148838996887207
Epoch: 6, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.939413 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 2.3440191745758057
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 2.483532428741455
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.350383996963501
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.24361252784729
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.507350444793701
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.962394).  Saving model ...
Epoch: 12 cost time: 2.6096067428588867
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.150 Vali Acc: 0.948 Test Loss: 0.150 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4565999507904053
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.966573).  Saving model ...
Epoch: 14 cost time: 2.2187442779541016
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.164278507232666
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3520901203155518
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.189 Vali Acc: 0.936 Test Loss: 0.189 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1836977005004883
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5855813026428223
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.966573).  Saving model ...
Epoch: 19 cost time: 2.3543546199798584
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4190473556518555
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 21 cost time: 2.5615994930267334
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5074918270111084
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.373206377029419
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5138444900512695
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4051811695098877
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.51548171043396
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5512218475341797
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4444425106048584
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3983664512634277
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1700632572174072
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 764986
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.696263313293457
Epoch: 1, Steps: 89 | Train Loss: 2.169 Vali Loss: 1.404 Vali Acc: 0.831 Test Loss: 1.404 Test Acc: 0.831
Validation loss decreased (inf --> -0.830766).  Saving model ...
Epoch: 2 cost time: 1.4531831741333008
Epoch: 2, Steps: 89 | Train Loss: 0.949 Vali Loss: 0.657 Vali Acc: 0.881 Test Loss: 0.657 Test Acc: 0.881
Validation loss decreased (-0.830766 --> -0.880913).  Saving model ...
Epoch: 3 cost time: 1.7023754119873047
Epoch: 3, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.428 Vali Acc: 0.896 Test Loss: 0.428 Test Acc: 0.896
Validation loss decreased (-0.880913 --> -0.896235).  Saving model ...
Epoch: 4 cost time: 1.555370807647705
Epoch: 4, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.269 Vali Acc: 0.939 Test Loss: 0.269 Test Acc: 0.939
Validation loss decreased (-0.896235 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 1.521777629852295
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.938716 --> -0.949858).  Saving model ...
Epoch: 6 cost time: 1.6310954093933105
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.949858 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 1.6488840579986572
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.87445068359375
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.846351146697998
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 10 cost time: 1.5986518859863281
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.863302230834961
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.678333044052124
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961002).  Saving model ...
Epoch: 13 cost time: 1.808997631072998
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.961002 --> -0.967269).  Saving model ...
Epoch: 14 cost time: 1.6064414978027344
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7441158294677734
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5867743492126465
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5862572193145752
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5865836143493652
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7193541526794434
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6653363704681396
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.727325201034546
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.929 Test Loss: 0.221 Test Acc: 0.929
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5956103801727295
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4482967853546143
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 760890
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.5874829292297363
Epoch: 1, Steps: 89 | Train Loss: 2.142 Vali Loss: 1.336 Vali Acc: 0.840 Test Loss: 1.336 Test Acc: 0.840
Validation loss decreased (inf --> -0.839820).  Saving model ...
Epoch: 2 cost time: 1.339421272277832
Epoch: 2, Steps: 89 | Train Loss: 0.887 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
Validation loss decreased (-0.839820 --> -0.883002).  Saving model ...
Epoch: 3 cost time: 1.600062370300293
Epoch: 3, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.385 Vali Acc: 0.902 Test Loss: 0.385 Test Acc: 0.902
Validation loss decreased (-0.883002 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 1.4854979515075684
Epoch: 4, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
Validation loss decreased (-0.901807 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 1.322904348373413
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.376729965209961
Epoch: 6, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.940109 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 1.4166231155395508
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 1.3391916751861572
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3143301010131836
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.455672025680542
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4189844131469727
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.954734 --> -0.958912).  Saving model ...
Epoch: 12 cost time: 1.2993919849395752
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.952 Test Loss: 0.148 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2424566745758057
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3199963569641113
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.587437391281128
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2052812576293945
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2277984619140625
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.294 Vali Acc: 0.914 Test Loss: 0.294 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1477406024932861
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.363962173461914
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963090).  Saving model ...
Epoch: 20 cost time: 1.2684829235076904
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.278904676437378
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.967269).  Saving model ...
Epoch: 22 cost time: 1.3390116691589355
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2731235027313232
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2241003513336182
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 25 cost time: 1.200737476348877
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.279439926147461
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.929 Test Loss: 0.250 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2573540210723877
Epoch: 27, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2723422050476074
Epoch: 28, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.38264799118042
Epoch: 29, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3225781917572021
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2842991352081299
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 32 cost time: 1.3346755504608154
Epoch: 32, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2084276676177979
Epoch: 33, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4388806819915771
Epoch: 34, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4108853340148926
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6641647815704346
Epoch: 36, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7243609428405762
Epoch: 37, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 38 cost time: 1.8910841941833496
Epoch: 38, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6797075271606445
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 40 cost time: 1.4373526573181152
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 41 cost time: 1.792470932006836
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.550987958908081
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6632845401763916
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5423858165740967
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6223077774047852
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.471670150756836
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3537302017211914
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4544248580932617
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.510636806488037
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4878008365631104
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 758842
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.886857271194458
Epoch: 1, Steps: 89 | Train Loss: 2.669 Vali Loss: 2.194 Vali Acc: 0.692 Test Loss: 2.194 Test Acc: 0.692
Validation loss decreased (inf --> -0.692179).  Saving model ...
Epoch: 2 cost time: 8.014473676681519
Epoch: 2, Steps: 89 | Train Loss: 1.748 Vali Loss: 1.313 Vali Acc: 0.825 Test Loss: 1.313 Test Acc: 0.825
Validation loss decreased (-0.692179 --> -0.824499).  Saving model ...
Epoch: 3 cost time: 8.074743747711182
Epoch: 3, Steps: 89 | Train Loss: 0.963 Vali Loss: 0.732 Vali Acc: 0.876 Test Loss: 0.732 Test Acc: 0.876
Validation loss decreased (-0.824499 --> -0.876037).  Saving model ...
Epoch: 4 cost time: 8.303233861923218
Epoch: 4, Steps: 89 | Train Loss: 0.529 Vali Loss: 0.454 Vali Acc: 0.921 Test Loss: 0.454 Test Acc: 0.921
Validation loss decreased (-0.876037 --> -0.920608).  Saving model ...
Epoch: 5 cost time: 7.841179132461548
Epoch: 5, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.920608 --> -0.934537).  Saving model ...
Epoch: 6 cost time: 7.80462384223938
Epoch: 6, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.934537 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 7.910318374633789
Epoch: 7, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.943591 --> -0.947769).  Saving model ...
Epoch: 8 cost time: 7.489351272583008
Epoch: 8, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.947769 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 8.599306344985962
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 8.08443021774292
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 8.078094959259033
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 8.611060380935669
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972143).  Saving model ...
Epoch: 13 cost time: 7.910512208938599
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.871826648712158
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.9733781814575195
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.027338743209839
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.37503170967102
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.296205759048462
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.512008666992188
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.057632684707642
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973537).  Saving model ...
Epoch: 21 cost time: 8.599686861038208
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.973537).  Saving model ...
Epoch: 22 cost time: 8.005060911178589
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.056129693984985
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 24 cost time: 7.846414804458618
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.464619159698486
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.863696336746216
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.433892011642456
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 9.216394901275635
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 29 cost time: 8.367762327194214
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.249209642410278
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 7.313839673995972
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 8.116554737091064
Epoch: 32, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 8.732069253921509
Epoch: 33, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 8.579121828079224
Epoch: 34, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 8.170916557312012
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 8.36026120185852
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 8.069295644760132
Epoch: 37, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 7.968256950378418
Epoch: 38, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 407644
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.095486879348755
Epoch: 1, Steps: 89 | Train Loss: 2.722 Vali Loss: 2.253 Vali Acc: 0.584 Test Loss: 2.253 Test Acc: 0.584
Validation loss decreased (inf --> -0.584239).  Saving model ...
Epoch: 2 cost time: 6.420773029327393
Epoch: 2, Steps: 89 | Train Loss: 1.737 Vali Loss: 1.289 Vali Acc: 0.785 Test Loss: 1.289 Test Acc: 0.785
Validation loss decreased (-0.584239 --> -0.784806).  Saving model ...
Epoch: 3 cost time: 6.79238748550415
Epoch: 3, Steps: 89 | Train Loss: 0.946 Vali Loss: 0.734 Vali Acc: 0.884 Test Loss: 0.734 Test Acc: 0.884
Validation loss decreased (-0.784806 --> -0.884394).  Saving model ...
Epoch: 4 cost time: 6.973344087600708
Epoch: 4, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.476 Vali Acc: 0.911 Test Loss: 0.476 Test Acc: 0.911
Validation loss decreased (-0.884394 --> -0.910859).  Saving model ...
Epoch: 5 cost time: 6.699365139007568
Epoch: 5, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.345 Vali Acc: 0.939 Test Loss: 0.345 Test Acc: 0.939
Validation loss decreased (-0.910859 --> -0.938715).  Saving model ...
Epoch: 6 cost time: 6.454618215560913
Epoch: 6, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.938715 --> -0.948465).  Saving model ...
Epoch: 7 cost time: 6.4836742877960205
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
Validation loss decreased (-0.948465 --> -0.954733).  Saving model ...
Epoch: 8 cost time: 6.862804651260376
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
Validation loss decreased (-0.954733 --> -0.963786).  Saving model ...
Epoch: 9 cost time: 6.4594526290893555
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
Validation loss decreased (-0.963786 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 6.48646879196167
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966572).  Saving model ...
Epoch: 11 cost time: 6.447795152664185
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.652737855911255
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 6.844029664993286
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 6.691484689712524
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.8819966316223145
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.729567527770996
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.176689147949219
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 18 cost time: 6.486350059509277
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.711420774459839
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.528965711593628
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.36909818649292
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.764880418777466
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.807066917419434
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.5008814334869385
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.223465919494629
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 26 cost time: 7.754176378250122
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.413314580917358
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.709671258926392
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.476357460021973
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.514060020446777
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.668013572692871
Epoch: 31, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.664700508117676
Epoch: 32, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 7.155757904052734
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 7.489839315414429
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.3101043701171875
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 403548
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.797845840454102
Epoch: 1, Steps: 89 | Train Loss: 2.722 Vali Loss: 2.238 Vali Acc: 0.643 Test Loss: 2.238 Test Acc: 0.643
Validation loss decreased (inf --> -0.642735).  Saving model ...
Epoch: 2 cost time: 5.07096529006958
Epoch: 2, Steps: 89 | Train Loss: 1.730 Vali Loss: 1.274 Vali Acc: 0.814 Test Loss: 1.274 Test Acc: 0.814
Validation loss decreased (-0.642735 --> -0.814054).  Saving model ...
Epoch: 3 cost time: 5.186571359634399
Epoch: 3, Steps: 89 | Train Loss: 0.930 Vali Loss: 0.698 Vali Acc: 0.876 Test Loss: 0.698 Test Acc: 0.876
Validation loss decreased (-0.814054 --> -0.876038).  Saving model ...
Epoch: 4 cost time: 5.14919114112854
Epoch: 4, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.876038 --> -0.925483).  Saving model ...
Epoch: 5 cost time: 5.293844223022461
Epoch: 5, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.925483 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 5.448666334152222
Epoch: 6, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.944287 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 5.6390581130981445
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.205 Vali Acc: 0.955 Test Loss: 0.205 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.370911359786987
Epoch: 8, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 5.30448055267334
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 5.005536794662476
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 5.474407911300659
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.965180 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 5.2214624881744385
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.359612464904785
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.744205713272095
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.566378593444824
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.650428771972656
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.800230026245117
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 18 cost time: 5.798151016235352
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 19 cost time: 6.23774790763855
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 20 cost time: 5.7844860553741455
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.4285948276519775
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.340229749679565
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.229336738586426
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.182870149612427
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.316369295120239
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.533567667007446
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.510885000228882
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.219654560089111
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.4477574825286865
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 398428
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.814089059829712
Epoch: 1, Steps: 89 | Train Loss: 2.664 Vali Loss: 2.104 Vali Acc: 0.711 Test Loss: 2.104 Test Acc: 0.711
Validation loss decreased (inf --> -0.710982).  Saving model ...
Epoch: 2 cost time: 4.462305545806885
Epoch: 2, Steps: 89 | Train Loss: 1.567 Vali Loss: 1.113 Vali Acc: 0.845 Test Loss: 1.113 Test Acc: 0.845
Validation loss decreased (-0.710982 --> -0.844696).  Saving model ...
Epoch: 3 cost time: 4.191584348678589
Epoch: 3, Steps: 89 | Train Loss: 0.786 Vali Loss: 0.596 Vali Acc: 0.903 Test Loss: 0.596 Test Acc: 0.903
Validation loss decreased (-0.844696 --> -0.903197).  Saving model ...
Epoch: 4 cost time: 4.365023374557495
Epoch: 4, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.396 Vali Acc: 0.923 Test Loss: 0.396 Test Acc: 0.923
Validation loss decreased (-0.903197 --> -0.923394).  Saving model ...
Epoch: 5 cost time: 4.386605978012085
Epoch: 5, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.923394 --> -0.943590).  Saving model ...
Epoch: 6 cost time: 4.245163202285767
Epoch: 6, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.943590 --> -0.958215).  Saving model ...
Epoch: 7 cost time: 4.51463770866394
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
Validation loss decreased (-0.958215 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 4.661755800247192
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.755671739578247
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 4.699632883071899
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 4.723677396774292
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 4.292799711227417
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 4.513253927230835
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 4.6905152797698975
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.643751382827759
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.676318883895874
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.460688591003418
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.602381467819214
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.437446117401123
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.217196226119995
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.409505844116211
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.573603868484497
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.01728081703186
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 394332
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.821393728256226
Epoch: 1, Steps: 89 | Train Loss: 2.727 Vali Loss: 2.255 Vali Acc: 0.670 Test Loss: 2.255 Test Acc: 0.670
Validation loss decreased (inf --> -0.669894).  Saving model ...
Epoch: 2 cost time: 3.501715660095215
Epoch: 2, Steps: 89 | Train Loss: 1.752 Vali Loss: 1.260 Vali Acc: 0.828 Test Loss: 1.260 Test Acc: 0.828
Validation loss decreased (-0.669894 --> -0.827982).  Saving model ...
Epoch: 3 cost time: 3.1820154190063477
Epoch: 3, Steps: 89 | Train Loss: 0.894 Vali Loss: 0.655 Vali Acc: 0.897 Test Loss: 0.655 Test Acc: 0.897
Validation loss decreased (-0.827982 --> -0.896929).  Saving model ...
Epoch: 4 cost time: 2.861738681793213
Epoch: 4, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.393 Vali Acc: 0.935 Test Loss: 0.393 Test Acc: 0.935
Validation loss decreased (-0.896929 --> -0.935233).  Saving model ...
Epoch: 5 cost time: 2.968825578689575
Epoch: 5, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.280 Vali Acc: 0.951 Test Loss: 0.280 Test Acc: 0.951
Validation loss decreased (-0.935233 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 3.0621490478515625
Epoch: 6, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
Validation loss decreased (-0.951251 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 3.235353469848633
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.956822 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 3.25101375579834
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.968661).  Saving model ...
Epoch: 9 cost time: 3.2742011547088623
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.968661 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 2.8619396686553955
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 3.374803066253662
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 3.4254140853881836
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1932668685913086
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.326979398727417
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3874552249908447
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.672607660293579
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3189828395843506
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2760252952575684
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 19 cost time: 3.119217872619629
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.097062587738037
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.133478879928589
Epoch: 21, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9018173217773438
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9811441898345947
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.330213785171509
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.235625743865967
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.0978496074676514
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.132715940475464
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.455394744873047
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 390236
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.951338768005371
Epoch: 1, Steps: 89 | Train Loss: 2.581 Vali Loss: 1.968 Vali Acc: 0.717 Test Loss: 1.968 Test Acc: 0.717
Validation loss decreased (inf --> -0.717251).  Saving model ...
Epoch: 2 cost time: 2.8550240993499756
Epoch: 2, Steps: 89 | Train Loss: 1.417 Vali Loss: 0.976 Vali Acc: 0.870 Test Loss: 0.976 Test Acc: 0.870
Validation loss decreased (-0.717251 --> -0.869767).  Saving model ...
Epoch: 3 cost time: 2.7646002769470215
Epoch: 3, Steps: 89 | Train Loss: 0.679 Vali Loss: 0.507 Vali Acc: 0.924 Test Loss: 0.507 Test Acc: 0.924
Validation loss decreased (-0.869767 --> -0.924090).  Saving model ...
Epoch: 4 cost time: 2.752808094024658
Epoch: 4, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.924090 --> -0.949857).  Saving model ...
Epoch: 5 cost time: 2.453565835952759
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
Validation loss decreased (-0.949857 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.668099880218506
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.174 Vali Acc: 0.966 Test Loss: 0.174 Test Acc: 0.966
Validation loss decreased (-0.954037 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 2.527618646621704
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4653804302215576
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4613900184631348
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 2.5479025840759277
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7614431381225586
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 2.651088237762451
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 2.543275833129883
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.539536952972412
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6205697059631348
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8740108013153076
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6330339908599854
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6052775382995605
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.784104585647583
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9867424964904785
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6775929927825928
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.914743423461914
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 388188
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.638136386871338
Epoch: 1, Steps: 89 | Train Loss: 2.630 Vali Loss: 2.065 Vali Acc: 0.686 Test Loss: 2.065 Test Acc: 0.686
Validation loss decreased (inf --> -0.685912).  Saving model ...
Epoch: 2 cost time: 2.3569142818450928
Epoch: 2, Steps: 89 | Train Loss: 1.551 Vali Loss: 1.112 Vali Acc: 0.856 Test Loss: 1.112 Test Acc: 0.856
Validation loss decreased (-0.685912 --> -0.855838).  Saving model ...
Epoch: 3 cost time: 2.1200692653656006
Epoch: 3, Steps: 89 | Train Loss: 0.799 Vali Loss: 0.609 Vali Acc: 0.907 Test Loss: 0.609 Test Acc: 0.907
Validation loss decreased (-0.855838 --> -0.906679).  Saving model ...
Epoch: 4 cost time: 1.892446756362915
Epoch: 4, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.382 Vali Acc: 0.932 Test Loss: 0.382 Test Acc: 0.932
Validation loss decreased (-0.906679 --> -0.932447).  Saving model ...
Epoch: 5 cost time: 1.853200912475586
Epoch: 5, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.932447 --> -0.949858).  Saving model ...
Epoch: 6 cost time: 1.9239091873168945
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.949858 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 1.8669207096099854
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 1.7804419994354248
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.2327933311462402
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.0332443714141846
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 2.081315279006958
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 2.283210515975952
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 2.3253746032714844
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.327260732650757
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 15 cost time: 2.4860615730285645
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1855275630950928
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0155937671661377
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4025845527648926
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9958019256591797
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9188225269317627
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1737124919891357
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9897651672363281
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0821893215179443
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1279220581054688
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 386140
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9409067630767822
Epoch: 1, Steps: 89 | Train Loss: 2.657 Vali Loss: 2.065 Vali Acc: 0.731 Test Loss: 2.065 Test Acc: 0.731
Validation loss decreased (inf --> -0.730481).  Saving model ...
Epoch: 2 cost time: 1.8579633235931396
Epoch: 2, Steps: 89 | Train Loss: 1.483 Vali Loss: 0.984 Vali Acc: 0.878 Test Loss: 0.984 Test Acc: 0.878
Validation loss decreased (-0.730481 --> -0.878124).  Saving model ...
Epoch: 3 cost time: 1.6308376789093018
Epoch: 3, Steps: 89 | Train Loss: 0.665 Vali Loss: 0.476 Vali Acc: 0.927 Test Loss: 0.476 Test Acc: 0.927
Validation loss decreased (-0.878124 --> -0.926875).  Saving model ...
Epoch: 4 cost time: 1.6787080764770508
Epoch: 4, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
Validation loss decreased (-0.926875 --> -0.952643).  Saving model ...
Epoch: 5 cost time: 1.7827682495117188
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
Validation loss decreased (-0.952643 --> -0.962393).  Saving model ...
Epoch: 6 cost time: 1.5689682960510254
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
Validation loss decreased (-0.962393 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 1.6212654113769531
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 1.6230969429016113
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 1.7333214282989502
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.927196741104126
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 1.7987282276153564
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 1.8565797805786133
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7081940174102783
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.050267457962036
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 1.9473841190338135
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9467079639434814
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7167842388153076
Epoch: 17, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8762402534484863
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.669783592224121
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5705294609069824
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5920076370239258
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.939 Test Loss: 0.161 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.583716630935669
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.756498098373413
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7898695468902588
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 385116
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.153302192687988
Epoch: 1, Steps: 89 | Train Loss: 2.362 Vali Loss: 1.716 Vali Acc: 0.766 Test Loss: 1.716 Test Acc: 0.766
Validation loss decreased (inf --> -0.766000).  Saving model ...
Epoch: 2 cost time: 8.209442138671875
Epoch: 2, Steps: 89 | Train Loss: 1.282 Vali Loss: 0.958 Vali Acc: 0.845 Test Loss: 0.958 Test Acc: 0.845
Validation loss decreased (-0.766000 --> -0.844698).  Saving model ...
Epoch: 3 cost time: 7.363872289657593
Epoch: 3, Steps: 89 | Train Loss: 0.694 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
Validation loss decreased (-0.844698 --> -0.889270).  Saving model ...
Epoch: 4 cost time: 7.410680770874023
Epoch: 4, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.405 Vali Acc: 0.905 Test Loss: 0.405 Test Acc: 0.905
Validation loss decreased (-0.889270 --> -0.905288).  Saving model ...
Epoch: 5 cost time: 7.688703298568726
Epoch: 5, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.905288 --> -0.931055).  Saving model ...
Epoch: 6 cost time: 7.420734167098999
Epoch: 6, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.931055 --> -0.933145).  Saving model ...
Epoch: 7 cost time: 7.140036344528198
Epoch: 7, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
Validation loss decreased (-0.933145 --> -0.942895).  Saving model ...
Epoch: 8 cost time: 7.346202373504639
Epoch: 8, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 7.535982847213745
Epoch: 9, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.790549039840698
Epoch: 10, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.719184637069702
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.185 Vali Acc: 0.947 Test Loss: 0.185 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.903379678726196
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.028350830078125
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.659048080444336
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 15 cost time: 7.481713771820068
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.1419172286987305
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.257174253463745
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 18 cost time: 7.864616870880127
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.034041404724121
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.91106104850769
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.869274377822876
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 22 cost time: 7.812933921813965
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.127954959869385
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.287184000015259
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.631968259811401
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.291309595108032
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.6000754833221436
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.5244221687316895
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.601622104644775
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.21252703666687
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.6017162799835205
Epoch: 31, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 32 cost time: 7.245558738708496
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 7.150730609893799
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 7.38506007194519
Epoch: 34, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 7.957028865814209
Epoch: 35, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 8.19930911064148
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 37 cost time: 8.081728219985962
Epoch: 37, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 8.481396675109863
Epoch: 38, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 8.604203224182129
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 7.253129005432129
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 7.8757452964782715
Epoch: 41, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 7.6813743114471436
Epoch: 42, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 7.603132486343384
Epoch: 43, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 8.288519620895386
Epoch: 44, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 8.15216851234436
Epoch: 45, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 8.192431211471558
Epoch: 46, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 407610
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.890751123428345
Epoch: 1, Steps: 89 | Train Loss: 2.363 Vali Loss: 1.665 Vali Acc: 0.831 Test Loss: 1.665 Test Acc: 0.831
Validation loss decreased (inf --> -0.830763).  Saving model ...
Epoch: 2 cost time: 6.243560314178467
Epoch: 2, Steps: 89 | Train Loss: 1.205 Vali Loss: 0.844 Vali Acc: 0.870 Test Loss: 0.844 Test Acc: 0.870
Validation loss decreased (-0.830763 --> -0.870465).  Saving model ...
Epoch: 3 cost time: 6.470539093017578
Epoch: 3, Steps: 89 | Train Loss: 0.622 Vali Loss: 0.521 Vali Acc: 0.891 Test Loss: 0.521 Test Acc: 0.891
Validation loss decreased (-0.870465 --> -0.890663).  Saving model ...
Epoch: 4 cost time: 6.061442613601685
Epoch: 4, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.388 Vali Acc: 0.912 Test Loss: 0.388 Test Acc: 0.912
Validation loss decreased (-0.890663 --> -0.912252).  Saving model ...
Epoch: 5 cost time: 6.107917547225952
Epoch: 5, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.309 Vali Acc: 0.921 Test Loss: 0.309 Test Acc: 0.921
Validation loss decreased (-0.912252 --> -0.921306).  Saving model ...
Epoch: 6 cost time: 5.988629102706909
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
Validation loss decreased (-0.921306 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 6.1628944873809814
Epoch: 7, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.940109 --> -0.951251).  Saving model ...
Epoch: 8 cost time: 6.4300336837768555
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.203 Vali Acc: 0.945 Test Loss: 0.203 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.092753171920776
Epoch: 9, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.187173128128052
Epoch: 10, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.454963207244873
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.951251 --> -0.954037).  Saving model ...
Epoch: 12 cost time: 5.862729549407959
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 6.266175746917725
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.310296535491943
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.341862678527832
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.591207265853882
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.4699015617370605
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.031006336212158
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.1671388149261475
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.366433143615723
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.917433738708496
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.182999134063721
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 403514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.29696249961853
Epoch: 1, Steps: 89 | Train Loss: 2.269 Vali Loss: 1.568 Vali Acc: 0.807 Test Loss: 1.568 Test Acc: 0.807
Validation loss decreased (inf --> -0.807087).  Saving model ...
Epoch: 2 cost time: 5.0887510776519775
Epoch: 2, Steps: 89 | Train Loss: 1.123 Vali Loss: 0.797 Vali Acc: 0.873 Test Loss: 0.797 Test Acc: 0.873
Validation loss decreased (-0.807087 --> -0.872555).  Saving model ...
Epoch: 3 cost time: 5.5888121128082275
Epoch: 3, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.495 Vali Acc: 0.905 Test Loss: 0.495 Test Acc: 0.905
Validation loss decreased (-0.872555 --> -0.905288).  Saving model ...
Epoch: 4 cost time: 5.760836601257324
Epoch: 4, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
Validation loss decreased (-0.905288 --> -0.922002).  Saving model ...
Epoch: 5 cost time: 5.8395912647247314
Epoch: 5, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.282 Vali Acc: 0.939 Test Loss: 0.282 Test Acc: 0.939
Validation loss decreased (-0.922002 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 5.976212978363037
Epoch: 6, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.256 Vali Acc: 0.936 Test Loss: 0.256 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.241510391235352
Epoch: 7, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.546477556228638
Epoch: 8, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.938716 --> -0.948466).  Saving model ...
Epoch: 9 cost time: 5.1144208908081055
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 5.479310750961304
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.098215341567993
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.194457769393921
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.224308490753174
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 5.308369159698486
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.195594072341919
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.971173286437988
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.08031439781189
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.966582775115967
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.3899431228637695
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.175707101821899
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.356005907058716
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.0168421268463135
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.3306190967559814
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 398394
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.083909511566162
Epoch: 1, Steps: 89 | Train Loss: 2.321 Vali Loss: 1.625 Vali Acc: 0.761 Test Loss: 1.625 Test Acc: 0.761
Validation loss decreased (inf --> -0.761126).  Saving model ...
Epoch: 2 cost time: 4.063567399978638
Epoch: 2, Steps: 89 | Train Loss: 1.135 Vali Loss: 0.809 Vali Acc: 0.871 Test Loss: 0.809 Test Acc: 0.871
Validation loss decreased (-0.761126 --> -0.871162).  Saving model ...
Epoch: 3 cost time: 4.3793864250183105
Epoch: 3, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.497 Vali Acc: 0.906 Test Loss: 0.497 Test Acc: 0.906
Validation loss decreased (-0.871162 --> -0.905984).  Saving model ...
Epoch: 4 cost time: 4.028604984283447
Epoch: 4, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.905984 --> -0.929662).  Saving model ...
Epoch: 5 cost time: 3.9782838821411133
Epoch: 5, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
Validation loss decreased (-0.929662 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 3.720423936843872
Epoch: 6, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.232 Vali Acc: 0.936 Test Loss: 0.232 Test Acc: 0.936
Validation loss decreased (-0.935234 --> -0.935931).  Saving model ...
Epoch: 7 cost time: 3.950099468231201
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
Validation loss decreased (-0.935931 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 3.9345815181732178
Epoch: 8, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.950555 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 3.8917338848114014
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
Validation loss decreased (-0.951948 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 3.992839813232422
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.104957818984985
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.395300388336182
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 4.071733474731445
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.168459415435791
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.2149951457977295
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.916308879852295
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.1562676429748535
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.2289488315582275
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.956 Test Loss: 0.140 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9253861904144287
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8740880489349365
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.710794448852539
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7557764053344727
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 394298
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.730116128921509
Epoch: 1, Steps: 89 | Train Loss: 2.383 Vali Loss: 1.638 Vali Acc: 0.772 Test Loss: 1.638 Test Acc: 0.772
Validation loss decreased (inf --> -0.771571).  Saving model ...
Epoch: 2 cost time: 2.921427011489868
Epoch: 2, Steps: 89 | Train Loss: 1.109 Vali Loss: 0.770 Vali Acc: 0.880 Test Loss: 0.770 Test Acc: 0.880
Validation loss decreased (-0.771571 --> -0.880215).  Saving model ...
Epoch: 3 cost time: 2.773219347000122
Epoch: 3, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.458 Vali Acc: 0.899 Test Loss: 0.458 Test Acc: 0.899
Validation loss decreased (-0.880215 --> -0.899020).  Saving model ...
Epoch: 4 cost time: 3.118591547012329
Epoch: 4, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
Validation loss decreased (-0.899020 --> -0.932448).  Saving model ...
Epoch: 5 cost time: 3.0663609504699707
Epoch: 5, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.246 Vali Acc: 0.940 Test Loss: 0.246 Test Acc: 0.940
Validation loss decreased (-0.932448 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 3.0222415924072266
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.940109 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 2.940459966659546
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 3.146103858947754
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 3.04136061668396
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.185 Vali Acc: 0.939 Test Loss: 0.185 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1355526447296143
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 2.607999801635742
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 12 cost time: 2.6017425060272217
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 13 cost time: 2.522306442260742
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 2.709413766860962
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.623904228210449
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.666595697402954
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.952 Test Loss: 0.143 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.930624485015869
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1338374614715576
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.354473829269409
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.990328788757324
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 21 cost time: 3.1698787212371826
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9365921020507812
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8177826404571533
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8482699394226074
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970054).  Saving model ...
Epoch: 25 cost time: 3.1136474609375
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970054 --> -0.970054).  Saving model ...
Epoch: 26 cost time: 2.9962656497955322
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7734603881835938
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.855515241622925
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7682571411132812
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.851381540298462
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8453593254089355
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7320456504821777
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8123269081115723
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.708332061767578
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.227588176727295
Epoch: 35, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 390202
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.803292751312256
Epoch: 1, Steps: 89 | Train Loss: 2.315 Vali Loss: 1.559 Vali Acc: 0.773 Test Loss: 1.559 Test Acc: 0.773
Validation loss decreased (inf --> -0.772965).  Saving model ...
Epoch: 2 cost time: 2.2169244289398193
Epoch: 2, Steps: 89 | Train Loss: 1.061 Vali Loss: 0.730 Vali Acc: 0.884 Test Loss: 0.730 Test Acc: 0.884
Validation loss decreased (-0.772965 --> -0.883697).  Saving model ...
Epoch: 3 cost time: 2.2161455154418945
Epoch: 3, Steps: 89 | Train Loss: 0.518 Vali Loss: 0.442 Vali Acc: 0.904 Test Loss: 0.442 Test Acc: 0.904
Validation loss decreased (-0.883697 --> -0.903895).  Saving model ...
Epoch: 4 cost time: 2.256359100341797
Epoch: 4, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.273 Vali Acc: 0.940 Test Loss: 0.273 Test Acc: 0.940
Validation loss decreased (-0.903895 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 2.4450252056121826
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.228 Vali Acc: 0.945 Test Loss: 0.228 Test Acc: 0.945
Validation loss decreased (-0.940109 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 2.4551842212677
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5430965423583984
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.944984 --> -0.949163).  Saving model ...
Epoch: 8 cost time: 2.3081393241882324
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.949163 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 2.2005908489227295
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.341144323348999
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1728501319885254
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.468371868133545
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.960305 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 2.298370838165283
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4314985275268555
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.30173397064209
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5190155506134033
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 17 cost time: 2.6894116401672363
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.45442271232605
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7487354278564453
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4107351303100586
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.585690975189209
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5766940116882324
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.464954376220703
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.330803394317627
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3981988430023193
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.594102144241333
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 388154
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0101816654205322
Epoch: 1, Steps: 89 | Train Loss: 2.332 Vali Loss: 1.559 Vali Acc: 0.794 Test Loss: 1.559 Test Acc: 0.794
Validation loss decreased (inf --> -0.793856).  Saving model ...
Epoch: 2 cost time: 1.626326322555542
Epoch: 2, Steps: 89 | Train Loss: 1.046 Vali Loss: 0.705 Vali Acc: 0.882 Test Loss: 0.705 Test Acc: 0.882
Validation loss decreased (-0.793856 --> -0.881609).  Saving model ...
Epoch: 3 cost time: 1.8211255073547363
Epoch: 3, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.384 Vali Acc: 0.916 Test Loss: 0.384 Test Acc: 0.916
Validation loss decreased (-0.881609 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 1.6866436004638672
Epoch: 4, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.916431 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 1.8236567974090576
Epoch: 5, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.928270 --> -0.930360).  Saving model ...
Epoch: 6 cost time: 2.0289487838745117
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.930360 --> -0.945680).  Saving model ...
Epoch: 7 cost time: 2.028911590576172
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.945680 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 1.9109909534454346
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9700613021850586
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8183510303497314
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0046443939208984
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9168195724487305
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9838640689849854
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.092366933822632
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1234121322631836
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8424489498138428
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.822664737701416
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 386106
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7025821208953857
Epoch: 1, Steps: 89 | Train Loss: 2.299 Vali Loss: 1.521 Vali Acc: 0.797 Test Loss: 1.521 Test Acc: 0.797
Validation loss decreased (inf --> -0.797339).  Saving model ...
Epoch: 2 cost time: 1.240204095840454
Epoch: 2, Steps: 89 | Train Loss: 1.015 Vali Loss: 0.682 Vali Acc: 0.879 Test Loss: 0.682 Test Acc: 0.879
Validation loss decreased (-0.797339 --> -0.878823).  Saving model ...
Epoch: 3 cost time: 1.3046464920043945
Epoch: 3, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.371 Vali Acc: 0.914 Test Loss: 0.371 Test Acc: 0.914
Validation loss decreased (-0.878823 --> -0.913645).  Saving model ...
Epoch: 4 cost time: 1.413478136062622
Epoch: 4, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.913645 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 1.390190839767456
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.940805 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 1.3702239990234375
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.942198 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 1.303706407546997
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4239847660064697
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 1.3267252445220947
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.545170545578003
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.337592601776123
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3559322357177734
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.394362449645996
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3865561485290527
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3129384517669678
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.410853385925293
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2969589233398438
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2594232559204102
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 385082
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.379703760147095
Epoch: 1, Steps: 89 | Train Loss: 2.742 Vali Loss: 2.277 Vali Acc: 0.614 Test Loss: 2.277 Test Acc: 0.614
Validation loss decreased (inf --> -0.614183).  Saving model ...
Epoch: 2 cost time: 7.828752517700195
Epoch: 2, Steps: 89 | Train Loss: 1.810 Vali Loss: 1.380 Vali Acc: 0.823 Test Loss: 1.380 Test Acc: 0.823
Validation loss decreased (-0.614183 --> -0.823106).  Saving model ...
Epoch: 3 cost time: 8.068617820739746
Epoch: 3, Steps: 89 | Train Loss: 1.035 Vali Loss: 0.793 Vali Acc: 0.876 Test Loss: 0.793 Test Acc: 0.876
Validation loss decreased (-0.823106 --> -0.876037).  Saving model ...
Epoch: 4 cost time: 8.090020656585693
Epoch: 4, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
Validation loss decreased (-0.876037 --> -0.910859).  Saving model ...
Epoch: 5 cost time: 8.980092525482178
Epoch: 5, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.346 Vali Acc: 0.938 Test Loss: 0.346 Test Acc: 0.938
Validation loss decreased (-0.910859 --> -0.938019).  Saving model ...
Epoch: 6 cost time: 8.500272512435913
Epoch: 6, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.266 Vali Acc: 0.951 Test Loss: 0.266 Test Acc: 0.951
Validation loss decreased (-0.938019 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 8.782175302505493
Epoch: 7, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
Validation loss decreased (-0.951251 --> -0.962393).  Saving model ...
Epoch: 8 cost time: 7.981517314910889
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.113724708557129
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.962393 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 8.59876799583435
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 11 cost time: 9.243558168411255
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 8.644308805465698
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.201412916183472
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 8.773238182067871
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.797170639038086
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 8.65813660621643
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 8.343153715133667
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.08962106704712
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.575812816619873
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.747899532318115
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 21 cost time: 8.477657318115234
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.46435022354126
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.650981903076172
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.532670021057129
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.208238124847412
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.092525959014893
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.403745889663696
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.115195751190186
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.963127613067627
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.168736696243286
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 209500
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.810966491699219
Epoch: 1, Steps: 89 | Train Loss: 2.748 Vali Loss: 2.357 Vali Acc: 0.583 Test Loss: 2.357 Test Acc: 0.583
Validation loss decreased (inf --> -0.582846).  Saving model ...
Epoch: 2 cost time: 6.474864482879639
Epoch: 2, Steps: 89 | Train Loss: 1.861 Vali Loss: 1.391 Vali Acc: 0.779 Test Loss: 1.391 Test Acc: 0.779
Validation loss decreased (-0.582846 --> -0.778538).  Saving model ...
Epoch: 3 cost time: 6.52401328086853
Epoch: 3, Steps: 89 | Train Loss: 1.023 Vali Loss: 0.773 Vali Acc: 0.864 Test Loss: 0.773 Test Acc: 0.864
Validation loss decreased (-0.778538 --> -0.863502).  Saving model ...
Epoch: 4 cost time: 6.644409656524658
Epoch: 4, Steps: 89 | Train Loss: 0.595 Vali Loss: 0.499 Vali Acc: 0.909 Test Loss: 0.499 Test Acc: 0.909
Validation loss decreased (-0.863502 --> -0.909466).  Saving model ...
Epoch: 5 cost time: 6.615001678466797
Epoch: 5, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.909466 --> -0.924787).  Saving model ...
Epoch: 6 cost time: 6.664903402328491
Epoch: 6, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.272 Vali Acc: 0.939 Test Loss: 0.272 Test Acc: 0.939
Validation loss decreased (-0.924787 --> -0.939412).  Saving model ...
Epoch: 7 cost time: 6.998264312744141
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
Validation loss decreased (-0.939412 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 7.14567232131958
Epoch: 8, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 7.248827695846558
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958215).  Saving model ...
Epoch: 10 cost time: 6.644203186035156
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.959608).  Saving model ...
Epoch: 11 cost time: 6.536698579788208
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966572).  Saving model ...
Epoch: 12 cost time: 6.282534837722778
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.667737245559692
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.477023363113403
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 15 cost time: 7.9358015060424805
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 16 cost time: 7.551568031311035
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.19540810585022
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 7.220785617828369
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 6.980205297470093
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.393056631088257
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.113812446594238
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.031862258911133
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.766565322875977
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.460461854934692
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.626655340194702
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.708548307418823
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.887181520462036
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.950359106063843
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 207452
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.561323642730713
Epoch: 1, Steps: 89 | Train Loss: 2.729 Vali Loss: 2.267 Vali Acc: 0.658 Test Loss: 2.267 Test Acc: 0.658
Validation loss decreased (inf --> -0.658055).  Saving model ...
Epoch: 2 cost time: 5.6345555782318115
Epoch: 2, Steps: 89 | Train Loss: 1.762 Vali Loss: 1.293 Vali Acc: 0.842 Test Loss: 1.293 Test Acc: 0.842
Validation loss decreased (-0.658055 --> -0.841909).  Saving model ...
Epoch: 3 cost time: 5.665359973907471
Epoch: 3, Steps: 89 | Train Loss: 0.935 Vali Loss: 0.699 Vali Acc: 0.879 Test Loss: 0.699 Test Acc: 0.879
Validation loss decreased (-0.841909 --> -0.878823).  Saving model ...
Epoch: 4 cost time: 5.378876686096191
Epoch: 4, Steps: 89 | Train Loss: 0.510 Vali Loss: 0.430 Vali Acc: 0.926 Test Loss: 0.430 Test Acc: 0.926
Validation loss decreased (-0.878823 --> -0.926180).  Saving model ...
Epoch: 5 cost time: 5.603577375411987
Epoch: 5, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.300 Vali Acc: 0.943 Test Loss: 0.300 Test Acc: 0.943
Validation loss decreased (-0.926180 --> -0.942894).  Saving model ...
Epoch: 6 cost time: 5.543047189712524
Epoch: 6, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
Validation loss decreased (-0.942894 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 5.496441602706909
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 5.520824909210205
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 5.382152557373047
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.254336357116699
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 5.177000999450684
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 5.361665964126587
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 5.571749210357666
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.459599494934082
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.35310173034668
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.647217273712158
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 6.358396530151367
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.91935658454895
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 19 cost time: 5.701138734817505
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 5.514230251312256
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.242610931396484
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.522590160369873
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.5129711627960205
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.857398986816406
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.311562776565552
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.326083421707153
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.343819618225098
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.279423952102661
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 29 cost time: 5.643094778060913
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.564354419708252
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 31 cost time: 5.404819488525391
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 32 cost time: 5.355295896530151
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.841341733932495
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.886383771896362
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 35 cost time: 5.572901248931885
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.159007549285889
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.233601808547974
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.344618082046509
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.445672035217285
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 40 cost time: 5.354666233062744
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.07599663734436
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.3736724853515625
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.463587284088135
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 44 cost time: 4.8851752281188965
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.12527871131897
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.949769020080566
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 4.893896579742432
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.821044683456421
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 5.093803405761719
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 5.139598608016968
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 5.274791955947876
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 5.580111503601074
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 5.532307147979736
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 204892
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.86356782913208
Epoch: 1, Steps: 89 | Train Loss: 2.734 Vali Loss: 2.247 Vali Acc: 0.640 Test Loss: 2.247 Test Acc: 0.640
Validation loss decreased (inf --> -0.639950).  Saving model ...
Epoch: 2 cost time: 4.4272284507751465
Epoch: 2, Steps: 89 | Train Loss: 1.741 Vali Loss: 1.299 Vali Acc: 0.830 Test Loss: 1.299 Test Acc: 0.830
Validation loss decreased (-0.639950 --> -0.830071).  Saving model ...
Epoch: 3 cost time: 4.60312557220459
Epoch: 3, Steps: 89 | Train Loss: 0.956 Vali Loss: 0.746 Vali Acc: 0.874 Test Loss: 0.746 Test Acc: 0.874
Validation loss decreased (-0.830071 --> -0.873948).  Saving model ...
Epoch: 4 cost time: 3.9772021770477295
Epoch: 4, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.476 Vali Acc: 0.909 Test Loss: 0.476 Test Acc: 0.909
Validation loss decreased (-0.873948 --> -0.909466).  Saving model ...
Epoch: 5 cost time: 4.144405126571655
Epoch: 5, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.320 Vali Acc: 0.947 Test Loss: 0.320 Test Acc: 0.947
Validation loss decreased (-0.909466 --> -0.947072).  Saving model ...
Epoch: 6 cost time: 4.26442551612854
Epoch: 6, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.249 Vali Acc: 0.949 Test Loss: 0.249 Test Acc: 0.949
Validation loss decreased (-0.947072 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 4.182921409606934
Epoch: 7, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.949162 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 4.387172222137451
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.139779806137085
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959608).  Saving model ...
Epoch: 10 cost time: 4.700677394866943
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 4.135600566864014
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.604598045349121
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.328340530395508
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 4.463019371032715
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 4.498951196670532
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.4666218757629395
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.228113174438477
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 4.394205331802368
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 19 cost time: 4.144341468811035
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.200820446014404
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.4159886837005615
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 4.452002048492432
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 4.371516466140747
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.253065347671509
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.446820020675659
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.076167106628418
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.119521856307983
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.196573495864868
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.2875449657440186
Epoch: 29, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.10284948348999
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.275608539581299
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.099344730377197
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 202844
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.281607151031494
Epoch: 1, Steps: 89 | Train Loss: 2.689 Vali Loss: 2.177 Vali Acc: 0.666 Test Loss: 2.177 Test Acc: 0.666
Validation loss decreased (inf --> -0.665716).  Saving model ...
Epoch: 2 cost time: 3.254596710205078
Epoch: 2, Steps: 89 | Train Loss: 1.640 Vali Loss: 1.177 Vali Acc: 0.828 Test Loss: 1.177 Test Acc: 0.828
Validation loss decreased (-0.665716 --> -0.827983).  Saving model ...
Epoch: 3 cost time: 3.2427785396575928
Epoch: 3, Steps: 89 | Train Loss: 0.837 Vali Loss: 0.626 Vali Acc: 0.901 Test Loss: 0.626 Test Acc: 0.901
Validation loss decreased (-0.827983 --> -0.901108).  Saving model ...
Epoch: 4 cost time: 3.357290744781494
Epoch: 4, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.390 Vali Acc: 0.929 Test Loss: 0.390 Test Acc: 0.929
Validation loss decreased (-0.901108 --> -0.928965).  Saving model ...
Epoch: 5 cost time: 3.230642795562744
Epoch: 5, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.928965 --> -0.949858).  Saving model ...
Epoch: 6 cost time: 3.2944533824920654
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.209 Vali Acc: 0.955 Test Loss: 0.209 Test Acc: 0.955
Validation loss decreased (-0.949858 --> -0.954733).  Saving model ...
Epoch: 7 cost time: 3.252685546875
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
Validation loss decreased (-0.954733 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 3.1941769123077393
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4222450256347656
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 3.371096134185791
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 3.2465980052948
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 2.974893808364868
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 3.1240334510803223
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.044665575027466
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 3.3755173683166504
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1137654781341553
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 3.497542381286621
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 18 cost time: 3.7686359882354736
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 3.4091007709503174
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 20 cost time: 3.4011924266815186
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.472684383392334
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5192108154296875
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4701037406921387
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5854735374450684
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.436769723892212
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5963573455810547
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.140085220336914
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1285574436187744
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.1630351543426514
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 200796
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.617889165878296
Epoch: 1, Steps: 89 | Train Loss: 2.695 Vali Loss: 2.138 Vali Acc: 0.774 Test Loss: 2.138 Test Acc: 0.774
Validation loss decreased (inf --> -0.773655).  Saving model ...
Epoch: 2 cost time: 2.4438657760620117
Epoch: 2, Steps: 89 | Train Loss: 1.547 Vali Loss: 1.055 Vali Acc: 0.892 Test Loss: 1.055 Test Acc: 0.892
Validation loss decreased (-0.773655 --> -0.892051).  Saving model ...
Epoch: 3 cost time: 2.305020809173584
Epoch: 3, Steps: 89 | Train Loss: 0.718 Vali Loss: 0.547 Vali Acc: 0.909 Test Loss: 0.547 Test Acc: 0.909
Validation loss decreased (-0.892051 --> -0.909465).  Saving model ...
Epoch: 4 cost time: 2.436274290084839
Epoch: 4, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.343 Vali Acc: 0.945 Test Loss: 0.343 Test Acc: 0.945
Validation loss decreased (-0.909465 --> -0.944983).  Saving model ...
Epoch: 5 cost time: 2.3601231575012207
Epoch: 5, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.242 Vali Acc: 0.961 Test Loss: 0.242 Test Acc: 0.961
Validation loss decreased (-0.944983 --> -0.961000).  Saving model ...
Epoch: 6 cost time: 2.6240761280059814
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.846400737762451
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.961000 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 2.6353085041046143
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.572387933731079
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 2.6397287845611572
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.476605176925659
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.329242467880249
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 2.5820071697235107
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5117311477661133
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3608205318450928
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2980196475982666
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 2.327155351638794
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3779141902923584
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.38468861579895
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4632039070129395
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.62762188911438
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9014527797698975
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7459089756011963
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7077181339263916
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8988778591156006
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7225663661956787
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 199772
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.29016375541687
Epoch: 1, Steps: 89 | Train Loss: 2.668 Vali Loss: 2.156 Vali Acc: 0.671 Test Loss: 2.156 Test Acc: 0.671
Validation loss decreased (inf --> -0.670591).  Saving model ...
Epoch: 2 cost time: 2.0006325244903564
Epoch: 2, Steps: 89 | Train Loss: 1.611 Vali Loss: 1.173 Vali Acc: 0.844 Test Loss: 1.173 Test Acc: 0.844
Validation loss decreased (-0.670591 --> -0.843999).  Saving model ...
Epoch: 3 cost time: 1.9860713481903076
Epoch: 3, Steps: 89 | Train Loss: 0.825 Vali Loss: 0.620 Vali Acc: 0.901 Test Loss: 0.620 Test Acc: 0.901
Validation loss decreased (-0.843999 --> -0.901108).  Saving model ...
Epoch: 4 cost time: 1.9747557640075684
Epoch: 4, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.410 Vali Acc: 0.926 Test Loss: 0.410 Test Acc: 0.926
Validation loss decreased (-0.901108 --> -0.926180).  Saving model ...
Epoch: 5 cost time: 1.8247711658477783
Epoch: 5, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.293 Vali Acc: 0.939 Test Loss: 0.293 Test Acc: 0.939
Validation loss decreased (-0.926180 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 1.705233097076416
Epoch: 6, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.938716 --> -0.944287).  Saving model ...
Epoch: 7 cost time: 1.8695416450500488
Epoch: 7, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
Validation loss decreased (-0.944287 --> -0.961697).  Saving model ...
Epoch: 8 cost time: 1.751276969909668
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.18746018409729
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.961697 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 2.1624600887298584
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 2.119173049926758
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 2.5976052284240723
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 2.0284621715545654
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 2.3528013229370117
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1334993839263916
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2931442260742188
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 2.3188483715057373
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1645147800445557
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.326833486557007
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 20 cost time: 2.2771217823028564
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.902635097503662
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9435114860534668
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9046738147735596
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.109873056411743
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3095521926879883
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9360501766204834
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2369720935821533
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9598805904388428
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8815991878509521
Epoch: 29, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 198748
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.257840871810913
Epoch: 1, Steps: 89 | Train Loss: 2.618 Vali Loss: 2.061 Vali Acc: 0.728 Test Loss: 2.061 Test Acc: 0.728
Validation loss decreased (inf --> -0.728392).  Saving model ...
Epoch: 2 cost time: 1.65516996383667
Epoch: 2, Steps: 89 | Train Loss: 1.502 Vali Loss: 1.024 Vali Acc: 0.866 Test Loss: 1.024 Test Acc: 0.866
Validation loss decreased (-0.728392 --> -0.865589).  Saving model ...
Epoch: 3 cost time: 1.622441053390503
Epoch: 3, Steps: 89 | Train Loss: 0.715 Vali Loss: 0.537 Vali Acc: 0.910 Test Loss: 0.537 Test Acc: 0.910
Validation loss decreased (-0.865589 --> -0.910162).  Saving model ...
Epoch: 4 cost time: 1.545551061630249
Epoch: 4, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.306 Vali Acc: 0.947 Test Loss: 0.306 Test Acc: 0.947
Validation loss decreased (-0.910162 --> -0.947072).  Saving model ...
Epoch: 5 cost time: 1.7814526557922363
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
Validation loss decreased (-0.947072 --> -0.956822).  Saving model ...
Epoch: 6 cost time: 1.565516471862793
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
Validation loss decreased (-0.956822 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 1.5802273750305176
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 1.7166693210601807
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.524946928024292
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 1.6436922550201416
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.961 Test Loss: 0.114 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6380655765533447
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5687024593353271
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 1.5207109451293945
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 1.5833508968353271
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7897264957427979
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5899484157562256
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5748722553253174
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 1.6797270774841309
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.661895513534546
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.929513931274414
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9133782386779785
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7694942951202393
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5899903774261475
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7080910205841064
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9384677410125732
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8228747844696045
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.751246690750122
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 198236
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.1082124710083
Epoch: 1, Steps: 89 | Train Loss: 2.470 Vali Loss: 1.842 Vali Acc: 0.799 Test Loss: 1.842 Test Acc: 0.799
Validation loss decreased (inf --> -0.798728).  Saving model ...
Epoch: 2 cost time: 7.6467554569244385
Epoch: 2, Steps: 89 | Train Loss: 1.352 Vali Loss: 0.978 Vali Acc: 0.861 Test Loss: 0.978 Test Acc: 0.861
Validation loss decreased (-0.798728 --> -0.861411).  Saving model ...
Epoch: 3 cost time: 7.941426038742065
Epoch: 3, Steps: 89 | Train Loss: 0.717 Vali Loss: 0.581 Vali Acc: 0.891 Test Loss: 0.581 Test Acc: 0.891
Validation loss decreased (-0.861411 --> -0.890663).  Saving model ...
Epoch: 4 cost time: 7.77724027633667
Epoch: 4, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.412 Vali Acc: 0.916 Test Loss: 0.412 Test Acc: 0.916
Validation loss decreased (-0.890663 --> -0.916430).  Saving model ...
Epoch: 5 cost time: 8.081170797348022
Epoch: 5, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
Validation loss decreased (-0.916430 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 7.818013906478882
Epoch: 6, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
Validation loss decreased (-0.929663 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 8.161044359207153
Epoch: 7, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.938020 --> -0.947769).  Saving model ...
Epoch: 8 cost time: 7.832129955291748
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.947769 --> -0.949162).  Saving model ...
Epoch: 9 cost time: 7.711022138595581
Epoch: 9, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.951252).  Saving model ...
Epoch: 10 cost time: 8.002624750137329
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951252 --> -0.951948).  Saving model ...
Epoch: 11 cost time: 7.528356552124023
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.951948 --> -0.956823).  Saving model ...
Epoch: 12 cost time: 7.918814182281494
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.287172317504883
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.958216).  Saving model ...
Epoch: 14 cost time: 7.879649877548218
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.958216 --> -0.963787).  Saving model ...
Epoch: 15 cost time: 8.403640031814575
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.172152280807495
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.437995672225952
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.276045560836792
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.495846271514893
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 20 cost time: 8.284040212631226
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.36994218826294
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.204541444778442
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.490530014038086
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.8715479373931885
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.458256006240845
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.371075868606567
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.8762946128845215
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.830260276794434
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.398145198822021
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 209466
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.35710334777832
Epoch: 1, Steps: 89 | Train Loss: 2.459 Vali Loss: 1.773 Vali Acc: 0.759 Test Loss: 1.773 Test Acc: 0.759
Validation loss decreased (inf --> -0.759035).  Saving model ...
Epoch: 2 cost time: 6.348312139511108
Epoch: 2, Steps: 89 | Train Loss: 1.283 Vali Loss: 0.899 Vali Acc: 0.866 Test Loss: 0.899 Test Acc: 0.866
Validation loss decreased (-0.759035 --> -0.866286).  Saving model ...
Epoch: 3 cost time: 6.185863018035889
Epoch: 3, Steps: 89 | Train Loss: 0.668 Vali Loss: 0.533 Vali Acc: 0.891 Test Loss: 0.533 Test Acc: 0.891
Validation loss decreased (-0.866286 --> -0.891360).  Saving model ...
Epoch: 4 cost time: 6.211181163787842
Epoch: 4, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.379 Vali Acc: 0.916 Test Loss: 0.379 Test Acc: 0.916
Validation loss decreased (-0.891360 --> -0.916431).  Saving model ...
Epoch: 5 cost time: 6.220613241195679
Epoch: 5, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.293 Vali Acc: 0.939 Test Loss: 0.293 Test Acc: 0.939
Validation loss decreased (-0.916431 --> -0.939412).  Saving model ...
Epoch: 6 cost time: 6.371309280395508
Epoch: 6, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.267 Vali Acc: 0.934 Test Loss: 0.267 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.675680637359619
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.939412 --> -0.944288).  Saving model ...
Epoch: 8 cost time: 6.847513675689697
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.944288 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 6.574949502944946
Epoch: 9, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.5956268310546875
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.43231463432312
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.736282825469971
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960305).  Saving model ...
Epoch: 13 cost time: 6.677978277206421
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 6.684719562530518
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.3912317752838135
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.843303680419922
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.943036794662476
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.800718784332275
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.857833623886108
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.624717712402344
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.9893739223480225
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.7344183921813965
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 23 cost time: 6.508267641067505
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 24 cost time: 6.479856729507446
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.633337020874023
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.41861629486084
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.655109882354736
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.900484085083008
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.4175214767456055
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.951937675476074
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.413124322891235
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.19459867477417
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.214010953903198
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 207418
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.2120137214660645
Epoch: 1, Steps: 89 | Train Loss: 2.476 Vali Loss: 1.805 Vali Acc: 0.773 Test Loss: 1.805 Test Acc: 0.773
Validation loss decreased (inf --> -0.772962).  Saving model ...
Epoch: 2 cost time: 5.336613178253174
Epoch: 2, Steps: 89 | Train Loss: 1.269 Vali Loss: 0.890 Vali Acc: 0.854 Test Loss: 0.890 Test Acc: 0.854
Validation loss decreased (-0.772962 --> -0.853752).  Saving model ...
Epoch: 3 cost time: 5.382897853851318
Epoch: 3, Steps: 89 | Train Loss: 0.640 Vali Loss: 0.523 Vali Acc: 0.885 Test Loss: 0.523 Test Acc: 0.885
Validation loss decreased (-0.853752 --> -0.885092).  Saving model ...
Epoch: 4 cost time: 5.26856803894043
Epoch: 4, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.376 Vali Acc: 0.913 Test Loss: 0.376 Test Acc: 0.913
Validation loss decreased (-0.885092 --> -0.912949).  Saving model ...
Epoch: 5 cost time: 5.1941962242126465
Epoch: 5, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.283 Vali Acc: 0.932 Test Loss: 0.283 Test Acc: 0.932
Validation loss decreased (-0.912949 --> -0.932448).  Saving model ...
Epoch: 6 cost time: 5.071420907974243
Epoch: 6, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
Validation loss decreased (-0.932448 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 5.471832752227783
Epoch: 7, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.815151691436768
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.8650782108306885
Epoch: 9, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.944984 --> -0.946377).  Saving model ...
Epoch: 10 cost time: 5.247743844985962
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.309527635574341
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.946377 --> -0.949859).  Saving model ...
Epoch: 12 cost time: 5.435903072357178
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
Validation loss decreased (-0.949859 --> -0.956127).  Saving model ...
Epoch: 13 cost time: 6.337012767791748
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956127 --> -0.956823).  Saving model ...
Epoch: 14 cost time: 6.335564851760864
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.959609).  Saving model ...
Epoch: 15 cost time: 5.999528169631958
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.964483).  Saving model ...
Epoch: 16 cost time: 5.544388771057129
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.952 Test Loss: 0.149 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.390548944473267
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.393957138061523
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 19 cost time: 5.387543439865112
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.042615175247192
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.1482157707214355
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.26820707321167
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.886369466781616
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.620934009552002
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.458797931671143
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.2222325801849365
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.604994535446167
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.5768280029296875
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 204858
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.286499261856079
Epoch: 1, Steps: 89 | Train Loss: 2.446 Vali Loss: 1.759 Vali Acc: 0.800 Test Loss: 1.759 Test Acc: 0.800
Validation loss decreased (inf --> -0.800122).  Saving model ...
Epoch: 2 cost time: 3.6746790409088135
Epoch: 2, Steps: 89 | Train Loss: 1.226 Vali Loss: 0.865 Vali Acc: 0.877 Test Loss: 0.865 Test Acc: 0.877
Validation loss decreased (-0.800122 --> -0.877429).  Saving model ...
Epoch: 3 cost time: 3.9539246559143066
Epoch: 3, Steps: 89 | Train Loss: 0.600 Vali Loss: 0.490 Vali Acc: 0.909 Test Loss: 0.490 Test Acc: 0.909
Validation loss decreased (-0.877429 --> -0.908769).  Saving model ...
Epoch: 4 cost time: 3.98165225982666
Epoch: 4, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
Validation loss decreased (-0.908769 --> -0.930359).  Saving model ...
Epoch: 5 cost time: 4.461496114730835
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
Validation loss decreased (-0.930359 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 4.293962478637695
Epoch: 6, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
Validation loss decreased (-0.940109 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 4.5712056159973145
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.166339635848999
Epoch: 8, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 4.28342080116272
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9633498191833496
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.950555 --> -0.958912).  Saving model ...
Epoch: 11 cost time: 3.9919538497924805
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8709278106689453
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 13 cost time: 3.9774460792541504
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.896798849105835
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.185337543487549
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966573).  Saving model ...
Epoch: 16 cost time: 3.9512059688568115
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.033901691436768
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.158761501312256
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.21858286857605
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.319278240203857
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.213676929473877
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.358010768890381
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.9150469303131104
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.27533745765686
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.9549002647399902
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 202810
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.200166702270508
Epoch: 1, Steps: 89 | Train Loss: 2.518 Vali Loss: 1.812 Vali Acc: 0.734 Test Loss: 1.812 Test Acc: 0.734
Validation loss decreased (inf --> -0.733965).  Saving model ...
Epoch: 2 cost time: 2.7053096294403076
Epoch: 2, Steps: 89 | Train Loss: 1.266 Vali Loss: 0.866 Vali Acc: 0.863 Test Loss: 0.866 Test Acc: 0.863
Validation loss decreased (-0.733965 --> -0.862805).  Saving model ...
Epoch: 3 cost time: 2.8083808422088623
Epoch: 3, Steps: 89 | Train Loss: 0.591 Vali Loss: 0.469 Vali Acc: 0.905 Test Loss: 0.469 Test Acc: 0.905
Validation loss decreased (-0.862805 --> -0.905288).  Saving model ...
Epoch: 4 cost time: 3.0723235607147217
Epoch: 4, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.905288 --> -0.931055).  Saving model ...
Epoch: 5 cost time: 2.888535976409912
Epoch: 5, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
Validation loss decreased (-0.931055 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 3.2737410068511963
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.938716 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 3.0453712940216064
Epoch: 7, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.954037 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 3.012397527694702
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.214364767074585
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 3.2445569038391113
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 2.986905097961426
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.158332347869873
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8405277729034424
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.938565492630005
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7682981491088867
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7155184745788574
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7064621448516846
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8126235008239746
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0884883403778076
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.278425455093384
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 200762
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.705497980117798
Epoch: 1, Steps: 89 | Train Loss: 2.498 Vali Loss: 1.791 Vali Acc: 0.775 Test Loss: 1.791 Test Acc: 0.775
Validation loss decreased (inf --> -0.775052).  Saving model ...
Epoch: 2 cost time: 2.642566680908203
Epoch: 2, Steps: 89 | Train Loss: 1.235 Vali Loss: 0.847 Vali Acc: 0.870 Test Loss: 0.847 Test Acc: 0.870
Validation loss decreased (-0.775052 --> -0.870465).  Saving model ...
Epoch: 3 cost time: 2.5324347019195557
Epoch: 3, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.476 Vali Acc: 0.901 Test Loss: 0.476 Test Acc: 0.901
Validation loss decreased (-0.870465 --> -0.901109).  Saving model ...
Epoch: 4 cost time: 2.503565788269043
Epoch: 4, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
Validation loss decreased (-0.901109 --> -0.930359).  Saving model ...
Epoch: 5 cost time: 2.3223373889923096
Epoch: 5, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.257 Vali Acc: 0.946 Test Loss: 0.257 Test Acc: 0.946
Validation loss decreased (-0.930359 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.2685422897338867
Epoch: 6, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
Validation loss decreased (-0.945680 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 2.3080246448516846
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.209343433380127
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.949162 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 2.245771646499634
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 1.9295945167541504
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959609).  Saving model ...
Epoch: 11 cost time: 2.0368854999542236
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2738990783691406
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.959609 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 2.401860237121582
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.956 Test Loss: 0.141 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.451258420944214
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.481377124786377
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5226564407348633
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6322598457336426
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6464452743530273
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6481833457946777
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.611297369003296
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.542750835418701
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3636293411254883
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 199738
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0230917930603027
Epoch: 1, Steps: 89 | Train Loss: 2.446 Vali Loss: 1.736 Vali Acc: 0.812 Test Loss: 1.736 Test Acc: 0.812
Validation loss decreased (inf --> -0.811960).  Saving model ...
Epoch: 2 cost time: 1.808068037033081
Epoch: 2, Steps: 89 | Train Loss: 1.185 Vali Loss: 0.807 Vali Acc: 0.880 Test Loss: 0.807 Test Acc: 0.880
Validation loss decreased (-0.811960 --> -0.880215).  Saving model ...
Epoch: 3 cost time: 1.583256721496582
Epoch: 3, Steps: 89 | Train Loss: 0.542 Vali Loss: 0.450 Vali Acc: 0.907 Test Loss: 0.450 Test Acc: 0.907
Validation loss decreased (-0.880215 --> -0.906681).  Saving model ...
Epoch: 4 cost time: 1.6071300506591797
Epoch: 4, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
Validation loss decreased (-0.906681 --> -0.926877).  Saving model ...
Epoch: 5 cost time: 1.563896656036377
Epoch: 5, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.221 Vali Acc: 0.955 Test Loss: 0.221 Test Acc: 0.955
Validation loss decreased (-0.926877 --> -0.954733).  Saving model ...
Epoch: 6 cost time: 1.7580013275146484
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.489067792892456
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 1.7002801895141602
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5962269306182861
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3510215282440186
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6637983322143555
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4305083751678467
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6002967357635498
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6959376335144043
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7173852920532227
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.955 Test Loss: 0.135 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6170098781585693
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.668504238128662
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 198714
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9267611503601074
Epoch: 1, Steps: 89 | Train Loss: 2.409 Vali Loss: 1.651 Vali Acc: 0.772 Test Loss: 1.651 Test Acc: 0.772
Validation loss decreased (inf --> -0.772268).  Saving model ...
Epoch: 2 cost time: 1.2791106700897217
Epoch: 2, Steps: 89 | Train Loss: 1.106 Vali Loss: 0.744 Vali Acc: 0.882 Test Loss: 0.744 Test Acc: 0.882
Validation loss decreased (-0.772268 --> -0.882305).  Saving model ...
Epoch: 3 cost time: 1.3158552646636963
Epoch: 3, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.882305 --> -0.902503).  Saving model ...
Epoch: 4 cost time: 1.385732889175415
Epoch: 4, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
Validation loss decreased (-0.902503 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 1.2779219150543213
Epoch: 5, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.927574 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 1.2270455360412598
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.944287 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 1.285677433013916
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 1.2198114395141602
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2113070487976074
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3172166347503662
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.959609 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 1.235504388809204
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.953 Test Loss: 0.143 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3620514869689941
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1332850456237793
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2838077545166016
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.270719289779663
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.243884801864624
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3354980945587158
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2110576629638672
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2519545555114746
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.953 Test Loss: 0.148 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4817874431610107
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 198202
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.030598878860474
Epoch: 1, Steps: 89 | Train Loss: 2.765 Vali Loss: 2.326 Vali Acc: 0.566 Test Loss: 2.326 Test Acc: 0.566
Validation loss decreased (inf --> -0.566133).  Saving model ...
Epoch: 2 cost time: 8.63477373123169
Epoch: 2, Steps: 89 | Train Loss: 1.851 Vali Loss: 1.413 Vali Acc: 0.792 Test Loss: 1.413 Test Acc: 0.792
Validation loss decreased (-0.566133 --> -0.791769).  Saving model ...
Epoch: 3 cost time: 8.7403564453125
Epoch: 3, Steps: 89 | Train Loss: 1.039 Vali Loss: 0.794 Vali Acc: 0.884 Test Loss: 0.794 Test Acc: 0.884
Validation loss decreased (-0.791769 --> -0.883697).  Saving model ...
Epoch: 4 cost time: 8.134414911270142
Epoch: 4, Steps: 89 | Train Loss: 0.581 Vali Loss: 0.501 Vali Acc: 0.910 Test Loss: 0.501 Test Acc: 0.910
Validation loss decreased (-0.883697 --> -0.910162).  Saving model ...
Epoch: 5 cost time: 8.096832752227783
Epoch: 5, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.355 Vali Acc: 0.933 Test Loss: 0.355 Test Acc: 0.933
Validation loss decreased (-0.910162 --> -0.933144).  Saving model ...
Epoch: 6 cost time: 7.708120107650757
Epoch: 6, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.276 Vali Acc: 0.945 Test Loss: 0.276 Test Acc: 0.945
Validation loss decreased (-0.933144 --> -0.944983).  Saving model ...
Epoch: 7 cost time: 8.013588905334473
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.226 Vali Acc: 0.954 Test Loss: 0.226 Test Acc: 0.954
Validation loss decreased (-0.944983 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 8.224863290786743
Epoch: 8, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 8.081039905548096
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.955430 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 8.329010963439941
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 7.778263092041016
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.961001 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 7.800303220748901
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 7.661576986312866
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.547875165939331
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 15 cost time: 7.7188801765441895
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.56008005142212
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.318572044372559
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.479506492614746
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.257648229598999
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.309546709060669
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973537).  Saving model ...
Epoch: 21 cost time: 7.594092130661011
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.4348554611206055
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.973537).  Saving model ...
Epoch: 23 cost time: 7.899572849273682
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 24 cost time: 8.232343196868896
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.198380708694458
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.510871648788452
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.36781620979309
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 28 cost time: 8.414300203323364
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.840361595153809
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.784741163253784
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.713724613189697
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 8.404186010360718
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 8.607608556747437
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 8.183676481246948
Epoch: 34, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 8.624727964401245
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 7.715554475784302
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.6021294593811035
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w23_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 110428
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.723250389099121
Epoch: 1, Steps: 89 | Train Loss: 2.754 Vali Loss: 2.290 Vali Acc: 0.670 Test Loss: 2.290 Test Acc: 0.670
Validation loss decreased (inf --> -0.669894).  Saving model ...
Epoch: 2 cost time: 7.239623069763184
Epoch: 2, Steps: 89 | Train Loss: 1.757 Vali Loss: 1.288 Vali Acc: 0.817 Test Loss: 1.288 Test Acc: 0.817
Validation loss decreased (-0.669894 --> -0.816839).  Saving model ...
Epoch: 3 cost time: 7.092901229858398
Epoch: 3, Steps: 89 | Train Loss: 0.940 Vali Loss: 0.732 Vali Acc: 0.879 Test Loss: 0.732 Test Acc: 0.879
Validation loss decreased (-0.816839 --> -0.878823).  Saving model ...
Epoch: 4 cost time: 7.021283149719238
Epoch: 4, Steps: 89 | Train Loss: 0.548 Vali Loss: 0.475 Vali Acc: 0.913 Test Loss: 0.475 Test Acc: 0.913
Validation loss decreased (-0.878823 --> -0.912948).  Saving model ...
Epoch: 5 cost time: 7.540589094161987
Epoch: 5, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.337 Vali Acc: 0.934 Test Loss: 0.337 Test Acc: 0.934
Validation loss decreased (-0.912948 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 6.951143741607666
Epoch: 6, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.933841 --> -0.940805).  Saving model ...
Epoch: 7 cost time: 6.788449764251709
Epoch: 7, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.940805 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 6.667779207229614
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
Validation loss decreased (-0.949162 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 6.343617677688599
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.571227073669434
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968661).  Saving model ...
Epoch: 11 cost time: 6.861964464187622
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.481197118759155
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.01707911491394
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.323343992233276
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 6.542854309082031
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.296829700469971
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 6.37494421005249
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.554759740829468
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.454025745391846
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 7.167128324508667
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 6.835696697235107
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.208350419998169
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.02452278137207
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 24 cost time: 6.976217985153198
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.691316604614258
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.881268739700317
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.457926511764526
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.621476411819458
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.411127328872681
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 30 cost time: 7.062697887420654
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.97073769569397
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.677613019943237
Epoch: 32, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.843886375427246
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.807868003845215
Epoch: 34, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.692679405212402
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.336705684661865
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.6993408203125
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.985645055770874
Epoch: 38, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.653205156326294
Epoch: 39, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w19_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 109404
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.5996856689453125
Epoch: 1, Steps: 89 | Train Loss: 2.790 Vali Loss: 2.350 Vali Acc: 0.606 Test Loss: 2.350 Test Acc: 0.606
Validation loss decreased (inf --> -0.605826).  Saving model ...
Epoch: 2 cost time: 5.390674591064453
Epoch: 2, Steps: 89 | Train Loss: 1.828 Vali Loss: 1.370 Vali Acc: 0.800 Test Loss: 1.370 Test Acc: 0.800
Validation loss decreased (-0.605826 --> -0.800126).  Saving model ...
Epoch: 3 cost time: 5.609822988510132
Epoch: 3, Steps: 89 | Train Loss: 1.003 Vali Loss: 0.773 Vali Acc: 0.882 Test Loss: 0.773 Test Acc: 0.882
Validation loss decreased (-0.800126 --> -0.881608).  Saving model ...
Epoch: 4 cost time: 5.146749258041382
Epoch: 4, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.499 Vali Acc: 0.907 Test Loss: 0.499 Test Acc: 0.907
Validation loss decreased (-0.881608 --> -0.906680).  Saving model ...
Epoch: 5 cost time: 5.687400579452515
Epoch: 5, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.358 Vali Acc: 0.928 Test Loss: 0.358 Test Acc: 0.928
Validation loss decreased (-0.906680 --> -0.927573).  Saving model ...
Epoch: 6 cost time: 5.260257720947266
Epoch: 6, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.276 Vali Acc: 0.947 Test Loss: 0.276 Test Acc: 0.947
Validation loss decreased (-0.927573 --> -0.947072).  Saving model ...
Epoch: 7 cost time: 5.62585973739624
Epoch: 7, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
Validation loss decreased (-0.947072 --> -0.953340).  Saving model ...
Epoch: 8 cost time: 5.694984436035156
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.188 Vali Acc: 0.961 Test Loss: 0.188 Test Acc: 0.961
Validation loss decreased (-0.953340 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 6.007457256317139
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.358273506164551
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.495834589004517
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.961001 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 5.510519504547119
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.6317267417907715
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.511049032211304
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.887451887130737
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.203375577926636
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.789068937301636
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972143 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 6.166579246520996
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.2026472091674805
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 20 cost time: 5.377895832061768
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.834758043289185
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.6027913093566895
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973537).  Saving model ...
Epoch: 23 cost time: 5.711185455322266
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.820635557174683
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.771682024002075
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.608697891235352
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.7454893589019775
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.691908836364746
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.700173854827881
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.295294761657715
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.1954216957092285
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 32 cost time: 5.077590227127075
Epoch: 32, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.47953987121582
Epoch: 33, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 34 cost time: 6.0407233238220215
Epoch: 34, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.984439849853516
Epoch: 35, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.534409999847412
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.67743182182312
Epoch: 37, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.866118431091309
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 5.963869333267212
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.349276065826416
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.564857006072998
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 5.1764075756073
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 5.665874004364014
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 108124
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.969296455383301
Epoch: 1, Steps: 89 | Train Loss: 2.848 Vali Loss: 2.487 Vali Acc: 0.476 Test Loss: 2.487 Test Acc: 0.476
Validation loss decreased (inf --> -0.475602).  Saving model ...
Epoch: 2 cost time: 4.417266130447388
Epoch: 2, Steps: 89 | Train Loss: 2.040 Vali Loss: 1.574 Vali Acc: 0.747 Test Loss: 1.574 Test Acc: 0.747
Validation loss decreased (-0.475602 --> -0.747199).  Saving model ...
Epoch: 3 cost time: 4.498927593231201
Epoch: 3, Steps: 89 | Train Loss: 1.180 Vali Loss: 0.877 Vali Acc: 0.862 Test Loss: 0.877 Test Acc: 0.862
Validation loss decreased (-0.747199 --> -0.862108).  Saving model ...
Epoch: 4 cost time: 4.76669979095459
Epoch: 4, Steps: 89 | Train Loss: 0.642 Vali Loss: 0.538 Vali Acc: 0.893 Test Loss: 0.538 Test Acc: 0.893
Validation loss decreased (-0.862108 --> -0.892752).  Saving model ...
Epoch: 5 cost time: 4.0076799392700195
Epoch: 5, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.892752 --> -0.924787).  Saving model ...
Epoch: 6 cost time: 4.437887668609619
Epoch: 6, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.271 Vali Acc: 0.945 Test Loss: 0.271 Test Acc: 0.945
Validation loss decreased (-0.924787 --> -0.944983).  Saving model ...
Epoch: 7 cost time: 4.569788694381714
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.944983 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 4.183865785598755
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.956126 --> -0.963090).  Saving model ...
Epoch: 9 cost time: 4.291792631149292
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.968661).  Saving model ...
Epoch: 10 cost time: 4.247859954833984
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.620228052139282
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.968661 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 4.596404314041138
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 4.5141377449035645
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 4.531566143035889
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 4.527917385101318
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.835613965988159
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 4.2201902866363525
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 4.253389120101929
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.394136428833008
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.308148145675659
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.673397779464722
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.270047426223755
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.1595618724823
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.651854515075684
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.574285268783569
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.814437389373779
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 27 cost time: 4.4594292640686035
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.173424482345581
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.34984827041626
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.334177494049072
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.077988386154175
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.181324005126953
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.349364757537842
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.691951513290405
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.4149253368377686
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.260039329528809
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 107100
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.551201581954956
Epoch: 1, Steps: 89 | Train Loss: 2.748 Vali Loss: 2.285 Vali Acc: 0.677 Test Loss: 2.285 Test Acc: 0.677
Validation loss decreased (inf --> -0.676857).  Saving model ...
Epoch: 2 cost time: 3.0245518684387207
Epoch: 2, Steps: 89 | Train Loss: 1.771 Vali Loss: 1.304 Vali Acc: 0.831 Test Loss: 1.304 Test Acc: 0.831
Validation loss decreased (-0.676857 --> -0.831463).  Saving model ...
Epoch: 3 cost time: 2.8447861671447754
Epoch: 3, Steps: 89 | Train Loss: 0.957 Vali Loss: 0.726 Vali Acc: 0.882 Test Loss: 0.726 Test Acc: 0.882
Validation loss decreased (-0.831463 --> -0.881608).  Saving model ...
Epoch: 4 cost time: 2.6969895362854004
Epoch: 4, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
Validation loss decreased (-0.881608 --> -0.918519).  Saving model ...
Epoch: 5 cost time: 2.8539557456970215
Epoch: 5, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.320 Vali Acc: 0.942 Test Loss: 0.320 Test Acc: 0.942
Validation loss decreased (-0.918519 --> -0.942197).  Saving model ...
Epoch: 6 cost time: 2.6417899131774902
Epoch: 6, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
Validation loss decreased (-0.942197 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 2.81246018409729
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 2.8973002433776855
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.959608 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 2.8401668071746826
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 2.9017162322998047
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 2.9541993141174316
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 12 cost time: 2.979539632797241
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 3.0714221000671387
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.990389108657837
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 2.945701837539673
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.751854658126831
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 2.8701069355010986
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6926987171173096
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 19 cost time: 2.990121841430664
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.816967487335205
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0695507526397705
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 22 cost time: 2.9200522899627686
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 23 cost time: 3.0237319469451904
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9496307373046875
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.415950298309326
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4377732276916504
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.267094135284424
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.965493679046631
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.1016502380371094
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.323945999145508
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.937394857406616
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.0198893547058105
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 106076
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.921351194381714
Epoch: 1, Steps: 89 | Train Loss: 2.807 Vali Loss: 2.344 Vali Acc: 0.610 Test Loss: 2.344 Test Acc: 0.610
Validation loss decreased (inf --> -0.610004).  Saving model ...
Epoch: 2 cost time: 2.6695964336395264
Epoch: 2, Steps: 89 | Train Loss: 1.820 Vali Loss: 1.338 Vali Acc: 0.827 Test Loss: 1.338 Test Acc: 0.827
Validation loss decreased (-0.610004 --> -0.827285).  Saving model ...
Epoch: 3 cost time: 2.736764907836914
Epoch: 3, Steps: 89 | Train Loss: 0.964 Vali Loss: 0.731 Vali Acc: 0.884 Test Loss: 0.731 Test Acc: 0.884
Validation loss decreased (-0.827285 --> -0.884394).  Saving model ...
Epoch: 4 cost time: 2.6641697883605957
Epoch: 4, Steps: 89 | Train Loss: 0.521 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.884394 --> -0.925483).  Saving model ...
Epoch: 5 cost time: 2.730337381362915
Epoch: 5, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.317 Vali Acc: 0.934 Test Loss: 0.317 Test Acc: 0.934
Validation loss decreased (-0.925483 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 2.5858542919158936
Epoch: 6, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
Validation loss decreased (-0.933841 --> -0.953340).  Saving model ...
Epoch: 7 cost time: 2.7782766819000244
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.953340 --> -0.967268).  Saving model ...
Epoch: 8 cost time: 2.7978339195251465
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.72015380859375
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.967268 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 2.8925094604492188
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2040345668792725
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 2.9103448390960693
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 2.778749465942383
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.67764949798584
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 2.846620798110962
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 16 cost time: 2.7987496852874756
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.711582660675049
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7694437503814697
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.547396183013916
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.474835157394409
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.62168288230896
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.717316150665283
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.498701810836792
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3936028480529785
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.376958131790161
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 105564
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2581827640533447
Epoch: 1, Steps: 89 | Train Loss: 2.787 Vali Loss: 2.337 Vali Acc: 0.671 Test Loss: 2.337 Test Acc: 0.671
Validation loss decreased (inf --> -0.671286).  Saving model ...
Epoch: 2 cost time: 1.9454467296600342
Epoch: 2, Steps: 89 | Train Loss: 1.830 Vali Loss: 1.349 Vali Acc: 0.821 Test Loss: 1.349 Test Acc: 0.821
Validation loss decreased (-0.671286 --> -0.821017).  Saving model ...
Epoch: 3 cost time: 2.019326686859131
Epoch: 3, Steps: 89 | Train Loss: 0.973 Vali Loss: 0.737 Vali Acc: 0.885 Test Loss: 0.737 Test Acc: 0.885
Validation loss decreased (-0.821017 --> -0.885090).  Saving model ...
Epoch: 4 cost time: 1.7680494785308838
Epoch: 4, Steps: 89 | Train Loss: 0.526 Vali Loss: 0.445 Vali Acc: 0.918 Test Loss: 0.445 Test Acc: 0.918
Validation loss decreased (-0.885090 --> -0.917823).  Saving model ...
Epoch: 5 cost time: 1.9652283191680908
Epoch: 5, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.315 Vali Acc: 0.942 Test Loss: 0.315 Test Acc: 0.942
Validation loss decreased (-0.917823 --> -0.942197).  Saving model ...
Epoch: 6 cost time: 1.9967186450958252
Epoch: 6, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
Validation loss decreased (-0.942197 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 1.859055519104004
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 1.9113974571228027
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.959608 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 1.905651569366455
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 2.1127474308013916
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 2.082077980041504
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 1.9848132133483887
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 2.233595371246338
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.881087303161621
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 2.00197434425354
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9368975162506104
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1723310947418213
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.101417303085327
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0063705444335938
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.993588924407959
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9830379486083984
Epoch: 21, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9001927375793457
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9100136756896973
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8567795753479004
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 105052
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.555661916732788
Epoch: 1, Steps: 89 | Train Loss: 2.744 Vali Loss: 2.358 Vali Acc: 0.515 Test Loss: 2.358 Test Acc: 0.515
Validation loss decreased (inf --> -0.515297).  Saving model ...
Epoch: 2 cost time: 1.499453067779541
Epoch: 2, Steps: 89 | Train Loss: 1.865 Vali Loss: 1.372 Vali Acc: 0.831 Test Loss: 1.372 Test Acc: 0.831
Validation loss decreased (-0.515297 --> -0.830766).  Saving model ...
Epoch: 3 cost time: 1.5502235889434814
Epoch: 3, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.696 Vali Acc: 0.889 Test Loss: 0.696 Test Acc: 0.889
Validation loss decreased (-0.830766 --> -0.889269).  Saving model ...
Epoch: 4 cost time: 1.9495086669921875
Epoch: 4, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.889269 --> -0.925483).  Saving model ...
Epoch: 5 cost time: 1.7816863059997559
Epoch: 5, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.274 Vali Acc: 0.942 Test Loss: 0.274 Test Acc: 0.942
Validation loss decreased (-0.925483 --> -0.941501).  Saving model ...
Epoch: 6 cost time: 1.867182731628418
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.941501 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 1.8345794677734375
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.956822 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 1.6230990886688232
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 1.9311878681182861
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.871647834777832
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 2.0916385650634766
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 1.8069241046905518
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 1.584322452545166
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8324251174926758
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.382948398590088
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5244431495666504
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4679224491119385
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5627448558807373
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4062387943267822
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4376323223114014
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 21 cost time: 1.707334280014038
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5167229175567627
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.541717529296875
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8571512699127197
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8356759548187256
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7629218101501465
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6877248287200928
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8774688243865967
Epoch: 28, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8661293983459473
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7155413627624512
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 104796
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.380661487579346
Epoch: 1, Steps: 89 | Train Loss: 2.613 Vali Loss: 2.001 Vali Acc: 0.760 Test Loss: 2.001 Test Acc: 0.760
Validation loss decreased (inf --> -0.759729).  Saving model ...
Epoch: 2 cost time: 7.478402137756348
Epoch: 2, Steps: 89 | Train Loss: 1.453 Vali Loss: 1.040 Vali Acc: 0.861 Test Loss: 1.040 Test Acc: 0.861
Validation loss decreased (-0.759729 --> -0.860714).  Saving model ...
Epoch: 3 cost time: 7.3398802280426025
Epoch: 3, Steps: 89 | Train Loss: 0.730 Vali Loss: 0.590 Vali Acc: 0.891 Test Loss: 0.590 Test Acc: 0.891
Validation loss decreased (-0.860714 --> -0.891359).  Saving model ...
Epoch: 4 cost time: 7.502857685089111
Epoch: 4, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.417 Vali Acc: 0.910 Test Loss: 0.417 Test Acc: 0.910
Validation loss decreased (-0.891359 --> -0.910163).  Saving model ...
Epoch: 5 cost time: 7.900692462921143
Epoch: 5, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.306 Vali Acc: 0.936 Test Loss: 0.306 Test Acc: 0.936
Validation loss decreased (-0.910163 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 7.603225469589233
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.935930 --> -0.940805).  Saving model ...
Epoch: 7 cost time: 7.501409530639648
Epoch: 7, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.358295440673828
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.940805 --> -0.942895).  Saving model ...
Epoch: 9 cost time: 7.270884037017822
Epoch: 9, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.942895 --> -0.949859).  Saving model ...
Epoch: 10 cost time: 6.890106201171875
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 11 cost time: 6.997688055038452
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.351683616638184
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.23531699180603
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.336277484893799
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
Validation loss decreased (-0.959608 --> -0.960305).  Saving model ...
Epoch: 15 cost time: 7.324719190597534
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.886044979095459
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.766627788543701
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.989405632019043
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 19 cost time: 6.629676580429077
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.604450702667236
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.238598585128784
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.6103246212005615
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.904264211654663
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.33438777923584
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.323535919189453
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.366300344467163
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.1798930168151855
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.95264744758606
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w23_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 110394
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.997143745422363
Epoch: 1, Steps: 89 | Train Loss: 2.531 Vali Loss: 1.923 Vali Acc: 0.777 Test Loss: 1.923 Test Acc: 0.777
Validation loss decreased (inf --> -0.777140).  Saving model ...
Epoch: 2 cost time: 7.119969606399536
Epoch: 2, Steps: 89 | Train Loss: 1.397 Vali Loss: 0.982 Vali Acc: 0.847 Test Loss: 0.982 Test Acc: 0.847
Validation loss decreased (-0.777140 --> -0.846787).  Saving model ...
Epoch: 3 cost time: 7.158515930175781
Epoch: 3, Steps: 89 | Train Loss: 0.712 Vali Loss: 0.578 Vali Acc: 0.886 Test Loss: 0.578 Test Acc: 0.886
Validation loss decreased (-0.846787 --> -0.886484).  Saving model ...
Epoch: 4 cost time: 6.418161153793335
Epoch: 4, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.403 Vali Acc: 0.905 Test Loss: 0.403 Test Acc: 0.905
Validation loss decreased (-0.886484 --> -0.905288).  Saving model ...
Epoch: 5 cost time: 6.471062421798706
Epoch: 5, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.327 Vali Acc: 0.921 Test Loss: 0.327 Test Acc: 0.921
Validation loss decreased (-0.905288 --> -0.920610).  Saving model ...
Epoch: 6 cost time: 6.274642705917358
Epoch: 6, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.253 Vali Acc: 0.947 Test Loss: 0.253 Test Acc: 0.947
Validation loss decreased (-0.920610 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 6.684000015258789
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.231 Vali Acc: 0.940 Test Loss: 0.231 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.462524652481079
Epoch: 8, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.531712532043457
Epoch: 9, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.954734).  Saving model ...
Epoch: 10 cost time: 6.738041400909424
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.92498254776001
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.159957647323608
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.140437602996826
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.954734 --> -0.955430).  Saving model ...
Epoch: 14 cost time: 6.172037124633789
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.521305799484253
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.958216).  Saving model ...
Epoch: 16 cost time: 6.369675397872925
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.958216 --> -0.963787).  Saving model ...
Epoch: 17 cost time: 5.98966908454895
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.847818374633789
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.01606297492981
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.309643507003784
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.199718236923218
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.357820987701416
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.4736692905426025
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.053764581680298
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.6130688190460205
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.1483659744262695
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w19_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 109370
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.375498533248901
Epoch: 1, Steps: 89 | Train Loss: 2.561 Vali Loss: 1.950 Vali Acc: 0.770 Test Loss: 1.950 Test Acc: 0.770
Validation loss decreased (inf --> -0.770175).  Saving model ...
Epoch: 2 cost time: 4.905334234237671
Epoch: 2, Steps: 89 | Train Loss: 1.404 Vali Loss: 0.989 Vali Acc: 0.864 Test Loss: 0.989 Test Acc: 0.864
Validation loss decreased (-0.770175 --> -0.863500).  Saving model ...
Epoch: 3 cost time: 5.485667705535889
Epoch: 3, Steps: 89 | Train Loss: 0.687 Vali Loss: 0.560 Vali Acc: 0.893 Test Loss: 0.560 Test Acc: 0.893
Validation loss decreased (-0.863500 --> -0.892752).  Saving model ...
Epoch: 4 cost time: 5.016929388046265
Epoch: 4, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.386 Vali Acc: 0.918 Test Loss: 0.386 Test Acc: 0.918
Validation loss decreased (-0.892752 --> -0.917823).  Saving model ...
Epoch: 5 cost time: 5.011157989501953
Epoch: 5, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.301 Vali Acc: 0.939 Test Loss: 0.301 Test Acc: 0.939
Validation loss decreased (-0.917823 --> -0.939412).  Saving model ...
Epoch: 6 cost time: 5.106585741043091
Epoch: 6, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
Validation loss decreased (-0.939412 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 5.82616925239563
Epoch: 7, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.213 Vali Acc: 0.945 Test Loss: 0.213 Test Acc: 0.945
Validation loss decreased (-0.940109 --> -0.944984).  Saving model ...
Epoch: 8 cost time: 4.962463855743408
Epoch: 8, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.944984 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 4.9574291706085205
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.931901931762695
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.057018280029297
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 5.149551630020142
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958216).  Saving model ...
Epoch: 13 cost time: 4.793024301528931
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.983346700668335
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.393314361572266
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 16 cost time: 5.1826653480529785
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.191295623779297
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.088174819946289
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.051083564758301
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.953 Test Loss: 0.138 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.944340467453003
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.758810043334961
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.884423494338989
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 23 cost time: 4.5789101123809814
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 24 cost time: 5.385056257247925
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.513970375061035
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.172062873840332
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970054).  Saving model ...
Epoch: 27 cost time: 5.454823017120361
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.218841314315796
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.960772752761841
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.885993242263794
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.952484607696533
Epoch: 31, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.748235702514648
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.831366539001465
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.866481065750122
Epoch: 34, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.429564952850342
Epoch: 35, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.354391574859619
Epoch: 36, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 108090
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.597905397415161
Epoch: 1, Steps: 89 | Train Loss: 2.612 Vali Loss: 2.002 Vali Acc: 0.727 Test Loss: 2.002 Test Acc: 0.727
Validation loss decreased (inf --> -0.726999).  Saving model ...
Epoch: 2 cost time: 4.059014797210693
Epoch: 2, Steps: 89 | Train Loss: 1.439 Vali Loss: 1.008 Vali Acc: 0.851 Test Loss: 1.008 Test Acc: 0.851
Validation loss decreased (-0.726999 --> -0.850965).  Saving model ...
Epoch: 3 cost time: 3.7375223636627197
Epoch: 3, Steps: 89 | Train Loss: 0.692 Vali Loss: 0.545 Vali Acc: 0.893 Test Loss: 0.545 Test Acc: 0.893
Validation loss decreased (-0.850965 --> -0.893449).  Saving model ...
Epoch: 4 cost time: 3.972233772277832
Epoch: 4, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.362 Vali Acc: 0.920 Test Loss: 0.362 Test Acc: 0.920
Validation loss decreased (-0.893449 --> -0.919913).  Saving model ...
Epoch: 5 cost time: 3.9328160285949707
Epoch: 5, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.919913 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 3.869853973388672
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.239 Vali Acc: 0.945 Test Loss: 0.239 Test Acc: 0.945
Validation loss decreased (-0.929663 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 4.016862392425537
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.944984 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 3.95112943649292
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.946377 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 4.239264965057373
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.282620429992676
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.312760829925537
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.955430 --> -0.956823).  Saving model ...
Epoch: 12 cost time: 4.413202524185181
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.176 Vali Acc: 0.947 Test Loss: 0.176 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.123117208480835
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 14 cost time: 3.7654123306274414
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.701911211013794
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.725032091140747
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.668339252471924
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6843209266662598
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963091).  Saving model ...
Epoch: 19 cost time: 3.629676103591919
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.610136032104492
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.85902738571167
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 22 cost time: 3.8617889881134033
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.873685836791992
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.9492380619049072
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.022842645645142
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8606083393096924
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5647337436676025
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 28 cost time: 3.4680094718933105
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6534383296966553
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.517148733139038
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.3504302501678467
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.433591604232788
Epoch: 32, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.772706985473633
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.6948037147521973
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.3534817695617676
Epoch: 35, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 36 cost time: 3.6611216068267822
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7833755016326904
Epoch: 37, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.399502754211426
Epoch: 38, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 39 cost time: 3.917736530303955
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 40 cost time: 3.5851290225982666
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.28639554977417
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.6782431602478027
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.537538766860962
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.581406831741333
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.5539023876190186
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.496459484100342
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.7715535163879395
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.7491421699523926
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.973442554473877
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 107066
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.623234272003174
Epoch: 1, Steps: 89 | Train Loss: 2.654 Vali Loss: 2.049 Vali Acc: 0.719 Test Loss: 2.049 Test Acc: 0.719
Validation loss decreased (inf --> -0.718642).  Saving model ...
Epoch: 2 cost time: 2.951737403869629
Epoch: 2, Steps: 89 | Train Loss: 1.466 Vali Loss: 1.007 Vali Acc: 0.867 Test Loss: 1.007 Test Acc: 0.867
Validation loss decreased (-0.718642 --> -0.866982).  Saving model ...
Epoch: 3 cost time: 2.62829327583313
Epoch: 3, Steps: 89 | Train Loss: 0.688 Vali Loss: 0.540 Vali Acc: 0.908 Test Loss: 0.540 Test Acc: 0.908
Validation loss decreased (-0.866982 --> -0.908073).  Saving model ...
Epoch: 4 cost time: 2.627338171005249
Epoch: 4, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
Validation loss decreased (-0.908073 --> -0.919216).  Saving model ...
Epoch: 5 cost time: 2.742966651916504
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.919216 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 2.829864740371704
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.929663 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 2.63191819190979
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
Validation loss decreased (-0.942895 --> -0.956823).  Saving model ...
Epoch: 8 cost time: 2.8569183349609375
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.035896062850952
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.956823 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 3.0168261528015137
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.956823 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 3.3919565677642822
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.095309257507324
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.972015142440796
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.011688709259033
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.938588857650757
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.147400140762329
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6895604133605957
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.587273359298706
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8316874504089355
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9360527992248535
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 106042
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2750637531280518
Epoch: 1, Steps: 89 | Train Loss: 2.543 Vali Loss: 1.913 Vali Acc: 0.757 Test Loss: 1.913 Test Acc: 0.757
Validation loss decreased (inf --> -0.756945).  Saving model ...
Epoch: 2 cost time: 2.160459041595459
Epoch: 2, Steps: 89 | Train Loss: 1.355 Vali Loss: 0.949 Vali Acc: 0.852 Test Loss: 0.949 Test Acc: 0.852
Validation loss decreased (-0.756945 --> -0.852358).  Saving model ...
Epoch: 3 cost time: 1.966559886932373
Epoch: 3, Steps: 89 | Train Loss: 0.633 Vali Loss: 0.503 Vali Acc: 0.896 Test Loss: 0.503 Test Acc: 0.896
Validation loss decreased (-0.852358 --> -0.896235).  Saving model ...
Epoch: 4 cost time: 2.0504698753356934
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.896235 --> -0.925484).  Saving model ...
Epoch: 5 cost time: 2.192451000213623
Epoch: 5, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.249 Vali Acc: 0.946 Test Loss: 0.249 Test Acc: 0.946
Validation loss decreased (-0.925484 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.1353044509887695
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.945680 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 2.119086265563965
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.949162 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 2.1453959941864014
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0487377643585205
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 10 cost time: 2.0878827571868896
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.957519 --> -0.963091).  Saving model ...
Epoch: 11 cost time: 2.0549509525299072
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0142948627471924
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2304553985595703
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1850810050964355
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0806047916412354
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.016047716140747
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 17 cost time: 2.174586772918701
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.070293664932251
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0464038848876953
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5489885807037354
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.279240131378174
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.374990224838257
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4995460510253906
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 24 cost time: 2.378911256790161
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4299240112304688
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4923083782196045
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 27 cost time: 2.437309503555298
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.163421869277954
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.027773380279541
Epoch: 29, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9560952186584473
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.027299404144287
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.992182970046997
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9854176044464111
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.220653533935547
Epoch: 34, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1094696521759033
Epoch: 35, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0704593658447266
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 105530
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.817061424255371
Epoch: 1, Steps: 89 | Train Loss: 2.593 Vali Loss: 1.965 Vali Acc: 0.678 Test Loss: 1.965 Test Acc: 0.678
Validation loss decreased (inf --> -0.677557).  Saving model ...
Epoch: 2 cost time: 1.8384473323822021
Epoch: 2, Steps: 89 | Train Loss: 1.406 Vali Loss: 0.961 Vali Acc: 0.846 Test Loss: 0.961 Test Acc: 0.846
Validation loss decreased (-0.677557 --> -0.846091).  Saving model ...
Epoch: 3 cost time: 1.5477988719940186
Epoch: 3, Steps: 89 | Train Loss: 0.663 Vali Loss: 0.524 Vali Acc: 0.893 Test Loss: 0.524 Test Acc: 0.893
Validation loss decreased (-0.846091 --> -0.892752).  Saving model ...
Epoch: 4 cost time: 1.6318111419677734
Epoch: 4, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
Validation loss decreased (-0.892752 --> -0.927573).  Saving model ...
Epoch: 5 cost time: 1.619889736175537
Epoch: 5, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.927573 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 1.5413901805877686
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.214 Vali Acc: 0.945 Test Loss: 0.214 Test Acc: 0.945
Validation loss decreased (-0.944287 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 1.6546099185943604
Epoch: 7, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 1.6849932670593262
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 1.6993708610534668
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.953341 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 1.509411096572876
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5261518955230713
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.514916181564331
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4314403533935547
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 14 cost time: 1.6005704402923584
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5988566875457764
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6289410591125488
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5190153121948242
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.57773756980896
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8231027126312256
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9106204509735107
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.746241807937622
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8629448413848877
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.827840805053711
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 105018
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.5758275985717773
Epoch: 1, Steps: 89 | Train Loss: 2.540 Vali Loss: 1.916 Vali Acc: 0.692 Test Loss: 1.916 Test Acc: 0.692
Validation loss decreased (inf --> -0.692181).  Saving model ...
Epoch: 2 cost time: 1.5163459777832031
Epoch: 2, Steps: 89 | Train Loss: 1.339 Vali Loss: 0.901 Vali Acc: 0.846 Test Loss: 0.901 Test Acc: 0.846
Validation loss decreased (-0.692181 --> -0.846091).  Saving model ...
Epoch: 3 cost time: 1.316610336303711
Epoch: 3, Steps: 89 | Train Loss: 0.616 Vali Loss: 0.503 Vali Acc: 0.894 Test Loss: 0.503 Test Acc: 0.894
Validation loss decreased (-0.846091 --> -0.894145).  Saving model ...
Epoch: 4 cost time: 1.2145941257476807
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
Validation loss decreased (-0.894145 --> -0.912949).  Saving model ...
Epoch: 5 cost time: 1.216726303100586
Epoch: 5, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.242 Vali Acc: 0.939 Test Loss: 0.242 Test Acc: 0.939
Validation loss decreased (-0.912949 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 1.1482133865356445
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.938716 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 1.1500952243804932
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.942198 --> -0.952645).  Saving model ...
Epoch: 8 cost time: 1.3492600917816162
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2198331356048584
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.952645 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 1.3352344036102295
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.955 Test Loss: 0.134 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1498122215270996
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3254876136779785
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0806012153625488
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2940640449523926
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5129046440124512
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2186908721923828
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3721213340759277
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3644204139709473
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4300727844238281
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_MTSMixer_UEA_ftM_sl182_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 104762
model size : 0.41MB
