Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.024195909500122
Epoch: 1, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.753 Vali Acc: 0.278 Test Loss: 1.753 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.2212579250335693
Epoch: 2, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.530 Vali Acc: 0.433 Test Loss: 1.530 Test Acc: 0.433
Validation loss decreased (-0.277760 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 1.1586635112762451
Epoch: 3, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.288 Vali Acc: 0.611 Test Loss: 1.288 Test Acc: 0.611
Validation loss decreased (-0.433318 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.2169125080108643
Epoch: 4, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.064 Vali Acc: 0.683 Test Loss: 1.064 Test Acc: 0.683
Validation loss decreased (-0.611098 --> -0.683323).  Saving model ...
Epoch: 5 cost time: 1.0746819972991943
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.868 Vali Acc: 0.722 Test Loss: 0.868 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722214).  Saving model ...
Epoch: 6 cost time: 1.0505707263946533
Epoch: 6, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.716 Vali Acc: 0.756 Test Loss: 0.716 Test Acc: 0.756
Validation loss decreased (-0.722214 --> -0.755548).  Saving model ...
Epoch: 7 cost time: 1.026519775390625
Epoch: 7, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 1.2049646377563477
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827773).  Saving model ...
Epoch: 9 cost time: 1.3664140701293945
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.176551103591919
Epoch: 10, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.402 Vali Acc: 0.878 Test Loss: 0.402 Test Acc: 0.878
Validation loss decreased (-0.833329 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.1134982109069824
Epoch: 11, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1462998390197754
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
Validation loss decreased (-0.877774 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 1.1661045551300049
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2035984992980957
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0598697662353516
Epoch: 15, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0787036418914795
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 1.0248758792877197
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0476689338684082
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1171987056732178
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 1.1069483757019043
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1624939441680908
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 22 cost time: 1.109229564666748
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1168646812438965
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9860634803771973
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0898916721343994
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 1.0270683765411377
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0794246196746826
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0711092948913574
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9896447658538818
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2877686023712158
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0924317836761475
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2230863571166992
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1247437000274658
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1369099617004395
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0903491973876953
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 232444
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.741839647293091
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.760 Vali Acc: 0.244 Test Loss: 1.760 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.0515058040618896
Epoch: 2, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.534 Vali Acc: 0.417 Test Loss: 1.534 Test Acc: 0.417
Validation loss decreased (-0.244427 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.1283893585205078
Epoch: 3, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.281 Vali Acc: 0.622 Test Loss: 1.281 Test Acc: 0.622
Validation loss decreased (-0.416651 --> -0.622209).  Saving model ...
Epoch: 4 cost time: 1.1208641529083252
Epoch: 4, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.622209 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 1.1359233856201172
Epoch: 5, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.843 Vali Acc: 0.744 Test Loss: 0.843 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 1.1078784465789795
Epoch: 6, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.691 Vali Acc: 0.806 Test Loss: 0.691 Test Acc: 0.806
Validation loss decreased (-0.744436 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.058955192565918
Epoch: 7, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.578 Vali Acc: 0.794 Test Loss: 0.578 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.12015700340271
Epoch: 8, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 1.216965913772583
Epoch: 9, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 0.9120228290557861
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.844440 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.0818870067596436
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 1.1570582389831543
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 1.1866376399993896
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5190527439117432
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0297353267669678
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0527331829071045
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9229660034179688
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0227491855621338
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9130244255065918
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9602570533752441
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.905552 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 1.0827522277832031
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9965476989746094
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1146807670593262
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.966282844543457
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1740953922271729
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0088202953338623
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.091125726699829
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9948596954345703
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9631545543670654
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9694690704345703
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 230396
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3018746376037598
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.619 Vali Acc: 0.400 Test Loss: 1.619 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.2060201168060303
Epoch: 2, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.416 Vali Acc: 0.567 Test Loss: 1.416 Test Acc: 0.567
Validation loss decreased (-0.399984 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 1.025970458984375
Epoch: 3, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.194 Vali Acc: 0.661 Test Loss: 1.194 Test Acc: 0.661
Validation loss decreased (-0.566653 --> -0.661099).  Saving model ...
Epoch: 4 cost time: 0.9868283271789551
Epoch: 4, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
Validation loss decreased (-0.661099 --> -0.727768).  Saving model ...
Epoch: 5 cost time: 1.0628077983856201
Epoch: 5, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 0.8242688179016113
Epoch: 6, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 1.16331148147583
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.591 Vali Acc: 0.811 Test Loss: 0.591 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 0.9771451950073242
Epoch: 8, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 1.0638585090637207
Epoch: 9, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.8948788642883301
Epoch: 10, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.1576004028320312
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.1238279342651367
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 1.1339037418365479
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.155219554901123
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0832924842834473
Epoch: 15, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.1974623203277588
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 0.9139008522033691
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1828994750976562
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9880282878875732
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9708552360534668
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 0.9376916885375977
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.1414105892181396
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.0735187530517578
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0889594554901123
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0259411334991455
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.252546787261963
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0888252258300781
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3075709342956543
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2014930248260498
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0144309997558594
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.218458652496338
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.336364984512329
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 226300
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.437413454055786
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.695 Vali Acc: 0.211 Test Loss: 1.695 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.209277629852295
Epoch: 2, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.457 Vali Acc: 0.483 Test Loss: 1.457 Test Acc: 0.483
Validation loss decreased (-0.211094 --> -0.483319).  Saving model ...
Epoch: 3 cost time: 0.8578379154205322
Epoch: 3, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.212 Vali Acc: 0.617 Test Loss: 1.212 Test Acc: 0.617
Validation loss decreased (-0.483319 --> -0.616655).  Saving model ...
Epoch: 4 cost time: 0.9522995948791504
Epoch: 4, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.002 Vali Acc: 0.678 Test Loss: 1.002 Test Acc: 0.678
Validation loss decreased (-0.616655 --> -0.677768).  Saving model ...
Epoch: 5 cost time: 0.8088641166687012
Epoch: 5, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
Validation loss decreased (-0.677768 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 0.8517482280731201
Epoch: 6, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 0.9733231067657471
Epoch: 7, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.589 Vali Acc: 0.794 Test Loss: 0.589 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 1.1057393550872803
Epoch: 8, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 1.0424408912658691
Epoch: 9, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 0.9083049297332764
Epoch: 10, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.402 Vali Acc: 0.872 Test Loss: 0.402 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 11 cost time: 1.1133880615234375
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 1.1137330532073975
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 1.040503978729248
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8989870548248291
Epoch: 14, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.7536804676055908
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.9501676559448242
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1009368896484375
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9091377258300781
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0095326900482178
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.0639772415161133
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8159596920013428
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0326263904571533
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0831539630889893
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.8874228000640869
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 0.8671772480010986
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9383323192596436
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.105290174484253
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0259804725646973
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 0.897711992263794
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 30 cost time: 0.9754745960235596
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 31 cost time: 0.934746503829956
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8926613330841064
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9534633159637451
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 34 cost time: 1.2313745021820068
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 35 cost time: 1.041524887084961
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8104715347290039
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.928 Test Loss: 0.174 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.047091007232666
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8282415866851807
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7493748664855957
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.112189531326294
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.922 Test Loss: 0.168 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8236067295074463
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1953988075256348
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9120402336120605
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.922 Test Loss: 0.165 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1760492324829102
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.928 Test Loss: 0.163 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 224252
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9320929050445557
Epoch: 1, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.629 Vali Acc: 0.261 Test Loss: 1.629 Test Acc: 0.261
Validation loss decreased (inf --> -0.261095).  Saving model ...
Epoch: 2 cost time: 0.8459146022796631
Epoch: 2, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.421 Vali Acc: 0.517 Test Loss: 1.421 Test Acc: 0.517
Validation loss decreased (-0.261095 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 0.9180643558502197
Epoch: 3, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.184 Vali Acc: 0.644 Test Loss: 1.184 Test Acc: 0.644
Validation loss decreased (-0.516652 --> -0.644433).  Saving model ...
Epoch: 4 cost time: 0.8133213520050049
Epoch: 4, Steps: 12 | Train Loss: 1.005 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.644433 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.0429694652557373
Epoch: 5, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 0.8894782066345215
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 0.9871542453765869
Epoch: 7, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822217).  Saving model ...
Epoch: 8 cost time: 1.0572173595428467
Epoch: 8, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855551).  Saving model ...
Epoch: 9 cost time: 0.900230884552002
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.435 Vali Acc: 0.883 Test Loss: 0.435 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 1.097442388534546
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0256423950195312
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
Validation loss decreased (-0.883329 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.9505007266998291
Epoch: 12, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0631721019744873
Epoch: 13, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9963905811309814
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0715432167053223
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 16 cost time: 1.0185692310333252
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1328394412994385
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.012657642364502
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9528257846832275
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.237 Vali Acc: 0.939 Test Loss: 0.237 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 0.9770231246948242
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1018540859222412
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3538193702697754
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1992146968841553
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0848979949951172
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.02386474609375
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0244393348693848
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1251423358917236
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1854534149169922
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.234968900680542
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 222204
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.993530035018921
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.9207680225372314
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.482 Vali Acc: 0.444 Test Loss: 1.482 Test Acc: 0.444
Validation loss decreased (-0.277761 --> -0.444430).  Saving model ...
Epoch: 3 cost time: 1.0593271255493164
Epoch: 3, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.232 Vali Acc: 0.622 Test Loss: 1.232 Test Acc: 0.622
Validation loss decreased (-0.444430 --> -0.622210).  Saving model ...
Epoch: 4 cost time: 1.0082554817199707
Epoch: 4, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.024 Vali Acc: 0.694 Test Loss: 1.024 Test Acc: 0.694
Validation loss decreased (-0.622210 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 0.9923985004425049
Epoch: 5, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.848 Vali Acc: 0.733 Test Loss: 0.848 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733325).  Saving model ...
Epoch: 6 cost time: 0.8970212936401367
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 0.8731808662414551
Epoch: 7, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.597 Vali Acc: 0.794 Test Loss: 0.597 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 0.8923952579498291
Epoch: 8, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 0.7914035320281982
Epoch: 9, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
Validation loss decreased (-0.822217 --> -0.877773).  Saving model ...
Epoch: 10 cost time: 0.7785487174987793
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 1.0851516723632812
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 12 cost time: 0.877692461013794
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 1.0329127311706543
Epoch: 13, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 1.0076279640197754
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.9053785800933838
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9632494449615479
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.8028366565704346
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9547531604766846
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7057855129241943
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8889079093933105
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8682410717010498
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1778714656829834
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9151618480682373
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1469876766204834
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9718017578125
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0340723991394043
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 220156
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0812668800354004
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.998375654220581
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.482 Vali Acc: 0.444 Test Loss: 1.482 Test Acc: 0.444
Validation loss decreased (-0.277761 --> -0.444430).  Saving model ...
Epoch: 3 cost time: 0.8174846172332764
Epoch: 3, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.232 Vali Acc: 0.622 Test Loss: 1.232 Test Acc: 0.622
Validation loss decreased (-0.444430 --> -0.622210).  Saving model ...
Epoch: 4 cost time: 1.0894746780395508
Epoch: 4, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.024 Vali Acc: 0.694 Test Loss: 1.024 Test Acc: 0.694
Validation loss decreased (-0.622210 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 0.9059078693389893
Epoch: 5, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.848 Vali Acc: 0.733 Test Loss: 0.848 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733325).  Saving model ...
Epoch: 6 cost time: 0.927661657333374
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 1.0347177982330322
Epoch: 7, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.597 Vali Acc: 0.794 Test Loss: 0.597 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 0.9262001514434814
Epoch: 8, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 0.9841504096984863
Epoch: 9, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
Validation loss decreased (-0.822217 --> -0.877773).  Saving model ...
Epoch: 10 cost time: 0.95778489112854
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 1.1904947757720947
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 12 cost time: 1.0663387775421143
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 0.8298318386077881
Epoch: 13, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 0.8456156253814697
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 1.0260491371154785
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.876244068145752
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.9510126113891602
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0113530158996582
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9230327606201172
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.082465410232544
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9480147361755371
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0561561584472656
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.866441011428833
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9079287052154541
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8790595531463623
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8308558464050293
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 220156
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1450870037078857
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.703 Vali Acc: 0.328 Test Loss: 1.703 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.096818447113037
Epoch: 2, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.517 Vali Acc: 0.461 Test Loss: 1.517 Test Acc: 0.461
Validation loss decreased (-0.327761 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 1.0471320152282715
Epoch: 3, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.294 Vali Acc: 0.617 Test Loss: 1.294 Test Acc: 0.617
Validation loss decreased (-0.461096 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 1.1161954402923584
Epoch: 4, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.080 Vali Acc: 0.711 Test Loss: 1.080 Test Acc: 0.711
Validation loss decreased (-0.616654 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 1.1633210182189941
Epoch: 5, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.901 Vali Acc: 0.733 Test Loss: 0.901 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 1.2099106311798096
Epoch: 6, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
Validation loss decreased (-0.733324 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 1.0383830070495605
Epoch: 7, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 1.0211601257324219
Epoch: 8, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.552 Vali Acc: 0.817 Test Loss: 0.552 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.5310750007629395
Epoch: 9, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.816661 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.2474164962768555
Epoch: 10, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877773).  Saving model ...
Epoch: 11 cost time: 1.2394864559173584
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.356492042541504
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4448401927947998
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.3361091613769531
Epoch: 14, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 1.2196176052093506
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5470523834228516
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3931972980499268
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2807090282440186
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4365525245666504
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.4019436836242676
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.1008524894714355
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.1345727443695068
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 1.485875129699707
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3143248558044434
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.211388111114502
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.103255271911621
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2111213207244873
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.372006893157959
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1884067058563232
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.698030948638916
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2943379878997803
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.805860996246338
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.210120677947998
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.5690622329711914
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6236572265625
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1603543758392334
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2738006114959717
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 1.3955352306365967
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4816529750823975
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1774756908416748
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.259538173675537
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4205620288848877
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.632140874862671
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7504937648773193
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 45 cost time: 1.5670733451843262
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.713061809539795
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.249389886856079
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 48 cost time: 1.6230099201202393
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3279600143432617
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3843660354614258
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4804105758666992
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.5050601959228516
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.4113714694976807
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.4873793125152588
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.3516592979431152
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 56 cost time: 1.451275110244751
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3595423698425293
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.3596839904785156
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.12967848777771
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.5410983562469482
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2846004962921143
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.342897891998291
Epoch: 62, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.124783992767334
Epoch: 63, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.3080143928527832
Epoch: 64, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.2219409942626953
Epoch: 65, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 231660
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.009117841720581
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.729 Vali Acc: 0.261 Test Loss: 1.729 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.2856364250183105
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.529 Vali Acc: 0.417 Test Loss: 1.529 Test Acc: 0.417
Validation loss decreased (-0.261094 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.4227938652038574
Epoch: 3, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.300 Vali Acc: 0.661 Test Loss: 1.300 Test Acc: 0.661
Validation loss decreased (-0.416651 --> -0.661098).  Saving model ...
Epoch: 4 cost time: 1.0685715675354004
Epoch: 4, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.083 Vali Acc: 0.722 Test Loss: 1.083 Test Acc: 0.722
Validation loss decreased (-0.661098 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 1.4252278804779053
Epoch: 5, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.875 Vali Acc: 0.761 Test Loss: 0.875 Test Acc: 0.761
Validation loss decreased (-0.722211 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 1.3129751682281494
Epoch: 6, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.761102 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.195868968963623
Epoch: 7, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816661).  Saving model ...
Epoch: 8 cost time: 1.349863052368164
Epoch: 8, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.816661 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.1973803043365479
Epoch: 9, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
Validation loss decreased (-0.849995 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 1.2485387325286865
Epoch: 10, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.398 Vali Acc: 0.894 Test Loss: 0.398 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 11 cost time: 1.3093979358673096
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905552).  Saving model ...
Epoch: 12 cost time: 1.6335337162017822
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 1.154865026473999
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.260443925857544
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1541688442230225
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.3657667636871338
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 1.0634243488311768
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3701255321502686
Epoch: 18, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3458101749420166
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4939696788787842
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3080785274505615
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5275664329528809
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.422722339630127
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5786948204040527
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3634450435638428
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3855020999908447
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 229612
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.32173752784729
Epoch: 1, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.727 Vali Acc: 0.311 Test Loss: 1.727 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.017179250717163
Epoch: 2, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.514 Vali Acc: 0.461 Test Loss: 1.514 Test Acc: 0.461
Validation loss decreased (-0.311094 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.8288669586181641
Epoch: 3, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.298 Vali Acc: 0.611 Test Loss: 1.298 Test Acc: 0.611
Validation loss decreased (-0.461096 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 0.9527254104614258
Epoch: 4, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
Validation loss decreased (-0.611098 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.9804613590240479
Epoch: 5, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
Validation loss decreased (-0.749989 --> -0.788880).  Saving model ...
Epoch: 6 cost time: 1.2064967155456543
Epoch: 6, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.020582675933838
Epoch: 7, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 8 cost time: 1.094245195388794
Epoch: 8, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 9 cost time: 1.0576345920562744
Epoch: 9, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.446 Vali Acc: 0.867 Test Loss: 0.446 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 10 cost time: 1.0727200508117676
Epoch: 10, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.396 Vali Acc: 0.872 Test Loss: 0.396 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 11 cost time: 1.125058889389038
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.2423863410949707
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 1.092916488647461
Epoch: 13, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 1.0013089179992676
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9806220531463623
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 0.9280457496643066
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8577702045440674
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 0.87701416015625
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.8319582939147949
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.080902099609375
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0234549045562744
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0135667324066162
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.948829174041748
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0860772132873535
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.1582555770874023
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 0.9796595573425293
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9774672985076904
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.845496654510498
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2360584735870361
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.184288740158081
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2366609573364258
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.177288293838501
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0393321514129639
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9528586864471436
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.241901159286499
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 225516
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1684787273406982
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.786 Vali Acc: 0.183 Test Loss: 1.786 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.246190071105957
Epoch: 2, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.555 Vali Acc: 0.439 Test Loss: 1.555 Test Acc: 0.439
Validation loss decreased (-0.183315 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 1.150604486465454
Epoch: 3, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.301 Vali Acc: 0.639 Test Loss: 1.301 Test Acc: 0.639
Validation loss decreased (-0.438873 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 1.0405807495117188
Epoch: 4, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.072 Vali Acc: 0.678 Test Loss: 1.072 Test Acc: 0.678
Validation loss decreased (-0.638876 --> -0.677767).  Saving model ...
Epoch: 5 cost time: 0.9959497451782227
Epoch: 5, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.875 Vali Acc: 0.722 Test Loss: 0.875 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 0.9824588298797607
Epoch: 6, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.9640593528747559
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788883).  Saving model ...
Epoch: 8 cost time: 1.202416181564331
Epoch: 8, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.526 Vali Acc: 0.806 Test Loss: 0.526 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 1.1637248992919922
Epoch: 9, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.477 Vali Acc: 0.817 Test Loss: 0.477 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 1.439481496810913
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.45670485496521
Epoch: 11, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.400 Vali Acc: 0.872 Test Loss: 0.400 Test Acc: 0.872
Validation loss decreased (-0.827773 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.3499367237091064
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.221564769744873
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2800977230072021
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.633983850479126
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.4245882034301758
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.021937608718872
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.0970656871795654
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7997972965240479
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9552667140960693
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.0250322818756104
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.1507666110992432
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1098923683166504
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2561910152435303
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1173312664031982
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.158233880996704
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0066123008728027
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0944390296936035
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1514003276824951
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5397045612335205
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.146425485610962
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2862370014190674
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.167233943939209
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9854705333709717
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3782989978790283
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 223468
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4852850437164307
Epoch: 1, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.773 Vali Acc: 0.233 Test Loss: 1.773 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.0452234745025635
Epoch: 2, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.543 Vali Acc: 0.367 Test Loss: 1.543 Test Acc: 0.367
Validation loss decreased (-0.233316 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 1.0962836742401123
Epoch: 3, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.304 Vali Acc: 0.617 Test Loss: 1.304 Test Acc: 0.617
Validation loss decreased (-0.366651 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 0.9323868751525879
Epoch: 4, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.069 Vali Acc: 0.706 Test Loss: 1.069 Test Acc: 0.706
Validation loss decreased (-0.616654 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 1.1679480075836182
Epoch: 5, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.868 Vali Acc: 0.706 Test Loss: 0.868 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 1.2049508094787598
Epoch: 6, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
Validation loss decreased (-0.705547 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.317565679550171
Epoch: 7, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.755549 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 1.1390790939331055
Epoch: 8, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.499 Vali Acc: 0.839 Test Loss: 0.499 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838884).  Saving model ...
Epoch: 9 cost time: 1.158541202545166
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.445 Vali Acc: 0.839 Test Loss: 0.445 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 1.2381019592285156
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.1705565452575684
Epoch: 11, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.1236400604248047
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.1689400672912598
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.221909523010254
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 0.877302885055542
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3303382396697998
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2026212215423584
Epoch: 17, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2558388710021973
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9274611473083496
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2270355224609375
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0839059352874756
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.1032435894012451
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.232 Vali Acc: 0.878 Test Loss: 0.232 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0488367080688477
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1932809352874756
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.241389513015747
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.228863000869751
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.878 Test Loss: 0.235 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1969618797302246
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3265101909637451
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1010961532592773
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3032972812652588
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.883 Test Loss: 0.227 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3683803081512451
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 221420
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.552600860595703
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.737 Vali Acc: 0.128 Test Loss: 1.737 Test Acc: 0.128
Validation loss decreased (inf --> -0.127760).  Saving model ...
Epoch: 2 cost time: 1.1418046951293945
Epoch: 2, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.512 Vali Acc: 0.511 Test Loss: 1.512 Test Acc: 0.511
Validation loss decreased (-0.127760 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 0.9799621105194092
Epoch: 3, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.261 Vali Acc: 0.700 Test Loss: 1.261 Test Acc: 0.700
Validation loss decreased (-0.511096 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 0.98309326171875
Epoch: 4, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.699987 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 1.031534194946289
Epoch: 5, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 6 cost time: 0.9353556632995605
Epoch: 6, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.738880 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 1.0442695617675781
Epoch: 7, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816661).  Saving model ...
Epoch: 8 cost time: 0.9349117279052734
Epoch: 8, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.816661 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.970221996307373
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 0.9779312610626221
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7885923385620117
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 0.9087555408477783
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 1.2337839603424072
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1389517784118652
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3667693138122559
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0122075080871582
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.1796414852142334
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1587183475494385
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.7941074371337891
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0887439250946045
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.069408893585205
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0915172100067139
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.910930871963501
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0923199653625488
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4744758605957031
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3909506797790527
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2120988368988037
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9187004566192627
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 219372
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4448606967926025
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.737 Vali Acc: 0.128 Test Loss: 1.737 Test Acc: 0.128
Validation loss decreased (inf --> -0.127760).  Saving model ...
Epoch: 2 cost time: 0.9655420780181885
Epoch: 2, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.512 Vali Acc: 0.511 Test Loss: 1.512 Test Acc: 0.511
Validation loss decreased (-0.127760 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 0.8006761074066162
Epoch: 3, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.261 Vali Acc: 0.700 Test Loss: 1.261 Test Acc: 0.700
Validation loss decreased (-0.511096 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 1.0493769645690918
Epoch: 4, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.699987 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 1.0979044437408447
Epoch: 5, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 6 cost time: 0.9964368343353271
Epoch: 6, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.738880 --> -0.788882).  Saving model ...
Epoch: 7 cost time: 0.6918139457702637
Epoch: 7, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816661).  Saving model ...
Epoch: 8 cost time: 0.8596384525299072
Epoch: 8, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.816661 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.9821581840515137
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 0.8795371055603027
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.963616132736206
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 0.9573683738708496
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 0.8606514930725098
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.038811445236206
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0578932762145996
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9009079933166504
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.0782597064971924
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.031794548034668
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.1997861862182617
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8626899719238281
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3334476947784424
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1858770847320557
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.008596658706665
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0787851810455322
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9433624744415283
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2716333866119385
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2870044708251953
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2251853942871094
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 219372
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2183480262756348
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.745 Vali Acc: 0.200 Test Loss: 1.745 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3967835903167725
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.529 Vali Acc: 0.478 Test Loss: 1.529 Test Acc: 0.478
Validation loss decreased (-0.199983 --> -0.477762).  Saving model ...
Epoch: 3 cost time: 1.6121094226837158
Epoch: 3, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.297 Vali Acc: 0.744 Test Loss: 1.297 Test Acc: 0.744
Validation loss decreased (-0.477762 --> -0.744431).  Saving model ...
Epoch: 4 cost time: 1.207472324371338
Epoch: 4, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.065 Vali Acc: 0.739 Test Loss: 1.065 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4092307090759277
Epoch: 5, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
Validation loss decreased (-0.744431 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.550832986831665
Epoch: 6, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.3927366733551025
Epoch: 7, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 1.1894738674163818
Epoch: 8, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.525 Vali Acc: 0.811 Test Loss: 0.525 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5848524570465088
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 1.1537361145019531
Epoch: 10, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.411372184753418
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 1.338864803314209
Epoch: 12, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.4538345336914062
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.093414068222046
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.323 Vali Acc: 0.867 Test Loss: 0.323 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.048588752746582
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.2381689548492432
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2454886436462402
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.211247444152832
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2192649841308594
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1409766674041748
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1738224029541016
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.883331 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 1.4285433292388916
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.252 Vali Acc: 0.844 Test Loss: 0.252 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.344877004623413
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.249 Vali Acc: 0.844 Test Loss: 0.249 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1794042587280273
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.872 Test Loss: 0.247 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2038788795471191
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1254520416259766
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.242 Vali Acc: 0.872 Test Loss: 0.242 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3647668361663818
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.861 Test Loss: 0.244 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2134473323822021
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3678197860717773
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.872 Test Loss: 0.241 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5197010040283203
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.231701374053955
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 231268
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5951614379882812
Epoch: 1, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.683 Vali Acc: 0.272 Test Loss: 1.683 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.2463252544403076
Epoch: 2, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.492 Vali Acc: 0.428 Test Loss: 1.492 Test Acc: 0.428
Validation loss decreased (-0.272205 --> -0.427763).  Saving model ...
Epoch: 3 cost time: 1.3612358570098877
Epoch: 3, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.262 Vali Acc: 0.644 Test Loss: 1.262 Test Acc: 0.644
Validation loss decreased (-0.427763 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 1.4605298042297363
Epoch: 4, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.031 Vali Acc: 0.744 Test Loss: 1.031 Test Acc: 0.744
Validation loss decreased (-0.644432 --> -0.744434).  Saving model ...
Epoch: 5 cost time: 1.4052560329437256
Epoch: 5, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.836 Vali Acc: 0.806 Test Loss: 0.836 Test Acc: 0.806
Validation loss decreased (-0.744434 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 1.3403208255767822
Epoch: 6, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6541013717651367
Epoch: 7, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.581 Vali Acc: 0.817 Test Loss: 0.581 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816661).  Saving model ...
Epoch: 8 cost time: 1.753551721572876
Epoch: 8, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 1.5207862854003906
Epoch: 9, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.530479907989502
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.6407854557037354
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5607264041900635
Epoch: 12, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.314072847366333
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.5201892852783203
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.450334072113037
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4885139465332031
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3814351558685303
Epoch: 17, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2938249111175537
Epoch: 18, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4706456661224365
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3911027908325195
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.404766321182251
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.6378049850463867
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6882917881011963
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.346083164215088
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8223035335540771
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.5036768913269043
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3777010440826416
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.827038288116455
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.3768250942230225
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 1.5126636028289795
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1575360298156738
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2945549488067627
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.5806159973144531
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5634000301361084
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3403615951538086
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.380660057067871
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.526991844177246
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.578881025314331
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4207732677459717
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.484013557434082
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4462847709655762
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 42 cost time: 1.324836254119873
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.320932388305664
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0902676582336426
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6029777526855469
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.421231985092163
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4569802284240723
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.5156965255737305
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4950649738311768
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.589221715927124
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.439180612564087
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 229220
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8974788188934326
Epoch: 1, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.697 Vali Acc: 0.311 Test Loss: 1.697 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.1155309677124023
Epoch: 2, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.501 Vali Acc: 0.411 Test Loss: 1.501 Test Acc: 0.411
Validation loss decreased (-0.311094 --> -0.411096).  Saving model ...
Epoch: 3 cost time: 1.1356902122497559
Epoch: 3, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.290 Vali Acc: 0.578 Test Loss: 1.290 Test Acc: 0.578
Validation loss decreased (-0.411096 --> -0.577765).  Saving model ...
Epoch: 4 cost time: 0.9622406959533691
Epoch: 4, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.085 Vali Acc: 0.667 Test Loss: 1.085 Test Acc: 0.667
Validation loss decreased (-0.577765 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 1.0018284320831299
Epoch: 5, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.666656 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 0.9176695346832275
Epoch: 6, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
Validation loss decreased (-0.711102 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 0.8483326435089111
Epoch: 7, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 0.8413031101226807
Epoch: 8, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 9 cost time: 1.182729959487915
Epoch: 9, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.495 Vali Acc: 0.806 Test Loss: 0.495 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.458817481994629
Epoch: 10, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 1.1083900928497314
Epoch: 11, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.405 Vali Acc: 0.856 Test Loss: 0.405 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.1579170227050781
Epoch: 12, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.373 Vali Acc: 0.878 Test Loss: 0.373 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.1769030094146729
Epoch: 13, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 0.8105795383453369
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 0.8446664810180664
Epoch: 15, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.1652460098266602
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 1.0467910766601562
Epoch: 17, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8697640895843506
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9821712970733643
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.18198561668396
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0650334358215332
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0099008083343506
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9478964805603027
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.092315673828125
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1608457565307617
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.0532712936401367
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3198611736297607
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4668869972229004
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2226040363311768
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0240013599395752
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0630261898040771
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.894209623336792
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.883 Test Loss: 0.225 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0086824893951416
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.018237590789795
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.872 Test Loss: 0.233 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9941086769104004
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 225124
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3770806789398193
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.767 Vali Acc: 0.178 Test Loss: 1.767 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 1.141618251800537
Epoch: 2, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.552 Vali Acc: 0.350 Test Loss: 1.552 Test Acc: 0.350
Validation loss decreased (-0.177760 --> -0.349984).  Saving model ...
Epoch: 3 cost time: 1.4104888439178467
Epoch: 3, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.293 Vali Acc: 0.583 Test Loss: 1.293 Test Acc: 0.583
Validation loss decreased (-0.349984 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.9769878387451172
Epoch: 4, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.035 Vali Acc: 0.744 Test Loss: 1.035 Test Acc: 0.744
Validation loss decreased (-0.583320 --> -0.744434).  Saving model ...
Epoch: 5 cost time: 1.0389807224273682
Epoch: 5, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.826 Vali Acc: 0.772 Test Loss: 0.826 Test Acc: 0.772
Validation loss decreased (-0.744434 --> -0.772214).  Saving model ...
Epoch: 6 cost time: 0.9261922836303711
Epoch: 6, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.897510290145874
Epoch: 7, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8928613662719727
Epoch: 8, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 1.009031057357788
Epoch: 9, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.1228837966918945
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.9141395092010498
Epoch: 11, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.388 Vali Acc: 0.867 Test Loss: 0.388 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 0.8355019092559814
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 0.931462287902832
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 0.9576287269592285
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.0982143878936768
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1366195678710938
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.105982780456543
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.0111758708953857
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.8266868591308594
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.1107182502746582
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.8747649192810059
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9012811183929443
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9795143604278564
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.1655151844024658
Epoch: 24, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0621471405029297
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.120490312576294
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.0191497802734375
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0475594997406006
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1404023170471191
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.2605617046356201
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1294379234313965
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.297767162322998
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1323871612548828
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1818163394927979
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.102625846862793
Epoch: 35, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9153881072998047
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1157429218292236
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8828206062316895
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.991264820098877
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 223076
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.993248462677002
Epoch: 1, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.755 Vali Acc: 0.233 Test Loss: 1.755 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.1070756912231445
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.550 Vali Acc: 0.372 Test Loss: 1.550 Test Acc: 0.372
Validation loss decreased (-0.233316 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 1.0855836868286133
Epoch: 3, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.325 Vali Acc: 0.561 Test Loss: 1.325 Test Acc: 0.561
Validation loss decreased (-0.372207 --> -0.561098).  Saving model ...
Epoch: 4 cost time: 1.0053737163543701
Epoch: 4, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.108 Vali Acc: 0.683 Test Loss: 1.108 Test Acc: 0.683
Validation loss decreased (-0.561098 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 0.9743540287017822
Epoch: 5, Steps: 12 | Train Loss: 0.925 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.683322 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.9150938987731934
Epoch: 6, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 1.0431716442108154
Epoch: 7, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 0.7992267608642578
Epoch: 8, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.563 Vali Acc: 0.817 Test Loss: 0.563 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.0782475471496582
Epoch: 9, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.8645248413085938
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.451 Vali Acc: 0.839 Test Loss: 0.451 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 0.7956202030181885
Epoch: 11, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 0.8523643016815186
Epoch: 12, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7805361747741699
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.363 Vali Acc: 0.878 Test Loss: 0.363 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 0.9419221878051758
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8849072456359863
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9384732246398926
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9550282955169678
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9043898582458496
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 0.8267266750335693
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.0209698677062988
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.9525935649871826
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9412987232208252
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0501701831817627
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 0.9919235706329346
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 0.8806791305541992
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.916510820388794
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.001643419265747
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0466389656066895
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.990577220916748
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.9816229343414307
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0314784049987793
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1971406936645508
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1099777221679688
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.883 Test Loss: 0.228 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3327922821044922
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1632275581359863
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3534505367279053
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3254644870758057
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6177279949188232
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3516676425933838
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 221028
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.130324363708496
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.729 Vali Acc: 0.233 Test Loss: 1.729 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.2561147212982178
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.494 Vali Acc: 0.517 Test Loss: 1.494 Test Acc: 0.517
Validation loss decreased (-0.233316 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 1.241363525390625
Epoch: 3, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.259 Vali Acc: 0.678 Test Loss: 1.259 Test Acc: 0.678
Validation loss decreased (-0.516652 --> -0.677765).  Saving model ...
Epoch: 4 cost time: 1.1346406936645508
Epoch: 4, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
Validation loss decreased (-0.677765 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 1.0530188083648682
Epoch: 5, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.863 Vali Acc: 0.761 Test Loss: 0.863 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 1.1406633853912354
Epoch: 6, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 1.0715463161468506
Epoch: 7, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
Validation loss decreased (-0.766660 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 1.1904006004333496
Epoch: 8, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.544 Vali Acc: 0.817 Test Loss: 0.544 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.1823220252990723
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.022742509841919
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.5271806716918945
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.8427672386169434
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.8858981132507324
Epoch: 13, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 0.9570598602294922
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 0.8762328624725342
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1615900993347168
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9936494827270508
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1526014804840088
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9058310985565186
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9557416439056396
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9626014232635498
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.8066344261169434
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8667635917663574
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8533420562744141
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3292598724365234
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.071509599685669
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2680151462554932
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.919776201248169
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7916762828826904
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1622719764709473
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9124341011047363
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.8124101161956787
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9921579360961914
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.127021312713623
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1386175155639648
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0365571975708008
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.211846113204956
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.059401273727417
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9946727752685547
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.167233943939209
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1300721168518066
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0683200359344482
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4930269718170166
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 218980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3743884563446045
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.729 Vali Acc: 0.233 Test Loss: 1.729 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.8021643161773682
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.494 Vali Acc: 0.517 Test Loss: 1.494 Test Acc: 0.517
Validation loss decreased (-0.233316 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 1.0455834865570068
Epoch: 3, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.259 Vali Acc: 0.678 Test Loss: 1.259 Test Acc: 0.678
Validation loss decreased (-0.516652 --> -0.677765).  Saving model ...
Epoch: 4 cost time: 1.110060453414917
Epoch: 4, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
Validation loss decreased (-0.677765 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.917792797088623
Epoch: 5, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.863 Vali Acc: 0.761 Test Loss: 0.863 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 0.9598357677459717
Epoch: 6, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 0.9075775146484375
Epoch: 7, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
Validation loss decreased (-0.766660 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 0.9599435329437256
Epoch: 8, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.544 Vali Acc: 0.817 Test Loss: 0.544 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.0147123336791992
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.0360734462738037
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.1497774124145508
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.9545261859893799
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.0121409893035889
Epoch: 13, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 0.7947070598602295
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 0.955115556716919
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7954075336456299
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8112804889678955
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7687616348266602
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8336014747619629
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8266654014587402
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9380402565002441
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.7759323120117188
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.024082899093628
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9359776973724365
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1622443199157715
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8138279914855957
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1085517406463623
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.0358872413635254
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9616641998291016
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9620578289031982
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.994077205657959
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 1.0004637241363525
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1923625469207764
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.8735795021057129
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1266028881072998
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8742132186889648
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.093425989151001
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2816433906555176
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9951281547546387
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9678506851196289
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1674320697784424
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.057990312576294
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3007688522338867
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 218980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4556519985198975
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.789 Vali Acc: 0.233 Test Loss: 1.789 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 1.2775018215179443
Epoch: 2, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.572 Vali Acc: 0.417 Test Loss: 1.572 Test Acc: 0.417
Validation loss decreased (-0.233315 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.5297765731811523
Epoch: 3, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.340 Vali Acc: 0.567 Test Loss: 1.340 Test Acc: 0.567
Validation loss decreased (-0.416651 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 1.1509926319122314
Epoch: 4, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.131 Vali Acc: 0.644 Test Loss: 1.131 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.250305414199829
Epoch: 5, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.937 Vali Acc: 0.661 Test Loss: 0.937 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661102).  Saving model ...
Epoch: 6 cost time: 1.7079806327819824
Epoch: 6, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
Validation loss decreased (-0.661102 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 1.4499335289001465
Epoch: 7, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.5672760009765625
Epoch: 8, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.761104 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.3308167457580566
Epoch: 9, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.514 Vali Acc: 0.839 Test Loss: 0.514 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 1.2541847229003906
Epoch: 10, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.461 Vali Acc: 0.817 Test Loss: 0.461 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.467050552368164
Epoch: 11, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.4385695457458496
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.453118085861206
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2862765789031982
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.344 Vali Acc: 0.867 Test Loss: 0.344 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.2712812423706055
Epoch: 15, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 1.3397910594940186
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.1227161884307861
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.39747953414917
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4310669898986816
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 1.0938854217529297
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 1.737515926361084
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.4639906883239746
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.4301230907440186
Epoch: 23, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4796454906463623
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.2623848915100098
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6856606006622314
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5466647148132324
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1190259456634521
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2902514934539795
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1282641887664795
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5701956748962402
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.2170202732086182
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.4596662521362305
Epoch: 33, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5200612545013428
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3200674057006836
Epoch: 35, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.792478322982788
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9110898971557617
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5358517169952393
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4370160102844238
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4226820468902588
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5789618492126465
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6007084846496582
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 231072
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.428222179412842
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.773 Vali Acc: 0.278 Test Loss: 1.773 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.5679588317871094
Epoch: 2, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.580 Vali Acc: 0.389 Test Loss: 1.580 Test Acc: 0.389
Validation loss decreased (-0.277760 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 1.2581932544708252
Epoch: 3, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.366 Vali Acc: 0.544 Test Loss: 1.366 Test Acc: 0.544
Validation loss decreased (-0.388873 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 1.1800487041473389
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.149 Vali Acc: 0.672 Test Loss: 1.149 Test Acc: 0.672
Validation loss decreased (-0.544431 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 1.1877713203430176
Epoch: 5, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.3027520179748535
Epoch: 6, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
Validation loss decreased (-0.699990 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 1.3682613372802734
Epoch: 7, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 1.1013453006744385
Epoch: 8, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 1.2838938236236572
Epoch: 9, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.495 Vali Acc: 0.817 Test Loss: 0.495 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0037147998809814
Epoch: 10, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 1.1501421928405762
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 1.3271875381469727
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 1.469386100769043
Epoch: 13, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.861107 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.0574204921722412
Epoch: 14, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3129193782806396
Epoch: 15, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.68918776512146
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2702562808990479
Epoch: 17, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3156793117523193
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.176720142364502
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1138358116149902
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1640450954437256
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 1.243955373764038
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0030174255371094
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1420764923095703
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.2578866481781006
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1415948867797852
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.231 Vali Acc: 0.878 Test Loss: 0.231 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3614964485168457
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.878 Test Loss: 0.225 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2281811237335205
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.583665132522583
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.224 Vali Acc: 0.872 Test Loss: 0.224 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4303956031799316
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.872 Test Loss: 0.224 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.276505947113037
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.883 Test Loss: 0.219 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1998891830444336
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 33 cost time: 1.4555537700653076
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 1.4134528636932373
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.633826494216919
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.878 Test Loss: 0.214 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3595104217529297
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.878 Test Loss: 0.217 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3153080940246582
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.883 Test Loss: 0.214 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.254899501800537
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.325598955154419
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4591753482818604
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.894 Test Loss: 0.207 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3789072036743164
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.7210488319396973
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4056379795074463
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 229024
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.706472158432007
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.724 Vali Acc: 0.217 Test Loss: 1.724 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 1.1889770030975342
Epoch: 2, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.532 Vali Acc: 0.439 Test Loss: 1.532 Test Acc: 0.439
Validation loss decreased (-0.216649 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 1.034123420715332
Epoch: 3, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.320 Vali Acc: 0.594 Test Loss: 1.320 Test Acc: 0.594
Validation loss decreased (-0.438874 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 1.1637952327728271
Epoch: 4, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.125 Vali Acc: 0.689 Test Loss: 1.125 Test Acc: 0.689
Validation loss decreased (-0.594431 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 1.1280584335327148
Epoch: 5, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.0998647212982178
Epoch: 6, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.802 Vali Acc: 0.717 Test Loss: 0.802 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 0.9975900650024414
Epoch: 7, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.716659 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 0.8432245254516602
Epoch: 8, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.1551578044891357
Epoch: 9, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.521 Vali Acc: 0.811 Test Loss: 0.521 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 10 cost time: 1.1937384605407715
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
Validation loss decreased (-0.811106 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 1.1050286293029785
Epoch: 11, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 0.9529557228088379
Epoch: 12, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.381 Vali Acc: 0.883 Test Loss: 0.381 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.1116468906402588
Epoch: 13, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1759915351867676
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 1.0361146926879883
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.064497947692871
Epoch: 16, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.171543836593628
Epoch: 17, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 0.9677932262420654
Epoch: 18, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.437159776687622
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4281022548675537
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.3579132556915283
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.1077804565429688
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0637428760528564
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1157329082489014
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1997590065002441
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.2356979846954346
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1669766902923584
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6106009483337402
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1299302577972412
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3187901973724365
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2185282707214355
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1797597408294678
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2749249935150146
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.468013048171997
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3529043197631836
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 224928
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.955007553100586
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.760 Vali Acc: 0.250 Test Loss: 1.760 Test Acc: 0.250
Validation loss decreased (inf --> -0.249982).  Saving model ...
Epoch: 2 cost time: 1.0254886150360107
Epoch: 2, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.561 Vali Acc: 0.483 Test Loss: 1.561 Test Acc: 0.483
Validation loss decreased (-0.249982 --> -0.483318).  Saving model ...
Epoch: 3 cost time: 1.1550381183624268
Epoch: 3, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.342 Vali Acc: 0.650 Test Loss: 1.342 Test Acc: 0.650
Validation loss decreased (-0.483318 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 1.4052398204803467
Epoch: 4, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.127 Vali Acc: 0.700 Test Loss: 1.127 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.9327139854431152
Epoch: 5, Steps: 12 | Train Loss: 0.976 Vali Loss: 0.918 Vali Acc: 0.772 Test Loss: 0.918 Test Acc: 0.772
Validation loss decreased (-0.699989 --> -0.772213).  Saving model ...
Epoch: 6 cost time: 1.3747329711914062
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.0626344680786133
Epoch: 7, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.1631457805633545
Epoch: 8, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 9 cost time: 1.1673250198364258
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8991062641143799
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 11 cost time: 1.0609462261199951
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.15687894821167
Epoch: 12, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.372 Vali Acc: 0.894 Test Loss: 0.372 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 1.120269775390625
Epoch: 13, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 1.0363776683807373
Epoch: 14, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 1.1943528652191162
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.052720546722412
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9188885688781738
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.070366382598877
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.10422945022583
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.967665433883667
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9299936294555664
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0810983180999756
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0434746742248535
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0577483177185059
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 222880
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1070058345794678
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.761 Vali Acc: 0.211 Test Loss: 1.761 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.029733657836914
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.552 Vali Acc: 0.511 Test Loss: 1.552 Test Acc: 0.511
Validation loss decreased (-0.211094 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 0.771080493927002
Epoch: 3, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.307 Vali Acc: 0.689 Test Loss: 1.307 Test Acc: 0.689
Validation loss decreased (-0.511096 --> -0.688876).  Saving model ...
Epoch: 4 cost time: 0.9128708839416504
Epoch: 4, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.078 Vali Acc: 0.744 Test Loss: 1.078 Test Acc: 0.744
Validation loss decreased (-0.688876 --> -0.744434).  Saving model ...
Epoch: 5 cost time: 1.1445343494415283
Epoch: 5, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.880 Vali Acc: 0.783 Test Loss: 0.880 Test Acc: 0.783
Validation loss decreased (-0.744434 --> -0.783325).  Saving model ...
Epoch: 6 cost time: 0.9180128574371338
Epoch: 6, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 0.9615862369537354
Epoch: 7, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 8 cost time: 0.9525177478790283
Epoch: 8, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855551).  Saving model ...
Epoch: 9 cost time: 1.1191554069519043
Epoch: 9, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 1.188042163848877
Epoch: 10, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3411836624145508
Epoch: 11, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.344 Vali Acc: 0.872 Test Loss: 0.344 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0543110370635986
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 1.2367639541625977
Epoch: 13, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 1.1414523124694824
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0869266986846924
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 1.1616723537445068
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1076076030731201
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8023808002471924
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.8874976634979248
Epoch: 19, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.8691442012786865
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8106157779693604
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2369263172149658
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0141544342041016
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.9782555103302002
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.008807897567749
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.194380283355713
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.106586217880249
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2594516277313232
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2840297222137451
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.215 Vali Acc: 0.894 Test Loss: 0.215 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3277487754821777
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0491628646850586
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0338013172149658
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8624792098999023
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.894 Test Loss: 0.210 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 220832
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.149939060211182
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.681 Vali Acc: 0.383 Test Loss: 1.681 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.096719741821289
Epoch: 2, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.499 Vali Acc: 0.533 Test Loss: 1.499 Test Acc: 0.533
Validation loss decreased (-0.383317 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 1.1955914497375488
Epoch: 3, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.290 Vali Acc: 0.667 Test Loss: 1.290 Test Acc: 0.667
Validation loss decreased (-0.533318 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 0.9141950607299805
Epoch: 4, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.069 Vali Acc: 0.733 Test Loss: 1.069 Test Acc: 0.733
Validation loss decreased (-0.666654 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 1.217780590057373
Epoch: 5, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766658).  Saving model ...
Epoch: 6 cost time: 1.479813814163208
Epoch: 6, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777771).  Saving model ...
Epoch: 7 cost time: 1.1875715255737305
Epoch: 7, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.777771 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 0.9916455745697021
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.520 Vali Acc: 0.817 Test Loss: 0.520 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0857250690460205
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.0480570793151855
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 1.384549856185913
Epoch: 11, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.3491852283477783
Epoch: 12, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2951247692108154
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0033607482910156
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.0135481357574463
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.1314606666564941
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.15201735496521
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.0663385391235352
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9053177833557129
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.153611660003662
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.800684928894043
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4773197174072266
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.1039164066314697
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2031652927398682
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.3438091278076172
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9639627933502197
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.024108648300171
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1539247035980225
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2210376262664795
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0293986797332764
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1212999820709229
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.002305030822754
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9858489036560059
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9798471927642822
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 218784
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.85117769241333
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.681 Vali Acc: 0.383 Test Loss: 1.681 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.131218671798706
Epoch: 2, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.499 Vali Acc: 0.533 Test Loss: 1.499 Test Acc: 0.533
Validation loss decreased (-0.383317 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 1.0957324504852295
Epoch: 3, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.290 Vali Acc: 0.667 Test Loss: 1.290 Test Acc: 0.667
Validation loss decreased (-0.533318 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 1.0498428344726562
Epoch: 4, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.069 Vali Acc: 0.733 Test Loss: 1.069 Test Acc: 0.733
Validation loss decreased (-0.666654 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.9533324241638184
Epoch: 5, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766658).  Saving model ...
Epoch: 6 cost time: 0.796135663986206
Epoch: 6, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777771).  Saving model ...
Epoch: 7 cost time: 0.840487003326416
Epoch: 7, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.777771 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 0.9092252254486084
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.520 Vali Acc: 0.817 Test Loss: 0.520 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9636354446411133
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.9872326850891113
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 0.9736006259918213
Epoch: 11, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 0.7642347812652588
Epoch: 12, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.289254903793335
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0077555179595947
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 0.9088361263275146
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.0447027683258057
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9645209312438965
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.9405264854431152
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.913811206817627
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8046314716339111
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0990378856658936
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0294599533081055
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.9848353862762451
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.136202335357666
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.1311264038085938
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8625202178955078
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.042520523071289
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9926886558532715
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.120185375213623
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1066067218780518
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9340419769287109
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2089869976043701
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0357553958892822
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2360191345214844
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 218784
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5709075927734375
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.635 Vali Acc: 0.278 Test Loss: 1.635 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.2490098476409912
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.302 Vali Acc: 0.606 Test Loss: 1.302 Test Acc: 0.606
Validation loss decreased (-0.277761 --> -0.605543).  Saving model ...
Epoch: 3 cost time: 1.8114266395568848
Epoch: 3, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.050 Vali Acc: 0.717 Test Loss: 1.050 Test Acc: 0.717
Validation loss decreased (-0.605543 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 1.4887974262237549
Epoch: 4, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.848 Vali Acc: 0.767 Test Loss: 0.848 Test Acc: 0.767
Validation loss decreased (-0.716656 --> -0.766658).  Saving model ...
Epoch: 5 cost time: 1.68739914894104
Epoch: 5, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.766658 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.1948363780975342
Epoch: 6, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.574 Vali Acc: 0.806 Test Loss: 0.574 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4353373050689697
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 1.3735053539276123
Epoch: 8, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.415 Vali Acc: 0.872 Test Loss: 0.415 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872218).  Saving model ...
Epoch: 9 cost time: 1.5672316551208496
Epoch: 9, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5946524143218994
Epoch: 10, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.363 Vali Acc: 0.878 Test Loss: 0.363 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.223435878753662
Epoch: 11, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3697609901428223
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 1.186002492904663
Epoch: 13, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4168381690979004
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2459969520568848
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2872278690338135
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0347650051116943
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4425852298736572
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4526259899139404
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.2428488731384277
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.169689655303955
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2507736682891846
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.245 Vali Acc: 0.883 Test Loss: 0.245 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2335681915283203
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.252094030380249
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5718193054199219
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2866244316101074
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4730331897735596
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2574892044067383
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4996764659881592
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4448063373565674
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 230828
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6585795879364014
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.640 Vali Acc: 0.267 Test Loss: 1.640 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 1.0992522239685059
Epoch: 2, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.258 Vali Acc: 0.572 Test Loss: 1.258 Test Acc: 0.572
Validation loss decreased (-0.266650 --> -0.572210).  Saving model ...
Epoch: 3 cost time: 1.3615851402282715
Epoch: 3, Steps: 12 | Train Loss: 1.029 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
Validation loss decreased (-0.572210 --> -0.705546).  Saving model ...
Epoch: 4 cost time: 1.6323633193969727
Epoch: 4, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
Validation loss decreased (-0.705546 --> -0.761103).  Saving model ...
Epoch: 5 cost time: 1.2877724170684814
Epoch: 5, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.761103 --> -0.822216).  Saving model ...
Epoch: 6 cost time: 1.4045448303222656
Epoch: 6, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.2352888584136963
Epoch: 7, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
Validation loss decreased (-0.833328 --> -0.866662).  Saving model ...
Epoch: 8 cost time: 1.200756311416626
Epoch: 8, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 9 cost time: 1.1399860382080078
Epoch: 9, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1557378768920898
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.372 Vali Acc: 0.878 Test Loss: 0.372 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.5605196952819824
Epoch: 11, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.472102403640747
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.075134038925171
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2519240379333496
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.2937276363372803
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.4501745700836182
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5296878814697266
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2958171367645264
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.238300085067749
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7260005474090576
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.4713101387023926
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9504425525665283
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2101292610168457
Epoch: 23, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1058075428009033
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.185943841934204
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.872 Test Loss: 0.251 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2614240646362305
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1498112678527832
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.0398445129394531
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4014899730682373
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1846768856048584
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0858476161956787
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.096045970916748
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5095081329345703
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.607536792755127
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5949089527130127
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9247872829437256
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1827857494354248
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 228780
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7746057510375977
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.630 Vali Acc: 0.339 Test Loss: 1.630 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 1.0391411781311035
Epoch: 2, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.251 Vali Acc: 0.644 Test Loss: 1.251 Test Acc: 0.644
Validation loss decreased (-0.338873 --> -0.644432).  Saving model ...
Epoch: 3 cost time: 1.0467665195465088
Epoch: 3, Steps: 12 | Train Loss: 1.024 Vali Loss: 0.994 Vali Acc: 0.706 Test Loss: 0.994 Test Acc: 0.706
Validation loss decreased (-0.644432 --> -0.705546).  Saving model ...
Epoch: 4 cost time: 1.1165857315063477
Epoch: 4, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
Validation loss decreased (-0.705546 --> -0.761103).  Saving model ...
Epoch: 5 cost time: 1.037489891052246
Epoch: 5, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.179271936416626
Epoch: 6, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827772).  Saving model ...
Epoch: 7 cost time: 0.9877207279205322
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0298984050750732
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 0.9989745616912842
Epoch: 9, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0538835525512695
Epoch: 10, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
Validation loss decreased (-0.833329 --> -0.872218).  Saving model ...
Epoch: 11 cost time: 0.9543464183807373
Epoch: 11, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0513532161712646
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1190130710601807
Epoch: 13, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2578802108764648
Epoch: 14, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.0022108554840088
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9030952453613281
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9512660503387451
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4167449474334717
Epoch: 18, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0113487243652344
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.148371934890747
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0826702117919922
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.03678297996521
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9462735652923584
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0348825454711914
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 224684
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5638632774353027
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.708 Vali Acc: 0.261 Test Loss: 1.708 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.1076629161834717
Epoch: 2, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.325 Vali Acc: 0.606 Test Loss: 1.325 Test Acc: 0.606
Validation loss decreased (-0.261094 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 0.9563517570495605
Epoch: 3, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.605542 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.1374881267547607
Epoch: 4, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
Validation loss decreased (-0.699990 --> -0.777770).  Saving model ...
Epoch: 5 cost time: 1.090740442276001
Epoch: 5, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.777770 --> -0.844438).  Saving model ...
Epoch: 6 cost time: 1.3189499378204346
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.034642219543457
Epoch: 7, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.0013079643249512
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 1.1344373226165771
Epoch: 9, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.376 Vali Acc: 0.872 Test Loss: 0.376 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 1.233466386795044
Epoch: 10, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.360 Vali Acc: 0.867 Test Loss: 0.360 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0347113609313965
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.0662806034088135
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0428602695465088
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 0.9295330047607422
Epoch: 14, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.099597692489624
Epoch: 15, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.130133867263794
Epoch: 16, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2077386379241943
Epoch: 17, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0407185554504395
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1667826175689697
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0764577388763428
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.8457400798797607
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.139866828918457
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8622188568115234
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.105407953262329
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9797730445861816
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9714446067810059
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0965235233306885
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.088543176651001
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.06587815284729
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1298341751098633
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 222636
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3597726821899414
Epoch: 1, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.596 Vali Acc: 0.344 Test Loss: 1.596 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 0.8083474636077881
Epoch: 2, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
Validation loss decreased (-0.344428 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 0.7607402801513672
Epoch: 3, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.068 Vali Acc: 0.667 Test Loss: 1.068 Test Acc: 0.667
Validation loss decreased (-0.599987 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.7417941093444824
Epoch: 4, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.891 Vali Acc: 0.722 Test Loss: 0.891 Test Acc: 0.722
Validation loss decreased (-0.666656 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 0.9056591987609863
Epoch: 5, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
Validation loss decreased (-0.722213 --> -0.783326).  Saving model ...
Epoch: 6 cost time: 0.9246385097503662
Epoch: 6, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 7 cost time: 1.0292243957519531
Epoch: 7, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.531 Vali Acc: 0.811 Test Loss: 0.531 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 0.8610286712646484
Epoch: 8, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.464 Vali Acc: 0.828 Test Loss: 0.464 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827773).  Saving model ...
Epoch: 9 cost time: 0.9643113613128662
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 0.9974019527435303
Epoch: 10, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9797625541687012
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 1.01198148727417
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9019031524658203
Epoch: 13, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8588602542877197
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 0.8416538238525391
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0662577152252197
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 0.9751060009002686
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.0099449157714844
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 0.9305555820465088
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.0832266807556152
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 0.924677848815918
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.850 Test Loss: 0.282 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0407991409301758
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.275 Vali Acc: 0.850 Test Loss: 0.275 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9782400131225586
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1233327388763428
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1191010475158691
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0621662139892578
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.133868932723999
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0804483890533447
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.158726453781128
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8374538421630859
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 220588
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.633343458175659
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.617 Vali Acc: 0.306 Test Loss: 1.617 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 0.9540989398956299
Epoch: 2, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.252 Vali Acc: 0.611 Test Loss: 1.252 Test Acc: 0.611
Validation loss decreased (-0.305539 --> -0.611099).  Saving model ...
Epoch: 3 cost time: 0.8571343421936035
Epoch: 3, Steps: 12 | Train Loss: 1.040 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
Validation loss decreased (-0.611099 --> -0.738879).  Saving model ...
Epoch: 4 cost time: 0.9310448169708252
Epoch: 4, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.1306712627410889
Epoch: 5, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.744437 --> -0.788882).  Saving model ...
Epoch: 6 cost time: 1.0958945751190186
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.543 Vali Acc: 0.806 Test Loss: 0.543 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805550).  Saving model ...
Epoch: 7 cost time: 0.7731947898864746
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.477 Vali Acc: 0.839 Test Loss: 0.477 Test Acc: 0.839
Validation loss decreased (-0.805550 --> -0.838884).  Saving model ...
Epoch: 8 cost time: 0.7027862071990967
Epoch: 8, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.838884 --> -0.877774).  Saving model ...
Epoch: 9 cost time: 0.8056070804595947
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7907249927520752
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0455336570739746
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.766789436340332
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8127379417419434
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 0.670520544052124
Epoch: 14, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7347493171691895
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.7313704490661621
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 0.8224961757659912
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7498111724853516
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8717007637023926
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.105048656463623
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9801068305969238
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7249348163604736
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9930531978607178
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.24977445602417
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9086759090423584
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.950446367263794
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 218540
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6242876052856445
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.617 Vali Acc: 0.306 Test Loss: 1.617 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 0.8388473987579346
Epoch: 2, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.252 Vali Acc: 0.611 Test Loss: 1.252 Test Acc: 0.611
Validation loss decreased (-0.305539 --> -0.611099).  Saving model ...
Epoch: 3 cost time: 0.7769055366516113
Epoch: 3, Steps: 12 | Train Loss: 1.040 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
Validation loss decreased (-0.611099 --> -0.738879).  Saving model ...
Epoch: 4 cost time: 0.9987266063690186
Epoch: 4, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.0858433246612549
Epoch: 5, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.744437 --> -0.788882).  Saving model ...
Epoch: 6 cost time: 0.9205625057220459
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.543 Vali Acc: 0.806 Test Loss: 0.543 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805550).  Saving model ...
Epoch: 7 cost time: 0.9327459335327148
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.477 Vali Acc: 0.839 Test Loss: 0.477 Test Acc: 0.839
Validation loss decreased (-0.805550 --> -0.838884).  Saving model ...
Epoch: 8 cost time: 1.0165631771087646
Epoch: 8, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.838884 --> -0.877774).  Saving model ...
Epoch: 9 cost time: 1.1373443603515625
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.097926139831543
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9559688568115234
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8362438678741455
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.956575870513916
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 0.8028016090393066
Epoch: 14, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8678433895111084
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.8916122913360596
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 0.8292629718780518
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9579527378082275
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9694492816925049
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9086720943450928
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8956923484802246
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9922220706939697
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9773204326629639
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9808273315429688
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8464131355285645
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6381800174713135
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 218540
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6990153789520264
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.790 Vali Acc: 0.206 Test Loss: 1.790 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 1.3258183002471924
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.616 Vali Acc: 0.317 Test Loss: 1.616 Test Acc: 0.317
Validation loss decreased (-0.205538 --> -0.316651).  Saving model ...
Epoch: 3 cost time: 1.1685729026794434
Epoch: 3, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.401 Vali Acc: 0.544 Test Loss: 1.401 Test Acc: 0.544
Validation loss decreased (-0.316651 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.1193480491638184
Epoch: 4, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.185 Vali Acc: 0.667 Test Loss: 1.185 Test Acc: 0.667
Validation loss decreased (-0.544430 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.2091493606567383
Epoch: 5, Steps: 12 | Train Loss: 1.029 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.0713565349578857
Epoch: 6, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.814 Vali Acc: 0.756 Test Loss: 0.814 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.1355085372924805
Epoch: 7, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783327).  Saving model ...
Epoch: 8 cost time: 1.1966564655303955
Epoch: 8, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.1915841102600098
Epoch: 9, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 1.144028902053833
Epoch: 10, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 1.106166124343872
Epoch: 11, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.408 Vali Acc: 0.867 Test Loss: 0.408 Test Acc: 0.867
Validation loss decreased (-0.822218 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 1.047649621963501
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.381 Vali Acc: 0.839 Test Loss: 0.381 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0293803215026855
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.160780429840088
Epoch: 14, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.101552963256836
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.866663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.174635887145996
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.045161247253418
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1704604625701904
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.128936529159546
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0895702838897705
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1546170711517334
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.2249512672424316
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2955617904663086
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.0955049991607666
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.238933801651001
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.147428035736084
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.9856376647949219
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 1.1260426044464111
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1689808368682861
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2148685455322266
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.0024213790893555
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 32 cost time: 0.9415943622589111
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 33 cost time: 1.0915789604187012
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 1.2096519470214844
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.168 Vali Acc: 0.928 Test Loss: 0.168 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 1.2633111476898193
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.922 Test Loss: 0.178 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3668186664581299
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1372685432434082
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.922 Test Loss: 0.168 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3227827548980713
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2620925903320312
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.922 Test Loss: 0.169 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1123700141906738
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0170326232910156
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.917 Test Loss: 0.167 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0110511779785156
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.922 Test Loss: 0.164 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0995004177093506
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.928 Test Loss: 0.159 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 44 cost time: 1.1076862812042236
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.922 Test Loss: 0.162 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1050441265106201
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.922 Test Loss: 0.160 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9785070419311523
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.922 Test Loss: 0.159 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.131720781326294
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 48 cost time: 1.084564447402954
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.922 Test Loss: 0.166 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0531361103057861
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.922 Test Loss: 0.159 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.002558946609497
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.922 Test Loss: 0.159 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0210461616516113
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.928 Test Loss: 0.155 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0870051383972168
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.922 Test Loss: 0.156 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1581447124481201
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.928 Test Loss: 0.159 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.2697298526763916
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.933 Test Loss: 0.160 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 55 cost time: 1.204127550125122
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.922 Test Loss: 0.161 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0646836757659912
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1506524085998535
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.922 Test Loss: 0.157 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.3565821647644043
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.922 Test Loss: 0.156 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2637922763824463
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.928 Test Loss: 0.159 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1900653839111328
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.922 Test Loss: 0.161 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1687736511230469
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.928 Test Loss: 0.164 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.2359907627105713
Epoch: 62, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.928 Test Loss: 0.162 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.242995023727417
Epoch: 63, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.917 Test Loss: 0.164 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.4996306896209717
Epoch: 64, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.928 Test Loss: 0.162 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 120828
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8049256801605225
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.771 Vali Acc: 0.244 Test Loss: 1.771 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.2088680267333984
Epoch: 2, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.595 Vali Acc: 0.411 Test Loss: 1.595 Test Acc: 0.411
Validation loss decreased (-0.244427 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 1.206150770187378
Epoch: 3, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.390 Vali Acc: 0.589 Test Loss: 1.390 Test Acc: 0.589
Validation loss decreased (-0.411095 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 1.0306973457336426
Epoch: 4, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.191 Vali Acc: 0.656 Test Loss: 1.191 Test Acc: 0.656
Validation loss decreased (-0.588875 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.3366069793701172
Epoch: 5, Steps: 12 | Train Loss: 0.998 Vali Loss: 0.998 Vali Acc: 0.678 Test Loss: 0.998 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 1.1292293071746826
Epoch: 6, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.834 Vali Acc: 0.728 Test Loss: 0.834 Test Acc: 0.728
Validation loss decreased (-0.677768 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 1.4322340488433838
Epoch: 7, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.1524052619934082
Epoch: 8, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.1819686889648438
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 1.1610066890716553
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1066977977752686
Epoch: 11, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.422 Vali Acc: 0.839 Test Loss: 0.422 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 0.9459288120269775
Epoch: 12, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.1483983993530273
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.0963284969329834
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2717618942260742
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.337 Vali Acc: 0.878 Test Loss: 0.337 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 1.4984261989593506
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.2331514358520508
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.1839599609375
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0072362422943115
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.1347301006317139
Epoch: 20, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.1866888999938965
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1562128067016602
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0870802402496338
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1907603740692139
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4187285900115967
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1842849254608154
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.239 Vali Acc: 0.872 Test Loss: 0.239 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1872403621673584
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3493070602416992
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3562614917755127
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4219508171081543
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 119804
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0497872829437256
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.756 Vali Acc: 0.211 Test Loss: 1.756 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.1045429706573486
Epoch: 2, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.586 Vali Acc: 0.367 Test Loss: 1.586 Test Acc: 0.367
Validation loss decreased (-0.211094 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 1.0395886898040771
Epoch: 3, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.395 Vali Acc: 0.533 Test Loss: 1.395 Test Acc: 0.533
Validation loss decreased (-0.366651 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 1.2185347080230713
Epoch: 4, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.202 Vali Acc: 0.633 Test Loss: 1.202 Test Acc: 0.633
Validation loss decreased (-0.533319 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.0017926692962646
Epoch: 5, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
Validation loss decreased (-0.633321 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.0306224822998047
Epoch: 6, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.861 Vali Acc: 0.739 Test Loss: 0.861 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.2838833332061768
Epoch: 7, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.1619067192077637
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.761104 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.2338056564331055
Epoch: 9, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 1.2264494895935059
Epoch: 10, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 0.93190598487854
Epoch: 11, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 0.9666397571563721
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0642492771148682
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.382 Vali Acc: 0.894 Test Loss: 0.382 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 1.0472254753112793
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0697734355926514
Epoch: 15, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1237096786499023
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8740818500518799
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.9376130104064941
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0107841491699219
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0866506099700928
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1890201568603516
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 0.9612627029418945
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9003016948699951
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1329364776611328
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9076259136199951
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1552274227142334
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9813880920410156
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9662134647369385
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8349919319152832
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0063307285308838
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9923269748687744
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 117756
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6644034385681152
Epoch: 1, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.790 Vali Acc: 0.161 Test Loss: 1.790 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.9572529792785645
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.607 Vali Acc: 0.361 Test Loss: 1.607 Test Acc: 0.361
Validation loss decreased (-0.161093 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 0.9453771114349365
Epoch: 3, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.395 Vali Acc: 0.578 Test Loss: 1.395 Test Acc: 0.578
Validation loss decreased (-0.361095 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.9140975475311279
Epoch: 4, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.177 Vali Acc: 0.722 Test Loss: 1.177 Test Acc: 0.722
Validation loss decreased (-0.577764 --> -0.722210).  Saving model ...
Epoch: 5 cost time: 0.7473058700561523
Epoch: 5, Steps: 12 | Train Loss: 0.998 Vali Loss: 0.968 Vali Acc: 0.756 Test Loss: 0.968 Test Acc: 0.756
Validation loss decreased (-0.722210 --> -0.755546).  Saving model ...
Epoch: 6 cost time: 0.8103818893432617
Epoch: 6, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 1.035815954208374
Epoch: 7, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
Validation loss decreased (-0.783326 --> -0.827771).  Saving model ...
Epoch: 8 cost time: 1.0637969970703125
Epoch: 8, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.540 Vali Acc: 0.817 Test Loss: 0.540 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0715031623840332
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 1.013066291809082
Epoch: 10, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 1.2274267673492432
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.379 Vali Acc: 0.872 Test Loss: 0.379 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 0.9992156028747559
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.0663883686065674
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.0297455787658691
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.3749406337738037
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.243706226348877
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 1.1523799896240234
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1899707317352295
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 0.9191675186157227
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.2479462623596191
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 1.3041584491729736
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.996150016784668
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0567803382873535
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0954649448394775
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0523853302001953
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2780272960662842
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9496562480926514
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0131089687347412
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9002621173858643
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8163497447967529
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.911 Test Loss: 0.179 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 116732
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5956051349639893
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.830 Vali Acc: 0.233 Test Loss: 1.830 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 0.8983204364776611
Epoch: 2, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.633 Vali Acc: 0.339 Test Loss: 1.633 Test Acc: 0.339
Validation loss decreased (-0.233315 --> -0.338873).  Saving model ...
Epoch: 3 cost time: 0.8634710311889648
Epoch: 3, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (-0.338873 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.7677907943725586
Epoch: 4, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.196 Vali Acc: 0.594 Test Loss: 1.196 Test Acc: 0.594
Validation loss decreased (-0.499986 --> -0.594432).  Saving model ...
Epoch: 5 cost time: 0.956439733505249
Epoch: 5, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.995 Vali Acc: 0.656 Test Loss: 0.995 Test Acc: 0.656
Validation loss decreased (-0.594432 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 1.2018122673034668
Epoch: 6, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
Validation loss decreased (-0.655546 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 0.8437583446502686
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 1.0695793628692627
Epoch: 8, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
Validation loss decreased (-0.738882 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 0.9896574020385742
Epoch: 9, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.540 Vali Acc: 0.778 Test Loss: 0.540 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9055538177490234
Epoch: 10, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.491 Vali Acc: 0.794 Test Loss: 0.491 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.0505051612854004
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.450 Vali Acc: 0.828 Test Loss: 0.450 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.8721780776977539
Epoch: 12, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 0.8249871730804443
Epoch: 13, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 0.7929971218109131
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 0.8040521144866943
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.983426570892334
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0134367942810059
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.1667582988739014
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8873906135559082
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8209676742553711
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8115847110748291
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7437474727630615
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 0.7897002696990967
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2272448539733887
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 25 cost time: 0.947319507598877
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0385026931762695
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 27 cost time: 0.9147589206695557
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 0.9112286567687988
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2950859069824219
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0448224544525146
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0065193176269531
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9798455238342285
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.059722661972046
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.935225248336792
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 1.0720226764678955
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 36 cost time: 0.9029636383056641
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.077704906463623
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0518090724945068
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0136542320251465
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.048699140548706
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 0.8695194721221924
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8686313629150391
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.891338586807251
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 0.9074087142944336
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.986140251159668
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9823358058929443
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7523758411407471
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8974533081054688
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0594007968902588
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9865062236785889
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7819039821624756
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9317049980163574
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8770897388458252
Epoch: 53, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 115708
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0789542198181152
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.699 Vali Acc: 0.278 Test Loss: 1.699 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.0608398914337158
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.517 Vali Acc: 0.478 Test Loss: 1.517 Test Acc: 0.478
Validation loss decreased (-0.277761 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 0.8547701835632324
Epoch: 3, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.477763 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 1.0630135536193848
Epoch: 4, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.616654 --> -0.733322).  Saving model ...
Epoch: 5 cost time: 0.9141337871551514
Epoch: 5, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.733322 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.7295095920562744
Epoch: 6, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.8810036182403564
Epoch: 7, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 0.8310537338256836
Epoch: 8, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1783263683319092
Epoch: 9, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 1.1196835041046143
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.0389633178710938
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.94724440574646
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.001922607421875
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8625822067260742
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 0.9132483005523682
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.8257954120635986
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9086194038391113
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 0.8175215721130371
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0255701541900635
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9393718242645264
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 0.8868832588195801
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 0.9579799175262451
Epoch: 22, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 0.7526028156280518
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 0.85672926902771
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.881005048751831
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8477613925933838
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 27 cost time: 0.8909928798675537
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8751952648162842
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 0.857961893081665
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 0.7327380180358887
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7261192798614502
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7449569702148438
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8072493076324463
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8502748012542725
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9666550159454346
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9028992652893066
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.907494068145752
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8569893836975098
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6960158348083496
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 114684
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3978028297424316
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.699 Vali Acc: 0.278 Test Loss: 1.699 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.7736301422119141
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.517 Vali Acc: 0.478 Test Loss: 1.517 Test Acc: 0.478
Validation loss decreased (-0.277761 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 0.9770691394805908
Epoch: 3, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.477763 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 0.980762243270874
Epoch: 4, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.616654 --> -0.733322).  Saving model ...
Epoch: 5 cost time: 0.7546193599700928
Epoch: 5, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.733322 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.7993860244750977
Epoch: 6, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.8849313259124756
Epoch: 7, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 0.8229165077209473
Epoch: 8, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9685897827148438
Epoch: 9, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 0.8488526344299316
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 0.838484525680542
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8749954700469971
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.804344892501831
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9110558032989502
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 0.7792987823486328
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.8313262462615967
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8437016010284424
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 0.8821878433227539
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9496424198150635
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8801569938659668
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 0.9347083568572998
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.2094135284423828
Epoch: 22, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 0.7450845241546631
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 0.9941201210021973
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.7355411052703857
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0441269874572754
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 27 cost time: 0.8820629119873047
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.043609857559204
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 0.8988780975341797
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 0.9312002658843994
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9811701774597168
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.940568208694458
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7565200328826904
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7408337593078613
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8674073219299316
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8384547233581543
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.974790096282959
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8593275547027588
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7629377841949463
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 114684
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.829867124557495
Epoch: 1, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.673 Vali Acc: 0.328 Test Loss: 1.673 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.111572265625
Epoch: 2, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.519 Vali Acc: 0.456 Test Loss: 1.519 Test Acc: 0.456
Validation loss decreased (-0.327761 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.1661903858184814
Epoch: 3, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.346 Vali Acc: 0.556 Test Loss: 1.346 Test Acc: 0.556
Validation loss decreased (-0.455540 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.2017643451690674
Epoch: 4, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.171 Vali Acc: 0.606 Test Loss: 1.171 Test Acc: 0.606
Validation loss decreased (-0.555542 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 1.3063886165618896
Epoch: 5, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.011 Vali Acc: 0.667 Test Loss: 1.011 Test Acc: 0.667
Validation loss decreased (-0.605544 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.3269963264465332
Epoch: 6, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.858 Vali Acc: 0.739 Test Loss: 0.858 Test Acc: 0.739
Validation loss decreased (-0.666657 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.5250513553619385
Epoch: 7, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 1.2681620121002197
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
Validation loss decreased (-0.772215 --> -0.827772).  Saving model ...
Epoch: 9 cost time: 1.4471054077148438
Epoch: 9, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 1.325310468673706
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 1.0667681694030762
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.2163915634155273
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.1933109760284424
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.0415623188018799
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3075282573699951
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.498253583908081
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 1.2016515731811523
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.104250192642212
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 1.0182116031646729
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1784403324127197
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.585303783416748
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2361068725585938
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 1.3798604011535645
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2329652309417725
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1891791820526123
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.3619933128356934
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0360996723175049
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.126725435256958
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0475420951843262
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2844014167785645
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 1.1083061695098877
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0876245498657227
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1044974327087402
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.0923960208892822
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 0.9191489219665527
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1689753532409668
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1388471126556396
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1962676048278809
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 1.2907435894012451
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3844327926635742
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 1.150397539138794
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2099132537841797
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1530811786651611
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1087584495544434
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0371899604797363
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2748756408691406
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2529139518737793
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0648438930511475
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 49 cost time: 1.0938963890075684
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.9952487945556641
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9807417392730713
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.062269926071167
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1112124919891357
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.012890338897705
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1930615901947021
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.9543073177337646
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.2508437633514404
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.052983283996582
Epoch: 58, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.952430009841919
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.939 Test Loss: 0.172 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 120044
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.069645404815674
Epoch: 1, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.844 Vali Acc: 0.100 Test Loss: 1.844 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 1.5060808658599854
Epoch: 2, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.663 Vali Acc: 0.311 Test Loss: 1.663 Test Acc: 0.311
Validation loss decreased (-0.099982 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 1.0713467597961426
Epoch: 3, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.452 Vali Acc: 0.544 Test Loss: 1.452 Test Acc: 0.544
Validation loss decreased (-0.311094 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.1486096382141113
Epoch: 4, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.235 Vali Acc: 0.589 Test Loss: 1.235 Test Acc: 0.589
Validation loss decreased (-0.544430 --> -0.588877).  Saving model ...
Epoch: 5 cost time: 1.1516005992889404
Epoch: 5, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.036 Vali Acc: 0.689 Test Loss: 1.036 Test Acc: 0.689
Validation loss decreased (-0.588877 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 0.988938570022583
Epoch: 6, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.855 Vali Acc: 0.739 Test Loss: 0.855 Test Acc: 0.739
Validation loss decreased (-0.688879 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.1044108867645264
Epoch: 7, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 1.1362314224243164
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.599 Vali Acc: 0.806 Test Loss: 0.599 Test Acc: 0.806
Validation loss decreased (-0.766660 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 1.0848174095153809
Epoch: 9, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 1.1580893993377686
Epoch: 10, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.477 Vali Acc: 0.828 Test Loss: 0.477 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.0148720741271973
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 1.1187222003936768
Epoch: 12, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0411689281463623
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.076120138168335
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2730615139007568
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.1924715042114258
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.438621997833252
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.4200820922851562
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.109053134918213
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.0523583889007568
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.135936975479126
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.145110845565796
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 23 cost time: 1.0009169578552246
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 1.2155952453613281
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.4314610958099365
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.3717710971832275
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.0488812923431396
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.2584168910980225
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 1.2325539588928223
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.176666498184204
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4002947807312012
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2356946468353271
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 33 cost time: 1.5430405139923096
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5021274089813232
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2663567066192627
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 1.337158441543579
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 1.753882646560669
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2751286029815674
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 1.3229119777679443
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1045191287994385
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9526169300079346
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0017380714416504
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4841256141662598
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.339174747467041
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 1.2179896831512451
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.211852788925171
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4516370296478271
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3937580585479736
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2558138370513916
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.15389084815979
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3802547454833984
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.6147377490997314
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 1.2629458904266357
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4399073123931885
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2483716011047363
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2864713668823242
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2530136108398438
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.355668306350708
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3234100341796875
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.349684238433838
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3344202041625977
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.261707067489624
Epoch: 62, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 119020
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.865588903427124
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.729 Vali Acc: 0.206 Test Loss: 1.729 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.9681954383850098
Epoch: 2, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.561 Vali Acc: 0.456 Test Loss: 1.561 Test Acc: 0.456
Validation loss decreased (-0.205538 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.4060091972351074
Epoch: 3, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.370 Vali Acc: 0.572 Test Loss: 1.370 Test Acc: 0.572
Validation loss decreased (-0.455540 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.9640829563140869
Epoch: 4, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.174 Vali Acc: 0.672 Test Loss: 1.174 Test Acc: 0.672
Validation loss decreased (-0.572209 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.1892714500427246
Epoch: 5, Steps: 12 | Train Loss: 1.039 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
Validation loss decreased (-0.672210 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.9212839603424072
Epoch: 6, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 1.1133484840393066
Epoch: 7, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
Validation loss decreased (-0.727769 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 1.087571620941162
Epoch: 8, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.2754645347595215
Epoch: 9, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 1.0632398128509521
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0013854503631592
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.9890477657318115
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 0.8327360153198242
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
Validation loss decreased (-0.855551 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.034040927886963
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9314877986907959
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0133867263793945
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.064276933670044
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.0517301559448242
Epoch: 18, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.1474530696868896
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.1421959400177002
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.9140262603759766
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 1.0390613079071045
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8284378051757812
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9812352657318115
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9050068855285645
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8938140869140625
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8570969104766846
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8510758876800537
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9556515216827393
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9085681438446045
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8419878482818604
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 116972
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7007408142089844
Epoch: 1, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.735 Vali Acc: 0.267 Test Loss: 1.735 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 1.0119755268096924
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.561 Vali Acc: 0.406 Test Loss: 1.561 Test Acc: 0.406
Validation loss decreased (-0.266649 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 1.0967345237731934
Epoch: 3, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.371 Vali Acc: 0.489 Test Loss: 1.371 Test Acc: 0.489
Validation loss decreased (-0.405540 --> -0.488875).  Saving model ...
Epoch: 4 cost time: 0.86893630027771
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.178 Vali Acc: 0.628 Test Loss: 1.178 Test Acc: 0.628
Validation loss decreased (-0.488875 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 1.0423839092254639
Epoch: 5, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.002 Vali Acc: 0.706 Test Loss: 1.002 Test Acc: 0.706
Validation loss decreased (-0.627766 --> -0.705546).  Saving model ...
Epoch: 6 cost time: 0.964177131652832
Epoch: 6, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.847 Vali Acc: 0.739 Test Loss: 0.847 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.8895971775054932
Epoch: 7, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 0.8679959774017334
Epoch: 8, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783327).  Saving model ...
Epoch: 9 cost time: 1.0323011875152588
Epoch: 9, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.0176050662994385
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.497 Vali Acc: 0.817 Test Loss: 0.497 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.0600402355194092
Epoch: 11, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.462 Vali Acc: 0.828 Test Loss: 0.462 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.9601147174835205
Epoch: 12, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.021263837814331
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 1.0714099407196045
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.003443956375122
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.039003849029541
Epoch: 16, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1335878372192383
Epoch: 17, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1542890071868896
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.2976384162902832
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2258186340332031
Epoch: 20, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3505709171295166
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1148946285247803
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9899475574493408
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0887048244476318
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9423985481262207
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8880884647369385
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0252718925476074
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.058777093887329
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 115948
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.766939163208008
Epoch: 1, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.702 Vali Acc: 0.261 Test Loss: 1.702 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 0.7117767333984375
Epoch: 2, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.534 Vali Acc: 0.433 Test Loss: 1.534 Test Acc: 0.433
Validation loss decreased (-0.261094 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 0.7009835243225098
Epoch: 3, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.328 Vali Acc: 0.572 Test Loss: 1.328 Test Acc: 0.572
Validation loss decreased (-0.433318 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.6859922409057617
Epoch: 4, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.124 Vali Acc: 0.694 Test Loss: 1.124 Test Acc: 0.694
Validation loss decreased (-0.572209 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 0.8157391548156738
Epoch: 5, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
Validation loss decreased (-0.694433 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 0.7377521991729736
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755548).  Saving model ...
Epoch: 7 cost time: 0.7549088001251221
Epoch: 7, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 0.7620337009429932
Epoch: 8, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.794438 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.7866513729095459
Epoch: 9, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 0.8448913097381592
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.446 Vali Acc: 0.867 Test Loss: 0.446 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 0.7517216205596924
Epoch: 11, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.8438010215759277
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 0.8856022357940674
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.346 Vali Acc: 0.883 Test Loss: 0.346 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 0.9717755317687988
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.775641918182373
Epoch: 15, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.7322378158569336
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8352198600769043
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.8019051551818848
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8212127685546875
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1856167316436768
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 0.9425842761993408
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9105160236358643
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.205336570739746
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 1.276904821395874
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.052428960800171
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.219 Vali Acc: 0.883 Test Loss: 0.219 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8656637668609619
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 0.8603477478027344
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0407719612121582
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 1.2321791648864746
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2167034149169922
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 1.0159971714019775
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.878 Test Loss: 0.232 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2323663234710693
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8543756008148193
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.91400146484375
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0317893028259277
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9287500381469727
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8163332939147949
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1312694549560547
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1149485111236572
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0089428424835205
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 114924
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2137911319732666
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.716 Vali Acc: 0.206 Test Loss: 1.716 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.9387433528900146
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.539 Vali Acc: 0.372 Test Loss: 1.539 Test Acc: 0.372
Validation loss decreased (-0.205538 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 0.766273021697998
Epoch: 3, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.348 Vali Acc: 0.611 Test Loss: 1.348 Test Acc: 0.611
Validation loss decreased (-0.372207 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 0.8993489742279053
Epoch: 4, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.156 Vali Acc: 0.678 Test Loss: 1.156 Test Acc: 0.678
Validation loss decreased (-0.611098 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.7819631099700928
Epoch: 5, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.976 Vali Acc: 0.767 Test Loss: 0.976 Test Acc: 0.767
Validation loss decreased (-0.677766 --> -0.766657).  Saving model ...
Epoch: 6 cost time: 0.8665666580200195
Epoch: 6, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.812 Vali Acc: 0.794 Test Loss: 0.812 Test Acc: 0.794
Validation loss decreased (-0.766657 --> -0.794436).  Saving model ...
Epoch: 7 cost time: 0.9836733341217041
Epoch: 7, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
Validation loss decreased (-0.794436 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 0.7753305435180664
Epoch: 8, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.588 Vali Acc: 0.817 Test Loss: 0.588 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9527859687805176
Epoch: 9, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.516 Vali Acc: 0.839 Test Loss: 0.516 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 1.0447165966033936
Epoch: 10, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0874900817871094
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 0.758411169052124
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.398 Vali Acc: 0.856 Test Loss: 0.398 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 0.7567055225372314
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.8734848499298096
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 1.0706048011779785
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.9404733180999756
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9348783493041992
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.8191995620727539
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8405210971832275
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9124646186828613
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.146068811416626
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9213435649871826
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0507032871246338
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9502780437469482
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9667847156524658
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8478834629058838
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0255048274993896
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 113900
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3253841400146484
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.716 Vali Acc: 0.206 Test Loss: 1.716 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.9600791931152344
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.539 Vali Acc: 0.372 Test Loss: 1.539 Test Acc: 0.372
Validation loss decreased (-0.205538 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 0.7432875633239746
Epoch: 3, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.348 Vali Acc: 0.611 Test Loss: 1.348 Test Acc: 0.611
Validation loss decreased (-0.372207 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 0.7451531887054443
Epoch: 4, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.156 Vali Acc: 0.678 Test Loss: 1.156 Test Acc: 0.678
Validation loss decreased (-0.611098 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.973034143447876
Epoch: 5, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.976 Vali Acc: 0.767 Test Loss: 0.976 Test Acc: 0.767
Validation loss decreased (-0.677766 --> -0.766657).  Saving model ...
Epoch: 6 cost time: 0.8103153705596924
Epoch: 6, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.812 Vali Acc: 0.794 Test Loss: 0.812 Test Acc: 0.794
Validation loss decreased (-0.766657 --> -0.794436).  Saving model ...
Epoch: 7 cost time: 0.7681832313537598
Epoch: 7, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
Validation loss decreased (-0.794436 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 0.8329203128814697
Epoch: 8, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.588 Vali Acc: 0.817 Test Loss: 0.588 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.830272912979126
Epoch: 9, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.516 Vali Acc: 0.839 Test Loss: 0.516 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 0.909461498260498
Epoch: 10, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8666031360626221
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 0.879274845123291
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.398 Vali Acc: 0.856 Test Loss: 0.398 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 0.7982163429260254
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.8773367404937744
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.836860179901123
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.790947675704956
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8208255767822266
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.8918719291687012
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.023890733718872
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7792301177978516
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9291346073150635
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8580565452575684
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9067966938018799
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9918618202209473
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8844122886657715
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.778846263885498
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7896904945373535
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 113900
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8535497188568115
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.835 Vali Acc: 0.183 Test Loss: 1.835 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.086822509765625
Epoch: 2, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.675 Vali Acc: 0.333 Test Loss: 1.675 Test Acc: 0.333
Validation loss decreased (-0.183315 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 1.3319635391235352
Epoch: 3, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.477 Vali Acc: 0.522 Test Loss: 1.477 Test Acc: 0.522
Validation loss decreased (-0.333317 --> -0.522207).  Saving model ...
Epoch: 4 cost time: 0.996157169342041
Epoch: 4, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.274 Vali Acc: 0.656 Test Loss: 1.274 Test Acc: 0.656
Validation loss decreased (-0.522207 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.3483121395111084
Epoch: 5, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.075 Vali Acc: 0.733 Test Loss: 1.075 Test Acc: 0.733
Validation loss decreased (-0.655543 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.1565577983856201
Epoch: 6, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.882 Vali Acc: 0.739 Test Loss: 0.882 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.6386044025421143
Epoch: 7, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.738880 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 1.091881513595581
Epoch: 8, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.4000723361968994
Epoch: 9, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.9979479312896729
Epoch: 10, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.3357000350952148
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.1095926761627197
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.387 Vali Acc: 0.856 Test Loss: 0.387 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2780296802520752
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.361 Vali Acc: 0.883 Test Loss: 0.361 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.2365524768829346
Epoch: 14, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.2082240581512451
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.147411823272705
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
Validation loss decreased (-0.883330 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 1.3277125358581543
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4114432334899902
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.2746708393096924
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.356764316558838
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2252984046936035
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6366157531738281
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.434546709060669
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3389256000518799
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4873957633972168
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4152553081512451
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4980528354644775
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4459691047668457
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 0.972571611404419
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.198481559753418
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2338049411773682
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.478015661239624
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3122735023498535
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.397491455078125
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.181884527206421
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1459519863128662
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0986013412475586
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.209104061126709
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 119652
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6520235538482666
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.815 Vali Acc: 0.183 Test Loss: 1.815 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.5387523174285889
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.626 Vali Acc: 0.361 Test Loss: 1.626 Test Acc: 0.361
Validation loss decreased (-0.183315 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 1.1299221515655518
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.399 Vali Acc: 0.606 Test Loss: 1.399 Test Acc: 0.606
Validation loss decreased (-0.361095 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 1.011270523071289
Epoch: 4, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.177 Vali Acc: 0.711 Test Loss: 1.177 Test Acc: 0.711
Validation loss decreased (-0.605542 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 0.9656119346618652
Epoch: 5, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.985 Vali Acc: 0.711 Test Loss: 0.985 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 1.1015410423278809
Epoch: 6, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 1.0624206066131592
Epoch: 7, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.683 Vali Acc: 0.772 Test Loss: 0.683 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 1.0402238368988037
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.593 Vali Acc: 0.772 Test Loss: 0.593 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 1.0682573318481445
Epoch: 9, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.521 Vali Acc: 0.806 Test Loss: 0.521 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 1.406491756439209
Epoch: 10, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.467 Vali Acc: 0.839 Test Loss: 0.467 Test Acc: 0.839
Validation loss decreased (-0.805550 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.3096189498901367
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 1.0675971508026123
Epoch: 12, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.395 Vali Acc: 0.844 Test Loss: 0.395 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.2604618072509766
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.2794547080993652
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4674601554870605
Epoch: 15, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 1.2886910438537598
Epoch: 16, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1530699729919434
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 0.9719061851501465
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.0850856304168701
Epoch: 19, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.187408208847046
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0791687965393066
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.417529582977295
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.0776708126068115
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3085620403289795
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.1046178340911865
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.550255298614502
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.1488275527954102
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 1.404608964920044
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2012946605682373
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8591113090515137
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 31 cost time: 1.0327491760253906
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1049199104309082
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2432312965393066
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1071877479553223
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1741070747375488
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9735369682312012
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1489458084106445
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.13616943359375
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0777912139892578
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2499477863311768
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 118628
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.971026659011841
Epoch: 1, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.756 Vali Acc: 0.178 Test Loss: 1.756 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 1.1115572452545166
Epoch: 2, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.585 Vali Acc: 0.372 Test Loss: 1.585 Test Acc: 0.372
Validation loss decreased (-0.177760 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 0.9995977878570557
Epoch: 3, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.394 Vali Acc: 0.650 Test Loss: 1.394 Test Acc: 0.650
Validation loss decreased (-0.372206 --> -0.649986).  Saving model ...
Epoch: 4 cost time: 1.0526766777038574
Epoch: 4, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.197 Vali Acc: 0.744 Test Loss: 1.197 Test Acc: 0.744
Validation loss decreased (-0.649986 --> -0.744432).  Saving model ...
Epoch: 5 cost time: 0.9836955070495605
Epoch: 5, Steps: 12 | Train Loss: 1.098 Vali Loss: 0.999 Vali Acc: 0.800 Test Loss: 0.999 Test Acc: 0.800
Validation loss decreased (-0.744432 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.8377606868743896
Epoch: 6, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.825 Vali Acc: 0.817 Test Loss: 0.825 Test Acc: 0.817
Validation loss decreased (-0.799990 --> -0.816658).  Saving model ...
Epoch: 7 cost time: 0.864332914352417
Epoch: 7, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.684 Vali Acc: 0.806 Test Loss: 0.684 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8758175373077393
Epoch: 8, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.816658 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 0.9050824642181396
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 10 cost time: 0.8939645290374756
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.9106566905975342
Epoch: 11, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9968380928039551
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 1.0590465068817139
Epoch: 13, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 0.9423401355743408
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9683778285980225
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8902332782745361
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9900922775268555
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.8799986839294434
Epoch: 18, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9564323425292969
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9826679229736328
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8018314838409424
Epoch: 21, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7935934066772461
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.8435416221618652
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.9613234996795654
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0409188270568848
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9690811634063721
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 0.9752914905548096
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9243824481964111
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.821284294128418
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7495651245117188
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7969961166381836
Epoch: 31, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.055243730545044
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.894 Test Loss: 0.214 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0368385314941406
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9040226936340332
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0135247707366943
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.00327467918396
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 37 cost time: 0.9048552513122559
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.24349045753479
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.894 Test Loss: 0.220 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2347712516784668
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1221857070922852
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2723877429962158
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9811809062957764
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9455533027648926
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.055652141571045
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.931358814239502
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8671221733093262
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 116580
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.492175340652466
Epoch: 1, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.659 Vali Acc: 0.311 Test Loss: 1.659 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.890329122543335
Epoch: 2, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.497 Vali Acc: 0.528 Test Loss: 1.497 Test Acc: 0.528
Validation loss decreased (-0.311095 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 1.071518898010254
Epoch: 3, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.300 Vali Acc: 0.611 Test Loss: 1.300 Test Acc: 0.611
Validation loss decreased (-0.527763 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.1737101078033447
Epoch: 4, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.101 Vali Acc: 0.683 Test Loss: 1.101 Test Acc: 0.683
Validation loss decreased (-0.611098 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 0.8598237037658691
Epoch: 5, Steps: 12 | Train Loss: 0.964 Vali Loss: 0.915 Vali Acc: 0.728 Test Loss: 0.915 Test Acc: 0.728
Validation loss decreased (-0.683322 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 1.1406219005584717
Epoch: 6, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.769 Vali Acc: 0.733 Test Loss: 0.769 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 7 cost time: 0.9236249923706055
Epoch: 7, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.655 Vali Acc: 0.728 Test Loss: 0.655 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8407666683197021
Epoch: 8, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.571 Vali Acc: 0.767 Test Loss: 0.571 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.1124231815338135
Epoch: 9, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.507 Vali Acc: 0.794 Test Loss: 0.507 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 0.964374303817749
Epoch: 10, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
Validation loss decreased (-0.794439 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.9720051288604736
Epoch: 11, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.0606207847595215
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.9520132541656494
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.0514285564422607
Epoch: 14, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 0.9049479961395264
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.0068070888519287
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 0.9890215396881104
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.9243886470794678
Epoch: 18, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9519152641296387
Epoch: 19, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9836857318878174
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3558762073516846
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.008169412612915
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0173845291137695
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0174081325531006
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.0589239597320557
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.226 Vali Acc: 0.883 Test Loss: 0.226 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1315312385559082
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.010861873626709
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9228198528289795
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9186186790466309
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 0.8762547969818115
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9916167259216309
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.310314416885376
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9620487689971924
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.894 Test Loss: 0.215 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9890899658203125
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.102982759475708
Epoch: 35, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.303525447845459
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2576353549957275
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.337599515914917
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.906 Test Loss: 0.194 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1739482879638672
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 115556
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8442628383636475
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.718 Vali Acc: 0.233 Test Loss: 1.718 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.090259075164795
Epoch: 2, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.562 Vali Acc: 0.439 Test Loss: 1.562 Test Acc: 0.439
Validation loss decreased (-0.233316 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 1.097151756286621
Epoch: 3, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.376 Vali Acc: 0.589 Test Loss: 1.376 Test Acc: 0.589
Validation loss decreased (-0.438873 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.9310269355773926
Epoch: 4, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.183 Vali Acc: 0.672 Test Loss: 1.183 Test Acc: 0.672
Validation loss decreased (-0.588875 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 0.9639675617218018
Epoch: 5, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.985 Vali Acc: 0.728 Test Loss: 0.985 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 1.1810846328735352
Epoch: 6, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.823 Vali Acc: 0.767 Test Loss: 0.823 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 1.1445484161376953
Epoch: 7, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 1.0333101749420166
Epoch: 8, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822216).  Saving model ...
Epoch: 9 cost time: 1.0756251811981201
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 1.092383623123169
Epoch: 10, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.467 Vali Acc: 0.839 Test Loss: 0.467 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 0.9756889343261719
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.8870067596435547
Epoch: 12, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.382 Vali Acc: 0.872 Test Loss: 0.382 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 1.0393104553222656
Epoch: 13, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 1.0689303874969482
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 0.9909062385559082
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.059781789779663
Epoch: 16, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.9458279609680176
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.1933131217956543
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0464987754821777
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.1881704330444336
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.9579932689666748
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.251 Vali Acc: 0.872 Test Loss: 0.251 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9883472919464111
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.0130615234375
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.235 Vali Acc: 0.883 Test Loss: 0.235 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1260743141174316
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.804694414138794
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 0.7802441120147705
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9946138858795166
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 0.934234619140625
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.964116096496582
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9747109413146973
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0045876502990723
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 1.1478521823883057
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9082791805267334
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.8796241283416748
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.0992684364318848
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 0.7680819034576416
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 1.0199565887451172
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0590879917144775
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1178147792816162
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2069861888885498
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8469948768615723
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2064049243927002
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.226177453994751
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9571840763092041
Epoch: 44, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8573179244995117
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7602133750915527
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 114532
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9829115867614746
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.723 Vali Acc: 0.172 Test Loss: 1.723 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 0.9648501873016357
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.544 Vali Acc: 0.467 Test Loss: 1.544 Test Acc: 0.467
Validation loss decreased (-0.172205 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.741844654083252
Epoch: 3, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.466651 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 1.0445268154144287
Epoch: 4, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.149 Vali Acc: 0.711 Test Loss: 1.149 Test Acc: 0.711
Validation loss decreased (-0.644431 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 0.8269116878509521
Epoch: 5, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.970 Vali Acc: 0.744 Test Loss: 0.970 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 0.9299883842468262
Epoch: 6, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
Validation loss decreased (-0.744435 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 0.9002895355224609
Epoch: 7, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.7874219417572021
Epoch: 8, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 0.9941017627716064
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 0.8207035064697266
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.018589735031128
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.9892840385437012
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.0155434608459473
Epoch: 13, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 0.9939541816711426
Epoch: 14, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8605818748474121
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8569638729095459
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.116288661956787
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7258367538452148
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.8517377376556396
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.9594714641571045
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 0.8878533840179443
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.02701735496521
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 23 cost time: 0.8830978870391846
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.9010698795318604
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9253387451171875
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 0.9645183086395264
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 1.0310511589050293
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8517553806304932
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7629876136779785
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7697281837463379
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.9161121845245361
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9581723213195801
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8346536159515381
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7309329509735107
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 0.962792158126831
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8267102241516113
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8808004856109619
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9072732925415039
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8769028186798096
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8121509552001953
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.9450984001159668
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.852288007736206
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9652965068817139
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9208581447601318
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.9658451080322266
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0863382816314697
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9003326892852783
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9927451610565186
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.7351398468017578
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8139553070068359
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9371285438537598
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8107423782348633
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8519191741943359
Epoch: 53, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.8320684432983398
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0701982975006104
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0523037910461426
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9374494552612305
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.1151995658874512
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0010700225830078
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.0121231079101562
Epoch: 60, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1388514041900635
Epoch: 61, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.931431770324707
Epoch: 62, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8039929866790771
Epoch: 63, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 113508
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.878835439682007
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.723 Vali Acc: 0.172 Test Loss: 1.723 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 0.6788010597229004
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.544 Vali Acc: 0.467 Test Loss: 1.544 Test Acc: 0.467
Validation loss decreased (-0.172205 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.6548604965209961
Epoch: 3, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.466651 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 0.7267515659332275
Epoch: 4, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.149 Vali Acc: 0.711 Test Loss: 1.149 Test Acc: 0.711
Validation loss decreased (-0.644431 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 0.9227809906005859
Epoch: 5, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.970 Vali Acc: 0.744 Test Loss: 0.970 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 0.7328729629516602
Epoch: 6, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
Validation loss decreased (-0.744435 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 0.7512683868408203
Epoch: 7, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.8625543117523193
Epoch: 8, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 0.7785811424255371
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 0.6891708374023438
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7541294097900391
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.6728143692016602
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.8233850002288818
Epoch: 13, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 0.6594743728637695
Epoch: 14, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7622644901275635
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8978445529937744
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 0.7904355525970459
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8802480697631836
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.8014209270477295
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.7679879665374756
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 0.7294609546661377
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8092780113220215
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 23 cost time: 0.9525072574615479
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.7997920513153076
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7683303356170654
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 0.638237476348877
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 0.6626739501953125
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7450911998748779
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7851626873016357
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5794765949249268
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.6298661231994629
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9921848773956299
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.807199239730835
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8282227516174316
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 0.8799097537994385
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8505215644836426
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8158249855041504
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0504100322723389
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7377071380615234
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7967801094055176
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.7353115081787109
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.654130220413208
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7751686573028564
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7650880813598633
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.8367660045623779
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7788376808166504
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6581130027770996
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7792210578918457
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.8828005790710449
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7921440601348877
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7035255432128906
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8160932064056396
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7601573467254639
Epoch: 53, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.7390344142913818
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6494717597961426
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9343059062957764
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7904782295227051
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7436866760253906
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7427504062652588
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6333467960357666
Epoch: 60, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.7868638038635254
Epoch: 61, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.89764404296875
Epoch: 62, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8940348625183105
Epoch: 63, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 113508
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.107820510864258
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.779 Vali Acc: 0.206 Test Loss: 1.779 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 1.4049532413482666
Epoch: 2, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.610 Vali Acc: 0.289 Test Loss: 1.610 Test Acc: 0.289
Validation loss decreased (-0.205538 --> -0.288873).  Saving model ...
Epoch: 3 cost time: 1.4383068084716797
Epoch: 3, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.413 Vali Acc: 0.528 Test Loss: 1.413 Test Acc: 0.528
Validation loss decreased (-0.288873 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.4564390182495117
Epoch: 4, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.208 Vali Acc: 0.633 Test Loss: 1.208 Test Acc: 0.633
Validation loss decreased (-0.527764 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.2271170616149902
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
Validation loss decreased (-0.633321 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 1.2179245948791504
Epoch: 6, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.874 Vali Acc: 0.739 Test Loss: 0.874 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.327934980392456
Epoch: 7, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 1.474219799041748
Epoch: 8, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783327).  Saving model ...
Epoch: 9 cost time: 1.3438546657562256
Epoch: 9, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.578 Vali Acc: 0.817 Test Loss: 0.578 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 1.173379898071289
Epoch: 10, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.21209716796875
Epoch: 11, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.1830549240112305
Epoch: 12, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.432 Vali Acc: 0.839 Test Loss: 0.432 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.2014217376708984
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.407029151916504
Epoch: 14, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 1.1489615440368652
Epoch: 15, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2406177520751953
Epoch: 16, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.1516690254211426
Epoch: 17, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.2613332271575928
Epoch: 18, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3583347797393799
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2760186195373535
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.1369297504425049
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2568602561950684
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.249500036239624
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1381094455718994
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5295889377593994
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.249 Vali Acc: 0.878 Test Loss: 0.249 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1664438247680664
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1122899055480957
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6978769302368164
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2780165672302246
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 30 cost time: 1.222712516784668
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5425164699554443
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.444155216217041
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2534911632537842
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.241060733795166
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0905373096466064
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1320278644561768
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.878 Test Loss: 0.229 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1574382781982422
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 38 cost time: 1.2031502723693848
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.407418966293335
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3387525081634521
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.878 Test Loss: 0.233 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2421185970306396
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.878 Test Loss: 0.226 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.313826084136963
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.872 Test Loss: 0.233 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2047224044799805
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.878 Test Loss: 0.231 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2718422412872314
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2574210166931152
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.883 Test Loss: 0.221 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4007389545440674
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.342085838317871
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.883 Test Loss: 0.234 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 119456
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.762144088745117
Epoch: 1, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.712 Vali Acc: 0.239 Test Loss: 1.712 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 1.139136791229248
Epoch: 2, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.553 Vali Acc: 0.433 Test Loss: 1.553 Test Acc: 0.433
Validation loss decreased (-0.238872 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 1.1122300624847412
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.368 Vali Acc: 0.561 Test Loss: 1.368 Test Acc: 0.561
Validation loss decreased (-0.433318 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 1.137500524520874
Epoch: 4, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.175 Vali Acc: 0.656 Test Loss: 1.175 Test Acc: 0.656
Validation loss decreased (-0.561097 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.374403953552246
Epoch: 5, Steps: 12 | Train Loss: 1.051 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.655544 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.4476850032806396
Epoch: 6, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.820 Vali Acc: 0.778 Test Loss: 0.820 Test Acc: 0.778
Validation loss decreased (-0.749990 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 1.2266552448272705
Epoch: 7, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 1.5248491764068604
Epoch: 8, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.0579860210418701
Epoch: 9, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.521 Vali Acc: 0.817 Test Loss: 0.521 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 1.116377592086792
Epoch: 10, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.468 Vali Acc: 0.839 Test Loss: 0.468 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.273742437362671
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 1.2072412967681885
Epoch: 12, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3640851974487305
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0485999584197998
Epoch: 14, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0420429706573486
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.1584277153015137
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.327566385269165
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 0.9715991020202637
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 1.1530208587646484
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.2055470943450928
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1189346313476562
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.1247539520263672
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1706762313842773
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.145512342453003
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2518081665039062
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.1986689567565918
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6172518730163574
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2062432765960693
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.319460153579712
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2997379302978516
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.282613754272461
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1232211589813232
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1395902633666992
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0013790130615234
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1473503112792969
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.894 Test Loss: 0.202 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 118432
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2075109481811523
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.782 Vali Acc: 0.239 Test Loss: 1.782 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 1.0690953731536865
Epoch: 2, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.640 Vali Acc: 0.411 Test Loss: 1.640 Test Acc: 0.411
Validation loss decreased (-0.238871 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 0.9913640022277832
Epoch: 3, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.475 Vali Acc: 0.544 Test Loss: 1.475 Test Acc: 0.544
Validation loss decreased (-0.411095 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.0223352909088135
Epoch: 4, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.301 Vali Acc: 0.661 Test Loss: 1.301 Test Acc: 0.661
Validation loss decreased (-0.544430 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 1.0062644481658936
Epoch: 5, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.129 Vali Acc: 0.694 Test Loss: 1.129 Test Acc: 0.694
Validation loss decreased (-0.661098 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.0693480968475342
Epoch: 6, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.981 Vali Acc: 0.706 Test Loss: 0.981 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 1.2252607345581055
Epoch: 7, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.834 Vali Acc: 0.761 Test Loss: 0.834 Test Acc: 0.761
Validation loss decreased (-0.705546 --> -0.761103).  Saving model ...
Epoch: 8 cost time: 0.9602072238922119
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.716 Vali Acc: 0.778 Test Loss: 0.716 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 9 cost time: 0.8425264358520508
Epoch: 9, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.022831916809082
Epoch: 10, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 0.9631497859954834
Epoch: 11, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.8095736503601074
Epoch: 12, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.062293291091919
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 14 cost time: 0.851945161819458
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9122841358184814
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 0.9042935371398926
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905552).  Saving model ...
Epoch: 17 cost time: 1.0627014636993408
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 18 cost time: 0.9866466522216797
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.0797533988952637
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 0.9990384578704834
Epoch: 20, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0354671478271484
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1318409442901611
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0041675567626953
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.9076969623565674
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0745985507965088
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.873976469039917
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1770293712615967
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8251123428344727
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0701899528503418
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0643374919891357
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0878329277038574
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0152511596679688
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.99322509765625
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 116384
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6759355068206787
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.784 Vali Acc: 0.239 Test Loss: 1.784 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 1.109961748123169
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.623 Vali Acc: 0.344 Test Loss: 1.623 Test Acc: 0.344
Validation loss decreased (-0.238871 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 1.0316483974456787
Epoch: 3, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.435 Vali Acc: 0.533 Test Loss: 1.435 Test Acc: 0.533
Validation loss decreased (-0.344428 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 1.048149585723877
Epoch: 4, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.226 Vali Acc: 0.606 Test Loss: 1.226 Test Acc: 0.606
Validation loss decreased (-0.533319 --> -0.605543).  Saving model ...
Epoch: 5 cost time: 1.0614879131317139
Epoch: 5, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.605543 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 0.9659698009490967
Epoch: 6, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.870 Vali Acc: 0.683 Test Loss: 0.870 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.0324397087097168
Epoch: 7, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 1.3307640552520752
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.653 Vali Acc: 0.733 Test Loss: 0.653 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.1777844429016113
Epoch: 9, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 1.135493516921997
Epoch: 10, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 0.9658036231994629
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.487 Vali Acc: 0.811 Test Loss: 0.487 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.9188826084136963
Epoch: 12, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.42386794090271
Epoch: 13, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.2480645179748535
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 0.9538431167602539
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0362389087677002
Epoch: 16, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 1.0424928665161133
Epoch: 17, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 0.9847276210784912
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9662778377532959
Epoch: 19, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.1246016025543213
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.1553356647491455
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8564069271087646
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9088947772979736
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 0.8956074714660645
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.0174505710601807
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 1.0253140926361084
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8390305042266846
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 28 cost time: 1.2287273406982422
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 1.1794898509979248
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9274330139160156
Epoch: 30, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.128159761428833
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 32 cost time: 0.997560977935791
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9283618927001953
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.927924394607544
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.9962937831878662
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0847530364990234
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9753725528717041
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9866642951965332
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0199599266052246
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.883 Test Loss: 0.228 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7989037036895752
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3806054592132568
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.883 Test Loss: 0.235 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.142958402633667
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.942863941192627
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9792382717132568
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 115360
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.156320571899414
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.741 Vali Acc: 0.267 Test Loss: 1.741 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.8256247043609619
Epoch: 2, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.580 Vali Acc: 0.394 Test Loss: 1.580 Test Acc: 0.394
Validation loss decreased (-0.266649 --> -0.394429).  Saving model ...
Epoch: 3 cost time: 0.8728864192962646
Epoch: 3, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.380 Vali Acc: 0.578 Test Loss: 1.380 Test Acc: 0.578
Validation loss decreased (-0.394429 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.8740472793579102
Epoch: 4, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.174 Vali Acc: 0.694 Test Loss: 1.174 Test Acc: 0.694
Validation loss decreased (-0.577764 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 1.2500202655792236
Epoch: 5, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.8236515522003174
Epoch: 6, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 1.068223476409912
Epoch: 7, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 0.9473705291748047
Epoch: 8, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.577 Vali Acc: 0.794 Test Loss: 0.577 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 0.8505823612213135
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
Validation loss decreased (-0.794439 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 0.9440810680389404
Epoch: 10, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.452 Vali Acc: 0.839 Test Loss: 0.452 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.062882900238037
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 0.8436884880065918
Epoch: 12, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.8239827156066895
Epoch: 13, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 0.7514863014221191
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9922864437103271
Epoch: 15, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 0.8162906169891357
Epoch: 16, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.8494889736175537
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 0.8706169128417969
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.8894848823547363
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 0.8785362243652344
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8336310386657715
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8695509433746338
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.853609561920166
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8604519367218018
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8875811100006104
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.7799067497253418
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.8585898876190186
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 1.1761090755462646
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8878507614135742
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1144189834594727
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1431028842926025
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.9734113216400146
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0530943870544434
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 0.9230475425720215
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0891087055206299
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0058159828186035
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0997216701507568
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1166775226593018
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.906 Test Loss: 0.195 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1790845394134521
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8137121200561523
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.80660080909729
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0494959354400635
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9006152153015137
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 114336
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.498769760131836
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.834 Vali Acc: 0.183 Test Loss: 1.834 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 0.7526094913482666
Epoch: 2, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.668 Vali Acc: 0.394 Test Loss: 1.668 Test Acc: 0.394
Validation loss decreased (-0.183315 --> -0.394428).  Saving model ...
Epoch: 3 cost time: 1.038193941116333
Epoch: 3, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.394428 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.941096305847168
Epoch: 4, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
Validation loss decreased (-0.533319 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.8194358348846436
Epoch: 5, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.046 Vali Acc: 0.711 Test Loss: 1.046 Test Acc: 0.711
Validation loss decreased (-0.649987 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 0.88226318359375
Epoch: 6, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744436).  Saving model ...
Epoch: 7 cost time: 0.7504823207855225
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8380792140960693
Epoch: 8, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
Validation loss decreased (-0.744436 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.006474494934082
Epoch: 9, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.535 Vali Acc: 0.806 Test Loss: 0.535 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 0.8410038948059082
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
Validation loss decreased (-0.805550 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 0.8992190361022949
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 0.746389627456665
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
Validation loss decreased (-0.866662 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 0.7615487575531006
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 14 cost time: 0.7231111526489258
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.781358003616333
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.8161771297454834
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7965736389160156
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.8227198123931885
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7889511585235596
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.8592686653137207
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8147308826446533
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8190219402313232
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.926257848739624
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9219613075256348
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.931222677230835
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8221194744110107
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9479920864105225
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9771387577056885
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8058958053588867
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7870008945465088
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 113312
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5582759380340576
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.834 Vali Acc: 0.183 Test Loss: 1.834 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 0.7355096340179443
Epoch: 2, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.668 Vali Acc: 0.394 Test Loss: 1.668 Test Acc: 0.394
Validation loss decreased (-0.183315 --> -0.394428).  Saving model ...
Epoch: 3 cost time: 0.7281866073608398
Epoch: 3, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.394428 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.8624916076660156
Epoch: 4, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
Validation loss decreased (-0.533319 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.872765064239502
Epoch: 5, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.046 Vali Acc: 0.711 Test Loss: 1.046 Test Acc: 0.711
Validation loss decreased (-0.649987 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 0.7460451126098633
Epoch: 6, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744436).  Saving model ...
Epoch: 7 cost time: 0.7517752647399902
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8185830116271973
Epoch: 8, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
Validation loss decreased (-0.744436 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.8716564178466797
Epoch: 9, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.535 Vali Acc: 0.806 Test Loss: 0.535 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 0.9819293022155762
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
Validation loss decreased (-0.805550 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 0.8102543354034424
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 0.8956151008605957
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
Validation loss decreased (-0.866662 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 0.9192259311676025
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 14 cost time: 0.8200101852416992
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.8343799114227295
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.8471591472625732
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0544636249542236
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.9862372875213623
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7633066177368164
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.83628249168396
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8965661525726318
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.840510368347168
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8626804351806641
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9961602687835693
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.78841233253479
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9800090789794922
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9007649421691895
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8257908821105957
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8298578262329102
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7860524654388428
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 113312
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0593321323394775
Epoch: 1, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.594 Vali Acc: 0.344 Test Loss: 1.594 Test Acc: 0.344
Validation loss decreased (inf --> -0.344429).  Saving model ...
Epoch: 2 cost time: 1.1378583908081055
Epoch: 2, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.320 Vali Acc: 0.606 Test Loss: 1.320 Test Acc: 0.606
Validation loss decreased (-0.344429 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 1.0295026302337646
Epoch: 3, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.090 Vali Acc: 0.739 Test Loss: 1.090 Test Acc: 0.739
Validation loss decreased (-0.605542 --> -0.738878).  Saving model ...
Epoch: 4 cost time: 1.1100702285766602
Epoch: 4, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
Validation loss decreased (-0.738878 --> -0.783324).  Saving model ...
Epoch: 5 cost time: 1.0995326042175293
Epoch: 5, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.738 Vali Acc: 0.828 Test Loss: 0.738 Test Acc: 0.828
Validation loss decreased (-0.783324 --> -0.827770).  Saving model ...
Epoch: 6 cost time: 1.1261732578277588
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 1.2453927993774414
Epoch: 7, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0660474300384521
Epoch: 8, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
Validation loss decreased (-0.833327 --> -0.866662).  Saving model ...
Epoch: 9 cost time: 1.0206122398376465
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6880123615264893
Epoch: 10, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.383 Vali Acc: 0.872 Test Loss: 0.383 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 11 cost time: 1.2608203887939453
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.1432218551635742
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.3001201152801514
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1988129615783691
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.0590276718139648
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.4316847324371338
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6516821384429932
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.163830041885376
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4483680725097656
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3248090744018555
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.014404296875
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.044940710067749
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.004267692565918
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.031250238418579
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.282466173171997
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3935317993164062
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2719674110412598
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.0022587776184082
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0490984916687012
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1378374099731445
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1590251922607422
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9318952560424805
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1034796237945557
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3449699878692627
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.129967212677002
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2419183254241943
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.220003604888916
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9966678619384766
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1083922386169434
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4119455814361572
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3381123542785645
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.435196876525879
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3823914527893066
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3838555812835693
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.44950270652771
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1921110153198242
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 119212
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8418166637420654
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.679 Vali Acc: 0.350 Test Loss: 1.679 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 1.1401278972625732
Epoch: 2, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.353 Vali Acc: 0.561 Test Loss: 1.353 Test Acc: 0.561
Validation loss decreased (-0.349983 --> -0.561098).  Saving model ...
Epoch: 3 cost time: 1.567040205001831
Epoch: 3, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.092 Vali Acc: 0.683 Test Loss: 1.092 Test Acc: 0.683
Validation loss decreased (-0.561098 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 1.2612700462341309
Epoch: 4, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.892 Vali Acc: 0.772 Test Loss: 0.892 Test Acc: 0.772
Validation loss decreased (-0.683322 --> -0.772213).  Saving model ...
Epoch: 5 cost time: 1.1256482601165771
Epoch: 5, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3328933715820312
Epoch: 6, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.772213 --> -0.822216).  Saving model ...
Epoch: 7 cost time: 1.1146466732025146
Epoch: 7, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.539 Vali Acc: 0.794 Test Loss: 0.539 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3528447151184082
Epoch: 8, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827773).  Saving model ...
Epoch: 9 cost time: 1.0297296047210693
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 1.0129082202911377
Epoch: 10, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 0.9550333023071289
Epoch: 11, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 0.9615585803985596
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0057907104492188
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.0707173347473145
Epoch: 14, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2997913360595703
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2840917110443115
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2385759353637695
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2349622249603271
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.2243330478668213
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 0.940140962600708
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0811502933502197
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.1431868076324463
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.280334234237671
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.865880012512207
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8928158283233643
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0229730606079102
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3265819549560547
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3534395694732666
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.328260898590088
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0030672550201416
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9706041812896729
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1986091136932373
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.374223232269287
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 118188
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6801209449768066
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.715 Vali Acc: 0.317 Test Loss: 1.715 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 0.8537182807922363
Epoch: 2, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.427 Vali Acc: 0.517 Test Loss: 1.427 Test Acc: 0.517
Validation loss decreased (-0.316650 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 1.1835145950317383
Epoch: 3, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.169 Vali Acc: 0.678 Test Loss: 1.169 Test Acc: 0.678
Validation loss decreased (-0.516652 --> -0.677766).  Saving model ...
Epoch: 4 cost time: 0.9243700504302979
Epoch: 4, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
Validation loss decreased (-0.677766 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.0663211345672607
Epoch: 5, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772215).  Saving model ...
Epoch: 6 cost time: 1.0114643573760986
Epoch: 6, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.772215 --> -0.844438).  Saving model ...
Epoch: 7 cost time: 0.9104084968566895
Epoch: 7, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 0.9106378555297852
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
Validation loss decreased (-0.855550 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 1.0428190231323242
Epoch: 9, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.8725299835205078
Epoch: 10, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9357988834381104
Epoch: 11, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8221051692962646
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.838054895401001
Epoch: 13, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7809860706329346
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.8027682304382324
Epoch: 15, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.893449068069458
Epoch: 16, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9547491073608398
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0912282466888428
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9717726707458496
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.1000394821166992
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.7969489097595215
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9403412342071533
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9987976551055908
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8419296741485596
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8828177452087402
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.8384959697723389
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9690525531768799
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8856620788574219
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9590599536895752
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9099152088165283
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 0.8856256008148193
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7988896369934082
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7907254695892334
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0086114406585693
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7782347202301025
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9103066921234131
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0649700164794922
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8419289588928223
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9378535747528076
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8262166976928711
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 116140
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5871551036834717
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.698 Vali Acc: 0.256 Test Loss: 1.698 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.9583024978637695
Epoch: 2, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.392 Vali Acc: 0.572 Test Loss: 1.392 Test Acc: 0.572
Validation loss decreased (-0.255539 --> -0.572208).  Saving model ...
Epoch: 3 cost time: 0.8502461910247803
Epoch: 3, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.133 Vali Acc: 0.661 Test Loss: 1.133 Test Acc: 0.661
Validation loss decreased (-0.572208 --> -0.661100).  Saving model ...
Epoch: 4 cost time: 1.161576271057129
Epoch: 4, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.907 Vali Acc: 0.739 Test Loss: 0.907 Test Acc: 0.739
Validation loss decreased (-0.661100 --> -0.738880).  Saving model ...
Epoch: 5 cost time: 1.053398609161377
Epoch: 5, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 6 cost time: 0.9023966789245605
Epoch: 6, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.629 Vali Acc: 0.817 Test Loss: 0.629 Test Acc: 0.817
Validation loss decreased (-0.761104 --> -0.816660).  Saving model ...
Epoch: 7 cost time: 0.9557526111602783
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.539 Vali Acc: 0.806 Test Loss: 0.539 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.050257921218872
Epoch: 8, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.469 Vali Acc: 0.806 Test Loss: 0.469 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8687264919281006
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.436 Vali Acc: 0.839 Test Loss: 0.436 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 0.9206516742706299
Epoch: 10, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 0.9070389270782471
Epoch: 11, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 0.81854248046875
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.966916561126709
Epoch: 13, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8568284511566162
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.0712156295776367
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7818670272827148
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9286277294158936
Epoch: 17, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.836822509765625
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.913712739944458
Epoch: 19, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1322107315063477
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.0479261875152588
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0802130699157715
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8883829116821289
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 0.868943452835083
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 0.8706474304199219
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 0.92547607421875
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.040804386138916
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8793232440948486
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7344820499420166
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7707023620605469
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0525217056274414
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8687565326690674
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9680099487304688
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7866687774658203
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9405264854431152
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 115116
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4792072772979736
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.701 Vali Acc: 0.272 Test Loss: 1.701 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 0.7529339790344238
Epoch: 2, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.441 Vali Acc: 0.417 Test Loss: 1.441 Test Acc: 0.417
Validation loss decreased (-0.272205 --> -0.416652).  Saving model ...
Epoch: 3 cost time: 0.6970837116241455
Epoch: 3, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.175 Vali Acc: 0.633 Test Loss: 1.175 Test Acc: 0.633
Validation loss decreased (-0.416652 --> -0.633322).  Saving model ...
Epoch: 4 cost time: 0.6662807464599609
Epoch: 4, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
Validation loss decreased (-0.633322 --> -0.716657).  Saving model ...
Epoch: 5 cost time: 1.0182688236236572
Epoch: 5, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.750 Vali Acc: 0.806 Test Loss: 0.750 Test Acc: 0.806
Validation loss decreased (-0.716657 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 1.0138225555419922
Epoch: 6, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827772).  Saving model ...
Epoch: 7 cost time: 0.9981975555419922
Epoch: 7, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.9599626064300537
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.0352983474731445
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 0.9798657894134521
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 0.8512904644012451
Epoch: 11, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 0.9554412364959717
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 1.1965887546539307
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.350 Vali Acc: 0.878 Test Loss: 0.350 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 1.0341484546661377
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9499835968017578
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 1.3050343990325928
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.095435380935669
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 1.1910185813903809
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8928477764129639
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 1.0226554870605469
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3463611602783203
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1519653797149658
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 1.1473515033721924
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0456910133361816
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9847784042358398
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9428260326385498
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9627940654754639
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.894991397857666
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0401644706726074
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2757105827331543
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.337 Vali Acc: 0.878 Test Loss: 0.337 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.046659231185913
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1384549140930176
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 114092
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.616450309753418
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.740 Vali Acc: 0.228 Test Loss: 1.740 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 0.6849002838134766
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.449 Vali Acc: 0.522 Test Loss: 1.449 Test Acc: 0.522
Validation loss decreased (-0.227760 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 0.9225773811340332
Epoch: 3, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.160 Vali Acc: 0.700 Test Loss: 1.160 Test Acc: 0.700
Validation loss decreased (-0.522208 --> -0.699988).  Saving model ...
Epoch: 4 cost time: 0.8295564651489258
Epoch: 4, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 0.8618597984313965
Epoch: 5, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.773 Vali Acc: 0.806 Test Loss: 0.773 Test Acc: 0.806
Validation loss decreased (-0.733324 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.6189112663269043
Epoch: 6, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.805548 --> -0.844438).  Saving model ...
Epoch: 7 cost time: 0.7260255813598633
Epoch: 7, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 0.722273588180542
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 9 cost time: 0.76198410987854
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.9629106521606445
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8376762866973877
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9791140556335449
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0274028778076172
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1178383827209473
Epoch: 14, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.028986930847168
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0440196990966797
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9064044952392578
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9237227439880371
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8393607139587402
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 113068
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5366432666778564
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.740 Vali Acc: 0.228 Test Loss: 1.740 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 0.8310263156890869
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.449 Vali Acc: 0.522 Test Loss: 1.449 Test Acc: 0.522
Validation loss decreased (-0.227760 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 0.8455085754394531
Epoch: 3, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.160 Vali Acc: 0.700 Test Loss: 1.160 Test Acc: 0.700
Validation loss decreased (-0.522208 --> -0.699988).  Saving model ...
Epoch: 4 cost time: 0.9097836017608643
Epoch: 4, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 0.8122527599334717
Epoch: 5, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.773 Vali Acc: 0.806 Test Loss: 0.773 Test Acc: 0.806
Validation loss decreased (-0.733324 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.835115909576416
Epoch: 6, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.805548 --> -0.844438).  Saving model ...
Epoch: 7 cost time: 0.8731064796447754
Epoch: 7, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 0.825434684753418
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 9 cost time: 1.0421411991119385
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.805687427520752
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8797392845153809
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8819210529327393
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0211694240570068
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0442650318145752
Epoch: 14, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8429014682769775
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8025515079498291
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9082975387573242
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0648422241210938
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0518453121185303
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 113068
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.689476251602173
Epoch: 1, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.807 Vali Acc: 0.172 Test Loss: 1.807 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.0729453563690186
Epoch: 2, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.665 Vali Acc: 0.328 Test Loss: 1.665 Test Acc: 0.328
Validation loss decreased (-0.172204 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 1.1332366466522217
Epoch: 3, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.491 Vali Acc: 0.539 Test Loss: 1.491 Test Acc: 0.539
Validation loss decreased (-0.327761 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 1.072901964187622
Epoch: 4, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.308 Vali Acc: 0.628 Test Loss: 1.308 Test Acc: 0.628
Validation loss decreased (-0.538874 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 1.1082839965820312
Epoch: 5, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.121 Vali Acc: 0.683 Test Loss: 1.121 Test Acc: 0.683
Validation loss decreased (-0.627765 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 1.012007713317871
Epoch: 6, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.948 Vali Acc: 0.706 Test Loss: 0.948 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 1.2085249423980713
Epoch: 7, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.798 Vali Acc: 0.772 Test Loss: 0.798 Test Acc: 0.772
Validation loss decreased (-0.705546 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 1.2584381103515625
Epoch: 8, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 1.3468174934387207
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.612 Vali Acc: 0.772 Test Loss: 0.612 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3346378803253174
Epoch: 10, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4578375816345215
Epoch: 11, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
Validation loss decreased (-0.788882 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 1.3065204620361328
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2134921550750732
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.421 Vali Acc: 0.828 Test Loss: 0.421 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.1049954891204834
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.1451120376586914
Epoch: 15, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 1.224501609802246
Epoch: 16, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.1490552425384521
Epoch: 17, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.16202712059021
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.157670259475708
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.1074349880218506
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.1123464107513428
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.1624197959899902
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.0554375648498535
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.1971490383148193
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 1.0541648864746094
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0243151187896729
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.0283918380737305
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 1.0430116653442383
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1123032569885254
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.074169635772705
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2353944778442383
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.122640609741211
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2175495624542236
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0069305896759033
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 1.20335054397583
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0956737995147705
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 1.2220709323883057
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 38 cost time: 0.9321324825286865
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1617963314056396
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.040513038635254
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1446483135223389
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0293302536010742
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0357155799865723
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.956348180770874
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0768840312957764
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.192887544631958
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9952170848846436
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3805327415466309
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.142704963684082
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1201472282409668
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.126755714416504
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9686098098754883
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.1303892135620117
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 65020
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8646678924560547
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.767 Vali Acc: 0.200 Test Loss: 1.767 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.4120750427246094
Epoch: 2, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.621 Vali Acc: 0.378 Test Loss: 1.621 Test Acc: 0.378
Validation loss decreased (-0.199982 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 1.2880170345306396
Epoch: 3, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.441 Vali Acc: 0.556 Test Loss: 1.441 Test Acc: 0.556
Validation loss decreased (-0.377762 --> -0.555541).  Saving model ...
Epoch: 4 cost time: 0.9028029441833496
Epoch: 4, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.250 Vali Acc: 0.672 Test Loss: 1.250 Test Acc: 0.672
Validation loss decreased (-0.555541 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.0935969352722168
Epoch: 5, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.062 Vali Acc: 0.672 Test Loss: 1.062 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 1.2119698524475098
Epoch: 6, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 1.288264513015747
Epoch: 7, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.758 Vali Acc: 0.739 Test Loss: 0.758 Test Acc: 0.739
Validation loss decreased (-0.694436 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 1.0551092624664307
Epoch: 8, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.738881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.2434606552124023
Epoch: 9, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.580 Vali Acc: 0.794 Test Loss: 0.580 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 1.4451358318328857
Epoch: 10, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
Validation loss decreased (-0.794439 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.4792044162750244
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.475 Vali Acc: 0.817 Test Loss: 0.475 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.288053035736084
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.1398420333862305
Epoch: 13, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 1.352351188659668
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.1947202682495117
Epoch: 15, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.3128135204315186
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 1.2271502017974854
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1119270324707031
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3039038181304932
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.1300861835479736
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.2530601024627686
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1358213424682617
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0596280097961426
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.239976167678833
Epoch: 24, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.195918321609497
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 1.2389256954193115
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1936206817626953
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1106109619140625
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 1.2046022415161133
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2576775550842285
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.265000581741333
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.119736671447754
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2386224269866943
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3153223991394043
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4094295501708984
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0823376178741455
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3041367530822754
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.365159273147583
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.894 Test Loss: 0.195 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 64508
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7587802410125732
Epoch: 1, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.789 Vali Acc: 0.189 Test Loss: 1.789 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.040891408920288
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.624 Vali Acc: 0.344 Test Loss: 1.624 Test Acc: 0.344
Validation loss decreased (-0.188871 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 1.020794153213501
Epoch: 3, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.435 Vali Acc: 0.522 Test Loss: 1.435 Test Acc: 0.522
Validation loss decreased (-0.344428 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 0.9496397972106934
Epoch: 4, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.253 Vali Acc: 0.611 Test Loss: 1.253 Test Acc: 0.611
Validation loss decreased (-0.522208 --> -0.611099).  Saving model ...
Epoch: 5 cost time: 1.2969822883605957
Epoch: 5, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.080 Vali Acc: 0.689 Test Loss: 1.080 Test Acc: 0.689
Validation loss decreased (-0.611099 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 0.9060180187225342
Epoch: 6, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.921 Vali Acc: 0.744 Test Loss: 0.921 Test Acc: 0.744
Validation loss decreased (-0.688878 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.1621809005737305
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.781 Vali Acc: 0.739 Test Loss: 0.781 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0492784976959229
Epoch: 8, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 0.9570002555847168
Epoch: 9, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.598 Vali Acc: 0.778 Test Loss: 0.598 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 0.99723219871521
Epoch: 10, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.07399320602417
Epoch: 11, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.495 Vali Acc: 0.800 Test Loss: 0.495 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 1.0286192893981934
Epoch: 12, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 1.191864252090454
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.0208344459533691
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.9442284107208252
Epoch: 15, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0256366729736328
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 0.9416046142578125
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 0.9356808662414551
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1283183097839355
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9709913730621338
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.8623874187469482
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 0.9687366485595703
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0222020149230957
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.9349551200866699
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0268733501434326
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1957385540008545
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0447447299957275
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8384602069854736
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.05385160446167
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9481487274169922
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7973847389221191
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.976473331451416
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.202 Vali Acc: 0.894 Test Loss: 0.202 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8763759136199951
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.9331767559051514
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 0.8720395565032959
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 36 cost time: 0.85805344581604
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9857604503631592
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.9843461513519287
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.939 Test Loss: 0.184 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 39 cost time: 1.0616776943206787
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8818538188934326
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.939 Test Loss: 0.178 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 41 cost time: 0.8634867668151855
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9873967170715332
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8707244396209717
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0265944004058838
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.811316967010498
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8816952705383301
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8132014274597168
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9050798416137695
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 49 cost time: 0.8924484252929688
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9604401588439941
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 51 cost time: 0.9827420711517334
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.939 Test Loss: 0.164 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 52 cost time: 0.8448915481567383
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9867753982543945
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 54 cost time: 0.8356747627258301
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.939 Test Loss: 0.164 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8519220352172852
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 56 cost time: 0.9208357334136963
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.939 Test Loss: 0.162 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 57 cost time: 0.893996000289917
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.811814546585083
Epoch: 58, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.939 Test Loss: 0.161 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 59 cost time: 1.0917649269104004
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9266722202301025
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.939 Test Loss: 0.162 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8939986228942871
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.939 Test Loss: 0.159 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 62 cost time: 1.0758047103881836
Epoch: 62, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 63 cost time: 0.9037387371063232
Epoch: 63, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.939 Test Loss: 0.157 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 64 cost time: 0.8773212432861328
Epoch: 64, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.939 Test Loss: 0.156 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 65 cost time: 0.8161001205444336
Epoch: 65, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9135620594024658
Epoch: 66, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2329716682434082
Epoch: 67, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.939 Test Loss: 0.157 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.928826093673706
Epoch: 68, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.939 Test Loss: 0.156 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 69 cost time: 0.974550724029541
Epoch: 69, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.939 Test Loss: 0.155 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 70 cost time: 1.0242316722869873
Epoch: 70, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 71 cost time: 0.8590052127838135
Epoch: 71, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 72 cost time: 0.8920576572418213
Epoch: 72, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.939 Test Loss: 0.152 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 73 cost time: 0.8823363780975342
Epoch: 73, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9085869789123535
Epoch: 74, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.939 Test Loss: 0.154 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8699204921722412
Epoch: 75, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.8896515369415283
Epoch: 76, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.939 Test Loss: 0.154 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.9145574569702148
Epoch: 77, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.939 Test Loss: 0.151 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 78 cost time: 0.8515276908874512
Epoch: 78, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 79 cost time: 0.8483607769012451
Epoch: 79, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.907902717590332
Epoch: 80, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 81 cost time: 0.7665133476257324
Epoch: 81, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.02592134475708
Epoch: 82, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.939 Test Loss: 0.152 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.0474674701690674
Epoch: 83, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.939 Test Loss: 0.151 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0526106357574463
Epoch: 84, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.952110767364502
Epoch: 85, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.8921401500701904
Epoch: 86, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.9392316341400146
Epoch: 87, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.8817596435546875
Epoch: 88, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 89 cost time: 0.9336142539978027
Epoch: 89, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 90 cost time: 1.0087220668792725
Epoch: 90, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.103351354598999
Epoch: 91, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9527111053466797
Epoch: 92, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.1146540641784668
Epoch: 93, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.939 Test Loss: 0.147 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 94 cost time: 0.9282474517822266
Epoch: 94, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1275265216827393
Epoch: 95, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.9945166110992432
Epoch: 96, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.1300899982452393
Epoch: 97, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 1.2138867378234863
Epoch: 98, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.939 Test Loss: 0.149 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 1.061401128768921
Epoch: 99, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 1.054720163345337
Epoch: 100, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 63484
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1264119148254395
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.759 Vali Acc: 0.222 Test Loss: 1.759 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.1098248958587646
Epoch: 2, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.605 Vali Acc: 0.394 Test Loss: 1.605 Test Acc: 0.394
Validation loss decreased (-0.222205 --> -0.394428).  Saving model ...
Epoch: 3 cost time: 1.1012029647827148
Epoch: 3, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.421 Vali Acc: 0.572 Test Loss: 1.421 Test Acc: 0.572
Validation loss decreased (-0.394428 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 0.9709439277648926
Epoch: 4, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.234 Vali Acc: 0.672 Test Loss: 1.234 Test Acc: 0.672
Validation loss decreased (-0.572208 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.0326745510101318
Epoch: 5, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.053 Vali Acc: 0.767 Test Loss: 1.053 Test Acc: 0.767
Validation loss decreased (-0.672210 --> -0.766656).  Saving model ...
Epoch: 6 cost time: 1.0965285301208496
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.894 Vali Acc: 0.767 Test Loss: 0.894 Test Acc: 0.767
Validation loss decreased (-0.766656 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 1.0480549335479736
Epoch: 7, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.762 Vali Acc: 0.778 Test Loss: 0.762 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 1.0261032581329346
Epoch: 8, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.0023467540740967
Epoch: 9, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 10 cost time: 0.8414766788482666
Epoch: 10, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.04807710647583
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.463 Vali Acc: 0.839 Test Loss: 0.463 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 12 cost time: 1.0885999202728271
Epoch: 12, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.9059934616088867
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.844 Test Loss: 0.394 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9516422748565674
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.888063907623291
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 0.9920129776000977
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 0.996143102645874
Epoch: 17, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1682283878326416
Epoch: 18, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.025937557220459
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.9432504177093506
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.9376728534698486
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.8531568050384521
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4146578311920166
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.2842833995819092
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.992333173751831
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.9204862117767334
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 1.080610990524292
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1645863056182861
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 0.9113821983337402
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9862372875213623
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8704285621643066
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3339765071868896
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1909565925598145
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8825051784515381
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8483343124389648
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 36 cost time: 0.9128415584564209
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2458751201629639
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0338318347930908
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9842965602874756
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0477120876312256
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0822811126708984
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.922 Test Loss: 0.174 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0014820098876953
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 43 cost time: 0.7995114326477051
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 44 cost time: 1.1168856620788574
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.020223617553711
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0166339874267578
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.038844347000122
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9639534950256348
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0290234088897705
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0939664840698242
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.939 Test Loss: 0.162 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 51 cost time: 1.0200307369232178
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 52 cost time: 0.8705546855926514
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.928 Test Loss: 0.160 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1392154693603516
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.928 Test Loss: 0.163 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.010507583618164
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.939 Test Loss: 0.160 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9112153053283691
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9693381786346436
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.074716329574585
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.080909252166748
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0819506645202637
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.933 Test Loss: 0.165 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9135456085205078
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9617269039154053
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.939 Test Loss: 0.167 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 62972
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8120031356811523
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.791 Vali Acc: 0.256 Test Loss: 1.791 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.8161492347717285
Epoch: 2, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.606 Vali Acc: 0.406 Test Loss: 1.606 Test Acc: 0.406
Validation loss decreased (-0.255538 --> -0.405539).  Saving model ...
Epoch: 3 cost time: 1.242774486541748
Epoch: 3, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.393 Vali Acc: 0.578 Test Loss: 1.393 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.9810421466827393
Epoch: 4, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.184 Vali Acc: 0.656 Test Loss: 1.184 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.7400872707366943
Epoch: 5, Steps: 12 | Train Loss: 1.028 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.655544 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 0.8594238758087158
Epoch: 6, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761103).  Saving model ...
Epoch: 7 cost time: 0.9642918109893799
Epoch: 7, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 1.0171825885772705
Epoch: 8, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.618 Vali Acc: 0.811 Test Loss: 0.618 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 0.9278233051300049
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.001309871673584
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.492 Vali Acc: 0.839 Test Loss: 0.492 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 0.8561186790466309
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 0.8344769477844238
Epoch: 12, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 0.9787850379943848
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 14 cost time: 0.8741660118103027
Epoch: 14, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.359 Vali Acc: 0.894 Test Loss: 0.359 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 0.914360523223877
Epoch: 15, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9394392967224121
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9357757568359375
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9465632438659668
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.0780034065246582
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 0.9736471176147461
Epoch: 20, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 0.9787890911102295
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 0.7340414524078369
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.7670066356658936
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8374118804931641
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8795177936553955
Epoch: 25, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9571154117584229
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0436341762542725
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.868668794631958
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.9447908401489258
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.7729496955871582
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8691375255584717
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7984886169433594
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.7880034446716309
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8992612361907959
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9358527660369873
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9686119556427002
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9977736473083496
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 38 cost time: 0.7381076812744141
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8395414352416992
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0125980377197266
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8702499866485596
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9679346084594727
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7031638622283936
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8807737827301025
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.771082878112793
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7510521411895752
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9429299831390381
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 62460
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4870972633361816
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.798 Vali Acc: 0.206 Test Loss: 1.798 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.8431048393249512
Epoch: 2, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.644 Vali Acc: 0.356 Test Loss: 1.644 Test Acc: 0.356
Validation loss decreased (-0.205538 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 0.7508673667907715
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.457 Vali Acc: 0.544 Test Loss: 1.457 Test Acc: 0.544
Validation loss decreased (-0.355539 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 0.6544833183288574
Epoch: 4, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.256 Vali Acc: 0.617 Test Loss: 1.256 Test Acc: 0.617
Validation loss decreased (-0.544430 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 0.7404665946960449
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.062 Vali Acc: 0.672 Test Loss: 1.062 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 0.7513604164123535
Epoch: 6, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.888 Vali Acc: 0.739 Test Loss: 0.888 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.9135146141052246
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.746 Vali Acc: 0.733 Test Loss: 0.746 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8283367156982422
Epoch: 8, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.738880 --> -0.783327).  Saving model ...
Epoch: 9 cost time: 0.7303681373596191
Epoch: 9, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.767 Test Loss: 0.559 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8806118965148926
Epoch: 10, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.499 Vali Acc: 0.806 Test Loss: 0.499 Test Acc: 0.806
Validation loss decreased (-0.783327 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 0.8865532875061035
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.459 Vali Acc: 0.828 Test Loss: 0.459 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.7258226871490479
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.9753520488739014
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.8434913158416748
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9443473815917969
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 0.7989420890808105
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9558186531066895
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.0735971927642822
Epoch: 18, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7291643619537354
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.8470520973205566
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7956631183624268
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8816697597503662
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.9740240573883057
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9559805393218994
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.2408804893493652
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9026787281036377
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.8745214939117432
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9308018684387207
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.053175449371338
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9825551509857178
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2929742336273193
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0087172985076904
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0619854927062988
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0139813423156738
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 0.7900793552398682
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7555890083312988
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8104438781738281
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8727245330810547
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 0.8013777732849121
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7740263938903809
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7492432594299316
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8024959564208984
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.872469425201416
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8936948776245117
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8650047779083252
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.791590690612793
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7160511016845703
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9264523983001709
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 61948
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9276907444000244
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.798 Vali Acc: 0.206 Test Loss: 1.798 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.8256821632385254
Epoch: 2, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.644 Vali Acc: 0.356 Test Loss: 1.644 Test Acc: 0.356
Validation loss decreased (-0.205538 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 0.772350549697876
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.457 Vali Acc: 0.544 Test Loss: 1.457 Test Acc: 0.544
Validation loss decreased (-0.355539 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 0.7801530361175537
Epoch: 4, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.256 Vali Acc: 0.617 Test Loss: 1.256 Test Acc: 0.617
Validation loss decreased (-0.544430 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 1.0573670864105225
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.062 Vali Acc: 0.672 Test Loss: 1.062 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 0.7974710464477539
Epoch: 6, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.888 Vali Acc: 0.739 Test Loss: 0.888 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.0190517902374268
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.746 Vali Acc: 0.733 Test Loss: 0.746 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.848721981048584
Epoch: 8, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.738880 --> -0.783327).  Saving model ...
Epoch: 9 cost time: 0.7796623706817627
Epoch: 9, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.767 Test Loss: 0.559 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1454298496246338
Epoch: 10, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.499 Vali Acc: 0.806 Test Loss: 0.499 Test Acc: 0.806
Validation loss decreased (-0.783327 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 0.9668827056884766
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.459 Vali Acc: 0.828 Test Loss: 0.459 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.8536417484283447
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.9992561340332031
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.9558284282684326
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7944674491882324
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 0.8552405834197998
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7682528495788574
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 0.8020975589752197
Epoch: 18, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.8179709911346436
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.0937960147857666
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8983488082885742
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0723481178283691
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.9916634559631348
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.140122413635254
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 0.9900729656219482
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8646607398986816
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.8776624202728271
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8325324058532715
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7831406593322754
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.8996431827545166
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.689387321472168
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7934741973876953
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.787747859954834
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9974243640899658
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 0.8969118595123291
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8246688842773438
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7789783477783203
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.679711103439331
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 0.7700662612915039
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7461166381835938
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7034733295440674
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7716386318206787
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8754932880401611
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8146843910217285
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9540135860443115
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9548952579498291
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8534026145935059
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7572624683380127
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 61948
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0268349647521973
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.866 Vali Acc: 0.150 Test Loss: 1.866 Test Acc: 0.150
Validation loss decreased (inf --> -0.149981).  Saving model ...
Epoch: 2 cost time: 1.0262413024902344
Epoch: 2, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.703 Vali Acc: 0.228 Test Loss: 1.703 Test Acc: 0.228
Validation loss decreased (-0.149981 --> -0.227761).  Saving model ...
Epoch: 3 cost time: 1.315401315689087
Epoch: 3, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.505 Vali Acc: 0.489 Test Loss: 1.505 Test Acc: 0.489
Validation loss decreased (-0.227761 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 1.4295332431793213
Epoch: 4, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.296 Vali Acc: 0.661 Test Loss: 1.296 Test Acc: 0.661
Validation loss decreased (-0.488874 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 1.052893877029419
Epoch: 5, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.9729540348052979
Epoch: 6, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.928 Vali Acc: 0.739 Test Loss: 0.928 Test Acc: 0.739
Validation loss decreased (-0.699989 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.2890303134918213
Epoch: 7, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
Validation loss decreased (-0.738880 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 1.1452891826629639
Epoch: 8, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
Validation loss decreased (-0.777770 --> -0.822216).  Saving model ...
Epoch: 9 cost time: 1.2342677116394043
Epoch: 9, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 1.1645550727844238
Epoch: 10, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 1.314910650253296
Epoch: 11, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 1.3275551795959473
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866662).  Saving model ...
Epoch: 13 cost time: 1.160801887512207
Epoch: 13, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
Validation loss decreased (-0.866662 --> -0.894440).  Saving model ...
Epoch: 14 cost time: 1.092576026916504
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5354409217834473
Epoch: 15, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
Validation loss decreased (-0.894440 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.1207408905029297
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3806791305541992
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.1729776859283447
Epoch: 18, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2262051105499268
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3029966354370117
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 21 cost time: 1.2216088771820068
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.320486068725586
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.0485198497772217
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.046783685684204
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 1.1832971572875977
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.1965420246124268
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 1.1620278358459473
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.216723918914795
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1593148708343506
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.238025426864624
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.068418264389038
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2317454814910889
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2272593975067139
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0076208114624023
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0830316543579102
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4633331298828125
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 64236
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7539212703704834
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.816 Vali Acc: 0.189 Test Loss: 1.816 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.9815430641174316
Epoch: 2, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.657 Vali Acc: 0.333 Test Loss: 1.657 Test Acc: 0.333
Validation loss decreased (-0.188871 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 1.1178653240203857
Epoch: 3, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.471 Vali Acc: 0.533 Test Loss: 1.471 Test Acc: 0.533
Validation loss decreased (-0.333317 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 1.1583199501037598
Epoch: 4, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.277 Vali Acc: 0.650 Test Loss: 1.277 Test Acc: 0.650
Validation loss decreased (-0.533319 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 1.3851170539855957
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.089 Vali Acc: 0.728 Test Loss: 1.089 Test Acc: 0.728
Validation loss decreased (-0.649987 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.3910207748413086
Epoch: 6, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.918 Vali Acc: 0.728 Test Loss: 0.918 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 1.0840797424316406
Epoch: 7, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.775 Vali Acc: 0.733 Test Loss: 0.775 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 1.2519645690917969
Epoch: 8, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777771).  Saving model ...
Epoch: 9 cost time: 1.7949297428131104
Epoch: 9, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.777771 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 1.0747098922729492
Epoch: 10, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 1.1017062664031982
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.066065788269043
Epoch: 12, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 1.172612190246582
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.386 Vali Acc: 0.883 Test Loss: 0.386 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 14 cost time: 1.0353500843048096
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.9931995868682861
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.283637523651123
Epoch: 16, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.530177354812622
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 1.049314260482788
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.1586787700653076
Epoch: 19, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.0471312999725342
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0331640243530273
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.9773073196411133
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 0.8899376392364502
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0643465518951416
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.350208044052124
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 1.3345794677734375
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3260552883148193
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2794208526611328
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.728513479232788
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2262189388275146
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1798136234283447
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.1693603992462158
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.912651538848877
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.038184642791748
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1780455112457275
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2622497081756592
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.922 Test Loss: 0.172 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.141552448272705
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.939 Test Loss: 0.160 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2999722957611084
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3151519298553467
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0316662788391113
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.939 Test Loss: 0.165 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1389458179473877
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9274327754974365
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 63724
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.646913528442383
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.708 Vali Acc: 0.294 Test Loss: 1.708 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.2498619556427002
Epoch: 2, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.575 Vali Acc: 0.417 Test Loss: 1.575 Test Acc: 0.417
Validation loss decreased (-0.294427 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.065650463104248
Epoch: 3, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.406 Vali Acc: 0.594 Test Loss: 1.406 Test Acc: 0.594
Validation loss decreased (-0.416651 --> -0.594430).  Saving model ...
Epoch: 4 cost time: 1.187743902206421
Epoch: 4, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.224 Vali Acc: 0.717 Test Loss: 1.224 Test Acc: 0.717
Validation loss decreased (-0.594430 --> -0.716654).  Saving model ...
Epoch: 5 cost time: 1.0415589809417725
Epoch: 5, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.039 Vali Acc: 0.739 Test Loss: 1.039 Test Acc: 0.739
Validation loss decreased (-0.716654 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 0.9517452716827393
Epoch: 6, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.872 Vali Acc: 0.772 Test Loss: 0.872 Test Acc: 0.772
Validation loss decreased (-0.738878 --> -0.772214).  Saving model ...
Epoch: 7 cost time: 1.0443181991577148
Epoch: 7, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.33998441696167
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 1.2241926193237305
Epoch: 9, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 0.9382030963897705
Epoch: 10, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.502 Vali Acc: 0.839 Test Loss: 0.502 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.0979046821594238
Epoch: 11, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.461 Vali Acc: 0.839 Test Loss: 0.461 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 12 cost time: 1.2434813976287842
Epoch: 12, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.9860517978668213
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 1.189620018005371
Epoch: 14, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.0766284465789795
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 1.166435956954956
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2618494033813477
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.1705710887908936
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 0.9977295398712158
Epoch: 19, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9797701835632324
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.1845393180847168
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.2893171310424805
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.3612852096557617
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.9047787189483643
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.113537073135376
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4063544273376465
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1099789142608643
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.0802090167999268
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 1.1143722534179688
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.3932137489318848
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0403568744659424
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0100188255310059
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 1.2043077945709229
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0648458003997803
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.047745704650879
Epoch: 35, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0489723682403564
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9526317119598389
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1039738655090332
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8875269889831543
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1017422676086426
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1316440105438232
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0622222423553467
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 62700
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.074481964111328
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.833 Vali Acc: 0.183 Test Loss: 1.833 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.0068187713623047
Epoch: 2, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.699 Vali Acc: 0.339 Test Loss: 1.699 Test Acc: 0.339
Validation loss decreased (-0.183315 --> -0.338872).  Saving model ...
Epoch: 3 cost time: 0.983975887298584
Epoch: 3, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.535 Vali Acc: 0.506 Test Loss: 1.535 Test Acc: 0.506
Validation loss decreased (-0.338872 --> -0.505540).  Saving model ...
Epoch: 4 cost time: 0.9637253284454346
Epoch: 4, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.361 Vali Acc: 0.644 Test Loss: 1.361 Test Acc: 0.644
Validation loss decreased (-0.505540 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 1.0352544784545898
Epoch: 5, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.186 Vali Acc: 0.733 Test Loss: 1.186 Test Acc: 0.733
Validation loss decreased (-0.644431 --> -0.733321).  Saving model ...
Epoch: 6 cost time: 1.1690962314605713
Epoch: 6, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.015 Vali Acc: 0.778 Test Loss: 1.015 Test Acc: 0.778
Validation loss decreased (-0.733321 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 1.1631207466125488
Epoch: 7, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.858 Vali Acc: 0.811 Test Loss: 0.858 Test Acc: 0.811
Validation loss decreased (-0.777768 --> -0.811103).  Saving model ...
Epoch: 8 cost time: 0.9691646099090576
Epoch: 8, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.734 Vali Acc: 0.822 Test Loss: 0.734 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 9 cost time: 0.9600563049316406
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 1.0152456760406494
Epoch: 10, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 1.2894949913024902
Epoch: 11, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.9379744529724121
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877773).  Saving model ...
Epoch: 13 cost time: 1.077960729598999
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 14 cost time: 0.8480451107025146
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 1.079010009765625
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 1.4847586154937744
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.184248685836792
Epoch: 17, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0380077362060547
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 1.1737189292907715
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4213178157806396
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.0100805759429932
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9207043647766113
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8852415084838867
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9230740070343018
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0222785472869873
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0723989009857178
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.8748908042907715
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 1.0382046699523926
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.9298136234283447
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.017024040222168
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.8753564357757568
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 32 cost time: 0.8917849063873291
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 1.179945468902588
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1895487308502197
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.057798147201538
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 0.9818551540374756
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 37 cost time: 1.0040452480316162
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 38 cost time: 0.9021129608154297
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8896379470825195
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 0.7611370086669922
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 41 cost time: 0.8456974029541016
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1484251022338867
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 43 cost time: 0.835017204284668
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9408478736877441
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7972273826599121
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8248164653778076
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0082125663757324
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9192290306091309
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.831974983215332
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9100143909454346
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0947768688201904
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1678390502929688
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 62188
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7150824069976807
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.749 Vali Acc: 0.283 Test Loss: 1.749 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 0.9623246192932129
Epoch: 2, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.598 Vali Acc: 0.433 Test Loss: 1.598 Test Acc: 0.433
Validation loss decreased (-0.283316 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 1.0838310718536377
Epoch: 3, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.415 Vali Acc: 0.544 Test Loss: 1.415 Test Acc: 0.544
Validation loss decreased (-0.433317 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.1196861267089844
Epoch: 4, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.214 Vali Acc: 0.672 Test Loss: 1.214 Test Acc: 0.672
Validation loss decreased (-0.544430 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 0.8916501998901367
Epoch: 5, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.024 Vali Acc: 0.728 Test Loss: 1.024 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 0.8815205097198486
Epoch: 6, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.855 Vali Acc: 0.778 Test Loss: 0.855 Test Acc: 0.778
Validation loss decreased (-0.727768 --> -0.777769).  Saving model ...
Epoch: 7 cost time: 1.100036859512329
Epoch: 7, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 1.1358895301818848
Epoch: 8, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.606 Vali Acc: 0.817 Test Loss: 0.606 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 0.9116032123565674
Epoch: 9, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.816661 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 1.1199731826782227
Epoch: 10, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.474 Vali Acc: 0.817 Test Loss: 0.474 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1264822483062744
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.439 Vali Acc: 0.828 Test Loss: 0.439 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.014723300933838
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 0.9829151630401611
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.378 Vali Acc: 0.878 Test Loss: 0.378 Test Acc: 0.878
Validation loss decreased (-0.844440 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 0.8049843311309814
Epoch: 14, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 0.8516521453857422
Epoch: 15, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8974292278289795
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1696810722351074
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9101829528808594
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8841872215270996
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8636417388916016
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.9186065196990967
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7882542610168457
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 0.8051691055297852
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.8472685813903809
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0152149200439453
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8983547687530518
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.0849173069000244
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9424152374267578
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.8797359466552734
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3126187324523926
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 31 cost time: 0.9793338775634766
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9519979953765869
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 33 cost time: 0.8764936923980713
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.013641119003296
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0697524547576904
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.044823169708252
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1222081184387207
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0617334842681885
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9716029167175293
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.9261054992675781
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1746032238006592
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.213566780090332
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9957876205444336
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8841533660888672
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0944948196411133
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3755559921264648
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2783479690551758
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 48 cost time: 0.9784328937530518
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0434620380401611
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.170943260192871
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9476649761199951
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.939 Test Loss: 0.244 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1678822040557861
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9325258731842041
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0814409255981445
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.109797716140747
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.156050682067871
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.8364367485046387
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 61676
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.999424457550049
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.729 Vali Acc: 0.256 Test Loss: 1.729 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.9710385799407959
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.593 Vali Acc: 0.400 Test Loss: 1.593 Test Acc: 0.400
Validation loss decreased (-0.255538 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.7532265186309814
Epoch: 3, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.419 Vali Acc: 0.567 Test Loss: 1.419 Test Acc: 0.567
Validation loss decreased (-0.399984 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 0.729163646697998
Epoch: 4, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.236 Vali Acc: 0.617 Test Loss: 1.236 Test Acc: 0.617
Validation loss decreased (-0.566652 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 0.8750860691070557
Epoch: 5, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.052 Vali Acc: 0.711 Test Loss: 1.052 Test Acc: 0.711
Validation loss decreased (-0.616654 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 0.7918705940246582
Epoch: 6, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.877 Vali Acc: 0.739 Test Loss: 0.877 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.8778896331787109
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.732 Vali Acc: 0.794 Test Loss: 0.732 Test Acc: 0.794
Validation loss decreased (-0.738880 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 0.7412497997283936
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.616 Vali Acc: 0.794 Test Loss: 0.616 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 0.7799892425537109
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.794438 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 0.7138259410858154
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 0.7222645282745361
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.420 Vali Acc: 0.839 Test Loss: 0.420 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7090413570404053
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.714301347732544
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.677588939666748
Epoch: 14, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6552231311798096
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8049392700195312
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.7770650386810303
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7464702129364014
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.8495292663574219
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8250901699066162
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7854530811309814
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8759322166442871
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9616184234619141
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7241084575653076
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7421627044677734
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7440822124481201
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7104630470275879
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9226863384246826
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 61164
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1751224994659424
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.729 Vali Acc: 0.256 Test Loss: 1.729 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.004995346069336
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.593 Vali Acc: 0.400 Test Loss: 1.593 Test Acc: 0.400
Validation loss decreased (-0.255538 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.9273562431335449
Epoch: 3, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.419 Vali Acc: 0.567 Test Loss: 1.419 Test Acc: 0.567
Validation loss decreased (-0.399984 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 0.9512872695922852
Epoch: 4, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.236 Vali Acc: 0.617 Test Loss: 1.236 Test Acc: 0.617
Validation loss decreased (-0.566652 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 0.9148263931274414
Epoch: 5, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.052 Vali Acc: 0.711 Test Loss: 1.052 Test Acc: 0.711
Validation loss decreased (-0.616654 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 1.1763038635253906
Epoch: 6, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.877 Vali Acc: 0.739 Test Loss: 0.877 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.021850347518921
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.732 Vali Acc: 0.794 Test Loss: 0.732 Test Acc: 0.794
Validation loss decreased (-0.738880 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 0.8181185722351074
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.616 Vali Acc: 0.794 Test Loss: 0.616 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 0.8398122787475586
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.794438 --> -0.844439).  Saving model ...
Epoch: 10 cost time: 0.9973881244659424
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 0.714425802230835
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.420 Vali Acc: 0.839 Test Loss: 0.420 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8737998008728027
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.961855411529541
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.9183187484741211
Epoch: 14, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9313979148864746
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0714685916900635
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.914400577545166
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.007188081741333
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.969038724899292
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9738969802856445
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8902313709259033
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8839330673217773
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9668481349945068
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9186663627624512
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9807186126708984
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9981861114501953
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0827155113220215
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9243996143341064
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 61164
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8631763458251953
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.811 Vali Acc: 0.128 Test Loss: 1.811 Test Acc: 0.128
Validation loss decreased (inf --> -0.127760).  Saving model ...
Epoch: 2 cost time: 1.4402518272399902
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.669 Vali Acc: 0.289 Test Loss: 1.669 Test Acc: 0.289
Validation loss decreased (-0.127760 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 1.2434790134429932
Epoch: 3, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.496 Vali Acc: 0.472 Test Loss: 1.496 Test Acc: 0.472
Validation loss decreased (-0.288872 --> -0.472207).  Saving model ...
Epoch: 4 cost time: 1.288602590560913
Epoch: 4, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.320 Vali Acc: 0.628 Test Loss: 1.320 Test Acc: 0.628
Validation loss decreased (-0.472207 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 1.2346692085266113
Epoch: 5, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.139 Vali Acc: 0.694 Test Loss: 1.139 Test Acc: 0.694
Validation loss decreased (-0.627765 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.3104305267333984
Epoch: 6, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 1.2272584438323975
Epoch: 7, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.0265474319458008
Epoch: 8, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777771).  Saving model ...
Epoch: 9 cost time: 1.326643466949463
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.0347812175750732
Epoch: 10, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.541 Vali Acc: 0.817 Test Loss: 0.541 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 1.175786018371582
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.487 Vali Acc: 0.817 Test Loss: 0.487 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 1.157984733581543
Epoch: 12, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.3643083572387695
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.855551 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.4618959426879883
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.390 Vali Acc: 0.867 Test Loss: 0.390 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4781088829040527
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.283919334411621
Epoch: 16, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 1.2658336162567139
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2355589866638184
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.403862714767456
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.3864500522613525
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.6481211185455322
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4623916149139404
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.389005422592163
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.357175350189209
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 1.1917264461517334
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 1.3352324962615967
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3712191581726074
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4894514083862305
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4056549072265625
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6540863513946533
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2146084308624268
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.363168716430664
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.298264980316162
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5263431072235107
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.317347526550293
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 1.2236230373382568
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5524423122406006
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.894 Test Loss: 0.210 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3457772731781006
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5137784481048584
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.199535846710205
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4631688594818115
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3892238140106201
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.4843330383300781
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.465827226638794
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.4156246185302734
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 63844
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3824398517608643
Epoch: 1, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.806 Vali Acc: 0.194 Test Loss: 1.806 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 1.1857261657714844
Epoch: 2, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.662 Vali Acc: 0.278 Test Loss: 1.662 Test Acc: 0.278
Validation loss decreased (-0.194426 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 1.0972139835357666
Epoch: 3, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.499 Vali Acc: 0.494 Test Loss: 1.499 Test Acc: 0.494
Validation loss decreased (-0.277761 --> -0.494429).  Saving model ...
Epoch: 4 cost time: 1.0206005573272705
Epoch: 4, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.328 Vali Acc: 0.611 Test Loss: 1.328 Test Acc: 0.611
Validation loss decreased (-0.494429 --> -0.611098).  Saving model ...
Epoch: 5 cost time: 1.4314093589782715
Epoch: 5, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.158 Vali Acc: 0.683 Test Loss: 1.158 Test Acc: 0.683
Validation loss decreased (-0.611098 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 1.0691523551940918
Epoch: 6, Steps: 12 | Train Loss: 0.998 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 1.0482828617095947
Epoch: 7, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.857 Vali Acc: 0.744 Test Loss: 0.857 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.0863285064697266
Epoch: 8, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.2757325172424316
Epoch: 9, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 10 cost time: 1.1688332557678223
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 11 cost time: 1.0041463375091553
Epoch: 11, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.788883 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.0365681648254395
Epoch: 12, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0293281078338623
Epoch: 13, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.453 Vali Acc: 0.839 Test Loss: 0.453 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 1.060239553451538
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.0935397148132324
Epoch: 15, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.406 Vali Acc: 0.872 Test Loss: 0.406 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 1.0805127620697021
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 1.0821483135223389
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.2131688594818115
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1641840934753418
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.339 Vali Acc: 0.883 Test Loss: 0.339 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.201052188873291
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0613911151885986
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.0768365859985352
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4123218059539795
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.2759253978729248
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1886887550354004
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5209934711456299
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 1.0119643211364746
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2522258758544922
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1617462635040283
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.17073392868042
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1854417324066162
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.260897159576416
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3654592037200928
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 1.1598026752471924
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3936731815338135
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 36 cost time: 1.247922420501709
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3016273975372314
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0607388019561768
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0589525699615479
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 40 cost time: 1.2576894760131836
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1753339767456055
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5124378204345703
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3346638679504395
Epoch: 43, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.360781192779541
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2039847373962402
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.228574514389038
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.906 Test Loss: 0.201 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.271878719329834
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.900 Test Loss: 0.196 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2843396663665771
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.906 Test Loss: 0.190 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.3615531921386719
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 50 cost time: 1.0931828022003174
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.134549617767334
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.346529245376587
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.073014497756958
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2337470054626465
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1173994541168213
Epoch: 55, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.223991870880127
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9915192127227783
Epoch: 57, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.906 Test Loss: 0.198 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.1828467845916748
Epoch: 58, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.906 Test Loss: 0.198 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2366571426391602
Epoch: 59, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.906 Test Loss: 0.189 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 63332
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.186614990234375
Epoch: 1, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.747 Vali Acc: 0.250 Test Loss: 1.747 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 1.1956777572631836
Epoch: 2, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.603 Vali Acc: 0.389 Test Loss: 1.603 Test Acc: 0.389
Validation loss decreased (-0.249983 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 1.0340251922607422
Epoch: 3, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.435 Vali Acc: 0.494 Test Loss: 1.435 Test Acc: 0.494
Validation loss decreased (-0.388873 --> -0.494430).  Saving model ...
Epoch: 4 cost time: 1.0644590854644775
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.494430 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.977588415145874
Epoch: 5, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.089 Vali Acc: 0.756 Test Loss: 1.089 Test Acc: 0.756
Validation loss decreased (-0.649987 --> -0.755545).  Saving model ...
Epoch: 6 cost time: 1.0740597248077393
Epoch: 6, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.924 Vali Acc: 0.761 Test Loss: 0.924 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761102).  Saving model ...
Epoch: 7 cost time: 1.4668657779693604
Epoch: 7, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.107710599899292
Epoch: 8, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.660 Vali Acc: 0.817 Test Loss: 0.660 Test Acc: 0.817
Validation loss decreased (-0.761102 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 1.413478136062622
Epoch: 9, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2055673599243164
Epoch: 10, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.510 Vali Acc: 0.839 Test Loss: 0.510 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.0841901302337646
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.463 Vali Acc: 0.811 Test Loss: 0.463 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.824592113494873
Epoch: 12, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.421 Vali Acc: 0.883 Test Loss: 0.421 Test Acc: 0.883
Validation loss decreased (-0.838884 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 0.9781162738800049
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0409486293792725
Epoch: 14, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0800328254699707
Epoch: 15, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.1029646396636963
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0674867630004883
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 18 cost time: 0.9684493541717529
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.086824655532837
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9369518756866455
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0514147281646729
Epoch: 21, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0572493076324463
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0496211051940918
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9720315933227539
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1189653873443604
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3549869060516357
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3075237274169922
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 62308
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6636135578155518
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.682 Vali Acc: 0.250 Test Loss: 1.682 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.9097819328308105
Epoch: 2, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.555 Vali Acc: 0.467 Test Loss: 1.555 Test Acc: 0.467
Validation loss decreased (-0.249983 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 1.207472562789917
Epoch: 3, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.403 Vali Acc: 0.611 Test Loss: 1.403 Test Acc: 0.611
Validation loss decreased (-0.466651 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 1.0313453674316406
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.243 Vali Acc: 0.700 Test Loss: 1.243 Test Acc: 0.700
Validation loss decreased (-0.611097 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.102114200592041
Epoch: 5, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.084 Vali Acc: 0.728 Test Loss: 1.084 Test Acc: 0.728
Validation loss decreased (-0.699988 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.0937130451202393
Epoch: 6, Steps: 12 | Train Loss: 0.983 Vali Loss: 0.927 Vali Acc: 0.739 Test Loss: 0.927 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.9620399475097656
Epoch: 7, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.792 Vali Acc: 0.789 Test Loss: 0.792 Test Acc: 0.789
Validation loss decreased (-0.738880 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 1.0399062633514404
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.674 Vali Acc: 0.794 Test Loss: 0.674 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 0.9638833999633789
Epoch: 9, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.591 Vali Acc: 0.817 Test Loss: 0.591 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 0.9997828006744385
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.3430194854736328
Epoch: 11, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.29227876663208
Epoch: 12, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
Validation loss decreased (-0.833329 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 0.8211472034454346
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2442870140075684
Epoch: 14, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
Validation loss decreased (-0.872218 --> -0.911107).  Saving model ...
Epoch: 15 cost time: 0.9858534336090088
Epoch: 15, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2499043941497803
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.959815502166748
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.911107 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.9742932319641113
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9911766052246094
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.213742971420288
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 1.321403980255127
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1189579963684082
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1900498867034912
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9970107078552246
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.051518440246582
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1500301361083984
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2394061088562012
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.400500774383545
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 1.2348875999450684
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 1.1201519966125488
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 31 cost time: 1.031308889389038
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1023125648498535
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 1.2037391662597656
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 34 cost time: 0.932490348815918
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 0.8667936325073242
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9980471134185791
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1089320182800293
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 1.2028324604034424
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0014102458953857
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0209338665008545
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.9542367458343506
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1493220329284668
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8880183696746826
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9137396812438965
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1679408550262451
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8307545185089111
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.000431776046753
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9906408786773682
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.024845838546753
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9526510238647461
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 61796
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2119598388671875
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.765 Vali Acc: 0.200 Test Loss: 1.765 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.9857165813446045
Epoch: 2, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.630 Vali Acc: 0.367 Test Loss: 1.630 Test Acc: 0.367
Validation loss decreased (-0.199982 --> -0.366650).  Saving model ...
Epoch: 3 cost time: 1.1456689834594727
Epoch: 3, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.462 Vali Acc: 0.489 Test Loss: 1.462 Test Acc: 0.489
Validation loss decreased (-0.366650 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 1.096559762954712
Epoch: 4, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.291 Vali Acc: 0.594 Test Loss: 1.291 Test Acc: 0.594
Validation loss decreased (-0.488874 --> -0.594432).  Saving model ...
Epoch: 5 cost time: 1.119330883026123
Epoch: 5, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.118 Vali Acc: 0.672 Test Loss: 1.118 Test Acc: 0.672
Validation loss decreased (-0.594432 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 0.9656012058258057
Epoch: 6, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 1.0011231899261475
Epoch: 7, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 0.9426355361938477
Epoch: 8, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777771).  Saving model ...
Epoch: 9 cost time: 0.9326770305633545
Epoch: 9, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.611 Vali Acc: 0.817 Test Loss: 0.611 Test Acc: 0.817
Validation loss decreased (-0.777771 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 0.8117098808288574
Epoch: 10, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.539 Vali Acc: 0.817 Test Loss: 0.539 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 0.887861967086792
Epoch: 11, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.816661 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 1.0810558795928955
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 1.1139862537384033
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 1.2500879764556885
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
Validation loss decreased (-0.861107 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 1.0716304779052734
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.9677748680114746
Epoch: 16, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 1.270122766494751
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9694259166717529
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9964697360992432
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.1039161682128906
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0615837574005127
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.272639274597168
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938886).  Saving model ...
Epoch: 23 cost time: 1.0261199474334717
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.938886 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.9409885406494141
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 1.0296823978424072
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8429992198944092
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.7569551467895508
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.909168004989624
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.7660493850708008
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.104635238647461
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8135597705841064
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8153610229492188
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.939 Test Loss: 0.172 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.172093391418457
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.874220609664917
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8129873275756836
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.939 Test Loss: 0.169 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9151148796081543
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1693556308746338
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.939 Test Loss: 0.169 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0449891090393066
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.939 Test Loss: 0.161 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 61284
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0529603958129883
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.822 Vali Acc: 0.167 Test Loss: 1.822 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.9533746242523193
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.673 Vali Acc: 0.306 Test Loss: 1.673 Test Acc: 0.306
Validation loss decreased (-0.166648 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 0.7943885326385498
Epoch: 3, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
Validation loss decreased (-0.305539 --> -0.511096).  Saving model ...
Epoch: 4 cost time: 1.0759193897247314
Epoch: 4, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.286 Vali Acc: 0.628 Test Loss: 1.286 Test Acc: 0.628
Validation loss decreased (-0.511096 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 0.9796557426452637
Epoch: 5, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.087 Vali Acc: 0.706 Test Loss: 1.087 Test Acc: 0.706
Validation loss decreased (-0.627765 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.0998799800872803
Epoch: 6, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 0.9548313617706299
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 0.9378337860107422
Epoch: 8, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.638 Vali Acc: 0.794 Test Loss: 0.638 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.097684383392334
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.794438 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.8890547752380371
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.472 Vali Acc: 0.839 Test Loss: 0.472 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 0.8775334358215332
Epoch: 11, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.425 Vali Acc: 0.867 Test Loss: 0.425 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 0.8880631923675537
Epoch: 12, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.866662 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.8082213401794434
Epoch: 13, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9942588806152344
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9571573734283447
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.019529104232788
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9005155563354492
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.0396645069122314
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9911894798278809
Epoch: 19, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0618155002593994
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0870330333709717
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.2972261905670166
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.8912515640258789
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2225360870361328
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0891661643981934
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.098304033279419
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.9086544513702393
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0124337673187256
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.078800916671753
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8901076316833496
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1134932041168213
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0583546161651611
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9582512378692627
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.034677267074585
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8973219394683838
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9695663452148438
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9696881771087646
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9184300899505615
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 60772
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.520127534866333
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.822 Vali Acc: 0.167 Test Loss: 1.822 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 1.0918455123901367
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.673 Vali Acc: 0.306 Test Loss: 1.673 Test Acc: 0.306
Validation loss decreased (-0.166648 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 0.8278689384460449
Epoch: 3, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
Validation loss decreased (-0.305539 --> -0.511096).  Saving model ...
Epoch: 4 cost time: 1.0244455337524414
Epoch: 4, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.286 Vali Acc: 0.628 Test Loss: 1.286 Test Acc: 0.628
Validation loss decreased (-0.511096 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 0.9950170516967773
Epoch: 5, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.087 Vali Acc: 0.706 Test Loss: 1.087 Test Acc: 0.706
Validation loss decreased (-0.627765 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.31307053565979
Epoch: 6, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 0.9110851287841797
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 0.861668586730957
Epoch: 8, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.638 Vali Acc: 0.794 Test Loss: 0.638 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.182281255722046
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.794438 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.313230037689209
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.472 Vali Acc: 0.839 Test Loss: 0.472 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.2369232177734375
Epoch: 11, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.425 Vali Acc: 0.867 Test Loss: 0.425 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 0.904707670211792
Epoch: 12, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.866662 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.1514759063720703
Epoch: 13, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9874434471130371
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3254051208496094
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1106476783752441
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0319223403930664
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.1698336601257324
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.205176591873169
Epoch: 19, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0327813625335693
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2315242290496826
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 0.9963164329528809
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.0354335308074951
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.017315149307251
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0082743167877197
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.35746169090271
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.8959643840789795
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.907020092010498
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.2120394706726074
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0504124164581299
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9942631721496582
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.982393741607666
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8794620037078857
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8324685096740723
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8496322631835938
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.067121982574463
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.924816370010376
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.89015793800354
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 60772
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1732969284057617
Epoch: 1, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.766 Vali Acc: 0.289 Test Loss: 1.766 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 1.2022802829742432
Epoch: 2, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.649 Vali Acc: 0.322 Test Loss: 1.649 Test Acc: 0.322
Validation loss decreased (-0.288871 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 1.1961841583251953
Epoch: 3, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.501 Vali Acc: 0.433 Test Loss: 1.501 Test Acc: 0.433
Validation loss decreased (-0.322206 --> -0.433318).  Saving model ...
Epoch: 4 cost time: 1.2214500904083252
Epoch: 4, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.334 Vali Acc: 0.633 Test Loss: 1.334 Test Acc: 0.633
Validation loss decreased (-0.433318 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 1.4729406833648682
Epoch: 5, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.167 Vali Acc: 0.722 Test Loss: 1.167 Test Acc: 0.722
Validation loss decreased (-0.633320 --> -0.722211).  Saving model ...
Epoch: 6 cost time: 1.216022253036499
Epoch: 6, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
Validation loss decreased (-0.722211 --> -0.744434).  Saving model ...
Epoch: 7 cost time: 1.050605058670044
Epoch: 7, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.865 Vali Acc: 0.739 Test Loss: 0.865 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5296876430511475
Epoch: 8, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.744434 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.3577182292938232
Epoch: 9, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794438).  Saving model ...
Epoch: 10 cost time: 1.4203591346740723
Epoch: 10, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 1.6100788116455078
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1718809604644775
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.491 Vali Acc: 0.817 Test Loss: 0.491 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 1.2707359790802002
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.454 Vali Acc: 0.839 Test Loss: 0.454 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 1.4293193817138672
Epoch: 14, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.433 Vali Acc: 0.839 Test Loss: 0.433 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.2677116394042969
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.413 Vali Acc: 0.839 Test Loss: 0.413 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 1.206298828125
Epoch: 16, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 1.591540813446045
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.2282345294952393
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1962764263153076
Epoch: 19, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.338 Vali Acc: 0.867 Test Loss: 0.338 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1480298042297363
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2290027141571045
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.233748197555542
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 23 cost time: 1.2177259922027588
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2207849025726318
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.2991981506347656
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2942149639129639
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1576132774353027
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2561695575714111
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3290140628814697
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4077520370483398
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6049695014953613
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.6300013065338135
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3878452777862549
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 34 cost time: 1.207345962524414
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.339383840560913
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.334902286529541
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2921607494354248
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1288704872131348
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1456151008605957
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 1.0752909183502197
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 41 cost time: 1.2263333797454834
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3329977989196777
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1443121433258057
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.469658374786377
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2532110214233398
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.543407917022705
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.322730302810669
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.6133248805999756
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2024869918823242
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4358220100402832
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 63648
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5482726097106934
Epoch: 1, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.638 Vali Acc: 0.311 Test Loss: 1.638 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.9980316162109375
Epoch: 2, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.511 Vali Acc: 0.506 Test Loss: 1.511 Test Acc: 0.506
Validation loss decreased (-0.311095 --> -0.505540).  Saving model ...
Epoch: 3 cost time: 1.1411054134368896
Epoch: 3, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
Validation loss decreased (-0.505540 --> -0.616653).  Saving model ...
Epoch: 4 cost time: 0.9832124710083008
Epoch: 4, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.185 Vali Acc: 0.706 Test Loss: 1.185 Test Acc: 0.706
Validation loss decreased (-0.616653 --> -0.705544).  Saving model ...
Epoch: 5 cost time: 1.1426615715026855
Epoch: 5, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738879).  Saving model ...
Epoch: 6 cost time: 1.182133674621582
Epoch: 6, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761103).  Saving model ...
Epoch: 7 cost time: 0.994732141494751
Epoch: 7, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 8 cost time: 1.270045518875122
Epoch: 8, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.619 Vali Acc: 0.806 Test Loss: 0.619 Test Acc: 0.806
Validation loss decreased (-0.777771 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 1.1285650730133057
Epoch: 9, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.549 Vali Acc: 0.794 Test Loss: 0.549 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9818212985992432
Epoch: 10, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.086510419845581
Epoch: 11, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
Validation loss decreased (-0.805549 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 1.1433136463165283
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.417 Vali Acc: 0.856 Test Loss: 0.417 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.2833776473999023
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2481451034545898
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.855551 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 1.0795927047729492
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2190477848052979
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.2902464866638184
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 1.1192097663879395
Epoch: 18, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3270747661590576
Epoch: 19, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.4136254787445068
Epoch: 20, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1126327514648438
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.9472196102142334
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1624948978424072
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1530203819274902
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 1.35709810256958
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.0149564743041992
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 1.1736750602722168
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.028522253036499
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 1.1280851364135742
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 1.0781652927398682
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.0090100765228271
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9730751514434814
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9973773956298828
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 1.1185376644134521
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1006574630737305
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0573511123657227
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0874061584472656
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0336742401123047
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.172 Vali Acc: 0.939 Test Loss: 0.172 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9122428894042969
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1130619049072266
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.9455606937408447
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1461832523345947
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 1.082456350326538
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.931189775466919
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1087391376495361
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9750716686248779
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1167478561401367
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9728977680206299
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.001591682434082
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2687606811523438
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2397410869598389
Epoch: 51, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0009706020355225
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 63136
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.775714635848999
Epoch: 1, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.834 Vali Acc: 0.278 Test Loss: 1.834 Test Acc: 0.278
Validation loss decreased (inf --> -0.277759).  Saving model ...
Epoch: 2 cost time: 1.055776596069336
Epoch: 2, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.662 Vali Acc: 0.344 Test Loss: 1.662 Test Acc: 0.344
Validation loss decreased (-0.277759 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.9474260807037354
Epoch: 3, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.457 Vali Acc: 0.578 Test Loss: 1.457 Test Acc: 0.578
Validation loss decreased (-0.344428 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 0.9720375537872314
Epoch: 4, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.260 Vali Acc: 0.706 Test Loss: 1.260 Test Acc: 0.706
Validation loss decreased (-0.577763 --> -0.705543).  Saving model ...
Epoch: 5 cost time: 0.9474921226501465
Epoch: 5, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.078 Vali Acc: 0.733 Test Loss: 1.078 Test Acc: 0.733
Validation loss decreased (-0.705543 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 0.9026000499725342
Epoch: 6, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.905 Vali Acc: 0.728 Test Loss: 0.905 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9410483837127686
Epoch: 7, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
Validation loss decreased (-0.733323 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 1.0182347297668457
Epoch: 8, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.654 Vali Acc: 0.767 Test Loss: 0.654 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9045770168304443
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.573 Vali Acc: 0.778 Test Loss: 0.573 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0294392108917236
Epoch: 10, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.513 Vali Acc: 0.794 Test Loss: 0.513 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 1.093156337738037
Epoch: 11, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
Validation loss decreased (-0.794439 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.9382514953613281
Epoch: 12, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.429 Vali Acc: 0.839 Test Loss: 0.429 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 0.9019105434417725
Epoch: 13, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.401 Vali Acc: 0.856 Test Loss: 0.401 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 0.8664360046386719
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.969627857208252
Epoch: 15, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 0.9828736782073975
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.337 Vali Acc: 0.878 Test Loss: 0.337 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 0.9417154788970947
Epoch: 17, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0331547260284424
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9484002590179443
Epoch: 19, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.0513408184051514
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.898841142654419
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.9243500232696533
Epoch: 22, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7895562648773193
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8277804851531982
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9833984375
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9017021656036377
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.821399450302124
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9095039367675781
Epoch: 28, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9473235607147217
Epoch: 29, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.791710376739502
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8710908889770508
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 62112
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3673386573791504
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.823 Vali Acc: 0.172 Test Loss: 1.823 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.0003771781921387
Epoch: 2, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.695 Vali Acc: 0.322 Test Loss: 1.695 Test Acc: 0.322
Validation loss decreased (-0.172204 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.864647388458252
Epoch: 3, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.542 Vali Acc: 0.422 Test Loss: 1.542 Test Acc: 0.422
Validation loss decreased (-0.322205 --> -0.422207).  Saving model ...
Epoch: 4 cost time: 0.7576167583465576
Epoch: 4, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.377 Vali Acc: 0.539 Test Loss: 1.377 Test Acc: 0.539
Validation loss decreased (-0.422207 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 0.9191930294036865
Epoch: 5, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.209 Vali Acc: 0.606 Test Loss: 1.209 Test Acc: 0.606
Validation loss decreased (-0.538875 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 0.9783613681793213
Epoch: 6, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.052 Vali Acc: 0.689 Test Loss: 1.052 Test Acc: 0.689
Validation loss decreased (-0.605543 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 0.8203775882720947
Epoch: 7, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.908 Vali Acc: 0.711 Test Loss: 0.908 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 1.2503807544708252
Epoch: 8, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 0.8319187164306641
Epoch: 9, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794438).  Saving model ...
Epoch: 10 cost time: 0.7727863788604736
Epoch: 10, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805550).  Saving model ...
Epoch: 11 cost time: 0.9489367008209229
Epoch: 11, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.534 Vali Acc: 0.811 Test Loss: 0.534 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.8396070003509521
Epoch: 12, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 0.895167350769043
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 0.8822128772735596
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 0.8789770603179932
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 1.0108850002288818
Epoch: 16, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.929459810256958
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8949086666107178
Epoch: 18, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 1.1972064971923828
Epoch: 19, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9299652576446533
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 1.0469951629638672
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.9198880195617676
Epoch: 22, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0740242004394531
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8027975559234619
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0723686218261719
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.7971763610839844
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.8626089096069336
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.7785017490386963
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9928421974182129
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8390870094299316
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 0.9543402194976807
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8011488914489746
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.060744047164917
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7402620315551758
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0373120307922363
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8151388168334961
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9027431011199951
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8245522975921631
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8914227485656738
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9214200973510742
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 61600
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9697604179382324
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.752 Vali Acc: 0.239 Test Loss: 1.752 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 0.8936212062835693
Epoch: 2, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.622 Vali Acc: 0.400 Test Loss: 1.622 Test Acc: 0.400
Validation loss decreased (-0.238871 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.8542966842651367
Epoch: 3, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
Validation loss decreased (-0.399984 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 0.9619655609130859
Epoch: 4, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.303 Vali Acc: 0.622 Test Loss: 1.303 Test Acc: 0.622
Validation loss decreased (-0.549985 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 0.7457478046417236
Epoch: 5, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.131 Vali Acc: 0.728 Test Loss: 1.131 Test Acc: 0.728
Validation loss decreased (-0.622209 --> -0.727766).  Saving model ...
Epoch: 6 cost time: 0.8489830493927002
Epoch: 6, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.972 Vali Acc: 0.739 Test Loss: 0.972 Test Acc: 0.739
Validation loss decreased (-0.727766 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 0.7237837314605713
Epoch: 7, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 0.8627874851226807
Epoch: 8, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 0.8293180465698242
Epoch: 9, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.635 Vali Acc: 0.767 Test Loss: 0.635 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9176933765411377
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805550).  Saving model ...
Epoch: 11 cost time: 1.1883811950683594
Epoch: 11, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 0.8761537075042725
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.460 Vali Acc: 0.822 Test Loss: 0.460 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0296525955200195
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.9435458183288574
Epoch: 14, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.400 Vali Acc: 0.872 Test Loss: 0.400 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 15 cost time: 0.9950683116912842
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9240994453430176
Epoch: 16, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.358 Vali Acc: 0.867 Test Loss: 0.358 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1217143535614014
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9072084426879883
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 0.9182603359222412
Epoch: 19, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.255101203918457
Epoch: 20, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 0.858346700668335
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2127604484558105
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0051419734954834
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.086409091949463
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.895988941192627
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7680644989013672
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8441579341888428
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9981722831726074
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 0.7899339199066162
Epoch: 29, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 0.8162777423858643
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8827915191650391
Epoch: 31, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 32 cost time: 0.8323140144348145
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8752527236938477
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.9926028251647949
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1274361610412598
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.218 Vali Acc: 0.900 Test Loss: 0.218 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1903140544891357
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8670022487640381
Epoch: 37, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 0.912076473236084
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.894 Test Loss: 0.213 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7211277484893799
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9569408893585205
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1198451519012451
Epoch: 41, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.210 Vali Acc: 0.894 Test Loss: 0.210 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8938138484954834
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.019073247909546
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0918769836425781
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.894 Test Loss: 0.223 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9462308883666992
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.136683702468872
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7876107692718506
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 61088
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.089116334915161
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.667 Vali Acc: 0.250 Test Loss: 1.667 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 1.1249003410339355
Epoch: 2, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.543 Vali Acc: 0.439 Test Loss: 1.543 Test Acc: 0.439
Validation loss decreased (-0.249983 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 1.144075870513916
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.394 Vali Acc: 0.678 Test Loss: 1.394 Test Acc: 0.678
Validation loss decreased (-0.438873 --> -0.677764).  Saving model ...
Epoch: 4 cost time: 0.9763026237487793
Epoch: 4, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 1.1221392154693604
Epoch: 5, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
Validation loss decreased (-0.711099 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 1.1818263530731201
Epoch: 6, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.917 Vali Acc: 0.761 Test Loss: 0.917 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761102).  Saving model ...
Epoch: 7 cost time: 0.879225492477417
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.778 Vali Acc: 0.789 Test Loss: 0.778 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 1.1714694499969482
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.656 Vali Acc: 0.794 Test Loss: 0.656 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.056734561920166
Epoch: 9, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.568 Vali Acc: 0.817 Test Loss: 0.568 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 1.1617558002471924
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.9022326469421387
Epoch: 11, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 0.9972972869873047
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.884014368057251
Epoch: 13, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.866663 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.7780346870422363
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 0.878497838973999
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7490701675415039
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7416415214538574
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8402371406555176
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9171900749206543
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.185699462890625
Epoch: 20, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 1.0704708099365234
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.9602823257446289
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7839438915252686
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.972670316696167
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1610031127929688
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9819416999816895
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.749786376953125
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7967226505279541
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0996410846710205
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9133627414703369
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8915374279022217
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3202521800994873
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.880246639251709
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9890422821044922
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1328988075256348
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.894 Test Loss: 0.200 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9982514381408691
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.906 Test Loss: 0.187 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 60576
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7564537525177
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.667 Vali Acc: 0.250 Test Loss: 1.667 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.9064710140228271
Epoch: 2, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.543 Vali Acc: 0.439 Test Loss: 1.543 Test Acc: 0.439
Validation loss decreased (-0.249983 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 0.9043288230895996
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.394 Vali Acc: 0.678 Test Loss: 1.394 Test Acc: 0.678
Validation loss decreased (-0.438873 --> -0.677764).  Saving model ...
Epoch: 4 cost time: 0.8166697025299072
Epoch: 4, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 0.8960909843444824
Epoch: 5, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
Validation loss decreased (-0.711099 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.861853837966919
Epoch: 6, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.917 Vali Acc: 0.761 Test Loss: 0.917 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761102).  Saving model ...
Epoch: 7 cost time: 0.7329976558685303
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.778 Vali Acc: 0.789 Test Loss: 0.778 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 0.9048805236816406
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.656 Vali Acc: 0.794 Test Loss: 0.656 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 0.9803314208984375
Epoch: 9, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.568 Vali Acc: 0.817 Test Loss: 0.568 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 10 cost time: 0.9491257667541504
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.7993896007537842
Epoch: 11, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 0.8163795471191406
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.878026008605957
Epoch: 13, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.866663 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.9116473197937012
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 0.7198429107666016
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9945261478424072
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6869432926177979
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.6912233829498291
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9804320335388184
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0201783180236816
Epoch: 20, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.8599839210510254
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.7899768352508545
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0042552947998047
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0127782821655273
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2728416919708252
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1137347221374512
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.8698818683624268
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8765554428100586
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0122289657592773
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9873552322387695
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0231797695159912
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0955901145935059
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.19230055809021
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0621845722198486
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.115044116973877
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.894 Test Loss: 0.200 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9821467399597168
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.906 Test Loss: 0.187 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 60576
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.049708127975464
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.775 Vali Acc: 0.133 Test Loss: 1.775 Test Acc: 0.133
Validation loss decreased (inf --> -0.133316).  Saving model ...
Epoch: 2 cost time: 1.3080980777740479
Epoch: 2, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.565 Vali Acc: 0.433 Test Loss: 1.565 Test Acc: 0.433
Validation loss decreased (-0.133316 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 1.1534085273742676
Epoch: 3, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.338 Vali Acc: 0.617 Test Loss: 1.338 Test Acc: 0.617
Validation loss decreased (-0.433318 --> -0.616653).  Saving model ...
Epoch: 4 cost time: 1.0078802108764648
Epoch: 4, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.128 Vali Acc: 0.700 Test Loss: 1.128 Test Acc: 0.700
Validation loss decreased (-0.616653 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.3006870746612549
Epoch: 5, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.939 Vali Acc: 0.772 Test Loss: 0.939 Test Acc: 0.772
Validation loss decreased (-0.699989 --> -0.772213).  Saving model ...
Epoch: 6 cost time: 1.2279362678527832
Epoch: 6, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.779 Vali Acc: 0.794 Test Loss: 0.779 Test Acc: 0.794
Validation loss decreased (-0.772213 --> -0.794437).  Saving model ...
Epoch: 7 cost time: 1.1825637817382812
Epoch: 7, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 1.2336368560791016
Epoch: 8, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
Validation loss decreased (-0.811105 --> -0.855550).  Saving model ...
Epoch: 9 cost time: 1.083491325378418
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2952466011047363
Epoch: 10, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 1.323920726776123
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 1.1634745597839355
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 1.1306219100952148
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.381 Vali Acc: 0.883 Test Loss: 0.381 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.2710413932800293
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4369590282440186
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2594661712646484
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1805999279022217
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3463120460510254
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5533864498138428
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3993229866027832
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2743229866027832
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3595070838928223
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4600014686584473
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 63404
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.609375
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.757 Vali Acc: 0.233 Test Loss: 1.757 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.0875215530395508
Epoch: 2, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.533 Vali Acc: 0.411 Test Loss: 1.533 Test Acc: 0.411
Validation loss decreased (-0.233316 --> -0.411096).  Saving model ...
Epoch: 3 cost time: 1.1803877353668213
Epoch: 3, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.298 Vali Acc: 0.628 Test Loss: 1.298 Test Acc: 0.628
Validation loss decreased (-0.411096 --> -0.627765).  Saving model ...
Epoch: 4 cost time: 0.8959143161773682
Epoch: 4, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.086 Vali Acc: 0.711 Test Loss: 1.086 Test Acc: 0.711
Validation loss decreased (-0.627765 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 1.120711326599121
Epoch: 5, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.711100 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.0431632995605469
Epoch: 6, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
Validation loss decreased (-0.749991 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 0.894357442855835
Epoch: 7, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 0.9005990028381348
Epoch: 8, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855550).  Saving model ...
Epoch: 9 cost time: 1.028064489364624
Epoch: 9, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 10 cost time: 1.0834205150604248
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 1.000091791152954
Epoch: 11, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.402 Vali Acc: 0.872 Test Loss: 0.402 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.166583776473999
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.9072637557983398
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.158341884613037
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.333 Vali Acc: 0.883 Test Loss: 0.333 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0279440879821777
Epoch: 15, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.329 Vali Acc: 0.894 Test Loss: 0.329 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.2282946109771729
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 17 cost time: 1.0594806671142578
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.158398151397705
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.0114977359771729
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0451533794403076
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.057363510131836
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.931833028793335
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1091139316558838
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9775238037109375
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2210488319396973
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2902557849884033
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3227510452270508
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1248016357421875
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 62892
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0391907691955566
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.714 Vali Acc: 0.267 Test Loss: 1.714 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 1.2124431133270264
Epoch: 2, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.502 Vali Acc: 0.483 Test Loss: 1.502 Test Acc: 0.483
Validation loss decreased (-0.266650 --> -0.483318).  Saving model ...
Epoch: 3 cost time: 1.084329605102539
Epoch: 3, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.284 Vali Acc: 0.622 Test Loss: 1.284 Test Acc: 0.622
Validation loss decreased (-0.483318 --> -0.622209).  Saving model ...
Epoch: 4 cost time: 1.5441184043884277
Epoch: 4, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.078 Vali Acc: 0.706 Test Loss: 1.078 Test Acc: 0.706
Validation loss decreased (-0.622209 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 1.2164580821990967
Epoch: 5, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.893 Vali Acc: 0.739 Test Loss: 0.893 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 6 cost time: 1.5010316371917725
Epoch: 6, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.740 Vali Acc: 0.817 Test Loss: 0.740 Test Acc: 0.817
Validation loss decreased (-0.738880 --> -0.816659).  Saving model ...
Epoch: 7 cost time: 1.3129355907440186
Epoch: 7, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.617 Vali Acc: 0.839 Test Loss: 0.617 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838883).  Saving model ...
Epoch: 8 cost time: 1.079632043838501
Epoch: 8, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 9 cost time: 1.0755436420440674
Epoch: 9, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.4135980606079102
Epoch: 10, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0250120162963867
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.396 Vali Acc: 0.872 Test Loss: 0.396 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.0629334449768066
Epoch: 12, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0517101287841797
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.366 Vali Acc: 0.856 Test Loss: 0.366 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.31878662109375
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9700419902801514
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 0.9550981521606445
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 0.9214508533477783
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.084472417831421
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.0276165008544922
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1266875267028809
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.1802880764007568
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2105903625488281
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0444726943969727
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.188047170639038
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1081738471984863
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8846886157989502
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0215363502502441
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1521508693695068
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1273903846740723
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.188605785369873
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 61868
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.876905918121338
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.707 Vali Acc: 0.228 Test Loss: 1.707 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 0.9884929656982422
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
Validation loss decreased (-0.227761 --> -0.488874).  Saving model ...
Epoch: 3 cost time: 0.963554859161377
Epoch: 3, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.248 Vali Acc: 0.611 Test Loss: 1.248 Test Acc: 0.611
Validation loss decreased (-0.488874 --> -0.611099).  Saving model ...
Epoch: 4 cost time: 0.7657020092010498
Epoch: 4, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.045 Vali Acc: 0.689 Test Loss: 1.045 Test Acc: 0.689
Validation loss decreased (-0.611099 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 0.7487642765045166
Epoch: 5, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 0.9916956424713135
Epoch: 6, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755548).  Saving model ...
Epoch: 7 cost time: 1.0667839050292969
Epoch: 7, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9437284469604492
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.579 Vali Acc: 0.778 Test Loss: 0.579 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.0026662349700928
Epoch: 9, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 0.8801605701446533
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.883866548538208
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 1.1286799907684326
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.9112772941589355
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9507091045379639
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.7647502422332764
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0853722095489502
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9626727104187012
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 18 cost time: 0.8096780776977539
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9692020416259766
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9317123889923096
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.984529972076416
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9898254871368408
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 0.9402768611907959
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8794293403625488
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 25 cost time: 0.9761359691619873
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1095445156097412
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 0.848048210144043
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0317251682281494
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7913947105407715
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9563305377960205
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9604754447937012
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9134209156036377
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0650510787963867
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8488218784332275
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8459866046905518
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 36 cost time: 0.8802194595336914
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9188239574432373
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0403978824615479
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9312500953674316
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9358022212982178
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7683963775634766
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9296562671661377
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8346517086029053
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0305697917938232
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.943756103515625
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 61356
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.059764862060547
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.751 Vali Acc: 0.294 Test Loss: 1.751 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.1913747787475586
Epoch: 2, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.527 Vali Acc: 0.478 Test Loss: 1.527 Test Acc: 0.478
Validation loss decreased (-0.294427 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 0.9060297012329102
Epoch: 3, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.276 Vali Acc: 0.656 Test Loss: 1.276 Test Acc: 0.656
Validation loss decreased (-0.477763 --> -0.655543).  Saving model ...
Epoch: 4 cost time: 0.9221665859222412
Epoch: 4, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.051 Vali Acc: 0.717 Test Loss: 1.051 Test Acc: 0.717
Validation loss decreased (-0.655543 --> -0.716656).  Saving model ...
Epoch: 5 cost time: 1.05167555809021
Epoch: 5, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
Validation loss decreased (-0.716656 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 0.8716473579406738
Epoch: 6, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.714 Vali Acc: 0.772 Test Loss: 0.714 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 0.9961116313934326
Epoch: 7, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
Validation loss decreased (-0.772215 --> -0.838883).  Saving model ...
Epoch: 8 cost time: 1.1869323253631592
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.1015377044677734
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 0.9719469547271729
Epoch: 10, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2084870338439941
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.1398003101348877
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3410160541534424
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 1.0948102474212646
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.018949031829834
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.0231261253356934
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.085512399673462
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1229114532470703
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2504477500915527
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.058171033859253
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 0.9808790683746338
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.132366418838501
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.8561496734619141
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1704041957855225
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0902693271636963
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8854324817657471
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2070708274841309
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.233046054840088
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8553299903869629
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0207314491271973
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.761035680770874
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9184291362762451
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 60844
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.739315986633301
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.833 Vali Acc: 0.178 Test Loss: 1.833 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.924976110458374
Epoch: 2, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.597 Vali Acc: 0.383 Test Loss: 1.597 Test Acc: 0.383
Validation loss decreased (-0.177759 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 0.812720775604248
Epoch: 3, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.342 Vali Acc: 0.656 Test Loss: 1.342 Test Acc: 0.656
Validation loss decreased (-0.383317 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 0.8854453563690186
Epoch: 4, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.104 Vali Acc: 0.733 Test Loss: 1.104 Test Acc: 0.733
Validation loss decreased (-0.655542 --> -0.733322).  Saving model ...
Epoch: 5 cost time: 0.9220306873321533
Epoch: 5, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.891 Vali Acc: 0.772 Test Loss: 0.891 Test Acc: 0.772
Validation loss decreased (-0.733322 --> -0.772213).  Saving model ...
Epoch: 6 cost time: 1.0158467292785645
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.772213 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 0.9139862060546875
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 0.955437421798706
Epoch: 8, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.811105 --> -0.855551).  Saving model ...
Epoch: 9 cost time: 1.0311369895935059
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 0.996877908706665
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0443816184997559
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8628585338592529
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7921943664550781
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9484720230102539
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0106120109558105
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.883329 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.0233652591705322
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0196282863616943
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1450104713439941
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8007411956787109
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0210239887237549
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.1258409023284912
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0204293727874756
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.1171300411224365
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9488081932067871
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0827879905700684
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7877795696258545
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8270514011383057
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9866964817047119
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.945451021194458
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6742041110992432
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1112322807312012
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.0726830959320068
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8888018131256104
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7050278186798096
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8884434700012207
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0510270595550537
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.008183479309082
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1438453197479248
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8676431179046631
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9080195426940918
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9048545360565186
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 60332
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6500208377838135
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.833 Vali Acc: 0.178 Test Loss: 1.833 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.7820184230804443
Epoch: 2, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.597 Vali Acc: 0.383 Test Loss: 1.597 Test Acc: 0.383
Validation loss decreased (-0.177759 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 0.9736924171447754
Epoch: 3, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.342 Vali Acc: 0.656 Test Loss: 1.342 Test Acc: 0.656
Validation loss decreased (-0.383317 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 1.0223639011383057
Epoch: 4, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.104 Vali Acc: 0.733 Test Loss: 1.104 Test Acc: 0.733
Validation loss decreased (-0.655542 --> -0.733322).  Saving model ...
Epoch: 5 cost time: 0.7887077331542969
Epoch: 5, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.891 Vali Acc: 0.772 Test Loss: 0.891 Test Acc: 0.772
Validation loss decreased (-0.733322 --> -0.772213).  Saving model ...
Epoch: 6 cost time: 0.7435743808746338
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.772213 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 0.8076612949371338
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811105).  Saving model ...
Epoch: 8 cost time: 0.8947222232818604
Epoch: 8, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.811105 --> -0.855551).  Saving model ...
Epoch: 9 cost time: 0.9418721199035645
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 0.952315092086792
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7406232357025146
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8381006717681885
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.006594181060791
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9547221660614014
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.959728479385376
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.883329 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.9686527252197266
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8646748065948486
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9143755435943604
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8107366561889648
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0952982902526855
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0767080783843994
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9886782169342041
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.925929069519043
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9277195930480957
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8519647121429443
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.084550380706787
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8116538524627686
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8997631072998047
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9160668849945068
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7240312099456787
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.861553430557251
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8647661209106445
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9974725246429443
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8917515277862549
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8347432613372803
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8495731353759766
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8490204811096191
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7801294326782227
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6937532424926758
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8168184757232666
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9751527309417725
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 60332
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0158073902130127
Epoch: 1, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.843 Vali Acc: 0.194 Test Loss: 1.843 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 1.1246302127838135
Epoch: 2, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.708 Vali Acc: 0.278 Test Loss: 1.708 Test Acc: 0.278
Validation loss decreased (-0.194426 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 1.152968168258667
Epoch: 3, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.539 Vali Acc: 0.428 Test Loss: 1.539 Test Acc: 0.428
Validation loss decreased (-0.277761 --> -0.427762).  Saving model ...
Epoch: 4 cost time: 1.0583672523498535
Epoch: 4, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.361 Vali Acc: 0.583 Test Loss: 1.361 Test Acc: 0.583
Validation loss decreased (-0.427762 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 1.1195991039276123
Epoch: 5, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.188 Vali Acc: 0.639 Test Loss: 1.188 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 1.092947006225586
Epoch: 6, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.024 Vali Acc: 0.694 Test Loss: 1.024 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 0.9705910682678223
Epoch: 7, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
Validation loss decreased (-0.694434 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 1.167539358139038
Epoch: 8, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.751 Vali Acc: 0.778 Test Loss: 0.751 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.0296387672424316
Epoch: 9, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783327).  Saving model ...
Epoch: 10 cost time: 1.1249761581420898
Epoch: 10, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.586 Vali Acc: 0.794 Test Loss: 0.586 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 0.9314606189727783
Epoch: 11, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.1216754913330078
Epoch: 12, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.497 Vali Acc: 0.817 Test Loss: 0.497 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3194360733032227
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 0.999427080154419
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 1.1536765098571777
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1552269458770752
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 1.2151172161102295
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 1.1749999523162842
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.0947363376617432
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0084741115570068
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0044758319854736
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.0551652908325195
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1797730922698975
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.0959992408752441
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.1258904933929443
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 1.1942267417907715
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.093198299407959
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.275545358657837
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.2094416618347168
Epoch: 29, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 0.9712424278259277
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1985020637512207
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.166794776916504
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1576838493347168
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.160728931427002
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 0.9967172145843506
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 36 cost time: 0.9786972999572754
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0822956562042236
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 38 cost time: 1.4168646335601807
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0602915287017822
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1672730445861816
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.09356689453125
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 42 cost time: 1.0613865852355957
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3941712379455566
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 44 cost time: 1.064812183380127
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 45 cost time: 0.9706401824951172
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1480681896209717
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.911 Test Loss: 0.176 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0538218021392822
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.922 Test Loss: 0.172 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9384706020355225
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.928 Test Loss: 0.168 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9815402030944824
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.922 Test Loss: 0.167 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0929198265075684
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.922 Test Loss: 0.171 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9329566955566406
Epoch: 51, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.922 Test Loss: 0.168 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0071611404418945
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.917 Test Loss: 0.166 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1202738285064697
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0589160919189453
Epoch: 54, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.922 Test Loss: 0.167 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 37116
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2086081504821777
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.853 Vali Acc: 0.217 Test Loss: 1.853 Test Acc: 0.217
Validation loss decreased (inf --> -0.216648).  Saving model ...
Epoch: 2 cost time: 1.2192051410675049
Epoch: 2, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.715 Vali Acc: 0.339 Test Loss: 1.715 Test Acc: 0.339
Validation loss decreased (-0.216648 --> -0.338872).  Saving model ...
Epoch: 3 cost time: 0.9486391544342041
Epoch: 3, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.546 Vali Acc: 0.517 Test Loss: 1.546 Test Acc: 0.517
Validation loss decreased (-0.338872 --> -0.516651).  Saving model ...
Epoch: 4 cost time: 1.2525923252105713
Epoch: 4, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.362 Vali Acc: 0.656 Test Loss: 1.362 Test Acc: 0.656
Validation loss decreased (-0.516651 --> -0.655542).  Saving model ...
Epoch: 5 cost time: 1.2890050411224365
Epoch: 5, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.187 Vali Acc: 0.706 Test Loss: 1.187 Test Acc: 0.706
Validation loss decreased (-0.655542 --> -0.705544).  Saving model ...
Epoch: 6 cost time: 1.127150535583496
Epoch: 6, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.026 Vali Acc: 0.722 Test Loss: 1.026 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 1.137641429901123
Epoch: 7, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.881 Vali Acc: 0.756 Test Loss: 0.881 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 1.0831413269042969
Epoch: 8, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 9 cost time: 1.015563726425171
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 1.2978620529174805
Epoch: 10, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.602 Vali Acc: 0.817 Test Loss: 0.602 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 1.2631125450134277
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.547 Vali Acc: 0.817 Test Loss: 0.547 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 12 cost time: 1.1076242923736572
Epoch: 12, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 1.145423412322998
Epoch: 13, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 1.10725998878479
Epoch: 14, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.429 Vali Acc: 0.839 Test Loss: 0.429 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2950139045715332
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 1.2314810752868652
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 1.088515281677246
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.1884782314300537
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.4822618961334229
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.3990483283996582
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.3076539039611816
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.2615468502044678
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.4850826263427734
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3241832256317139
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6964502334594727
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.31516695022583
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.494849443435669
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.1727886199951172
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.2524540424346924
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3190851211547852
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.1617076396942139
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.4301629066467285
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 1.1991832256317139
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4168815612792969
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6696860790252686
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8622584342956543
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4803082942962646
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3401672840118408
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2768166065216064
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2947072982788086
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4396216869354248
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3947787284851074
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 1.075456142425537
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0884172916412354
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.277146339416504
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0025413036346436
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 1.1630020141601562
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.01963472366333
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2046854496002197
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.3248956203460693
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 51 cost time: 1.273094892501831
Epoch: 51, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0840353965759277
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.051795244216919
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5342283248901367
Epoch: 54, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0142204761505127
Epoch: 55, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2411060333251953
Epoch: 56, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2091000080108643
Epoch: 57, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1971914768218994
Epoch: 58, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.4985277652740479
Epoch: 59, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.065438985824585
Epoch: 60, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 36860
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.158019781112671
Epoch: 1, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.795 Vali Acc: 0.189 Test Loss: 1.795 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.9967494010925293
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.649 Vali Acc: 0.283 Test Loss: 1.649 Test Acc: 0.283
Validation loss decreased (-0.188871 --> -0.283317).  Saving model ...
Epoch: 3 cost time: 0.8837776184082031
Epoch: 3, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.468 Vali Acc: 0.483 Test Loss: 1.468 Test Acc: 0.483
Validation loss decreased (-0.283317 --> -0.483319).  Saving model ...
Epoch: 4 cost time: 1.0989983081817627
Epoch: 4, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.284 Vali Acc: 0.656 Test Loss: 1.284 Test Acc: 0.656
Validation loss decreased (-0.483319 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 0.8024387359619141
Epoch: 5, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.109 Vali Acc: 0.694 Test Loss: 1.109 Test Acc: 0.694
Validation loss decreased (-0.655543 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.0030856132507324
Epoch: 6, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.914959192276001
Epoch: 7, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 0.9126026630401611
Epoch: 8, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
Validation loss decreased (-0.755547 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 0.973895788192749
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 0.9677340984344482
Epoch: 10, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9576659202575684
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.0225398540496826
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 0.9230391979217529
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.9341127872467041
Epoch: 14, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1212668418884277
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.1524815559387207
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.361 Vali Acc: 0.878 Test Loss: 0.361 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 1.0199785232543945
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.340 Vali Acc: 0.883 Test Loss: 0.340 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.1028759479522705
Epoch: 18, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.325 Vali Acc: 0.883 Test Loss: 0.325 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 0.9761350154876709
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.008638858795166
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 1.0731329917907715
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0352528095245361
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9717292785644531
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0561859607696533
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0272400379180908
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.873058557510376
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.111363410949707
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2264087200164795
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9768095016479492
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.858435869216919
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 36348
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.909146308898926
Epoch: 1, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.757 Vali Acc: 0.217 Test Loss: 1.757 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 0.9570999145507812
Epoch: 2, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.627 Vali Acc: 0.372 Test Loss: 1.627 Test Acc: 0.372
Validation loss decreased (-0.216649 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 0.8970301151275635
Epoch: 3, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.470 Vali Acc: 0.544 Test Loss: 1.470 Test Acc: 0.544
Validation loss decreased (-0.372206 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.0822181701660156
Epoch: 4, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.298 Vali Acc: 0.622 Test Loss: 1.298 Test Acc: 0.622
Validation loss decreased (-0.544430 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 0.9101376533508301
Epoch: 5, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.133 Vali Acc: 0.706 Test Loss: 1.133 Test Acc: 0.706
Validation loss decreased (-0.622209 --> -0.705544).  Saving model ...
Epoch: 6 cost time: 0.9218783378601074
Epoch: 6, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.975 Vali Acc: 0.761 Test Loss: 0.975 Test Acc: 0.761
Validation loss decreased (-0.705544 --> -0.761101).  Saving model ...
Epoch: 7 cost time: 0.8587586879730225
Epoch: 7, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.833 Vali Acc: 0.772 Test Loss: 0.833 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 1.0427744388580322
Epoch: 8, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 9 cost time: 0.9144177436828613
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
Validation loss decreased (-0.783326 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.8695714473724365
Epoch: 10, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.552 Vali Acc: 0.817 Test Loss: 0.552 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8252806663513184
Epoch: 11, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.8468775749206543
Epoch: 12, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 13 cost time: 0.7389183044433594
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9032454490661621
Epoch: 14, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.8534092903137207
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9158921241760254
Epoch: 16, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.9041478633880615
Epoch: 17, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.00767183303833
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8281393051147461
Epoch: 19, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9777059555053711
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.141836404800415
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9538755416870117
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9554660320281982
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 1.0218868255615234
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8591136932373047
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8982875347137451
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0882294178009033
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0639722347259521
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8287570476531982
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.911 Test Loss: 0.200 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0308117866516113
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9471938610076904
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.906 Test Loss: 0.189 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9746894836425781
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9646472930908203
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36092
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7525830268859863
Epoch: 1, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.673 Vali Acc: 0.267 Test Loss: 1.673 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 0.8751587867736816
Epoch: 2, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.543 Vali Acc: 0.428 Test Loss: 1.543 Test Acc: 0.428
Validation loss decreased (-0.266650 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 0.7622876167297363
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
Validation loss decreased (-0.427762 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 0.968205451965332
Epoch: 4, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.213 Vali Acc: 0.711 Test Loss: 1.213 Test Acc: 0.711
Validation loss decreased (-0.594431 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 0.9140098094940186
Epoch: 5, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
Validation loss decreased (-0.711099 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.9211382865905762
Epoch: 6, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.889 Vali Acc: 0.772 Test Loss: 0.889 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 7 cost time: 0.847196102142334
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.760 Vali Acc: 0.778 Test Loss: 0.760 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 0.7483904361724854
Epoch: 8, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 0.824303150177002
Epoch: 9, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 0.81679368019104
Epoch: 10, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.862189769744873
Epoch: 11, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.7258574962615967
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8098762035369873
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 14 cost time: 0.8350038528442383
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 0.8557934761047363
Epoch: 15, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7876019477844238
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9791221618652344
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.895012378692627
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 0.969132661819458
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 0.9244904518127441
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9351632595062256
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7397286891937256
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.8329861164093018
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.0422883033752441
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 1.0044052600860596
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8936319351196289
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7873971462249756
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9212112426757812
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7971911430358887
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7704644203186035
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8063032627105713
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9876000881195068
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8692071437835693
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8883833885192871
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 35836
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1655807495117188
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.718 Vali Acc: 0.211 Test Loss: 1.718 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.8707926273345947
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.584 Vali Acc: 0.378 Test Loss: 1.584 Test Acc: 0.378
Validation loss decreased (-0.211094 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.8537802696228027
Epoch: 3, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
Validation loss decreased (-0.377762 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.6560535430908203
Epoch: 4, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.248 Vali Acc: 0.594 Test Loss: 1.248 Test Acc: 0.594
Validation loss decreased (-0.499986 --> -0.594432).  Saving model ...
Epoch: 5 cost time: 0.6452066898345947
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
Validation loss decreased (-0.594432 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 0.698206901550293
Epoch: 6, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.788501501083374
Epoch: 7, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 0.6964373588562012
Epoch: 8, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.87058424949646
Epoch: 9, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.607 Vali Acc: 0.772 Test Loss: 0.607 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 10 cost time: 0.805455207824707
Epoch: 10, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.6407210826873779
Epoch: 11, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.6487154960632324
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6673424243927002
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 0.8025481700897217
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.714531421661377
Epoch: 15, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.8228065967559814
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.8258445262908936
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7472686767578125
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7345314025878906
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7369945049285889
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.8224239349365234
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8409123420715332
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9855453968048096
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.6650755405426025
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0177640914916992
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8333213329315186
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9934916496276855
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6805083751678467
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9877314567565918
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8564865589141846
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9106314182281494
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7253174781799316
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8274550437927246
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 35580
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3610875606536865
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.718 Vali Acc: 0.211 Test Loss: 1.718 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.713564395904541
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.584 Vali Acc: 0.378 Test Loss: 1.584 Test Acc: 0.378
Validation loss decreased (-0.211094 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.7704846858978271
Epoch: 3, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
Validation loss decreased (-0.377762 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.763587236404419
Epoch: 4, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.248 Vali Acc: 0.594 Test Loss: 1.248 Test Acc: 0.594
Validation loss decreased (-0.499986 --> -0.594432).  Saving model ...
Epoch: 5 cost time: 0.8207674026489258
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
Validation loss decreased (-0.594432 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 0.7055134773254395
Epoch: 6, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.6844582557678223
Epoch: 7, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 0.7877771854400635
Epoch: 8, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.6570224761962891
Epoch: 9, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.607 Vali Acc: 0.772 Test Loss: 0.607 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 10 cost time: 0.8408679962158203
Epoch: 10, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.7330129146575928
Epoch: 11, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.777259349822998
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8488020896911621
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 0.7013757228851318
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8271024227142334
Epoch: 15, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.6869573593139648
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.8254683017730713
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7260837554931641
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8405370712280273
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9515895843505859
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.7672574520111084
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.018437385559082
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.841930627822876
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.0592195987701416
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8676965236663818
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9925515651702881
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9616553783416748
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7798526287078857
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0385894775390625
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7701570987701416
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9600362777709961
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8626329898834229
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9973340034484863
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 35580
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7692997455596924
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.849 Vali Acc: 0.172 Test Loss: 1.849 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.3903684616088867
Epoch: 2, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.711 Vali Acc: 0.267 Test Loss: 1.711 Test Acc: 0.267
Validation loss decreased (-0.172204 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 1.294921636581421
Epoch: 3, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.538 Vali Acc: 0.444 Test Loss: 1.538 Test Acc: 0.444
Validation loss decreased (-0.266650 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 1.333745002746582
Epoch: 4, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.353 Vali Acc: 0.644 Test Loss: 1.353 Test Acc: 0.644
Validation loss decreased (-0.444429 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 1.2388582229614258
Epoch: 5, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.168 Vali Acc: 0.711 Test Loss: 1.168 Test Acc: 0.711
Validation loss decreased (-0.644431 --> -0.711099).  Saving model ...
Epoch: 6 cost time: 1.317749261856079
Epoch: 6, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.001 Vali Acc: 0.717 Test Loss: 1.001 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 1.1509180068969727
Epoch: 7, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.857 Vali Acc: 0.733 Test Loss: 0.857 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 8 cost time: 1.3867104053497314
Epoch: 8, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 1.3557653427124023
Epoch: 9, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 1.3062784671783447
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.4177374839782715
Epoch: 11, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.512 Vali Acc: 0.800 Test Loss: 0.512 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 1.1354320049285889
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 1.291184902191162
Epoch: 13, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
Validation loss decreased (-0.799995 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 1.079942226409912
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1787021160125732
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
Validation loss decreased (-0.844440 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 1.0851881504058838
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 1.1199727058410645
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 1.0888495445251465
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0442335605621338
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.000915765762329
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.916663 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 1.092482328414917
Epoch: 21, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.153383493423462
Epoch: 22, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2402563095092773
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2348430156707764
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.169154405593872
Epoch: 25, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1270248889923096
Epoch: 26, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3388140201568604
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2978992462158203
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.313216209411621
Epoch: 29, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1753802299499512
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 36332
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.994553327560425
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.708 Vali Acc: 0.217 Test Loss: 1.708 Test Acc: 0.217
Validation loss decreased (inf --> -0.216650).  Saving model ...
Epoch: 2 cost time: 0.9761130809783936
Epoch: 2, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.582 Vali Acc: 0.378 Test Loss: 1.582 Test Acc: 0.378
Validation loss decreased (-0.216650 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 1.18790602684021
Epoch: 3, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.431 Vali Acc: 0.589 Test Loss: 1.431 Test Acc: 0.589
Validation loss decreased (-0.377762 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.9789869785308838
Epoch: 4, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.274 Vali Acc: 0.639 Test Loss: 1.274 Test Acc: 0.639
Validation loss decreased (-0.588875 --> -0.638876).  Saving model ...
Epoch: 5 cost time: 0.9678876399993896
Epoch: 5, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.122 Vali Acc: 0.667 Test Loss: 1.122 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 1.0778250694274902
Epoch: 6, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.975 Vali Acc: 0.689 Test Loss: 0.975 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688879).  Saving model ...
Epoch: 7 cost time: 1.215453863143921
Epoch: 7, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716658).  Saving model ...
Epoch: 8 cost time: 1.090533971786499
Epoch: 8, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 1.1229498386383057
Epoch: 9, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 0.9733095169067383
Epoch: 10, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 0.9492814540863037
Epoch: 11, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 0.9809744358062744
Epoch: 12, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.490 Vali Acc: 0.806 Test Loss: 0.490 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.1854770183563232
Epoch: 13, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.458 Vali Acc: 0.811 Test Loss: 0.458 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.9600145816802979
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 1.0836424827575684
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 1.0388669967651367
Epoch: 16, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 1.0253868103027344
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.0755672454833984
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 0.9949076175689697
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 0.969613790512085
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.032564640045166
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.9466545581817627
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.188300371170044
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.1173646450042725
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.0938222408294678
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.2226719856262207
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.101977825164795
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0194497108459473
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 0.9657025337219238
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 1.0082440376281738
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.0027129650115967
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.20051908493042
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 0.9752469062805176
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 1.103454351425171
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.0406787395477295
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 0.9836182594299316
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1111493110656738
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0278091430664062
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1200916767120361
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1840450763702393
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.126481294631958
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0399134159088135
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1932146549224854
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9136044979095459
Epoch: 44, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2515287399291992
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 36076
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7831099033355713
Epoch: 1, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.883 Vali Acc: 0.167 Test Loss: 1.883 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.9050590991973877
Epoch: 2, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.731 Vali Acc: 0.211 Test Loss: 1.731 Test Acc: 0.211
Validation loss decreased (-0.166648 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 1.1298940181732178
Epoch: 3, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.549 Vali Acc: 0.361 Test Loss: 1.549 Test Acc: 0.361
Validation loss decreased (-0.211094 --> -0.361096).  Saving model ...
Epoch: 4 cost time: 1.0485379695892334
Epoch: 4, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.363 Vali Acc: 0.583 Test Loss: 1.363 Test Acc: 0.583
Validation loss decreased (-0.361096 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 0.9578509330749512
Epoch: 5, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.178 Vali Acc: 0.711 Test Loss: 1.178 Test Acc: 0.711
Validation loss decreased (-0.583320 --> -0.711099).  Saving model ...
Epoch: 6 cost time: 0.9500093460083008
Epoch: 6, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.004 Vali Acc: 0.761 Test Loss: 1.004 Test Acc: 0.761
Validation loss decreased (-0.711099 --> -0.761101).  Saving model ...
Epoch: 7 cost time: 1.0639686584472656
Epoch: 7, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.856 Vali Acc: 0.756 Test Loss: 0.856 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9533076286315918
Epoch: 8, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
Validation loss decreased (-0.761101 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 1.0472512245178223
Epoch: 9, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 0.94443678855896
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.573 Vali Acc: 0.794 Test Loss: 0.573 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 0.9406106472015381
Epoch: 11, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 0.9570612907409668
Epoch: 12, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0545859336853027
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.0282113552093506
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.0654945373535156
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.398 Vali Acc: 0.844 Test Loss: 0.398 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1131737232208252
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 1.03232741355896
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 0.8342719078063965
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 0.983961820602417
Epoch: 19, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1165385246276855
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0596024990081787
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 0.8808739185333252
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0080499649047852
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 0.9865877628326416
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8491940498352051
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 0.9832582473754883
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9323780536651611
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0750882625579834
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9944264888763428
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0248498916625977
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0328524112701416
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.0195319652557373
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.019881248474121
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9367063045501709
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 35 cost time: 1.1977367401123047
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.245 Vali Acc: 0.883 Test Loss: 0.245 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9744775295257568
Epoch: 36, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9416873455047607
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9688310623168945
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0664403438568115
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.143632173538208
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 41 cost time: 1.071732521057129
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9277040958404541
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 43 cost time: 1.0502970218658447
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0097594261169434
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 45 cost time: 1.045034646987915
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 46 cost time: 0.9830458164215088
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8731839656829834
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8515312671661377
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1034889221191406
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1710994243621826
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9178731441497803
Epoch: 51, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.3900325298309326
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.97110915184021
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.128396987915039
Epoch: 54, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.09574294090271
Epoch: 55, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 35564
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.037729501724243
Epoch: 1, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.771 Vali Acc: 0.261 Test Loss: 1.771 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 1.2211859226226807
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.620 Vali Acc: 0.422 Test Loss: 1.620 Test Acc: 0.422
Validation loss decreased (-0.261093 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 1.1181862354278564
Epoch: 3, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.439 Vali Acc: 0.550 Test Loss: 1.439 Test Acc: 0.550
Validation loss decreased (-0.422206 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 0.9782781600952148
Epoch: 4, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.252 Vali Acc: 0.628 Test Loss: 1.252 Test Acc: 0.628
Validation loss decreased (-0.549986 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 1.132366418838501
Epoch: 5, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.069 Vali Acc: 0.694 Test Loss: 1.069 Test Acc: 0.694
Validation loss decreased (-0.627765 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 1.0158412456512451
Epoch: 6, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.907 Vali Acc: 0.744 Test Loss: 0.907 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.055755615234375
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
Validation loss decreased (-0.744435 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 0.9144511222839355
Epoch: 8, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783327).  Saving model ...
Epoch: 9 cost time: 1.251718521118164
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 1.1815714836120605
Epoch: 10, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.524 Vali Acc: 0.817 Test Loss: 0.524 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 1.0973141193389893
Epoch: 11, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.0915160179138184
Epoch: 12, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.437 Vali Acc: 0.839 Test Loss: 0.437 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.1228611469268799
Epoch: 13, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.1083276271820068
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1944429874420166
Epoch: 15, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 1.035517930984497
Epoch: 16, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.1205904483795166
Epoch: 17, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.1146998405456543
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.9537301063537598
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.879340648651123
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.091254711151123
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.0426723957061768
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8704447746276855
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8344709873199463
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.777564525604248
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8659236431121826
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.175050973892212
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.038452386856079
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0136549472808838
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.867708683013916
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9337484836578369
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0732238292694092
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.055396556854248
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2057769298553467
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.049612045288086
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.200 Vali Acc: 0.894 Test Loss: 0.200 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1345758438110352
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.039855718612671
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 1.1728427410125732
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3337187767028809
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 1.131608486175537
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0733988285064697
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1642625331878662
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.634596347808838
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.9706928730010986
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3939604759216309
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2964801788330078
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1394133567810059
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.906 Test Loss: 0.195 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0531716346740723
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3072354793548584
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1175658702850342
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.267185926437378
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9961800575256348
Epoch: 52, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.038254976272583
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 35308
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2517096996307373
Epoch: 1, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.635 Vali Acc: 0.378 Test Loss: 1.635 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.8537108898162842
Epoch: 2, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
Validation loss decreased (-0.377761 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 1.090747594833374
Epoch: 3, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.342 Vali Acc: 0.667 Test Loss: 1.342 Test Acc: 0.667
Validation loss decreased (-0.511096 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.9820957183837891
Epoch: 4, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.182 Vali Acc: 0.717 Test Loss: 1.182 Test Acc: 0.717
Validation loss decreased (-0.666653 --> -0.716655).  Saving model ...
Epoch: 5 cost time: 0.7937629222869873
Epoch: 5, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.024 Vali Acc: 0.739 Test Loss: 1.024 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738879).  Saving model ...
Epoch: 6 cost time: 0.9760880470275879
Epoch: 6, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.8089945316314697
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.1625733375549316
Epoch: 8, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.651 Vali Acc: 0.794 Test Loss: 0.651 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.0339207649230957
Epoch: 9, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.571 Vali Acc: 0.767 Test Loss: 0.571 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8673536777496338
Epoch: 10, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.514 Vali Acc: 0.778 Test Loss: 0.514 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9053614139556885
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.9308757781982422
Epoch: 12, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.436 Vali Acc: 0.828 Test Loss: 0.436 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 0.949882984161377
Epoch: 13, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.8291676044464111
Epoch: 14, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 0.940645694732666
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.363 Vali Acc: 0.872 Test Loss: 0.363 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 0.8769912719726562
Epoch: 16, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.8195171356201172
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.9671661853790283
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.8930315971374512
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.000464677810669
Epoch: 20, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.7976157665252686
Epoch: 21, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9058499336242676
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.8487911224365234
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.8296377658843994
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 0.8639318943023682
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 0.7890520095825195
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8561697006225586
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8101377487182617
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.8746814727783203
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 0.8660550117492676
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7874982357025146
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.8656766414642334
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9302997589111328
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8280420303344727
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8707969188690186
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 0.86281418800354
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7877473831176758
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 38 cost time: 0.7999801635742188
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 39 cost time: 0.865908145904541
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8325488567352295
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8718447685241699
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9476778507232666
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7723548412322998
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9073090553283691
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0671427249908447
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8985934257507324
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.8898658752441406
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.8485100269317627
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7497372627258301
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9876925945281982
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7851381301879883
Epoch: 51, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.027402400970459
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0058488845825195
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8208844661712646
Epoch: 54, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9129147529602051
Epoch: 55, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8881890773773193
Epoch: 56, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.8212449550628662
Epoch: 57, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 35052
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4483277797698975
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.789 Vali Acc: 0.183 Test Loss: 1.789 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 0.7502179145812988
Epoch: 2, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.649 Vali Acc: 0.317 Test Loss: 1.649 Test Acc: 0.317
Validation loss decreased (-0.183315 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 1.2818889617919922
Epoch: 3, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.475 Vali Acc: 0.494 Test Loss: 1.475 Test Acc: 0.494
Validation loss decreased (-0.316650 --> -0.494430).  Saving model ...
Epoch: 4 cost time: 1.0636951923370361
Epoch: 4, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.302 Vali Acc: 0.617 Test Loss: 1.302 Test Acc: 0.617
Validation loss decreased (-0.494430 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 0.8832817077636719
Epoch: 5, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.128 Vali Acc: 0.689 Test Loss: 1.128 Test Acc: 0.689
Validation loss decreased (-0.616654 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 1.200648546218872
Epoch: 6, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 0.9433343410491943
Epoch: 7, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.845 Vali Acc: 0.767 Test Loss: 0.845 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 1.212101697921753
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8968825340270996
Epoch: 9, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.9712479114532471
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.587 Vali Acc: 0.811 Test Loss: 0.587 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 1.0095570087432861
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 0.8886682987213135
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 0.8226606845855713
Epoch: 13, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.450 Vali Acc: 0.839 Test Loss: 0.450 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 0.8559751510620117
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 15 cost time: 1.0030968189239502
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.384 Vali Acc: 0.872 Test Loss: 0.384 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.8853797912597656
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.872218 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 1.0154650211334229
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.167743444442749
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1857500076293945
Epoch: 19, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 1.0263357162475586
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1588594913482666
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 1.2012829780578613
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 1.2646152973175049
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.1920182704925537
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9972443580627441
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3234117031097412
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1467907428741455
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1076221466064453
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.191749095916748
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0713131427764893
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0366036891937256
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.85382080078125
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.94183349609375
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0491247177124023
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 34796
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.149036169052124
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.789 Vali Acc: 0.183 Test Loss: 1.789 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 0.7746655941009521
Epoch: 2, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.649 Vali Acc: 0.317 Test Loss: 1.649 Test Acc: 0.317
Validation loss decreased (-0.183315 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 0.8042266368865967
Epoch: 3, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.475 Vali Acc: 0.494 Test Loss: 1.475 Test Acc: 0.494
Validation loss decreased (-0.316650 --> -0.494430).  Saving model ...
Epoch: 4 cost time: 0.8601982593536377
Epoch: 4, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.302 Vali Acc: 0.617 Test Loss: 1.302 Test Acc: 0.617
Validation loss decreased (-0.494430 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 0.8047764301300049
Epoch: 5, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.128 Vali Acc: 0.689 Test Loss: 1.128 Test Acc: 0.689
Validation loss decreased (-0.616654 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 0.7557373046875
Epoch: 6, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 0.8933491706848145
Epoch: 7, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.845 Vali Acc: 0.767 Test Loss: 0.845 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 0.8080041408538818
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8367719650268555
Epoch: 9, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.7455258369445801
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.587 Vali Acc: 0.811 Test Loss: 0.587 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 0.7806646823883057
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 0.9517796039581299
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 0.8009545803070068
Epoch: 13, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.450 Vali Acc: 0.839 Test Loss: 0.450 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 0.8771774768829346
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 15 cost time: 0.8825149536132812
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.384 Vali Acc: 0.872 Test Loss: 0.384 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.9668934345245361
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.872218 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.9877886772155762
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1441147327423096
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0897188186645508
Epoch: 19, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 0.8686878681182861
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8057091236114502
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.872734785079956
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.7064588069915771
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.8479981422424316
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.8961589336395264
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9927554130554199
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7209429740905762
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8879590034484863
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9085032939910889
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8871243000030518
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7812635898590088
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7606332302093506
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6459007263183594
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8743095397949219
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 34796
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.114201068878174
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.761 Vali Acc: 0.222 Test Loss: 1.761 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.1779699325561523
Epoch: 2, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.624 Vali Acc: 0.372 Test Loss: 1.624 Test Acc: 0.372
Validation loss decreased (-0.222205 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 1.2683546543121338
Epoch: 3, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.470 Vali Acc: 0.561 Test Loss: 1.470 Test Acc: 0.561
Validation loss decreased (-0.372206 --> -0.561096).  Saving model ...
Epoch: 4 cost time: 1.1653172969818115
Epoch: 4, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.307 Vali Acc: 0.667 Test Loss: 1.307 Test Acc: 0.667
Validation loss decreased (-0.561096 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 1.3074493408203125
Epoch: 5, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.148 Vali Acc: 0.717 Test Loss: 1.148 Test Acc: 0.717
Validation loss decreased (-0.666654 --> -0.716655).  Saving model ...
Epoch: 6 cost time: 1.3715429306030273
Epoch: 6, Steps: 12 | Train Loss: 0.989 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 1.0546538829803467
Epoch: 7, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 1.0734026432037354
Epoch: 8, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 9 cost time: 1.4510064125061035
Epoch: 9, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.1831235885620117
Epoch: 10, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 1.309915542602539
Epoch: 11, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.557 Vali Acc: 0.806 Test Loss: 0.557 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3003976345062256
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 1.366825819015503
Epoch: 13, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.3719556331634521
Epoch: 14, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 1.5026719570159912
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
Validation loss decreased (-0.833329 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 1.4244205951690674
Epoch: 16, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.398 Vali Acc: 0.856 Test Loss: 0.398 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4147741794586182
Epoch: 17, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 1.2085566520690918
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 1.1005828380584717
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 1.1021053791046143
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.1842257976531982
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.352264642715454
Epoch: 22, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 23 cost time: 1.2504456043243408
Epoch: 23, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2468650341033936
Epoch: 24, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.244847297668457
Epoch: 25, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.234792947769165
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.116349697113037
Epoch: 27, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.3758046627044678
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.219027042388916
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2878036499023438
Epoch: 30, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3988842964172363
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.396653652191162
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.1707088947296143
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 1.2687809467315674
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1244328022003174
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0632998943328857
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.096583366394043
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8717596530914307
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0827398300170898
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2620062828063965
Epoch: 40, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.245835304260254
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.207 Vali Acc: 0.883 Test Loss: 0.207 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2414474487304688
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 1.4559047222137451
Epoch: 43, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1043508052825928
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.900 Test Loss: 0.201 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3629813194274902
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.196 Vali Acc: 0.894 Test Loss: 0.196 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.175079584121704
Epoch: 46, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1072285175323486
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9884014129638672
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.894 Test Loss: 0.192 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1880402565002441
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.883 Test Loss: 0.193 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0566215515136719
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.900 Test Loss: 0.194 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.3019192218780518
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.889 Test Loss: 0.188 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.398911714553833
Epoch: 52, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.900 Test Loss: 0.188 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 35940
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.793461799621582
Epoch: 1, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.840 Vali Acc: 0.172 Test Loss: 1.840 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.2490830421447754
Epoch: 2, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.716 Vali Acc: 0.244 Test Loss: 1.716 Test Acc: 0.244
Validation loss decreased (-0.172204 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 1.1801469326019287
Epoch: 3, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.556 Vali Acc: 0.400 Test Loss: 1.556 Test Acc: 0.400
Validation loss decreased (-0.244427 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.1559598445892334
Epoch: 4, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.388 Vali Acc: 0.600 Test Loss: 1.388 Test Acc: 0.600
Validation loss decreased (-0.399984 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 1.1101336479187012
Epoch: 5, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.226 Vali Acc: 0.683 Test Loss: 1.226 Test Acc: 0.683
Validation loss decreased (-0.599986 --> -0.683321).  Saving model ...
Epoch: 6 cost time: 0.9913547039031982
Epoch: 6, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.065 Vali Acc: 0.728 Test Loss: 1.065 Test Acc: 0.728
Validation loss decreased (-0.683321 --> -0.727767).  Saving model ...
Epoch: 7 cost time: 0.9469926357269287
Epoch: 7, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.920 Vali Acc: 0.767 Test Loss: 0.920 Test Acc: 0.767
Validation loss decreased (-0.727767 --> -0.766657).  Saving model ...
Epoch: 8 cost time: 0.9080541133880615
Epoch: 8, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.0238609313964844
Epoch: 9, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.701 Vali Acc: 0.778 Test Loss: 0.701 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8853898048400879
Epoch: 10, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.012084722518921
Epoch: 11, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.560 Vali Acc: 0.817 Test Loss: 0.560 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 12 cost time: 1.072608470916748
Epoch: 12, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.515 Vali Acc: 0.811 Test Loss: 0.515 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0272762775421143
Epoch: 13, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.475 Vali Acc: 0.839 Test Loss: 0.475 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 0.8941800594329834
Epoch: 14, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.444 Vali Acc: 0.839 Test Loss: 0.444 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 15 cost time: 0.8687400817871094
Epoch: 15, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.9586091041564941
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.9956748485565186
Epoch: 17, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 0.8585755825042725
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 1.2666940689086914
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1770515441894531
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1348564624786377
Epoch: 21, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2167277336120605
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1294639110565186
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9296305179595947
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 0.9037497043609619
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.9460690021514893
Epoch: 26, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9679629802703857
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.2528867721557617
Epoch: 28, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2479040622711182
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9030029773712158
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1251142024993896
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1428592205047607
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1180684566497803
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0865201950073242
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.30306077003479
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 36 cost time: 1.0847694873809814
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0086686611175537
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9321415424346924
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9985589981079102
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8532059192657471
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0330531597137451
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.9268245697021484
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0139868259429932
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.068420171737671
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0331735610961914
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2145202159881592
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.30059814453125
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2204043865203857
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9705667495727539
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0177867412567139
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9669101238250732
Epoch: 51, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 35684
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.427654504776001
Epoch: 1, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.635 Vali Acc: 0.394 Test Loss: 1.635 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 0.9969196319580078
Epoch: 2, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.512 Vali Acc: 0.489 Test Loss: 1.512 Test Acc: 0.489
Validation loss decreased (-0.394428 --> -0.488874).  Saving model ...
Epoch: 3 cost time: 0.8923745155334473
Epoch: 3, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.366 Vali Acc: 0.617 Test Loss: 1.366 Test Acc: 0.617
Validation loss decreased (-0.488874 --> -0.616653).  Saving model ...
Epoch: 4 cost time: 0.8781955242156982
Epoch: 4, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.218 Vali Acc: 0.672 Test Loss: 1.218 Test Acc: 0.672
Validation loss decreased (-0.616653 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 0.9878613948822021
Epoch: 5, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.070 Vali Acc: 0.733 Test Loss: 1.070 Test Acc: 0.733
Validation loss decreased (-0.672210 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 0.9039211273193359
Epoch: 6, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.938 Vali Acc: 0.739 Test Loss: 0.938 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.9645373821258545
Epoch: 7, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.816 Vali Acc: 0.767 Test Loss: 0.816 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 0.843339204788208
Epoch: 8, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 0.7444183826446533
Epoch: 9, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.635 Vali Acc: 0.817 Test Loss: 0.635 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 10 cost time: 0.7340412139892578
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822217).  Saving model ...
Epoch: 11 cost time: 0.8091893196105957
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 0.9282212257385254
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.8308544158935547
Epoch: 13, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0259521007537842
Epoch: 14, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 0.9285027980804443
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.8696596622467041
Epoch: 16, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9572288990020752
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905552).  Saving model ...
Epoch: 18 cost time: 0.8195474147796631
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.7989072799682617
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 20 cost time: 0.9841406345367432
Epoch: 20, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 21 cost time: 0.9391045570373535
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.8496525287628174
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.7331333160400391
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 0.8514387607574463
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0004403591156006
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8625411987304688
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8423562049865723
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9820842742919922
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.033670425415039
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8990116119384766
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0157954692840576
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8044121265411377
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9583055973052979
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 35172
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3131470680236816
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.778 Vali Acc: 0.211 Test Loss: 1.778 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.0465445518493652
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.631 Vali Acc: 0.350 Test Loss: 1.631 Test Acc: 0.350
Validation loss decreased (-0.211093 --> -0.349984).  Saving model ...
Epoch: 3 cost time: 0.8565976619720459
Epoch: 3, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.456 Vali Acc: 0.522 Test Loss: 1.456 Test Acc: 0.522
Validation loss decreased (-0.349984 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 0.756727933883667
Epoch: 4, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.281 Vali Acc: 0.661 Test Loss: 1.281 Test Acc: 0.661
Validation loss decreased (-0.522208 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 0.8787851333618164
Epoch: 5, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.119 Vali Acc: 0.711 Test Loss: 1.119 Test Acc: 0.711
Validation loss decreased (-0.661098 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 0.7342605590820312
Epoch: 6, Steps: 12 | Train Loss: 0.983 Vali Loss: 0.967 Vali Acc: 0.761 Test Loss: 0.967 Test Acc: 0.761
Validation loss decreased (-0.711100 --> -0.761101).  Saving model ...
Epoch: 7 cost time: 0.7331552505493164
Epoch: 7, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.858189582824707
Epoch: 8, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
Validation loss decreased (-0.761101 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 0.7840754985809326
Epoch: 9, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 0.700547456741333
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822217).  Saving model ...
Epoch: 11 cost time: 0.797896146774292
Epoch: 11, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 12 cost time: 0.6705029010772705
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.8959293365478516
Epoch: 13, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
Validation loss decreased (-0.861107 --> -0.894440).  Saving model ...
Epoch: 14 cost time: 0.8170676231384277
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.6875302791595459
Epoch: 15, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8515541553497314
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8257126808166504
Epoch: 17, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 0.8279590606689453
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7783868312835693
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 0.8384952545166016
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8360838890075684
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8008637428283691
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.7278957366943359
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.8634665012359619
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.234 Vali Acc: 0.939 Test Loss: 0.234 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 25 cost time: 0.7679767608642578
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 0.7304885387420654
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.9579365253448486
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7718551158905029
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8268234729766846
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8368964195251465
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8691413402557373
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6842913627624512
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8024294376373291
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9551887512207031
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.865781307220459
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8037698268890381
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 34916
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.078665018081665
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.715 Vali Acc: 0.250 Test Loss: 1.715 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.7277772426605225
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.589 Vali Acc: 0.361 Test Loss: 1.589 Test Acc: 0.361
Validation loss decreased (-0.249983 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 0.6979196071624756
Epoch: 3, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.434 Vali Acc: 0.489 Test Loss: 1.434 Test Acc: 0.489
Validation loss decreased (-0.361095 --> -0.488875).  Saving model ...
Epoch: 4 cost time: 0.6967227458953857
Epoch: 4, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.271 Vali Acc: 0.678 Test Loss: 1.271 Test Acc: 0.678
Validation loss decreased (-0.488875 --> -0.677765).  Saving model ...
Epoch: 5 cost time: 0.7475190162658691
Epoch: 5, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.111 Vali Acc: 0.717 Test Loss: 1.111 Test Acc: 0.717
Validation loss decreased (-0.677765 --> -0.716656).  Saving model ...
Epoch: 6 cost time: 0.6630477905273438
Epoch: 6, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 0.6559329032897949
Epoch: 7, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.838 Vali Acc: 0.744 Test Loss: 0.838 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 0.679980993270874
Epoch: 8, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.721 Vali Acc: 0.756 Test Loss: 0.721 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 0.8458993434906006
Epoch: 9, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
Validation loss decreased (-0.755548 --> -0.816660).  Saving model ...
Epoch: 10 cost time: 0.7058792114257812
Epoch: 10, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 11 cost time: 0.8722798824310303
Epoch: 11, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 0.6416597366333008
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.474 Vali Acc: 0.806 Test Loss: 0.474 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8099002838134766
Epoch: 13, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.715956449508667
Epoch: 14, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 0.808929443359375
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.6470420360565186
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 0.6873915195465088
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 0.6551599502563477
Epoch: 18, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8561911582946777
Epoch: 19, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.7316336631774902
Epoch: 20, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6510906219482422
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.7289376258850098
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 0.6433310508728027
Epoch: 23, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 0.7746973037719727
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 0.7540059089660645
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 0.7564573287963867
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8319840431213379
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.76259446144104
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 0.761239767074585
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 0.729536771774292
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 0.865520715713501
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7996852397918701
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6440672874450684
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.8316848278045654
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8237636089324951
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.87380051612854
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8990795612335205
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7441630363464355
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7427108287811279
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6907541751861572
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7971103191375732
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8319888114929199
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 0.7332460880279541
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9371240139007568
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7796988487243652
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7176015377044678
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8229122161865234
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7068796157836914
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8541688919067383
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7243263721466064
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8578519821166992
Epoch: 51, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7393503189086914
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 34660
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.282400131225586
Epoch: 1, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.842 Vali Acc: 0.161 Test Loss: 1.842 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.6826450824737549
Epoch: 2, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
Validation loss decreased (-0.161093 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.6230130195617676
Epoch: 3, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.523 Vali Acc: 0.489 Test Loss: 1.523 Test Acc: 0.489
Validation loss decreased (-0.277761 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 0.6711845397949219
Epoch: 4, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.352 Vali Acc: 0.617 Test Loss: 1.352 Test Acc: 0.617
Validation loss decreased (-0.488874 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 0.6903927326202393
Epoch: 5, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.184 Vali Acc: 0.672 Test Loss: 1.184 Test Acc: 0.672
Validation loss decreased (-0.616653 --> -0.672210).  Saving model ...
Epoch: 6 cost time: 0.7113504409790039
Epoch: 6, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
Validation loss decreased (-0.672210 --> -0.733323).  Saving model ...
Epoch: 7 cost time: 0.6996769905090332
Epoch: 7, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 8 cost time: 0.7491722106933594
Epoch: 8, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 0.5628345012664795
Epoch: 9, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 0.6442666053771973
Epoch: 10, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 0.6134366989135742
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6365652084350586
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.499 Vali Acc: 0.839 Test Loss: 0.499 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 0.7047319412231445
Epoch: 13, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6357331275939941
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.436 Vali Acc: 0.828 Test Loss: 0.436 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8357493877410889
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855551).  Saving model ...
Epoch: 16 cost time: 0.7509233951568604
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7186517715454102
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6984407901763916
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.361 Vali Acc: 0.872 Test Loss: 0.361 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 0.7223455905914307
Epoch: 19, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 0.6821906566619873
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 0.644819974899292
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6672954559326172
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9272847175598145
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.7511370182037354
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6654722690582275
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.8120112419128418
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 0.5982544422149658
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 0.6595780849456787
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6561644077301025
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 0.639235258102417
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8189711570739746
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6956961154937744
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 0.6632025241851807
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.7162115573883057
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.691319465637207
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8028154373168945
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 37 cost time: 0.7124989032745361
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7343094348907471
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 39 cost time: 0.7356781959533691
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7601356506347656
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 0.7773854732513428
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 0.6719150543212891
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8267083168029785
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7093653678894043
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 0.6238491535186768
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6359283924102783
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6786067485809326
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6832168102264404
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7946858406066895
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7276265621185303
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8166899681091309
Epoch: 51, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8013167381286621
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6300857067108154
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.889 Test Loss: 0.205 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6593198776245117
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 34404
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2358431816101074
Epoch: 1, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.842 Vali Acc: 0.161 Test Loss: 1.842 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.6698205471038818
Epoch: 2, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
Validation loss decreased (-0.161093 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.6641871929168701
Epoch: 3, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.523 Vali Acc: 0.489 Test Loss: 1.523 Test Acc: 0.489
Validation loss decreased (-0.277761 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 0.8422708511352539
Epoch: 4, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.352 Vali Acc: 0.617 Test Loss: 1.352 Test Acc: 0.617
Validation loss decreased (-0.488874 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 0.6637430191040039
Epoch: 5, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.184 Vali Acc: 0.672 Test Loss: 1.184 Test Acc: 0.672
Validation loss decreased (-0.616653 --> -0.672210).  Saving model ...
Epoch: 6 cost time: 0.7098269462585449
Epoch: 6, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
Validation loss decreased (-0.672210 --> -0.733323).  Saving model ...
Epoch: 7 cost time: 0.6953468322753906
Epoch: 7, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 8 cost time: 0.7360851764678955
Epoch: 8, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 0.6535823345184326
Epoch: 9, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 0.7908835411071777
Epoch: 10, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 0.6536674499511719
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6352517604827881
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.499 Vali Acc: 0.839 Test Loss: 0.499 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 0.7279939651489258
Epoch: 13, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7491922378540039
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.436 Vali Acc: 0.828 Test Loss: 0.436 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9102706909179688
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855551).  Saving model ...
Epoch: 16 cost time: 0.8819122314453125
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.912893533706665
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7026915550231934
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.361 Vali Acc: 0.872 Test Loss: 0.361 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 0.6744952201843262
Epoch: 19, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 0.6476719379425049
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 0.7135627269744873
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7513208389282227
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6168766021728516
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6931679248809814
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6879334449768066
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5941331386566162
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 0.6914494037628174
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 0.8320040702819824
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8922326564788818
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 0.7178709506988525
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7942578792572021
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6503629684448242
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 0.7088987827301025
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.7394859790802002
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7014439105987549
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6194732189178467
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 37 cost time: 0.6280903816223145
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7682960033416748
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 39 cost time: 0.8010332584381104
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6773409843444824
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 0.678464412689209
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 0.7380106449127197
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.725989818572998
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9126102924346924
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 0.7422423362731934
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7521319389343262
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7516138553619385
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7498419284820557
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8286473751068115
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6924426555633545
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7822568416595459
Epoch: 51, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8720903396606445
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8105671405792236
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.889 Test Loss: 0.205 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7632367610931396
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 34404
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.734656572341919
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.858 Vali Acc: 0.083 Test Loss: 1.858 Test Acc: 0.083
Validation loss decreased (inf --> -0.083315).  Saving model ...
Epoch: 2 cost time: 1.309277057647705
Epoch: 2, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.738 Vali Acc: 0.228 Test Loss: 1.738 Test Acc: 0.228
Validation loss decreased (-0.083315 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 1.2942368984222412
Epoch: 3, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.592 Vali Acc: 0.439 Test Loss: 1.592 Test Acc: 0.439
Validation loss decreased (-0.227760 --> -0.438873).  Saving model ...
Epoch: 4 cost time: 1.0696909427642822
Epoch: 4, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.429 Vali Acc: 0.556 Test Loss: 1.429 Test Acc: 0.556
Validation loss decreased (-0.438873 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 1.037872314453125
Epoch: 5, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.269 Vali Acc: 0.672 Test Loss: 1.269 Test Acc: 0.672
Validation loss decreased (-0.555541 --> -0.672210).  Saving model ...
Epoch: 6 cost time: 1.2497985363006592
Epoch: 6, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.118 Vali Acc: 0.694 Test Loss: 1.118 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694433).  Saving model ...
Epoch: 7 cost time: 1.0851240158081055
Epoch: 7, Steps: 12 | Train Loss: 0.986 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 1.1575403213500977
Epoch: 8, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 1.0526432991027832
Epoch: 9, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 1.047985553741455
Epoch: 10, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 0.9392001628875732
Epoch: 11, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.607 Vali Acc: 0.767 Test Loss: 0.607 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 0.9745519161224365
Epoch: 12, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788883).  Saving model ...
Epoch: 13 cost time: 1.5131494998931885
Epoch: 13, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.042102336883545
Epoch: 14, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822217).  Saving model ...
Epoch: 15 cost time: 1.0069756507873535
Epoch: 15, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.452 Vali Acc: 0.822 Test Loss: 0.452 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 0.9947302341461182
Epoch: 16, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.428 Vali Acc: 0.817 Test Loss: 0.428 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2243058681488037
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 1.0917549133300781
Epoch: 18, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.9983112812042236
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 1.0084826946258545
Epoch: 20, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.350 Vali Acc: 0.878 Test Loss: 0.350 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 1.0074682235717773
Epoch: 21, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 0.9979293346405029
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0597753524780273
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 1.0278089046478271
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0796070098876953
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.0990986824035645
Epoch: 26, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.922518253326416
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9976568222045898
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 1.0725021362304688
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.0462560653686523
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1455984115600586
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0720007419586182
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0344429016113281
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.070415735244751
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0457613468170166
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0063414573669434
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1792171001434326
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0108942985534668
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1532294750213623
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 35744
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6059327125549316
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.832 Vali Acc: 0.144 Test Loss: 1.832 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.8830382823944092
Epoch: 2, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (-0.144426 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 0.884843111038208
Epoch: 3, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.584 Vali Acc: 0.439 Test Loss: 1.584 Test Acc: 0.439
Validation loss decreased (-0.283316 --> -0.438873).  Saving model ...
Epoch: 4 cost time: 1.0166091918945312
Epoch: 4, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.425 Vali Acc: 0.583 Test Loss: 1.425 Test Acc: 0.583
Validation loss decreased (-0.438873 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 0.9223625659942627
Epoch: 5, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.265 Vali Acc: 0.700 Test Loss: 1.265 Test Acc: 0.700
Validation loss decreased (-0.583319 --> -0.699987).  Saving model ...
Epoch: 6 cost time: 0.8745265007019043
Epoch: 6, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.107 Vali Acc: 0.778 Test Loss: 1.107 Test Acc: 0.778
Validation loss decreased (-0.699987 --> -0.777767).  Saving model ...
Epoch: 7 cost time: 0.9473836421966553
Epoch: 7, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.965 Vali Acc: 0.778 Test Loss: 0.965 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777768).  Saving model ...
Epoch: 8 cost time: 0.8803791999816895
Epoch: 8, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.840 Vali Acc: 0.789 Test Loss: 0.840 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 9 cost time: 0.9157810211181641
Epoch: 9, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
Validation loss decreased (-0.788880 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 0.8938360214233398
Epoch: 10, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838882).  Saving model ...
Epoch: 11 cost time: 0.8478398323059082
Epoch: 11, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.8175156116485596
Epoch: 12, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.9347517490386963
Epoch: 13, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 0.9651246070861816
Epoch: 14, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877773).  Saving model ...
Epoch: 15 cost time: 0.983412504196167
Epoch: 15, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.032578468322754
Epoch: 16, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 0.9632220268249512
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.360 Vali Acc: 0.894 Test Loss: 0.360 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.9784114360809326
Epoch: 18, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.9871001243591309
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.162644624710083
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.302 Vali Acc: 0.928 Test Loss: 0.302 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927775).  Saving model ...
Epoch: 21 cost time: 0.908226728439331
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.288 Vali Acc: 0.939 Test Loss: 0.288 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938886).  Saving model ...
Epoch: 22 cost time: 0.8986902236938477
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0377635955810547
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0233800411224365
Epoch: 24, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9852948188781738
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0629444122314453
Epoch: 26, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.977379322052002
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9818434715270996
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.126312017440796
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 1.1485893726348877
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.1275367736816406
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9523758888244629
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.0029401779174805
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9489433765411377
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.955754280090332
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1806063652038574
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 1.0363941192626953
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.180 Vali Acc: 0.939 Test Loss: 0.180 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.065988540649414
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.2157671451568604
Epoch: 39, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.169 Vali Acc: 0.939 Test Loss: 0.169 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9551963806152344
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 1.0455927848815918
Epoch: 41, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1137259006500244
Epoch: 42, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1189045906066895
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1966512203216553
Epoch: 44, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0483248233795166
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.95039963722229
Epoch: 46, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9164741039276123
Epoch: 47, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.939 Test Loss: 0.165 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9134316444396973
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9602084159851074
Epoch: 49, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.939 Test Loss: 0.164 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0397567749023438
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0277886390686035
Epoch: 51, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.939 Test Loss: 0.160 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.059020757675171
Epoch: 52, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9152219295501709
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.079089879989624
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9682390689849854
Epoch: 55, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 35488
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1768269538879395
Epoch: 1, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.856 Vali Acc: 0.161 Test Loss: 1.856 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.9364383220672607
Epoch: 2, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.711 Vali Acc: 0.372 Test Loss: 1.711 Test Acc: 0.372
Validation loss decreased (-0.161093 --> -0.372205).  Saving model ...
Epoch: 3 cost time: 0.8896698951721191
Epoch: 3, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.542 Vali Acc: 0.500 Test Loss: 1.542 Test Acc: 0.500
Validation loss decreased (-0.372205 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 1.026329755783081
Epoch: 4, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.379 Vali Acc: 0.611 Test Loss: 1.379 Test Acc: 0.611
Validation loss decreased (-0.499985 --> -0.611097).  Saving model ...
Epoch: 5 cost time: 0.8685507774353027
Epoch: 5, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.222 Vali Acc: 0.667 Test Loss: 1.222 Test Acc: 0.667
Validation loss decreased (-0.611097 --> -0.666654).  Saving model ...
Epoch: 6 cost time: 0.9482572078704834
Epoch: 6, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.062 Vali Acc: 0.717 Test Loss: 1.062 Test Acc: 0.717
Validation loss decreased (-0.666654 --> -0.716656).  Saving model ...
Epoch: 7 cost time: 0.8896214962005615
Epoch: 7, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 0.9910008907318115
Epoch: 8, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.738880 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.8404767513275146
Epoch: 9, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8996169567108154
Epoch: 10, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8643057346343994
Epoch: 11, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799994).  Saving model ...
Epoch: 12 cost time: 0.9138004779815674
Epoch: 12, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.523 Vali Acc: 0.811 Test Loss: 0.523 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811106).  Saving model ...
Epoch: 13 cost time: 0.9202375411987305
Epoch: 13, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9764647483825684
Epoch: 14, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.8400352001190186
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.425 Vali Acc: 0.839 Test Loss: 0.425 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.8530657291412354
Epoch: 16, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8478503227233887
Epoch: 17, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0404717922210693
Epoch: 18, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 0.9000546932220459
Epoch: 19, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9445397853851318
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 0.920320987701416
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9306797981262207
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8423526287078857
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0064899921417236
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9551503658294678
Epoch: 25, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 0.8615825176239014
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.8983511924743652
Epoch: 27, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9510633945465088
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8752665519714355
Epoch: 29, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8049430847167969
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9149246215820312
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8234996795654297
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8943986892700195
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8503026962280273
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.8462026119232178
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8734920024871826
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8271791934967041
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 0.9362936019897461
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8107199668884277
Epoch: 39, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 0.8406562805175781
Epoch: 40, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9061093330383301
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1097803115844727
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8924946784973145
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.904097318649292
Epoch: 44, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 0.9163453578948975
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 46 cost time: 0.8630743026733398
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0308716297149658
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8748259544372559
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9121921062469482
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7562084197998047
Epoch: 50, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.835352897644043
Epoch: 51, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0029311180114746
Epoch: 52, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9569458961486816
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9067709445953369
Epoch: 54, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.881718635559082
Epoch: 55, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 34976
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7743070125579834
Epoch: 1, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.719 Vali Acc: 0.261 Test Loss: 1.719 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 0.9661462306976318
Epoch: 2, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.605 Vali Acc: 0.400 Test Loss: 1.605 Test Acc: 0.400
Validation loss decreased (-0.261094 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.862525224685669
Epoch: 3, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.469 Vali Acc: 0.483 Test Loss: 1.469 Test Acc: 0.483
Validation loss decreased (-0.399984 --> -0.483319).  Saving model ...
Epoch: 4 cost time: 0.9390811920166016
Epoch: 4, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.325 Vali Acc: 0.606 Test Loss: 1.325 Test Acc: 0.606
Validation loss decreased (-0.483319 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 0.8280353546142578
Epoch: 5, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
Validation loss decreased (-0.605542 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.8309149742126465
Epoch: 6, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.045 Vali Acc: 0.694 Test Loss: 1.045 Test Acc: 0.694
Validation loss decreased (-0.649988 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 0.9363479614257812
Epoch: 7, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.921 Vali Acc: 0.739 Test Loss: 0.921 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 0.7653133869171143
Epoch: 8, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.808 Vali Acc: 0.772 Test Loss: 0.808 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 0.961151123046875
Epoch: 9, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.9314517974853516
Epoch: 10, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 0.8019039630889893
Epoch: 11, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.574 Vali Acc: 0.806 Test Loss: 0.574 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7816705703735352
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 0.8643388748168945
Epoch: 13, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.9038450717926025
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8821284770965576
Epoch: 15, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.422 Vali Acc: 0.856 Test Loss: 0.422 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 16 cost time: 0.8791735172271729
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 0.8975324630737305
Epoch: 17, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.374 Vali Acc: 0.883 Test Loss: 0.374 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 0.7987539768218994
Epoch: 18, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.999880313873291
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.8855118751525879
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 1.058370590209961
Epoch: 21, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.965768575668335
Epoch: 22, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8820199966430664
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0179443359375
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.962897777557373
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0528855323791504
Epoch: 26, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8527107238769531
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9179439544677734
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8918635845184326
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.8378283977508545
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8585960865020752
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 32 cost time: 0.9005074501037598
Epoch: 32, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8496642112731934
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.945112943649292
Epoch: 34, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8474960327148438
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 36 cost time: 0.8228309154510498
Epoch: 36, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 37 cost time: 1.0422477722167969
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 38 cost time: 0.9542274475097656
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7859389781951904
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8037803173065186
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9011635780334473
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.007925271987915
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9631426334381104
Epoch: 43, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0037734508514404
Epoch: 44, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8494846820831299
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7336618900299072
Epoch: 46, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.789438009262085
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 34720
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3238677978515625
Epoch: 1, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.818 Vali Acc: 0.200 Test Loss: 1.818 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.8644561767578125
Epoch: 2, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.666 Vali Acc: 0.339 Test Loss: 1.666 Test Acc: 0.339
Validation loss decreased (-0.199982 --> -0.338872).  Saving model ...
Epoch: 3 cost time: 0.6949687004089355
Epoch: 3, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.492 Vali Acc: 0.567 Test Loss: 1.492 Test Acc: 0.567
Validation loss decreased (-0.338872 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 0.6822917461395264
Epoch: 4, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.320 Vali Acc: 0.639 Test Loss: 1.320 Test Acc: 0.639
Validation loss decreased (-0.566652 --> -0.638876).  Saving model ...
Epoch: 5 cost time: 0.7621181011199951
Epoch: 5, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.156 Vali Acc: 0.717 Test Loss: 1.156 Test Acc: 0.717
Validation loss decreased (-0.638876 --> -0.716655).  Saving model ...
Epoch: 6 cost time: 0.7127487659454346
Epoch: 6, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.001 Vali Acc: 0.739 Test Loss: 1.001 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 0.6750304698944092
Epoch: 7, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
Validation loss decreased (-0.738879 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 0.6960086822509766
Epoch: 8, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 0.758385181427002
Epoch: 9, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 0.675058126449585
Epoch: 10, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 0.9699177742004395
Epoch: 11, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.811105 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 0.8905839920043945
Epoch: 12, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.486 Vali Acc: 0.839 Test Loss: 0.486 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7501978874206543
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.7443828582763672
Epoch: 14, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 0.8369886875152588
Epoch: 15, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.398 Vali Acc: 0.839 Test Loss: 0.398 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6949689388275146
Epoch: 16, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 0.7731125354766846
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.777611255645752
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7133026123046875
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7591724395751953
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7704219818115234
Epoch: 21, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7907721996307373
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 0.7468619346618652
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7027192115783691
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 0.8307754993438721
Epoch: 25, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9171133041381836
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 0.8653900623321533
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 0.8843410015106201
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.8371133804321289
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.865710973739624
Epoch: 30, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.962073564529419
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 32 cost time: 0.98193359375
Epoch: 32, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.921511173248291
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0500342845916748
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8864350318908691
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8133931159973145
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.762824296951294
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6674253940582275
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8280906677246094
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.191 Vali Acc: 0.911 Test Loss: 0.191 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7366442680358887
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7325623035430908
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 34464
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0978236198425293
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.713 Vali Acc: 0.217 Test Loss: 1.713 Test Acc: 0.217
Validation loss decreased (inf --> -0.216650).  Saving model ...
Epoch: 2 cost time: 0.7109813690185547
Epoch: 2, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.568 Vali Acc: 0.389 Test Loss: 1.568 Test Acc: 0.389
Validation loss decreased (-0.216650 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.7165398597717285
Epoch: 3, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.406 Vali Acc: 0.611 Test Loss: 1.406 Test Acc: 0.611
Validation loss decreased (-0.388873 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 0.8346529006958008
Epoch: 4, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.245 Vali Acc: 0.717 Test Loss: 1.245 Test Acc: 0.717
Validation loss decreased (-0.611097 --> -0.716654).  Saving model ...
Epoch: 5 cost time: 0.7373495101928711
Epoch: 5, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.082 Vali Acc: 0.761 Test Loss: 1.082 Test Acc: 0.761
Validation loss decreased (-0.716654 --> -0.761100).  Saving model ...
Epoch: 6 cost time: 0.758314847946167
Epoch: 6, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.929 Vali Acc: 0.783 Test Loss: 0.929 Test Acc: 0.783
Validation loss decreased (-0.761100 --> -0.783324).  Saving model ...
Epoch: 7 cost time: 0.8637189865112305
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.783324 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.7629134654998779
Epoch: 8, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 9 cost time: 0.8460800647735596
Epoch: 9, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.599 Vali Acc: 0.811 Test Loss: 0.599 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 0.7992208003997803
Epoch: 10, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.534 Vali Acc: 0.811 Test Loss: 0.534 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 0.7965710163116455
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.7925729751586914
Epoch: 12, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.435 Vali Acc: 0.839 Test Loss: 0.435 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 0.8302772045135498
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.7710273265838623
Epoch: 14, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 0.8521237373352051
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7022368907928467
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.8584067821502686
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.805018424987793
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8557562828063965
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 0.7331573963165283
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.7315716743469238
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.7722084522247314
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 23 cost time: 0.692990779876709
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.7163994312286377
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6692419052124023
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6844451427459717
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8224713802337646
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7244081497192383
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.740210771560669
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7950534820556641
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.696124792098999
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7322392463684082
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7095069885253906
Epoch: 33, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.6662404537200928
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6588854789733887
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6193807125091553
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7113292217254639
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6798858642578125
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7900745868682861
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7703037261962891
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6415057182312012
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.894 Test Loss: 0.198 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8042416572570801
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7584819793701172
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 34208
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.312609910964966
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.713 Vali Acc: 0.217 Test Loss: 1.713 Test Acc: 0.217
Validation loss decreased (inf --> -0.216650).  Saving model ...
Epoch: 2 cost time: 0.688366174697876
Epoch: 2, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.568 Vali Acc: 0.389 Test Loss: 1.568 Test Acc: 0.389
Validation loss decreased (-0.216650 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.8024094104766846
Epoch: 3, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.406 Vali Acc: 0.611 Test Loss: 1.406 Test Acc: 0.611
Validation loss decreased (-0.388873 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 0.6632251739501953
Epoch: 4, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.245 Vali Acc: 0.717 Test Loss: 1.245 Test Acc: 0.717
Validation loss decreased (-0.611097 --> -0.716654).  Saving model ...
Epoch: 5 cost time: 0.684863805770874
Epoch: 5, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.082 Vali Acc: 0.761 Test Loss: 1.082 Test Acc: 0.761
Validation loss decreased (-0.716654 --> -0.761100).  Saving model ...
Epoch: 6 cost time: 0.7611918449401855
Epoch: 6, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.929 Vali Acc: 0.783 Test Loss: 0.929 Test Acc: 0.783
Validation loss decreased (-0.761100 --> -0.783324).  Saving model ...
Epoch: 7 cost time: 0.7131640911102295
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.783324 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.724794864654541
Epoch: 8, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 9 cost time: 0.6365013122558594
Epoch: 9, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.599 Vali Acc: 0.811 Test Loss: 0.599 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 0.6538078784942627
Epoch: 10, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.534 Vali Acc: 0.811 Test Loss: 0.534 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 0.8366401195526123
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.6412599086761475
Epoch: 12, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.435 Vali Acc: 0.839 Test Loss: 0.435 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 0.6520569324493408
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.6999144554138184
Epoch: 14, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 0.6448936462402344
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6286368370056152
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.709423303604126
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.682692289352417
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6267051696777344
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 0.9919147491455078
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.7196898460388184
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.7287089824676514
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 23 cost time: 0.6159863471984863
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.7016198635101318
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6802959442138672
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7161059379577637
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7178671360015869
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.761702299118042
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6518430709838867
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8291995525360107
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.685882568359375
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7156012058258057
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.692084789276123
Epoch: 33, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.6648414134979248
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8758940696716309
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7617650032043457
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7075088024139404
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8209388256072998
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8079144954681396
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8212363719940186
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6581032276153564
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.894 Test Loss: 0.198 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8171124458312988
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6913478374481201
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 34208
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2002642154693604
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.685 Vali Acc: 0.300 Test Loss: 1.685 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.8418173789978027
Epoch: 2, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.535 Vali Acc: 0.489 Test Loss: 1.535 Test Acc: 0.489
Validation loss decreased (-0.299983 --> -0.488874).  Saving model ...
Epoch: 3 cost time: 0.9262194633483887
Epoch: 3, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.352 Vali Acc: 0.583 Test Loss: 1.352 Test Acc: 0.583
Validation loss decreased (-0.488874 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.8420157432556152
Epoch: 4, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.167 Vali Acc: 0.650 Test Loss: 1.167 Test Acc: 0.650
Validation loss decreased (-0.583320 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.8487932682037354
Epoch: 5, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.649988 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.9102609157562256
Epoch: 6, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.840 Vali Acc: 0.733 Test Loss: 0.840 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 0.8045117855072021
Epoch: 7, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.881019115447998
Epoch: 8, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
Validation loss decreased (-0.749993 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 0.8537049293518066
Epoch: 9, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.551 Vali Acc: 0.806 Test Loss: 0.551 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 0.9463405609130859
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.92950439453125
Epoch: 11, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.8474280834197998
Epoch: 12, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.416 Vali Acc: 0.872 Test Loss: 0.416 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 0.9120006561279297
Epoch: 13, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9369609355926514
Epoch: 14, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8014688491821289
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.7885305881500244
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0089507102966309
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8711423873901367
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9754092693328857
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.8663406372070312
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8416767120361328
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 0.957258939743042
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0249989032745361
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8249051570892334
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7669305801391602
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 0.894108772277832
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 0.9176175594329834
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9138805866241455
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8755884170532227
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9366319179534912
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.933875322341919
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.883 Test Loss: 0.242 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8735346794128418
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.870650053024292
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9783957004547119
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.856243371963501
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8269975185394287
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 35500
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9562773704528809
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.780 Vali Acc: 0.222 Test Loss: 1.780 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.8998739719390869
Epoch: 2, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.604 Vali Acc: 0.372 Test Loss: 1.604 Test Acc: 0.372
Validation loss decreased (-0.222204 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 0.8194172382354736
Epoch: 3, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.404 Vali Acc: 0.583 Test Loss: 1.404 Test Acc: 0.583
Validation loss decreased (-0.372206 --> -0.583319).  Saving model ...
Epoch: 4 cost time: 0.7133984565734863
Epoch: 4, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.202 Vali Acc: 0.678 Test Loss: 1.202 Test Acc: 0.678
Validation loss decreased (-0.583319 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.9726083278656006
Epoch: 5, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.012 Vali Acc: 0.756 Test Loss: 1.012 Test Acc: 0.756
Validation loss decreased (-0.677766 --> -0.755545).  Saving model ...
Epoch: 6 cost time: 0.7950451374053955
Epoch: 6, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.858 Vali Acc: 0.744 Test Loss: 0.858 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8769745826721191
Epoch: 7, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 0.9124178886413574
Epoch: 8, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.643 Vali Acc: 0.761 Test Loss: 0.643 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.9169127941131592
Epoch: 9, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 0.7454545497894287
Epoch: 10, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.779233455657959
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.832568883895874
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8829715251922607
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 0.9206910133361816
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.395 Vali Acc: 0.839 Test Loss: 0.395 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 0.8536036014556885
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.8592383861541748
Epoch: 16, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 0.9622602462768555
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8428878784179688
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 0.8623025417327881
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 0.800736665725708
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8247320652008057
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8845045566558838
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 23 cost time: 0.756272554397583
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7350738048553467
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8677771091461182
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7886734008789062
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 27 cost time: 0.7967503070831299
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9319777488708496
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9107849597930908
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8710429668426514
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9436821937561035
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0134623050689697
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9253964424133301
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8761334419250488
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9262855052947998
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9627707004547119
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 35244
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5754542350769043
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.705 Vali Acc: 0.267 Test Loss: 1.705 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 0.7871036529541016
Epoch: 2, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.531 Vali Acc: 0.478 Test Loss: 1.531 Test Acc: 0.478
Validation loss decreased (-0.266650 --> -0.477762).  Saving model ...
Epoch: 3 cost time: 0.7377052307128906
Epoch: 3, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.332 Vali Acc: 0.672 Test Loss: 1.332 Test Acc: 0.672
Validation loss decreased (-0.477762 --> -0.672209).  Saving model ...
Epoch: 4 cost time: 0.8056743144989014
Epoch: 4, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.141 Vali Acc: 0.739 Test Loss: 1.141 Test Acc: 0.739
Validation loss decreased (-0.672209 --> -0.738877).  Saving model ...
Epoch: 5 cost time: 0.6822655200958252
Epoch: 5, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
Validation loss decreased (-0.738877 --> -0.755546).  Saving model ...
Epoch: 6 cost time: 0.6969377994537354
Epoch: 6, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.808 Vali Acc: 0.783 Test Loss: 0.808 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 0.6859588623046875
Epoch: 7, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
Validation loss decreased (-0.783325 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 0.8364162445068359
Epoch: 8, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877772).  Saving model ...
Epoch: 9 cost time: 0.7202513217926025
Epoch: 9, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8972582817077637
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7104170322418213
Epoch: 11, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 0.7725415229797363
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 0.7554538249969482
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.7641117572784424
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.7567050457000732
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7409284114837646
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.8530535697937012
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7228281497955322
Epoch: 18, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 0.7164881229400635
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 0.8641562461853027
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6525018215179443
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 0.6656203269958496
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7182002067565918
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7304990291595459
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8043434619903564
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8788433074951172
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9012582302093506
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7889580726623535
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8956480026245117
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7943985462188721
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8606467247009277
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 34732
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2375636100769043
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.709 Vali Acc: 0.239 Test Loss: 1.709 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 0.7914929389953613
Epoch: 2, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.539 Vali Acc: 0.417 Test Loss: 1.539 Test Acc: 0.417
Validation loss decreased (-0.238872 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 0.7758631706237793
Epoch: 3, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.350 Vali Acc: 0.578 Test Loss: 1.350 Test Acc: 0.578
Validation loss decreased (-0.416651 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.7389006614685059
Epoch: 4, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.165 Vali Acc: 0.656 Test Loss: 1.165 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.7981574535369873
Epoch: 5, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 6 cost time: 0.7757735252380371
Epoch: 6, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.8878240585327148
Epoch: 7, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.724 Vali Acc: 0.733 Test Loss: 0.724 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.738161563873291
Epoch: 8, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 0.7488436698913574
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 0.8628199100494385
Epoch: 10, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 0.7265875339508057
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 0.762362003326416
Epoch: 12, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8320093154907227
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 0.755023717880249
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 0.8727514743804932
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.899777889251709
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.983666181564331
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 0.818535566329956
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 0.7264094352722168
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7713613510131836
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 0.896989107131958
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7693188190460205
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7410774230957031
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9253132343292236
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7274703979492188
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7147824764251709
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.7890574932098389
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8877949714660645
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.789147138595581
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.678541898727417
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.710512638092041
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.7948384284973145
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7615437507629395
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.7260568141937256
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7185549736022949
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.798969030380249
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7190797328948975
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.6974029541015625
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7338595390319824
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6688458919525146
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7923948764801025
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7503979206085205
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.7580966949462891
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7333192825317383
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8170392513275146
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6494722366333008
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.7355313301086426
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7631409168243408
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7398760318756104
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6711869239807129
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.625849723815918
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8010110855102539
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7789437770843506
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7462203502655029
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7856833934783936
Epoch: 55, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8374054431915283
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 34476
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2037463188171387
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.730 Vali Acc: 0.228 Test Loss: 1.730 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 0.658151388168335
Epoch: 2, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
Validation loss decreased (-0.227760 --> -0.449985).  Saving model ...
Epoch: 3 cost time: 0.6255064010620117
Epoch: 3, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.350 Vali Acc: 0.550 Test Loss: 1.350 Test Acc: 0.550
Validation loss decreased (-0.449985 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.6054427623748779
Epoch: 4, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.148 Vali Acc: 0.683 Test Loss: 1.148 Test Acc: 0.683
Validation loss decreased (-0.549987 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 0.586357593536377
Epoch: 5, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.968 Vali Acc: 0.767 Test Loss: 0.968 Test Acc: 0.767
Validation loss decreased (-0.683322 --> -0.766657).  Saving model ...
Epoch: 6 cost time: 0.6342635154724121
Epoch: 6, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.805 Vali Acc: 0.811 Test Loss: 0.805 Test Acc: 0.811
Validation loss decreased (-0.766657 --> -0.811103).  Saving model ...
Epoch: 7 cost time: 0.5640099048614502
Epoch: 7, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.677 Vali Acc: 0.844 Test Loss: 0.677 Test Acc: 0.844
Validation loss decreased (-0.811103 --> -0.844438).  Saving model ...
Epoch: 8 cost time: 0.5721027851104736
Epoch: 8, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 9 cost time: 0.6186642646789551
Epoch: 9, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 0.6631383895874023
Epoch: 10, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 0.6262524127960205
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.554234504699707
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.623910665512085
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.6983287334442139
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6922690868377686
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 0.6718623638153076
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6589899063110352
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.6861274242401123
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 0.5429482460021973
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6269726753234863
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.6931264400482178
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5831198692321777
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6154618263244629
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6018805503845215
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6171870231628418
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5292346477508545
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6505274772644043
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.655933141708374
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6688289642333984
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6562290191650391
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 34220
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0017058849334717
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.773 Vali Acc: 0.239 Test Loss: 1.773 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 0.6820087432861328
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.580 Vali Acc: 0.378 Test Loss: 1.580 Test Acc: 0.378
Validation loss decreased (-0.238871 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.5853843688964844
Epoch: 3, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.363 Vali Acc: 0.572 Test Loss: 1.363 Test Acc: 0.572
Validation loss decreased (-0.377762 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.6452326774597168
Epoch: 4, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.164 Vali Acc: 0.672 Test Loss: 1.164 Test Acc: 0.672
Validation loss decreased (-0.572209 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.5188641548156738
Epoch: 5, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.5548155307769775
Epoch: 6, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 0.5339233875274658
Epoch: 7, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 0.7282533645629883
Epoch: 8, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 0.5647180080413818
Epoch: 9, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 0.7392821311950684
Epoch: 10, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.494 Vali Acc: 0.811 Test Loss: 0.494 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 0.7249782085418701
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
Validation loss decreased (-0.811106 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.8152716159820557
Epoch: 12, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 0.6591415405273438
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.694258451461792
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.399 Vali Acc: 0.878 Test Loss: 0.399 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 0.581662654876709
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6125941276550293
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.5931806564331055
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.639559268951416
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 0.7411799430847168
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7926583290100098
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 0.6386227607727051
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8049814701080322
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 0.5641825199127197
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6840052604675293
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6660723686218262
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 0.5888128280639648
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6077232360839844
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6701192855834961
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7079510688781738
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7205696105957031
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.684516191482544
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6615431308746338
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6110744476318359
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7120459079742432
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7219817638397217
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 33964
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1058316230773926
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.773 Vali Acc: 0.239 Test Loss: 1.773 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 0.740337610244751
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.580 Vali Acc: 0.378 Test Loss: 1.580 Test Acc: 0.378
Validation loss decreased (-0.238871 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.7694382667541504
Epoch: 3, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.363 Vali Acc: 0.572 Test Loss: 1.363 Test Acc: 0.572
Validation loss decreased (-0.377762 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.826007604598999
Epoch: 4, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.164 Vali Acc: 0.672 Test Loss: 1.164 Test Acc: 0.672
Validation loss decreased (-0.572209 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.7693674564361572
Epoch: 5, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.7146956920623779
Epoch: 6, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 0.7626843452453613
Epoch: 7, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 0.8693068027496338
Epoch: 8, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 0.6768331527709961
Epoch: 9, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 0.8113188743591309
Epoch: 10, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.494 Vali Acc: 0.811 Test Loss: 0.494 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 0.8336062431335449
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
Validation loss decreased (-0.811106 --> -0.855551).  Saving model ...
Epoch: 12 cost time: 0.9164316654205322
Epoch: 12, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 0.6717190742492676
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 0.6050240993499756
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.399 Vali Acc: 0.878 Test Loss: 0.399 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 0.8725767135620117
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.672968864440918
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.6620147228240967
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.786759614944458
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 0.8876852989196777
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7011785507202148
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 0.7702591419219971
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8946142196655273
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 0.8068022727966309
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8515560626983643
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.694871187210083
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 0.7765319347381592
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8492841720581055
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8397231101989746
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6889994144439697
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7644867897033691
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6870138645172119
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.790269136428833
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7641661167144775
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8123581409454346
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.895050048828125
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_MTSMixer_UEA_ftM_sl51_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 33964
model size : 0.14MB
