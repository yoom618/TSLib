Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3153514862060547
Epoch: 1, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.379 Vali Acc: 0.360 Test Loss: 1.379 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 2.0491769313812256
Epoch: 2, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.731 Vali Acc: 0.520 Test Loss: 1.731 Test Acc: 0.520
Validation loss decreased (-0.359986 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 1.928987979888916
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.702 Vali Acc: 0.460 Test Loss: 2.702 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.930121660232544
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.145 Vali Acc: 0.500 Test Loss: 2.145 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9313836097717285
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.580 Test Loss: 2.006 Test Acc: 0.580
Validation loss decreased (-0.519983 --> -0.579980).  Saving model ...
Epoch: 6 cost time: 1.915933609008789
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.560 Test Loss: 2.010 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9247922897338867
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.580 Test Loss: 2.035 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9600889682769775
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.580 Test Loss: 2.056 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.029855489730835
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.580 Test Loss: 2.069 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9810314178466797
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.580 Test Loss: 2.076 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0416691303253174
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.580 Test Loss: 2.080 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8963754177093506
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.580 Test Loss: 2.083 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9224343299865723
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.580 Test Loss: 2.084 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9727699756622314
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.580 Test Loss: 2.086 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9367198944091797
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.580 Test Loss: 2.086 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3691503
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6976370811462402
Epoch: 1, Steps: 7 | Train Loss: 1.593 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 2.2172186374664307
Epoch: 2, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.260 Vali Acc: 0.520 Test Loss: 2.260 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519977).  Saving model ...
Epoch: 3 cost time: 2.2338550090789795
Epoch: 3, Steps: 7 | Train Loss: 0.140 Vali Loss: 2.572 Vali Acc: 0.460 Test Loss: 2.572 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.074371576309204
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.480 Test Loss: 2.369 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3363654613494873
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.414 Vali Acc: 0.540 Test Loss: 2.414 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539976).  Saving model ...
Epoch: 6 cost time: 2.3853745460510254
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.580 Test Loss: 2.483 Test Acc: 0.580
Validation loss decreased (-0.539976 --> -0.579975).  Saving model ...
Epoch: 7 cost time: 2.272653102874756
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.535 Vali Acc: 0.580 Test Loss: 2.535 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3241636753082275
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.580 Test Loss: 2.566 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3490726947784424
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.600 Test Loss: 2.584 Test Acc: 0.600
Validation loss decreased (-0.579975 --> -0.599974).  Saving model ...
Epoch: 10 cost time: 2.2894327640533447
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.600 Test Loss: 2.593 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.359896421432495
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.600 Test Loss: 2.597 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.252256393432617
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.599 Vali Acc: 0.600 Test Loss: 2.599 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.342514753341675
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.599 Vali Acc: 0.600 Test Loss: 2.599 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.164125919342041
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.600 Test Loss: 2.598 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3699522018432617
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.600 Test Loss: 2.598 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1802778244018555
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.600 Test Loss: 2.597 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.252896785736084
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.595 Vali Acc: 0.600 Test Loss: 2.595 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0906741619110107
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.594 Vali Acc: 0.600 Test Loss: 2.594 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.119180202484131
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.600 Test Loss: 2.593 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3677167
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4925904273986816
Epoch: 1, Steps: 7 | Train Loss: 1.609 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 1.911440134048462
Epoch: 2, Steps: 7 | Train Loss: 0.150 Vali Loss: 1.697 Vali Acc: 0.420 Test Loss: 1.697 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.004587173461914
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.400 Test Loss: 2.242 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.973433017730713
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.440 Test Loss: 2.696 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9063048362731934
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.989 Vali Acc: 0.440 Test Loss: 2.989 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.913050651550293
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.440 Test Loss: 3.163 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8332345485687256
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.261 Vali Acc: 0.440 Test Loss: 3.261 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9734139442443848
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.314 Vali Acc: 0.440 Test Loss: 3.314 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9737844467163086
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.342 Vali Acc: 0.440 Test Loss: 3.342 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8251092433929443
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.357 Vali Acc: 0.440 Test Loss: 3.357 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9800372123718262
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.363 Vali Acc: 0.440 Test Loss: 3.363 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3664879
model size : 14.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.309499740600586
Epoch: 1, Steps: 7 | Train Loss: 1.545 Vali Loss: 1.252 Vali Acc: 0.420 Test Loss: 1.252 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.7810590267181396
Epoch: 2, Steps: 7 | Train Loss: 0.158 Vali Loss: 1.484 Vali Acc: 0.540 Test Loss: 1.484 Test Acc: 0.540
Validation loss decreased (-0.419987 --> -0.539985).  Saving model ...
Epoch: 3 cost time: 1.5923528671264648
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.540 Test Loss: 2.002 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7828834056854248
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.383 Vali Acc: 0.560 Test Loss: 2.383 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559976).  Saving model ...
Epoch: 5 cost time: 1.956761121749878
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.560 Test Loss: 2.601 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8544213771820068
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.616 Vali Acc: 0.600 Test Loss: 2.616 Test Acc: 0.600
Validation loss decreased (-0.559976 --> -0.599974).  Saving model ...
Epoch: 7 cost time: 1.669666051864624
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.642 Vali Acc: 0.600 Test Loss: 2.642 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.809720516204834
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.580 Test Loss: 2.661 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8099853992462158
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.673 Vali Acc: 0.580 Test Loss: 2.673 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7761180400848389
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.580 Test Loss: 2.679 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.756455898284912
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.683 Vali Acc: 0.580 Test Loss: 2.683 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6620664596557617
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.580 Test Loss: 2.685 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.701246738433838
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.686 Vali Acc: 0.580 Test Loss: 2.686 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8864216804504395
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.687 Vali Acc: 0.580 Test Loss: 2.687 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8276124000549316
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.687 Vali Acc: 0.580 Test Loss: 2.687 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8394861221313477
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.688 Vali Acc: 0.580 Test Loss: 2.688 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3650543
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.13870906829834
Epoch: 1, Steps: 7 | Train Loss: 1.817 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.3693304061889648
Epoch: 2, Steps: 7 | Train Loss: 0.155 Vali Loss: 1.942 Vali Acc: 0.480 Test Loss: 1.942 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2480087280273438
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.198 Vali Acc: 0.540 Test Loss: 2.198 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539978).  Saving model ...
Epoch: 4 cost time: 1.4755589962005615
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.266 Vali Acc: 0.600 Test Loss: 2.266 Test Acc: 0.600
Validation loss decreased (-0.539978 --> -0.599977).  Saving model ...
Epoch: 5 cost time: 1.4449234008789062
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.540 Test Loss: 2.546 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.382920742034912
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.756 Vali Acc: 0.520 Test Loss: 2.756 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5224270820617676
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.874 Vali Acc: 0.520 Test Loss: 2.874 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5812113285064697
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.520 Test Loss: 2.934 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.470693826675415
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.965 Vali Acc: 0.520 Test Loss: 2.965 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4440600872039795
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.980 Vali Acc: 0.520 Test Loss: 2.980 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6299614906311035
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.986 Vali Acc: 0.520 Test Loss: 2.986 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.546431541442871
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.988 Vali Acc: 0.520 Test Loss: 2.988 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5435495376586914
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.987 Vali Acc: 0.520 Test Loss: 2.987 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4467692375183105
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.986 Vali Acc: 0.520 Test Loss: 2.986 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3640303
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.792635679244995
Epoch: 1, Steps: 7 | Train Loss: 1.685 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.3115160465240479
Epoch: 2, Steps: 7 | Train Loss: 0.180 Vali Loss: 1.696 Vali Acc: 0.460 Test Loss: 1.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.233792781829834
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.181 Vali Acc: 0.520 Test Loss: 2.181 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519978).  Saving model ...
Epoch: 4 cost time: 1.2174413204193115
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.520 Test Loss: 2.557 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.212256669998169
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.763 Vali Acc: 0.540 Test Loss: 2.763 Test Acc: 0.540
Validation loss decreased (-0.519978 --> -0.539972).  Saving model ...
Epoch: 6 cost time: 1.228137493133545
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.884 Vali Acc: 0.540 Test Loss: 2.884 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2422432899475098
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.540 Test Loss: 2.953 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1931540966033936
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.991 Vali Acc: 0.560 Test Loss: 2.991 Test Acc: 0.560
Validation loss decreased (-0.539972 --> -0.559970).  Saving model ...
Epoch: 9 cost time: 1.4672515392303467
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.012 Vali Acc: 0.560 Test Loss: 3.012 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.189969539642334
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.022 Vali Acc: 0.560 Test Loss: 3.022 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4088752269744873
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.028 Vali Acc: 0.560 Test Loss: 3.028 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.225450038909912
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.030 Vali Acc: 0.560 Test Loss: 3.030 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3387162685394287
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.560 Test Loss: 3.031 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2299249172210693
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.560 Test Loss: 3.031 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1468656063079834
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.560 Test Loss: 3.031 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2397096157073975
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.030 Vali Acc: 0.560 Test Loss: 3.030 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2219188213348389
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.560 Test Loss: 3.029 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2760872840881348
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.028 Vali Acc: 0.560 Test Loss: 3.028 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3634159
model size : 13.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7999417781829834
Epoch: 1, Steps: 7 | Train Loss: 1.721 Vali Loss: 1.374 Vali Acc: 0.340 Test Loss: 1.374 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 1.3212177753448486
Epoch: 2, Steps: 7 | Train Loss: 0.165 Vali Loss: 2.027 Vali Acc: 0.420 Test Loss: 2.027 Test Acc: 0.420
Validation loss decreased (-0.339986 --> -0.419980).  Saving model ...
Epoch: 3 cost time: 1.248565912246704
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.079 Vali Acc: 0.460 Test Loss: 3.079 Test Acc: 0.460
Validation loss decreased (-0.419980 --> -0.459969).  Saving model ...
Epoch: 4 cost time: 1.177779197692871
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.544 Vali Acc: 0.520 Test Loss: 3.544 Test Acc: 0.520
Validation loss decreased (-0.459969 --> -0.519965).  Saving model ...
Epoch: 5 cost time: 1.3223280906677246
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.419 Vali Acc: 0.540 Test Loss: 3.419 Test Acc: 0.540
Validation loss decreased (-0.519965 --> -0.539966).  Saving model ...
Epoch: 6 cost time: 1.234858512878418
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.659 Vali Acc: 0.520 Test Loss: 3.659 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2096726894378662
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.933 Vali Acc: 0.480 Test Loss: 3.933 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1587834358215332
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.087 Vali Acc: 0.480 Test Loss: 4.087 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2902822494506836
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.480 Test Loss: 4.121 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3235278129577637
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.127 Vali Acc: 0.480 Test Loss: 4.127 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2435839176177979
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.124 Vali Acc: 0.480 Test Loss: 4.124 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1842432022094727
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.115 Vali Acc: 0.480 Test Loss: 4.115 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2035725116729736
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.106 Vali Acc: 0.480 Test Loss: 4.106 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2451858520507812
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.096 Vali Acc: 0.480 Test Loss: 4.096 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1294827461242676
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.086 Vali Acc: 0.480 Test Loss: 4.086 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3628015
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.43568754196167
Epoch: 1, Steps: 7 | Train Loss: 1.702 Vali Loss: 1.385 Vali Acc: 0.380 Test Loss: 1.385 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 0.9623780250549316
Epoch: 2, Steps: 7 | Train Loss: 0.225 Vali Loss: 1.643 Vali Acc: 0.540 Test Loss: 1.643 Test Acc: 0.540
Validation loss decreased (-0.379986 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 1.0074584484100342
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.575 Vali Acc: 0.540 Test Loss: 1.575 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 0.9992496967315674
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.560 Test Loss: 1.852 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559981).  Saving model ...
Epoch: 5 cost time: 0.9989049434661865
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.540 Test Loss: 2.086 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0083250999450684
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.237 Vali Acc: 0.540 Test Loss: 2.237 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0482511520385742
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.520 Test Loss: 2.324 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0076115131378174
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.520 Test Loss: 2.371 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8424370288848877
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.394 Vali Acc: 0.520 Test Loss: 2.394 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8947865962982178
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.403 Vali Acc: 0.520 Test Loss: 2.403 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9057526588439941
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.520 Test Loss: 2.407 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9276716709136963
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.408 Vali Acc: 0.520 Test Loss: 2.408 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9510841369628906
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.408 Vali Acc: 0.520 Test Loss: 2.408 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0191714763641357
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.406 Vali Acc: 0.520 Test Loss: 2.406 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3623919
model size : 13.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.603787660598755
Epoch: 1, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.407 Vali Acc: 0.260 Test Loss: 1.407 Test Acc: 0.260
Validation loss decreased (inf --> -0.259986).  Saving model ...
Epoch: 2 cost time: 2.266695261001587
Epoch: 2, Steps: 7 | Train Loss: 0.169 Vali Loss: 1.957 Vali Acc: 0.420 Test Loss: 1.957 Test Acc: 0.420
Validation loss decreased (-0.259986 --> -0.419980).  Saving model ...
Epoch: 3 cost time: 2.432029962539673
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.003 Vali Acc: 0.500 Test Loss: 2.003 Test Acc: 0.500
Validation loss decreased (-0.419980 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 2.3921189308166504
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.795 Vali Acc: 0.480 Test Loss: 2.795 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5866403579711914
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.252 Vali Acc: 0.480 Test Loss: 3.252 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5328738689422607
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.462 Vali Acc: 0.440 Test Loss: 3.462 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2654576301574707
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.466 Vali Acc: 0.420 Test Loss: 3.466 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.365091323852539
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.420 Test Loss: 3.438 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.478086233139038
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.412 Vali Acc: 0.440 Test Loss: 3.412 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.317375898361206
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.379 Vali Acc: 0.460 Test Loss: 3.379 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5012717247009277
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.460 Test Loss: 3.356 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4233334064483643
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.460 Test Loss: 3.339 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.449741840362549
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.324 Vali Acc: 0.480 Test Loss: 3.324 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3347055
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9277215003967285
Epoch: 1, Steps: 7 | Train Loss: 1.619 Vali Loss: 1.360 Vali Acc: 0.320 Test Loss: 1.360 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 2.138714075088501
Epoch: 2, Steps: 7 | Train Loss: 0.151 Vali Loss: 1.902 Vali Acc: 0.540 Test Loss: 1.902 Test Acc: 0.540
Validation loss decreased (-0.319986 --> -0.539981).  Saving model ...
Epoch: 3 cost time: 2.3579750061035156
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.211 Vali Acc: 0.540 Test Loss: 2.211 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2311935424804688
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.540 Test Loss: 2.487 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.118983030319214
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.540 Test Loss: 2.716 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.281741142272949
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.866 Vali Acc: 0.500 Test Loss: 2.866 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1363484859466553
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.952 Vali Acc: 0.500 Test Loss: 2.952 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1746277809143066
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.997 Vali Acc: 0.500 Test Loss: 2.997 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3410844802856445
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.500 Test Loss: 3.016 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2213547229766846
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.022 Vali Acc: 0.500 Test Loss: 3.022 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2722175121307373
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.500 Test Loss: 3.024 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.090651273727417
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.023 Vali Acc: 0.500 Test Loss: 3.023 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3332719
model size : 12.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2335073947906494
Epoch: 1, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.315 Vali Acc: 0.460 Test Loss: 1.315 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.8571813106536865
Epoch: 2, Steps: 7 | Train Loss: 0.179 Vali Loss: 1.865 Vali Acc: 0.460 Test Loss: 1.865 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9334242343902588
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.824 Vali Acc: 0.440 Test Loss: 2.824 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7791357040405273
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.560 Test Loss: 2.140 Test Acc: 0.560
Validation loss decreased (-0.459987 --> -0.559979).  Saving model ...
Epoch: 5 cost time: 1.9106712341308594
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.589 Vali Acc: 0.500 Test Loss: 2.589 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8744566440582275
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.959 Vali Acc: 0.460 Test Loss: 2.959 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.794264316558838
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.190 Vali Acc: 0.440 Test Loss: 3.190 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.986023187637329
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.320 Vali Acc: 0.440 Test Loss: 3.320 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7972450256347656
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.389 Vali Acc: 0.420 Test Loss: 3.389 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9106073379516602
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.419 Vali Acc: 0.420 Test Loss: 3.419 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9068443775177002
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.431 Vali Acc: 0.420 Test Loss: 3.431 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8285181522369385
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.420 Test Loss: 3.434 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8449554443359375
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.430 Vali Acc: 0.420 Test Loss: 3.430 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.801013708114624
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.426 Vali Acc: 0.420 Test Loss: 3.426 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3320431
model size : 12.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.99021053314209
Epoch: 1, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.7124338150024414
Epoch: 2, Steps: 7 | Train Loss: 0.165 Vali Loss: 1.687 Vali Acc: 0.520 Test Loss: 1.687 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 1.4963080883026123
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.197 Vali Acc: 0.520 Test Loss: 2.197 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5234272480010986
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.011 Vali Acc: 0.520 Test Loss: 2.011 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4649512767791748
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.213 Vali Acc: 0.540 Test Loss: 2.213 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539978).  Saving model ...
Epoch: 6 cost time: 1.4637527465820312
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.540 Test Loss: 2.400 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.423206090927124
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.506 Vali Acc: 0.560 Test Loss: 2.506 Test Acc: 0.560
Validation loss decreased (-0.539978 --> -0.559975).  Saving model ...
Epoch: 8 cost time: 1.5122387409210205
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.560 Test Loss: 2.540 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5765595436096191
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.554 Vali Acc: 0.540 Test Loss: 2.554 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4521174430847168
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.540 Test Loss: 2.552 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5060157775878906
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.540 Test Loss: 2.548 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4920899868011475
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.545 Vali Acc: 0.540 Test Loss: 2.545 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5493998527526855
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.542 Vali Acc: 0.540 Test Loss: 2.542 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5059361457824707
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.540 Test Loss: 2.538 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4866752624511719
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.535 Vali Acc: 0.540 Test Loss: 2.535 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3831391334533691
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.532 Vali Acc: 0.540 Test Loss: 2.532 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5136899948120117
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.529 Vali Acc: 0.540 Test Loss: 2.529 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3306095
model size : 12.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6672959327697754
Epoch: 1, Steps: 7 | Train Loss: 1.728 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.1166493892669678
Epoch: 2, Steps: 7 | Train Loss: 0.172 Vali Loss: 2.058 Vali Acc: 0.460 Test Loss: 2.058 Test Acc: 0.460
Validation loss decreased (-0.299986 --> -0.459979).  Saving model ...
Epoch: 3 cost time: 1.0399196147918701
Epoch: 3, Steps: 7 | Train Loss: 0.079 Vali Loss: 2.655 Vali Acc: 0.460 Test Loss: 2.655 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2491767406463623
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.500 Test Loss: 2.597 Test Acc: 0.500
Validation loss decreased (-0.459979 --> -0.499974).  Saving model ...
Epoch: 5 cost time: 1.2651753425598145
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.664 Vali Acc: 0.480 Test Loss: 2.664 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2338485717773438
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.727 Vali Acc: 0.480 Test Loss: 2.727 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.36177659034729
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.771 Vali Acc: 0.480 Test Loss: 2.771 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.369269609451294
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.796 Vali Acc: 0.480 Test Loss: 2.796 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3081812858581543
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.480 Test Loss: 2.810 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3003926277160645
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.480 Test Loss: 2.818 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.214909315109253
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.821 Vali Acc: 0.480 Test Loss: 2.821 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1597847938537598
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.823 Vali Acc: 0.480 Test Loss: 2.823 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2976911067962646
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.823 Vali Acc: 0.480 Test Loss: 2.823 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2752466201782227
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.823 Vali Acc: 0.480 Test Loss: 2.823 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3295855
model size : 12.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3800430297851562
Epoch: 1, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.376 Vali Acc: 0.440 Test Loss: 1.376 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.4161078929901123
Epoch: 2, Steps: 7 | Train Loss: 0.145 Vali Loss: 1.473 Vali Acc: 0.520 Test Loss: 1.473 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519985).  Saving model ...
Epoch: 3 cost time: 1.1001479625701904
Epoch: 3, Steps: 7 | Train Loss: 0.024 Vali Loss: 2.232 Vali Acc: 0.520 Test Loss: 2.232 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1356966495513916
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.520 Test Loss: 3.044 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2425668239593506
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.542 Vali Acc: 0.520 Test Loss: 3.542 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.011887550354004
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.753 Vali Acc: 0.540 Test Loss: 3.753 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539962).  Saving model ...
Epoch: 7 cost time: 1.1404321193695068
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.799 Vali Acc: 0.540 Test Loss: 3.799 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.125258445739746
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.828 Vali Acc: 0.520 Test Loss: 3.828 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0746967792510986
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.843 Vali Acc: 0.520 Test Loss: 3.843 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1419291496276855
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.851 Vali Acc: 0.520 Test Loss: 3.851 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.294480323791504
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.853 Vali Acc: 0.520 Test Loss: 3.853 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0144014358520508
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.853 Vali Acc: 0.520 Test Loss: 3.853 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0541579723358154
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.852 Vali Acc: 0.520 Test Loss: 3.852 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.108670949935913
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.850 Vali Acc: 0.520 Test Loss: 3.850 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.109112024307251
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.848 Vali Acc: 0.520 Test Loss: 3.848 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0765910148620605
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.847 Vali Acc: 0.520 Test Loss: 3.847 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3289711
model size : 12.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.440519094467163
Epoch: 1, Steps: 7 | Train Loss: 1.706 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.0670950412750244
Epoch: 2, Steps: 7 | Train Loss: 0.134 Vali Loss: 1.930 Vali Acc: 0.440 Test Loss: 1.930 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9720761775970459
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.757 Vali Acc: 0.620 Test Loss: 1.757 Test Acc: 0.620
Validation loss decreased (-0.499987 --> -0.619982).  Saving model ...
Epoch: 4 cost time: 0.9915132522583008
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.620 Test Loss: 1.936 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9824283123016357
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.620 Test Loss: 2.120 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.055490493774414
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.247 Vali Acc: 0.620 Test Loss: 2.247 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.006944179534912
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.640 Test Loss: 2.323 Test Acc: 0.640
Validation loss decreased (-0.619982 --> -0.639977).  Saving model ...
Epoch: 8 cost time: 1.0140385627746582
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.640 Test Loss: 2.366 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0863957405090332
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.389 Vali Acc: 0.640 Test Loss: 2.389 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0424892902374268
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.401 Vali Acc: 0.620 Test Loss: 2.401 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1702990531921387
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.620 Test Loss: 2.407 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9877183437347412
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.410 Vali Acc: 0.620 Test Loss: 2.410 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9064292907714844
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.640 Test Loss: 2.411 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9989697933197021
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.640 Test Loss: 2.411 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0054986476898193
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.410 Vali Acc: 0.640 Test Loss: 2.410 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9991827011108398
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.410 Vali Acc: 0.640 Test Loss: 2.410 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0783843994140625
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.640 Test Loss: 2.409 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 3283567
model size : 12.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.387437105178833
Epoch: 1, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.263 Vali Acc: 0.460 Test Loss: 1.263 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 0.8809740543365479
Epoch: 2, Steps: 7 | Train Loss: 0.186 Vali Loss: 1.990 Vali Acc: 0.580 Test Loss: 1.990 Test Acc: 0.580
Validation loss decreased (-0.459987 --> -0.579980).  Saving model ...
Epoch: 3 cost time: 0.9215354919433594
Epoch: 3, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.566 Vali Acc: 0.580 Test Loss: 1.566 Test Acc: 0.580
Validation loss decreased (-0.579980 --> -0.579984).  Saving model ...
Epoch: 4 cost time: 0.8843574523925781
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.540 Test Loss: 2.116 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.851146936416626
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.364 Vali Acc: 0.560 Test Loss: 2.364 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0215628147125244
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.521 Vali Acc: 0.540 Test Loss: 2.521 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9109578132629395
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.614 Vali Acc: 0.520 Test Loss: 2.614 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8936107158660889
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.666 Vali Acc: 0.520 Test Loss: 2.666 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9518723487854004
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.520 Test Loss: 2.694 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9132816791534424
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.709 Vali Acc: 0.520 Test Loss: 2.709 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9563579559326172
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.520 Test Loss: 2.716 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.029871940612793
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.720 Vali Acc: 0.520 Test Loss: 2.720 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1292552947998047
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.520 Test Loss: 2.721 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3279471
model size : 12.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.713914155960083
Epoch: 1, Steps: 7 | Train Loss: 1.671 Vali Loss: 1.503 Vali Acc: 0.280 Test Loss: 1.503 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 2.33695912361145
Epoch: 2, Steps: 7 | Train Loss: 0.208 Vali Loss: 1.922 Vali Acc: 0.440 Test Loss: 1.922 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439981).  Saving model ...
Epoch: 3 cost time: 2.279218912124634
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.605 Vali Acc: 0.420 Test Loss: 2.605 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2035722732543945
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.911 Vali Acc: 0.440 Test Loss: 2.911 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3062260150909424
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.274 Vali Acc: 0.400 Test Loss: 3.274 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.264986753463745
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.503 Vali Acc: 0.380 Test Loss: 3.503 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2768146991729736
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.615 Vali Acc: 0.380 Test Loss: 3.615 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2850711345672607
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.665 Vali Acc: 0.380 Test Loss: 3.665 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.267136573791504
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.380 Test Loss: 3.637 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.205084800720215
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.621 Vali Acc: 0.380 Test Loss: 3.621 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2144229412078857
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.607 Vali Acc: 0.380 Test Loss: 3.607 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1912567615509033
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.598 Vali Acc: 0.380 Test Loss: 3.598 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3174831
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.522390604019165
Epoch: 1, Steps: 7 | Train Loss: 1.544 Vali Loss: 1.237 Vali Acc: 0.440 Test Loss: 1.237 Test Acc: 0.440
Validation loss decreased (inf --> -0.439988).  Saving model ...
Epoch: 2 cost time: 2.1049208641052246
Epoch: 2, Steps: 7 | Train Loss: 0.161 Vali Loss: 1.888 Vali Acc: 0.540 Test Loss: 1.888 Test Acc: 0.540
Validation loss decreased (-0.439988 --> -0.539981).  Saving model ...
Epoch: 3 cost time: 2.0860860347747803
Epoch: 3, Steps: 7 | Train Loss: 0.027 Vali Loss: 1.963 Vali Acc: 0.520 Test Loss: 1.963 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1469173431396484
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.179 Vali Acc: 0.520 Test Loss: 2.179 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.067067861557007
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.500 Test Loss: 2.431 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.118734359741211
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.500 Test Loss: 2.557 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.184375047683716
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.629 Vali Acc: 0.480 Test Loss: 2.629 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9503417015075684
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.664 Vali Acc: 0.480 Test Loss: 2.664 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1101343631744385
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.680 Vali Acc: 0.480 Test Loss: 2.680 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.235269069671631
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.686 Vali Acc: 0.480 Test Loss: 2.686 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2390105724334717
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.480 Test Loss: 2.685 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0379834175109863
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.682 Vali Acc: 0.480 Test Loss: 2.682 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3160495
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.407094955444336
Epoch: 1, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.270 Vali Acc: 0.420 Test Loss: 1.270 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 2.0115272998809814
Epoch: 2, Steps: 7 | Train Loss: 0.222 Vali Loss: 2.068 Vali Acc: 0.460 Test Loss: 2.068 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459979).  Saving model ...
Epoch: 3 cost time: 1.8372960090637207
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.657 Vali Acc: 0.640 Test Loss: 1.657 Test Acc: 0.640
Validation loss decreased (-0.459979 --> -0.639983).  Saving model ...
Epoch: 4 cost time: 1.7861242294311523
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.500 Test Loss: 2.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8652994632720947
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.436 Vali Acc: 0.500 Test Loss: 2.436 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7946116924285889
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.460 Test Loss: 2.708 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7655003070831299
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.460 Test Loss: 2.854 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8111786842346191
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.460 Test Loss: 2.895 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8090803623199463
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.914 Vali Acc: 0.460 Test Loss: 2.914 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7892470359802246
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.922 Vali Acc: 0.460 Test Loss: 2.922 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6921780109405518
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.460 Test Loss: 2.923 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.923360824584961
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.460 Test Loss: 2.923 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9501099586486816
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.921 Vali Acc: 0.460 Test Loss: 2.921 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 3148207
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6638741493225098
Epoch: 1, Steps: 7 | Train Loss: 1.655 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.5977230072021484
Epoch: 2, Steps: 7 | Train Loss: 0.167 Vali Loss: 1.859 Vali Acc: 0.580 Test Loss: 1.859 Test Acc: 0.580
Validation loss decreased (-0.399987 --> -0.579981).  Saving model ...
Epoch: 3 cost time: 1.4230337142944336
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.171 Vali Acc: 0.520 Test Loss: 2.171 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4841444492340088
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.562845230102539
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.238 Vali Acc: 0.480 Test Loss: 2.238 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6738812923431396
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.308 Vali Acc: 0.540 Test Loss: 2.308 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4546723365783691
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.560 Test Loss: 2.396 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.493553638458252
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.560 Test Loss: 2.458 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5674655437469482
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.560 Test Loss: 2.495 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4795880317687988
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.560 Test Loss: 2.516 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4653253555297852
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.560 Test Loss: 2.528 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5420200824737549
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.534 Vali Acc: 0.560 Test Loss: 2.534 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3133871
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.599175453186035
Epoch: 1, Steps: 7 | Train Loss: 1.635 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.3117094039916992
Epoch: 2, Steps: 7 | Train Loss: 0.154 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1982054710388184
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.239 Vali Acc: 0.540 Test Loss: 2.239 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539978).  Saving model ...
Epoch: 4 cost time: 1.3936517238616943
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.500 Test Loss: 2.450 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3618881702423096
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.709 Vali Acc: 0.480 Test Loss: 2.709 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2825982570648193
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.890 Vali Acc: 0.480 Test Loss: 2.890 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4117717742919922
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.999 Vali Acc: 0.480 Test Loss: 2.999 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1991121768951416
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.061 Vali Acc: 0.480 Test Loss: 3.061 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2633657455444336
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.095 Vali Acc: 0.480 Test Loss: 3.095 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.204554796218872
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.113 Vali Acc: 0.480 Test Loss: 3.113 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.241410732269287
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.123 Vali Acc: 0.480 Test Loss: 3.123 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2331669330596924
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.128 Vali Acc: 0.480 Test Loss: 3.128 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.157928705215454
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.131 Vali Acc: 0.480 Test Loss: 3.131 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3123631
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2840723991394043
Epoch: 1, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.389 Vali Acc: 0.440 Test Loss: 1.389 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.086014747619629
Epoch: 2, Steps: 7 | Train Loss: 0.149 Vali Loss: 2.433 Vali Acc: 0.460 Test Loss: 2.433 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459976).  Saving model ...
Epoch: 3 cost time: 1.0025606155395508
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.651 Vali Acc: 0.500 Test Loss: 2.651 Test Acc: 0.500
Validation loss decreased (-0.459976 --> -0.499973).  Saving model ...
Epoch: 4 cost time: 0.944178581237793
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.748 Vali Acc: 0.500 Test Loss: 2.748 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0845365524291992
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.868 Vali Acc: 0.500 Test Loss: 2.868 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9902489185333252
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.957 Vali Acc: 0.520 Test Loss: 2.957 Test Acc: 0.520
Validation loss decreased (-0.499973 --> -0.519970).  Saving model ...
Epoch: 7 cost time: 1.0492370128631592
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.014 Vali Acc: 0.560 Test Loss: 3.014 Test Acc: 0.560
Validation loss decreased (-0.519970 --> -0.559970).  Saving model ...
Epoch: 8 cost time: 1.1050429344177246
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.047 Vali Acc: 0.560 Test Loss: 3.047 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0181002616882324
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.067 Vali Acc: 0.560 Test Loss: 3.067 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0795783996582031
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.079 Vali Acc: 0.560 Test Loss: 3.079 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0191848278045654
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.086 Vali Acc: 0.560 Test Loss: 3.086 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9881715774536133
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.091 Vali Acc: 0.560 Test Loss: 3.091 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1265888214111328
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.095 Vali Acc: 0.560 Test Loss: 3.095 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1632776260375977
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.098 Vali Acc: 0.560 Test Loss: 3.098 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0480947494506836
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.560 Test Loss: 3.101 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9719786643981934
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.103 Vali Acc: 0.560 Test Loss: 3.103 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0557153224945068
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.105 Vali Acc: 0.560 Test Loss: 3.105 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3117487
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5167932510375977
Epoch: 1, Steps: 7 | Train Loss: 1.660 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.0406303405761719
Epoch: 2, Steps: 7 | Train Loss: 0.286 Vali Loss: 1.939 Vali Acc: 0.520 Test Loss: 1.939 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519981).  Saving model ...
Epoch: 3 cost time: 1.0949084758758545
Epoch: 3, Steps: 7 | Train Loss: 0.051 Vali Loss: 2.414 Vali Acc: 0.520 Test Loss: 2.414 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.061455249786377
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.632 Vali Acc: 0.560 Test Loss: 2.632 Test Acc: 0.560
Validation loss decreased (-0.519981 --> -0.559974).  Saving model ...
Epoch: 5 cost time: 0.9751396179199219
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.191 Vali Acc: 0.520 Test Loss: 3.191 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.013078212738037
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.577 Vali Acc: 0.540 Test Loss: 3.577 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0908641815185547
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.798 Vali Acc: 0.540 Test Loss: 3.798 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.051363468170166
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.917 Vali Acc: 0.540 Test Loss: 3.917 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2150750160217285
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.976 Vali Acc: 0.540 Test Loss: 3.976 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0166935920715332
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.999 Vali Acc: 0.540 Test Loss: 3.999 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0464446544647217
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.540 Test Loss: 4.006 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1382534503936768
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.540 Test Loss: 4.006 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9939031600952148
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.000 Vali Acc: 0.540 Test Loss: 4.000 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9169116020202637
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.995 Vali Acc: 0.540 Test Loss: 3.995 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3111343
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0871293544769287
Epoch: 1, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.7646172046661377
Epoch: 2, Steps: 7 | Train Loss: 0.197 Vali Loss: 1.605 Vali Acc: 0.520 Test Loss: 1.605 Test Acc: 0.520
Validation loss decreased (-0.399987 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 0.813556432723999
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.400 Test Loss: 2.024 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8350296020507812
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.420 Test Loss: 2.334 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7788434028625488
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.400 Test Loss: 2.586 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8228399753570557
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.400 Test Loss: 2.732 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8706967830657959
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.400 Test Loss: 2.808 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8298149108886719
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.400 Test Loss: 2.846 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8540182113647461
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.864 Vali Acc: 0.400 Test Loss: 2.864 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7647049427032471
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.871 Vali Acc: 0.400 Test Loss: 2.871 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8490328788757324
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.872 Vali Acc: 0.400 Test Loss: 2.872 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.795060396194458
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.866 Vali Acc: 0.400 Test Loss: 2.866 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3107247
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.228724241256714
Epoch: 1, Steps: 7 | Train Loss: 1.533 Vali Loss: 1.433 Vali Acc: 0.380 Test Loss: 1.433 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 2.433865785598755
Epoch: 2, Steps: 7 | Train Loss: 0.214 Vali Loss: 2.132 Vali Acc: 0.340 Test Loss: 2.132 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2615573406219482
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.696 Vali Acc: 0.500 Test Loss: 2.696 Test Acc: 0.500
Validation loss decreased (-0.379986 --> -0.499973).  Saving model ...
Epoch: 4 cost time: 2.4804270267486572
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.125 Vali Acc: 0.480 Test Loss: 3.125 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.442087411880493
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.500 Test Loss: 3.493 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4094483852386475
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.693 Vali Acc: 0.480 Test Loss: 3.693 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4475314617156982
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.800 Vali Acc: 0.480 Test Loss: 3.800 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4913222789764404
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.855 Vali Acc: 0.460 Test Loss: 3.855 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3683738708496094
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.882 Vali Acc: 0.460 Test Loss: 3.882 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.412168502807617
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.893 Vali Acc: 0.460 Test Loss: 3.893 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.416008949279785
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.892 Vali Acc: 0.460 Test Loss: 3.892 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.410176992416382
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.889 Vali Acc: 0.460 Test Loss: 3.889 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.311626434326172
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.884 Vali Acc: 0.460 Test Loss: 3.884 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3088719
model size : 11.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.30523943901062
Epoch: 1, Steps: 7 | Train Loss: 1.551 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 2.0522384643554688
Epoch: 2, Steps: 7 | Train Loss: 0.247 Vali Loss: 2.186 Vali Acc: 0.400 Test Loss: 2.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0047221183776855
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.9250550270080566
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.354 Vali Acc: 0.460 Test Loss: 3.354 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8907709121704102
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.126 Vali Acc: 0.440 Test Loss: 4.126 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0165388584136963
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.269 Vali Acc: 0.480 Test Loss: 3.269 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.02195143699646
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.520 Test Loss: 2.934 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519971).  Saving model ...
Epoch: 8 cost time: 2.0366692543029785
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.191 Vali Acc: 0.420 Test Loss: 3.191 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1220664978027344
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.440 Test Loss: 3.355 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9973580837249756
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.437 Vali Acc: 0.440 Test Loss: 3.437 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.01882004737854
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.446 Vali Acc: 0.440 Test Loss: 3.446 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.006056785583496
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.429 Vali Acc: 0.440 Test Loss: 3.429 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.982215404510498
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.410 Vali Acc: 0.440 Test Loss: 3.410 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9896173477172852
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.393 Vali Acc: 0.440 Test Loss: 3.393 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1385879516601562
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.379 Vali Acc: 0.440 Test Loss: 3.379 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.037449836730957
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.367 Vali Acc: 0.440 Test Loss: 3.367 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.969212532043457
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.440 Test Loss: 3.356 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3074383
model size : 11.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2973644733428955
Epoch: 1, Steps: 7 | Train Loss: 1.719 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.6469447612762451
Epoch: 2, Steps: 7 | Train Loss: 0.256 Vali Loss: 1.710 Vali Acc: 0.460 Test Loss: 1.710 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459983).  Saving model ...
Epoch: 3 cost time: 1.9181866645812988
Epoch: 3, Steps: 7 | Train Loss: 0.054 Vali Loss: 1.789 Vali Acc: 0.520 Test Loss: 1.789 Test Acc: 0.520
Validation loss decreased (-0.459983 --> -0.519982).  Saving model ...
Epoch: 4 cost time: 1.8383853435516357
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.651 Vali Acc: 0.540 Test Loss: 2.651 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539973).  Saving model ...
Epoch: 5 cost time: 1.6875824928283691
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.461 Vali Acc: 0.520 Test Loss: 3.461 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8594131469726562
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.900 Vali Acc: 0.520 Test Loss: 3.900 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.82478928565979
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.104 Vali Acc: 0.540 Test Loss: 4.104 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8056674003601074
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.186 Vali Acc: 0.540 Test Loss: 4.186 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7629079818725586
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.186 Vali Acc: 0.540 Test Loss: 4.186 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6651654243469238
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.168 Vali Acc: 0.520 Test Loss: 4.168 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7491199970245361
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.520 Test Loss: 4.149 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5300698280334473
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.132 Vali Acc: 0.520 Test Loss: 4.132 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.718148946762085
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.112 Vali Acc: 0.520 Test Loss: 4.112 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7383229732513428
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.097 Vali Acc: 0.520 Test Loss: 4.097 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3062095
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.647308588027954
Epoch: 1, Steps: 7 | Train Loss: 1.724 Vali Loss: 1.447 Vali Acc: 0.360 Test Loss: 1.447 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.4445512294769287
Epoch: 2, Steps: 7 | Train Loss: 0.193 Vali Loss: 2.454 Vali Acc: 0.420 Test Loss: 2.454 Test Acc: 0.420
Validation loss decreased (-0.359986 --> -0.419975).  Saving model ...
Epoch: 3 cost time: 1.5268869400024414
Epoch: 3, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.114 Vali Acc: 0.500 Test Loss: 2.114 Test Acc: 0.500
Validation loss decreased (-0.419975 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 1.4283273220062256
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.088 Vali Acc: 0.520 Test Loss: 2.088 Test Acc: 0.520
Validation loss decreased (-0.499979 --> -0.519979).  Saving model ...
Epoch: 5 cost time: 1.532010793685913
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.911 Vali Acc: 0.540 Test Loss: 2.911 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539971).  Saving model ...
Epoch: 6 cost time: 1.6274807453155518
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.884 Vali Acc: 0.540 Test Loss: 3.884 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5249700546264648
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.196 Vali Acc: 0.540 Test Loss: 4.196 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5826478004455566
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.031 Vali Acc: 0.540 Test Loss: 4.031 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5547468662261963
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.923 Vali Acc: 0.540 Test Loss: 3.923 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.52586030960083
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.848 Vali Acc: 0.540 Test Loss: 3.848 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4895868301391602
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.802 Vali Acc: 0.540 Test Loss: 3.802 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5311219692230225
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.768 Vali Acc: 0.540 Test Loss: 3.768 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6373159885406494
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.742 Vali Acc: 0.540 Test Loss: 3.742 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.447972297668457
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.540 Test Loss: 3.720 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5044424533843994
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.703 Vali Acc: 0.540 Test Loss: 3.703 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3047759
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.67474627494812
Epoch: 1, Steps: 7 | Train Loss: 1.742 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.2386689186096191
Epoch: 2, Steps: 7 | Train Loss: 0.221 Vali Loss: 1.588 Vali Acc: 0.500 Test Loss: 1.588 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.2720818519592285
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.580 Test Loss: 1.925 Test Acc: 0.580
Validation loss decreased (-0.499984 --> -0.579981).  Saving model ...
Epoch: 4 cost time: 1.2613990306854248
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.560 Test Loss: 2.252 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1650896072387695
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.550 Vali Acc: 0.580 Test Loss: 2.550 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.297790765762329
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.740 Vali Acc: 0.540 Test Loss: 2.740 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2719147205352783
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.852 Vali Acc: 0.540 Test Loss: 2.852 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2391228675842285
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.913 Vali Acc: 0.540 Test Loss: 2.913 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.279102087020874
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.946 Vali Acc: 0.540 Test Loss: 2.946 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2710742950439453
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.963 Vali Acc: 0.540 Test Loss: 2.963 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.285973072052002
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.971 Vali Acc: 0.540 Test Loss: 2.971 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3043010234832764
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.974 Vali Acc: 0.540 Test Loss: 2.974 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2136414051055908
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.975 Vali Acc: 0.540 Test Loss: 2.975 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3037519
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.636950969696045
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.534 Vali Acc: 0.320 Test Loss: 1.534 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.0959434509277344
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 1.621 Vali Acc: 0.520 Test Loss: 1.621 Test Acc: 0.520
Validation loss decreased (-0.319985 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 1.0894489288330078
Epoch: 3, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.407 Vali Acc: 0.480 Test Loss: 2.407 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2459580898284912
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.742 Vali Acc: 0.580 Test Loss: 2.742 Test Acc: 0.580
Validation loss decreased (-0.519984 --> -0.579973).  Saving model ...
Epoch: 5 cost time: 1.1695923805236816
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.626 Vali Acc: 0.520 Test Loss: 2.626 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0790281295776367
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.909 Vali Acc: 0.460 Test Loss: 2.909 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2120094299316406
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.110 Vali Acc: 0.460 Test Loss: 3.110 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0439708232879639
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.480 Test Loss: 3.214 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1941938400268555
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.480 Test Loss: 3.263 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0665936470031738
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.271 Vali Acc: 0.500 Test Loss: 3.271 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1324312686920166
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.268 Vali Acc: 0.500 Test Loss: 3.268 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2011003494262695
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.256 Vali Acc: 0.500 Test Loss: 3.256 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.144179105758667
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.246 Vali Acc: 0.500 Test Loss: 3.246 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0692827701568604
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.237 Vali Acc: 0.500 Test Loss: 3.237 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3031375
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.540832042694092
Epoch: 1, Steps: 7 | Train Loss: 1.650 Vali Loss: 1.282 Vali Acc: 0.460 Test Loss: 1.282 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.007540225982666
Epoch: 2, Steps: 7 | Train Loss: 0.207 Vali Loss: 1.944 Vali Acc: 0.560 Test Loss: 1.944 Test Acc: 0.560
Validation loss decreased (-0.459987 --> -0.559981).  Saving model ...
Epoch: 3 cost time: 1.1039419174194336
Epoch: 3, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
Validation loss decreased (-0.559981 --> -0.579986).  Saving model ...
Epoch: 4 cost time: 0.8231217861175537
Epoch: 4, Steps: 7 | Train Loss: 0.090 Vali Loss: 1.985 Vali Acc: 0.600 Test Loss: 1.985 Test Acc: 0.600
Validation loss decreased (-0.579986 --> -0.599980).  Saving model ...
Epoch: 5 cost time: 0.9095544815063477
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.323 Vali Acc: 0.500 Test Loss: 3.323 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8807191848754883
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.995 Vali Acc: 0.580 Test Loss: 1.995 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0781261920928955
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.600 Test Loss: 2.135 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9593515396118164
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.497 Vali Acc: 0.560 Test Loss: 2.497 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9779760837554932
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.540 Test Loss: 2.698 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9727194309234619
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.712 Vali Acc: 0.540 Test Loss: 2.712 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9024980068206787
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.540 Test Loss: 2.677 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0000338554382324
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.647 Vali Acc: 0.560 Test Loss: 2.647 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0202374458312988
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.629 Vali Acc: 0.560 Test Loss: 2.629 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9672548770904541
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.617 Vali Acc: 0.560 Test Loss: 2.617 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3025231
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0753633975982666
Epoch: 1, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.350 Vali Acc: 0.420 Test Loss: 1.350 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.741851806640625
Epoch: 2, Steps: 7 | Train Loss: 0.260 Vali Loss: 1.847 Vali Acc: 0.480 Test Loss: 1.847 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479982).  Saving model ...
Epoch: 3 cost time: 0.8160688877105713
Epoch: 3, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.751 Vali Acc: 0.540 Test Loss: 1.751 Test Acc: 0.540
Validation loss decreased (-0.479982 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 0.7470557689666748
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.480 Test Loss: 2.164 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8000094890594482
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.460 Test Loss: 2.565 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8175485134124756
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.739 Vali Acc: 0.460 Test Loss: 2.739 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9900422096252441
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.830 Vali Acc: 0.460 Test Loss: 2.830 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7993075847625732
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.880 Vali Acc: 0.460 Test Loss: 2.880 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8118672370910645
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.440 Test Loss: 2.907 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8530008792877197
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.920 Vali Acc: 0.440 Test Loss: 2.920 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9543240070343018
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.926 Vali Acc: 0.440 Test Loss: 2.926 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8228774070739746
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.929 Vali Acc: 0.440 Test Loss: 2.929 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8361396789550781
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.440 Test Loss: 2.930 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3021135
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.046590566635132
Epoch: 1, Steps: 7 | Train Loss: 1.601 Vali Loss: 1.424 Vali Acc: 0.400 Test Loss: 1.424 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 2.2421836853027344
Epoch: 2, Steps: 7 | Train Loss: 0.266 Vali Loss: 1.768 Vali Acc: 0.520 Test Loss: 1.768 Test Acc: 0.520
Validation loss decreased (-0.399986 --> -0.519982).  Saving model ...
Epoch: 3 cost time: 2.3658528327941895
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 2.522 Vali Acc: 0.580 Test Loss: 2.522 Test Acc: 0.580
Validation loss decreased (-0.519982 --> -0.579975).  Saving model ...
Epoch: 4 cost time: 2.290221929550171
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.684 Vali Acc: 0.580 Test Loss: 2.684 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3826091289520264
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.890 Vali Acc: 0.540 Test Loss: 2.890 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3397581577301025
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.102 Vali Acc: 0.520 Test Loss: 3.102 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.371065855026245
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.247 Vali Acc: 0.500 Test Loss: 3.247 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4987568855285645
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.328 Vali Acc: 0.480 Test Loss: 3.328 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4286487102508545
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.365 Vali Acc: 0.480 Test Loss: 3.365 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.491959571838379
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.378 Vali Acc: 0.480 Test Loss: 3.378 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3751699924468994
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.374 Vali Acc: 0.480 Test Loss: 3.374 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4656431674957275
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.366 Vali Acc: 0.480 Test Loss: 3.366 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3175899982452393
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.361 Vali Acc: 0.480 Test Loss: 3.361 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3045663
model size : 11.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.63997745513916
Epoch: 1, Steps: 7 | Train Loss: 1.718 Vali Loss: 1.404 Vali Acc: 0.380 Test Loss: 1.404 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 2.0603928565979004
Epoch: 2, Steps: 7 | Train Loss: 0.360 Vali Loss: 2.661 Vali Acc: 0.380 Test Loss: 2.661 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9938719272613525
Epoch: 3, Steps: 7 | Train Loss: 0.092 Vali Loss: 2.012 Vali Acc: 0.460 Test Loss: 2.012 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459980).  Saving model ...
Epoch: 4 cost time: 1.993173599243164
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.749 Vali Acc: 0.500 Test Loss: 2.749 Test Acc: 0.500
Validation loss decreased (-0.459980 --> -0.499973).  Saving model ...
Epoch: 5 cost time: 2.0619428157806396
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.226 Vali Acc: 0.540 Test Loss: 3.226 Test Acc: 0.540
Validation loss decreased (-0.499973 --> -0.539968).  Saving model ...
Epoch: 6 cost time: 2.153503894805908
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.335 Vali Acc: 0.520 Test Loss: 3.335 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.091064214706421
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.417 Vali Acc: 0.460 Test Loss: 3.417 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.06779146194458
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.454 Vali Acc: 0.460 Test Loss: 3.454 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1292173862457275
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.467 Vali Acc: 0.460 Test Loss: 3.467 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.170135498046875
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.472 Vali Acc: 0.460 Test Loss: 3.472 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0716729164123535
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.474 Vali Acc: 0.460 Test Loss: 3.474 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2392501831054688
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.473 Vali Acc: 0.460 Test Loss: 3.473 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.119553327560425
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.471 Vali Acc: 0.460 Test Loss: 3.471 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1507370471954346
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.468 Vali Acc: 0.460 Test Loss: 3.468 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1092934608459473
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.460 Test Loss: 3.465 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3031327
model size : 11.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.162339925765991
Epoch: 1, Steps: 7 | Train Loss: 1.596 Vali Loss: 1.364 Vali Acc: 0.420 Test Loss: 1.364 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 1.709850788116455
Epoch: 2, Steps: 7 | Train Loss: 0.255 Vali Loss: 1.306 Vali Acc: 0.560 Test Loss: 1.306 Test Acc: 0.560
Validation loss decreased (-0.419986 --> -0.559987).  Saving model ...
Epoch: 3 cost time: 1.797438383102417
Epoch: 3, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.637 Vali Acc: 0.540 Test Loss: 2.637 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6321418285369873
Epoch: 4, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.952 Vali Acc: 0.620 Test Loss: 1.952 Test Acc: 0.620
Validation loss decreased (-0.559987 --> -0.619980).  Saving model ...
Epoch: 5 cost time: 1.703049659729004
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.580 Test Loss: 3.063 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.748913288116455
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.370 Vali Acc: 0.580 Test Loss: 3.370 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7461259365081787
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.880 Vali Acc: 0.580 Test Loss: 2.880 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6565923690795898
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.769 Vali Acc: 0.620 Test Loss: 2.769 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6980667114257812
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.754 Vali Acc: 0.600 Test Loss: 2.754 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6623826026916504
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.761 Vali Acc: 0.640 Test Loss: 2.761 Test Acc: 0.640
Validation loss decreased (-0.619980 --> -0.639972).  Saving model ...
Epoch: 11 cost time: 1.6163203716278076
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.769 Vali Acc: 0.620 Test Loss: 2.769 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.591101884841919
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.773 Vali Acc: 0.620 Test Loss: 2.773 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8930485248565674
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.770 Vali Acc: 0.620 Test Loss: 2.770 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7802786827087402
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.768 Vali Acc: 0.620 Test Loss: 2.768 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.905937671661377
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.765 Vali Acc: 0.620 Test Loss: 2.765 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.915757656097412
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.763 Vali Acc: 0.620 Test Loss: 2.763 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7645559310913086
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.761 Vali Acc: 0.620 Test Loss: 2.761 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9282519817352295
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.757 Vali Acc: 0.640 Test Loss: 2.757 Test Acc: 0.640
Validation loss decreased (-0.639972 --> -0.639972).  Saving model ...
Epoch: 19 cost time: 1.8618483543395996
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.754 Vali Acc: 0.640 Test Loss: 2.754 Test Acc: 0.640
Validation loss decreased (-0.639972 --> -0.639972).  Saving model ...
Epoch: 20 cost time: 1.8820409774780273
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.751 Vali Acc: 0.640 Test Loss: 2.751 Test Acc: 0.640
Validation loss decreased (-0.639972 --> -0.639972).  Saving model ...
Epoch: 21 cost time: 1.6795282363891602
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.749 Vali Acc: 0.640 Test Loss: 2.749 Test Acc: 0.640
Validation loss decreased (-0.639972 --> -0.639973).  Saving model ...
Epoch: 22 cost time: 1.6812710762023926
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.747 Vali Acc: 0.640 Test Loss: 2.747 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 23 cost time: 1.7774956226348877
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.745 Vali Acc: 0.640 Test Loss: 2.745 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 24 cost time: 1.9493486881256104
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.640 Test Loss: 2.744 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 25 cost time: 1.8316395282745361
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.742 Vali Acc: 0.640 Test Loss: 2.742 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 26 cost time: 1.8241868019104004
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.741 Vali Acc: 0.640 Test Loss: 2.741 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 27 cost time: 1.8301467895507812
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.740 Vali Acc: 0.640 Test Loss: 2.740 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 28 cost time: 1.7598145008087158
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.738 Vali Acc: 0.640 Test Loss: 2.738 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 29 cost time: 1.8792893886566162
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.737 Vali Acc: 0.640 Test Loss: 2.737 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 30 cost time: 1.7459771633148193
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.735 Vali Acc: 0.640 Test Loss: 2.735 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 31 cost time: 1.7719683647155762
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.640 Test Loss: 2.733 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 32 cost time: 1.7266662120819092
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.640 Test Loss: 2.732 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 33 cost time: 1.7887670993804932
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.730 Vali Acc: 0.640 Test Loss: 2.730 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 34 cost time: 1.7692615985870361
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.728 Vali Acc: 0.640 Test Loss: 2.728 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 35 cost time: 1.7755730152130127
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.727 Vali Acc: 0.640 Test Loss: 2.727 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 36 cost time: 1.904707908630371
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.725 Vali Acc: 0.640 Test Loss: 2.725 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 37 cost time: 1.750180721282959
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.724 Vali Acc: 0.640 Test Loss: 2.724 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 38 cost time: 1.6648705005645752
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.722 Vali Acc: 0.640 Test Loss: 2.722 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 39 cost time: 1.8308637142181396
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.640 Test Loss: 2.721 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 40 cost time: 1.6553714275360107
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.719 Vali Acc: 0.640 Test Loss: 2.719 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 41 cost time: 1.8542649745941162
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.717 Vali Acc: 0.640 Test Loss: 2.717 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 42 cost time: 1.7057054042816162
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.640 Test Loss: 2.716 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 43 cost time: 1.764249324798584
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.640 Test Loss: 2.714 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 44 cost time: 1.8441545963287354
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.713 Vali Acc: 0.640 Test Loss: 2.713 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 45 cost time: 1.8213133811950684
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.640 Test Loss: 2.711 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 46 cost time: 1.793869972229004
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.710 Vali Acc: 0.640 Test Loss: 2.710 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 47 cost time: 1.8521203994750977
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.640 Test Loss: 2.708 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 48 cost time: 1.6889193058013916
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.707 Vali Acc: 0.640 Test Loss: 2.707 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 49 cost time: 1.7639763355255127
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.705 Vali Acc: 0.640 Test Loss: 2.705 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 50 cost time: 1.7761363983154297
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.704 Vali Acc: 0.640 Test Loss: 2.704 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 51 cost time: 1.8111581802368164
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.640 Test Loss: 2.702 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 52 cost time: 1.9511539936065674
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.701 Vali Acc: 0.640 Test Loss: 2.701 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 53 cost time: 1.7409777641296387
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.640 Test Loss: 2.700 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 54 cost time: 1.8432176113128662
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.640 Test Loss: 2.698 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 55 cost time: 1.8359167575836182
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.697 Vali Acc: 0.640 Test Loss: 2.697 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 56 cost time: 1.885486125946045
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.695 Vali Acc: 0.640 Test Loss: 2.695 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 57 cost time: 1.8405170440673828
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.640 Test Loss: 2.694 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 58 cost time: 1.78001070022583
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.693 Vali Acc: 0.640 Test Loss: 2.693 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 59 cost time: 1.80708909034729
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.640 Test Loss: 2.691 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 60 cost time: 1.9256808757781982
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.690 Vali Acc: 0.640 Test Loss: 2.690 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 61 cost time: 1.8272011280059814
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.689 Vali Acc: 0.640 Test Loss: 2.689 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 62 cost time: 1.7753970623016357
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.688 Vali Acc: 0.640 Test Loss: 2.688 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 63 cost time: 1.8805317878723145
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.686 Vali Acc: 0.640 Test Loss: 2.686 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 64 cost time: 1.7967588901519775
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.640 Test Loss: 2.685 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 65 cost time: 1.7291216850280762
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.683 Vali Acc: 0.640 Test Loss: 2.683 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 66 cost time: 1.9118168354034424
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.682 Vali Acc: 0.640 Test Loss: 2.682 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 67 cost time: 1.910811185836792
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.680 Vali Acc: 0.640 Test Loss: 2.680 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 68 cost time: 1.8095324039459229
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.640 Test Loss: 2.679 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 69 cost time: 1.7429540157318115
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.678 Vali Acc: 0.640 Test Loss: 2.678 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 70 cost time: 1.7745471000671387
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.640 Test Loss: 2.677 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 71 cost time: 1.8487670421600342
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.675 Vali Acc: 0.640 Test Loss: 2.675 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 72 cost time: 1.8700535297393799
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.674 Vali Acc: 0.640 Test Loss: 2.674 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 73 cost time: 1.7609143257141113
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.673 Vali Acc: 0.640 Test Loss: 2.673 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 74 cost time: 1.8486950397491455
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.672 Vali Acc: 0.640 Test Loss: 2.672 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 75 cost time: 1.8267865180969238
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.640 Test Loss: 2.671 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 76 cost time: 1.9713561534881592
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.670 Vali Acc: 0.640 Test Loss: 2.670 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 77 cost time: 1.930450201034546
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.669 Vali Acc: 0.640 Test Loss: 2.669 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 78 cost time: 1.7774584293365479
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.667 Vali Acc: 0.640 Test Loss: 2.667 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 79 cost time: 1.8048806190490723
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.666 Vali Acc: 0.640 Test Loss: 2.666 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 80 cost time: 1.8689615726470947
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.664 Vali Acc: 0.640 Test Loss: 2.664 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 81 cost time: 1.9190187454223633
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.662 Vali Acc: 0.640 Test Loss: 2.662 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 82 cost time: 1.7399873733520508
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.640 Test Loss: 2.661 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 83 cost time: 1.8160369396209717
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.659 Vali Acc: 0.640 Test Loss: 2.659 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 84 cost time: 1.8783774375915527
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.640 Test Loss: 2.658 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 85 cost time: 1.805431604385376
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.656 Vali Acc: 0.640 Test Loss: 2.656 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 86 cost time: 1.8470256328582764
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.655 Vali Acc: 0.640 Test Loss: 2.655 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 87 cost time: 1.8020572662353516
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.654 Vali Acc: 0.640 Test Loss: 2.654 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 88 cost time: 1.8656320571899414
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.653 Vali Acc: 0.640 Test Loss: 2.653 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 89 cost time: 1.7239558696746826
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.652 Vali Acc: 0.640 Test Loss: 2.652 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 90 cost time: 1.6553680896759033
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.651 Vali Acc: 0.640 Test Loss: 2.651 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 91 cost time: 1.7348668575286865
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.640 Test Loss: 2.650 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639973).  Saving model ...
Epoch: 92 cost time: 1.795142650604248
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.649 Vali Acc: 0.640 Test Loss: 2.649 Test Acc: 0.640
Validation loss decreased (-0.639973 --> -0.639974).  Saving model ...
Epoch: 93 cost time: 1.771545648574829
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.648 Vali Acc: 0.640 Test Loss: 2.648 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 94 cost time: 1.7965495586395264
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.647 Vali Acc: 0.640 Test Loss: 2.647 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 95 cost time: 2.002667188644409
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.646 Vali Acc: 0.640 Test Loss: 2.646 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 96 cost time: 1.9201457500457764
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.645 Vali Acc: 0.640 Test Loss: 2.645 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 97 cost time: 1.9060008525848389
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.640 Test Loss: 2.644 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 98 cost time: 1.7888426780700684
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.643 Vali Acc: 0.640 Test Loss: 2.643 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 99 cost time: 1.7826571464538574
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.642 Vali Acc: 0.640 Test Loss: 2.642 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
Epoch: 100 cost time: 1.8935191631317139
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.640 Test Loss: 2.641 Test Acc: 0.640
Validation loss decreased (-0.639974 --> -0.639974).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 3019039
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.684424638748169
Epoch: 1, Steps: 7 | Train Loss: 1.604 Vali Loss: 1.403 Vali Acc: 0.360 Test Loss: 1.403 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.3934805393218994
Epoch: 2, Steps: 7 | Train Loss: 0.329 Vali Loss: 1.614 Vali Acc: 0.460 Test Loss: 1.614 Test Acc: 0.460
Validation loss decreased (-0.359986 --> -0.459984).  Saving model ...
Epoch: 3 cost time: 1.39866304397583
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.540 Test Loss: 1.750 Test Acc: 0.540
Validation loss decreased (-0.459984 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 1.5204787254333496
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.322 Vali Acc: 0.560 Test Loss: 2.322 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559977).  Saving model ...
Epoch: 5 cost time: 1.3925528526306152
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.600 Test Loss: 2.484 Test Acc: 0.600
Validation loss decreased (-0.559977 --> -0.599975).  Saving model ...
Epoch: 6 cost time: 1.3488543033599854
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.600 Test Loss: 2.431 Test Acc: 0.600
Validation loss decreased (-0.599975 --> -0.599976).  Saving model ...
Epoch: 7 cost time: 1.3266966342926025
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.420 Vali Acc: 0.580 Test Loss: 2.420 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5647010803222656
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.420 Vali Acc: 0.580 Test Loss: 2.420 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3565995693206787
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.421 Vali Acc: 0.580 Test Loss: 2.421 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4287693500518799
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.423 Vali Acc: 0.580 Test Loss: 2.423 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3701069355010986
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.425 Vali Acc: 0.580 Test Loss: 2.425 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.365624189376831
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.426 Vali Acc: 0.580 Test Loss: 2.426 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.35302734375
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.426 Vali Acc: 0.580 Test Loss: 2.426 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4347879886627197
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.427 Vali Acc: 0.580 Test Loss: 2.427 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7102196216583252
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.427 Vali Acc: 0.580 Test Loss: 2.427 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4397149085998535
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.429 Vali Acc: 0.580 Test Loss: 2.429 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3004703
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7052016258239746
Epoch: 1, Steps: 7 | Train Loss: 1.607 Vali Loss: 1.263 Vali Acc: 0.420 Test Loss: 1.263 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.4037418365478516
Epoch: 2, Steps: 7 | Train Loss: 0.353 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.244321584701538
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.012 Vali Acc: 0.540 Test Loss: 2.012 Test Acc: 0.540
Validation loss decreased (-0.419987 --> -0.539980).  Saving model ...
Epoch: 4 cost time: 1.234757900238037
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.560 Vali Acc: 0.480 Test Loss: 2.560 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2542598247528076
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.566 Vali Acc: 0.400 Test Loss: 3.566 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2169997692108154
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.590 Vali Acc: 0.500 Test Loss: 3.590 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3300886154174805
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.842 Vali Acc: 0.540 Test Loss: 2.842 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4030275344848633
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.179 Vali Acc: 0.480 Test Loss: 3.179 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2385613918304443
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.864 Vali Acc: 0.520 Test Loss: 2.864 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3033835887908936
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.846 Vali Acc: 0.440 Test Loss: 4.846 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1880288124084473
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 3.266 Vali Acc: 0.420 Test Loss: 3.266 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2570788860321045
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.554 Vali Acc: 0.440 Test Loss: 3.554 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.200037956237793
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.059 Vali Acc: 0.460 Test Loss: 4.059 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2994463
model size : 11.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4882876873016357
Epoch: 1, Steps: 7 | Train Loss: 1.702 Vali Loss: 1.327 Vali Acc: 0.440 Test Loss: 1.327 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.3233463764190674
Epoch: 2, Steps: 7 | Train Loss: 0.244 Vali Loss: 1.341 Vali Acc: 0.540 Test Loss: 1.341 Test Acc: 0.540
Validation loss decreased (-0.439987 --> -0.539987).  Saving model ...
Epoch: 3 cost time: 1.1846082210540771
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.243 Vali Acc: 0.560 Test Loss: 2.243 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559978).  Saving model ...
Epoch: 4 cost time: 1.2074365615844727
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.829 Vali Acc: 0.540 Test Loss: 1.829 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3274757862091064
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.837 Vali Acc: 0.540 Test Loss: 1.837 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3248798847198486
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.580 Test Loss: 1.839 Test Acc: 0.580
Validation loss decreased (-0.559978 --> -0.579982).  Saving model ...
Epoch: 7 cost time: 1.2383229732513428
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.375 Vali Acc: 0.460 Test Loss: 2.375 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2439453601837158
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.701 Vali Acc: 0.460 Test Loss: 2.701 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1979222297668457
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.833 Vali Acc: 0.440 Test Loss: 2.833 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4563980102539062
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.420 Test Loss: 2.888 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.235375165939331
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.420 Test Loss: 2.907 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3528282642364502
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.420 Test Loss: 2.907 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2579903602600098
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.898 Vali Acc: 0.420 Test Loss: 2.898 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2017567157745361
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.440 Test Loss: 2.888 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2040634155273438
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.874 Vali Acc: 0.440 Test Loss: 2.874 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2747068405151367
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.861 Vali Acc: 0.440 Test Loss: 2.861 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2988319
model size : 11.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6708433628082275
Epoch: 1, Steps: 7 | Train Loss: 1.638 Vali Loss: 1.482 Vali Acc: 0.420 Test Loss: 1.482 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 1.114248514175415
Epoch: 2, Steps: 7 | Train Loss: 0.260 Vali Loss: 1.630 Vali Acc: 0.540 Test Loss: 1.630 Test Acc: 0.540
Validation loss decreased (-0.419985 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 1.1884801387786865
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.560 Test Loss: 1.792 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559982).  Saving model ...
Epoch: 4 cost time: 1.2456300258636475
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.580 Test Loss: 1.964 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579980).  Saving model ...
Epoch: 5 cost time: 1.0975456237792969
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.600 Test Loss: 2.150 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599979).  Saving model ...
Epoch: 6 cost time: 1.2237069606781006
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.620 Test Loss: 2.259 Test Acc: 0.620
Validation loss decreased (-0.599979 --> -0.619977).  Saving model ...
Epoch: 7 cost time: 1.0292727947235107
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.620 Test Loss: 2.319 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.113095998764038
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.620 Test Loss: 2.350 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0367381572723389
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.364 Vali Acc: 0.620 Test Loss: 2.364 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1033220291137695
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.620 Test Loss: 2.369 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1612820625305176
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.620 Test Loss: 2.371 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1716938018798828
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.620 Test Loss: 2.372 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1805667877197266
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.620 Test Loss: 2.371 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1282212734222412
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.620 Test Loss: 2.370 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1434309482574463
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.620 Test Loss: 2.368 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.259619951248169
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.620 Test Loss: 2.366 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2982175
model size : 11.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.207411289215088
Epoch: 1, Steps: 7 | Train Loss: 1.704 Vali Loss: 1.486 Vali Acc: 0.240 Test Loss: 1.486 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.043074607849121
Epoch: 2, Steps: 7 | Train Loss: 0.264 Vali Loss: 1.876 Vali Acc: 0.420 Test Loss: 1.876 Test Acc: 0.420
Validation loss decreased (-0.239985 --> -0.419981).  Saving model ...
Epoch: 3 cost time: 1.129488229751587
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.376 Vali Acc: 0.580 Test Loss: 2.376 Test Acc: 0.580
Validation loss decreased (-0.419981 --> -0.579976).  Saving model ...
Epoch: 4 cost time: 1.004939317703247
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.723 Vali Acc: 0.560 Test Loss: 2.723 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9823963642120361
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.002 Vali Acc: 0.520 Test Loss: 3.002 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0648407936096191
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.414 Vali Acc: 0.440 Test Loss: 3.414 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9854674339294434
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.643 Vali Acc: 0.460 Test Loss: 3.643 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0108208656311035
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.440 Test Loss: 3.720 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0454814434051514
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.757 Vali Acc: 0.440 Test Loss: 3.757 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9961636066436768
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.771 Vali Acc: 0.440 Test Loss: 3.771 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9994709491729736
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.769 Vali Acc: 0.440 Test Loss: 3.769 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0507383346557617
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.766 Vali Acc: 0.440 Test Loss: 3.766 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9950814247131348
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.762 Vali Acc: 0.440 Test Loss: 3.762 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2978079
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2052671909332275
Epoch: 1, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.343 Vali Acc: 0.360 Test Loss: 1.343 Test Acc: 0.360
Validation loss decreased (inf --> -0.359987).  Saving model ...
Epoch: 2 cost time: 2.372102975845337
Epoch: 2, Steps: 7 | Train Loss: 0.520 Vali Loss: 2.032 Vali Acc: 0.440 Test Loss: 2.032 Test Acc: 0.440
Validation loss decreased (-0.359987 --> -0.439980).  Saving model ...
Epoch: 3 cost time: 2.528942108154297
Epoch: 3, Steps: 7 | Train Loss: 0.033 Vali Loss: 2.537 Vali Acc: 0.520 Test Loss: 2.537 Test Acc: 0.520
Validation loss decreased (-0.439980 --> -0.519975).  Saving model ...
Epoch: 4 cost time: 2.4973769187927246
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.193 Vali Acc: 0.520 Test Loss: 2.193 Test Acc: 0.520
Validation loss decreased (-0.519975 --> -0.519978).  Saving model ...
Epoch: 5 cost time: 2.448253631591797
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.580 Test Loss: 2.388 Test Acc: 0.580
Validation loss decreased (-0.519978 --> -0.579976).  Saving model ...
Epoch: 6 cost time: 2.3947982788085938
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.273 Vali Acc: 0.600 Test Loss: 2.273 Test Acc: 0.600
Validation loss decreased (-0.579976 --> -0.599977).  Saving model ...
Epoch: 7 cost time: 2.513477325439453
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.560 Test Loss: 2.467 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.362504482269287
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.647 Vali Acc: 0.520 Test Loss: 2.647 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.452392339706421
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.520 Test Loss: 2.764 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4286084175109863
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.831 Vali Acc: 0.520 Test Loss: 2.831 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4178316593170166
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.868 Vali Acc: 0.520 Test Loss: 2.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2985689640045166
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.520 Test Loss: 2.888 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4669137001037598
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.898 Vali Acc: 0.520 Test Loss: 2.898 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.425938844680786
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.903 Vali Acc: 0.520 Test Loss: 2.903 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.429621458053589
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.906 Vali Acc: 0.520 Test Loss: 2.906 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.317199230194092
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.520 Test Loss: 2.907 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3024135
model size : 11.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.548079252243042
Epoch: 1, Steps: 7 | Train Loss: 1.472 Vali Loss: 1.453 Vali Acc: 0.460 Test Loss: 1.453 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 2.2269766330718994
Epoch: 2, Steps: 7 | Train Loss: 0.373 Vali Loss: 2.802 Vali Acc: 0.380 Test Loss: 2.802 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.078465700149536
Epoch: 3, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.999 Vali Acc: 0.460 Test Loss: 1.999 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0302071571350098
Epoch: 4, Steps: 7 | Train Loss: 0.074 Vali Loss: 3.073 Vali Acc: 0.440 Test Loss: 3.073 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0663535594940186
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.818 Vali Acc: 0.440 Test Loss: 4.818 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.09346342086792
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.136 Vali Acc: 0.440 Test Loss: 3.136 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1970162391662598
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.856 Vali Acc: 0.460 Test Loss: 4.856 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.292973518371582
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.578 Vali Acc: 0.520 Test Loss: 3.578 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519964).  Saving model ...
Epoch: 9 cost time: 2.138986349105835
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.865 Vali Acc: 0.480 Test Loss: 3.865 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9986622333526611
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.176 Vali Acc: 0.500 Test Loss: 3.176 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9980664253234863
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.718 Vali Acc: 0.480 Test Loss: 3.718 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0748631954193115
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.405 Vali Acc: 0.440 Test Loss: 4.405 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.171482801437378
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.127 Vali Acc: 0.440 Test Loss: 4.127 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1070680618286133
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.440 Test Loss: 3.858 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9378433227539062
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.809 Vali Acc: 0.440 Test Loss: 3.809 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.103729486465454
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.814 Vali Acc: 0.420 Test Loss: 3.814 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0659687519073486
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.823 Vali Acc: 0.420 Test Loss: 3.823 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.051361560821533
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.826 Vali Acc: 0.420 Test Loss: 3.826 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3009799
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3467729091644287
Epoch: 1, Steps: 7 | Train Loss: 1.724 Vali Loss: 1.614 Vali Acc: 0.280 Test Loss: 1.614 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.8157989978790283
Epoch: 2, Steps: 7 | Train Loss: 0.432 Vali Loss: 1.999 Vali Acc: 0.460 Test Loss: 1.999 Test Acc: 0.460
Validation loss decreased (-0.279984 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 2.008861541748047
Epoch: 3, Steps: 7 | Train Loss: 0.129 Vali Loss: 1.681 Vali Acc: 0.460 Test Loss: 1.681 Test Acc: 0.460
Validation loss decreased (-0.459980 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 1.939112901687622
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.334 Vali Acc: 0.520 Test Loss: 2.334 Test Acc: 0.520
Validation loss decreased (-0.459983 --> -0.519977).  Saving model ...
Epoch: 5 cost time: 2.0011086463928223
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.561 Vali Acc: 0.460 Test Loss: 4.561 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.000746488571167
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.655 Vali Acc: 0.520 Test Loss: 2.655 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9546988010406494
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.839 Vali Acc: 0.540 Test Loss: 2.839 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539972).  Saving model ...
Epoch: 8 cost time: 2.016666889190674
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.816 Vali Acc: 0.480 Test Loss: 3.816 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9874165058135986
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.540 Test Loss: 1.852 Test Acc: 0.540
Validation loss decreased (-0.539972 --> -0.539981).  Saving model ...
Epoch: 10 cost time: 1.794696569442749
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9907057285308838
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.657 Vali Acc: 0.480 Test Loss: 2.657 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7899842262268066
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.500 Test Loss: 2.453 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8556523323059082
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.684 Vali Acc: 0.500 Test Loss: 2.684 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9223756790161133
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.540 Test Loss: 2.411 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9169740676879883
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.560 Test Loss: 2.340 Test Acc: 0.560
Validation loss decreased (-0.539981 --> -0.559977).  Saving model ...
Epoch: 16 cost time: 1.824944257736206
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.580 Test Loss: 2.329 Test Acc: 0.580
Validation loss decreased (-0.559977 --> -0.579977).  Saving model ...
Epoch: 17 cost time: 1.903892993927002
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.580 Test Loss: 2.331 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9810590744018555
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.560 Test Loss: 2.334 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8854787349700928
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.560 Test Loss: 2.336 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.92216157913208
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.560 Test Loss: 2.337 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0861849784851074
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.560 Test Loss: 2.338 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9838471412658691
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.560 Test Loss: 2.339 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9729628562927246
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.560 Test Loss: 2.339 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.829404592514038
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.560 Test Loss: 2.339 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8527727127075195
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.560 Test Loss: 2.339 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.987353801727295
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.560 Test Loss: 2.339 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2997511
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.27396297454834
Epoch: 1, Steps: 7 | Train Loss: 1.770 Vali Loss: 1.729 Vali Acc: 0.380 Test Loss: 1.729 Test Acc: 0.380
Validation loss decreased (inf --> -0.379983).  Saving model ...
Epoch: 2 cost time: 1.668480634689331
Epoch: 2, Steps: 7 | Train Loss: 0.505 Vali Loss: 2.455 Vali Acc: 0.480 Test Loss: 2.455 Test Acc: 0.480
Validation loss decreased (-0.379983 --> -0.479975).  Saving model ...
Epoch: 3 cost time: 1.5178086757659912
Epoch: 3, Steps: 7 | Train Loss: 0.162 Vali Loss: 2.135 Vali Acc: 0.460 Test Loss: 2.135 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6774230003356934
Epoch: 4, Steps: 7 | Train Loss: 0.142 Vali Loss: 3.900 Vali Acc: 0.400 Test Loss: 3.900 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4890363216400146
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.657 Vali Acc: 0.400 Test Loss: 3.657 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.552603006362915
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.987 Vali Acc: 0.420 Test Loss: 4.987 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.523369312286377
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.035 Vali Acc: 0.380 Test Loss: 4.035 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5094120502471924
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.849 Vali Acc: 0.440 Test Loss: 3.849 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5375850200653076
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.472 Vali Acc: 0.400 Test Loss: 5.472 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.515697956085205
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.954 Vali Acc: 0.380 Test Loss: 6.954 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5313315391540527
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 5.360 Vali Acc: 0.400 Test Loss: 5.360 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.482980489730835
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.311 Vali Acc: 0.380 Test Loss: 4.311 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2983175
model size : 11.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.627201795578003
Epoch: 1, Steps: 7 | Train Loss: 1.740 Vali Loss: 1.374 Vali Acc: 0.360 Test Loss: 1.374 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.3242506980895996
Epoch: 2, Steps: 7 | Train Loss: 0.370 Vali Loss: 1.810 Vali Acc: 0.460 Test Loss: 1.810 Test Acc: 0.460
Validation loss decreased (-0.359986 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.3606162071228027
Epoch: 3, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.008 Vali Acc: 0.440 Test Loss: 2.008 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3780317306518555
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.454 Vali Acc: 0.480 Test Loss: 2.454 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479975).  Saving model ...
Epoch: 5 cost time: 1.3535215854644775
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.691 Vali Acc: 0.520 Test Loss: 2.691 Test Acc: 0.520
Validation loss decreased (-0.479975 --> -0.519973).  Saving model ...
Epoch: 6 cost time: 1.3469955921173096
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.046 Vali Acc: 0.460 Test Loss: 4.046 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.392887830734253
Epoch: 7, Steps: 7 | Train Loss: 0.107 Vali Loss: 3.161 Vali Acc: 0.600 Test Loss: 3.161 Test Acc: 0.600
Validation loss decreased (-0.519973 --> -0.599968).  Saving model ...
Epoch: 8 cost time: 1.281128168106079
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.538 Vali Acc: 0.540 Test Loss: 4.538 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3923885822296143
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 7.004 Vali Acc: 0.320 Test Loss: 7.004 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3753328323364258
Epoch: 10, Steps: 7 | Train Loss: 0.097 Vali Loss: 3.037 Vali Acc: 0.520 Test Loss: 3.037 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6764366626739502
Epoch: 11, Steps: 7 | Train Loss: 0.061 Vali Loss: 4.722 Vali Acc: 0.500 Test Loss: 4.722 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3918163776397705
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 5.618 Vali Acc: 0.420 Test Loss: 5.618 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4524152278900146
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.745 Vali Acc: 0.440 Test Loss: 5.745 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5303573608398438
Epoch: 14, Steps: 7 | Train Loss: 0.181 Vali Loss: 2.876 Vali Acc: 0.620 Test Loss: 2.876 Test Acc: 0.620
Validation loss decreased (-0.599968 --> -0.619971).  Saving model ...
Epoch: 15 cost time: 1.4123663902282715
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 6.045 Vali Acc: 0.440 Test Loss: 6.045 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5629243850708008
Epoch: 16, Steps: 7 | Train Loss: 0.391 Vali Loss: 11.058 Vali Acc: 0.460 Test Loss: 11.058 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4078171253204346
Epoch: 17, Steps: 7 | Train Loss: 0.302 Vali Loss: 8.906 Vali Acc: 0.480 Test Loss: 8.906 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7241215705871582
Epoch: 18, Steps: 7 | Train Loss: 0.220 Vali Loss: 9.285 Vali Acc: 0.460 Test Loss: 9.285 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6507620811462402
Epoch: 19, Steps: 7 | Train Loss: 0.238 Vali Loss: 8.766 Vali Acc: 0.500 Test Loss: 8.766 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4219670295715332
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 6.950 Vali Acc: 0.480 Test Loss: 6.950 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5499577522277832
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 9.047 Vali Acc: 0.420 Test Loss: 9.047 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.457758903503418
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 16.052 Vali Acc: 0.400 Test Loss: 16.052 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4640731811523438
Epoch: 23, Steps: 7 | Train Loss: 0.035 Vali Loss: 12.312 Vali Acc: 0.420 Test Loss: 12.312 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4648494720458984
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.641 Vali Acc: 0.480 Test Loss: 10.641 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2972935
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1220855712890625
Epoch: 1, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.434 Vali Acc: 0.340 Test Loss: 1.434 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 1.342581033706665
Epoch: 2, Steps: 7 | Train Loss: 0.347 Vali Loss: 1.412 Vali Acc: 0.480 Test Loss: 1.412 Test Acc: 0.480
Validation loss decreased (-0.339986 --> -0.479986).  Saving model ...
Epoch: 3 cost time: 1.1920487880706787
Epoch: 3, Steps: 7 | Train Loss: 0.061 Vali Loss: 2.289 Vali Acc: 0.500 Test Loss: 2.289 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 1.3814761638641357
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.273 Vali Acc: 0.560 Test Loss: 2.273 Test Acc: 0.560
Validation loss decreased (-0.499977 --> -0.559977).  Saving model ...
Epoch: 5 cost time: 1.2265660762786865
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.600 Test Loss: 1.944 Test Acc: 0.600
Validation loss decreased (-0.559977 --> -0.599981).  Saving model ...
Epoch: 6 cost time: 1.2835733890533447
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.560 Test Loss: 2.191 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3062119483947754
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.540 Test Loss: 2.522 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2974729537963867
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.735 Vali Acc: 0.560 Test Loss: 2.735 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3175041675567627
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.853 Vali Acc: 0.560 Test Loss: 2.853 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1379992961883545
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.917 Vali Acc: 0.560 Test Loss: 2.917 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.206864833831787
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.950 Vali Acc: 0.560 Test Loss: 2.950 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2214548587799072
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.966 Vali Acc: 0.560 Test Loss: 2.966 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2286319732666016
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.974 Vali Acc: 0.560 Test Loss: 2.974 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1758079528808594
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.976 Vali Acc: 0.560 Test Loss: 2.976 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.272644281387329
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.976 Vali Acc: 0.560 Test Loss: 2.976 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2966791
model size : 11.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4611146450042725
Epoch: 1, Steps: 7 | Train Loss: 1.614 Vali Loss: 1.282 Vali Acc: 0.440 Test Loss: 1.282 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.0888919830322266
Epoch: 2, Steps: 7 | Train Loss: 0.654 Vali Loss: 1.796 Vali Acc: 0.440 Test Loss: 1.796 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2159876823425293
Epoch: 3, Steps: 7 | Train Loss: 0.160 Vali Loss: 2.858 Vali Acc: 0.500 Test Loss: 2.858 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499971).  Saving model ...
Epoch: 4 cost time: 1.003464698791504
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.690 Vali Acc: 0.500 Test Loss: 2.690 Test Acc: 0.500
Validation loss decreased (-0.499971 --> -0.499973).  Saving model ...
Epoch: 5 cost time: 1.1678555011749268
Epoch: 5, Steps: 7 | Train Loss: 0.167 Vali Loss: 4.321 Vali Acc: 0.400 Test Loss: 4.321 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9917812347412109
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.380 Vali Acc: 0.440 Test Loss: 4.380 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.124779462814331
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 3.873 Vali Acc: 0.440 Test Loss: 3.873 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2253186702728271
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.149 Vali Acc: 0.400 Test Loss: 5.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9726169109344482
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 4.028 Vali Acc: 0.500 Test Loss: 4.028 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.164158582687378
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.334 Vali Acc: 0.440 Test Loss: 4.334 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1477108001708984
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.560 Vali Acc: 0.420 Test Loss: 4.560 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2449586391448975
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.108 Vali Acc: 0.460 Test Loss: 4.108 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0788919925689697
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.904 Vali Acc: 0.500 Test Loss: 3.904 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0336978435516357
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.789 Vali Acc: 0.500 Test Loss: 3.789 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2960647
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.315682888031006
Epoch: 1, Steps: 7 | Train Loss: 1.735 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.9572057723999023
Epoch: 2, Steps: 7 | Train Loss: 0.530 Vali Loss: 1.427 Vali Acc: 0.540 Test Loss: 1.427 Test Acc: 0.540
Validation loss decreased (-0.319984 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 1.046229600906372
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.130 Vali Acc: 0.500 Test Loss: 2.130 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8967635631561279
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.400 Vali Acc: 0.500 Test Loss: 2.400 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0690219402313232
Epoch: 5, Steps: 7 | Train Loss: 0.123 Vali Loss: 2.372 Vali Acc: 0.500 Test Loss: 2.372 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9210155010223389
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.540 Test Loss: 2.430 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1089048385620117
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.436 Vali Acc: 0.600 Test Loss: 2.436 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599976).  Saving model ...
Epoch: 8 cost time: 0.9464373588562012
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.722 Vali Acc: 0.580 Test Loss: 2.722 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0578157901763916
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.560 Test Loss: 2.844 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0489778518676758
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.871 Vali Acc: 0.560 Test Loss: 2.871 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0509238243103027
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.864 Vali Acc: 0.560 Test Loss: 2.864 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.931175708770752
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.843 Vali Acc: 0.560 Test Loss: 2.843 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0096571445465088
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.560 Test Loss: 2.828 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9898359775543213
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.819 Vali Acc: 0.560 Test Loss: 2.819 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.949988603591919
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.811 Vali Acc: 0.560 Test Loss: 2.811 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1044604778289795
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.560 Test Loss: 2.805 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0049872398376465
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.560 Test Loss: 2.800 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2956551
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9788596630096436
Epoch: 1, Steps: 7 | Train Loss: 1.793 Vali Loss: 2.215 Vali Acc: 0.220 Test Loss: 2.215 Test Acc: 0.220
Validation loss decreased (inf --> -0.219978).  Saving model ...
Epoch: 2 cost time: 2.3224401473999023
Epoch: 2, Steps: 7 | Train Loss: 1.131 Vali Loss: 2.317 Vali Acc: 0.400 Test Loss: 2.317 Test Acc: 0.400
Validation loss decreased (-0.219978 --> -0.399977).  Saving model ...
Epoch: 3 cost time: 2.4703612327575684
Epoch: 3, Steps: 7 | Train Loss: 0.201 Vali Loss: 1.889 Vali Acc: 0.420 Test Loss: 1.889 Test Acc: 0.420
Validation loss decreased (-0.399977 --> -0.419981).  Saving model ...
Epoch: 4 cost time: 2.360734462738037
Epoch: 4, Steps: 7 | Train Loss: 0.077 Vali Loss: 4.403 Vali Acc: 0.440 Test Loss: 4.403 Test Acc: 0.440
Validation loss decreased (-0.419981 --> -0.439956).  Saving model ...
Epoch: 5 cost time: 2.3572986125946045
Epoch: 5, Steps: 7 | Train Loss: 0.385 Vali Loss: 3.185 Vali Acc: 0.420 Test Loss: 3.185 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3166801929473877
Epoch: 6, Steps: 7 | Train Loss: 0.154 Vali Loss: 3.759 Vali Acc: 0.480 Test Loss: 3.759 Test Acc: 0.480
Validation loss decreased (-0.439956 --> -0.479962).  Saving model ...
Epoch: 7 cost time: 2.4215006828308105
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.729 Vali Acc: 0.500 Test Loss: 3.729 Test Acc: 0.500
Validation loss decreased (-0.479962 --> -0.499963).  Saving model ...
Epoch: 8 cost time: 2.354438543319702
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.398 Vali Acc: 0.420 Test Loss: 3.398 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2203197479248047
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.627 Vali Acc: 0.480 Test Loss: 4.627 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.444276809692383
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.000 Vali Acc: 0.440 Test Loss: 4.000 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2455594539642334
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.749 Vali Acc: 0.500 Test Loss: 4.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3415069580078125
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.028 Vali Acc: 0.480 Test Loss: 5.028 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.28180193901062
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.604 Vali Acc: 0.500 Test Loss: 5.604 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.375338315963745
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.845 Vali Acc: 0.280 Test Loss: 9.845 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.382458209991455
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 11.816 Vali Acc: 0.280 Test Loss: 11.816 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.351348638534546
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 7.117 Vali Acc: 0.460 Test Loss: 7.117 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.460186719894409
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.358 Vali Acc: 0.420 Test Loss: 9.358 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3013371
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9327831268310547
Epoch: 1, Steps: 7 | Train Loss: 1.651 Vali Loss: 2.066 Vali Acc: 0.320 Test Loss: 2.066 Test Acc: 0.320
Validation loss decreased (inf --> -0.319979).  Saving model ...
Epoch: 2 cost time: 2.2117631435394287
Epoch: 2, Steps: 7 | Train Loss: 0.836 Vali Loss: 2.420 Vali Acc: 0.400 Test Loss: 2.420 Test Acc: 0.400
Validation loss decreased (-0.319979 --> -0.399976).  Saving model ...
Epoch: 3 cost time: 2.2501296997070312
Epoch: 3, Steps: 7 | Train Loss: 0.419 Vali Loss: 2.645 Vali Acc: 0.400 Test Loss: 2.645 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.170323610305786
Epoch: 4, Steps: 7 | Train Loss: 0.083 Vali Loss: 4.894 Vali Acc: 0.340 Test Loss: 4.894 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1901137828826904
Epoch: 5, Steps: 7 | Train Loss: 0.548 Vali Loss: 2.262 Vali Acc: 0.520 Test Loss: 2.262 Test Acc: 0.520
Validation loss decreased (-0.399976 --> -0.519977).  Saving model ...
Epoch: 6 cost time: 2.176020383834839
Epoch: 6, Steps: 7 | Train Loss: 0.323 Vali Loss: 2.113 Vali Acc: 0.600 Test Loss: 2.113 Test Acc: 0.600
Validation loss decreased (-0.519977 --> -0.599979).  Saving model ...
Epoch: 7 cost time: 2.202686071395874
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.762 Vali Acc: 0.500 Test Loss: 3.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.316169261932373
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.696 Vali Acc: 0.500 Test Loss: 3.696 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.135481357574463
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.354 Vali Acc: 0.500 Test Loss: 3.354 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.244995594024658
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.300 Vali Acc: 0.440 Test Loss: 4.300 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3237464427948
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 3.841 Vali Acc: 0.520 Test Loss: 3.841 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3013062477111816
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.620 Vali Acc: 0.480 Test Loss: 4.620 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.215674638748169
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.351 Vali Acc: 0.520 Test Loss: 4.351 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2789556980133057
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.261 Vali Acc: 0.500 Test Loss: 4.261 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1593356132507324
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.233 Vali Acc: 0.500 Test Loss: 4.233 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.190885543823242
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.221 Vali Acc: 0.500 Test Loss: 4.221 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2999035
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4872074127197266
Epoch: 1, Steps: 7 | Train Loss: 1.763 Vali Loss: 1.742 Vali Acc: 0.280 Test Loss: 1.742 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 1.927147626876831
Epoch: 2, Steps: 7 | Train Loss: 0.961 Vali Loss: 2.623 Vali Acc: 0.340 Test Loss: 2.623 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339974).  Saving model ...
Epoch: 3 cost time: 1.7938125133514404
Epoch: 3, Steps: 7 | Train Loss: 0.530 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
Validation loss decreased (-0.339974 --> -0.539979).  Saving model ...
Epoch: 4 cost time: 1.6898810863494873
Epoch: 4, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.794 Vali Acc: 0.500 Test Loss: 2.794 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.740992784500122
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.961 Vali Acc: 0.480 Test Loss: 3.961 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8060712814331055
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.700 Vali Acc: 0.460 Test Loss: 4.700 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8519659042358398
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.778 Vali Acc: 0.460 Test Loss: 4.778 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8370375633239746
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.629 Vali Acc: 0.480 Test Loss: 4.629 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8132266998291016
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.522 Vali Acc: 0.500 Test Loss: 4.522 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8645801544189453
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.443 Vali Acc: 0.500 Test Loss: 4.443 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.814441204071045
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.390 Vali Acc: 0.500 Test Loss: 4.390 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8604991436004639
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.357 Vali Acc: 0.500 Test Loss: 4.357 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8198573589324951
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.338 Vali Acc: 0.500 Test Loss: 4.338 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2986747
model size : 11.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.925264596939087
Epoch: 1, Steps: 7 | Train Loss: 1.772 Vali Loss: 1.383 Vali Acc: 0.360 Test Loss: 1.383 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.6431212425231934
Epoch: 2, Steps: 7 | Train Loss: 0.684 Vali Loss: 2.406 Vali Acc: 0.440 Test Loss: 2.406 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439976).  Saving model ...
Epoch: 3 cost time: 1.5318267345428467
Epoch: 3, Steps: 7 | Train Loss: 0.157 Vali Loss: 2.634 Vali Acc: 0.420 Test Loss: 2.634 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5791831016540527
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.609 Vali Acc: 0.480 Test Loss: 2.609 Test Acc: 0.480
Validation loss decreased (-0.439976 --> -0.479974).  Saving model ...
Epoch: 5 cost time: 1.5960090160369873
Epoch: 5, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.986 Vali Acc: 0.440 Test Loss: 3.986 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7578139305114746
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.025 Vali Acc: 0.540 Test Loss: 4.025 Test Acc: 0.540
Validation loss decreased (-0.479974 --> -0.539960).  Saving model ...
Epoch: 7 cost time: 1.611374855041504
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.795 Vali Acc: 0.540 Test Loss: 2.795 Test Acc: 0.540
Validation loss decreased (-0.539960 --> -0.539972).  Saving model ...
Epoch: 8 cost time: 1.8278203010559082
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.949 Vali Acc: 0.520 Test Loss: 2.949 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7697179317474365
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.278 Vali Acc: 0.560 Test Loss: 3.278 Test Acc: 0.560
Validation loss decreased (-0.539972 --> -0.559967).  Saving model ...
Epoch: 10 cost time: 1.6924397945404053
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.503 Vali Acc: 0.540 Test Loss: 3.503 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5722191333770752
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.629 Vali Acc: 0.500 Test Loss: 3.629 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5862536430358887
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.680 Vali Acc: 0.500 Test Loss: 3.680 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4600622653961182
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.697 Vali Acc: 0.500 Test Loss: 3.697 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5891220569610596
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.691 Vali Acc: 0.480 Test Loss: 3.691 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5311028957366943
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.674 Vali Acc: 0.480 Test Loss: 3.674 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5686681270599365
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.655 Vali Acc: 0.480 Test Loss: 3.655 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4197392463684082
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.635 Vali Acc: 0.480 Test Loss: 3.635 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5038034915924072
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.615 Vali Acc: 0.480 Test Loss: 3.615 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5697705745697021
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.583 Vali Acc: 0.480 Test Loss: 3.583 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2972411
model size : 11.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7272069454193115
Epoch: 1, Steps: 7 | Train Loss: 1.788 Vali Loss: 2.208 Vali Acc: 0.300 Test Loss: 2.208 Test Acc: 0.300
Validation loss decreased (inf --> -0.299978).  Saving model ...
Epoch: 2 cost time: 1.270338773727417
Epoch: 2, Steps: 7 | Train Loss: 0.858 Vali Loss: 3.140 Vali Acc: 0.380 Test Loss: 3.140 Test Acc: 0.380
Validation loss decreased (-0.299978 --> -0.379969).  Saving model ...
Epoch: 3 cost time: 1.3767175674438477
Epoch: 3, Steps: 7 | Train Loss: 0.633 Vali Loss: 2.339 Vali Acc: 0.380 Test Loss: 2.339 Test Acc: 0.380
Validation loss decreased (-0.379969 --> -0.379977).  Saving model ...
Epoch: 4 cost time: 1.310276985168457
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.726 Vali Acc: 0.460 Test Loss: 2.726 Test Acc: 0.460
Validation loss decreased (-0.379977 --> -0.459973).  Saving model ...
Epoch: 5 cost time: 1.3047282695770264
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.198 Vali Acc: 0.440 Test Loss: 3.198 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2513766288757324
Epoch: 6, Steps: 7 | Train Loss: 0.229 Vali Loss: 4.811 Vali Acc: 0.320 Test Loss: 4.811 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4686055183410645
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.539 Vali Acc: 0.380 Test Loss: 4.539 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.385335922241211
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 3.879 Vali Acc: 0.360 Test Loss: 3.879 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2591185569763184
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.775 Vali Acc: 0.340 Test Loss: 5.775 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2854275703430176
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.035 Vali Acc: 0.380 Test Loss: 4.035 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4117631912231445
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.775 Vali Acc: 0.440 Test Loss: 3.775 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3094937801361084
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.785 Vali Acc: 0.460 Test Loss: 3.785 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2335197925567627
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.806 Vali Acc: 0.460 Test Loss: 3.806 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1980671882629395
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.810 Vali Acc: 0.460 Test Loss: 3.810 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2962171
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.400987386703491
Epoch: 1, Steps: 7 | Train Loss: 1.761 Vali Loss: 1.590 Vali Acc: 0.380 Test Loss: 1.590 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.1677677631378174
Epoch: 2, Steps: 7 | Train Loss: 0.748 Vali Loss: 1.530 Vali Acc: 0.480 Test Loss: 1.530 Test Acc: 0.480
Validation loss decreased (-0.379984 --> -0.479985).  Saving model ...
Epoch: 3 cost time: 1.1545517444610596
Epoch: 3, Steps: 7 | Train Loss: 0.103 Vali Loss: 2.020 Vali Acc: 0.380 Test Loss: 2.020 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2199368476867676
Epoch: 4, Steps: 7 | Train Loss: 0.088 Vali Loss: 2.791 Vali Acc: 0.500 Test Loss: 2.791 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499972).  Saving model ...
Epoch: 5 cost time: 1.1309947967529297
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 2.831 Vali Acc: 0.480 Test Loss: 2.831 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1989524364471436
Epoch: 6, Steps: 7 | Train Loss: 0.029 Vali Loss: 3.177 Vali Acc: 0.460 Test Loss: 3.177 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3284642696380615
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.554 Vali Acc: 0.480 Test Loss: 4.554 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2400166988372803
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.635 Vali Acc: 0.580 Test Loss: 3.635 Test Acc: 0.580
Validation loss decreased (-0.499972 --> -0.579964).  Saving model ...
Epoch: 9 cost time: 1.1678855419158936
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.731 Vali Acc: 0.560 Test Loss: 3.731 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3510258197784424
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.866 Vali Acc: 0.560 Test Loss: 3.866 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.253495693206787
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.936 Vali Acc: 0.560 Test Loss: 3.936 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.223026990890503
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.953 Vali Acc: 0.560 Test Loss: 3.953 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1254768371582031
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.940 Vali Acc: 0.560 Test Loss: 3.940 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2585432529449463
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.912 Vali Acc: 0.540 Test Loss: 3.912 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.255465030670166
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.883 Vali Acc: 0.540 Test Loss: 3.883 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2068252563476562
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.862 Vali Acc: 0.540 Test Loss: 3.862 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1828219890594482
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.847 Vali Acc: 0.540 Test Loss: 3.847 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.199106216430664
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.540 Test Loss: 3.832 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2956027
model size : 11.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6388092041015625
Epoch: 1, Steps: 7 | Train Loss: 1.598 Vali Loss: 1.870 Vali Acc: 0.280 Test Loss: 1.870 Test Acc: 0.280
Validation loss decreased (inf --> -0.279981).  Saving model ...
Epoch: 2 cost time: 1.2173314094543457
Epoch: 2, Steps: 7 | Train Loss: 0.703 Vali Loss: 2.313 Vali Acc: 0.380 Test Loss: 2.313 Test Acc: 0.380
Validation loss decreased (-0.279981 --> -0.379977).  Saving model ...
Epoch: 3 cost time: 1.2270524501800537
Epoch: 3, Steps: 7 | Train Loss: 0.171 Vali Loss: 2.711 Vali Acc: 0.440 Test Loss: 2.711 Test Acc: 0.440
Validation loss decreased (-0.379977 --> -0.439973).  Saving model ...
Epoch: 4 cost time: 1.243297815322876
Epoch: 4, Steps: 7 | Train Loss: 0.406 Vali Loss: 2.992 Vali Acc: 0.360 Test Loss: 2.992 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1561684608459473
Epoch: 5, Steps: 7 | Train Loss: 0.076 Vali Loss: 4.497 Vali Acc: 0.380 Test Loss: 4.497 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9756247997283936
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.666 Vali Acc: 0.340 Test Loss: 3.666 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1033093929290771
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.216 Vali Acc: 0.360 Test Loss: 4.216 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.088599443435669
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.874 Vali Acc: 0.400 Test Loss: 5.874 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0488450527191162
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.446 Vali Acc: 0.400 Test Loss: 6.446 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.132568597793579
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 7.125 Vali Acc: 0.460 Test Loss: 7.125 Test Acc: 0.460
Validation loss decreased (-0.439973 --> -0.459929).  Saving model ...
Epoch: 11 cost time: 1.027963638305664
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.839 Vali Acc: 0.480 Test Loss: 3.839 Test Acc: 0.480
Validation loss decreased (-0.459929 --> -0.479962).  Saving model ...
Epoch: 12 cost time: 1.1456990242004395
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.129 Vali Acc: 0.440 Test Loss: 4.129 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1439692974090576
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 7.342 Vali Acc: 0.340 Test Loss: 7.342 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0998923778533936
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.791 Vali Acc: 0.540 Test Loss: 3.791 Test Acc: 0.540
Validation loss decreased (-0.479962 --> -0.539962).  Saving model ...
Epoch: 15 cost time: 1.0746748447418213
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.984 Vali Acc: 0.480 Test Loss: 3.984 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1166625022888184
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.594 Vali Acc: 0.420 Test Loss: 3.594 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.174811840057373
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.641 Vali Acc: 0.420 Test Loss: 3.641 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1439673900604248
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.664 Vali Acc: 0.420 Test Loss: 3.664 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2143137454986572
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.552 Vali Acc: 0.440 Test Loss: 3.552 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1191442012786865
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.477 Vali Acc: 0.440 Test Loss: 3.477 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2218623161315918
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.437 Vali Acc: 0.440 Test Loss: 3.437 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1488819122314453
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.414 Vali Acc: 0.440 Test Loss: 3.414 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2597110271453857
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.402 Vali Acc: 0.440 Test Loss: 3.402 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.193964958190918
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.394 Vali Acc: 0.440 Test Loss: 3.394 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2949883
model size : 11.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.375774383544922
Epoch: 1, Steps: 7 | Train Loss: 1.792 Vali Loss: 1.651 Vali Acc: 0.220 Test Loss: 1.651 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 0.9550702571868896
Epoch: 2, Steps: 7 | Train Loss: 0.523 Vali Loss: 1.366 Vali Acc: 0.540 Test Loss: 1.366 Test Acc: 0.540
Validation loss decreased (-0.219983 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 1.0056977272033691
Epoch: 3, Steps: 7 | Train Loss: 0.170 Vali Loss: 2.871 Vali Acc: 0.400 Test Loss: 2.871 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9791162014007568
Epoch: 4, Steps: 7 | Train Loss: 0.272 Vali Loss: 1.915 Vali Acc: 0.440 Test Loss: 1.915 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9995973110198975
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.426 Vali Acc: 0.520 Test Loss: 3.426 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0962934494018555
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.458 Vali Acc: 0.380 Test Loss: 5.458 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0378291606903076
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 4.223 Vali Acc: 0.480 Test Loss: 4.223 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9025044441223145
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.478 Vali Acc: 0.460 Test Loss: 3.478 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9439973831176758
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.985 Vali Acc: 0.380 Test Loss: 6.985 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9969141483306885
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 6.554 Vali Acc: 0.400 Test Loss: 6.554 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9883723258972168
Epoch: 11, Steps: 7 | Train Loss: 0.108 Vali Loss: 5.360 Vali Acc: 0.500 Test Loss: 5.360 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9436767101287842
Epoch: 12, Steps: 7 | Train Loss: 0.084 Vali Loss: 9.435 Vali Acc: 0.380 Test Loss: 9.435 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2945787
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.93635630607605
Epoch: 1, Steps: 7 | Train Loss: 1.533 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 2.3278567790985107
Epoch: 2, Steps: 7 | Train Loss: 0.181 Vali Loss: 1.560 Vali Acc: 0.560 Test Loss: 1.560 Test Acc: 0.560
Validation loss decreased (-0.499987 --> -0.559984).  Saving model ...
Epoch: 3 cost time: 2.243858575820923
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.077 Vali Acc: 0.540 Test Loss: 2.077 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3130457401275635
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.540 Test Loss: 2.474 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3046624660491943
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.725 Vali Acc: 0.520 Test Loss: 2.725 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3225691318511963
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.873 Vali Acc: 0.520 Test Loss: 2.873 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3906257152557373
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.958 Vali Acc: 0.520 Test Loss: 2.958 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2368264198303223
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.005 Vali Acc: 0.520 Test Loss: 3.005 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4737296104431152
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.030 Vali Acc: 0.520 Test Loss: 3.030 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3204808235168457
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.520 Test Loss: 3.044 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4067752361297607
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.520 Test Loss: 3.051 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.307683229446411
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.054 Vali Acc: 0.520 Test Loss: 3.054 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2999917
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5371735095977783
Epoch: 1, Steps: 7 | Train Loss: 1.483 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 2.0837996006011963
Epoch: 2, Steps: 7 | Train Loss: 0.161 Vali Loss: 1.531 Vali Acc: 0.560 Test Loss: 1.531 Test Acc: 0.560
Validation loss decreased (-0.399986 --> -0.559985).  Saving model ...
Epoch: 3 cost time: 2.1145145893096924
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.501 Vali Acc: 0.440 Test Loss: 2.501 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.343123197555542
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.697 Vali Acc: 0.540 Test Loss: 2.697 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1195595264434814
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.849 Vali Acc: 0.540 Test Loss: 2.849 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1285362243652344
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.944 Vali Acc: 0.560 Test Loss: 2.944 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0999367237091064
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.000 Vali Acc: 0.580 Test Loss: 3.000 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579970).  Saving model ...
Epoch: 8 cost time: 2.0795528888702393
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.580 Test Loss: 3.031 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1618595123291016
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.580 Test Loss: 3.048 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.265476942062378
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.056 Vali Acc: 0.580 Test Loss: 3.056 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1191234588623047
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.061 Vali Acc: 0.580 Test Loss: 3.061 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.25762939453125
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.580 Test Loss: 3.063 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.146369695663452
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.580 Test Loss: 3.063 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.181807518005371
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.580 Test Loss: 3.063 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1407997608184814
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.580 Test Loss: 3.063 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2148189544677734
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.062 Vali Acc: 0.580 Test Loss: 3.062 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0440659523010254
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.061 Vali Acc: 0.580 Test Loss: 3.061 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2985581
model size : 11.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3181042671203613
Epoch: 1, Steps: 7 | Train Loss: 1.649 Vali Loss: 1.358 Vali Acc: 0.440 Test Loss: 1.358 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.8300912380218506
Epoch: 2, Steps: 7 | Train Loss: 0.237 Vali Loss: 1.967 Vali Acc: 0.460 Test Loss: 1.967 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 1.8906028270721436
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.965 Vali Acc: 0.480 Test Loss: 1.965 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479980).  Saving model ...
Epoch: 4 cost time: 1.7479324340820312
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.228 Vali Acc: 0.420 Test Loss: 2.228 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0506746768951416
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.480 Test Loss: 2.485 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8678107261657715
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.480 Test Loss: 2.661 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.986588954925537
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.500 Test Loss: 2.764 Test Acc: 0.500
Validation loss decreased (-0.479980 --> -0.499972).  Saving model ...
Epoch: 8 cost time: 1.7943668365478516
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.815 Vali Acc: 0.500 Test Loss: 2.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8062071800231934
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.500 Test Loss: 2.837 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.835500717163086
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.500 Test Loss: 2.845 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.873086929321289
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.480 Test Loss: 2.846 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8574509620666504
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.480 Test Loss: 2.845 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8585171699523926
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.841 Vali Acc: 0.480 Test Loss: 2.841 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7811756134033203
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.838 Vali Acc: 0.480 Test Loss: 2.838 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7840766906738281
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.834 Vali Acc: 0.480 Test Loss: 2.834 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8250787258148193
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.831 Vali Acc: 0.480 Test Loss: 2.831 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8034017086029053
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.827 Vali Acc: 0.480 Test Loss: 2.827 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2973293
model size : 11.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8365237712860107
Epoch: 1, Steps: 7 | Train Loss: 1.671 Vali Loss: 1.288 Vali Acc: 0.340 Test Loss: 1.288 Test Acc: 0.340
Validation loss decreased (inf --> -0.339987).  Saving model ...
Epoch: 2 cost time: 1.406999111175537
Epoch: 2, Steps: 7 | Train Loss: 0.252 Vali Loss: 1.805 Vali Acc: 0.520 Test Loss: 1.805 Test Acc: 0.520
Validation loss decreased (-0.339987 --> -0.519982).  Saving model ...
Epoch: 3 cost time: 1.4652047157287598
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.937 Vali Acc: 0.520 Test Loss: 1.937 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5149970054626465
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.460 Test Loss: 2.528 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5300211906433105
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.106 Vali Acc: 0.420 Test Loss: 3.106 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5002150535583496
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.452 Vali Acc: 0.380 Test Loss: 3.452 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5341103076934814
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.624 Vali Acc: 0.380 Test Loss: 3.624 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4757609367370605
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.704 Vali Acc: 0.380 Test Loss: 3.704 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5381734371185303
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.727 Vali Acc: 0.380 Test Loss: 3.727 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.436774492263794
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.730 Vali Acc: 0.380 Test Loss: 3.730 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.456054925918579
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.726 Vali Acc: 0.380 Test Loss: 3.726 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4740750789642334
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.719 Vali Acc: 0.380 Test Loss: 3.719 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2958957
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6099421977996826
Epoch: 1, Steps: 7 | Train Loss: 1.696 Vali Loss: 1.281 Vali Acc: 0.440 Test Loss: 1.281 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.2271721363067627
Epoch: 2, Steps: 7 | Train Loss: 0.214 Vali Loss: 1.876 Vali Acc: 0.500 Test Loss: 1.876 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.2338588237762451
Epoch: 3, Steps: 7 | Train Loss: 0.060 Vali Loss: 2.268 Vali Acc: 0.520 Test Loss: 2.268 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519977).  Saving model ...
Epoch: 4 cost time: 1.2112603187561035
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.480 Test Loss: 2.530 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2313361167907715
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.480 Test Loss: 2.744 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.238987922668457
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.875 Vali Acc: 0.500 Test Loss: 2.875 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2316429615020752
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.500 Test Loss: 2.945 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.228879451751709
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.500 Test Loss: 2.981 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.267637014389038
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.000 Vali Acc: 0.500 Test Loss: 3.000 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2598984241485596
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.010 Vali Acc: 0.500 Test Loss: 3.010 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3693687915802002
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.015 Vali Acc: 0.500 Test Loss: 3.015 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.335526466369629
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.018 Vali Acc: 0.500 Test Loss: 3.018 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3172085285186768
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.020 Vali Acc: 0.500 Test Loss: 3.020 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2948717
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.774641275405884
Epoch: 1, Steps: 7 | Train Loss: 1.529 Vali Loss: 1.228 Vali Acc: 0.420 Test Loss: 1.228 Test Acc: 0.420
Validation loss decreased (inf --> -0.419988).  Saving model ...
Epoch: 2 cost time: 1.1963169574737549
Epoch: 2, Steps: 7 | Train Loss: 0.217 Vali Loss: 1.661 Vali Acc: 0.580 Test Loss: 1.661 Test Acc: 0.580
Validation loss decreased (-0.419988 --> -0.579983).  Saving model ...
Epoch: 3 cost time: 1.0307855606079102
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.788 Vali Acc: 0.620 Test Loss: 1.788 Test Acc: 0.620
Validation loss decreased (-0.579983 --> -0.619982).  Saving model ...
Epoch: 4 cost time: 1.0482325553894043
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.600 Test Loss: 1.888 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9982142448425293
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.580 Test Loss: 2.030 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.135040044784546
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.560 Test Loss: 2.132 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0420119762420654
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.540 Test Loss: 2.194 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9930756092071533
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.229 Vali Acc: 0.540 Test Loss: 2.229 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1564443111419678
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.540 Test Loss: 2.249 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0728213787078857
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.540 Test Loss: 2.260 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0440425872802734
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.266 Vali Acc: 0.540 Test Loss: 2.266 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.153923511505127
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.269 Vali Acc: 0.540 Test Loss: 2.269 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.09468674659729
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.272 Vali Acc: 0.540 Test Loss: 2.272 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2942573
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1590747833251953
Epoch: 1, Steps: 7 | Train Loss: 1.664 Vali Loss: 1.305 Vali Acc: 0.380 Test Loss: 1.305 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 0.9829363822937012
Epoch: 2, Steps: 7 | Train Loss: 0.167 Vali Loss: 1.671 Vali Acc: 0.520 Test Loss: 1.671 Test Acc: 0.520
Validation loss decreased (-0.379987 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 0.9005367755889893
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.560 Test Loss: 1.835 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559982).  Saving model ...
Epoch: 4 cost time: 0.9678349494934082
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.540 Test Loss: 2.075 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9384801387786865
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.282 Vali Acc: 0.580 Test Loss: 2.282 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579977).  Saving model ...
Epoch: 6 cost time: 0.9144823551177979
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.580 Test Loss: 2.419 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8971641063690186
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.502 Vali Acc: 0.580 Test Loss: 2.502 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.038517713546753
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.580 Test Loss: 2.548 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9619085788726807
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.580 Test Loss: 2.574 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1108667850494385
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.580 Test Loss: 2.587 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9134809970855713
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.594 Vali Acc: 0.580 Test Loss: 2.594 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9129083156585693
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.580 Test Loss: 2.597 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.009303331375122
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.599 Vali Acc: 0.580 Test Loss: 2.599 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9517619609832764
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.599 Vali Acc: 0.580 Test Loss: 2.599 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9596920013427734
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.580 Test Loss: 2.598 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2936429
model size : 11.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.211052656173706
Epoch: 1, Steps: 7 | Train Loss: 1.515 Vali Loss: 1.300 Vali Acc: 0.440 Test Loss: 1.300 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 0.8165078163146973
Epoch: 2, Steps: 7 | Train Loss: 0.154 Vali Loss: 1.637 Vali Acc: 0.480 Test Loss: 1.637 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479984).  Saving model ...
Epoch: 3 cost time: 0.8760473728179932
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.927 Vali Acc: 0.540 Test Loss: 1.927 Test Acc: 0.540
Validation loss decreased (-0.479984 --> -0.539981).  Saving model ...
Epoch: 4 cost time: 0.7991712093353271
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.404 Vali Acc: 0.480 Test Loss: 2.404 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8627040386199951
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.798 Vali Acc: 0.420 Test Loss: 2.798 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7648556232452393
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.019 Vali Acc: 0.400 Test Loss: 3.019 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8304693698883057
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.138 Vali Acc: 0.380 Test Loss: 3.138 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.835566520690918
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.199 Vali Acc: 0.380 Test Loss: 3.199 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8332858085632324
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.230 Vali Acc: 0.380 Test Loss: 3.230 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8681478500366211
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.244 Vali Acc: 0.380 Test Loss: 3.244 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.784966230392456
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.250 Vali Acc: 0.380 Test Loss: 3.250 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8247518539428711
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.252 Vali Acc: 0.380 Test Loss: 3.252 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7549574375152588
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.251 Vali Acc: 0.380 Test Loss: 3.251 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2932333
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.937173366546631
Epoch: 1, Steps: 7 | Train Loss: 1.616 Vali Loss: 1.262 Vali Acc: 0.460 Test Loss: 1.262 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.84877610206604
Epoch: 2, Steps: 7 | Train Loss: 0.146 Vali Loss: 1.603 Vali Acc: 0.560 Test Loss: 1.603 Test Acc: 0.560
Validation loss decreased (-0.459987 --> -0.559984).  Saving model ...
Epoch: 3 cost time: 1.746328592300415
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.294 Vali Acc: 0.600 Test Loss: 2.294 Test Acc: 0.600
Validation loss decreased (-0.559984 --> -0.599977).  Saving model ...
Epoch: 4 cost time: 1.8727014064788818
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.540 Test Loss: 2.465 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8271079063415527
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.616 Vali Acc: 0.540 Test Loss: 2.616 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8987987041473389
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.560 Test Loss: 2.718 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8146483898162842
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.560 Test Loss: 2.781 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7607662677764893
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.817 Vali Acc: 0.560 Test Loss: 2.817 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.111407518386841
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.560 Test Loss: 2.837 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0045125484466553
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.848 Vali Acc: 0.560 Test Loss: 2.848 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.199153184890747
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.560 Test Loss: 2.854 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.123721122741699
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.857 Vali Acc: 0.560 Test Loss: 2.857 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1037511825561523
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.560 Test Loss: 2.858 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 3103727
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.916870355606079
Epoch: 1, Steps: 7 | Train Loss: 1.690 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.7752659320831299
Epoch: 2, Steps: 7 | Train Loss: 0.128 Vali Loss: 1.520 Vali Acc: 0.540 Test Loss: 1.520 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539985).  Saving model ...
Epoch: 3 cost time: 1.8230180740356445
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8506042957305908
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.520 Test Loss: 1.935 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6636111736297607
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.560 Test Loss: 2.587 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559974).  Saving model ...
Epoch: 6 cost time: 1.736295461654663
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.093 Vali Acc: 0.520 Test Loss: 3.093 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.652231216430664
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.394 Vali Acc: 0.520 Test Loss: 3.394 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6377484798431396
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.562 Vali Acc: 0.520 Test Loss: 3.562 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6750133037567139
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.653 Vali Acc: 0.520 Test Loss: 3.653 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7237884998321533
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.700 Vali Acc: 0.520 Test Loss: 3.700 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.761780023574829
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.723 Vali Acc: 0.520 Test Loss: 3.723 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8750922679901123
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.734 Vali Acc: 0.520 Test Loss: 3.734 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7507076263427734
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.737 Vali Acc: 0.520 Test Loss: 3.737 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.757368564605713
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.736 Vali Acc: 0.520 Test Loss: 3.736 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6600837707519531
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.734 Vali Acc: 0.520 Test Loss: 3.734 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3096559
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9713644981384277
Epoch: 1, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.6006050109863281
Epoch: 2, Steps: 7 | Train Loss: 0.145 Vali Loss: 1.951 Vali Acc: 0.540 Test Loss: 1.951 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539980).  Saving model ...
Epoch: 3 cost time: 1.5131852626800537
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.022 Vali Acc: 0.500 Test Loss: 3.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5924291610717773
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.806 Vali Acc: 0.460 Test Loss: 3.806 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5224311351776123
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.315 Vali Acc: 0.440 Test Loss: 4.315 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5623538494110107
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.609 Vali Acc: 0.440 Test Loss: 4.609 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4788925647735596
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.771 Vali Acc: 0.440 Test Loss: 4.771 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5329527854919434
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.851 Vali Acc: 0.440 Test Loss: 4.851 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.633054256439209
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.874 Vali Acc: 0.440 Test Loss: 4.874 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.637882947921753
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.440 Test Loss: 4.882 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6203529834747314
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.440 Test Loss: 4.880 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5953960418701172
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.875 Vali Acc: 0.440 Test Loss: 4.875 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3090415
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.697918176651001
Epoch: 1, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.2386195659637451
Epoch: 2, Steps: 7 | Train Loss: 0.149 Vali Loss: 1.737 Vali Acc: 0.540 Test Loss: 1.737 Test Acc: 0.540
Validation loss decreased (-0.399987 --> -0.539983).  Saving model ...
Epoch: 3 cost time: 1.3297321796417236
Epoch: 3, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.309100866317749
Epoch: 4, Steps: 7 | Train Loss: 0.098 Vali Loss: 2.447 Vali Acc: 0.480 Test Loss: 2.447 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2627947330474854
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.480 Test Loss: 2.473 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3163633346557617
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.688 Vali Acc: 0.500 Test Loss: 2.688 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2463581562042236
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.877 Vali Acc: 0.500 Test Loss: 2.877 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3138213157653809
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.008 Vali Acc: 0.480 Test Loss: 3.008 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3083231449127197
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.086 Vali Acc: 0.480 Test Loss: 3.086 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2495508193969727
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.130 Vali Acc: 0.480 Test Loss: 3.130 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1674811840057373
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.154 Vali Acc: 0.480 Test Loss: 3.154 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2535550594329834
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.480 Test Loss: 3.166 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3083247
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.854508638381958
Epoch: 1, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.355 Vali Acc: 0.440 Test Loss: 1.355 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.0982744693756104
Epoch: 2, Steps: 7 | Train Loss: 0.150 Vali Loss: 2.058 Vali Acc: 0.460 Test Loss: 2.058 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459979).  Saving model ...
Epoch: 3 cost time: 1.1734082698822021
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.797 Vali Acc: 0.480 Test Loss: 2.797 Test Acc: 0.480
Validation loss decreased (-0.459979 --> -0.479972).  Saving model ...
Epoch: 4 cost time: 1.1745357513427734
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.330 Vali Acc: 0.520 Test Loss: 3.330 Test Acc: 0.520
Validation loss decreased (-0.479972 --> -0.519967).  Saving model ...
Epoch: 5 cost time: 1.192150592803955
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.699 Vali Acc: 0.480 Test Loss: 3.699 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.196495771408081
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.925 Vali Acc: 0.480 Test Loss: 3.925 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0728161334991455
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.055 Vali Acc: 0.480 Test Loss: 4.055 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1502106189727783
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.128 Vali Acc: 0.500 Test Loss: 4.128 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0574531555175781
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.168 Vali Acc: 0.500 Test Loss: 4.168 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1249303817749023
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.189 Vali Acc: 0.500 Test Loss: 4.189 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0933663845062256
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.200 Vali Acc: 0.500 Test Loss: 4.200 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0881133079528809
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.205 Vali Acc: 0.500 Test Loss: 4.205 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0184781551361084
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.207 Vali Acc: 0.500 Test Loss: 4.207 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0981462001800537
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.208 Vali Acc: 0.500 Test Loss: 4.208 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3078127
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.118210792541504
Epoch: 1, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.373 Vali Acc: 0.440 Test Loss: 1.373 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 0.931708574295044
Epoch: 2, Steps: 7 | Train Loss: 0.157 Vali Loss: 2.570 Vali Acc: 0.480 Test Loss: 2.570 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479974).  Saving model ...
Epoch: 3 cost time: 1.0129215717315674
Epoch: 3, Steps: 7 | Train Loss: 0.044 Vali Loss: 2.184 Vali Acc: 0.460 Test Loss: 2.184 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0343365669250488
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.500 Test Loss: 2.241 Test Acc: 0.500
Validation loss decreased (-0.479974 --> -0.499978).  Saving model ...
Epoch: 5 cost time: 1.0270671844482422
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.785 Vali Acc: 0.500 Test Loss: 2.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9479691982269287
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.440 Test Loss: 3.339 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9978265762329102
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.707 Vali Acc: 0.480 Test Loss: 3.707 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0390501022338867
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.914 Vali Acc: 0.480 Test Loss: 3.914 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.91005539894104
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.000 Vali Acc: 0.480 Test Loss: 4.000 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0204246044158936
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.010 Vali Acc: 0.480 Test Loss: 4.010 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9726572036743164
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.972 Vali Acc: 0.480 Test Loss: 3.972 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9316415786743164
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.941 Vali Acc: 0.480 Test Loss: 3.941 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0220861434936523
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.917 Vali Acc: 0.480 Test Loss: 3.917 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9583210945129395
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.901 Vali Acc: 0.480 Test Loss: 3.901 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3075055
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.542952537536621
Epoch: 1, Steps: 7 | Train Loss: 1.722 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.0744004249572754
Epoch: 2, Steps: 7 | Train Loss: 0.208 Vali Loss: 1.367 Vali Acc: 0.520 Test Loss: 1.367 Test Acc: 0.520
Validation loss decreased (-0.399987 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 1.0376930236816406
Epoch: 3, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.607 Vali Acc: 0.380 Test Loss: 2.607 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9889519214630127
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.431 Vali Acc: 0.440 Test Loss: 3.431 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.89849853515625
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.809 Vali Acc: 0.420 Test Loss: 3.809 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9693176746368408
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.081 Vali Acc: 0.420 Test Loss: 4.081 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.031968355178833
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.236 Vali Acc: 0.420 Test Loss: 4.236 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.827498197555542
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.319 Vali Acc: 0.420 Test Loss: 4.319 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8779013156890869
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.361 Vali Acc: 0.420 Test Loss: 4.361 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9775629043579102
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.379 Vali Acc: 0.420 Test Loss: 4.379 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.858450174331665
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.383 Vali Acc: 0.420 Test Loss: 4.383 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9373748302459717
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.381 Vali Acc: 0.420 Test Loss: 4.381 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3071983
model size : 11.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3028576374053955
Epoch: 1, Steps: 7 | Train Loss: 1.583 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.7398769855499268
Epoch: 2, Steps: 7 | Train Loss: 0.169 Vali Loss: 2.032 Vali Acc: 0.460 Test Loss: 2.032 Test Acc: 0.460
Validation loss decreased (-0.399987 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 0.7983293533325195
Epoch: 3, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.498 Vali Acc: 0.480 Test Loss: 2.498 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479975).  Saving model ...
Epoch: 4 cost time: 0.7812824249267578
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.580 Test Loss: 2.233 Test Acc: 0.580
Validation loss decreased (-0.479975 --> -0.579978).  Saving model ...
Epoch: 5 cost time: 0.7927107810974121
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.425 Vali Acc: 0.560 Test Loss: 2.425 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8800532817840576
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.540 Test Loss: 2.598 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.754894495010376
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.707 Vali Acc: 0.540 Test Loss: 2.707 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9085791110992432
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.767 Vali Acc: 0.540 Test Loss: 2.767 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0258617401123047
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.793 Vali Acc: 0.540 Test Loss: 2.793 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8282368183135986
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.540 Test Loss: 2.805 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.78611159324646
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.809 Vali Acc: 0.540 Test Loss: 2.809 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7657535076141357
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.809 Vali Acc: 0.540 Test Loss: 2.809 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8135735988616943
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.540 Test Loss: 2.808 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9381670951843262
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.806 Vali Acc: 0.540 Test Loss: 2.806 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3069935
model size : 11.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5202183723449707
Epoch: 1, Steps: 7 | Train Loss: 1.617 Vali Loss: 1.384 Vali Acc: 0.380 Test Loss: 1.384 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.846663475036621
Epoch: 2, Steps: 7 | Train Loss: 0.210 Vali Loss: 1.887 Vali Acc: 0.480 Test Loss: 1.887 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479981).  Saving model ...
Epoch: 3 cost time: 1.9147710800170898
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.608 Vali Acc: 0.520 Test Loss: 2.608 Test Acc: 0.520
Validation loss decreased (-0.479981 --> -0.519974).  Saving model ...
Epoch: 4 cost time: 1.979302167892456
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.462 Vali Acc: 0.440 Test Loss: 3.462 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0153648853302
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.028 Vali Acc: 0.420 Test Loss: 4.028 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9938364028930664
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.329 Vali Acc: 0.420 Test Loss: 4.329 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0266377925872803
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.484 Vali Acc: 0.420 Test Loss: 4.484 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0299599170684814
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.555 Vali Acc: 0.420 Test Loss: 4.555 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.912886381149292
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.582 Vali Acc: 0.420 Test Loss: 4.582 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9487431049346924
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.587 Vali Acc: 0.420 Test Loss: 4.587 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9528405666351318
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.586 Vali Acc: 0.420 Test Loss: 4.586 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.11250638961792
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.580 Vali Acc: 0.420 Test Loss: 4.580 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8402442932128906
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.572 Vali Acc: 0.420 Test Loss: 4.572 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2759279
model size : 10.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.284174680709839
Epoch: 1, Steps: 7 | Train Loss: 1.732 Vali Loss: 1.346 Vali Acc: 0.400 Test Loss: 1.346 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.8325989246368408
Epoch: 2, Steps: 7 | Train Loss: 0.179 Vali Loss: 1.563 Vali Acc: 0.480 Test Loss: 1.563 Test Acc: 0.480
Validation loss decreased (-0.399987 --> -0.479984).  Saving model ...
Epoch: 3 cost time: 1.6953480243682861
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.785 Vali Acc: 0.460 Test Loss: 2.785 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.944141149520874
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.500 Test Loss: 3.057 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499969).  Saving model ...
Epoch: 5 cost time: 1.7613892555236816
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.540 Test Loss: 3.263 Test Acc: 0.540
Validation loss decreased (-0.499969 --> -0.539967).  Saving model ...
Epoch: 6 cost time: 1.9240267276763916
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.401 Vali Acc: 0.540 Test Loss: 3.401 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.089111089706421
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.484 Vali Acc: 0.520 Test Loss: 3.484 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8148763179779053
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.531 Vali Acc: 0.520 Test Loss: 3.531 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0002853870391846
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.556 Vali Acc: 0.520 Test Loss: 3.556 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.854818344116211
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.569 Vali Acc: 0.520 Test Loss: 3.569 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8610641956329346
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.520 Test Loss: 3.574 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9492759704589844
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.520 Test Loss: 3.576 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9469099044799805
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.575 Vali Acc: 0.520 Test Loss: 3.575 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0590901374816895
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.520 Test Loss: 3.574 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0096347332000732
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.573 Vali Acc: 0.520 Test Loss: 3.573 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2752111
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.113631010055542
Epoch: 1, Steps: 7 | Train Loss: 1.610 Vali Loss: 1.354 Vali Acc: 0.360 Test Loss: 1.354 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.6648762226104736
Epoch: 2, Steps: 7 | Train Loss: 0.135 Vali Loss: 1.994 Vali Acc: 0.500 Test Loss: 1.994 Test Acc: 0.500
Validation loss decreased (-0.359986 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 1.4701178073883057
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.757 Vali Acc: 0.460 Test Loss: 2.757 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6082677841186523
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.793 Vali Acc: 0.460 Test Loss: 2.793 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4654970169067383
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.480 Test Loss: 2.888 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6512691974639893
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.962 Vali Acc: 0.460 Test Loss: 2.962 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5277843475341797
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.989 Vali Acc: 0.460 Test Loss: 2.989 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5979282855987549
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.008 Vali Acc: 0.460 Test Loss: 3.008 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6323795318603516
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.019 Vali Acc: 0.460 Test Loss: 3.019 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.606135368347168
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.023 Vali Acc: 0.460 Test Loss: 3.023 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.64512300491333
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.025 Vali Acc: 0.460 Test Loss: 3.025 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7079894542694092
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.460 Test Loss: 3.024 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2745967
model size : 10.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7327041625976562
Epoch: 1, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.309 Vali Acc: 0.440 Test Loss: 1.309 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.3859214782714844
Epoch: 2, Steps: 7 | Train Loss: 0.175 Vali Loss: 1.530 Vali Acc: 0.560 Test Loss: 1.530 Test Acc: 0.560
Validation loss decreased (-0.439987 --> -0.559985).  Saving model ...
Epoch: 3 cost time: 1.2563631534576416
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.540 Test Loss: 2.378 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2689688205718994
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.572 Vali Acc: 0.540 Test Loss: 2.572 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3902595043182373
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.725 Vali Acc: 0.500 Test Loss: 2.725 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2983088493347168
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.826 Vali Acc: 0.500 Test Loss: 2.826 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4273653030395508
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.885 Vali Acc: 0.500 Test Loss: 2.885 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3635406494140625
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.918 Vali Acc: 0.500 Test Loss: 2.918 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3416662216186523
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.500 Test Loss: 2.935 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.233661413192749
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.500 Test Loss: 2.945 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5182864665985107
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.951 Vali Acc: 0.500 Test Loss: 2.951 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3258037567138672
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.954 Vali Acc: 0.500 Test Loss: 2.954 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2738799
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.718597173690796
Epoch: 1, Steps: 7 | Train Loss: 1.631 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.213498830795288
Epoch: 2, Steps: 7 | Train Loss: 0.123 Vali Loss: 1.795 Vali Acc: 0.480 Test Loss: 1.795 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2094552516937256
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.255 Vali Acc: 0.580 Test Loss: 2.255 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579977).  Saving model ...
Epoch: 4 cost time: 1.1747760772705078
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.734 Vali Acc: 0.600 Test Loss: 2.734 Test Acc: 0.600
Validation loss decreased (-0.579977 --> -0.599973).  Saving model ...
Epoch: 5 cost time: 1.1645464897155762
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.102 Vali Acc: 0.600 Test Loss: 3.102 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0934805870056152
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.330 Vali Acc: 0.600 Test Loss: 3.330 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.113616943359375
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.455 Vali Acc: 0.580 Test Loss: 3.455 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1036720275878906
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.522 Vali Acc: 0.580 Test Loss: 3.522 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.091278076171875
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.555 Vali Acc: 0.560 Test Loss: 3.555 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1544568538665771
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.570 Vali Acc: 0.560 Test Loss: 3.570 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.126387119293213
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.560 Test Loss: 3.576 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1903207302093506
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.560 Test Loss: 3.576 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2220425605773926
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.560 Test Loss: 3.574 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2693779468536377
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.570 Vali Acc: 0.560 Test Loss: 3.570 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2733679
model size : 10.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3325960636138916
Epoch: 1, Steps: 7 | Train Loss: 1.734 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 0.9752011299133301
Epoch: 2, Steps: 7 | Train Loss: 0.232 Vali Loss: 2.109 Vali Acc: 0.560 Test Loss: 2.109 Test Acc: 0.560
Validation loss decreased (-0.479988 --> -0.559979).  Saving model ...
Epoch: 3 cost time: 1.0141713619232178
Epoch: 3, Steps: 7 | Train Loss: 0.057 Vali Loss: 2.308 Vali Acc: 0.540 Test Loss: 2.308 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.011734962463379
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.708 Vali Acc: 0.480 Test Loss: 2.708 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9819653034210205
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.751 Vali Acc: 0.440 Test Loss: 3.751 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.042454719543457
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.161 Vali Acc: 0.540 Test Loss: 3.161 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.072335958480835
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.668 Vali Acc: 0.540 Test Loss: 2.668 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.03287935256958
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.540 Test Loss: 2.462 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0216147899627686
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.540 Test Loss: 2.370 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9643459320068359
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.540 Test Loss: 2.328 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0451545715332031
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.308 Vali Acc: 0.540 Test Loss: 2.308 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1224322319030762
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.540 Test Loss: 2.298 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2730607
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.025649309158325
Epoch: 1, Steps: 7 | Train Loss: 1.679 Vali Loss: 1.249 Vali Acc: 0.460 Test Loss: 1.249 Test Acc: 0.460
Validation loss decreased (inf --> -0.459988).  Saving model ...
Epoch: 2 cost time: 0.8078906536102295
Epoch: 2, Steps: 7 | Train Loss: 0.166 Vali Loss: 1.902 Vali Acc: 0.540 Test Loss: 1.902 Test Acc: 0.540
Validation loss decreased (-0.459988 --> -0.539981).  Saving model ...
Epoch: 3 cost time: 0.9974527359008789
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.193 Vali Acc: 0.460 Test Loss: 2.193 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7957208156585693
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.423 Vali Acc: 0.460 Test Loss: 2.423 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.960038423538208
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.540 Test Loss: 2.685 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.896245002746582
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.876 Vali Acc: 0.560 Test Loss: 2.876 Test Acc: 0.560
Validation loss decreased (-0.539981 --> -0.559971).  Saving model ...
Epoch: 7 cost time: 0.8634552955627441
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.994 Vali Acc: 0.540 Test Loss: 2.994 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8000376224517822
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.059 Vali Acc: 0.540 Test Loss: 3.059 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8882565498352051
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.094 Vali Acc: 0.540 Test Loss: 3.094 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1480841636657715
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.111 Vali Acc: 0.540 Test Loss: 3.111 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8907103538513184
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.119 Vali Acc: 0.540 Test Loss: 3.119 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9003391265869141
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.120 Vali Acc: 0.540 Test Loss: 3.120 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8683459758758545
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.119 Vali Acc: 0.540 Test Loss: 3.119 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7884206771850586
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.117 Vali Acc: 0.540 Test Loss: 3.117 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9180455207824707
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.113 Vali Acc: 0.540 Test Loss: 3.113 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9928171634674072
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.110 Vali Acc: 0.540 Test Loss: 3.110 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2727535
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2026076316833496
Epoch: 1, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.323 Vali Acc: 0.380 Test Loss: 1.323 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 0.9522974491119385
Epoch: 2, Steps: 7 | Train Loss: 0.137 Vali Loss: 1.838 Vali Acc: 0.460 Test Loss: 1.838 Test Acc: 0.460
Validation loss decreased (-0.379987 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 0.986546516418457
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.449 Vali Acc: 0.460 Test Loss: 2.449 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8946044445037842
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.941 Vali Acc: 0.460 Test Loss: 2.941 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8509714603424072
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.244 Vali Acc: 0.480 Test Loss: 3.244 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479968).  Saving model ...
Epoch: 6 cost time: 0.8956551551818848
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.401 Vali Acc: 0.480 Test Loss: 3.401 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0055265426635742
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.494 Vali Acc: 0.500 Test Loss: 3.494 Test Acc: 0.500
Validation loss decreased (-0.479968 --> -0.499965).  Saving model ...
Epoch: 8 cost time: 0.8240211009979248
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.545 Vali Acc: 0.520 Test Loss: 3.545 Test Acc: 0.520
Validation loss decreased (-0.499965 --> -0.519965).  Saving model ...
Epoch: 9 cost time: 0.9371566772460938
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.520 Test Loss: 3.574 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7996220588684082
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.589 Vali Acc: 0.520 Test Loss: 3.589 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8464937210083008
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.520 Test Loss: 3.597 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9038233757019043
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.520 Test Loss: 3.601 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8516519069671631
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.603 Vali Acc: 0.520 Test Loss: 3.603 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7787959575653076
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8774354457855225
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8852496147155762
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9890165328979492
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8329801559448242
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2725487
model size : 10.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.441361665725708
Epoch: 1, Steps: 7 | Train Loss: 1.751 Vali Loss: 1.371 Vali Acc: 0.340 Test Loss: 1.371 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 1.7947700023651123
Epoch: 2, Steps: 7 | Train Loss: 0.185 Vali Loss: 1.606 Vali Acc: 0.480 Test Loss: 1.606 Test Acc: 0.480
Validation loss decreased (-0.339986 --> -0.479984).  Saving model ...
Epoch: 3 cost time: 1.9015278816223145
Epoch: 3, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.309 Vali Acc: 0.480 Test Loss: 2.309 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8317124843597412
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.072 Vali Acc: 0.500 Test Loss: 4.072 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499959).  Saving model ...
Epoch: 5 cost time: 2.1568641662597656
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.334 Vali Acc: 0.480 Test Loss: 3.334 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9401373863220215
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.580 Test Loss: 2.598 Test Acc: 0.580
Validation loss decreased (-0.499959 --> -0.579974).  Saving model ...
Epoch: 7 cost time: 1.9629075527191162
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.777 Vali Acc: 0.560 Test Loss: 2.777 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9167509078979492
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.702 Vali Acc: 0.540 Test Loss: 2.702 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8892667293548584
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.324 Vali Acc: 0.500 Test Loss: 6.324 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.829374074935913
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.817 Vali Acc: 0.520 Test Loss: 3.817 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9103984832763672
Epoch: 11, Steps: 7 | Train Loss: 0.117 Vali Loss: 3.107 Vali Acc: 0.560 Test Loss: 3.107 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.821671962738037
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.151 Vali Acc: 0.520 Test Loss: 4.151 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.875274419784546
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.742 Vali Acc: 0.460 Test Loss: 6.742 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9753098487854004
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.315 Vali Acc: 0.480 Test Loss: 5.315 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.908440351486206
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.951 Vali Acc: 0.440 Test Loss: 4.951 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.838878870010376
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.887 Vali Acc: 0.460 Test Loss: 4.887 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2587055
model size : 9.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.976868152618408
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.8186969757080078
Epoch: 2, Steps: 7 | Train Loss: 0.240 Vali Loss: 1.564 Vali Acc: 0.440 Test Loss: 1.564 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439984).  Saving model ...
Epoch: 3 cost time: 1.6683573722839355
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.070 Vali Acc: 0.400 Test Loss: 2.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7325570583343506
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.109 Vali Acc: 0.460 Test Loss: 2.109 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459979).  Saving model ...
Epoch: 5 cost time: 1.5899794101715088
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.520 Test Loss: 2.342 Test Acc: 0.520
Validation loss decreased (-0.459979 --> -0.519977).  Saving model ...
Epoch: 6 cost time: 1.5667617321014404
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.564 Vali Acc: 0.520 Test Loss: 2.564 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.684722900390625
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.560 Test Loss: 2.708 Test Acc: 0.560
Validation loss decreased (-0.519977 --> -0.559973).  Saving model ...
Epoch: 8 cost time: 1.6167209148406982
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.792 Vali Acc: 0.560 Test Loss: 2.792 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.646660566329956
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.560 Test Loss: 2.839 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7088444232940674
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.864 Vali Acc: 0.560 Test Loss: 2.864 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6579139232635498
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.876 Vali Acc: 0.560 Test Loss: 2.876 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.685966968536377
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.882 Vali Acc: 0.560 Test Loss: 2.882 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6236059665679932
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.884 Vali Acc: 0.560 Test Loss: 2.884 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5798439979553223
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.885 Vali Acc: 0.560 Test Loss: 2.885 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6813223361968994
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.885 Vali Acc: 0.560 Test Loss: 2.885 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6390116214752197
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.884 Vali Acc: 0.560 Test Loss: 2.884 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6560022830963135
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.884 Vali Acc: 0.560 Test Loss: 2.884 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2579887
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9305641651153564
Epoch: 1, Steps: 7 | Train Loss: 1.536 Vali Loss: 1.380 Vali Acc: 0.380 Test Loss: 1.380 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.54052734375
Epoch: 2, Steps: 7 | Train Loss: 0.177 Vali Loss: 2.146 Vali Acc: 0.440 Test Loss: 2.146 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439979).  Saving model ...
Epoch: 3 cost time: 1.522336483001709
Epoch: 3, Steps: 7 | Train Loss: 0.038 Vali Loss: 2.861 Vali Acc: 0.460 Test Loss: 2.861 Test Acc: 0.460
Validation loss decreased (-0.439979 --> -0.459971).  Saving model ...
Epoch: 4 cost time: 1.472468376159668
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.989 Vali Acc: 0.540 Test Loss: 2.989 Test Acc: 0.540
Validation loss decreased (-0.459971 --> -0.539970).  Saving model ...
Epoch: 5 cost time: 1.475550889968872
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.204 Vali Acc: 0.560 Test Loss: 3.204 Test Acc: 0.560
Validation loss decreased (-0.539970 --> -0.559968).  Saving model ...
Epoch: 6 cost time: 1.446556806564331
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.354 Vali Acc: 0.560 Test Loss: 3.354 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4001407623291016
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.443 Vali Acc: 0.560 Test Loss: 3.443 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.466667890548706
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.560 Test Loss: 3.493 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4976651668548584
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.521 Vali Acc: 0.560 Test Loss: 3.521 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.550062656402588
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.536 Vali Acc: 0.560 Test Loss: 3.536 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4874143600463867
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.544 Vali Acc: 0.560 Test Loss: 3.544 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4062085151672363
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.549 Vali Acc: 0.560 Test Loss: 3.549 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4385724067687988
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.552 Vali Acc: 0.560 Test Loss: 3.552 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4763200283050537
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.554 Vali Acc: 0.560 Test Loss: 3.554 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5658507347106934
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.555 Vali Acc: 0.560 Test Loss: 3.555 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2573743
model size : 9.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.701874256134033
Epoch: 1, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.425 Vali Acc: 0.420 Test Loss: 1.425 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 1.37361741065979
Epoch: 2, Steps: 7 | Train Loss: 0.189 Vali Loss: 2.368 Vali Acc: 0.360 Test Loss: 2.368 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4915125370025635
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.156 Vali Acc: 0.420 Test Loss: 3.156 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.388272762298584
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.480 Test Loss: 3.493 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479965).  Saving model ...
Epoch: 5 cost time: 1.2894246578216553
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.689 Vali Acc: 0.480 Test Loss: 3.689 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.339625597000122
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.818 Vali Acc: 0.480 Test Loss: 3.818 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4230570793151855
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.895 Vali Acc: 0.480 Test Loss: 3.895 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3087801933288574
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.938 Vali Acc: 0.480 Test Loss: 3.938 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.306281566619873
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.962 Vali Acc: 0.480 Test Loss: 3.962 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2859923839569092
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.975 Vali Acc: 0.480 Test Loss: 3.975 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.459502935409546
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.982 Vali Acc: 0.480 Test Loss: 3.982 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4543209075927734
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.985 Vali Acc: 0.480 Test Loss: 3.985 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4331696033477783
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.987 Vali Acc: 0.480 Test Loss: 3.987 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4272429943084717
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.987 Vali Acc: 0.480 Test Loss: 3.987 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2566575
model size : 9.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4877617359161377
Epoch: 1, Steps: 7 | Train Loss: 1.633 Vali Loss: 1.313 Vali Acc: 0.440 Test Loss: 1.313 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.1522419452667236
Epoch: 2, Steps: 7 | Train Loss: 0.196 Vali Loss: 1.706 Vali Acc: 0.580 Test Loss: 1.706 Test Acc: 0.580
Validation loss decreased (-0.439987 --> -0.579983).  Saving model ...
Epoch: 3 cost time: 1.1397299766540527
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.628 Vali Acc: 0.540 Test Loss: 2.628 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1334025859832764
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.737 Vali Acc: 0.460 Test Loss: 3.737 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.229189157485962
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.460 Test Loss: 4.121 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1797716617584229
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.289 Vali Acc: 0.440 Test Loss: 4.289 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1941139698028564
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.371 Vali Acc: 0.420 Test Loss: 4.371 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1518216133117676
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.411 Vali Acc: 0.420 Test Loss: 4.411 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.092390775680542
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.428 Vali Acc: 0.420 Test Loss: 4.428 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1524245738983154
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.434 Vali Acc: 0.440 Test Loss: 4.434 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.191709041595459
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.432 Vali Acc: 0.440 Test Loss: 4.432 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1677420139312744
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.428 Vali Acc: 0.440 Test Loss: 4.428 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2561455
model size : 9.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6664493083953857
Epoch: 1, Steps: 7 | Train Loss: 1.669 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.001305103302002
Epoch: 2, Steps: 7 | Train Loss: 0.175 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.1044859886169434
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.282 Vali Acc: 0.500 Test Loss: 2.282 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1690282821655273
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.433 Vali Acc: 0.560 Test Loss: 2.433 Test Acc: 0.560
Validation loss decreased (-0.499984 --> -0.559976).  Saving model ...
Epoch: 5 cost time: 1.069328784942627
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.039 Vali Acc: 0.540 Test Loss: 3.039 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1199944019317627
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.020 Vali Acc: 0.460 Test Loss: 4.020 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9282135963439941
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.116 Vali Acc: 0.540 Test Loss: 3.116 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0773966312408447
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.571 Vali Acc: 0.480 Test Loss: 3.571 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9310424327850342
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.145 Vali Acc: 0.500 Test Loss: 4.145 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9847357273101807
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.228 Vali Acc: 0.540 Test Loss: 4.228 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9767501354217529
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.025 Vali Acc: 0.540 Test Loss: 4.025 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1558780670166016
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.875 Vali Acc: 0.540 Test Loss: 3.875 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0095810890197754
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.785 Vali Acc: 0.540 Test Loss: 3.785 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0352740287780762
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.736 Vali Acc: 0.540 Test Loss: 3.736 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2558383
model size : 9.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.207524299621582
Epoch: 1, Steps: 7 | Train Loss: 1.558 Vali Loss: 1.158 Vali Acc: 0.540 Test Loss: 1.158 Test Acc: 0.540
Validation loss decreased (inf --> -0.539988).  Saving model ...
Epoch: 2 cost time: 0.8501992225646973
Epoch: 2, Steps: 7 | Train Loss: 0.196 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.958855152130127
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.480 Test Loss: 1.846 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9121742248535156
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.480 Test Loss: 2.463 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8368325233459473
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.683 Vali Acc: 0.460 Test Loss: 2.683 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8228838443756104
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.738 Vali Acc: 0.520 Test Loss: 2.738 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8478527069091797
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.797 Vali Acc: 0.520 Test Loss: 2.797 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.867729663848877
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.520 Test Loss: 2.836 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8519046306610107
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.520 Test Loss: 2.858 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.90553879737854
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.520 Test Loss: 2.869 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8875911235809326
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.875 Vali Acc: 0.520 Test Loss: 2.875 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2555311
model size : 9.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.470036029815674
Epoch: 1, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.490 Vali Acc: 0.400 Test Loss: 1.490 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.8121218681335449
Epoch: 2, Steps: 7 | Train Loss: 0.291 Vali Loss: 1.844 Vali Acc: 0.480 Test Loss: 1.844 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479982).  Saving model ...
Epoch: 3 cost time: 0.928471565246582
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.636 Vali Acc: 0.580 Test Loss: 1.636 Test Acc: 0.580
Validation loss decreased (-0.479982 --> -0.579984).  Saving model ...
Epoch: 4 cost time: 0.8781123161315918
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.096 Vali Acc: 0.660 Test Loss: 2.096 Test Acc: 0.660
Validation loss decreased (-0.579984 --> -0.659979).  Saving model ...
Epoch: 5 cost time: 0.9676623344421387
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.660 Test Loss: 2.557 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.935368537902832
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.790 Vali Acc: 0.660 Test Loss: 2.790 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7919063568115234
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.660 Test Loss: 2.844 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7745511531829834
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.873 Vali Acc: 0.660 Test Loss: 2.873 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.943673849105835
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.887 Vali Acc: 0.640 Test Loss: 2.887 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2025485038757324
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.894 Vali Acc: 0.640 Test Loss: 2.894 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8857588768005371
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.640 Test Loss: 2.895 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8677699565887451
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.640 Test Loss: 2.895 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9871294498443604
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.640 Test Loss: 2.893 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9199872016906738
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.887 Vali Acc: 0.640 Test Loss: 2.887 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2553263
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3236939907073975
Epoch: 1, Steps: 7 | Train Loss: 1.733 Vali Loss: 1.417 Vali Acc: 0.360 Test Loss: 1.417 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.999363660812378
Epoch: 2, Steps: 7 | Train Loss: 0.358 Vali Loss: 2.159 Vali Acc: 0.480 Test Loss: 2.159 Test Acc: 0.480
Validation loss decreased (-0.359986 --> -0.479978).  Saving model ...
Epoch: 3 cost time: 1.9003283977508545
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
Validation loss decreased (-0.479978 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 1.9852383136749268
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.769 Vali Acc: 0.500 Test Loss: 2.769 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.792842149734497
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.500 Test Loss: 3.044 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.904900074005127
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.224 Vali Acc: 0.500 Test Loss: 3.224 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2257790565490723
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.330 Vali Acc: 0.500 Test Loss: 3.330 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.005525827407837
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.389 Vali Acc: 0.500 Test Loss: 3.389 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9553499221801758
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.420 Vali Acc: 0.480 Test Loss: 3.420 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9152052402496338
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.435 Vali Acc: 0.480 Test Loss: 3.435 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.064655303955078
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.441 Vali Acc: 0.480 Test Loss: 3.441 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.025624990463257
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.480 Test Loss: 3.438 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9722564220428467
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.435 Vali Acc: 0.480 Test Loss: 3.435 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2500943
model size : 9.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0031964778900146
Epoch: 1, Steps: 7 | Train Loss: 1.563 Vali Loss: 1.576 Vali Acc: 0.380 Test Loss: 1.576 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.699298620223999
Epoch: 2, Steps: 7 | Train Loss: 0.265 Vali Loss: 1.688 Vali Acc: 0.460 Test Loss: 1.688 Test Acc: 0.460
Validation loss decreased (-0.379984 --> -0.459983).  Saving model ...
Epoch: 3 cost time: 1.6797611713409424
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.834 Vali Acc: 0.580 Test Loss: 1.834 Test Acc: 0.580
Validation loss decreased (-0.459983 --> -0.579982).  Saving model ...
Epoch: 4 cost time: 1.743138074874878
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.580 Test Loss: 2.131 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.700479507446289
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.520 Test Loss: 2.345 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7234833240509033
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.480 Test Loss: 2.475 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7788476943969727
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.480 Test Loss: 2.552 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5854544639587402
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.594 Vali Acc: 0.480 Test Loss: 2.594 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.628610372543335
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.617 Vali Acc: 0.480 Test Loss: 2.617 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.674644947052002
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.630 Vali Acc: 0.480 Test Loss: 2.630 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6738002300262451
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.636 Vali Acc: 0.480 Test Loss: 2.636 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6169219017028809
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.480 Test Loss: 2.639 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6260192394256592
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.480 Test Loss: 2.641 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2493775
model size : 9.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9166572093963623
Epoch: 1, Steps: 7 | Train Loss: 1.722 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.4680192470550537
Epoch: 2, Steps: 7 | Train Loss: 0.226 Vali Loss: 1.945 Vali Acc: 0.440 Test Loss: 1.945 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439981).  Saving model ...
Epoch: 3 cost time: 1.5069637298583984
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.997 Vali Acc: 0.480 Test Loss: 1.997 Test Acc: 0.480
Validation loss decreased (-0.439981 --> -0.479980).  Saving model ...
Epoch: 4 cost time: 1.6061389446258545
Epoch: 4, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.750 Vali Acc: 0.480 Test Loss: 2.750 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.635951042175293
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.767 Vali Acc: 0.480 Test Loss: 3.767 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4011094570159912
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.308 Vali Acc: 0.440 Test Loss: 4.308 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4645724296569824
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.261 Vali Acc: 0.440 Test Loss: 4.261 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4288694858551025
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.087 Vali Acc: 0.440 Test Loss: 4.087 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.500598669052124
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.010 Vali Acc: 0.440 Test Loss: 4.010 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4900290966033936
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.973 Vali Acc: 0.440 Test Loss: 3.973 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.632535457611084
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.953 Vali Acc: 0.440 Test Loss: 3.953 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.500136375427246
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.942 Vali Acc: 0.460 Test Loss: 3.942 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8050956726074219
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.934 Vali Acc: 0.460 Test Loss: 3.934 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2487631
model size : 9.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3709733486175537
Epoch: 1, Steps: 7 | Train Loss: 1.570 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.1495773792266846
Epoch: 2, Steps: 7 | Train Loss: 0.204 Vali Loss: 1.734 Vali Acc: 0.520 Test Loss: 1.734 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 1.4245824813842773
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.819 Vali Acc: 0.540 Test Loss: 1.819 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 1.3020823001861572
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.070 Vali Acc: 0.560 Test Loss: 2.070 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559979).  Saving model ...
Epoch: 5 cost time: 1.2687113285064697
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.580 Test Loss: 2.271 Test Acc: 0.580
Validation loss decreased (-0.559979 --> -0.579977).  Saving model ...
Epoch: 6 cost time: 1.2766146659851074
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.435 Vali Acc: 0.560 Test Loss: 2.435 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.235564947128296
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.560 Test Loss: 2.540 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.232193946838379
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.560 Test Loss: 2.601 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2557945251464844
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.633 Vali Acc: 0.560 Test Loss: 2.633 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3318543434143066
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.560 Test Loss: 2.650 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.351386547088623
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.560 Test Loss: 2.658 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2819077968597412
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.660 Vali Acc: 0.560 Test Loss: 2.660 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3221385478973389
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.560 Test Loss: 2.661 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.321410894393921
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.659 Vali Acc: 0.560 Test Loss: 2.659 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2771029472351074
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.657 Vali Acc: 0.560 Test Loss: 2.657 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2480463
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4686391353607178
Epoch: 1, Steps: 7 | Train Loss: 1.632 Vali Loss: 1.413 Vali Acc: 0.380 Test Loss: 1.413 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.1276631355285645
Epoch: 2, Steps: 7 | Train Loss: 0.233 Vali Loss: 1.806 Vali Acc: 0.500 Test Loss: 1.806 Test Acc: 0.500
Validation loss decreased (-0.379986 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.1437582969665527
Epoch: 3, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.195 Vali Acc: 0.500 Test Loss: 2.195 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1340932846069336
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.500 Test Loss: 3.243 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2165145874023438
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.755 Vali Acc: 0.460 Test Loss: 3.755 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2464048862457275
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.976 Vali Acc: 0.440 Test Loss: 3.976 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1668362617492676
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.059 Vali Acc: 0.460 Test Loss: 4.059 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1526412963867188
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.076 Vali Acc: 0.460 Test Loss: 4.076 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.217909812927246
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.067 Vali Acc: 0.480 Test Loss: 4.067 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2100000381469727
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.046 Vali Acc: 0.500 Test Loss: 4.046 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3509082794189453
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.025 Vali Acc: 0.500 Test Loss: 4.025 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.154524803161621
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.500 Test Loss: 4.006 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2475343
model size : 9.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0183346271514893
Epoch: 1, Steps: 7 | Train Loss: 1.661 Vali Loss: 1.558 Vali Acc: 0.340 Test Loss: 1.558 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.048048973083496
Epoch: 2, Steps: 7 | Train Loss: 0.421 Vali Loss: 2.101 Vali Acc: 0.500 Test Loss: 2.101 Test Acc: 0.500
Validation loss decreased (-0.339984 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 1.1594009399414062
Epoch: 3, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.029 Vali Acc: 0.480 Test Loss: 2.029 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1311638355255127
Epoch: 4, Steps: 7 | Train Loss: 0.090 Vali Loss: 1.877 Vali Acc: 0.500 Test Loss: 1.877 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 1.1651802062988281
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.920 Vali Acc: 0.460 Test Loss: 2.920 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1573371887207031
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.667 Vali Acc: 0.500 Test Loss: 3.667 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0714683532714844
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.773 Vali Acc: 0.500 Test Loss: 3.773 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.106966257095337
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.825 Vali Acc: 0.500 Test Loss: 3.825 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.198211431503296
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.850 Vali Acc: 0.500 Test Loss: 3.850 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.10066819190979
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.500 Test Loss: 3.858 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1476988792419434
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.856 Vali Acc: 0.500 Test Loss: 3.856 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1367228031158447
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.847 Vali Acc: 0.500 Test Loss: 3.847 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0001652240753174
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.839 Vali Acc: 0.500 Test Loss: 3.839 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.009852647781372
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.500 Test Loss: 3.832 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2472271
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.345329761505127
Epoch: 1, Steps: 7 | Train Loss: 1.612 Vali Loss: 1.413 Vali Acc: 0.420 Test Loss: 1.413 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 0.9024808406829834
Epoch: 2, Steps: 7 | Train Loss: 0.217 Vali Loss: 1.733 Vali Acc: 0.440 Test Loss: 1.733 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439983).  Saving model ...
Epoch: 3 cost time: 1.0597600936889648
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.152 Vali Acc: 0.480 Test Loss: 2.152 Test Acc: 0.480
Validation loss decreased (-0.439983 --> -0.479978).  Saving model ...
Epoch: 4 cost time: 0.9290294647216797
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.173 Vali Acc: 0.520 Test Loss: 3.173 Test Acc: 0.520
Validation loss decreased (-0.479978 --> -0.519968).  Saving model ...
Epoch: 5 cost time: 0.8722355365753174
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.943 Vali Acc: 0.520 Test Loss: 3.943 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.011204481124878
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.369 Vali Acc: 0.520 Test Loss: 4.369 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9563276767730713
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.578 Vali Acc: 0.520 Test Loss: 4.578 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8792266845703125
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.678 Vali Acc: 0.520 Test Loss: 4.678 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9137444496154785
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.716 Vali Acc: 0.520 Test Loss: 4.716 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0173273086547852
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.725 Vali Acc: 0.520 Test Loss: 4.725 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.015918493270874
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.705 Vali Acc: 0.520 Test Loss: 4.705 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9845924377441406
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.688 Vali Acc: 0.520 Test Loss: 4.688 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9392690658569336
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.673 Vali Acc: 0.520 Test Loss: 4.673 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0092089176177979
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.662 Vali Acc: 0.520 Test Loss: 4.662 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2469199
model size : 9.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.268944501876831
Epoch: 1, Steps: 7 | Train Loss: 1.743 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 0.8127074241638184
Epoch: 2, Steps: 7 | Train Loss: 0.190 Vali Loss: 1.966 Vali Acc: 0.460 Test Loss: 1.966 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.93642258644104
Epoch: 3, Steps: 7 | Train Loss: 0.303 Vali Loss: 2.393 Vali Acc: 0.400 Test Loss: 2.393 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8989753723144531
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.292 Vali Acc: 0.380 Test Loss: 5.292 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7327365875244141
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.100 Vali Acc: 0.400 Test Loss: 4.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9356644153594971
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.540 Test Loss: 3.166 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539968).  Saving model ...
Epoch: 7 cost time: 0.7782363891601562
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.340 Vali Acc: 0.440 Test Loss: 3.340 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8197553157806396
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.462 Vali Acc: 0.440 Test Loss: 3.462 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8635501861572266
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.519 Vali Acc: 0.440 Test Loss: 3.519 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8551545143127441
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.543 Vali Acc: 0.460 Test Loss: 3.543 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8278892040252686
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.549 Vali Acc: 0.460 Test Loss: 3.549 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.914928674697876
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.546 Vali Acc: 0.460 Test Loss: 3.546 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.904832124710083
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.540 Vali Acc: 0.460 Test Loss: 3.540 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7415971755981445
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.531 Vali Acc: 0.460 Test Loss: 3.531 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7735605239868164
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.522 Vali Acc: 0.440 Test Loss: 3.522 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8098726272583008
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.514 Vali Acc: 0.440 Test Loss: 3.514 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2467151
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3702878952026367
Epoch: 1, Steps: 7 | Train Loss: 1.540 Vali Loss: 1.332 Vali Acc: 0.420 Test Loss: 1.332 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.940474271774292
Epoch: 2, Steps: 7 | Train Loss: 0.373 Vali Loss: 1.523 Vali Acc: 0.480 Test Loss: 1.523 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479985).  Saving model ...
Epoch: 3 cost time: 1.8430299758911133
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.565 Vali Acc: 0.480 Test Loss: 2.565 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.903702735900879
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.596 Vali Acc: 0.480 Test Loss: 2.596 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9953269958496094
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.699 Vali Acc: 0.440 Test Loss: 2.699 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9251329898834229
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.867 Vali Acc: 0.480 Test Loss: 2.867 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8333072662353516
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.991 Vali Acc: 0.480 Test Loss: 2.991 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9533846378326416
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.082 Vali Acc: 0.480 Test Loss: 3.082 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.927748441696167
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.480 Test Loss: 3.136 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.002591133117676
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.480 Test Loss: 3.166 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8582170009613037
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.180 Vali Acc: 0.480 Test Loss: 3.180 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0351240634918213
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.182 Vali Acc: 0.480 Test Loss: 3.182 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2457887
model size : 9.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2948176860809326
Epoch: 1, Steps: 7 | Train Loss: 1.712 Vali Loss: 1.616 Vali Acc: 0.320 Test Loss: 1.616 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.7180099487304688
Epoch: 2, Steps: 7 | Train Loss: 0.500 Vali Loss: 2.125 Vali Acc: 0.440 Test Loss: 2.125 Test Acc: 0.440
Validation loss decreased (-0.319984 --> -0.439979).  Saving model ...
Epoch: 3 cost time: 1.6685400009155273
Epoch: 3, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.864 Vali Acc: 0.480 Test Loss: 1.864 Test Acc: 0.480
Validation loss decreased (-0.439979 --> -0.479981).  Saving model ...
Epoch: 4 cost time: 1.7842991352081299
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.123 Vali Acc: 0.520 Test Loss: 3.123 Test Acc: 0.520
Validation loss decreased (-0.479981 --> -0.519969).  Saving model ...
Epoch: 5 cost time: 1.7229557037353516
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.117 Vali Acc: 0.520 Test Loss: 3.117 Test Acc: 0.520
Validation loss decreased (-0.519969 --> -0.519969).  Saving model ...
Epoch: 6 cost time: 1.7734260559082031
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 2.763 Vali Acc: 0.540 Test Loss: 2.763 Test Acc: 0.540
Validation loss decreased (-0.519969 --> -0.539972).  Saving model ...
Epoch: 7 cost time: 1.67055344581604
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.535 Vali Acc: 0.520 Test Loss: 3.535 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.753502368927002
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 3.289 Vali Acc: 0.480 Test Loss: 3.289 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7941441535949707
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.713 Vali Acc: 0.540 Test Loss: 2.713 Test Acc: 0.540
Validation loss decreased (-0.539972 --> -0.539973).  Saving model ...
Epoch: 10 cost time: 1.7338006496429443
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.834 Vali Acc: 0.520 Test Loss: 3.834 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.687535285949707
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.596 Vali Acc: 0.500 Test Loss: 4.596 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.059030532836914
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.725 Vali Acc: 0.380 Test Loss: 5.725 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.72218918800354
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.179 Vali Acc: 0.440 Test Loss: 5.179 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7421317100524902
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.520 Test Loss: 5.906 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.844789743423462
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.642 Vali Acc: 0.440 Test Loss: 7.642 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.831458330154419
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.561 Vali Acc: 0.580 Test Loss: 4.561 Test Acc: 0.580
Validation loss decreased (-0.539973 --> -0.579954).  Saving model ...
Epoch: 17 cost time: 1.8572442531585693
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.406 Vali Acc: 0.420 Test Loss: 5.406 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.758998155593872
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 7.282 Vali Acc: 0.440 Test Loss: 7.282 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8320529460906982
Epoch: 19, Steps: 7 | Train Loss: 0.206 Vali Loss: 5.096 Vali Acc: 0.560 Test Loss: 5.096 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.710191249847412
Epoch: 20, Steps: 7 | Train Loss: 0.038 Vali Loss: 7.190 Vali Acc: 0.540 Test Loss: 7.190 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8236000537872314
Epoch: 21, Steps: 7 | Train Loss: 0.117 Vali Loss: 7.053 Vali Acc: 0.380 Test Loss: 7.053 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8054718971252441
Epoch: 22, Steps: 7 | Train Loss: 0.263 Vali Loss: 6.257 Vali Acc: 0.500 Test Loss: 6.257 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.681905746459961
Epoch: 23, Steps: 7 | Train Loss: 1.006 Vali Loss: 5.923 Vali Acc: 0.540 Test Loss: 5.923 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6074106693267822
Epoch: 24, Steps: 7 | Train Loss: 0.226 Vali Loss: 7.174 Vali Acc: 0.540 Test Loss: 7.174 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.687086582183838
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.174 Vali Acc: 0.620 Test Loss: 7.174 Test Acc: 0.620
Validation loss decreased (-0.579954 --> -0.619928).  Saving model ...
Epoch: 26 cost time: 1.8919687271118164
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.014 Vali Acc: 0.540 Test Loss: 8.014 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6558153629302979
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 11.453 Vali Acc: 0.520 Test Loss: 11.453 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.703587532043457
Epoch: 28, Steps: 7 | Train Loss: 0.313 Vali Loss: 11.676 Vali Acc: 0.500 Test Loss: 11.676 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7865369319915771
Epoch: 29, Steps: 7 | Train Loss: 0.030 Vali Loss: 14.490 Vali Acc: 0.520 Test Loss: 14.490 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6034460067749023
Epoch: 30, Steps: 7 | Train Loss: 0.021 Vali Loss: 12.344 Vali Acc: 0.480 Test Loss: 12.344 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7284634113311768
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.516 Vali Acc: 0.520 Test Loss: 12.516 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6013760566711426
Epoch: 32, Steps: 7 | Train Loss: 0.218 Vali Loss: 15.483 Vali Acc: 0.460 Test Loss: 15.483 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8042726516723633
Epoch: 33, Steps: 7 | Train Loss: 0.128 Vali Loss: 16.417 Vali Acc: 0.480 Test Loss: 16.417 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.922778844833374
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 17.819 Vali Acc: 0.480 Test Loss: 17.819 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.773580551147461
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 13.042 Vali Acc: 0.600 Test Loss: 13.042 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2450719
model size : 9.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.202075242996216
Epoch: 1, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.668 Vali Acc: 0.240 Test Loss: 1.668 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.708266019821167
Epoch: 2, Steps: 7 | Train Loss: 0.450 Vali Loss: 1.871 Vali Acc: 0.460 Test Loss: 1.871 Test Acc: 0.460
Validation loss decreased (-0.239983 --> -0.459981).  Saving model ...
Epoch: 3 cost time: 1.6713769435882568
Epoch: 3, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.684 Vali Acc: 0.500 Test Loss: 1.684 Test Acc: 0.500
Validation loss decreased (-0.459981 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 1.6481525897979736
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.440 Test Loss: 2.774 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6876349449157715
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.742 Vali Acc: 0.460 Test Loss: 2.742 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5073893070220947
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.480 Test Loss: 2.584 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5048234462738037
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.614 Vali Acc: 0.500 Test Loss: 2.614 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.625473976135254
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.654 Vali Acc: 0.540 Test Loss: 2.654 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539973).  Saving model ...
Epoch: 9 cost time: 1.527937889099121
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.540 Test Loss: 2.671 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.574220895767212
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.540 Test Loss: 2.671 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6499707698822021
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.648 Vali Acc: 0.540 Test Loss: 2.648 Test Acc: 0.540
Validation loss decreased (-0.539973 --> -0.539974).  Saving model ...
Epoch: 12 cost time: 1.4737894535064697
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.634 Vali Acc: 0.540 Test Loss: 2.634 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 13 cost time: 1.6217677593231201
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.624 Vali Acc: 0.540 Test Loss: 2.624 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 14 cost time: 1.5249404907226562
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.617 Vali Acc: 0.540 Test Loss: 2.617 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 15 cost time: 1.5940492153167725
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.611 Vali Acc: 0.540 Test Loss: 2.611 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 16 cost time: 1.628753900527954
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.605 Vali Acc: 0.540 Test Loss: 2.605 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 17 cost time: 1.5955982208251953
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.540 Test Loss: 2.601 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 18 cost time: 1.6048269271850586
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.540 Test Loss: 2.597 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 19 cost time: 1.5687463283538818
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.594 Vali Acc: 0.540 Test Loss: 2.594 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 20 cost time: 1.697904348373413
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.591 Vali Acc: 0.540 Test Loss: 2.591 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 21 cost time: 1.714510440826416
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.540 Test Loss: 2.587 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 22 cost time: 1.6472218036651611
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.540 Test Loss: 2.584 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 23 cost time: 1.6489348411560059
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.540 Test Loss: 2.581 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 24 cost time: 1.7131011486053467
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.577 Vali Acc: 0.540 Test Loss: 2.577 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 25 cost time: 1.7858376502990723
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.540 Test Loss: 2.574 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 26 cost time: 1.5875020027160645
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.571 Vali Acc: 0.540 Test Loss: 2.571 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 27 cost time: 1.7182159423828125
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.568 Vali Acc: 0.540 Test Loss: 2.568 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 28 cost time: 1.6686384677886963
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.540 Test Loss: 2.566 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 29 cost time: 1.6923551559448242
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.562 Vali Acc: 0.540 Test Loss: 2.562 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 30 cost time: 1.6914589405059814
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.559 Vali Acc: 0.540 Test Loss: 2.559 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 31 cost time: 1.6319551467895508
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.556 Vali Acc: 0.540 Test Loss: 2.556 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 32 cost time: 1.6390776634216309
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.540 Test Loss: 2.552 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 33 cost time: 1.766273021697998
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.540 Test Loss: 2.549 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539975).  Saving model ...
Epoch: 34 cost time: 1.5544719696044922
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.540 Test Loss: 2.546 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 35 cost time: 1.6562461853027344
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.543 Vali Acc: 0.540 Test Loss: 2.543 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 36 cost time: 1.5368027687072754
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.540 Test Loss: 2.540 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 37 cost time: 1.5673840045928955
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.540 Test Loss: 2.538 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 38 cost time: 1.6078715324401855
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.537 Vali Acc: 0.540 Test Loss: 2.537 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 39 cost time: 1.493565320968628
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.534 Vali Acc: 0.540 Test Loss: 2.534 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 40 cost time: 1.584876537322998
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.532 Vali Acc: 0.540 Test Loss: 2.532 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 41 cost time: 1.694648027420044
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.540 Test Loss: 2.530 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 42 cost time: 1.5431416034698486
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.529 Vali Acc: 0.540 Test Loss: 2.529 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 43 cost time: 1.585205316543579
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.526 Vali Acc: 0.540 Test Loss: 2.526 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 44 cost time: 1.693211317062378
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.525 Vali Acc: 0.540 Test Loss: 2.525 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 45 cost time: 1.566330909729004
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.523 Vali Acc: 0.540 Test Loss: 2.523 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 46 cost time: 1.8409538269042969
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.521 Vali Acc: 0.540 Test Loss: 2.521 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 47 cost time: 1.7220604419708252
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.519 Vali Acc: 0.540 Test Loss: 2.519 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 48 cost time: 1.7381086349487305
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.518 Vali Acc: 0.540 Test Loss: 2.518 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 49 cost time: 1.6954448223114014
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.540 Test Loss: 2.516 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 50 cost time: 1.6384470462799072
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.515 Vali Acc: 0.540 Test Loss: 2.515 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 51 cost time: 1.8626205921173096
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.540 Test Loss: 2.513 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 52 cost time: 1.6921536922454834
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.512 Vali Acc: 0.540 Test Loss: 2.512 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 53 cost time: 1.764258623123169
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.540 Test Loss: 2.510 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 54 cost time: 1.6839802265167236
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.540 Test Loss: 2.509 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 55 cost time: 1.8126804828643799
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.507 Vali Acc: 0.540 Test Loss: 2.507 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 56 cost time: 1.6898844242095947
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.506 Vali Acc: 0.540 Test Loss: 2.506 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 57 cost time: 1.664933204650879
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.504 Vali Acc: 0.540 Test Loss: 2.504 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 58 cost time: 1.6800670623779297
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.540 Test Loss: 2.503 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 59 cost time: 1.729201316833496
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.502 Vali Acc: 0.540 Test Loss: 2.502 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 60 cost time: 1.6474614143371582
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.501 Vali Acc: 0.540 Test Loss: 2.501 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 61 cost time: 1.5437986850738525
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.500 Vali Acc: 0.540 Test Loss: 2.500 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 62 cost time: 1.5752966403961182
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.498 Vali Acc: 0.540 Test Loss: 2.498 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 63 cost time: 1.6765546798706055
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.497 Vali Acc: 0.540 Test Loss: 2.497 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 64 cost time: 1.503997802734375
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.496 Vali Acc: 0.540 Test Loss: 2.496 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 65 cost time: 1.5531749725341797
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.540 Test Loss: 2.495 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 66 cost time: 1.5274510383605957
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.540 Test Loss: 2.494 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 67 cost time: 1.5667955875396729
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.493 Vali Acc: 0.540 Test Loss: 2.493 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 68 cost time: 1.579892873764038
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.491 Vali Acc: 0.540 Test Loss: 2.491 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 69 cost time: 1.5395417213439941
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.490 Vali Acc: 0.540 Test Loss: 2.490 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 70 cost time: 1.5674898624420166
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.489 Vali Acc: 0.540 Test Loss: 2.489 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 71 cost time: 1.5708420276641846
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.540 Test Loss: 2.488 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 72 cost time: 1.6221868991851807
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.540 Test Loss: 2.487 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 73 cost time: 1.6836884021759033
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.486 Vali Acc: 0.540 Test Loss: 2.486 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 74 cost time: 1.603421926498413
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.540 Test Loss: 2.485 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 75 cost time: 1.6461153030395508
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.540 Test Loss: 2.484 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 76 cost time: 1.719909906387329
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.540 Test Loss: 2.483 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 77 cost time: 1.7335584163665771
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.482 Vali Acc: 0.540 Test Loss: 2.482 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 78 cost time: 1.5827195644378662
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.540 Test Loss: 2.481 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 79 cost time: 1.6552724838256836
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.540 Test Loss: 2.479 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 80 cost time: 1.584787130355835
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.478 Vali Acc: 0.540 Test Loss: 2.478 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 81 cost time: 1.6617350578308105
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.477 Vali Acc: 0.540 Test Loss: 2.477 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 82 cost time: 1.5643248558044434
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.476 Vali Acc: 0.540 Test Loss: 2.476 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 83 cost time: 1.5635221004486084
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.540 Test Loss: 2.475 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 84 cost time: 1.4535412788391113
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.540 Test Loss: 2.474 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 85 cost time: 1.7475669384002686
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.540 Test Loss: 2.473 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 86 cost time: 1.6114706993103027
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.472 Vali Acc: 0.540 Test Loss: 2.472 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 87 cost time: 1.6820480823516846
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.472 Vali Acc: 0.540 Test Loss: 2.472 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 88 cost time: 1.7067816257476807
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.540 Test Loss: 2.471 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 89 cost time: 1.6103668212890625
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.540 Test Loss: 2.470 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 90 cost time: 1.5257961750030518
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.540 Test Loss: 2.469 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 91 cost time: 1.6397368907928467
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.540 Test Loss: 2.469 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 92 cost time: 1.5096325874328613
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.468 Vali Acc: 0.540 Test Loss: 2.468 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 93 cost time: 1.6119799613952637
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.540 Test Loss: 2.467 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 94 cost time: 1.5707945823669434
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.540 Test Loss: 2.467 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 95 cost time: 1.492175579071045
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.466 Vali Acc: 0.540 Test Loss: 2.466 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 96 cost time: 1.4879498481750488
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.540 Test Loss: 2.465 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 97 cost time: 1.5183522701263428
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.464 Vali Acc: 0.540 Test Loss: 2.464 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 98 cost time: 1.6497607231140137
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.540 Test Loss: 2.463 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 99 cost time: 1.551506757736206
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.540 Test Loss: 2.462 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 100 cost time: 1.5283238887786865
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.540 Test Loss: 2.461 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2444575
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.764475107192993
Epoch: 1, Steps: 7 | Train Loss: 1.615 Vali Loss: 1.331 Vali Acc: 0.440 Test Loss: 1.331 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.3781218528747559
Epoch: 2, Steps: 7 | Train Loss: 0.217 Vali Loss: 1.760 Vali Acc: 0.460 Test Loss: 1.760 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.4155607223510742
Epoch: 3, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.910 Vali Acc: 0.460 Test Loss: 1.910 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4365956783294678
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.207 Vali Acc: 0.480 Test Loss: 2.207 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479978).  Saving model ...
Epoch: 5 cost time: 1.3313755989074707
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.440 Test Loss: 2.597 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3225715160369873
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.940 Vali Acc: 0.440 Test Loss: 2.940 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.285707950592041
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.147 Vali Acc: 0.380 Test Loss: 3.147 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3383851051330566
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.380 Test Loss: 3.248 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4007160663604736
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.286 Vali Acc: 0.380 Test Loss: 3.286 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3729393482208252
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.280 Vali Acc: 0.380 Test Loss: 3.280 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3108243942260742
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.258 Vali Acc: 0.380 Test Loss: 3.258 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.313462257385254
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.231 Vali Acc: 0.400 Test Loss: 3.231 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.190821647644043
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.211 Vali Acc: 0.400 Test Loss: 3.211 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.30314302444458
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.192 Vali Acc: 0.400 Test Loss: 3.192 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2437407
model size : 9.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.459311008453369
Epoch: 1, Steps: 7 | Train Loss: 1.689 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.116166353225708
Epoch: 2, Steps: 7 | Train Loss: 0.236 Vali Loss: 1.928 Vali Acc: 0.500 Test Loss: 1.928 Test Acc: 0.500
Validation loss decreased (-0.379986 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.0701313018798828
Epoch: 3, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.317 Vali Acc: 0.460 Test Loss: 2.317 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1767666339874268
Epoch: 4, Steps: 7 | Train Loss: 0.434 Vali Loss: 2.658 Vali Acc: 0.440 Test Loss: 2.658 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1943576335906982
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.755 Vali Acc: 0.500 Test Loss: 3.755 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1868774890899658
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.154 Vali Acc: 0.540 Test Loss: 3.154 Test Acc: 0.540
Validation loss decreased (-0.499981 --> -0.539968).  Saving model ...
Epoch: 7 cost time: 1.1228387355804443
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.022 Vali Acc: 0.500 Test Loss: 3.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2467539310455322
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.605 Vali Acc: 0.460 Test Loss: 3.605 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2957208156585693
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.109 Vali Acc: 0.520 Test Loss: 4.109 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2247180938720703
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.397 Vali Acc: 0.520 Test Loss: 4.397 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1022071838378906
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.485 Vali Acc: 0.520 Test Loss: 4.485 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4023425579071045
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.440 Vali Acc: 0.520 Test Loss: 4.440 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.207878589630127
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.385 Vali Acc: 0.520 Test Loss: 4.385 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1102015972137451
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.340 Vali Acc: 0.520 Test Loss: 4.340 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0978710651397705
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.307 Vali Acc: 0.520 Test Loss: 4.307 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.218233346939087
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.282 Vali Acc: 0.520 Test Loss: 4.282 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2432287
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.298487901687622
Epoch: 1, Steps: 7 | Train Loss: 1.644 Vali Loss: 1.405 Vali Acc: 0.360 Test Loss: 1.405 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.0509517192840576
Epoch: 2, Steps: 7 | Train Loss: 0.352 Vali Loss: 1.732 Vali Acc: 0.400 Test Loss: 1.732 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.9873847961425781
Epoch: 3, Steps: 7 | Train Loss: 0.021 Vali Loss: 2.092 Vali Acc: 0.460 Test Loss: 2.092 Test Acc: 0.460
Validation loss decreased (-0.399983 --> -0.459979).  Saving model ...
Epoch: 4 cost time: 1.0743763446807861
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.855 Vali Acc: 0.400 Test Loss: 2.855 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0252389907836914
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.229 Vali Acc: 0.420 Test Loss: 3.229 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.171818733215332
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.442 Vali Acc: 0.420 Test Loss: 3.442 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0550992488861084
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.558 Vali Acc: 0.420 Test Loss: 3.558 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.042665958404541
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.619 Vali Acc: 0.420 Test Loss: 3.619 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.122779369354248
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.645 Vali Acc: 0.420 Test Loss: 3.645 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0824885368347168
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.654 Vali Acc: 0.420 Test Loss: 3.654 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.976433277130127
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.654 Vali Acc: 0.420 Test Loss: 3.654 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1108574867248535
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.650 Vali Acc: 0.420 Test Loss: 3.650 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1013894081115723
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.643 Vali Acc: 0.420 Test Loss: 3.643 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2429215
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5259368419647217
Epoch: 1, Steps: 7 | Train Loss: 1.506 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8856954574584961
Epoch: 2, Steps: 7 | Train Loss: 0.287 Vali Loss: 1.508 Vali Acc: 0.540 Test Loss: 1.508 Test Acc: 0.540
Validation loss decreased (-0.399986 --> -0.539985).  Saving model ...
Epoch: 3 cost time: 0.944242000579834
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.379 Vali Acc: 0.480 Test Loss: 2.379 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.951425313949585
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.939 Vali Acc: 0.420 Test Loss: 2.939 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8699197769165039
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.965 Vali Acc: 0.460 Test Loss: 2.965 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0754106044769287
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.995 Vali Acc: 0.480 Test Loss: 2.995 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9802179336547852
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.018 Vali Acc: 0.460 Test Loss: 3.018 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9241414070129395
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.460 Test Loss: 3.032 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0031054019927979
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.040 Vali Acc: 0.460 Test Loss: 3.040 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.138624668121338
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.460 Test Loss: 3.044 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9443197250366211
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.046 Vali Acc: 0.460 Test Loss: 3.046 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8900330066680908
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.047 Vali Acc: 0.460 Test Loss: 3.047 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2426143
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.118175745010376
Epoch: 1, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.670 Vali Acc: 0.340 Test Loss: 1.670 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 0.8120541572570801
Epoch: 2, Steps: 7 | Train Loss: 0.333 Vali Loss: 1.710 Vali Acc: 0.420 Test Loss: 1.710 Test Acc: 0.420
Validation loss decreased (-0.339983 --> -0.419983).  Saving model ...
Epoch: 3 cost time: 0.8442809581756592
Epoch: 3, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.409 Vali Acc: 0.540 Test Loss: 2.409 Test Acc: 0.540
Validation loss decreased (-0.419983 --> -0.539976).  Saving model ...
Epoch: 4 cost time: 0.831383228302002
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 3.032 Vali Acc: 0.500 Test Loss: 3.032 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8376340866088867
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.777 Vali Acc: 0.400 Test Loss: 3.777 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8060281276702881
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.430 Vali Acc: 0.520 Test Loss: 2.430 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8029322624206543
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.480 Test Loss: 5.044 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8391237258911133
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.288 Vali Acc: 0.480 Test Loss: 4.288 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8968830108642578
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.518 Vali Acc: 0.460 Test Loss: 3.518 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7767014503479004
Epoch: 10, Steps: 7 | Train Loss: 0.033 Vali Loss: 3.653 Vali Acc: 0.440 Test Loss: 3.653 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8791980743408203
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.962 Vali Acc: 0.480 Test Loss: 4.962 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8365979194641113
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.557 Vali Acc: 0.460 Test Loss: 6.557 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8587336540222168
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.011 Vali Acc: 0.460 Test Loss: 7.011 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2424095
model size : 9.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4399049282073975
Epoch: 1, Steps: 7 | Train Loss: 1.765 Vali Loss: 1.541 Vali Acc: 0.340 Test Loss: 1.541 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.9428834915161133
Epoch: 2, Steps: 7 | Train Loss: 0.562 Vali Loss: 2.146 Vali Acc: 0.440 Test Loss: 2.146 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439979).  Saving model ...
Epoch: 3 cost time: 1.941314458847046
Epoch: 3, Steps: 7 | Train Loss: 0.070 Vali Loss: 1.673 Vali Acc: 0.520 Test Loss: 1.673 Test Acc: 0.520
Validation loss decreased (-0.439979 --> -0.519983).  Saving model ...
Epoch: 4 cost time: 2.028242588043213
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.322 Vali Acc: 0.560 Test Loss: 2.322 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559977).  Saving model ...
Epoch: 5 cost time: 1.9753222465515137
Epoch: 5, Steps: 7 | Train Loss: 0.046 Vali Loss: 2.834 Vali Acc: 0.540 Test Loss: 2.834 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.909898042678833
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.019 Vali Acc: 0.580 Test Loss: 2.019 Test Acc: 0.580
Validation loss decreased (-0.559977 --> -0.579980).  Saving model ...
Epoch: 7 cost time: 1.9214591979980469
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.454 Vali Acc: 0.540 Test Loss: 2.454 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8410730361938477
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.090 Vali Acc: 0.600 Test Loss: 2.090 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599979).  Saving model ...
Epoch: 9 cost time: 1.8820066452026367
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.520 Test Loss: 3.497 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8760483264923096
Epoch: 10, Steps: 7 | Train Loss: 0.037 Vali Loss: 2.359 Vali Acc: 0.600 Test Loss: 2.359 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8046281337738037
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.908 Vali Acc: 0.580 Test Loss: 2.908 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9132673740386963
Epoch: 12, Steps: 7 | Train Loss: 0.101 Vali Loss: 2.452 Vali Acc: 0.620 Test Loss: 2.452 Test Acc: 0.620
Validation loss decreased (-0.599979 --> -0.619975).  Saving model ...
Epoch: 13 cost time: 1.8947248458862305
Epoch: 13, Steps: 7 | Train Loss: 0.061 Vali Loss: 4.351 Vali Acc: 0.540 Test Loss: 4.351 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7836556434631348
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.103 Vali Acc: 0.480 Test Loss: 6.103 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8771560192108154
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.787 Vali Acc: 0.460 Test Loss: 6.787 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8196511268615723
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.296 Vali Acc: 0.480 Test Loss: 7.296 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8434226512908936
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.299 Vali Acc: 0.440 Test Loss: 8.299 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9120092391967773
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.862 Vali Acc: 0.440 Test Loss: 8.862 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8059139251708984
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.146 Vali Acc: 0.420 Test Loss: 9.146 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.823718547821045
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.273 Vali Acc: 0.420 Test Loss: 9.273 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9713706970214844
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.323 Vali Acc: 0.420 Test Loss: 9.323 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9597768783569336
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.335 Vali Acc: 0.420 Test Loss: 9.335 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2436359
model size : 9.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2721681594848633
Epoch: 1, Steps: 7 | Train Loss: 1.656 Vali Loss: 1.364 Vali Acc: 0.320 Test Loss: 1.364 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.788038730621338
Epoch: 2, Steps: 7 | Train Loss: 0.381 Vali Loss: 2.081 Vali Acc: 0.480 Test Loss: 2.081 Test Acc: 0.480
Validation loss decreased (-0.319986 --> -0.479979).  Saving model ...
Epoch: 3 cost time: 1.7802197933197021
Epoch: 3, Steps: 7 | Train Loss: 0.093 Vali Loss: 2.599 Vali Acc: 0.460 Test Loss: 2.599 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0360801219940186
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.612 Vali Acc: 0.500 Test Loss: 2.612 Test Acc: 0.500
Validation loss decreased (-0.479979 --> -0.499974).  Saving model ...
Epoch: 5 cost time: 1.7802023887634277
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.480 Vali Acc: 0.580 Test Loss: 2.480 Test Acc: 0.580
Validation loss decreased (-0.499974 --> -0.579975).  Saving model ...
Epoch: 6 cost time: 1.8032498359680176
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.600 Test Loss: 2.432 Test Acc: 0.600
Validation loss decreased (-0.579975 --> -0.599976).  Saving model ...
Epoch: 7 cost time: 1.685166835784912
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.417 Vali Acc: 0.620 Test Loss: 2.417 Test Acc: 0.620
Validation loss decreased (-0.599976 --> -0.619976).  Saving model ...
Epoch: 8 cost time: 1.678251028060913
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.620 Test Loss: 2.411 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 9 cost time: 1.6753442287445068
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.620 Test Loss: 2.407 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 10 cost time: 1.7661771774291992
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.404 Vali Acc: 0.620 Test Loss: 2.404 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 11 cost time: 1.7369155883789062
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.620 Test Loss: 2.402 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 12 cost time: 1.6842994689941406
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.399 Vali Acc: 0.620 Test Loss: 2.399 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 13 cost time: 1.7961630821228027
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.620 Test Loss: 2.396 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 14 cost time: 1.7944347858428955
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.394 Vali Acc: 0.620 Test Loss: 2.394 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 15 cost time: 1.6901884078979492
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.392 Vali Acc: 0.620 Test Loss: 2.392 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 16 cost time: 1.7047548294067383
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.620 Test Loss: 2.388 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 17 cost time: 1.7110497951507568
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.383 Vali Acc: 0.620 Test Loss: 2.383 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 18 cost time: 1.682802438735962
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.380 Vali Acc: 0.620 Test Loss: 2.380 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 19 cost time: 1.7549173831939697
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.377 Vali Acc: 0.620 Test Loss: 2.377 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 20 cost time: 1.7736804485321045
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.374 Vali Acc: 0.620 Test Loss: 2.374 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 21 cost time: 1.7696962356567383
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.620 Test Loss: 2.373 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 22 cost time: 1.824953317642212
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.620 Test Loss: 2.371 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 23 cost time: 1.7564845085144043
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.620 Test Loss: 2.370 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 24 cost time: 1.7444453239440918
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.620 Test Loss: 2.370 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8724851608276367
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.620 Test Loss: 2.370 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8136553764343262
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.620 Test Loss: 2.369 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 27 cost time: 1.7959890365600586
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.620 Test Loss: 2.368 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 28 cost time: 1.7321267127990723
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.620 Test Loss: 2.367 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 29 cost time: 1.8546881675720215
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.620 Test Loss: 2.366 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 30 cost time: 1.8456714153289795
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.620 Test Loss: 2.365 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 31 cost time: 1.7815110683441162
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.364 Vali Acc: 0.620 Test Loss: 2.364 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 32 cost time: 1.7449352741241455
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.620 Test Loss: 2.363 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 33 cost time: 1.684403419494629
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.362 Vali Acc: 0.620 Test Loss: 2.362 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 34 cost time: 1.690054178237915
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.362 Vali Acc: 0.620 Test Loss: 2.362 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 35 cost time: 1.6825575828552246
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.361 Vali Acc: 0.620 Test Loss: 2.361 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 36 cost time: 1.8705558776855469
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.360 Vali Acc: 0.620 Test Loss: 2.360 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 37 cost time: 1.6279163360595703
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.620 Test Loss: 2.358 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 38 cost time: 1.649315595626831
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.620 Test Loss: 2.356 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 39 cost time: 1.6875789165496826
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.620 Test Loss: 2.355 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 40 cost time: 1.6866812705993652
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.620 Test Loss: 2.353 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 41 cost time: 1.7364110946655273
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.620 Test Loss: 2.351 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619976).  Saving model ...
Epoch: 42 cost time: 1.654886245727539
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.620 Test Loss: 2.350 Test Acc: 0.620
Validation loss decreased (-0.619976 --> -0.619977).  Saving model ...
Epoch: 43 cost time: 1.7539637088775635
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.348 Vali Acc: 0.620 Test Loss: 2.348 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 44 cost time: 1.6484863758087158
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.620 Test Loss: 2.347 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 45 cost time: 1.6494262218475342
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.346 Vali Acc: 0.620 Test Loss: 2.346 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 46 cost time: 1.8946335315704346
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.344 Vali Acc: 0.620 Test Loss: 2.344 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 47 cost time: 1.7096903324127197
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.620 Test Loss: 2.342 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 48 cost time: 1.7587547302246094
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.620 Test Loss: 2.340 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 49 cost time: 1.721405029296875
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.620 Test Loss: 2.338 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 50 cost time: 1.789503812789917
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.620 Test Loss: 2.338 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 51 cost time: 1.684546947479248
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.620 Test Loss: 2.337 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 52 cost time: 1.800438404083252
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.620 Test Loss: 2.336 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 53 cost time: 1.750377893447876
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.620 Test Loss: 2.335 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 54 cost time: 1.6781005859375
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.620 Test Loss: 2.334 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 55 cost time: 1.713761806488037
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.333 Vali Acc: 0.620 Test Loss: 2.333 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 56 cost time: 1.8330960273742676
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.620 Test Loss: 2.331 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 57 cost time: 1.7853364944458008
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.620 Test Loss: 2.329 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 58 cost time: 1.7757301330566406
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.326 Vali Acc: 0.620 Test Loss: 2.326 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 59 cost time: 1.6705210208892822
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.620 Test Loss: 2.324 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 60 cost time: 1.7244484424591064
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.620 Test Loss: 2.323 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 61 cost time: 1.6630375385284424
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.620 Test Loss: 2.323 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 62 cost time: 1.707263469696045
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.322 Vali Acc: 0.620 Test Loss: 2.322 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 63 cost time: 1.760115385055542
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.321 Vali Acc: 0.620 Test Loss: 2.321 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 64 cost time: 1.6392288208007812
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 65 cost time: 1.7297999858856201
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 66 cost time: 1.682966947555542
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 67 cost time: 1.7035775184631348
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.7174298763275146
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.6566245555877686
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.620 Test Loss: 2.320 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.776146411895752
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.620 Test Loss: 2.319 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 71 cost time: 1.7206692695617676
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.620 Test Loss: 2.319 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 72 cost time: 1.567931890487671
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.620 Test Loss: 2.318 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 73 cost time: 1.634779930114746
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.620 Test Loss: 2.318 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 74 cost time: 1.7603607177734375
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.620 Test Loss: 2.318 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 75 cost time: 1.9231224060058594
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.620 Test Loss: 2.318 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 76 cost time: 1.7059128284454346
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.317 Vali Acc: 0.620 Test Loss: 2.317 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 77 cost time: 1.769521951675415
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.315 Vali Acc: 0.620 Test Loss: 2.315 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 78 cost time: 1.7704691886901855
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.314 Vali Acc: 0.620 Test Loss: 2.314 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 79 cost time: 1.7398059368133545
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.620 Test Loss: 2.313 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 80 cost time: 1.7002410888671875
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.620 Test Loss: 2.313 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.7880020141601562
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.620 Test Loss: 2.313 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 82 cost time: 1.78324294090271
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.620 Test Loss: 2.313 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 83 cost time: 1.644355297088623
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.620 Test Loss: 2.312 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 84 cost time: 1.7687628269195557
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.620 Test Loss: 2.311 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 85 cost time: 1.5653910636901855
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.620 Test Loss: 2.311 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 86 cost time: 1.7611114978790283
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.620 Test Loss: 2.309 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 87 cost time: 1.7536823749542236
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.308 Vali Acc: 0.620 Test Loss: 2.308 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 88 cost time: 1.7310035228729248
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.307 Vali Acc: 0.620 Test Loss: 2.307 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 89 cost time: 1.6332948207855225
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.307 Vali Acc: 0.620 Test Loss: 2.307 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 90 cost time: 1.7651560306549072
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.306 Vali Acc: 0.620 Test Loss: 2.306 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 91 cost time: 1.7356441020965576
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.306 Vali Acc: 0.620 Test Loss: 2.306 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 92 cost time: 1.6142971515655518
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.620 Test Loss: 2.305 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 93 cost time: 1.6734392642974854
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.620 Test Loss: 2.304 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 94 cost time: 1.746823787689209
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.620 Test Loss: 2.304 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.813291311264038
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.620 Test Loss: 2.305 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.820387840270996
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.620 Test Loss: 2.305 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.6380410194396973
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.620 Test Loss: 2.304 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 98 cost time: 1.5747568607330322
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.620 Test Loss: 2.304 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 99 cost time: 1.698270559310913
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.620 Test Loss: 2.303 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 100 cost time: 1.7428627014160156
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.620 Test Loss: 2.303 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2429191
model size : 9.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.046374559402466
Epoch: 1, Steps: 7 | Train Loss: 1.997 Vali Loss: 1.463 Vali Acc: 0.360 Test Loss: 1.463 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.6079063415527344
Epoch: 2, Steps: 7 | Train Loss: 0.545 Vali Loss: 2.276 Vali Acc: 0.380 Test Loss: 2.276 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379977).  Saving model ...
Epoch: 3 cost time: 1.5780994892120361
Epoch: 3, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.415 Vali Acc: 0.320 Test Loss: 2.415 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.599489450454712
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 4.911 Vali Acc: 0.320 Test Loss: 4.911 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7557122707366943
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.869 Vali Acc: 0.340 Test Loss: 3.869 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6841695308685303
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 2.563 Vali Acc: 0.460 Test Loss: 2.563 Test Acc: 0.460
Validation loss decreased (-0.379977 --> -0.459974).  Saving model ...
Epoch: 7 cost time: 1.6513845920562744
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.940 Vali Acc: 0.500 Test Loss: 2.940 Test Acc: 0.500
Validation loss decreased (-0.459974 --> -0.499971).  Saving model ...
Epoch: 8 cost time: 1.548797369003296
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.490 Vali Acc: 0.520 Test Loss: 2.490 Test Acc: 0.520
Validation loss decreased (-0.499971 --> -0.519975).  Saving model ...
Epoch: 9 cost time: 1.6845405101776123
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.362 Vali Acc: 0.380 Test Loss: 3.362 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5805385112762451
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.695 Vali Acc: 0.480 Test Loss: 2.695 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5170259475708008
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.480 Test Loss: 2.644 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5806255340576172
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.197 Vali Acc: 0.460 Test Loss: 3.197 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.631023645401001
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.619 Vali Acc: 0.440 Test Loss: 3.619 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.617793321609497
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.856 Vali Acc: 0.460 Test Loss: 3.856 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5545532703399658
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.979 Vali Acc: 0.460 Test Loss: 3.979 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5616812705993652
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.042 Vali Acc: 0.440 Test Loss: 4.042 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6050302982330322
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.069 Vali Acc: 0.440 Test Loss: 4.069 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6390891075134277
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.081 Vali Acc: 0.440 Test Loss: 4.081 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2423047
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0355770587921143
Epoch: 1, Steps: 7 | Train Loss: 1.513 Vali Loss: 1.410 Vali Acc: 0.420 Test Loss: 1.410 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 1.3398303985595703
Epoch: 2, Steps: 7 | Train Loss: 0.429 Vali Loss: 2.159 Vali Acc: 0.560 Test Loss: 2.159 Test Acc: 0.560
Validation loss decreased (-0.419986 --> -0.559978).  Saving model ...
Epoch: 3 cost time: 1.2564854621887207
Epoch: 3, Steps: 7 | Train Loss: 0.211 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2596893310546875
Epoch: 4, Steps: 7 | Train Loss: 0.046 Vali Loss: 2.903 Vali Acc: 0.460 Test Loss: 2.903 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3330886363983154
Epoch: 5, Steps: 7 | Train Loss: 0.044 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2385683059692383
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.560 Test Loss: 2.016 Test Acc: 0.560
Validation loss decreased (-0.559978 --> -0.559980).  Saving model ...
Epoch: 7 cost time: 1.2997183799743652
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.040 Vali Acc: 0.500 Test Loss: 2.040 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3468408584594727
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.079 Vali Acc: 0.580 Test Loss: 2.079 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579979).  Saving model ...
Epoch: 9 cost time: 1.2382078170776367
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.540 Test Loss: 2.107 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3846981525421143
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.540 Test Loss: 2.122 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2978010177612305
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.540 Test Loss: 2.131 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.354400634765625
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.134 Vali Acc: 0.540 Test Loss: 2.134 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.243105411529541
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.540 Test Loss: 2.135 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.238356113433838
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.540 Test Loss: 2.135 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2698485851287842
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.351529598236084
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.540 Test Loss: 2.131 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.363006353378296
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.127 Vali Acc: 0.540 Test Loss: 2.127 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3664331436157227
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.540 Test Loss: 2.124 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2415879
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0968549251556396
Epoch: 1, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.301 Vali Acc: 0.340 Test Loss: 1.301 Test Acc: 0.340
Validation loss decreased (inf --> -0.339987).  Saving model ...
Epoch: 2 cost time: 1.3289310932159424
Epoch: 2, Steps: 7 | Train Loss: 0.555 Vali Loss: 1.816 Vali Acc: 0.460 Test Loss: 1.816 Test Acc: 0.460
Validation loss decreased (-0.339987 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.2349965572357178
Epoch: 3, Steps: 7 | Train Loss: 0.090 Vali Loss: 2.757 Vali Acc: 0.440 Test Loss: 2.757 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3253374099731445
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.067 Vali Acc: 0.420 Test Loss: 3.067 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2019526958465576
Epoch: 5, Steps: 7 | Train Loss: 0.062 Vali Loss: 3.279 Vali Acc: 0.500 Test Loss: 3.279 Test Acc: 0.500
Validation loss decreased (-0.459982 --> -0.499967).  Saving model ...
Epoch: 6 cost time: 1.192077875137329
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.928 Vali Acc: 0.380 Test Loss: 4.928 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1126534938812256
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 2.825 Vali Acc: 0.600 Test Loss: 2.825 Test Acc: 0.600
Validation loss decreased (-0.499967 --> -0.599972).  Saving model ...
Epoch: 8 cost time: 1.3217065334320068
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.667 Vali Acc: 0.440 Test Loss: 6.667 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1953601837158203
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.982 Vali Acc: 0.460 Test Loss: 4.982 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1899261474609375
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 5.327 Vali Acc: 0.520 Test Loss: 5.327 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2274999618530273
Epoch: 11, Steps: 7 | Train Loss: 0.631 Vali Loss: 9.655 Vali Acc: 0.440 Test Loss: 9.655 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2600960731506348
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.635 Vali Acc: 0.440 Test Loss: 4.635 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1929986476898193
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.653 Vali Acc: 0.560 Test Loss: 4.653 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2718310356140137
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.139 Vali Acc: 0.500 Test Loss: 6.139 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1831531524658203
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.961 Vali Acc: 0.520 Test Loss: 5.961 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2158904075622559
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.014 Vali Acc: 0.460 Test Loss: 7.014 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2328271865844727
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.219 Vali Acc: 0.400 Test Loss: 8.219 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2410759
model size : 9.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3793675899505615
Epoch: 1, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.516 Vali Acc: 0.300 Test Loss: 1.516 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.9207663536071777
Epoch: 2, Steps: 7 | Train Loss: 0.413 Vali Loss: 1.928 Vali Acc: 0.380 Test Loss: 1.928 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379981).  Saving model ...
Epoch: 3 cost time: 1.0759093761444092
Epoch: 3, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.105 Vali Acc: 0.460 Test Loss: 2.105 Test Acc: 0.460
Validation loss decreased (-0.379981 --> -0.459979).  Saving model ...
Epoch: 4 cost time: 1.140045166015625
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
Validation loss decreased (-0.459979 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 0.9293055534362793
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.460 Test Loss: 2.373 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0550155639648438
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.440 Test Loss: 2.606 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9679849147796631
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.626 Vali Acc: 0.460 Test Loss: 2.626 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9261329174041748
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.608 Vali Acc: 0.460 Test Loss: 2.608 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9935767650604248
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.460 Test Loss: 2.586 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.029289722442627
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.460 Test Loss: 2.566 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9251077175140381
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.460 Test Loss: 2.547 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9645662307739258
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.460 Test Loss: 2.530 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9518601894378662
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.460 Test Loss: 2.516 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9698045253753662
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.504 Vali Acc: 0.460 Test Loss: 2.504 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2407687
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5682125091552734
Epoch: 1, Steps: 7 | Train Loss: 1.761 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.003279447555542
Epoch: 2, Steps: 7 | Train Loss: 0.471 Vali Loss: 2.086 Vali Acc: 0.520 Test Loss: 2.086 Test Acc: 0.520
Validation loss decreased (-0.399985 --> -0.519979).  Saving model ...
Epoch: 3 cost time: 1.1507644653320312
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.303 Vali Acc: 0.480 Test Loss: 2.303 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0652801990509033
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.217 Vali Acc: 0.500 Test Loss: 3.217 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1856818199157715
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.426 Vali Acc: 0.360 Test Loss: 3.426 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1898958683013916
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.888 Vali Acc: 0.380 Test Loss: 4.888 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0987663269042969
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.684 Vali Acc: 0.460 Test Loss: 4.684 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0809266567230225
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.094 Vali Acc: 0.400 Test Loss: 4.094 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.121516227722168
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.336 Vali Acc: 0.500 Test Loss: 3.336 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.306999683380127
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 2.656 Vali Acc: 0.520 Test Loss: 2.656 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2395191192626953
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.400 Test Loss: 3.249 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1652817726135254
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.380 Test Loss: 3.476 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2404615
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7116312980651855
Epoch: 1, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.528 Vali Acc: 0.340 Test Loss: 1.528 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 0.7673132419586182
Epoch: 2, Steps: 7 | Train Loss: 0.479 Vali Loss: 2.086 Vali Acc: 0.380 Test Loss: 2.086 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379979).  Saving model ...
Epoch: 3 cost time: 0.8804144859313965
Epoch: 3, Steps: 7 | Train Loss: 0.081 Vali Loss: 2.642 Vali Acc: 0.380 Test Loss: 2.642 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0388283729553223
Epoch: 4, Steps: 7 | Train Loss: 0.084 Vali Loss: 3.187 Vali Acc: 0.500 Test Loss: 3.187 Test Acc: 0.500
Validation loss decreased (-0.379979 --> -0.499968).  Saving model ...
Epoch: 5 cost time: 0.8555359840393066
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.336 Vali Acc: 0.360 Test Loss: 3.336 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.942296028137207
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 3.058 Vali Acc: 0.480 Test Loss: 3.058 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8668959140777588
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.746 Vali Acc: 0.400 Test Loss: 6.746 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9724242687225342
Epoch: 8, Steps: 7 | Train Loss: 0.143 Vali Loss: 4.039 Vali Acc: 0.480 Test Loss: 4.039 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8949506282806396
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.632 Vali Acc: 0.360 Test Loss: 4.632 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0378589630126953
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.889 Vali Acc: 0.500 Test Loss: 3.889 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.928666353225708
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.774 Vali Acc: 0.420 Test Loss: 5.774 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.822878360748291
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.729 Vali Acc: 0.440 Test Loss: 6.729 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9954345226287842
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.601 Vali Acc: 0.380 Test Loss: 8.601 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9809508323669434
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.245 Vali Acc: 0.420 Test Loss: 7.245 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2402567
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.494067907333374
Epoch: 1, Steps: 7 | Train Loss: 1.876 Vali Loss: 1.412 Vali Acc: 0.440 Test Loss: 1.412 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.7599923610687256
Epoch: 2, Steps: 7 | Train Loss: 0.902 Vali Loss: 2.775 Vali Acc: 0.320 Test Loss: 2.775 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9796767234802246
Epoch: 3, Steps: 7 | Train Loss: 0.332 Vali Loss: 2.489 Vali Acc: 0.380 Test Loss: 2.489 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0555081367492676
Epoch: 4, Steps: 7 | Train Loss: 0.062 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 2.111924648284912
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.283 Vali Acc: 0.340 Test Loss: 4.283 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9654154777526855
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 3.239 Vali Acc: 0.520 Test Loss: 3.239 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519968).  Saving model ...
Epoch: 7 cost time: 2.001033306121826
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.806 Vali Acc: 0.560 Test Loss: 2.806 Test Acc: 0.560
Validation loss decreased (-0.519968 --> -0.559972).  Saving model ...
Epoch: 8 cost time: 1.9316692352294922
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.860 Vali Acc: 0.500 Test Loss: 5.860 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8734514713287354
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 5.018 Vali Acc: 0.380 Test Loss: 5.018 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8402948379516602
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 3.865 Vali Acc: 0.520 Test Loss: 3.865 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0511012077331543
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.905 Vali Acc: 0.280 Test Loss: 8.905 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9750635623931885
Epoch: 12, Steps: 7 | Train Loss: 0.074 Vali Loss: 6.304 Vali Acc: 0.480 Test Loss: 6.304 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.892974853515625
Epoch: 13, Steps: 7 | Train Loss: 0.502 Vali Loss: 7.211 Vali Acc: 0.400 Test Loss: 7.211 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.828857183456421
Epoch: 14, Steps: 7 | Train Loss: 0.077 Vali Loss: 4.287 Vali Acc: 0.560 Test Loss: 4.287 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.834169864654541
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.116 Vali Acc: 0.640 Test Loss: 5.116 Test Acc: 0.640
Validation loss decreased (-0.559972 --> -0.639949).  Saving model ...
Epoch: 16 cost time: 1.8940258026123047
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.638 Vali Acc: 0.580 Test Loss: 6.638 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0294525623321533
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.833 Vali Acc: 0.560 Test Loss: 6.833 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8342676162719727
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.031 Vali Acc: 0.580 Test Loss: 5.031 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9053196907043457
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.840 Vali Acc: 0.580 Test Loss: 4.840 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.958387851715088
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.927 Vali Acc: 0.580 Test Loss: 4.927 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9530665874481201
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.005 Vali Acc: 0.540 Test Loss: 5.005 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.852552890777588
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.051 Vali Acc: 0.540 Test Loss: 5.051 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9745607376098633
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.074 Vali Acc: 0.540 Test Loss: 5.074 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.153761386871338
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.085 Vali Acc: 0.540 Test Loss: 5.085 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9334111213684082
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.090 Vali Acc: 0.540 Test Loss: 5.090 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2425595
model size : 9.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9856069087982178
Epoch: 1, Steps: 7 | Train Loss: 1.743 Vali Loss: 1.478 Vali Acc: 0.340 Test Loss: 1.478 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.7253916263580322
Epoch: 2, Steps: 7 | Train Loss: 0.488 Vali Loss: 1.488 Vali Acc: 0.480 Test Loss: 1.488 Test Acc: 0.480
Validation loss decreased (-0.339985 --> -0.479985).  Saving model ...
Epoch: 3 cost time: 1.672443151473999
Epoch: 3, Steps: 7 | Train Loss: 0.215 Vali Loss: 1.611 Vali Acc: 0.420 Test Loss: 1.611 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7467660903930664
Epoch: 4, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.818 Vali Acc: 0.420 Test Loss: 2.818 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6584289073944092
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.363 Vali Acc: 0.500 Test Loss: 2.363 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499976).  Saving model ...
Epoch: 6 cost time: 1.5449891090393066
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.609 Vali Acc: 0.480 Test Loss: 3.609 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.67573881149292
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.601 Vali Acc: 0.440 Test Loss: 4.601 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7911815643310547
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.297 Vali Acc: 0.440 Test Loss: 4.297 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.715933084487915
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.724 Vali Acc: 0.360 Test Loss: 3.724 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7741632461547852
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.779 Vali Acc: 0.300 Test Loss: 5.779 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8916175365447998
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.841 Vali Acc: 0.400 Test Loss: 4.841 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8761656284332275
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.421 Vali Acc: 0.520 Test Loss: 4.421 Test Acc: 0.520
Validation loss decreased (-0.499976 --> -0.519956).  Saving model ...
Epoch: 13 cost time: 1.7673728466033936
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.787 Vali Acc: 0.520 Test Loss: 3.787 Test Acc: 0.520
Validation loss decreased (-0.519956 --> -0.519962).  Saving model ...
Epoch: 14 cost time: 1.7613074779510498
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.539 Vali Acc: 0.540 Test Loss: 3.539 Test Acc: 0.540
Validation loss decreased (-0.519962 --> -0.539965).  Saving model ...
Epoch: 15 cost time: 1.8954436779022217
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.443 Vali Acc: 0.600 Test Loss: 3.443 Test Acc: 0.600
Validation loss decreased (-0.539965 --> -0.599966).  Saving model ...
Epoch: 16 cost time: 1.7268850803375244
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.408 Vali Acc: 0.620 Test Loss: 3.408 Test Acc: 0.620
Validation loss decreased (-0.599966 --> -0.619966).  Saving model ...
Epoch: 17 cost time: 1.9742207527160645
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.400 Vali Acc: 0.620 Test Loss: 3.400 Test Acc: 0.620
Validation loss decreased (-0.619966 --> -0.619966).  Saving model ...
Epoch: 18 cost time: 1.8411328792572021
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.406 Vali Acc: 0.620 Test Loss: 3.406 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7628154754638672
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.414 Vali Acc: 0.620 Test Loss: 3.414 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8235352039337158
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.421 Vali Acc: 0.600 Test Loss: 3.421 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8265373706817627
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.427 Vali Acc: 0.600 Test Loss: 3.427 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9072356224060059
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.432 Vali Acc: 0.600 Test Loss: 3.432 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.804408311843872
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.436 Vali Acc: 0.600 Test Loss: 3.436 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7973239421844482
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.440 Vali Acc: 0.600 Test Loss: 3.440 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7947771549224854
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.444 Vali Acc: 0.600 Test Loss: 3.444 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8172640800476074
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.450 Vali Acc: 0.600 Test Loss: 3.450 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6530005931854248
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.454 Vali Acc: 0.620 Test Loss: 3.454 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2418427
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.398789644241333
Epoch: 1, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.434 Vali Acc: 0.320 Test Loss: 1.434 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.651463508605957
Epoch: 2, Steps: 7 | Train Loss: 0.684 Vali Loss: 1.482 Vali Acc: 0.460 Test Loss: 1.482 Test Acc: 0.460
Validation loss decreased (-0.319986 --> -0.459985).  Saving model ...
Epoch: 3 cost time: 1.6447312831878662
Epoch: 3, Steps: 7 | Train Loss: 0.099 Vali Loss: 2.205 Vali Acc: 0.480 Test Loss: 2.205 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479978).  Saving model ...
Epoch: 4 cost time: 1.8671393394470215
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.494 Vali Acc: 0.520 Test Loss: 2.494 Test Acc: 0.520
Validation loss decreased (-0.479978 --> -0.519975).  Saving model ...
Epoch: 5 cost time: 1.8748481273651123
Epoch: 5, Steps: 7 | Train Loss: 0.074 Vali Loss: 3.226 Vali Acc: 0.420 Test Loss: 3.226 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6724624633789062
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.598 Vali Acc: 0.400 Test Loss: 4.598 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7537305355072021
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.525 Vali Acc: 0.480 Test Loss: 2.525 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6642138957977295
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.090 Vali Acc: 0.280 Test Loss: 4.090 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8164236545562744
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.961 Vali Acc: 0.460 Test Loss: 2.961 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6293182373046875
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.237 Vali Acc: 0.300 Test Loss: 6.237 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6808183193206787
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.682 Vali Acc: 0.560 Test Loss: 2.682 Test Acc: 0.560
Validation loss decreased (-0.519975 --> -0.559973).  Saving model ...
Epoch: 12 cost time: 1.675877571105957
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.850 Vali Acc: 0.440 Test Loss: 2.850 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6036455631256104
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 7.029 Vali Acc: 0.360 Test Loss: 7.029 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6022021770477295
Epoch: 14, Steps: 7 | Train Loss: 0.030 Vali Loss: 4.805 Vali Acc: 0.340 Test Loss: 4.805 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.865624189376831
Epoch: 15, Steps: 7 | Train Loss: 0.193 Vali Loss: 4.303 Vali Acc: 0.400 Test Loss: 4.303 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5797638893127441
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 8.192 Vali Acc: 0.460 Test Loss: 8.192 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6949646472930908
Epoch: 17, Steps: 7 | Train Loss: 0.064 Vali Loss: 9.914 Vali Acc: 0.400 Test Loss: 9.914 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5362977981567383
Epoch: 18, Steps: 7 | Train Loss: 0.779 Vali Loss: 11.546 Vali Acc: 0.500 Test Loss: 11.546 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.642747163772583
Epoch: 19, Steps: 7 | Train Loss: 2.262 Vali Loss: 9.670 Vali Acc: 0.420 Test Loss: 9.670 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5243721008300781
Epoch: 20, Steps: 7 | Train Loss: 1.707 Vali Loss: 11.545 Vali Acc: 0.360 Test Loss: 11.545 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6584079265594482
Epoch: 21, Steps: 7 | Train Loss: 1.213 Vali Loss: 14.837 Vali Acc: 0.440 Test Loss: 14.837 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2412283
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8514106273651123
Epoch: 1, Steps: 7 | Train Loss: 1.720 Vali Loss: 2.020 Vali Acc: 0.420 Test Loss: 2.020 Test Acc: 0.420
Validation loss decreased (inf --> -0.419980).  Saving model ...
Epoch: 2 cost time: 1.4198648929595947
Epoch: 2, Steps: 7 | Train Loss: 1.061 Vali Loss: 1.836 Vali Acc: 0.360 Test Loss: 1.836 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.519876480102539
Epoch: 3, Steps: 7 | Train Loss: 0.108 Vali Loss: 4.387 Vali Acc: 0.420 Test Loss: 4.387 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3476831912994385
Epoch: 4, Steps: 7 | Train Loss: 0.390 Vali Loss: 2.982 Vali Acc: 0.460 Test Loss: 2.982 Test Acc: 0.460
Validation loss decreased (-0.419980 --> -0.459970).  Saving model ...
Epoch: 5 cost time: 1.4830498695373535
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 3.834 Vali Acc: 0.560 Test Loss: 3.834 Test Acc: 0.560
Validation loss decreased (-0.459970 --> -0.559962).  Saving model ...
Epoch: 6 cost time: 1.4029505252838135
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.037 Vali Acc: 0.580 Test Loss: 3.037 Test Acc: 0.580
Validation loss decreased (-0.559962 --> -0.579970).  Saving model ...
Epoch: 7 cost time: 1.450145959854126
Epoch: 7, Steps: 7 | Train Loss: 0.076 Vali Loss: 2.372 Vali Acc: 0.620 Test Loss: 2.372 Test Acc: 0.620
Validation loss decreased (-0.579970 --> -0.619976).  Saving model ...
Epoch: 8 cost time: 1.5074474811553955
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.527 Vali Acc: 0.540 Test Loss: 3.527 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.379194974899292
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.826 Vali Acc: 0.480 Test Loss: 4.826 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5646898746490479
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.863 Vali Acc: 0.480 Test Loss: 4.863 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.284947156906128
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.260 Vali Acc: 0.540 Test Loss: 4.260 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.460331916809082
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.946 Vali Acc: 0.560 Test Loss: 3.946 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3954293727874756
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.781 Vali Acc: 0.560 Test Loss: 3.781 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3659660816192627
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.694 Vali Acc: 0.580 Test Loss: 3.694 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3716084957122803
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.648 Vali Acc: 0.580 Test Loss: 3.648 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.480717658996582
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.580 Test Loss: 3.623 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4652974605560303
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.609 Vali Acc: 0.580 Test Loss: 3.609 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2405115
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6692211627960205
Epoch: 1, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.3525042533874512
Epoch: 2, Steps: 7 | Train Loss: 0.739 Vali Loss: 4.416 Vali Acc: 0.280 Test Loss: 4.416 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279956).  Saving model ...
Epoch: 3 cost time: 1.2816319465637207
Epoch: 3, Steps: 7 | Train Loss: 1.447 Vali Loss: 2.523 Vali Acc: 0.420 Test Loss: 2.523 Test Acc: 0.420
Validation loss decreased (-0.279956 --> -0.419975).  Saving model ...
Epoch: 4 cost time: 1.4219894409179688
Epoch: 4, Steps: 7 | Train Loss: 0.330 Vali Loss: 4.153 Vali Acc: 0.520 Test Loss: 4.153 Test Acc: 0.520
Validation loss decreased (-0.419975 --> -0.519958).  Saving model ...
Epoch: 5 cost time: 1.2629823684692383
Epoch: 5, Steps: 7 | Train Loss: 0.425 Vali Loss: 2.159 Vali Acc: 0.560 Test Loss: 2.159 Test Acc: 0.560
Validation loss decreased (-0.519958 --> -0.559978).  Saving model ...
Epoch: 6 cost time: 1.356743335723877
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.560 Test Loss: 2.024 Test Acc: 0.560
Validation loss decreased (-0.559978 --> -0.559980).  Saving model ...
Epoch: 7 cost time: 1.2892632484436035
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.176 Vali Acc: 0.480 Test Loss: 3.176 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.296935796737671
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.200 Vali Acc: 0.560 Test Loss: 2.200 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.335677146911621
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.761 Vali Acc: 0.500 Test Loss: 4.761 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2467730045318604
Epoch: 10, Steps: 7 | Train Loss: 0.101 Vali Loss: 5.137 Vali Acc: 0.500 Test Loss: 5.137 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4883019924163818
Epoch: 11, Steps: 7 | Train Loss: 0.106 Vali Loss: 3.770 Vali Acc: 0.560 Test Loss: 3.770 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2101807594299316
Epoch: 12, Steps: 7 | Train Loss: 0.055 Vali Loss: 5.352 Vali Acc: 0.540 Test Loss: 5.352 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.284320592880249
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.684 Vali Acc: 0.480 Test Loss: 5.684 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2721822261810303
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 4.519 Vali Acc: 0.460 Test Loss: 4.519 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2167611122131348
Epoch: 15, Steps: 7 | Train Loss: 0.470 Vali Loss: 4.519 Vali Acc: 0.480 Test Loss: 4.519 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3370630741119385
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.005 Vali Acc: 0.480 Test Loss: 7.005 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2399995
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.400084972381592
Epoch: 1, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.821 Vali Acc: 0.200 Test Loss: 1.821 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.1904783248901367
Epoch: 2, Steps: 7 | Train Loss: 0.591 Vali Loss: 1.699 Vali Acc: 0.360 Test Loss: 1.699 Test Acc: 0.360
Validation loss decreased (-0.199982 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 1.0561704635620117
Epoch: 3, Steps: 7 | Train Loss: 0.115 Vali Loss: 2.092 Vali Acc: 0.420 Test Loss: 2.092 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419979).  Saving model ...
Epoch: 4 cost time: 1.2031476497650146
Epoch: 4, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.361 Vali Acc: 0.400 Test Loss: 3.361 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2824859619140625
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 2.293 Vali Acc: 0.500 Test Loss: 2.293 Test Acc: 0.500
Validation loss decreased (-0.419979 --> -0.499977).  Saving model ...
Epoch: 6 cost time: 1.2360033988952637
Epoch: 6, Steps: 7 | Train Loss: 0.090 Vali Loss: 5.434 Vali Acc: 0.340 Test Loss: 5.434 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3293673992156982
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.289 Vali Acc: 0.360 Test Loss: 3.289 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.284980297088623
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.440 Test Loss: 3.858 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2010328769683838
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.351 Vali Acc: 0.440 Test Loss: 4.351 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4122438430786133
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.603 Vali Acc: 0.440 Test Loss: 4.603 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2583937644958496
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.688 Vali Acc: 0.460 Test Loss: 4.688 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3623170852661133
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.689 Vali Acc: 0.440 Test Loss: 4.689 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1811282634735107
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.648 Vali Acc: 0.460 Test Loss: 4.648 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.225019931793213
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.591 Vali Acc: 0.480 Test Loss: 4.591 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1957981586456299
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.545 Vali Acc: 0.480 Test Loss: 4.545 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2396923
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4062418937683105
Epoch: 1, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.628 Vali Acc: 0.280 Test Loss: 1.628 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1552040576934814
Epoch: 2, Steps: 7 | Train Loss: 0.471 Vali Loss: 1.913 Vali Acc: 0.380 Test Loss: 1.913 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379981).  Saving model ...
Epoch: 3 cost time: 1.046008825302124
Epoch: 3, Steps: 7 | Train Loss: 0.340 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
Validation loss decreased (-0.379981 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 1.074505090713501
Epoch: 4, Steps: 7 | Train Loss: 0.075 Vali Loss: 2.572 Vali Acc: 0.520 Test Loss: 2.572 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519974).  Saving model ...
Epoch: 5 cost time: 1.1193349361419678
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.248 Vali Acc: 0.440 Test Loss: 5.248 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0792489051818848
Epoch: 6, Steps: 7 | Train Loss: 0.153 Vali Loss: 2.677 Vali Acc: 0.520 Test Loss: 2.677 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1818888187408447
Epoch: 7, Steps: 7 | Train Loss: 0.156 Vali Loss: 3.239 Vali Acc: 0.540 Test Loss: 3.239 Test Acc: 0.540
Validation loss decreased (-0.519974 --> -0.539968).  Saving model ...
Epoch: 8 cost time: 1.183140754699707
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 5.944 Vali Acc: 0.440 Test Loss: 5.944 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0536572933197021
Epoch: 9, Steps: 7 | Train Loss: 0.077 Vali Loss: 5.926 Vali Acc: 0.380 Test Loss: 5.926 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2259166240692139
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.416 Vali Acc: 0.520 Test Loss: 7.416 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0581300258636475
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 7.441 Vali Acc: 0.460 Test Loss: 7.441 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1176273822784424
Epoch: 12, Steps: 7 | Train Loss: 0.329 Vali Loss: 7.398 Vali Acc: 0.540 Test Loss: 7.398 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1375796794891357
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 13.853 Vali Acc: 0.440 Test Loss: 13.853 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0890278816223145
Epoch: 14, Steps: 7 | Train Loss: 1.220 Vali Loss: 10.457 Vali Acc: 0.380 Test Loss: 10.457 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3471157550811768
Epoch: 15, Steps: 7 | Train Loss: 0.701 Vali Loss: 7.109 Vali Acc: 0.540 Test Loss: 7.109 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1853184700012207
Epoch: 16, Steps: 7 | Train Loss: 0.505 Vali Loss: 9.755 Vali Acc: 0.460 Test Loss: 9.755 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9991674423217773
Epoch: 17, Steps: 7 | Train Loss: 0.200 Vali Loss: 16.357 Vali Acc: 0.320 Test Loss: 16.357 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2393851
model size : 9.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1534054279327393
Epoch: 1, Steps: 7 | Train Loss: 1.679 Vali Loss: 1.833 Vali Acc: 0.280 Test Loss: 1.833 Test Acc: 0.280
Validation loss decreased (inf --> -0.279982).  Saving model ...
Epoch: 2 cost time: 0.9014832973480225
Epoch: 2, Steps: 7 | Train Loss: 1.565 Vali Loss: 1.958 Vali Acc: 0.360 Test Loss: 1.958 Test Acc: 0.360
Validation loss decreased (-0.279982 --> -0.359980).  Saving model ...
Epoch: 3 cost time: 0.9263632297515869
Epoch: 3, Steps: 7 | Train Loss: 1.115 Vali Loss: 2.530 Vali Acc: 0.420 Test Loss: 2.530 Test Acc: 0.420
Validation loss decreased (-0.359980 --> -0.419975).  Saving model ...
Epoch: 4 cost time: 0.8403916358947754
Epoch: 4, Steps: 7 | Train Loss: 0.109 Vali Loss: 3.307 Vali Acc: 0.500 Test Loss: 3.307 Test Acc: 0.500
Validation loss decreased (-0.419975 --> -0.499967).  Saving model ...
Epoch: 5 cost time: 0.8257572650909424
Epoch: 5, Steps: 7 | Train Loss: 0.222 Vali Loss: 6.034 Vali Acc: 0.460 Test Loss: 6.034 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8810617923736572
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.801 Vali Acc: 0.500 Test Loss: 3.801 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9442198276519775
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.486 Vali Acc: 0.440 Test Loss: 4.486 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9458560943603516
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.494 Vali Acc: 0.420 Test Loss: 4.494 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1300849914550781
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.424 Vali Acc: 0.380 Test Loss: 5.424 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8706967830657959
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.420 Test Loss: 6.202 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.054211139678955
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.645 Vali Acc: 0.400 Test Loss: 6.645 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9754526615142822
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.746 Vali Acc: 0.400 Test Loss: 6.746 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.980186939239502
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.373 Vali Acc: 0.400 Test Loss: 6.373 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0722665786743164
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.187 Vali Acc: 0.380 Test Loss: 6.187 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2391803
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.453733444213867
Epoch: 1, Steps: 7 | Train Loss: 1.765 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.6863276958465576
Epoch: 2, Steps: 7 | Train Loss: 0.282 Vali Loss: 1.834 Vali Acc: 0.500 Test Loss: 1.834 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.811429738998413
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.683 Vali Acc: 0.420 Test Loss: 2.683 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.835702896118164
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.097 Vali Acc: 0.400 Test Loss: 3.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.938143253326416
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.352 Vali Acc: 0.400 Test Loss: 3.352 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8920040130615234
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.499 Vali Acc: 0.400 Test Loss: 3.499 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8595318794250488
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.580 Vali Acc: 0.400 Test Loss: 3.580 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0029337406158447
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.625 Vali Acc: 0.400 Test Loss: 3.625 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7787115573883057
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.648 Vali Acc: 0.400 Test Loss: 3.648 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8885951042175293
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.660 Vali Acc: 0.400 Test Loss: 3.660 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8427460193634033
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.665 Vali Acc: 0.400 Test Loss: 3.665 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2412141
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.370173692703247
Epoch: 1, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.7041752338409424
Epoch: 2, Steps: 7 | Train Loss: 0.273 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.81449294090271
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.749178409576416
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.520 Test Loss: 2.593 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519974).  Saving model ...
Epoch: 5 cost time: 1.882903814315796
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.897 Vali Acc: 0.520 Test Loss: 2.897 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9289274215698242
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.073 Vali Acc: 0.520 Test Loss: 3.073 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8873577117919922
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.164 Vali Acc: 0.520 Test Loss: 3.164 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7030720710754395
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.204 Vali Acc: 0.520 Test Loss: 3.204 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8690545558929443
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.221 Vali Acc: 0.520 Test Loss: 3.221 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.75596022605896
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.222 Vali Acc: 0.520 Test Loss: 3.222 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7011702060699463
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.220 Vali Acc: 0.500 Test Loss: 3.220 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6479277610778809
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.500 Test Loss: 3.214 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7467613220214844
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.204 Vali Acc: 0.500 Test Loss: 3.204 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.832094669342041
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.197 Vali Acc: 0.500 Test Loss: 3.197 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2404973
model size : 9.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3758246898651123
Epoch: 1, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.365 Vali Acc: 0.440 Test Loss: 1.365 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.5530407428741455
Epoch: 2, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.836 Vali Acc: 0.460 Test Loss: 1.836 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.5924208164215088
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.782 Vali Acc: 0.460 Test Loss: 2.782 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.537747859954834
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.307 Vali Acc: 0.440 Test Loss: 3.307 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6790380477905273
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.629 Vali Acc: 0.480 Test Loss: 3.629 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479964).  Saving model ...
Epoch: 6 cost time: 1.57277512550354
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.817 Vali Acc: 0.480 Test Loss: 3.817 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5569403171539307
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.923 Vali Acc: 0.480 Test Loss: 3.923 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8592665195465088
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.982 Vali Acc: 0.500 Test Loss: 3.982 Test Acc: 0.500
Validation loss decreased (-0.479964 --> -0.499960).  Saving model ...
Epoch: 9 cost time: 1.5454046726226807
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.013 Vali Acc: 0.500 Test Loss: 4.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6703987121582031
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.030 Vali Acc: 0.500 Test Loss: 4.030 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6115763187408447
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.039 Vali Acc: 0.500 Test Loss: 4.039 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6191143989562988
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.043 Vali Acc: 0.500 Test Loss: 4.043 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5494999885559082
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.045 Vali Acc: 0.500 Test Loss: 4.045 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5118274688720703
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.046 Vali Acc: 0.500 Test Loss: 4.046 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5298652648925781
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.047 Vali Acc: 0.500 Test Loss: 4.047 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4595952033996582
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.046 Vali Acc: 0.500 Test Loss: 4.046 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5636539459228516
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.046 Vali Acc: 0.500 Test Loss: 4.046 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7350616455078125
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.045 Vali Acc: 0.500 Test Loss: 4.045 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2398829
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9939005374908447
Epoch: 1, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.262 Vali Acc: 0.540 Test Loss: 1.262 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 1.3620610237121582
Epoch: 2, Steps: 7 | Train Loss: 0.183 Vali Loss: 2.008 Vali Acc: 0.520 Test Loss: 2.008 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4996180534362793
Epoch: 3, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.157 Vali Acc: 0.500 Test Loss: 2.157 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3443806171417236
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.460 Test Loss: 2.338 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4456450939178467
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.460 Test Loss: 2.650 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3668630123138428
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.851 Vali Acc: 0.480 Test Loss: 2.851 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5586276054382324
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.961 Vali Acc: 0.480 Test Loss: 2.961 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3510034084320068
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.015 Vali Acc: 0.480 Test Loss: 3.015 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.418616533279419
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.041 Vali Acc: 0.480 Test Loss: 3.041 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6308467388153076
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.053 Vali Acc: 0.480 Test Loss: 3.053 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3493931293487549
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.058 Vali Acc: 0.480 Test Loss: 3.058 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2391661
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8396003246307373
Epoch: 1, Steps: 7 | Train Loss: 1.584 Vali Loss: 1.300 Vali Acc: 0.480 Test Loss: 1.300 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.1975867748260498
Epoch: 2, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.926 Vali Acc: 0.520 Test Loss: 1.926 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519981).  Saving model ...
Epoch: 3 cost time: 1.2584261894226074
Epoch: 3, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.783 Vali Acc: 0.420 Test Loss: 2.783 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3000235557556152
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.053 Vali Acc: 0.420 Test Loss: 3.053 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2783291339874268
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.183 Vali Acc: 0.420 Test Loss: 3.183 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.166062593460083
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.261 Vali Acc: 0.420 Test Loss: 3.261 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3876936435699463
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.306 Vali Acc: 0.420 Test Loss: 3.306 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.327146053314209
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.331 Vali Acc: 0.440 Test Loss: 3.331 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3298752307891846
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.345 Vali Acc: 0.440 Test Loss: 3.345 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1558609008789062
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.352 Vali Acc: 0.440 Test Loss: 3.352 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2720930576324463
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.440 Test Loss: 3.355 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1680500507354736
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.440 Test Loss: 3.356 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2386541
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3291614055633545
Epoch: 1, Steps: 7 | Train Loss: 1.625 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.1836028099060059
Epoch: 2, Steps: 7 | Train Loss: 0.167 Vali Loss: 1.961 Vali Acc: 0.480 Test Loss: 1.961 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2281618118286133
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.460 Test Loss: 2.208 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1759731769561768
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.500 Test Loss: 2.397 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 1.0573759078979492
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.525 Vali Acc: 0.500 Test Loss: 2.525 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0320749282836914
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.604 Vali Acc: 0.520 Test Loss: 2.604 Test Acc: 0.520
Validation loss decreased (-0.499976 --> -0.519974).  Saving model ...
Epoch: 7 cost time: 1.0992906093597412
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.520 Test Loss: 2.650 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1843886375427246
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.675 Vali Acc: 0.520 Test Loss: 2.675 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1401422023773193
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.689 Vali Acc: 0.520 Test Loss: 2.689 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2212903499603271
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.520 Test Loss: 2.696 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2443790435791016
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.520 Test Loss: 2.700 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.15958571434021
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.520 Test Loss: 2.702 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.262420415878296
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.520 Test Loss: 2.703 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2821769714355469
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.520 Test Loss: 2.703 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2642457485198975
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.520 Test Loss: 2.703 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.098633050918579
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.520 Test Loss: 2.702 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2383469
model size : 9.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4864492416381836
Epoch: 1, Steps: 7 | Train Loss: 1.459 Vali Loss: 1.255 Vali Acc: 0.460 Test Loss: 1.255 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 0.920508861541748
Epoch: 2, Steps: 7 | Train Loss: 0.161 Vali Loss: 1.626 Vali Acc: 0.500 Test Loss: 1.626 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.0141527652740479
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.460 Test Loss: 2.349 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.012176752090454
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.921 Vali Acc: 0.460 Test Loss: 2.921 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9532928466796875
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.284 Vali Acc: 0.460 Test Loss: 3.284 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9402012825012207
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.498 Vali Acc: 0.460 Test Loss: 3.498 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0423297882080078
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.619 Vali Acc: 0.460 Test Loss: 3.619 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9670610427856445
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.685 Vali Acc: 0.460 Test Loss: 3.685 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.93924880027771
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.460 Test Loss: 3.720 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9190049171447754
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.737 Vali Acc: 0.460 Test Loss: 3.737 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9150409698486328
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.745 Vali Acc: 0.460 Test Loss: 3.745 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9289383888244629
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.748 Vali Acc: 0.460 Test Loss: 3.748 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2380397
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.257439374923706
Epoch: 1, Steps: 7 | Train Loss: 1.442 Vali Loss: 1.210 Vali Acc: 0.440 Test Loss: 1.210 Test Acc: 0.440
Validation loss decreased (inf --> -0.439988).  Saving model ...
Epoch: 2 cost time: 0.9458084106445312
Epoch: 2, Steps: 7 | Train Loss: 0.200 Vali Loss: 1.392 Vali Acc: 0.520 Test Loss: 1.392 Test Acc: 0.520
Validation loss decreased (-0.439988 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 0.9084916114807129
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.540 Test Loss: 1.819 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 0.8238327503204346
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.175 Vali Acc: 0.540 Test Loss: 2.175 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9415643215179443
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.560 Test Loss: 2.431 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559976).  Saving model ...
Epoch: 6 cost time: 0.880800724029541
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.589 Vali Acc: 0.560 Test Loss: 2.589 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9094798564910889
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.681 Vali Acc: 0.560 Test Loss: 2.681 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9147570133209229
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.560 Test Loss: 2.731 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8803544044494629
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.560 Test Loss: 2.758 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9648110866546631
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.772 Vali Acc: 0.560 Test Loss: 2.772 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0280663967132568
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.779 Vali Acc: 0.560 Test Loss: 2.779 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0286829471588135
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.782 Vali Acc: 0.560 Test Loss: 2.782 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.006554365158081
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.783 Vali Acc: 0.560 Test Loss: 2.783 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.135335922241211
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.783 Vali Acc: 0.560 Test Loss: 2.783 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.013948917388916
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.782 Vali Acc: 0.560 Test Loss: 2.782 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2378349
model size : 9.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.300314426422119
Epoch: 1, Steps: 7 | Train Loss: 1.557 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.7006027698516846
Epoch: 2, Steps: 7 | Train Loss: 0.211 Vali Loss: 1.992 Vali Acc: 0.500 Test Loss: 1.992 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 1.6575028896331787
Epoch: 3, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.708 Vali Acc: 0.580 Test Loss: 1.708 Test Acc: 0.580
Validation loss decreased (-0.499980 --> -0.579983).  Saving model ...
Epoch: 4 cost time: 1.885627031326294
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.112 Vali Acc: 0.520 Test Loss: 2.112 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7991182804107666
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.520 Test Loss: 2.447 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7685906887054443
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.540 Test Loss: 2.679 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.782672643661499
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.540 Test Loss: 2.824 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8107564449310303
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.909 Vali Acc: 0.540 Test Loss: 2.909 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8334639072418213
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.957 Vali Acc: 0.540 Test Loss: 2.957 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6785290241241455
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.982 Vali Acc: 0.540 Test Loss: 2.982 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.696685552597046
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.996 Vali Acc: 0.540 Test Loss: 2.996 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9601149559020996
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.003 Vali Acc: 0.540 Test Loss: 3.003 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6613292694091797
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.006 Vali Acc: 0.540 Test Loss: 3.006 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2809839
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5830023288726807
Epoch: 1, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.313 Vali Acc: 0.380 Test Loss: 1.313 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 1.438812017440796
Epoch: 2, Steps: 7 | Train Loss: 0.134 Vali Loss: 1.848 Vali Acc: 0.540 Test Loss: 1.848 Test Acc: 0.540
Validation loss decreased (-0.379987 --> -0.539982).  Saving model ...
Epoch: 3 cost time: 1.5608391761779785
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.639 Vali Acc: 0.580 Test Loss: 1.639 Test Acc: 0.580
Validation loss decreased (-0.539982 --> -0.579984).  Saving model ...
Epoch: 4 cost time: 1.455366849899292
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.540 Test Loss: 1.928 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6022791862487793
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.540 Test Loss: 2.071 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4959816932678223
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.520 Test Loss: 2.172 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7115106582641602
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.480 Test Loss: 2.223 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6221678256988525
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.251 Vali Acc: 0.500 Test Loss: 2.251 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5694024562835693
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.520 Test Loss: 2.267 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6591053009033203
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.520 Test Loss: 2.274 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6250848770141602
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.278 Vali Acc: 0.520 Test Loss: 2.278 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6248688697814941
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.520 Test Loss: 2.279 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6719250679016113
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.520 Test Loss: 2.279 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2806255
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9033849239349365
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.326 Vali Acc: 0.340 Test Loss: 1.326 Test Acc: 0.340
Validation loss decreased (inf --> -0.339987).  Saving model ...
Epoch: 2 cost time: 1.4019083976745605
Epoch: 2, Steps: 7 | Train Loss: 0.218 Vali Loss: 2.087 Vali Acc: 0.520 Test Loss: 2.087 Test Acc: 0.520
Validation loss decreased (-0.339987 --> -0.519979).  Saving model ...
Epoch: 3 cost time: 1.5949146747589111
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.636 Vali Acc: 0.480 Test Loss: 2.636 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.600205898284912
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.560 Test Loss: 2.194 Test Acc: 0.560
Validation loss decreased (-0.519979 --> -0.559978).  Saving model ...
Epoch: 5 cost time: 1.5727460384368896
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.540 Test Loss: 2.088 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5098140239715576
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.520 Test Loss: 2.122 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5955188274383545
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.540 Test Loss: 2.166 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5810832977294922
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.540 Test Loss: 2.197 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4390218257904053
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.215 Vali Acc: 0.540 Test Loss: 2.215 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4770731925964355
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.540 Test Loss: 2.225 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6494250297546387
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.230 Vali Acc: 0.540 Test Loss: 2.230 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5108819007873535
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.232 Vali Acc: 0.540 Test Loss: 2.232 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.477116584777832
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.232 Vali Acc: 0.540 Test Loss: 2.232 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5929296016693115
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.231 Vali Acc: 0.540 Test Loss: 2.231 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2803183
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.727708101272583
Epoch: 1, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.1930179595947266
Epoch: 2, Steps: 7 | Train Loss: 0.165 Vali Loss: 1.918 Vali Acc: 0.520 Test Loss: 1.918 Test Acc: 0.520
Validation loss decreased (-0.399987 --> -0.519981).  Saving model ...
Epoch: 3 cost time: 1.2102336883544922
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.275 Vali Acc: 0.500 Test Loss: 2.275 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2709639072418213
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.500 Test Loss: 2.671 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2895312309265137
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.840 Vali Acc: 0.480 Test Loss: 2.840 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2474157810211182
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.938 Vali Acc: 0.480 Test Loss: 2.938 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3106448650360107
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.993 Vali Acc: 0.480 Test Loss: 2.993 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1113214492797852
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.022 Vali Acc: 0.480 Test Loss: 3.022 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.156815528869629
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.037 Vali Acc: 0.480 Test Loss: 3.037 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.166304349899292
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.480 Test Loss: 3.044 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2781729698181152
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.047 Vali Acc: 0.480 Test Loss: 3.047 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2954821586608887
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.480 Test Loss: 3.048 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2799599
model size : 10.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.696824073791504
Epoch: 1, Steps: 7 | Train Loss: 1.649 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.0605604648590088
Epoch: 2, Steps: 7 | Train Loss: 0.191 Vali Loss: 1.585 Vali Acc: 0.520 Test Loss: 1.585 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 1.1221721172332764
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.400 Test Loss: 1.896 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1738696098327637
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.344 Vali Acc: 0.420 Test Loss: 2.344 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.194002628326416
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.647 Vali Acc: 0.420 Test Loss: 2.647 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1241428852081299
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.830 Vali Acc: 0.400 Test Loss: 2.830 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.217477560043335
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.400 Test Loss: 2.935 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.265829086303711
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.994 Vali Acc: 0.400 Test Loss: 2.994 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.02089524269104
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.026 Vali Acc: 0.400 Test Loss: 3.026 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.213120698928833
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.043 Vali Acc: 0.400 Test Loss: 3.043 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.992781400680542
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.400 Test Loss: 3.051 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1536853313446045
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.056 Vali Acc: 0.400 Test Loss: 3.056 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2797039
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4184722900390625
Epoch: 1, Steps: 7 | Train Loss: 1.623 Vali Loss: 1.345 Vali Acc: 0.440 Test Loss: 1.345 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 0.9635334014892578
Epoch: 2, Steps: 7 | Train Loss: 0.116 Vali Loss: 2.062 Vali Acc: 0.440 Test Loss: 2.062 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0207254886627197
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.287 Vali Acc: 0.520 Test Loss: 2.287 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519977).  Saving model ...
Epoch: 4 cost time: 1.0361270904541016
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.560 Test Loss: 2.045 Test Acc: 0.560
Validation loss decreased (-0.519977 --> -0.559980).  Saving model ...
Epoch: 5 cost time: 1.0216665267944336
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.109 Vali Acc: 0.640 Test Loss: 2.109 Test Acc: 0.640
Validation loss decreased (-0.559980 --> -0.639979).  Saving model ...
Epoch: 6 cost time: 1.159080982208252
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.600 Test Loss: 2.225 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0451858043670654
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.640 Test Loss: 2.303 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0576562881469727
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.600 Test Loss: 2.342 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.119593858718872
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.600 Test Loss: 2.356 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.068803310394287
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.600 Test Loss: 2.355 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.008368968963623
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.600 Test Loss: 2.350 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.982590913772583
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.600 Test Loss: 2.340 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0072658061981201
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.600 Test Loss: 2.332 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0730390548706055
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.325 Vali Acc: 0.600 Test Loss: 2.325 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0689125061035156
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.600 Test Loss: 2.319 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2795503
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.105278253555298
Epoch: 1, Steps: 7 | Train Loss: 1.743 Vali Loss: 1.229 Vali Acc: 0.560 Test Loss: 1.229 Test Acc: 0.560
Validation loss decreased (inf --> -0.559988).  Saving model ...
Epoch: 2 cost time: 0.9895584583282471
Epoch: 2, Steps: 7 | Train Loss: 0.163 Vali Loss: 1.803 Vali Acc: 0.480 Test Loss: 1.803 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9805200099945068
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.374 Vali Acc: 0.480 Test Loss: 2.374 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9094510078430176
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.540 Test Loss: 2.981 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0568456649780273
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.442 Vali Acc: 0.540 Test Loss: 3.442 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0341050624847412
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.728 Vali Acc: 0.540 Test Loss: 3.728 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9694404602050781
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.889 Vali Acc: 0.540 Test Loss: 3.889 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8863821029663086
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.953 Vali Acc: 0.540 Test Loss: 3.953 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9761302471160889
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.982 Vali Acc: 0.540 Test Loss: 3.982 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.84267258644104
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.994 Vali Acc: 0.540 Test Loss: 3.994 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9747827053070068
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.540 Test Loss: 3.998 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2793967
model size : 10.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5923144817352295
Epoch: 1, Steps: 7 | Train Loss: 1.559 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.027808666229248
Epoch: 2, Steps: 7 | Train Loss: 0.136 Vali Loss: 2.123 Vali Acc: 0.540 Test Loss: 2.123 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539979).  Saving model ...
Epoch: 3 cost time: 1.133863925933838
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.331 Vali Acc: 0.460 Test Loss: 2.331 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.178581953048706
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 2.807 Vali Acc: 0.480 Test Loss: 2.807 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0960118770599365
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.209 Vali Acc: 0.420 Test Loss: 4.209 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2022387981414795
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.877 Vali Acc: 0.380 Test Loss: 4.877 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0631952285766602
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.523 Vali Acc: 0.500 Test Loss: 3.523 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9546465873718262
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.560 Test Loss: 3.225 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559968).  Saving model ...
Epoch: 9 cost time: 1.1066486835479736
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.500 Test Loss: 3.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0819742679595947
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.217 Vali Acc: 0.500 Test Loss: 3.217 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0547170639038086
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.160 Vali Acc: 0.480 Test Loss: 3.160 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9512193202972412
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.133 Vali Acc: 0.480 Test Loss: 3.133 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9708888530731201
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.119 Vali Acc: 0.480 Test Loss: 3.119 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0330877304077148
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.112 Vali Acc: 0.480 Test Loss: 3.112 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0136218070983887
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.108 Vali Acc: 0.480 Test Loss: 3.108 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8641636371612549
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.106 Vali Acc: 0.480 Test Loss: 3.106 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.973116397857666
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.104 Vali Acc: 0.480 Test Loss: 3.104 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8250131607055664
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.100 Vali Acc: 0.480 Test Loss: 3.100 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2792943
model size : 10.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.478003740310669
Epoch: 1, Steps: 7 | Train Loss: 1.704 Vali Loss: 1.577 Vali Acc: 0.380 Test Loss: 1.577 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.7376830577850342
Epoch: 2, Steps: 7 | Train Loss: 0.221 Vali Loss: 1.792 Vali Acc: 0.400 Test Loss: 1.792 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.798706293106079
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.718 Vali Acc: 0.420 Test Loss: 2.718 Test Acc: 0.420
Validation loss decreased (-0.399982 --> -0.419973).  Saving model ...
Epoch: 4 cost time: 1.6584975719451904
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.096 Vali Acc: 0.440 Test Loss: 3.096 Test Acc: 0.440
Validation loss decreased (-0.419973 --> -0.439969).  Saving model ...
Epoch: 5 cost time: 2.140774965286255
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.377 Vali Acc: 0.460 Test Loss: 3.377 Test Acc: 0.460
Validation loss decreased (-0.439969 --> -0.459966).  Saving model ...
Epoch: 6 cost time: 2.030231475830078
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.560 Vali Acc: 0.440 Test Loss: 3.560 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8344762325286865
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.670 Vali Acc: 0.420 Test Loss: 3.670 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0495803356170654
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.732 Vali Acc: 0.420 Test Loss: 3.732 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.939037799835205
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.766 Vali Acc: 0.420 Test Loss: 3.766 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8942363262176514
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.784 Vali Acc: 0.420 Test Loss: 3.784 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7321577072143555
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.793 Vali Acc: 0.420 Test Loss: 3.793 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9661271572113037
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.797 Vali Acc: 0.420 Test Loss: 3.797 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7556068897247314
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.798 Vali Acc: 0.420 Test Loss: 3.798 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7626831531524658
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.798 Vali Acc: 0.420 Test Loss: 3.798 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9077973365783691
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.798 Vali Acc: 0.420 Test Loss: 3.798 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2465391
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2605807781219482
Epoch: 1, Steps: 7 | Train Loss: 1.436 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.6644940376281738
Epoch: 2, Steps: 7 | Train Loss: 0.159 Vali Loss: 2.342 Vali Acc: 0.360 Test Loss: 2.342 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6847965717315674
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.878 Vali Acc: 0.460 Test Loss: 2.878 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459971).  Saving model ...
Epoch: 4 cost time: 1.6587159633636475
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.970 Vali Acc: 0.520 Test Loss: 2.970 Test Acc: 0.520
Validation loss decreased (-0.459971 --> -0.519970).  Saving model ...
Epoch: 5 cost time: 1.7105686664581299
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.367 Vali Acc: 0.460 Test Loss: 4.367 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.725792646408081
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.386 Vali Acc: 0.440 Test Loss: 5.386 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.66092848777771
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.949 Vali Acc: 0.440 Test Loss: 5.949 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.600592851638794
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.216 Vali Acc: 0.420 Test Loss: 6.216 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7029881477355957
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.306 Vali Acc: 0.420 Test Loss: 6.306 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8134636878967285
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.302 Vali Acc: 0.420 Test Loss: 6.302 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6848690509796143
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.259 Vali Acc: 0.420 Test Loss: 6.259 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6787099838256836
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.225 Vali Acc: 0.420 Test Loss: 6.225 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6859402656555176
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.198 Vali Acc: 0.420 Test Loss: 6.198 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5930004119873047
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.176 Vali Acc: 0.420 Test Loss: 6.176 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2461807
model size : 9.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7800352573394775
Epoch: 1, Steps: 7 | Train Loss: 1.602 Vali Loss: 1.542 Vali Acc: 0.300 Test Loss: 1.542 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.382373571395874
Epoch: 2, Steps: 7 | Train Loss: 0.247 Vali Loss: 1.786 Vali Acc: 0.400 Test Loss: 1.786 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.4979448318481445
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.347 Vali Acc: 0.500 Test Loss: 2.347 Test Acc: 0.500
Validation loss decreased (-0.399982 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 1.4063720703125
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.459 Vali Acc: 0.540 Test Loss: 3.459 Test Acc: 0.540
Validation loss decreased (-0.499977 --> -0.539965).  Saving model ...
Epoch: 5 cost time: 1.3592314720153809
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.171 Vali Acc: 0.560 Test Loss: 3.171 Test Acc: 0.560
Validation loss decreased (-0.539965 --> -0.559968).  Saving model ...
Epoch: 6 cost time: 1.540093183517456
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.976 Vali Acc: 0.560 Test Loss: 2.976 Test Acc: 0.560
Validation loss decreased (-0.559968 --> -0.559970).  Saving model ...
Epoch: 7 cost time: 1.4001960754394531
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.520 Test Loss: 3.101 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4120526313781738
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.500 Test Loss: 3.243 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.334132432937622
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.336 Vali Acc: 0.500 Test Loss: 3.336 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5175936222076416
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.388 Vali Acc: 0.480 Test Loss: 3.388 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4176652431488037
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.413 Vali Acc: 0.480 Test Loss: 3.413 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4955012798309326
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.422 Vali Acc: 0.480 Test Loss: 3.422 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.430696725845337
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.422 Vali Acc: 0.480 Test Loss: 3.422 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.502856731414795
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.419 Vali Acc: 0.480 Test Loss: 3.419 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.492445707321167
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.416 Vali Acc: 0.480 Test Loss: 3.416 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5114705562591553
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.407 Vali Acc: 0.480 Test Loss: 3.407 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2458735
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9845590591430664
Epoch: 1, Steps: 7 | Train Loss: 1.569 Vali Loss: 1.321 Vali Acc: 0.520 Test Loss: 1.321 Test Acc: 0.520
Validation loss decreased (inf --> -0.519987).  Saving model ...
Epoch: 2 cost time: 1.3196659088134766
Epoch: 2, Steps: 7 | Train Loss: 0.226 Vali Loss: 1.461 Vali Acc: 0.520 Test Loss: 1.461 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3827331066131592
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.293 Vali Acc: 0.380 Test Loss: 2.293 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2795004844665527
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.420 Test Loss: 2.774 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2983174324035645
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.420 Test Loss: 3.021 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.199953556060791
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.156 Vali Acc: 0.420 Test Loss: 3.156 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2828431129455566
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.227 Vali Acc: 0.420 Test Loss: 3.227 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2796435356140137
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.262 Vali Acc: 0.420 Test Loss: 3.262 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2436225414276123
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.279 Vali Acc: 0.420 Test Loss: 3.279 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.209303617477417
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.279 Vali Acc: 0.420 Test Loss: 3.279 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.267585277557373
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.277 Vali Acc: 0.420 Test Loss: 3.277 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2455151
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.57570219039917
Epoch: 1, Steps: 7 | Train Loss: 1.594 Vali Loss: 1.256 Vali Acc: 0.480 Test Loss: 1.256 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.0997207164764404
Epoch: 2, Steps: 7 | Train Loss: 0.127 Vali Loss: 1.553 Vali Acc: 0.580 Test Loss: 1.553 Test Acc: 0.580
Validation loss decreased (-0.479987 --> -0.579984).  Saving model ...
Epoch: 3 cost time: 1.1402008533477783
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.560 Test Loss: 1.857 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1972780227661133
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.520 Test Loss: 2.055 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1648285388946533
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.231 Vali Acc: 0.480 Test Loss: 2.231 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.242393970489502
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.480 Test Loss: 2.349 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3310976028442383
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.480 Test Loss: 2.419 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2197303771972656
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.480 Test Loss: 2.459 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0945539474487305
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.460 Test Loss: 2.479 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.368187427520752
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.490 Vali Acc: 0.460 Test Loss: 2.490 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2159385681152344
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.460 Test Loss: 2.494 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2413036823272705
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.460 Test Loss: 2.495 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2452591
model size : 9.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.508108615875244
Epoch: 1, Steps: 7 | Train Loss: 1.610 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.0478265285491943
Epoch: 2, Steps: 7 | Train Loss: 0.148 Vali Loss: 1.615 Vali Acc: 0.420 Test Loss: 1.615 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419984).  Saving model ...
Epoch: 3 cost time: 1.1094958782196045
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.503 Vali Acc: 0.440 Test Loss: 2.503 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439975).  Saving model ...
Epoch: 4 cost time: 1.187157392501831
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.911 Vali Acc: 0.500 Test Loss: 2.911 Test Acc: 0.500
Validation loss decreased (-0.439975 --> -0.499971).  Saving model ...
Epoch: 5 cost time: 1.019904613494873
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.216 Vali Acc: 0.500 Test Loss: 3.216 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1328880786895752
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.405 Vali Acc: 0.500 Test Loss: 3.405 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.130133867263794
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.515 Vali Acc: 0.520 Test Loss: 3.515 Test Acc: 0.520
Validation loss decreased (-0.499971 --> -0.519965).  Saving model ...
Epoch: 8 cost time: 1.1214244365692139
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.577 Vali Acc: 0.520 Test Loss: 3.577 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9546992778778076
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.610 Vali Acc: 0.520 Test Loss: 3.610 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0896284580230713
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.628 Vali Acc: 0.520 Test Loss: 3.628 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0574002265930176
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.520 Test Loss: 3.638 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1276218891143799
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.642 Vali Acc: 0.520 Test Loss: 3.642 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1792328357696533
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.644 Vali Acc: 0.520 Test Loss: 3.644 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0838665962219238
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.645 Vali Acc: 0.520 Test Loss: 3.645 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.130542278289795
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.646 Vali Acc: 0.520 Test Loss: 3.646 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.074974536895752
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.645 Vali Acc: 0.520 Test Loss: 3.645 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0943777561187744
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.645 Vali Acc: 0.520 Test Loss: 3.645 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2451055
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3717665672302246
Epoch: 1, Steps: 7 | Train Loss: 1.498 Vali Loss: 1.228 Vali Acc: 0.460 Test Loss: 1.228 Test Acc: 0.460
Validation loss decreased (inf --> -0.459988).  Saving model ...
Epoch: 2 cost time: 0.9837114810943604
Epoch: 2, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 0.9698798656463623
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.851 Vali Acc: 0.580 Test Loss: 1.851 Test Acc: 0.580
Validation loss decreased (-0.499982 --> -0.579981).  Saving model ...
Epoch: 4 cost time: 1.0006744861602783
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0762808322906494
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.315 Vali Acc: 0.500 Test Loss: 2.315 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8377397060394287
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.500 Test Loss: 2.446 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9916205406188965
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.523 Vali Acc: 0.500 Test Loss: 2.523 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.919055700302124
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.500 Test Loss: 2.565 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0066306591033936
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.588 Vali Acc: 0.500 Test Loss: 2.588 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9363901615142822
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.600 Vali Acc: 0.500 Test Loss: 2.600 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9255189895629883
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.605 Vali Acc: 0.500 Test Loss: 2.605 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9307241439819336
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.500 Test Loss: 2.607 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9048757553100586
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.500 Test Loss: 2.607 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2449519
model size : 9.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1337664127349854
Epoch: 1, Steps: 7 | Train Loss: 1.637 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 0.8681473731994629
Epoch: 2, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.636 Vali Acc: 0.540 Test Loss: 1.636 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 0.8420228958129883
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.235 Vali Acc: 0.540 Test Loss: 2.235 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8500504493713379
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.734 Vali Acc: 0.520 Test Loss: 2.734 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8328671455383301
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.022 Vali Acc: 0.520 Test Loss: 3.022 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9537758827209473
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.193 Vali Acc: 0.520 Test Loss: 3.193 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9024398326873779
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.290 Vali Acc: 0.520 Test Loss: 3.290 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9101138114929199
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.343 Vali Acc: 0.520 Test Loss: 3.343 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9156014919281006
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.371 Vali Acc: 0.520 Test Loss: 3.371 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8662137985229492
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.385 Vali Acc: 0.520 Test Loss: 3.385 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9182820320129395
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.390 Vali Acc: 0.520 Test Loss: 3.390 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9479432106018066
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.393 Vali Acc: 0.520 Test Loss: 3.393 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2448495
model size : 9.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2016971111297607
Epoch: 1, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.473 Vali Acc: 0.380 Test Loss: 1.473 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 1.5779216289520264
Epoch: 2, Steps: 7 | Train Loss: 0.140 Vali Loss: 1.723 Vali Acc: 0.460 Test Loss: 1.723 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459983).  Saving model ...
Epoch: 3 cost time: 1.6109557151794434
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.954 Vali Acc: 0.520 Test Loss: 1.954 Test Acc: 0.520
Validation loss decreased (-0.459983 --> -0.519980).  Saving model ...
Epoch: 4 cost time: 1.597860336303711
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.580 Test Loss: 2.135 Test Acc: 0.580
Validation loss decreased (-0.519980 --> -0.579979).  Saving model ...
Epoch: 5 cost time: 1.6839966773986816
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.286 Vali Acc: 0.580 Test Loss: 2.286 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5192866325378418
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.384 Vali Acc: 0.580 Test Loss: 2.384 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.616821050643921
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.580 Test Loss: 2.442 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5364081859588623
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.580 Test Loss: 2.475 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7427020072937012
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.493 Vali Acc: 0.580 Test Loss: 2.493 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5577929019927979
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.580 Test Loss: 2.503 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8309450149536133
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.580 Test Loss: 2.509 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7721590995788574
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.512 Vali Acc: 0.580 Test Loss: 2.512 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.75111985206604
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.514 Vali Acc: 0.580 Test Loss: 2.514 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7043797969818115
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.515 Vali Acc: 0.580 Test Loss: 2.515 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2293167
model size : 8.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.045867443084717
Epoch: 1, Steps: 7 | Train Loss: 1.531 Vali Loss: 1.290 Vali Acc: 0.420 Test Loss: 1.290 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.7160415649414062
Epoch: 2, Steps: 7 | Train Loss: 0.192 Vali Loss: 1.784 Vali Acc: 0.420 Test Loss: 1.784 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5373671054840088
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.500 Test Loss: 2.178 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 1.610598087310791
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.577 Vali Acc: 0.520 Test Loss: 2.577 Test Acc: 0.520
Validation loss decreased (-0.499978 --> -0.519974).  Saving model ...
Epoch: 5 cost time: 1.6128647327423096
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.480 Test Loss: 2.858 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6074316501617432
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.035 Vali Acc: 0.480 Test Loss: 3.035 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5228805541992188
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.139 Vali Acc: 0.480 Test Loss: 3.139 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.440061330795288
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.198 Vali Acc: 0.480 Test Loss: 3.198 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.524780511856079
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.230 Vali Acc: 0.480 Test Loss: 3.230 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5476739406585693
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.247 Vali Acc: 0.480 Test Loss: 3.247 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4456782341003418
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.256 Vali Acc: 0.480 Test Loss: 3.256 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6151227951049805
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.260 Vali Acc: 0.480 Test Loss: 3.260 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4212098121643066
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.480 Test Loss: 3.263 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3938970565795898
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.480 Test Loss: 3.263 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2289583
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.982853889465332
Epoch: 1, Steps: 7 | Train Loss: 1.661 Vali Loss: 1.347 Vali Acc: 0.360 Test Loss: 1.347 Test Acc: 0.360
Validation loss decreased (inf --> -0.359987).  Saving model ...
Epoch: 2 cost time: 1.3845798969268799
Epoch: 2, Steps: 7 | Train Loss: 0.215 Vali Loss: 1.951 Vali Acc: 0.480 Test Loss: 1.951 Test Acc: 0.480
Validation loss decreased (-0.359987 --> -0.479980).  Saving model ...
Epoch: 3 cost time: 1.437915563583374
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.840 Vali Acc: 0.480 Test Loss: 1.840 Test Acc: 0.480
Validation loss decreased (-0.479980 --> -0.479982).  Saving model ...
Epoch: 4 cost time: 1.4295883178710938
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.688 Vali Acc: 0.520 Test Loss: 2.688 Test Acc: 0.520
Validation loss decreased (-0.479982 --> -0.519973).  Saving model ...
Epoch: 5 cost time: 1.5072920322418213
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.698 Vali Acc: 0.500 Test Loss: 3.698 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.486581563949585
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.226 Vali Acc: 0.460 Test Loss: 4.226 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3582072257995605
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.224 Vali Acc: 0.460 Test Loss: 4.224 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4599545001983643
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.181 Vali Acc: 0.480 Test Loss: 4.181 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.521843433380127
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.480 Test Loss: 4.149 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5260496139526367
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.125 Vali Acc: 0.480 Test Loss: 4.125 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3539226055145264
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.109 Vali Acc: 0.480 Test Loss: 4.109 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.431819200515747
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.096 Vali Acc: 0.480 Test Loss: 4.096 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3786656856536865
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.081 Vali Acc: 0.480 Test Loss: 4.081 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4569480419158936
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.069 Vali Acc: 0.480 Test Loss: 4.069 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2286511
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7808878421783447
Epoch: 1, Steps: 7 | Train Loss: 1.609 Vali Loss: 1.590 Vali Acc: 0.320 Test Loss: 1.590 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.4112203121185303
Epoch: 2, Steps: 7 | Train Loss: 0.254 Vali Loss: 1.779 Vali Acc: 0.400 Test Loss: 1.779 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.4853694438934326
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.460 Test Loss: 1.792 Test Acc: 0.460
Validation loss decreased (-0.399982 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 1.365013837814331
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.460 Test Loss: 2.120 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3712823390960693
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.520 Test Loss: 2.413 Test Acc: 0.520
Validation loss decreased (-0.459982 --> -0.519976).  Saving model ...
Epoch: 6 cost time: 1.4241633415222168
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.602 Vali Acc: 0.500 Test Loss: 2.602 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.445986270904541
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.500 Test Loss: 2.714 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4048850536346436
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.777 Vali Acc: 0.500 Test Loss: 2.777 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4706788063049316
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.811 Vali Acc: 0.500 Test Loss: 2.811 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5321462154388428
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.830 Vali Acc: 0.500 Test Loss: 2.830 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4545485973358154
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.500 Test Loss: 2.839 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4695031642913818
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.500 Test Loss: 2.844 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5502512454986572
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.500 Test Loss: 2.846 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.507767915725708
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.500 Test Loss: 2.847 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.495032548904419
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.500 Test Loss: 2.847 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2282927
model size : 8.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3540375232696533
Epoch: 1, Steps: 7 | Train Loss: 1.665 Vali Loss: 1.513 Vali Acc: 0.360 Test Loss: 1.513 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 0.924851655960083
Epoch: 2, Steps: 7 | Train Loss: 0.333 Vali Loss: 1.414 Vali Acc: 0.520 Test Loss: 1.414 Test Acc: 0.520
Validation loss decreased (-0.359985 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 1.0665061473846436
Epoch: 3, Steps: 7 | Train Loss: 0.078 Vali Loss: 1.620 Vali Acc: 0.560 Test Loss: 1.620 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559984).  Saving model ...
Epoch: 4 cost time: 1.0474941730499268
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.217 Vali Acc: 0.460 Test Loss: 3.217 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0276880264282227
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.271 Vali Acc: 0.440 Test Loss: 4.271 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1655426025390625
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.333 Vali Acc: 0.440 Test Loss: 4.333 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0253863334655762
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.303 Vali Acc: 0.420 Test Loss: 4.303 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0559353828430176
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.293 Vali Acc: 0.420 Test Loss: 4.293 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2721202373504639
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.290 Vali Acc: 0.420 Test Loss: 4.290 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2135882377624512
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.287 Vali Acc: 0.420 Test Loss: 4.287 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1496186256408691
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.284 Vali Acc: 0.420 Test Loss: 4.284 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1759464740753174
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.282 Vali Acc: 0.420 Test Loss: 4.282 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0844149589538574
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.278 Vali Acc: 0.420 Test Loss: 4.278 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2280367
model size : 8.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.772529363632202
Epoch: 1, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.371 Vali Acc: 0.360 Test Loss: 1.371 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.0908045768737793
Epoch: 2, Steps: 7 | Train Loss: 0.339 Vali Loss: 2.123 Vali Acc: 0.480 Test Loss: 2.123 Test Acc: 0.480
Validation loss decreased (-0.359986 --> -0.479979).  Saving model ...
Epoch: 3 cost time: 1.2167587280273438
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
Validation loss decreased (-0.479979 --> -0.539985).  Saving model ...
Epoch: 4 cost time: 1.0979511737823486
Epoch: 4, Steps: 7 | Train Loss: 0.025 Vali Loss: 3.983 Vali Acc: 0.360 Test Loss: 3.983 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1848900318145752
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.528 Vali Acc: 0.420 Test Loss: 4.528 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0956263542175293
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.340 Test Loss: 4.882 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0950322151184082
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.113 Vali Acc: 0.400 Test Loss: 5.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9752287864685059
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.160 Vali Acc: 0.400 Test Loss: 5.160 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1505110263824463
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.095 Vali Acc: 0.420 Test Loss: 5.095 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9941723346710205
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.006 Vali Acc: 0.400 Test Loss: 5.006 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1175003051757812
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.953 Vali Acc: 0.400 Test Loss: 4.953 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0574133396148682
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.915 Vali Acc: 0.400 Test Loss: 4.915 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.111619234085083
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.891 Vali Acc: 0.400 Test Loss: 4.891 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2278831
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.114197254180908
Epoch: 1, Steps: 7 | Train Loss: 1.594 Vali Loss: 1.353 Vali Acc: 0.420 Test Loss: 1.353 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 0.8943881988525391
Epoch: 2, Steps: 7 | Train Loss: 0.236 Vali Loss: 2.250 Vali Acc: 0.440 Test Loss: 2.250 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439978).  Saving model ...
Epoch: 3 cost time: 0.8864405155181885
Epoch: 3, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.986 Vali Acc: 0.520 Test Loss: 1.986 Test Acc: 0.520
Validation loss decreased (-0.439978 --> -0.519980).  Saving model ...
Epoch: 4 cost time: 0.8138656616210938
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.580 Test Loss: 2.407 Test Acc: 0.580
Validation loss decreased (-0.519980 --> -0.579976).  Saving model ...
Epoch: 5 cost time: 0.8783547878265381
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.821 Vali Acc: 0.600 Test Loss: 2.821 Test Acc: 0.600
Validation loss decreased (-0.579976 --> -0.599972).  Saving model ...
Epoch: 6 cost time: 0.8765623569488525
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.065 Vali Acc: 0.580 Test Loss: 3.065 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8900790214538574
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.206 Vali Acc: 0.580 Test Loss: 3.206 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0587491989135742
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.283 Vali Acc: 0.580 Test Loss: 3.283 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9754765033721924
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.322 Vali Acc: 0.580 Test Loss: 3.322 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.892399787902832
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.343 Vali Acc: 0.580 Test Loss: 3.343 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9095401763916016
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.352 Vali Acc: 0.580 Test Loss: 3.352 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9844987392425537
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.580 Test Loss: 3.355 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9851689338684082
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.580 Test Loss: 3.356 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9447841644287109
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.353 Vali Acc: 0.580 Test Loss: 3.353 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0779664516448975
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.351 Vali Acc: 0.580 Test Loss: 3.351 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2277295
model size : 8.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1496124267578125
Epoch: 1, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.435 Vali Acc: 0.320 Test Loss: 1.435 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.0012176036834717
Epoch: 2, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.954 Vali Acc: 0.480 Test Loss: 1.954 Test Acc: 0.480
Validation loss decreased (-0.319986 --> -0.479980).  Saving model ...
Epoch: 3 cost time: 0.9993076324462891
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.560 Test Loss: 1.688 Test Acc: 0.560
Validation loss decreased (-0.479980 --> -0.559983).  Saving model ...
Epoch: 4 cost time: 0.9430158138275146
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.130 Vali Acc: 0.540 Test Loss: 2.130 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9684584140777588
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.468 Vali Acc: 0.540 Test Loss: 2.468 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9605846405029297
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.670 Vali Acc: 0.540 Test Loss: 2.670 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9896688461303711
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.772 Vali Acc: 0.520 Test Loss: 2.772 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1482741832733154
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.799 Vali Acc: 0.520 Test Loss: 2.799 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.098618745803833
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.520 Test Loss: 2.812 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1753113269805908
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.819 Vali Acc: 0.520 Test Loss: 2.819 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.406529426574707
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.540 Test Loss: 2.820 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9905328750610352
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.540 Test Loss: 2.818 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.97548508644104
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.816 Vali Acc: 0.540 Test Loss: 2.816 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2276271
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2772655487060547
Epoch: 1, Steps: 7 | Train Loss: 1.622 Vali Loss: 1.477 Vali Acc: 0.400 Test Loss: 1.477 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.78776216506958
Epoch: 2, Steps: 7 | Train Loss: 0.514 Vali Loss: 2.092 Vali Acc: 0.480 Test Loss: 2.092 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479979).  Saving model ...
Epoch: 3 cost time: 1.9308998584747314
Epoch: 3, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.138 Vali Acc: 0.460 Test Loss: 2.138 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8715314865112305
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.329 Vali Acc: 0.360 Test Loss: 3.329 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9412496089935303
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.563 Vali Acc: 0.320 Test Loss: 4.563 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.936286449432373
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.821 Vali Acc: 0.340 Test Loss: 4.821 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.740584373474121
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.657 Vali Acc: 0.340 Test Loss: 4.657 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9046599864959717
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.518 Vali Acc: 0.340 Test Loss: 4.518 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8188927173614502
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.423 Vali Acc: 0.380 Test Loss: 4.423 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1071159839630127
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.370 Vali Acc: 0.420 Test Loss: 4.370 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.031038284301758
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.339 Vali Acc: 0.420 Test Loss: 4.339 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0426316261291504
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.322 Vali Acc: 0.420 Test Loss: 4.322 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2207055
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.971754789352417
Epoch: 1, Steps: 7 | Train Loss: 1.654 Vali Loss: 1.346 Vali Acc: 0.440 Test Loss: 1.346 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.5505845546722412
Epoch: 2, Steps: 7 | Train Loss: 0.236 Vali Loss: 2.524 Vali Acc: 0.420 Test Loss: 2.524 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6873245239257812
Epoch: 3, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.335 Vali Acc: 0.580 Test Loss: 1.335 Test Acc: 0.580
Validation loss decreased (-0.439987 --> -0.579987).  Saving model ...
Epoch: 4 cost time: 1.4843223094940186
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.697 Vali Acc: 0.500 Test Loss: 1.697 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5419330596923828
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.500 Test Loss: 2.334 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6375675201416016
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.460 Test Loss: 3.143 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5430653095245361
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.614 Vali Acc: 0.460 Test Loss: 3.614 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5679268836975098
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.710 Vali Acc: 0.460 Test Loss: 3.710 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4943203926086426
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.684 Vali Acc: 0.460 Test Loss: 3.684 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5151634216308594
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.650 Vali Acc: 0.460 Test Loss: 3.650 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4705805778503418
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.618 Vali Acc: 0.480 Test Loss: 3.618 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6441104412078857
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.591 Vali Acc: 0.480 Test Loss: 3.591 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8272192478179932
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.567 Vali Acc: 0.480 Test Loss: 3.567 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2203471
model size : 8.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.964233875274658
Epoch: 1, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.620 Vali Acc: 0.360 Test Loss: 1.620 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.4713530540466309
Epoch: 2, Steps: 7 | Train Loss: 0.314 Vali Loss: 2.155 Vali Acc: 0.320 Test Loss: 2.155 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3701441287994385
Epoch: 3, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.903 Vali Acc: 0.480 Test Loss: 1.903 Test Acc: 0.480
Validation loss decreased (-0.359984 --> -0.479981).  Saving model ...
Epoch: 4 cost time: 1.4528403282165527
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.825 Vali Acc: 0.540 Test Loss: 2.825 Test Acc: 0.540
Validation loss decreased (-0.479981 --> -0.539972).  Saving model ...
Epoch: 5 cost time: 1.4382715225219727
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.660 Vali Acc: 0.500 Test Loss: 2.660 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4302396774291992
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.723 Vali Acc: 0.540 Test Loss: 2.723 Test Acc: 0.540
Validation loss decreased (-0.539972 --> -0.539973).  Saving model ...
Epoch: 7 cost time: 1.4040699005126953
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.822 Vali Acc: 0.560 Test Loss: 2.822 Test Acc: 0.560
Validation loss decreased (-0.539973 --> -0.559972).  Saving model ...
Epoch: 8 cost time: 1.4172616004943848
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.892 Vali Acc: 0.560 Test Loss: 2.892 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2897346019744873
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.580 Test Loss: 2.934 Test Acc: 0.580
Validation loss decreased (-0.559972 --> -0.579971).  Saving model ...
Epoch: 10 cost time: 1.2801978588104248
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.958 Vali Acc: 0.560 Test Loss: 2.958 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2929506301879883
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.970 Vali Acc: 0.580 Test Loss: 2.970 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3828773498535156
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.977 Vali Acc: 0.580 Test Loss: 2.977 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2631981372833252
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.980 Vali Acc: 0.580 Test Loss: 2.980 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5134987831115723
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.580 Test Loss: 2.981 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2965898513793945
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.982 Vali Acc: 0.580 Test Loss: 2.982 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4457919597625732
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.982 Vali Acc: 0.580 Test Loss: 2.982 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4386036396026611
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.982 Vali Acc: 0.580 Test Loss: 2.982 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5281031131744385
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.580 Test Loss: 2.981 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.35530424118042
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.580 Test Loss: 2.981 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2200399
model size : 8.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.812504291534424
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.586 Vali Acc: 0.420 Test Loss: 1.586 Test Acc: 0.420
Validation loss decreased (inf --> -0.419984).  Saving model ...
Epoch: 2 cost time: 1.3127539157867432
Epoch: 2, Steps: 7 | Train Loss: 0.413 Vali Loss: 1.703 Vali Acc: 0.480 Test Loss: 1.703 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479983).  Saving model ...
Epoch: 3 cost time: 1.3982822895050049
Epoch: 3, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.963 Vali Acc: 0.420 Test Loss: 1.963 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3010447025299072
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.610 Vali Acc: 0.460 Test Loss: 2.610 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4093236923217773
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.471 Vali Acc: 0.440 Test Loss: 3.471 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2894012928009033
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.380 Test Loss: 3.998 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.269442081451416
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.307 Vali Acc: 0.360 Test Loss: 4.307 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3460907936096191
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.479 Vali Acc: 0.360 Test Loss: 4.479 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2226626873016357
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.562 Vali Acc: 0.360 Test Loss: 4.562 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2395317554473877
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.603 Vali Acc: 0.360 Test Loss: 4.603 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3659117221832275
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.620 Vali Acc: 0.360 Test Loss: 4.620 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3017938137054443
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.623 Vali Acc: 0.360 Test Loss: 4.623 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2196815
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.555757999420166
Epoch: 1, Steps: 7 | Train Loss: 1.632 Vali Loss: 1.330 Vali Acc: 0.420 Test Loss: 1.330 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.211165189743042
Epoch: 2, Steps: 7 | Train Loss: 0.363 Vali Loss: 2.203 Vali Acc: 0.520 Test Loss: 2.203 Test Acc: 0.520
Validation loss decreased (-0.419987 --> -0.519978).  Saving model ...
Epoch: 3 cost time: 1.0275661945343018
Epoch: 3, Steps: 7 | Train Loss: 0.098 Vali Loss: 1.730 Vali Acc: 0.460 Test Loss: 1.730 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1447479724884033
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.942 Vali Acc: 0.560 Test Loss: 1.942 Test Acc: 0.560
Validation loss decreased (-0.519978 --> -0.559981).  Saving model ...
Epoch: 5 cost time: 1.0778779983520508
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.852 Vali Acc: 0.460 Test Loss: 2.852 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1491951942443848
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.717 Vali Acc: 0.460 Test Loss: 3.717 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0793616771697998
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.815 Vali Acc: 0.480 Test Loss: 3.815 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2264363765716553
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.047 Vali Acc: 0.500 Test Loss: 4.047 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1444423198699951
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.243 Vali Acc: 0.500 Test Loss: 4.243 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0960538387298584
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.372 Vali Acc: 0.500 Test Loss: 4.372 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1848433017730713
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.446 Vali Acc: 0.500 Test Loss: 4.446 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.166616678237915
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.475 Vali Acc: 0.480 Test Loss: 4.475 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1944925785064697
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.482 Vali Acc: 0.480 Test Loss: 4.482 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1618053913116455
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.475 Vali Acc: 0.480 Test Loss: 4.475 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2194255
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4339091777801514
Epoch: 1, Steps: 7 | Train Loss: 1.662 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.9871816635131836
Epoch: 2, Steps: 7 | Train Loss: 0.220 Vali Loss: 1.887 Vali Acc: 0.440 Test Loss: 1.887 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0562467575073242
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.540 Test Loss: 1.757 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 1.0183773040771484
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.580 Test Loss: 1.895 Test Acc: 0.580
Validation loss decreased (-0.539982 --> -0.579981).  Saving model ...
Epoch: 5 cost time: 1.0509963035583496
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.560 Test Loss: 2.019 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.024230718612671
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.100 Vali Acc: 0.600 Test Loss: 2.100 Test Acc: 0.600
Validation loss decreased (-0.579981 --> -0.599979).  Saving model ...
Epoch: 7 cost time: 1.1118128299713135
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.147 Vali Acc: 0.600 Test Loss: 2.147 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0764110088348389
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.640 Test Loss: 2.173 Test Acc: 0.640
Validation loss decreased (-0.599979 --> -0.639978).  Saving model ...
Epoch: 9 cost time: 1.052130937576294
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.187 Vali Acc: 0.640 Test Loss: 2.187 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.10542631149292
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.640 Test Loss: 2.194 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0625653266906738
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.640 Test Loss: 2.197 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9877498149871826
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.640 Test Loss: 2.198 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.109753131866455
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.640 Test Loss: 2.198 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1677024364471436
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.640 Test Loss: 2.198 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.081045150756836
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.640 Test Loss: 2.197 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0529983043670654
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.620 Test Loss: 2.196 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2389411926269531
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.620 Test Loss: 2.195 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.109083890914917
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.620 Test Loss: 2.195 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2192719
model size : 8.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.334371328353882
Epoch: 1, Steps: 7 | Train Loss: 1.652 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 0.886110782623291
Epoch: 2, Steps: 7 | Train Loss: 0.278 Vali Loss: 2.138 Vali Acc: 0.440 Test Loss: 2.138 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8953597545623779
Epoch: 3, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.458 Vali Acc: 0.660 Test Loss: 1.458 Test Acc: 0.660
Validation loss decreased (-0.459987 --> -0.659985).  Saving model ...
Epoch: 4 cost time: 0.8780412673950195
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.580 Test Loss: 2.260 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9043359756469727
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.540 Test Loss: 2.698 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8439033031463623
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.701 Vali Acc: 0.520 Test Loss: 2.701 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8775863647460938
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.715 Vali Acc: 0.500 Test Loss: 2.715 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8409805297851562
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.725 Vali Acc: 0.480 Test Loss: 2.725 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9260714054107666
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.500 Test Loss: 2.731 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8839898109436035
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.500 Test Loss: 2.733 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.721794843673706
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.500 Test Loss: 2.733 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9155793190002441
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.500 Test Loss: 2.732 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0357937812805176
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.500 Test Loss: 2.731 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2191183
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.167398691177368
Epoch: 1, Steps: 7 | Train Loss: 1.474 Vali Loss: 1.234 Vali Acc: 0.440 Test Loss: 1.234 Test Acc: 0.440
Validation loss decreased (inf --> -0.439988).  Saving model ...
Epoch: 2 cost time: 0.6870975494384766
Epoch: 2, Steps: 7 | Train Loss: 0.182 Vali Loss: 1.677 Vali Acc: 0.580 Test Loss: 1.677 Test Acc: 0.580
Validation loss decreased (-0.439988 --> -0.579983).  Saving model ...
Epoch: 3 cost time: 0.666398286819458
Epoch: 3, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.377 Vali Acc: 0.500 Test Loss: 2.377 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7207891941070557
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.580 Test Loss: 2.027 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9824337959289551
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.838 Vali Acc: 0.560 Test Loss: 2.838 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8290150165557861
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.431 Vali Acc: 0.520 Test Loss: 3.431 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8256280422210693
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.667 Vali Acc: 0.580 Test Loss: 2.667 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9909124374389648
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.939 Vali Acc: 0.480 Test Loss: 2.939 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8431973457336426
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.495 Vali Acc: 0.500 Test Loss: 3.495 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9048702716827393
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.804 Vali Acc: 0.520 Test Loss: 2.804 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8575010299682617
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.656 Vali Acc: 0.540 Test Loss: 2.656 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.835731029510498
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.646 Vali Acc: 0.560 Test Loss: 2.646 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2190159
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2832717895507812
Epoch: 1, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.7298178672790527
Epoch: 2, Steps: 7 | Train Loss: 0.300 Vali Loss: 2.142 Vali Acc: 0.460 Test Loss: 2.142 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459979).  Saving model ...
Epoch: 3 cost time: 1.9824929237365723
Epoch: 3, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.268 Vali Acc: 0.460 Test Loss: 2.268 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.777616262435913
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.327 Vali Acc: 0.460 Test Loss: 3.327 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9916119575500488
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.054 Vali Acc: 0.440 Test Loss: 4.054 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7621450424194336
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.296 Vali Acc: 0.440 Test Loss: 4.296 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.858173131942749
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.330 Vali Acc: 0.440 Test Loss: 4.330 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7826306819915771
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.313 Vali Acc: 0.420 Test Loss: 4.313 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8067035675048828
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.251 Vali Acc: 0.420 Test Loss: 4.251 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6570017337799072
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.200 Vali Acc: 0.420 Test Loss: 4.200 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.857893943786621
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.172 Vali Acc: 0.420 Test Loss: 4.172 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9341988563537598
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.155 Vali Acc: 0.420 Test Loss: 4.155 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2163999
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2932653427124023
Epoch: 1, Steps: 7 | Train Loss: 1.667 Vali Loss: 1.281 Vali Acc: 0.460 Test Loss: 1.281 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 1.675309181213379
Epoch: 2, Steps: 7 | Train Loss: 0.213 Vali Loss: 1.306 Vali Acc: 0.560 Test Loss: 1.306 Test Acc: 0.560
Validation loss decreased (-0.459987 --> -0.559987).  Saving model ...
Epoch: 3 cost time: 1.580644130706787
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.045 Vali Acc: 0.500 Test Loss: 2.045 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.578582525253296
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.548 Vali Acc: 0.480 Test Loss: 3.548 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.779273271560669
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.257 Vali Acc: 0.440 Test Loss: 3.257 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6232635974884033
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.460 Test Loss: 3.265 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6639971733093262
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.281 Vali Acc: 0.460 Test Loss: 3.281 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6604177951812744
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.139 Vali Acc: 0.460 Test Loss: 3.139 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6205689907073975
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.062 Vali Acc: 0.460 Test Loss: 3.062 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5020179748535156
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.020 Vali Acc: 0.460 Test Loss: 3.020 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7005908489227295
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.996 Vali Acc: 0.480 Test Loss: 2.996 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5591094493865967
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.500 Test Loss: 2.981 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2160415
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.09157133102417
Epoch: 1, Steps: 7 | Train Loss: 1.654 Vali Loss: 1.429 Vali Acc: 0.380 Test Loss: 1.429 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.5184392929077148
Epoch: 2, Steps: 7 | Train Loss: 0.310 Vali Loss: 1.879 Vali Acc: 0.480 Test Loss: 1.879 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479981).  Saving model ...
Epoch: 3 cost time: 1.4062509536743164
Epoch: 3, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.808 Vali Acc: 0.480 Test Loss: 1.808 Test Acc: 0.480
Validation loss decreased (-0.479981 --> -0.479982).  Saving model ...
Epoch: 4 cost time: 1.466792345046997
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.940 Vali Acc: 0.340 Test Loss: 2.940 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.464848279953003
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.380 Test Loss: 2.691 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.549609899520874
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.627 Vali Acc: 0.420 Test Loss: 2.627 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4801907539367676
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.628 Vali Acc: 0.440 Test Loss: 2.628 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4812185764312744
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.460 Test Loss: 2.639 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5191709995269775
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.649 Vali Acc: 0.460 Test Loss: 2.649 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.453777551651001
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.655 Vali Acc: 0.460 Test Loss: 2.655 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4027881622314453
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.657 Vali Acc: 0.460 Test Loss: 2.657 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4572806358337402
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.460 Test Loss: 2.658 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3393237590789795
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.460 Test Loss: 2.658 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2157343
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.762171745300293
Epoch: 1, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.362 Vali Acc: 0.360 Test Loss: 1.362 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.2833399772644043
Epoch: 2, Steps: 7 | Train Loss: 0.271 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
Validation loss decreased (-0.359986 --> -0.419984).  Saving model ...
Epoch: 3 cost time: 1.2783465385437012
Epoch: 3, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.889 Vali Acc: 0.480 Test Loss: 1.889 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479981).  Saving model ...
Epoch: 4 cost time: 1.130629539489746
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.479 Vali Acc: 0.420 Test Loss: 3.479 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1344456672668457
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.190 Vali Acc: 0.460 Test Loss: 4.190 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1692986488342285
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.668 Vali Acc: 0.440 Test Loss: 4.668 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2420902252197266
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.922 Vali Acc: 0.440 Test Loss: 4.922 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1791746616363525
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.034 Vali Acc: 0.440 Test Loss: 5.034 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.239086389541626
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.069 Vali Acc: 0.440 Test Loss: 5.069 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1540236473083496
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.073 Vali Acc: 0.440 Test Loss: 5.073 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2691454887390137
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.052 Vali Acc: 0.440 Test Loss: 5.052 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.163966417312622
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.030 Vali Acc: 0.440 Test Loss: 5.030 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2496721744537354
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.006 Vali Acc: 0.440 Test Loss: 5.006 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2153759
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5266714096069336
Epoch: 1, Steps: 7 | Train Loss: 1.592 Vali Loss: 1.440 Vali Acc: 0.320 Test Loss: 1.440 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.1698322296142578
Epoch: 2, Steps: 7 | Train Loss: 0.297 Vali Loss: 2.031 Vali Acc: 0.460 Test Loss: 2.031 Test Acc: 0.460
Validation loss decreased (-0.319986 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 1.1813623905181885
Epoch: 3, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
Validation loss decreased (-0.459980 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.1849250793457031
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1501271724700928
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.154 Vali Acc: 0.520 Test Loss: 2.154 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519978).  Saving model ...
Epoch: 6 cost time: 1.0603888034820557
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.520 Test Loss: 2.538 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1402325630187988
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.500 Test Loss: 2.828 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1199638843536377
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.003 Vali Acc: 0.460 Test Loss: 3.003 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1430141925811768
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.093 Vali Acc: 0.440 Test Loss: 3.093 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.140557050704956
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.124 Vali Acc: 0.440 Test Loss: 3.124 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0544934272766113
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.124 Vali Acc: 0.440 Test Loss: 3.124 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2300832271575928
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.114 Vali Acc: 0.460 Test Loss: 3.114 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1015045642852783
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.098 Vali Acc: 0.460 Test Loss: 3.098 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1843655109405518
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.460 Test Loss: 3.077 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2056140899658203
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.055 Vali Acc: 0.460 Test Loss: 3.055 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2151199
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3574156761169434
Epoch: 1, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.415 Vali Acc: 0.300 Test Loss: 1.415 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9688003063201904
Epoch: 2, Steps: 7 | Train Loss: 0.311 Vali Loss: 1.870 Vali Acc: 0.360 Test Loss: 1.870 Test Acc: 0.360
Validation loss decreased (-0.299986 --> -0.359981).  Saving model ...
Epoch: 3 cost time: 1.0818965435028076
Epoch: 3, Steps: 7 | Train Loss: 0.094 Vali Loss: 2.202 Vali Acc: 0.540 Test Loss: 2.202 Test Acc: 0.540
Validation loss decreased (-0.359981 --> -0.539978).  Saving model ...
Epoch: 4 cost time: 1.114583969116211
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.237 Vali Acc: 0.560 Test Loss: 3.237 Test Acc: 0.560
Validation loss decreased (-0.539978 --> -0.559968).  Saving model ...
Epoch: 5 cost time: 1.0183801651000977
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.520 Test Loss: 2.324 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.961188554763794
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.600 Test Loss: 2.481 Test Acc: 0.600
Validation loss decreased (-0.559968 --> -0.599975).  Saving model ...
Epoch: 7 cost time: 1.1519560813903809
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.643 Vali Acc: 0.600 Test Loss: 2.643 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1003334522247314
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.713 Vali Acc: 0.600 Test Loss: 2.713 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0898196697235107
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.756 Vali Acc: 0.620 Test Loss: 2.756 Test Acc: 0.620
Validation loss decreased (-0.599975 --> -0.619972).  Saving model ...
Epoch: 10 cost time: 1.2098145484924316
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.600 Test Loss: 2.781 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.044914960861206
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.793 Vali Acc: 0.600 Test Loss: 2.793 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0582213401794434
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.799 Vali Acc: 0.600 Test Loss: 2.799 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1130051612854004
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.801 Vali Acc: 0.600 Test Loss: 2.801 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0803284645080566
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.600 Test Loss: 2.800 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1370911598205566
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.799 Vali Acc: 0.600 Test Loss: 2.799 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0678298473358154
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.797 Vali Acc: 0.600 Test Loss: 2.797 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.210336446762085
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.795 Vali Acc: 0.600 Test Loss: 2.795 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.064927339553833
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.792 Vali Acc: 0.600 Test Loss: 2.792 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.218482255935669
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.790 Vali Acc: 0.620 Test Loss: 2.790 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2149663
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.236804246902466
Epoch: 1, Steps: 7 | Train Loss: 1.752 Vali Loss: 1.511 Vali Acc: 0.360 Test Loss: 1.511 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.0506596565246582
Epoch: 2, Steps: 7 | Train Loss: 0.375 Vali Loss: 1.983 Vali Acc: 0.380 Test Loss: 1.983 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379980).  Saving model ...
Epoch: 3 cost time: 1.010490894317627
Epoch: 3, Steps: 7 | Train Loss: 0.188 Vali Loss: 2.207 Vali Acc: 0.480 Test Loss: 2.207 Test Acc: 0.480
Validation loss decreased (-0.379980 --> -0.479978).  Saving model ...
Epoch: 4 cost time: 0.8831601142883301
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.336 Vali Acc: 0.440 Test Loss: 4.336 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9174730777740479
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.127 Vali Acc: 0.480 Test Loss: 3.127 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.236217737197876
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.560 Test Loss: 2.086 Test Acc: 0.560
Validation loss decreased (-0.479978 --> -0.559979).  Saving model ...
Epoch: 7 cost time: 0.8887588977813721
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.540 Test Loss: 2.479 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0652751922607422
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.500 Test Loss: 2.818 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9473667144775391
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.914 Vali Acc: 0.500 Test Loss: 2.914 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.08876371383667
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.500 Test Loss: 2.869 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1318438053131104
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.520 Test Loss: 2.844 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9972949028015137
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.520 Test Loss: 2.828 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1113579273223877
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.520 Test Loss: 2.818 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0820653438568115
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.520 Test Loss: 2.812 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2108609676361084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.807 Vali Acc: 0.520 Test Loss: 2.807 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0389022827148438
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.520 Test Loss: 2.802 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2148127
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2900142669677734
Epoch: 1, Steps: 7 | Train Loss: 1.630 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 0.8915393352508545
Epoch: 2, Steps: 7 | Train Loss: 0.573 Vali Loss: 1.723 Vali Acc: 0.500 Test Loss: 1.723 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 0.8689348697662354
Epoch: 3, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.945 Vali Acc: 0.540 Test Loss: 1.945 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539981).  Saving model ...
Epoch: 4 cost time: 0.9714961051940918
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.319 Vali Acc: 0.540 Test Loss: 3.319 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8387343883514404
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.324 Vali Acc: 0.540 Test Loss: 3.324 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.912431001663208
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.079 Vali Acc: 0.540 Test Loss: 4.079 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9213676452636719
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.745 Vali Acc: 0.680 Test Loss: 2.745 Test Acc: 0.680
Validation loss decreased (-0.539981 --> -0.679973).  Saving model ...
Epoch: 8 cost time: 0.9578931331634521
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.859 Vali Acc: 0.520 Test Loss: 3.859 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9537348747253418
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.141 Vali Acc: 0.600 Test Loss: 3.141 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.975433349609375
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.596 Vali Acc: 0.460 Test Loss: 7.596 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9447207450866699
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.110 Vali Acc: 0.600 Test Loss: 3.110 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9661195278167725
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.787 Vali Acc: 0.460 Test Loss: 4.787 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.004634141921997
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.215 Vali Acc: 0.420 Test Loss: 6.215 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8855886459350586
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.687 Vali Acc: 0.460 Test Loss: 4.687 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9263324737548828
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.338 Vali Acc: 0.520 Test Loss: 5.338 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1082038879394531
Epoch: 16, Steps: 7 | Train Loss: 0.068 Vali Loss: 4.321 Vali Acc: 0.600 Test Loss: 4.321 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1764037609100342
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.475 Vali Acc: 0.520 Test Loss: 5.475 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 2147103
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3915607929229736
Epoch: 1, Steps: 7 | Train Loss: 1.622 Vali Loss: 1.412 Vali Acc: 0.440 Test Loss: 1.412 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 1.5949459075927734
Epoch: 2, Steps: 7 | Train Loss: 0.407 Vali Loss: 2.740 Vali Acc: 0.440 Test Loss: 2.740 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9531440734863281
Epoch: 3, Steps: 7 | Train Loss: 0.146 Vali Loss: 2.073 Vali Acc: 0.540 Test Loss: 2.073 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539979).  Saving model ...
Epoch: 4 cost time: 1.7420835494995117
Epoch: 4, Steps: 7 | Train Loss: 0.277 Vali Loss: 3.737 Vali Acc: 0.460 Test Loss: 3.737 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.758594274520874
Epoch: 5, Steps: 7 | Train Loss: 0.096 Vali Loss: 3.766 Vali Acc: 0.440 Test Loss: 3.766 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5204854011535645
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.871 Vali Acc: 0.520 Test Loss: 2.871 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7263646125793457
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.587 Vali Acc: 0.500 Test Loss: 2.587 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6015498638153076
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.752 Vali Acc: 0.540 Test Loss: 3.752 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8830995559692383
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.385 Vali Acc: 0.500 Test Loss: 5.385 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.757509469985962
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.354 Vali Acc: 0.440 Test Loss: 6.354 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6709649562835693
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.653 Vali Acc: 0.440 Test Loss: 6.653 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6232500076293945
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.769 Vali Acc: 0.440 Test Loss: 6.769 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7183692455291748
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.814 Vali Acc: 0.440 Test Loss: 6.814 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2142471
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9872725009918213
Epoch: 1, Steps: 7 | Train Loss: 1.639 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 1.3672082424163818
Epoch: 2, Steps: 7 | Train Loss: 0.537 Vali Loss: 1.886 Vali Acc: 0.420 Test Loss: 1.886 Test Acc: 0.420
Validation loss decreased (-0.299982 --> -0.419981).  Saving model ...
Epoch: 3 cost time: 1.4536361694335938
Epoch: 3, Steps: 7 | Train Loss: 0.024 Vali Loss: 2.215 Vali Acc: 0.480 Test Loss: 2.215 Test Acc: 0.480
Validation loss decreased (-0.419981 --> -0.479978).  Saving model ...
Epoch: 4 cost time: 1.6593735218048096
Epoch: 4, Steps: 7 | Train Loss: 0.056 Vali Loss: 2.436 Vali Acc: 0.500 Test Loss: 2.436 Test Acc: 0.500
Validation loss decreased (-0.479978 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 1.4824881553649902
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.943 Vali Acc: 0.380 Test Loss: 3.943 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4451823234558105
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.282 Vali Acc: 0.460 Test Loss: 4.282 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3367915153503418
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.484 Vali Acc: 0.600 Test Loss: 2.484 Test Acc: 0.600
Validation loss decreased (-0.499976 --> -0.599975).  Saving model ...
Epoch: 8 cost time: 1.41969895362854
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.511 Vali Acc: 0.420 Test Loss: 3.511 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4012129306793213
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.229 Vali Acc: 0.480 Test Loss: 3.229 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4164197444915771
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.767 Vali Acc: 0.500 Test Loss: 2.767 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4009897708892822
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.875 Vali Acc: 0.440 Test Loss: 3.875 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.584425449371338
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.970 Vali Acc: 0.460 Test Loss: 3.970 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.508486270904541
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 4.162 Vali Acc: 0.500 Test Loss: 4.162 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4177289009094238
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.199 Vali Acc: 0.480 Test Loss: 4.199 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5611891746520996
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.683 Vali Acc: 0.500 Test Loss: 3.683 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.367213249206543
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.593 Vali Acc: 0.540 Test Loss: 3.593 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.491600751876831
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.571 Vali Acc: 0.560 Test Loss: 3.571 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2138887
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.886972188949585
Epoch: 1, Steps: 7 | Train Loss: 1.614 Vali Loss: 1.633 Vali Acc: 0.300 Test Loss: 1.633 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.4702973365783691
Epoch: 2, Steps: 7 | Train Loss: 0.506 Vali Loss: 1.831 Vali Acc: 0.320 Test Loss: 1.831 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319982).  Saving model ...
Epoch: 3 cost time: 1.3759105205535889
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 3.628 Vali Acc: 0.360 Test Loss: 3.628 Test Acc: 0.360
Validation loss decreased (-0.319982 --> -0.359964).  Saving model ...
Epoch: 4 cost time: 1.4526033401489258
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.972 Vali Acc: 0.460 Test Loss: 1.972 Test Acc: 0.460
Validation loss decreased (-0.359964 --> -0.459980).  Saving model ...
Epoch: 5 cost time: 1.368494987487793
Epoch: 5, Steps: 7 | Train Loss: 0.055 Vali Loss: 2.499 Vali Acc: 0.460 Test Loss: 2.499 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.330803394317627
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.710 Vali Acc: 0.480 Test Loss: 2.710 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479973).  Saving model ...
Epoch: 7 cost time: 1.4141881465911865
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.420 Test Loss: 3.854 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3125720024108887
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.768 Vali Acc: 0.400 Test Loss: 4.768 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3789238929748535
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.969 Vali Acc: 0.400 Test Loss: 4.969 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3241791725158691
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.958 Vali Acc: 0.400 Test Loss: 4.958 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4017457962036133
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.843 Vali Acc: 0.400 Test Loss: 4.843 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3962182998657227
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.400 Test Loss: 4.753 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2665741443634033
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.683 Vali Acc: 0.440 Test Loss: 4.683 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4909703731536865
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.632 Vali Acc: 0.460 Test Loss: 4.632 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3936142921447754
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.591 Vali Acc: 0.440 Test Loss: 4.591 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.311720848083496
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.556 Vali Acc: 0.440 Test Loss: 4.556 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2135815
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7665460109710693
Epoch: 1, Steps: 7 | Train Loss: 1.669 Vali Loss: 1.537 Vali Acc: 0.340 Test Loss: 1.537 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.1528513431549072
Epoch: 2, Steps: 7 | Train Loss: 0.314 Vali Loss: 1.457 Vali Acc: 0.440 Test Loss: 1.457 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439985).  Saving model ...
Epoch: 3 cost time: 1.1798741817474365
Epoch: 3, Steps: 7 | Train Loss: 0.325 Vali Loss: 3.758 Vali Acc: 0.360 Test Loss: 3.758 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3241710662841797
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.872 Vali Acc: 0.420 Test Loss: 2.872 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.206636667251587
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.156 Vali Acc: 0.480 Test Loss: 2.156 Test Acc: 0.480
Validation loss decreased (-0.439985 --> -0.479978).  Saving model ...
Epoch: 6 cost time: 1.422377109527588
Epoch: 6, Steps: 7 | Train Loss: 0.082 Vali Loss: 2.404 Vali Acc: 0.580 Test Loss: 2.404 Test Acc: 0.580
Validation loss decreased (-0.479978 --> -0.579976).  Saving model ...
Epoch: 7 cost time: 1.1320126056671143
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.377 Vali Acc: 0.440 Test Loss: 3.377 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2364158630371094
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.281 Vali Acc: 0.460 Test Loss: 4.281 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3705644607543945
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.017 Vali Acc: 0.440 Test Loss: 4.017 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.426853895187378
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.003 Vali Acc: 0.440 Test Loss: 4.003 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2596936225891113
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.022 Vali Acc: 0.440 Test Loss: 4.022 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.229985237121582
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.035 Vali Acc: 0.420 Test Loss: 4.035 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.266355037689209
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.034 Vali Acc: 0.420 Test Loss: 4.034 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3364806175231934
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.031 Vali Acc: 0.420 Test Loss: 4.031 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2021982669830322
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.026 Vali Acc: 0.420 Test Loss: 4.026 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4130549430847168
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.020 Vali Acc: 0.420 Test Loss: 4.020 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2132231
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.466723918914795
Epoch: 1, Steps: 7 | Train Loss: 1.612 Vali Loss: 1.446 Vali Acc: 0.440 Test Loss: 1.446 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 0.9657843112945557
Epoch: 2, Steps: 7 | Train Loss: 0.420 Vali Loss: 1.579 Vali Acc: 0.400 Test Loss: 1.579 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3425345420837402
Epoch: 3, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.405 Vali Acc: 0.400 Test Loss: 2.405 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1498816013336182
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.876 Vali Acc: 0.400 Test Loss: 2.876 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.134753942489624
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.895 Vali Acc: 0.440 Test Loss: 2.895 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0019888877868652
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.496 Vali Acc: 0.380 Test Loss: 3.496 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2084767818450928
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.061 Vali Acc: 0.360 Test Loss: 4.061 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0565247535705566
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.375 Vali Acc: 0.380 Test Loss: 4.375 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.093362808227539
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.484 Vali Acc: 0.380 Test Loss: 4.484 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3669569492340088
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.507 Vali Acc: 0.380 Test Loss: 4.507 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2213385105133057
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.494 Vali Acc: 0.380 Test Loss: 4.494 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 2129671
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6717257499694824
Epoch: 1, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.801 Vali Acc: 0.280 Test Loss: 1.801 Test Acc: 0.280
Validation loss decreased (inf --> -0.279982).  Saving model ...
Epoch: 2 cost time: 1.0490329265594482
Epoch: 2, Steps: 7 | Train Loss: 0.618 Vali Loss: 2.103 Vali Acc: 0.440 Test Loss: 2.103 Test Acc: 0.440
Validation loss decreased (-0.279982 --> -0.439979).  Saving model ...
Epoch: 3 cost time: 1.0509717464447021
Epoch: 3, Steps: 7 | Train Loss: 0.179 Vali Loss: 1.842 Vali Acc: 0.460 Test Loss: 1.842 Test Acc: 0.460
Validation loss decreased (-0.439979 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 1.0690655708312988
Epoch: 4, Steps: 7 | Train Loss: 0.065 Vali Loss: 4.104 Vali Acc: 0.400 Test Loss: 4.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0182228088378906
Epoch: 5, Steps: 7 | Train Loss: 0.020 Vali Loss: 3.728 Vali Acc: 0.420 Test Loss: 3.728 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.205033540725708
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.886 Vali Acc: 0.440 Test Loss: 2.886 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1806941032409668
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.015 Vali Acc: 0.580 Test Loss: 3.015 Test Acc: 0.580
Validation loss decreased (-0.459982 --> -0.579970).  Saving model ...
Epoch: 8 cost time: 1.094902515411377
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.069 Vali Acc: 0.460 Test Loss: 5.069 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.014547348022461
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.934 Vali Acc: 0.440 Test Loss: 4.934 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8923971652984619
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.687 Vali Acc: 0.360 Test Loss: 5.687 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0149598121643066
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.041 Vali Acc: 0.300 Test Loss: 7.041 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0586812496185303
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.455 Vali Acc: 0.340 Test Loss: 6.455 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0486743450164795
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.108 Vali Acc: 0.320 Test Loss: 6.108 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0763392448425293
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.941 Vali Acc: 0.320 Test Loss: 5.941 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9986896514892578
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.850 Vali Acc: 0.340 Test Loss: 5.850 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9107794761657715
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.794 Vali Acc: 0.340 Test Loss: 5.794 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0395865440368652
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.762 Vali Acc: 0.340 Test Loss: 5.762 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2128135
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2409045696258545
Epoch: 1, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.787 Vali Acc: 0.280 Test Loss: 1.787 Test Acc: 0.280
Validation loss decreased (inf --> -0.279982).  Saving model ...
Epoch: 2 cost time: 0.9771149158477783
Epoch: 2, Steps: 7 | Train Loss: 0.591 Vali Loss: 2.808 Vali Acc: 0.380 Test Loss: 2.808 Test Acc: 0.380
Validation loss decreased (-0.279982 --> -0.379972).  Saving model ...
Epoch: 3 cost time: 1.0407373905181885
Epoch: 3, Steps: 7 | Train Loss: 0.107 Vali Loss: 3.042 Vali Acc: 0.360 Test Loss: 3.042 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0139098167419434
Epoch: 4, Steps: 7 | Train Loss: 0.236 Vali Loss: 2.645 Vali Acc: 0.500 Test Loss: 2.645 Test Acc: 0.500
Validation loss decreased (-0.379972 --> -0.499974).  Saving model ...
Epoch: 5 cost time: 1.0976202487945557
Epoch: 5, Steps: 7 | Train Loss: 0.053 Vali Loss: 3.133 Vali Acc: 0.360 Test Loss: 3.133 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0624268054962158
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.613 Vali Acc: 0.500 Test Loss: 2.613 Test Acc: 0.500
Validation loss decreased (-0.499974 --> -0.499974).  Saving model ...
Epoch: 7 cost time: 1.1204593181610107
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.161 Vali Acc: 0.420 Test Loss: 4.161 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.019162893295288
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.298 Vali Acc: 0.380 Test Loss: 5.298 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0825724601745605
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.163 Vali Acc: 0.380 Test Loss: 5.163 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0934932231903076
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.912 Vali Acc: 0.400 Test Loss: 4.912 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1602513790130615
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.766 Vali Acc: 0.420 Test Loss: 4.766 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1039643287658691
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.667 Vali Acc: 0.420 Test Loss: 4.667 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0068409442901611
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.613 Vali Acc: 0.440 Test Loss: 4.613 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1791601181030273
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.580 Vali Acc: 0.440 Test Loss: 4.580 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0769736766815186
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.561 Vali Acc: 0.440 Test Loss: 4.561 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.984668493270874
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.544 Vali Acc: 0.440 Test Loss: 4.544 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2126599
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2697794437408447
Epoch: 1, Steps: 7 | Train Loss: 1.563 Vali Loss: 1.702 Vali Acc: 0.320 Test Loss: 1.702 Test Acc: 0.320
Validation loss decreased (inf --> -0.319983).  Saving model ...
Epoch: 2 cost time: 0.9358201026916504
Epoch: 2, Steps: 7 | Train Loss: 0.573 Vali Loss: 2.356 Vali Acc: 0.360 Test Loss: 2.356 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359976).  Saving model ...
Epoch: 3 cost time: 0.9061062335968018
Epoch: 3, Steps: 7 | Train Loss: 0.027 Vali Loss: 2.138 Vali Acc: 0.500 Test Loss: 2.138 Test Acc: 0.500
Validation loss decreased (-0.359976 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.9438226222991943
Epoch: 4, Steps: 7 | Train Loss: 0.098 Vali Loss: 3.129 Vali Acc: 0.540 Test Loss: 3.129 Test Acc: 0.540
Validation loss decreased (-0.499979 --> -0.539969).  Saving model ...
Epoch: 5 cost time: 0.8767282962799072
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.132 Vali Acc: 0.460 Test Loss: 4.132 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8592290878295898
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.428 Vali Acc: 0.540 Test Loss: 2.428 Test Acc: 0.540
Validation loss decreased (-0.539969 --> -0.539976).  Saving model ...
Epoch: 7 cost time: 0.896752119064331
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.642 Vali Acc: 0.500 Test Loss: 3.642 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8973937034606934
Epoch: 8, Steps: 7 | Train Loss: 0.368 Vali Loss: 3.940 Vali Acc: 0.520 Test Loss: 3.940 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.949859619140625
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.501 Vali Acc: 0.480 Test Loss: 5.501 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9351310729980469
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 3.653 Vali Acc: 0.400 Test Loss: 3.653 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8812532424926758
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.190 Vali Acc: 0.520 Test Loss: 3.190 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9096133708953857
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.460 Test Loss: 3.604 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9062626361846924
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.229 Vali Acc: 0.480 Test Loss: 4.229 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0533254146575928
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.504 Vali Acc: 0.520 Test Loss: 3.504 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8282356262207031
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.533 Vali Acc: 0.520 Test Loss: 3.533 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9546096324920654
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.633 Vali Acc: 0.440 Test Loss: 3.633 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2125575
model size : 8.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.887934923171997
Epoch: 1, Steps: 7 | Train Loss: 1.787 Vali Loss: 2.174 Vali Acc: 0.180 Test Loss: 2.174 Test Acc: 0.180
Validation loss decreased (inf --> -0.179978).  Saving model ...
Epoch: 2 cost time: 1.565180778503418
Epoch: 2, Steps: 7 | Train Loss: 1.021 Vali Loss: 2.324 Vali Acc: 0.240 Test Loss: 2.324 Test Acc: 0.240
Validation loss decreased (-0.179978 --> -0.239977).  Saving model ...
Epoch: 3 cost time: 1.4993159770965576
Epoch: 3, Steps: 7 | Train Loss: 0.364 Vali Loss: 2.953 Vali Acc: 0.420 Test Loss: 2.953 Test Acc: 0.420
Validation loss decreased (-0.239977 --> -0.419970).  Saving model ...
Epoch: 4 cost time: 1.5322139263153076
Epoch: 4, Steps: 7 | Train Loss: 0.237 Vali Loss: 2.775 Vali Acc: 0.420 Test Loss: 2.775 Test Acc: 0.420
Validation loss decreased (-0.419970 --> -0.419972).  Saving model ...
Epoch: 5 cost time: 1.4931976795196533
Epoch: 5, Steps: 7 | Train Loss: 0.187 Vali Loss: 3.671 Vali Acc: 0.400 Test Loss: 3.671 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5863416194915771
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 5.407 Vali Acc: 0.500 Test Loss: 5.407 Test Acc: 0.500
Validation loss decreased (-0.419972 --> -0.499946).  Saving model ...
Epoch: 7 cost time: 1.464228868484497
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 5.100 Vali Acc: 0.480 Test Loss: 5.100 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6193230152130127
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.216 Vali Acc: 0.340 Test Loss: 7.216 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.615976095199585
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.059 Vali Acc: 0.500 Test Loss: 4.059 Test Acc: 0.500
Validation loss decreased (-0.499946 --> -0.499959).  Saving model ...
Epoch: 10 cost time: 1.6134657859802246
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.617 Vali Acc: 0.480 Test Loss: 4.617 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5932941436767578
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 3.686 Vali Acc: 0.500 Test Loss: 3.686 Test Acc: 0.500
Validation loss decreased (-0.499959 --> -0.499963).  Saving model ...
Epoch: 12 cost time: 1.6966371536254883
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.781 Vali Acc: 0.540 Test Loss: 4.781 Test Acc: 0.540
Validation loss decreased (-0.499963 --> -0.539952).  Saving model ...
Epoch: 13 cost time: 1.8191421031951904
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.188 Vali Acc: 0.480 Test Loss: 6.188 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7151694297790527
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.080 Vali Acc: 0.480 Test Loss: 6.080 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.757007360458374
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.025 Vali Acc: 0.480 Test Loss: 6.025 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.954505443572998
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.460 Test Loss: 5.956 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.800485372543335
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.904 Vali Acc: 0.480 Test Loss: 5.904 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8831589221954346
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.850 Vali Acc: 0.460 Test Loss: 5.850 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8796064853668213
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.811 Vali Acc: 0.460 Test Loss: 5.811 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9049181938171387
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.773 Vali Acc: 0.460 Test Loss: 5.773 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6205863952636719
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.745 Vali Acc: 0.460 Test Loss: 5.745 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.89414381980896
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.719 Vali Acc: 0.460 Test Loss: 5.719 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2131707
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7394514083862305
Epoch: 1, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.420 Vali Acc: 0.260 Test Loss: 1.420 Test Acc: 0.260
Validation loss decreased (inf --> -0.259986).  Saving model ...
Epoch: 2 cost time: 1.3988451957702637
Epoch: 2, Steps: 7 | Train Loss: 0.529 Vali Loss: 1.364 Vali Acc: 0.460 Test Loss: 1.364 Test Acc: 0.460
Validation loss decreased (-0.259986 --> -0.459986).  Saving model ...
Epoch: 3 cost time: 1.5077450275421143
Epoch: 3, Steps: 7 | Train Loss: 0.135 Vali Loss: 1.548 Vali Acc: 0.480 Test Loss: 1.548 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 1.4265718460083008
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.458 Vali Acc: 0.380 Test Loss: 3.458 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4405386447906494
Epoch: 5, Steps: 7 | Train Loss: 0.071 Vali Loss: 2.895 Vali Acc: 0.420 Test Loss: 2.895 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3405110836029053
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.144 Vali Acc: 0.520 Test Loss: 3.144 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519969).  Saving model ...
Epoch: 7 cost time: 1.789647102355957
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.563 Vali Acc: 0.400 Test Loss: 4.563 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5553812980651855
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.842 Vali Acc: 0.540 Test Loss: 2.842 Test Acc: 0.540
Validation loss decreased (-0.519969 --> -0.539972).  Saving model ...
Epoch: 9 cost time: 1.4877853393554688
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.103 Vali Acc: 0.460 Test Loss: 3.103 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5806019306182861
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.914 Vali Acc: 0.500 Test Loss: 2.914 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.425778865814209
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.825 Vali Acc: 0.560 Test Loss: 2.825 Test Acc: 0.560
Validation loss decreased (-0.539972 --> -0.559972).  Saving model ...
Epoch: 12 cost time: 1.5840682983398438
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.580 Test Loss: 2.810 Test Acc: 0.580
Validation loss decreased (-0.559972 --> -0.579972).  Saving model ...
Epoch: 13 cost time: 1.5198650360107422
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.600 Test Loss: 2.808 Test Acc: 0.600
Validation loss decreased (-0.579972 --> -0.599972).  Saving model ...
Epoch: 14 cost time: 1.4744939804077148
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.600 Test Loss: 2.808 Test Acc: 0.600
Validation loss decreased (-0.599972 --> -0.599972).  Saving model ...
Epoch: 15 cost time: 1.5717318058013916
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.600 Test Loss: 2.805 Test Acc: 0.600
Validation loss decreased (-0.599972 --> -0.599972).  Saving model ...
Epoch: 16 cost time: 1.4762818813323975
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.580 Test Loss: 2.802 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6896450519561768
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.797 Vali Acc: 0.580 Test Loss: 2.797 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5830533504486084
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.791 Vali Acc: 0.580 Test Loss: 2.791 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7381253242492676
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.785 Vali Acc: 0.580 Test Loss: 2.785 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5522832870483398
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.780 Vali Acc: 0.580 Test Loss: 2.780 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5858490467071533
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.775 Vali Acc: 0.580 Test Loss: 2.775 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5420172214508057
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.769 Vali Acc: 0.580 Test Loss: 2.769 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6645135879516602
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.761 Vali Acc: 0.580 Test Loss: 2.761 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5424294471740723
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.755 Vali Acc: 0.580 Test Loss: 2.755 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5070281028747559
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.750 Vali Acc: 0.580 Test Loss: 2.750 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2128123
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4102070331573486
Epoch: 1, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.481 Vali Acc: 0.280 Test Loss: 1.481 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.225858449935913
Epoch: 2, Steps: 7 | Train Loss: 0.457 Vali Loss: 1.639 Vali Acc: 0.440 Test Loss: 1.639 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439984).  Saving model ...
Epoch: 3 cost time: 1.2281646728515625
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.061 Vali Acc: 0.360 Test Loss: 2.061 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3002521991729736
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.049 Vali Acc: 0.440 Test Loss: 3.049 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3309121131896973
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.585 Vali Acc: 0.440 Test Loss: 3.585 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3005726337432861
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.884 Vali Acc: 0.540 Test Loss: 2.884 Test Acc: 0.540
Validation loss decreased (-0.439984 --> -0.539971).  Saving model ...
Epoch: 7 cost time: 1.2419712543487549
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.010 Vali Acc: 0.500 Test Loss: 3.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2822108268737793
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.138 Vali Acc: 0.480 Test Loss: 3.138 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4115557670593262
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.181 Vali Acc: 0.480 Test Loss: 3.181 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3063023090362549
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.178 Vali Acc: 0.480 Test Loss: 3.178 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1734349727630615
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.460 Test Loss: 3.159 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2958004474639893
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.141 Vali Acc: 0.480 Test Loss: 3.141 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4558799266815186
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.117 Vali Acc: 0.480 Test Loss: 3.117 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2807590961456299
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.096 Vali Acc: 0.480 Test Loss: 3.096 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2801954746246338
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.480 Test Loss: 3.077 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3880999088287354
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.480 Test Loss: 3.063 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2125051
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2168684005737305
Epoch: 1, Steps: 7 | Train Loss: 1.627 Vali Loss: 2.187 Vali Acc: 0.220 Test Loss: 2.187 Test Acc: 0.220
Validation loss decreased (inf --> -0.219978).  Saving model ...
Epoch: 2 cost time: 1.0673441886901855
Epoch: 2, Steps: 7 | Train Loss: 0.794 Vali Loss: 1.462 Vali Acc: 0.480 Test Loss: 1.462 Test Acc: 0.480
Validation loss decreased (-0.219978 --> -0.479985).  Saving model ...
Epoch: 3 cost time: 0.9815597534179688
Epoch: 3, Steps: 7 | Train Loss: 0.426 Vali Loss: 2.606 Vali Acc: 0.460 Test Loss: 2.606 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.030461072921753
Epoch: 4, Steps: 7 | Train Loss: 0.139 Vali Loss: 2.968 Vali Acc: 0.420 Test Loss: 2.968 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9858198165893555
Epoch: 5, Steps: 7 | Train Loss: 0.229 Vali Loss: 3.781 Vali Acc: 0.460 Test Loss: 3.781 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9718043804168701
Epoch: 6, Steps: 7 | Train Loss: 0.877 Vali Loss: 2.715 Vali Acc: 0.500 Test Loss: 2.715 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499973).  Saving model ...
Epoch: 7 cost time: 1.060243844985962
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 3.779 Vali Acc: 0.520 Test Loss: 3.779 Test Acc: 0.520
Validation loss decreased (-0.499973 --> -0.519962).  Saving model ...
Epoch: 8 cost time: 1.0312840938568115
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.617 Vali Acc: 0.560 Test Loss: 3.617 Test Acc: 0.560
Validation loss decreased (-0.519962 --> -0.559964).  Saving model ...
Epoch: 9 cost time: 1.0606486797332764
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.675 Vali Acc: 0.520 Test Loss: 2.675 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.075028419494629
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 3.629 Vali Acc: 0.460 Test Loss: 3.629 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0540482997894287
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.199 Vali Acc: 0.500 Test Loss: 5.199 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1123621463775635
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.776 Vali Acc: 0.480 Test Loss: 5.776 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0386383533477783
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.589 Vali Acc: 0.480 Test Loss: 5.589 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1722276210784912
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.333 Vali Acc: 0.520 Test Loss: 5.333 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1842272281646729
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.186 Vali Acc: 0.500 Test Loss: 5.186 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.071331262588501
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.111 Vali Acc: 0.500 Test Loss: 5.111 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0552809238433838
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.071 Vali Acc: 0.500 Test Loss: 5.071 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0586297512054443
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.048 Vali Acc: 0.500 Test Loss: 5.048 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2121467
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.419468879699707
Epoch: 1, Steps: 7 | Train Loss: 1.656 Vali Loss: 2.207 Vali Acc: 0.340 Test Loss: 2.207 Test Acc: 0.340
Validation loss decreased (inf --> -0.339978).  Saving model ...
Epoch: 2 cost time: 0.9847257137298584
Epoch: 2, Steps: 7 | Train Loss: 0.871 Vali Loss: 1.966 Vali Acc: 0.340 Test Loss: 1.966 Test Acc: 0.340
Validation loss decreased (-0.339978 --> -0.339980).  Saving model ...
Epoch: 3 cost time: 1.0654051303863525
Epoch: 3, Steps: 7 | Train Loss: 0.213 Vali Loss: 2.084 Vali Acc: 0.400 Test Loss: 2.084 Test Acc: 0.400
Validation loss decreased (-0.339980 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 1.0126738548278809
Epoch: 4, Steps: 7 | Train Loss: 0.111 Vali Loss: 1.950 Vali Acc: 0.500 Test Loss: 1.950 Test Acc: 0.500
Validation loss decreased (-0.399979 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 1.1044600009918213
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.500 Test Loss: 2.430 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0483171939849854
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.440 Test Loss: 3.438 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1662652492523193
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.080 Vali Acc: 0.440 Test Loss: 4.080 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1484711170196533
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.214 Vali Acc: 0.480 Test Loss: 4.214 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0368568897247314
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.480 Test Loss: 4.146 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.06585693359375
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.049 Vali Acc: 0.480 Test Loss: 4.049 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1989402770996094
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.983 Vali Acc: 0.480 Test Loss: 3.983 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0938138961791992
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.928 Vali Acc: 0.480 Test Loss: 3.928 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2340712547302246
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.888 Vali Acc: 0.480 Test Loss: 3.888 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.133091926574707
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.863 Vali Acc: 0.480 Test Loss: 3.863 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2118907
model size : 8.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2713358402252197
Epoch: 1, Steps: 7 | Train Loss: 1.933 Vali Loss: 2.130 Vali Acc: 0.240 Test Loss: 2.130 Test Acc: 0.240
Validation loss decreased (inf --> -0.239979).  Saving model ...
Epoch: 2 cost time: 0.9383409023284912
Epoch: 2, Steps: 7 | Train Loss: 0.914 Vali Loss: 2.632 Vali Acc: 0.400 Test Loss: 2.632 Test Acc: 0.400
Validation loss decreased (-0.239979 --> -0.399974).  Saving model ...
Epoch: 3 cost time: 0.9573040008544922
Epoch: 3, Steps: 7 | Train Loss: 0.348 Vali Loss: 1.623 Vali Acc: 0.560 Test Loss: 1.623 Test Acc: 0.560
Validation loss decreased (-0.399974 --> -0.559984).  Saving model ...
Epoch: 4 cost time: 0.9329934120178223
Epoch: 4, Steps: 7 | Train Loss: 0.394 Vali Loss: 2.914 Vali Acc: 0.400 Test Loss: 2.914 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9889113903045654
Epoch: 5, Steps: 7 | Train Loss: 0.075 Vali Loss: 2.856 Vali Acc: 0.500 Test Loss: 2.856 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0916478633880615
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.920 Vali Acc: 0.380 Test Loss: 3.920 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.022801160812378
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 5.741 Vali Acc: 0.300 Test Loss: 5.741 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9096620082855225
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.952 Vali Acc: 0.520 Test Loss: 2.952 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1434338092803955
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.420 Test Loss: 3.485 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0801098346710205
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.246 Vali Acc: 0.440 Test Loss: 3.246 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1078941822052002
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.998 Vali Acc: 0.440 Test Loss: 2.998 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0543193817138672
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.480 Test Loss: 3.048 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1199617385864258
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.127 Vali Acc: 0.480 Test Loss: 3.127 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2117371
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.164047956466675
Epoch: 1, Steps: 7 | Train Loss: 1.852 Vali Loss: 1.978 Vali Acc: 0.240 Test Loss: 1.978 Test Acc: 0.240
Validation loss decreased (inf --> -0.239980).  Saving model ...
Epoch: 2 cost time: 0.7982277870178223
Epoch: 2, Steps: 7 | Train Loss: 0.651 Vali Loss: 2.410 Vali Acc: 0.360 Test Loss: 2.410 Test Acc: 0.360
Validation loss decreased (-0.239980 --> -0.359976).  Saving model ...
Epoch: 3 cost time: 0.8458762168884277
Epoch: 3, Steps: 7 | Train Loss: 0.136 Vali Loss: 3.208 Vali Acc: 0.400 Test Loss: 3.208 Test Acc: 0.400
Validation loss decreased (-0.359976 --> -0.399968).  Saving model ...
Epoch: 4 cost time: 0.8679687976837158
Epoch: 4, Steps: 7 | Train Loss: 0.470 Vali Loss: 3.042 Vali Acc: 0.420 Test Loss: 3.042 Test Acc: 0.420
Validation loss decreased (-0.399968 --> -0.419970).  Saving model ...
Epoch: 5 cost time: 0.9237327575683594
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 4.992 Vali Acc: 0.400 Test Loss: 4.992 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7879619598388672
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.665 Vali Acc: 0.380 Test Loss: 3.665 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7578577995300293
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.217 Vali Acc: 0.360 Test Loss: 4.217 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8381083011627197
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 4.737 Vali Acc: 0.360 Test Loss: 4.737 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7769746780395508
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 5.016 Vali Acc: 0.440 Test Loss: 5.016 Test Acc: 0.440
Validation loss decreased (-0.419970 --> -0.439950).  Saving model ...
Epoch: 10 cost time: 0.8078625202178955
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 4.005 Vali Acc: 0.460 Test Loss: 4.005 Test Acc: 0.460
Validation loss decreased (-0.439950 --> -0.459960).  Saving model ...
Epoch: 11 cost time: 0.8124165534973145
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 5.932 Vali Acc: 0.500 Test Loss: 5.932 Test Acc: 0.500
Validation loss decreased (-0.459960 --> -0.499941).  Saving model ...
Epoch: 12 cost time: 0.7982356548309326
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.415 Vali Acc: 0.440 Test Loss: 5.415 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8140332698822021
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.479 Vali Acc: 0.440 Test Loss: 5.479 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0305898189544678
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.472 Vali Acc: 0.400 Test Loss: 5.472 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8552055358886719
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.417 Vali Acc: 0.380 Test Loss: 5.417 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.821253776550293
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.341 Vali Acc: 0.380 Test Loss: 5.341 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7500753402709961
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.294 Vali Acc: 0.380 Test Loss: 5.294 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7999265193939209
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.264 Vali Acc: 0.400 Test Loss: 5.264 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8089420795440674
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.236 Vali Acc: 0.400 Test Loss: 5.236 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8103361129760742
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.219 Vali Acc: 0.400 Test Loss: 5.219 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8439292907714844
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.208 Vali Acc: 0.400 Test Loss: 5.208 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2115835
model size : 8.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1985177993774414
Epoch: 1, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.576 Vali Acc: 0.320 Test Loss: 1.576 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.9608597755432129
Epoch: 2, Steps: 7 | Train Loss: 0.535 Vali Loss: 1.835 Vali Acc: 0.380 Test Loss: 1.835 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 0.9582943916320801
Epoch: 3, Steps: 7 | Train Loss: 0.166 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
Validation loss decreased (-0.379982 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 0.7698764801025391
Epoch: 4, Steps: 7 | Train Loss: 0.267 Vali Loss: 2.913 Vali Acc: 0.460 Test Loss: 2.913 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9437482357025146
Epoch: 5, Steps: 7 | Train Loss: 0.019 Vali Loss: 4.479 Vali Acc: 0.280 Test Loss: 4.479 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9302496910095215
Epoch: 6, Steps: 7 | Train Loss: 0.136 Vali Loss: 4.719 Vali Acc: 0.340 Test Loss: 4.719 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9044549465179443
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 4.357 Vali Acc: 0.420 Test Loss: 4.357 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9310181140899658
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.129 Vali Acc: 0.420 Test Loss: 5.129 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9669575691223145
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.167 Vali Acc: 0.540 Test Loss: 3.167 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539968).  Saving model ...
Epoch: 10 cost time: 0.9563827514648438
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.570 Vali Acc: 0.520 Test Loss: 3.570 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8811166286468506
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.685 Vali Acc: 0.500 Test Loss: 4.685 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8938837051391602
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.592 Vali Acc: 0.460 Test Loss: 5.592 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8270416259765625
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.045 Vali Acc: 0.460 Test Loss: 6.045 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8148214817047119
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.246 Vali Acc: 0.440 Test Loss: 6.246 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8575356006622314
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.326 Vali Acc: 0.440 Test Loss: 6.326 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9740185737609863
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.335 Vali Acc: 0.440 Test Loss: 6.335 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8508296012878418
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.308 Vali Acc: 0.440 Test Loss: 6.308 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8042984008789062
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.275 Vali Acc: 0.460 Test Loss: 6.275 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7609984874725342
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.244 Vali Acc: 0.480 Test Loss: 6.244 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2114811
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0406911373138428
Epoch: 1, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.350 Vali Acc: 0.360 Test Loss: 1.350 Test Acc: 0.360
Validation loss decreased (inf --> -0.359987).  Saving model ...
Epoch: 2 cost time: 1.6736335754394531
Epoch: 2, Steps: 7 | Train Loss: 0.203 Vali Loss: 1.628 Vali Acc: 0.480 Test Loss: 1.628 Test Acc: 0.480
Validation loss decreased (-0.359987 --> -0.479984).  Saving model ...
Epoch: 3 cost time: 1.679100513458252
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.500 Test Loss: 1.884 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.5769846439361572
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.520 Test Loss: 2.141 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519979).  Saving model ...
Epoch: 5 cost time: 1.6161775588989258
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.325 Vali Acc: 0.520 Test Loss: 2.325 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5500457286834717
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.439 Vali Acc: 0.500 Test Loss: 2.439 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6055505275726318
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.506 Vali Acc: 0.500 Test Loss: 2.506 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5848579406738281
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.543 Vali Acc: 0.500 Test Loss: 2.543 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.610001802444458
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.564 Vali Acc: 0.500 Test Loss: 2.564 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6442887783050537
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.500 Test Loss: 2.575 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4977633953094482
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.500 Test Loss: 2.581 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5608799457550049
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.500 Test Loss: 2.584 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7238273620605469
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.500 Test Loss: 2.586 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6355538368225098
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.500 Test Loss: 2.587 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2118253
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.772146224975586
Epoch: 1, Steps: 7 | Train Loss: 1.596 Vali Loss: 1.277 Vali Acc: 0.580 Test Loss: 1.277 Test Acc: 0.580
Validation loss decreased (inf --> -0.579987).  Saving model ...
Epoch: 2 cost time: 1.2586455345153809
Epoch: 2, Steps: 7 | Train Loss: 0.196 Vali Loss: 1.738 Vali Acc: 0.480 Test Loss: 1.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3029918670654297
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.410 Vali Acc: 0.440 Test Loss: 2.410 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3780193328857422
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.380 Test Loss: 2.732 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2782542705535889
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.946 Vali Acc: 0.400 Test Loss: 2.946 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4087154865264893
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.068 Vali Acc: 0.400 Test Loss: 3.068 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4036197662353516
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.135 Vali Acc: 0.400 Test Loss: 3.135 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4052481651306152
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.171 Vali Acc: 0.400 Test Loss: 3.171 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.317385196685791
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.420 Test Loss: 3.189 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4832093715667725
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.198 Vali Acc: 0.420 Test Loss: 3.198 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.427222728729248
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.201 Vali Acc: 0.420 Test Loss: 3.201 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2114669
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.48150897026062
Epoch: 1, Steps: 7 | Train Loss: 1.628 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.233510971069336
Epoch: 2, Steps: 7 | Train Loss: 0.190 Vali Loss: 1.611 Vali Acc: 0.440 Test Loss: 1.611 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2389178276062012
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.540 Test Loss: 1.980 Test Acc: 0.540
Validation loss decreased (-0.439987 --> -0.539980).  Saving model ...
Epoch: 4 cost time: 1.273876667022705
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.520 Test Loss: 2.303 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2269344329833984
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.517 Vali Acc: 0.540 Test Loss: 2.517 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.272831678390503
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.540 Test Loss: 2.644 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2312180995941162
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.540 Test Loss: 2.714 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.206636667251587
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.752 Vali Acc: 0.540 Test Loss: 2.752 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1739962100982666
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.772 Vali Acc: 0.540 Test Loss: 2.772 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2306156158447266
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.540 Test Loss: 2.781 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1914098262786865
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.785 Vali Acc: 0.540 Test Loss: 2.785 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2884325981140137
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.786 Vali Acc: 0.540 Test Loss: 2.786 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2342426776885986
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.786 Vali Acc: 0.540 Test Loss: 2.786 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2111597
model size : 8.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.533208131790161
Epoch: 1, Steps: 7 | Train Loss: 1.585 Vali Loss: 1.288 Vali Acc: 0.380 Test Loss: 1.288 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 1.0660884380340576
Epoch: 2, Steps: 7 | Train Loss: 0.202 Vali Loss: 1.620 Vali Acc: 0.540 Test Loss: 1.620 Test Acc: 0.540
Validation loss decreased (-0.379987 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 1.203582525253296
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.580 Test Loss: 1.960 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579980).  Saving model ...
Epoch: 4 cost time: 1.142676591873169
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.580 Test Loss: 2.164 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1360344886779785
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.302 Vali Acc: 0.600 Test Loss: 2.302 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599977).  Saving model ...
Epoch: 6 cost time: 1.1785557270050049
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.385 Vali Acc: 0.600 Test Loss: 2.385 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2011942863464355
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.433 Vali Acc: 0.600 Test Loss: 2.433 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1171636581420898
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.600 Test Loss: 2.459 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1909279823303223
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.600 Test Loss: 2.473 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.224839687347412
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.600 Test Loss: 2.481 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0688917636871338
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.600 Test Loss: 2.484 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2202246189117432
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.486 Vali Acc: 0.600 Test Loss: 2.486 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.177414894104004
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.486 Vali Acc: 0.600 Test Loss: 2.486 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1360142230987549
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.486 Vali Acc: 0.600 Test Loss: 2.486 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1745214462280273
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.600 Test Loss: 2.485 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2108013
model size : 8.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.042241334915161
Epoch: 1, Steps: 7 | Train Loss: 1.510 Vali Loss: 1.347 Vali Acc: 0.440 Test Loss: 1.347 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 0.9520998001098633
Epoch: 2, Steps: 7 | Train Loss: 0.180 Vali Loss: 1.567 Vali Acc: 0.540 Test Loss: 1.567 Test Acc: 0.540
Validation loss decreased (-0.439987 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 0.9075555801391602
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.188 Vali Acc: 0.520 Test Loss: 2.188 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9763433933258057
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.540 Test Loss: 2.607 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9204103946685791
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.520 Test Loss: 2.869 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8956031799316406
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.540 Test Loss: 3.024 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8312382698059082
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.112 Vali Acc: 0.520 Test Loss: 3.112 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8468375205993652
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.161 Vali Acc: 0.520 Test Loss: 3.161 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9214093685150146
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.186 Vali Acc: 0.520 Test Loss: 3.186 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9001150131225586
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.200 Vali Acc: 0.520 Test Loss: 3.200 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7922024726867676
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.207 Vali Acc: 0.520 Test Loss: 3.207 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9513695240020752
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.211 Vali Acc: 0.520 Test Loss: 3.211 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2105453
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.283165454864502
Epoch: 1, Steps: 7 | Train Loss: 1.738 Vali Loss: 1.233 Vali Acc: 0.560 Test Loss: 1.233 Test Acc: 0.560
Validation loss decreased (inf --> -0.559988).  Saving model ...
Epoch: 2 cost time: 0.9292588233947754
Epoch: 2, Steps: 7 | Train Loss: 0.220 Vali Loss: 1.393 Vali Acc: 0.540 Test Loss: 1.393 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8607182502746582
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.497 Vali Acc: 0.440 Test Loss: 1.497 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8848490715026855
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.460 Test Loss: 1.808 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9330394268035889
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.051 Vali Acc: 0.480 Test Loss: 2.051 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8446509838104248
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.480 Test Loss: 2.203 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9472153186798096
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.480 Test Loss: 2.292 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8773887157440186
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.480 Test Loss: 2.342 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.952430009841919
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.500 Test Loss: 2.370 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9615693092346191
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.385 Vali Acc: 0.500 Test Loss: 2.385 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9533383846282959
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.393 Vali Acc: 0.500 Test Loss: 2.393 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2103917
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8972187042236328
Epoch: 1, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.297 Vali Acc: 0.420 Test Loss: 1.297 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.725252628326416
Epoch: 2, Steps: 7 | Train Loss: 0.196 Vali Loss: 1.560 Vali Acc: 0.520 Test Loss: 1.560 Test Acc: 0.520
Validation loss decreased (-0.419987 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 0.7665619850158691
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.332 Vali Acc: 0.460 Test Loss: 2.332 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7356457710266113
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.761 Vali Acc: 0.460 Test Loss: 2.761 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7281012535095215
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.035 Vali Acc: 0.460 Test Loss: 3.035 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8236589431762695
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.197 Vali Acc: 0.460 Test Loss: 3.197 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7505545616149902
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.289 Vali Acc: 0.460 Test Loss: 3.289 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6463937759399414
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.340 Vali Acc: 0.460 Test Loss: 3.340 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.750685453414917
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.366 Vali Acc: 0.460 Test Loss: 3.366 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8475992679595947
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.379 Vali Acc: 0.460 Test Loss: 3.379 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7123682498931885
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.385 Vali Acc: 0.460 Test Loss: 3.385 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8190858364105225
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.387 Vali Acc: 0.460 Test Loss: 3.387 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2102381
model size : 8.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.854719638824463
Epoch: 1, Steps: 7 | Train Loss: 1.550 Vali Loss: 1.243 Vali Acc: 0.420 Test Loss: 1.243 Test Acc: 0.420
Validation loss decreased (inf --> -0.419988).  Saving model ...
Epoch: 2 cost time: 0.9227890968322754
Epoch: 2, Steps: 7 | Train Loss: 0.147 Vali Loss: 1.840 Vali Acc: 0.460 Test Loss: 1.840 Test Acc: 0.460
Validation loss decreased (-0.419988 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 0.8955841064453125
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.845 Vali Acc: 0.420 Test Loss: 2.845 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7002787590026855
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.603 Vali Acc: 0.400 Test Loss: 3.603 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8776118755340576
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.060 Vali Acc: 0.420 Test Loss: 4.060 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8097891807556152
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.322 Vali Acc: 0.400 Test Loss: 4.322 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7013130187988281
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.468 Vali Acc: 0.400 Test Loss: 4.468 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6854021549224854
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.546 Vali Acc: 0.400 Test Loss: 4.546 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8612213134765625
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.586 Vali Acc: 0.400 Test Loss: 4.586 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7423689365386963
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.605 Vali Acc: 0.400 Test Loss: 4.605 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.72294020652771
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.611 Vali Acc: 0.400 Test Loss: 4.611 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7828903198242188
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.613 Vali Acc: 0.400 Test Loss: 4.613 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2101357
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9224298000335693
Epoch: 1, Steps: 7 | Train Loss: 1.506 Vali Loss: 1.282 Vali Acc: 0.520 Test Loss: 1.282 Test Acc: 0.520
Validation loss decreased (inf --> -0.519987).  Saving model ...
Epoch: 2 cost time: 1.4381513595581055
Epoch: 2, Steps: 7 | Train Loss: 0.191 Vali Loss: 1.810 Vali Acc: 0.540 Test Loss: 1.810 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539982).  Saving model ...
Epoch: 3 cost time: 1.4769327640533447
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.500 Test Loss: 2.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3650360107421875
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.460 Test Loss: 2.814 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4802639484405518
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.140 Vali Acc: 0.460 Test Loss: 3.140 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5136046409606934
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.338 Vali Acc: 0.460 Test Loss: 3.338 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4190785884857178
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.452 Vali Acc: 0.460 Test Loss: 3.452 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4431498050689697
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.515 Vali Acc: 0.460 Test Loss: 3.515 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.354954719543457
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.550 Vali Acc: 0.460 Test Loss: 3.550 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4707088470458984
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.569 Vali Acc: 0.460 Test Loss: 3.569 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5785696506500244
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.578 Vali Acc: 0.460 Test Loss: 3.578 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4811160564422607
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.583 Vali Acc: 0.460 Test Loss: 3.583 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2662895
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9424080848693848
Epoch: 1, Steps: 7 | Train Loss: 1.582 Vali Loss: 1.262 Vali Acc: 0.480 Test Loss: 1.262 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.3730008602142334
Epoch: 2, Steps: 7 | Train Loss: 0.314 Vali Loss: 1.816 Vali Acc: 0.440 Test Loss: 1.816 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6404192447662354
Epoch: 3, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.016 Vali Acc: 0.540 Test Loss: 2.016 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539980).  Saving model ...
Epoch: 4 cost time: 1.5522277355194092
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.560 Test Loss: 2.072 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559979).  Saving model ...
Epoch: 5 cost time: 1.4819037914276123
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.360 Vali Acc: 0.520 Test Loss: 2.360 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4673395156860352
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.534 Vali Acc: 0.520 Test Loss: 2.534 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4565012454986572
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.629 Vali Acc: 0.520 Test Loss: 2.629 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4794456958770752
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.520 Test Loss: 2.679 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3969521522521973
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.520 Test Loss: 2.703 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4936120510101318
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.715 Vali Acc: 0.520 Test Loss: 2.715 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.494178056716919
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.719 Vali Acc: 0.520 Test Loss: 2.719 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5907189846038818
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.719 Vali Acc: 0.520 Test Loss: 2.719 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5145275592803955
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.717 Vali Acc: 0.520 Test Loss: 2.717 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5625014305114746
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.715 Vali Acc: 0.520 Test Loss: 2.715 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2661103
model size : 10.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5179190635681152
Epoch: 1, Steps: 7 | Train Loss: 1.632 Vali Loss: 1.370 Vali Acc: 0.380 Test Loss: 1.370 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.215785026550293
Epoch: 2, Steps: 7 | Train Loss: 0.173 Vali Loss: 1.988 Vali Acc: 0.460 Test Loss: 1.988 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 1.1618809700012207
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.353 Vali Acc: 0.500 Test Loss: 2.353 Test Acc: 0.500
Validation loss decreased (-0.459980 --> -0.499976).  Saving model ...
Epoch: 4 cost time: 1.3265995979309082
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.480 Test Loss: 3.044 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.444549560546875
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.393 Vali Acc: 0.520 Test Loss: 3.393 Test Acc: 0.520
Validation loss decreased (-0.499976 --> -0.519966).  Saving model ...
Epoch: 6 cost time: 1.1019232273101807
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.836 Vali Acc: 0.500 Test Loss: 3.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2638776302337646
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.199 Vali Acc: 0.480 Test Loss: 4.199 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2077062129974365
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.435 Vali Acc: 0.480 Test Loss: 4.435 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.147153615951538
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.565 Vali Acc: 0.480 Test Loss: 4.565 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.244828224182129
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.631 Vali Acc: 0.480 Test Loss: 4.631 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4059176445007324
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.480 Test Loss: 4.654 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3757383823394775
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.662 Vali Acc: 0.480 Test Loss: 4.662 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2200462818145752
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.660 Vali Acc: 0.480 Test Loss: 4.660 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.306825876235962
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.652 Vali Acc: 0.480 Test Loss: 4.652 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1788465976715088
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.643 Vali Acc: 0.480 Test Loss: 4.643 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2659567
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.535090923309326
Epoch: 1, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.320 Vali Acc: 0.380 Test Loss: 1.320 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 1.0769846439361572
Epoch: 2, Steps: 7 | Train Loss: 0.194 Vali Loss: 2.022 Vali Acc: 0.400 Test Loss: 2.022 Test Acc: 0.400
Validation loss decreased (-0.379987 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 1.0886509418487549
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.266 Vali Acc: 0.520 Test Loss: 2.266 Test Acc: 0.520
Validation loss decreased (-0.399980 --> -0.519977).  Saving model ...
Epoch: 4 cost time: 1.2374987602233887
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.420 Test Loss: 2.828 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.099736213684082
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.308 Vali Acc: 0.380 Test Loss: 3.308 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.011446475982666
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.612 Vali Acc: 0.360 Test Loss: 3.612 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0349884033203125
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.786 Vali Acc: 0.360 Test Loss: 3.786 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0711092948913574
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.879 Vali Acc: 0.360 Test Loss: 3.879 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9409244060516357
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.921 Vali Acc: 0.360 Test Loss: 3.921 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0624415874481201
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.939 Vali Acc: 0.360 Test Loss: 3.939 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.099860668182373
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.946 Vali Acc: 0.360 Test Loss: 3.946 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0764546394348145
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.947 Vali Acc: 0.360 Test Loss: 3.947 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1507296562194824
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.945 Vali Acc: 0.360 Test Loss: 3.945 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2657775
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1837594509124756
Epoch: 1, Steps: 7 | Train Loss: 1.711 Vali Loss: 1.278 Vali Acc: 0.360 Test Loss: 1.278 Test Acc: 0.360
Validation loss decreased (inf --> -0.359987).  Saving model ...
Epoch: 2 cost time: 0.9855735301971436
Epoch: 2, Steps: 7 | Train Loss: 0.156 Vali Loss: 1.621 Vali Acc: 0.460 Test Loss: 1.621 Test Acc: 0.460
Validation loss decreased (-0.359987 --> -0.459984).  Saving model ...
Epoch: 3 cost time: 0.9174234867095947
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.091 Vali Acc: 0.500 Test Loss: 2.091 Test Acc: 0.500
Validation loss decreased (-0.459984 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 1.0960981845855713
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.520 Test Loss: 2.185 Test Acc: 0.520
Validation loss decreased (-0.499979 --> -0.519978).  Saving model ...
Epoch: 5 cost time: 0.857715368270874
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.580 Test Loss: 2.291 Test Acc: 0.580
Validation loss decreased (-0.519978 --> -0.579977).  Saving model ...
Epoch: 6 cost time: 0.9823975563049316
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.600 Test Loss: 2.367 Test Acc: 0.600
Validation loss decreased (-0.579977 --> -0.599976).  Saving model ...
Epoch: 7 cost time: 0.8750801086425781
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.414 Vali Acc: 0.620 Test Loss: 2.414 Test Acc: 0.620
Validation loss decreased (-0.599976 --> -0.619976).  Saving model ...
Epoch: 8 cost time: 1.019300937652588
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.620 Test Loss: 2.441 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9401683807373047
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.620 Test Loss: 2.456 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9913330078125
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.620 Test Loss: 2.463 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.006326675415039
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.620 Test Loss: 2.467 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9854812622070312
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.620 Test Loss: 2.469 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9968483448028564
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.620 Test Loss: 2.469 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0162999629974365
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.620 Test Loss: 2.469 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9682042598724365
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.468 Vali Acc: 0.620 Test Loss: 2.468 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.023087501525879
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.620 Test Loss: 2.467 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9933733940124512
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.640 Test Loss: 2.467 Test Acc: 0.640
Validation loss decreased (-0.619976 --> -0.639975).  Saving model ...
Epoch: 18 cost time: 0.9341466426849365
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.466 Vali Acc: 0.640 Test Loss: 2.466 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 19 cost time: 1.0740249156951904
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.466 Vali Acc: 0.640 Test Loss: 2.466 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 20 cost time: 0.9318244457244873
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.640 Test Loss: 2.465 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 21 cost time: 0.9426085948944092
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.640 Test Loss: 2.465 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 22 cost time: 0.9552416801452637
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.464 Vali Acc: 0.640 Test Loss: 2.464 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 23 cost time: 0.916954755783081
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.464 Vali Acc: 0.640 Test Loss: 2.464 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 24 cost time: 0.8397400379180908
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.464 Vali Acc: 0.640 Test Loss: 2.464 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 25 cost time: 0.9073054790496826
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.640 Test Loss: 2.463 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 26 cost time: 0.8792147636413574
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.640 Test Loss: 2.463 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 27 cost time: 1.0298852920532227
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.640 Test Loss: 2.462 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 28 cost time: 1.083120584487915
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.640 Test Loss: 2.462 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 29 cost time: 0.9516842365264893
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.640 Test Loss: 2.461 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 30 cost time: 0.9749236106872559
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.640 Test Loss: 2.461 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 31 cost time: 0.9350595474243164
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.640 Test Loss: 2.461 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 32 cost time: 0.9903526306152344
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.640 Test Loss: 2.460 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 33 cost time: 0.924628496170044
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.640 Test Loss: 2.460 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 34 cost time: 1.0570378303527832
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.640 Test Loss: 2.460 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 35 cost time: 0.9122967720031738
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.640 Test Loss: 2.459 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 36 cost time: 0.9344704151153564
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.640 Test Loss: 2.459 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 37 cost time: 0.9413902759552002
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.640 Test Loss: 2.459 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 38 cost time: 1.0265486240386963
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.640 Test Loss: 2.458 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 39 cost time: 1.0369787216186523
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.640 Test Loss: 2.457 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 40 cost time: 0.9889781475067139
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.640 Test Loss: 2.457 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 41 cost time: 0.9896495342254639
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.640 Test Loss: 2.457 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 42 cost time: 1.1027941703796387
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.640 Test Loss: 2.456 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 43 cost time: 0.9678022861480713
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.640 Test Loss: 2.456 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 44 cost time: 1.0091538429260254
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.640 Test Loss: 2.456 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 45 cost time: 0.9821393489837646
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.640 Test Loss: 2.456 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 46 cost time: 0.953608512878418
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.640 Test Loss: 2.455 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 47 cost time: 1.0146276950836182
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.640 Test Loss: 2.455 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 48 cost time: 1.016442060470581
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.640 Test Loss: 2.455 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 49 cost time: 0.9652869701385498
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.454 Vali Acc: 0.640 Test Loss: 2.454 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 50 cost time: 0.9888925552368164
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.454 Vali Acc: 0.640 Test Loss: 2.454 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 51 cost time: 1.0069570541381836
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.454 Vali Acc: 0.640 Test Loss: 2.454 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 52 cost time: 0.9732742309570312
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.640 Test Loss: 2.453 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 53 cost time: 0.994983434677124
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.640 Test Loss: 2.453 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 54 cost time: 0.9475796222686768
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.640 Test Loss: 2.453 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 55 cost time: 1.0744242668151855
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.452 Vali Acc: 0.640 Test Loss: 2.452 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 56 cost time: 1.0341103076934814
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.452 Vali Acc: 0.640 Test Loss: 2.452 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 57 cost time: 1.0314829349517822
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.452 Vali Acc: 0.640 Test Loss: 2.452 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 58 cost time: 0.9971673488616943
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.640 Test Loss: 2.451 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 59 cost time: 0.8784046173095703
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.640 Test Loss: 2.451 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 60 cost time: 0.9543285369873047
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.640 Test Loss: 2.451 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 61 cost time: 0.8447177410125732
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.640 Test Loss: 2.451 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 62 cost time: 0.909461259841919
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.640 Test Loss: 2.450 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 63 cost time: 0.9186000823974609
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.640 Test Loss: 2.450 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639975).  Saving model ...
Epoch: 64 cost time: 1.0504283905029297
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.640 Test Loss: 2.450 Test Acc: 0.640
Validation loss decreased (-0.639975 --> -0.639976).  Saving model ...
Epoch: 65 cost time: 0.9036927223205566
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.640 Test Loss: 2.450 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 66 cost time: 0.9956808090209961
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.640 Test Loss: 2.449 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 67 cost time: 0.8812997341156006
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.640 Test Loss: 2.449 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 68 cost time: 1.0254456996917725
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.640 Test Loss: 2.449 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 69 cost time: 0.9107849597930908
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.640 Test Loss: 2.448 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 70 cost time: 1.0368635654449463
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.640 Test Loss: 2.448 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 71 cost time: 0.972792387008667
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.640 Test Loss: 2.448 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 72 cost time: 0.9212489128112793
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.640 Test Loss: 2.448 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 73 cost time: 0.9177029132843018
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.640 Test Loss: 2.447 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 74 cost time: 0.9549820423126221
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.640 Test Loss: 2.447 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 75 cost time: 0.9192900657653809
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.640 Test Loss: 2.446 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 76 cost time: 0.953711986541748
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.640 Test Loss: 2.446 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 77 cost time: 0.9450316429138184
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.640 Test Loss: 2.446 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 78 cost time: 0.9917511940002441
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.640 Test Loss: 2.446 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 79 cost time: 0.9224107265472412
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.640 Test Loss: 2.446 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 80 cost time: 0.9687092304229736
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.640 Test Loss: 2.445 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 81 cost time: 1.0624022483825684
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.640 Test Loss: 2.445 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 82 cost time: 0.9779558181762695
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.640 Test Loss: 2.445 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 83 cost time: 1.0279924869537354
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.640 Test Loss: 2.445 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 84 cost time: 1.1028897762298584
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.640 Test Loss: 2.444 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 85 cost time: 1.0922019481658936
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.640 Test Loss: 2.444 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 86 cost time: 1.0648057460784912
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.640 Test Loss: 2.444 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 87 cost time: 1.128227949142456
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.640 Test Loss: 2.444 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 88 cost time: 0.881218671798706
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.640 Test Loss: 2.443 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 89 cost time: 1.1258213520050049
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.640 Test Loss: 2.443 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 90 cost time: 0.9281418323516846
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.640 Test Loss: 2.443 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 91 cost time: 1.114511489868164
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.640 Test Loss: 2.443 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 92 cost time: 0.9772875308990479
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.640 Test Loss: 2.443 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 93 cost time: 1.0672423839569092
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.640 Test Loss: 2.442 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 94 cost time: 0.9585921764373779
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.640 Test Loss: 2.442 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 95 cost time: 1.0719690322875977
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.640 Test Loss: 2.442 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 96 cost time: 1.014646291732788
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.640 Test Loss: 2.442 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 97 cost time: 0.9329593181610107
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.640 Test Loss: 2.441 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 98 cost time: 0.994391918182373
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.640 Test Loss: 2.441 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 99 cost time: 0.8921830654144287
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.640 Test Loss: 2.441 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
Epoch: 100 cost time: 0.9577651023864746
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.640 Test Loss: 2.441 Test Acc: 0.640
Validation loss decreased (-0.639976 --> -0.639976).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2656495
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1220877170562744
Epoch: 1, Steps: 7 | Train Loss: 1.632 Vali Loss: 1.300 Vali Acc: 0.420 Test Loss: 1.300 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.8040287494659424
Epoch: 2, Steps: 7 | Train Loss: 0.139 Vali Loss: 1.810 Vali Acc: 0.500 Test Loss: 1.810 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 0.9372401237487793
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.063 Vali Acc: 0.420 Test Loss: 3.063 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8703479766845703
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.901 Vali Acc: 0.500 Test Loss: 2.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9546022415161133
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.500 Test Loss: 2.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8444778919219971
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.968 Vali Acc: 0.520 Test Loss: 2.968 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519970).  Saving model ...
Epoch: 7 cost time: 1.0420050621032715
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.000 Vali Acc: 0.520 Test Loss: 3.000 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8412463665008545
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.018 Vali Acc: 0.520 Test Loss: 3.018 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8574090003967285
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.028 Vali Acc: 0.520 Test Loss: 3.028 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.991898775100708
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.520 Test Loss: 3.032 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9391477108001709
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.033 Vali Acc: 0.520 Test Loss: 3.033 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1073839664459229
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.033 Vali Acc: 0.520 Test Loss: 3.033 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9542763233184814
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.520 Test Loss: 3.032 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9692966938018799
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.520 Test Loss: 3.031 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.054987907409668
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.520 Test Loss: 3.029 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9637570381164551
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.027 Vali Acc: 0.520 Test Loss: 3.027 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2655727
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2744667530059814
Epoch: 1, Steps: 7 | Train Loss: 1.559 Vali Loss: 1.271 Vali Acc: 0.480 Test Loss: 1.271 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 0.9762470722198486
Epoch: 2, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.185 Vali Acc: 0.420 Test Loss: 2.185 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0133881568908691
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.516 Vali Acc: 0.540 Test Loss: 2.516 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539975).  Saving model ...
Epoch: 4 cost time: 0.8211610317230225
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.560 Test Loss: 2.802 Test Acc: 0.560
Validation loss decreased (-0.539975 --> -0.559972).  Saving model ...
Epoch: 5 cost time: 0.9260165691375732
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.007 Vali Acc: 0.540 Test Loss: 3.007 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9249651432037354
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.134 Vali Acc: 0.520 Test Loss: 3.134 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7911858558654785
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.208 Vali Acc: 0.540 Test Loss: 3.208 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9579887390136719
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.540 Test Loss: 3.249 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9302418231964111
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.272 Vali Acc: 0.540 Test Loss: 3.272 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8547496795654297
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.284 Vali Acc: 0.540 Test Loss: 3.284 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8941679000854492
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.290 Vali Acc: 0.540 Test Loss: 3.290 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9050498008728027
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.540 Test Loss: 3.293 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0587491989135742
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.295 Vali Acc: 0.540 Test Loss: 3.295 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9649183750152588
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.295 Vali Acc: 0.540 Test Loss: 3.295 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2654959
model size : 10.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.217284679412842
Epoch: 1, Steps: 7 | Train Loss: 1.493 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8151960372924805
Epoch: 2, Steps: 7 | Train Loss: 0.197 Vali Loss: 1.949 Vali Acc: 0.560 Test Loss: 1.949 Test Acc: 0.560
Validation loss decreased (-0.399986 --> -0.559981).  Saving model ...
Epoch: 3 cost time: 0.8430864810943604
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.347 Vali Acc: 0.560 Test Loss: 2.347 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7350256443023682
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.460 Test Loss: 2.547 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7850549221038818
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.679 Vali Acc: 0.480 Test Loss: 2.679 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8500316143035889
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.856 Vali Acc: 0.540 Test Loss: 2.856 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7827107906341553
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.067 Vali Acc: 0.540 Test Loss: 3.067 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8367059230804443
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.204 Vali Acc: 0.520 Test Loss: 3.204 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8308210372924805
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.282 Vali Acc: 0.500 Test Loss: 3.282 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7906842231750488
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.325 Vali Acc: 0.520 Test Loss: 3.325 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8463170528411865
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.347 Vali Acc: 0.520 Test Loss: 3.347 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8451850414276123
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.358 Vali Acc: 0.520 Test Loss: 3.358 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2654447
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.982367515563965
Epoch: 1, Steps: 7 | Train Loss: 1.572 Vali Loss: 1.439 Vali Acc: 0.380 Test Loss: 1.439 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.4805893898010254
Epoch: 2, Steps: 7 | Train Loss: 0.286 Vali Loss: 2.026 Vali Acc: 0.480 Test Loss: 2.026 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479980).  Saving model ...
Epoch: 3 cost time: 1.476505994796753
Epoch: 3, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.261 Vali Acc: 0.440 Test Loss: 3.261 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5062015056610107
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.924 Vali Acc: 0.360 Test Loss: 2.924 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6733348369598389
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.414 Vali Acc: 0.440 Test Loss: 3.414 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3777997493743896
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.248 Vali Acc: 0.420 Test Loss: 5.248 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.355593204498291
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.921 Vali Acc: 0.420 Test Loss: 5.921 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4938840866088867
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.242 Vali Acc: 0.400 Test Loss: 5.242 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4867355823516846
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.472 Vali Acc: 0.460 Test Loss: 4.472 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5231914520263672
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.119 Vali Acc: 0.480 Test Loss: 4.119 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3624696731567383
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.952 Vali Acc: 0.480 Test Loss: 3.952 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5282132625579834
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.460 Test Loss: 3.870 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2318447
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8145968914031982
Epoch: 1, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.282451868057251
Epoch: 2, Steps: 7 | Train Loss: 0.149 Vali Loss: 2.020 Vali Acc: 0.520 Test Loss: 2.020 Test Acc: 0.520
Validation loss decreased (-0.399986 --> -0.519980).  Saving model ...
Epoch: 3 cost time: 1.4258344173431396
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.405 Vali Acc: 0.420 Test Loss: 2.405 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3848137855529785
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.919 Vali Acc: 0.460 Test Loss: 2.919 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5070059299468994
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.202 Vali Acc: 0.440 Test Loss: 3.202 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.230248212814331
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.388 Vali Acc: 0.460 Test Loss: 3.388 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.346398115158081
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.480 Test Loss: 3.497 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.360273838043213
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.558 Vali Acc: 0.480 Test Loss: 3.558 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3907411098480225
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.591 Vali Acc: 0.480 Test Loss: 3.591 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1971945762634277
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.607 Vali Acc: 0.480 Test Loss: 3.607 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3468694686889648
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.614 Vali Acc: 0.480 Test Loss: 3.614 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3599364757537842
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.480 Test Loss: 3.617 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2316655
model size : 8.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.333277940750122
Epoch: 1, Steps: 7 | Train Loss: 1.620 Vali Loss: 1.411 Vali Acc: 0.260 Test Loss: 1.411 Test Acc: 0.260
Validation loss decreased (inf --> -0.259986).  Saving model ...
Epoch: 2 cost time: 1.1398100852966309
Epoch: 2, Steps: 7 | Train Loss: 0.209 Vali Loss: 1.889 Vali Acc: 0.480 Test Loss: 1.889 Test Acc: 0.480
Validation loss decreased (-0.259986 --> -0.479981).  Saving model ...
Epoch: 3 cost time: 1.1149029731750488
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.560 Test Loss: 1.671 Test Acc: 0.560
Validation loss decreased (-0.479981 --> -0.559983).  Saving model ...
Epoch: 4 cost time: 1.1825215816497803
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.407 Vali Acc: 0.540 Test Loss: 2.407 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0699975490570068
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.414 Vali Acc: 0.500 Test Loss: 3.414 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1173124313354492
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.081 Vali Acc: 0.500 Test Loss: 4.081 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.00362229347229
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.468 Vali Acc: 0.500 Test Loss: 4.468 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1248462200164795
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.658 Vali Acc: 0.500 Test Loss: 4.658 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0334115028381348
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.722 Vali Acc: 0.500 Test Loss: 4.722 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0666253566741943
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.668 Vali Acc: 0.500 Test Loss: 4.668 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2065198421478271
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.631 Vali Acc: 0.500 Test Loss: 4.631 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1444666385650635
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.607 Vali Acc: 0.500 Test Loss: 4.607 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1020631790161133
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.590 Vali Acc: 0.500 Test Loss: 4.590 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2315119
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.65057110786438
Epoch: 1, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.328 Vali Acc: 0.440 Test Loss: 1.328 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.1954071521759033
Epoch: 2, Steps: 7 | Train Loss: 0.167 Vali Loss: 1.905 Vali Acc: 0.440 Test Loss: 1.905 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1840386390686035
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.267 Vali Acc: 0.480 Test Loss: 2.267 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479977).  Saving model ...
Epoch: 4 cost time: 1.4586765766143799
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.361 Vali Acc: 0.580 Test Loss: 2.361 Test Acc: 0.580
Validation loss decreased (-0.479977 --> -0.579976).  Saving model ...
Epoch: 5 cost time: 1.1172394752502441
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.580 Test Loss: 2.483 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3018770217895508
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.579 Vali Acc: 0.600 Test Loss: 2.579 Test Acc: 0.600
Validation loss decreased (-0.579976 --> -0.599974).  Saving model ...
Epoch: 7 cost time: 1.104325294494629
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.600 Test Loss: 2.639 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1343796253204346
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.673 Vali Acc: 0.600 Test Loss: 2.673 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1627702713012695
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.692 Vali Acc: 0.600 Test Loss: 2.692 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2399282455444336
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.600 Test Loss: 2.702 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.117844820022583
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.707 Vali Acc: 0.600 Test Loss: 2.707 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1282930374145508
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.710 Vali Acc: 0.600 Test Loss: 2.710 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9806597232818604
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.600 Test Loss: 2.711 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0158402919769287
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.600 Test Loss: 2.711 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0389165878295898
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.600 Test Loss: 2.711 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0026781558990479
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.600 Test Loss: 2.711 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2313327
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.046617269515991
Epoch: 1, Steps: 7 | Train Loss: 1.557 Vali Loss: 1.263 Vali Acc: 0.420 Test Loss: 1.263 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.8906536102294922
Epoch: 2, Steps: 7 | Train Loss: 0.182 Vali Loss: 1.591 Vali Acc: 0.480 Test Loss: 1.591 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479984).  Saving model ...
Epoch: 3 cost time: 0.8746011257171631
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.055 Vali Acc: 0.520 Test Loss: 2.055 Test Acc: 0.520
Validation loss decreased (-0.479984 --> -0.519979).  Saving model ...
Epoch: 4 cost time: 1.0044748783111572
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.500 Test Loss: 2.409 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8842461109161377
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.676 Vali Acc: 0.500 Test Loss: 2.676 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9728643894195557
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.851 Vali Acc: 0.520 Test Loss: 2.851 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0456044673919678
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.955 Vali Acc: 0.520 Test Loss: 2.955 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9465491771697998
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.014 Vali Acc: 0.520 Test Loss: 3.014 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9294986724853516
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.047 Vali Acc: 0.520 Test Loss: 3.047 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8561933040618896
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.064 Vali Acc: 0.520 Test Loss: 3.064 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9475531578063965
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.073 Vali Acc: 0.520 Test Loss: 3.073 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9536125659942627
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.520 Test Loss: 3.077 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9303622245788574
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.079 Vali Acc: 0.520 Test Loss: 3.079 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2312047
model size : 8.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2091739177703857
Epoch: 1, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.9304208755493164
Epoch: 2, Steps: 7 | Train Loss: 0.183 Vali Loss: 1.835 Vali Acc: 0.500 Test Loss: 1.835 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8890769481658936
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.253 Vali Acc: 0.440 Test Loss: 2.253 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8797385692596436
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.681 Vali Acc: 0.460 Test Loss: 2.681 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8825080394744873
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.998 Vali Acc: 0.420 Test Loss: 2.998 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9253325462341309
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.193 Vali Acc: 0.400 Test Loss: 3.193 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8388707637786865
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.302 Vali Acc: 0.400 Test Loss: 3.302 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8901016712188721
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.360 Vali Acc: 0.400 Test Loss: 3.360 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8124403953552246
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.389 Vali Acc: 0.400 Test Loss: 3.389 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.948453426361084
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.402 Vali Acc: 0.400 Test Loss: 3.402 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8124027252197266
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.407 Vali Acc: 0.400 Test Loss: 3.407 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2311279
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.923720121383667
Epoch: 1, Steps: 7 | Train Loss: 1.762 Vali Loss: 1.317 Vali Acc: 0.420 Test Loss: 1.317 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.6849935054779053
Epoch: 2, Steps: 7 | Train Loss: 0.103 Vali Loss: 1.475 Vali Acc: 0.520 Test Loss: 1.475 Test Acc: 0.520
Validation loss decreased (-0.419987 --> -0.519985).  Saving model ...
Epoch: 3 cost time: 0.779954195022583
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.633 Vali Acc: 0.520 Test Loss: 2.633 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8096163272857666
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.387 Vali Acc: 0.520 Test Loss: 3.387 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7124385833740234
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.839 Vali Acc: 0.520 Test Loss: 3.839 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0977168083190918
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.095 Vali Acc: 0.520 Test Loss: 4.095 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.796252965927124
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.238 Vali Acc: 0.520 Test Loss: 4.238 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8875656127929688
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.315 Vali Acc: 0.520 Test Loss: 4.315 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8772618770599365
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.347 Vali Acc: 0.520 Test Loss: 4.347 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8781442642211914
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.361 Vali Acc: 0.520 Test Loss: 4.361 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8585085868835449
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.368 Vali Acc: 0.520 Test Loss: 4.368 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9915039539337158
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.370 Vali Acc: 0.520 Test Loss: 4.370 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2310511
model size : 8.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0520200729370117
Epoch: 1, Steps: 7 | Train Loss: 1.560 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.7135241031646729
Epoch: 2, Steps: 7 | Train Loss: 0.219 Vali Loss: 1.703 Vali Acc: 0.460 Test Loss: 1.703 Test Acc: 0.460
Validation loss decreased (-0.399987 --> -0.459983).  Saving model ...
Epoch: 3 cost time: 0.797389030456543
Epoch: 3, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.499 Vali Acc: 0.460 Test Loss: 2.499 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7941939830780029
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.628 Vali Acc: 0.500 Test Loss: 2.628 Test Acc: 0.500
Validation loss decreased (-0.459983 --> -0.499974).  Saving model ...
Epoch: 5 cost time: 0.68487548828125
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.500 Test Loss: 2.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6571528911590576
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.480 Test Loss: 2.895 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7094390392303467
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.967 Vali Acc: 0.480 Test Loss: 2.967 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6973690986633301
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.009 Vali Acc: 0.480 Test Loss: 3.009 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6910059452056885
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.480 Test Loss: 3.032 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.717322826385498
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.045 Vali Acc: 0.480 Test Loss: 3.045 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6843912601470947
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.052 Vali Acc: 0.480 Test Loss: 3.052 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7082715034484863
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.055 Vali Acc: 0.480 Test Loss: 3.055 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7514240741729736
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.480 Test Loss: 3.057 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7265689373016357
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.058 Vali Acc: 0.480 Test Loss: 3.058 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2309999
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.791393756866455
Epoch: 1, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.5293457508087158
Epoch: 2, Steps: 7 | Train Loss: 0.208 Vali Loss: 1.695 Vali Acc: 0.540 Test Loss: 1.695 Test Acc: 0.540
Validation loss decreased (-0.399985 --> -0.539983).  Saving model ...
Epoch: 3 cost time: 1.289414405822754
Epoch: 3, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.540 Test Loss: 1.795 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3905539512634277
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.094 Vali Acc: 0.580 Test Loss: 2.094 Test Acc: 0.580
Validation loss decreased (-0.539983 --> -0.579979).  Saving model ...
Epoch: 5 cost time: 1.3745720386505127
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.580 Test Loss: 2.355 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3904128074645996
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.580 Test Loss: 2.528 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4432001113891602
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.628 Vali Acc: 0.580 Test Loss: 2.628 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4192993640899658
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.580 Test Loss: 2.685 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5875792503356934
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.715 Vali Acc: 0.580 Test Loss: 2.715 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3985943794250488
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.580 Test Loss: 2.731 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3313570022583008
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.739 Vali Acc: 0.580 Test Loss: 2.739 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4886348247528076
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.743 Vali Acc: 0.580 Test Loss: 2.743 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3870291709899902
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.745 Vali Acc: 0.580 Test Loss: 2.745 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4938771724700928
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.580 Test Loss: 2.744 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2146223
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7012791633605957
Epoch: 1, Steps: 7 | Train Loss: 1.688 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.3329198360443115
Epoch: 2, Steps: 7 | Train Loss: 0.221 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
Validation loss decreased (-0.399987 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 1.2506418228149414
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.173 Vali Acc: 0.480 Test Loss: 2.173 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.258514642715454
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.379 Vali Acc: 0.500 Test Loss: 2.379 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2869908809661865
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.816 Vali Acc: 0.460 Test Loss: 2.816 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3513669967651367
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.092 Vali Acc: 0.500 Test Loss: 3.092 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2670300006866455
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.224 Vali Acc: 0.480 Test Loss: 3.224 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3701767921447754
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.480 Test Loss: 3.263 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2750039100646973
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.278 Vali Acc: 0.480 Test Loss: 3.278 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4303040504455566
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.277 Vali Acc: 0.480 Test Loss: 3.277 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2430133819580078
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.273 Vali Acc: 0.480 Test Loss: 3.273 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3805129528045654
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.266 Vali Acc: 0.480 Test Loss: 3.266 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2144431
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2052462100982666
Epoch: 1, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.442 Vali Acc: 0.360 Test Loss: 1.442 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 1.101933479309082
Epoch: 2, Steps: 7 | Train Loss: 0.202 Vali Loss: 2.303 Vali Acc: 0.540 Test Loss: 2.303 Test Acc: 0.540
Validation loss decreased (-0.359986 --> -0.539977).  Saving model ...
Epoch: 3 cost time: 1.0979790687561035
Epoch: 3, Steps: 7 | Train Loss: 0.062 Vali Loss: 1.823 Vali Acc: 0.540 Test Loss: 1.823 Test Acc: 0.540
Validation loss decreased (-0.539977 --> -0.539982).  Saving model ...
Epoch: 4 cost time: 1.2779922485351562
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.455 Vali Acc: 0.540 Test Loss: 2.455 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1384446620941162
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.671 Vali Acc: 0.520 Test Loss: 2.671 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2471210956573486
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.709 Vali Acc: 0.400 Test Loss: 3.709 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3601181507110596
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.506 Vali Acc: 0.400 Test Loss: 4.506 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.349247694015503
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.543 Vali Acc: 0.420 Test Loss: 4.543 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.324387550354004
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.407 Vali Acc: 0.420 Test Loss: 4.407 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2972118854522705
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.297 Vali Acc: 0.420 Test Loss: 4.297 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2977383136749268
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.230 Vali Acc: 0.440 Test Loss: 4.230 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3482372760772705
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.186 Vali Acc: 0.460 Test Loss: 4.186 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2998783588409424
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.157 Vali Acc: 0.460 Test Loss: 4.157 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2142895
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4534010887145996
Epoch: 1, Steps: 7 | Train Loss: 1.625 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.1184165477752686
Epoch: 2, Steps: 7 | Train Loss: 0.290 Vali Loss: 1.542 Vali Acc: 0.500 Test Loss: 1.542 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 1.1163947582244873
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.809 Vali Acc: 0.560 Test Loss: 1.809 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559982).  Saving model ...
Epoch: 4 cost time: 1.1769776344299316
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.206 Vali Acc: 0.500 Test Loss: 3.206 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0086743831634521
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.931 Vali Acc: 0.480 Test Loss: 3.931 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9771914482116699
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.992 Vali Acc: 0.580 Test Loss: 2.992 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579970).  Saving model ...
Epoch: 7 cost time: 0.9683728218078613
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.927 Vali Acc: 0.520 Test Loss: 2.927 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0573065280914307
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.090 Vali Acc: 0.520 Test Loss: 3.090 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9883227348327637
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.228 Vali Acc: 0.520 Test Loss: 3.228 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.910991907119751
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.520 Test Loss: 3.309 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.951157808303833
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.347 Vali Acc: 0.520 Test Loss: 3.347 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.015207290649414
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.358 Vali Acc: 0.500 Test Loss: 3.358 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0068645477294922
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.357 Vali Acc: 0.500 Test Loss: 3.357 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.013338327407837
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.352 Vali Acc: 0.500 Test Loss: 3.352 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0381929874420166
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.348 Vali Acc: 0.500 Test Loss: 3.348 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9972739219665527
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.343 Vali Acc: 0.500 Test Loss: 3.343 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2141103
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3707966804504395
Epoch: 1, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.286 Vali Acc: 0.460 Test Loss: 1.286 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 0.9386947154998779
Epoch: 2, Steps: 7 | Train Loss: 0.273 Vali Loss: 1.544 Vali Acc: 0.580 Test Loss: 1.544 Test Acc: 0.580
Validation loss decreased (-0.459987 --> -0.579985).  Saving model ...
Epoch: 3 cost time: 0.9330971240997314
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.904 Vali Acc: 0.560 Test Loss: 1.904 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9422638416290283
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.619 Vali Acc: 0.520 Test Loss: 2.619 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0194473266601562
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.540 Test Loss: 3.159 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9977066516876221
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.560 Test Loss: 3.501 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0531463623046875
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.701 Vali Acc: 0.560 Test Loss: 3.701 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0920240879058838
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.812 Vali Acc: 0.540 Test Loss: 3.812 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9515070915222168
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.872 Vali Acc: 0.520 Test Loss: 3.872 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0529165267944336
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.904 Vali Acc: 0.520 Test Loss: 3.904 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9394259452819824
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.919 Vali Acc: 0.520 Test Loss: 3.919 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0360124111175537
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.926 Vali Acc: 0.520 Test Loss: 3.926 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2139823
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.184809446334839
Epoch: 1, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.290 Vali Acc: 0.360 Test Loss: 1.290 Test Acc: 0.360
Validation loss decreased (inf --> -0.359987).  Saving model ...
Epoch: 2 cost time: 0.8136205673217773
Epoch: 2, Steps: 7 | Train Loss: 0.191 Vali Loss: 1.824 Vali Acc: 0.440 Test Loss: 1.824 Test Acc: 0.440
Validation loss decreased (-0.359987 --> -0.439982).  Saving model ...
Epoch: 3 cost time: 0.9006831645965576
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.457 Vali Acc: 0.480 Test Loss: 2.457 Test Acc: 0.480
Validation loss decreased (-0.439982 --> -0.479975).  Saving model ...
Epoch: 4 cost time: 0.8505895137786865
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.514 Vali Acc: 0.600 Test Loss: 2.514 Test Acc: 0.600
Validation loss decreased (-0.479975 --> -0.599975).  Saving model ...
Epoch: 5 cost time: 0.9196460247039795
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.752 Vali Acc: 0.560 Test Loss: 2.752 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.819817066192627
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.946 Vali Acc: 0.560 Test Loss: 2.946 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7794170379638672
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.560 Test Loss: 3.063 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9002985954284668
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.126 Vali Acc: 0.560 Test Loss: 3.126 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9432215690612793
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.150 Vali Acc: 0.560 Test Loss: 3.150 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8253939151763916
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.160 Vali Acc: 0.560 Test Loss: 3.160 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8216104507446289
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.164 Vali Acc: 0.560 Test Loss: 3.164 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8535182476043701
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.560 Test Loss: 3.162 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8533527851104736
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.160 Vali Acc: 0.560 Test Loss: 3.160 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.877427339553833
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.157 Vali Acc: 0.560 Test Loss: 3.157 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2139055
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.075011730194092
Epoch: 1, Steps: 7 | Train Loss: 1.613 Vali Loss: 1.368 Vali Acc: 0.460 Test Loss: 1.368 Test Acc: 0.460
Validation loss decreased (inf --> -0.459986).  Saving model ...
Epoch: 2 cost time: 0.8323278427124023
Epoch: 2, Steps: 7 | Train Loss: 0.239 Vali Loss: 1.769 Vali Acc: 0.520 Test Loss: 1.769 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519982).  Saving model ...
Epoch: 3 cost time: 0.8434150218963623
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.519 Vali Acc: 0.540 Test Loss: 1.519 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539985).  Saving model ...
Epoch: 4 cost time: 0.8637938499450684
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.620 Test Loss: 1.672 Test Acc: 0.620
Validation loss decreased (-0.539985 --> -0.619983).  Saving model ...
Epoch: 5 cost time: 0.925128698348999
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.500 Test Loss: 2.485 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9114809036254883
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.191 Vali Acc: 0.480 Test Loss: 3.191 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9322607517242432
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.480 Test Loss: 3.617 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8232882022857666
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.838 Vali Acc: 0.480 Test Loss: 3.838 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8666980266571045
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.927 Vali Acc: 0.480 Test Loss: 3.927 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8512866497039795
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.952 Vali Acc: 0.480 Test Loss: 3.952 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8628971576690674
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.955 Vali Acc: 0.480 Test Loss: 3.955 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.874767541885376
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.948 Vali Acc: 0.480 Test Loss: 3.948 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9510829448699951
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.936 Vali Acc: 0.480 Test Loss: 3.936 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8939352035522461
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.925 Vali Acc: 0.480 Test Loss: 3.925 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2138287
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9701321125030518
Epoch: 1, Steps: 7 | Train Loss: 1.541 Vali Loss: 1.307 Vali Acc: 0.480 Test Loss: 1.307 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 0.59912109375
Epoch: 2, Steps: 7 | Train Loss: 0.197 Vali Loss: 1.664 Vali Acc: 0.560 Test Loss: 1.664 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559983).  Saving model ...
Epoch: 3 cost time: 0.6406185626983643
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.085 Vali Acc: 0.540 Test Loss: 2.085 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7356679439544678
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.540 Test Loss: 2.935 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6982660293579102
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.554 Vali Acc: 0.520 Test Loss: 3.554 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8051342964172363
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.838 Vali Acc: 0.540 Test Loss: 3.838 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7405345439910889
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.951 Vali Acc: 0.540 Test Loss: 3.951 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6628031730651855
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.002 Vali Acc: 0.540 Test Loss: 4.002 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7413523197174072
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.028 Vali Acc: 0.540 Test Loss: 4.028 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6176726818084717
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.040 Vali Acc: 0.540 Test Loss: 4.040 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7272059917449951
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.044 Vali Acc: 0.540 Test Loss: 4.044 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7760307788848877
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.044 Vali Acc: 0.540 Test Loss: 4.044 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2137775
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.995912790298462
Epoch: 1, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.445 Vali Acc: 0.320 Test Loss: 1.445 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.582627773284912
Epoch: 2, Steps: 7 | Train Loss: 0.215 Vali Loss: 1.435 Vali Acc: 0.520 Test Loss: 1.435 Test Acc: 0.520
Validation loss decreased (-0.319986 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 1.4807138442993164
Epoch: 3, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.741 Vali Acc: 0.560 Test Loss: 1.741 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559983).  Saving model ...
Epoch: 4 cost time: 1.6820552349090576
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.343 Vali Acc: 0.460 Test Loss: 3.343 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5068330764770508
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.390 Vali Acc: 0.600 Test Loss: 2.390 Test Acc: 0.600
Validation loss decreased (-0.559983 --> -0.599976).  Saving model ...
Epoch: 6 cost time: 1.494701862335205
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.600 Test Loss: 2.329 Test Acc: 0.600
Validation loss decreased (-0.599976 --> -0.599977).  Saving model ...
Epoch: 7 cost time: 1.2357728481292725
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.600 Test Loss: 2.402 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.510288953781128
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.600 Test Loss: 2.470 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4276812076568604
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.580 Test Loss: 2.513 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6589112281799316
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.536 Vali Acc: 0.580 Test Loss: 2.536 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2899444103240967
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.580 Test Loss: 2.547 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4701271057128906
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.580 Test Loss: 2.552 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3989806175231934
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.580 Test Loss: 2.552 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3358385562896729
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.551 Vali Acc: 0.580 Test Loss: 2.551 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4702627658843994
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.580 Test Loss: 2.549 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4179902076721191
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.580 Test Loss: 2.546 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2060111
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.503190517425537
Epoch: 1, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.284 Vali Acc: 0.540 Test Loss: 1.284 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 1.29268479347229
Epoch: 2, Steps: 7 | Train Loss: 0.300 Vali Loss: 2.047 Vali Acc: 0.500 Test Loss: 2.047 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3737084865570068
Epoch: 3, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.370 Vali Acc: 0.480 Test Loss: 2.370 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2917234897613525
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.862 Vali Acc: 0.420 Test Loss: 2.862 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2997395992279053
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.547 Vali Acc: 0.400 Test Loss: 3.547 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.358281135559082
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.932 Vali Acc: 0.420 Test Loss: 3.932 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3672370910644531
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.980 Vali Acc: 0.380 Test Loss: 3.980 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3035848140716553
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.685 Vali Acc: 0.380 Test Loss: 3.685 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3198349475860596
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.780 Vali Acc: 0.400 Test Loss: 3.780 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4810774326324463
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.862 Vali Acc: 0.400 Test Loss: 3.862 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2752649784088135
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.885 Vali Acc: 0.420 Test Loss: 3.885 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2058319
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.391434669494629
Epoch: 1, Steps: 7 | Train Loss: 1.814 Vali Loss: 1.418 Vali Acc: 0.400 Test Loss: 1.418 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.0372109413146973
Epoch: 2, Steps: 7 | Train Loss: 0.205 Vali Loss: 2.156 Vali Acc: 0.460 Test Loss: 2.156 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459978).  Saving model ...
Epoch: 3 cost time: 1.1903133392333984
Epoch: 3, Steps: 7 | Train Loss: 0.024 Vali Loss: 1.580 Vali Acc: 0.620 Test Loss: 1.580 Test Acc: 0.620
Validation loss decreased (-0.459978 --> -0.619984).  Saving model ...
Epoch: 4 cost time: 1.1475560665130615
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.983 Vali Acc: 0.520 Test Loss: 1.983 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1892755031585693
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.816 Vali Acc: 0.460 Test Loss: 2.816 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.158773422241211
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.409 Vali Acc: 0.420 Test Loss: 3.409 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2337267398834229
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.768 Vali Acc: 0.440 Test Loss: 3.768 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3097693920135498
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.940 Vali Acc: 0.420 Test Loss: 3.940 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3431196212768555
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.993 Vali Acc: 0.420 Test Loss: 3.993 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1969950199127197
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.005 Vali Acc: 0.420 Test Loss: 4.005 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.274719476699829
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.420 Test Loss: 3.998 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3665664196014404
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.980 Vali Acc: 0.400 Test Loss: 3.980 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3030791282653809
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.961 Vali Acc: 0.400 Test Loss: 3.961 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2056783
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4083218574523926
Epoch: 1, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.314 Vali Acc: 0.340 Test Loss: 1.314 Test Acc: 0.340
Validation loss decreased (inf --> -0.339987).  Saving model ...
Epoch: 2 cost time: 1.0438010692596436
Epoch: 2, Steps: 7 | Train Loss: 0.208 Vali Loss: 1.468 Vali Acc: 0.560 Test Loss: 1.468 Test Acc: 0.560
Validation loss decreased (-0.339987 --> -0.559985).  Saving model ...
Epoch: 3 cost time: 1.0003058910369873
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0753519535064697
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.736 Vali Acc: 0.460 Test Loss: 2.736 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.027529001235962
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.533 Vali Acc: 0.420 Test Loss: 3.533 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0605266094207764
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.727 Vali Acc: 0.440 Test Loss: 3.727 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9647676944732666
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.684 Vali Acc: 0.440 Test Loss: 3.684 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0715763568878174
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.500 Test Loss: 3.638 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.018080711364746
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.500 Test Loss: 3.601 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.068507432937622
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.577 Vali Acc: 0.500 Test Loss: 3.577 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.029599666595459
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.559 Vali Acc: 0.500 Test Loss: 3.559 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.056117296218872
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.542 Vali Acc: 0.500 Test Loss: 3.542 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2054991
model size : 7.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3557403087615967
Epoch: 1, Steps: 7 | Train Loss: 1.741 Vali Loss: 1.514 Vali Acc: 0.400 Test Loss: 1.514 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.0396232604980469
Epoch: 2, Steps: 7 | Train Loss: 0.399 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.0893754959106445
Epoch: 3, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 0.9842193126678467
Epoch: 4, Steps: 7 | Train Loss: 0.074 Vali Loss: 2.127 Vali Acc: 0.540 Test Loss: 2.127 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539979).  Saving model ...
Epoch: 5 cost time: 0.9946448802947998
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.333 Vali Acc: 0.520 Test Loss: 3.333 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0488641262054443
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.337 Vali Acc: 0.480 Test Loss: 4.337 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9794785976409912
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.904 Vali Acc: 0.480 Test Loss: 4.904 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0807616710662842
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.160 Vali Acc: 0.440 Test Loss: 5.160 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9274008274078369
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.226 Vali Acc: 0.440 Test Loss: 5.226 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.999075174331665
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.210 Vali Acc: 0.460 Test Loss: 5.210 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.05979323387146
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.178 Vali Acc: 0.460 Test Loss: 5.178 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0649797916412354
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.145 Vali Acc: 0.460 Test Loss: 5.145 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.04567289352417
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.113 Vali Acc: 0.460 Test Loss: 5.113 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9282817840576172
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.077 Vali Acc: 0.460 Test Loss: 5.077 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2053711
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1206908226013184
Epoch: 1, Steps: 7 | Train Loss: 1.703 Vali Loss: 1.414 Vali Acc: 0.340 Test Loss: 1.414 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 0.8765928745269775
Epoch: 2, Steps: 7 | Train Loss: 0.228 Vali Loss: 1.511 Vali Acc: 0.580 Test Loss: 1.511 Test Acc: 0.580
Validation loss decreased (-0.339986 --> -0.579985).  Saving model ...
Epoch: 3 cost time: 0.8710839748382568
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.851 Vali Acc: 0.600 Test Loss: 1.851 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599981).  Saving model ...
Epoch: 4 cost time: 0.8873412609100342
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.600 Test Loss: 2.088 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8546543121337891
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.600 Test Loss: 2.001 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9472270011901855
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.600 Test Loss: 2.042 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0299291610717773
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.094 Vali Acc: 0.600 Test Loss: 2.094 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9396083354949951
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.600 Test Loss: 2.132 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9075918197631836
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.154 Vali Acc: 0.600 Test Loss: 2.154 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8270399570465088
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.600 Test Loss: 2.166 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8935806751251221
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.600 Test Loss: 2.172 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9328875541687012
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.600 Test Loss: 2.174 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9456577301025391
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.600 Test Loss: 2.174 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2052943
model size : 7.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1343941688537598
Epoch: 1, Steps: 7 | Train Loss: 1.755 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 0.7980334758758545
Epoch: 2, Steps: 7 | Train Loss: 0.201 Vali Loss: 1.375 Vali Acc: 0.560 Test Loss: 1.375 Test Acc: 0.560
Validation loss decreased (-0.419985 --> -0.559986).  Saving model ...
Epoch: 3 cost time: 0.808068037033081
Epoch: 3, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.205 Vali Acc: 0.520 Test Loss: 2.205 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7808606624603271
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.144 Vali Acc: 0.600 Test Loss: 3.144 Test Acc: 0.600
Validation loss decreased (-0.559986 --> -0.599969).  Saving model ...
Epoch: 5 cost time: 0.7934596538543701
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.540 Test Loss: 3.077 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9337055683135986
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.211 Vali Acc: 0.520 Test Loss: 3.211 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7824244499206543
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.520 Test Loss: 3.339 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7818503379821777
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.422 Vali Acc: 0.520 Test Loss: 3.422 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8522350788116455
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.470 Vali Acc: 0.520 Test Loss: 3.470 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.880584716796875
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.496 Vali Acc: 0.520 Test Loss: 3.496 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8757092952728271
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.509 Vali Acc: 0.500 Test Loss: 3.509 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7585465908050537
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.513 Vali Acc: 0.500 Test Loss: 3.513 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8412458896636963
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.514 Vali Acc: 0.500 Test Loss: 3.514 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8610436916351318
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.513 Vali Acc: 0.500 Test Loss: 3.513 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2052175
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.062047004699707
Epoch: 1, Steps: 7 | Train Loss: 1.560 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.8050668239593506
Epoch: 2, Steps: 7 | Train Loss: 0.487 Vali Loss: 1.810 Vali Acc: 0.420 Test Loss: 1.810 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419982).  Saving model ...
Epoch: 3 cost time: 0.7979717254638672
Epoch: 3, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.924 Vali Acc: 0.560 Test Loss: 1.924 Test Acc: 0.560
Validation loss decreased (-0.419982 --> -0.559981).  Saving model ...
Epoch: 4 cost time: 0.8032331466674805
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.460 Test Loss: 2.694 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.845245361328125
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.580 Test Loss: 2.469 Test Acc: 0.580
Validation loss decreased (-0.559981 --> -0.579975).  Saving model ...
Epoch: 6 cost time: 0.8205785751342773
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.560 Test Loss: 2.409 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8157222270965576
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.420 Vali Acc: 0.640 Test Loss: 2.420 Test Acc: 0.640
Validation loss decreased (-0.579975 --> -0.639976).  Saving model ...
Epoch: 8 cost time: 0.7953975200653076
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.436 Vali Acc: 0.640 Test Loss: 2.436 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7379918098449707
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.640 Test Loss: 2.447 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8253343105316162
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.640 Test Loss: 2.453 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8184390068054199
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.620 Test Loss: 2.456 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8025662899017334
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.620 Test Loss: 2.457 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8486177921295166
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.620 Test Loss: 2.458 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8988358974456787
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.620 Test Loss: 2.458 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7622497081756592
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.620 Test Loss: 2.457 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8032634258270264
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.620 Test Loss: 2.457 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.809800386428833
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.620 Test Loss: 2.456 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2051663
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7312567234039307
Epoch: 1, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.456 Vali Acc: 0.320 Test Loss: 1.456 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.3929054737091064
Epoch: 2, Steps: 7 | Train Loss: 0.234 Vali Loss: 1.645 Vali Acc: 0.520 Test Loss: 1.645 Test Acc: 0.520
Validation loss decreased (-0.319985 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 1.7010185718536377
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.105 Vali Acc: 0.560 Test Loss: 2.105 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559979).  Saving model ...
Epoch: 4 cost time: 1.6036601066589355
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.395 Vali Acc: 0.560 Test Loss: 2.395 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6953554153442383
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.560 Test Loss: 2.685 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5804953575134277
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.600 Test Loss: 3.243 Test Acc: 0.600
Validation loss decreased (-0.559979 --> -0.599968).  Saving model ...
Epoch: 7 cost time: 1.7031807899475098
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.252 Vali Acc: 0.580 Test Loss: 3.252 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7725944519042969
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.520 Test Loss: 3.309 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.568310260772705
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.528 Vali Acc: 0.500 Test Loss: 3.528 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6795127391815186
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.670 Vali Acc: 0.520 Test Loss: 3.670 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.499540090560913
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.746 Vali Acc: 0.500 Test Loss: 3.746 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6120874881744385
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.780 Vali Acc: 0.500 Test Loss: 3.780 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4636852741241455
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.793 Vali Acc: 0.500 Test Loss: 3.793 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5574884414672852
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.795 Vali Acc: 0.500 Test Loss: 3.795 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3409168720245361
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.790 Vali Acc: 0.500 Test Loss: 3.790 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.51021146774292
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.780 Vali Acc: 0.500 Test Loss: 3.780 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2017055
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5199477672576904
Epoch: 1, Steps: 7 | Train Loss: 1.731 Vali Loss: 1.706 Vali Acc: 0.300 Test Loss: 1.706 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.2429583072662354
Epoch: 2, Steps: 7 | Train Loss: 0.365 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
Validation loss decreased (-0.299983 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.2929911613464355
Epoch: 3, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.663 Vali Acc: 0.500 Test Loss: 1.663 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 1.1847002506256104
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.753 Vali Acc: 0.400 Test Loss: 2.753 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2820968627929688
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.305 Vali Acc: 0.460 Test Loss: 3.305 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3861572742462158
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.247 Vali Acc: 0.400 Test Loss: 4.247 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2605273723602295
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.639 Vali Acc: 0.500 Test Loss: 2.639 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3437860012054443
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.047 Vali Acc: 0.480 Test Loss: 3.047 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3634865283966064
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.720 Vali Acc: 0.400 Test Loss: 6.720 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3652753829956055
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.498 Vali Acc: 0.400 Test Loss: 4.498 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3457913398742676
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.846 Vali Acc: 0.460 Test Loss: 3.846 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4679834842681885
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.070 Vali Acc: 0.500 Test Loss: 7.070 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.295457124710083
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.099 Vali Acc: 0.520 Test Loss: 4.099 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519959).  Saving model ...
Epoch: 14 cost time: 1.2735633850097656
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.929 Vali Acc: 0.520 Test Loss: 3.929 Test Acc: 0.520
Validation loss decreased (-0.519959 --> -0.519961).  Saving model ...
Epoch: 15 cost time: 1.359060287475586
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.843 Vali Acc: 0.580 Test Loss: 3.843 Test Acc: 0.580
Validation loss decreased (-0.519961 --> -0.579962).  Saving model ...
Epoch: 16 cost time: 1.406040906906128
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.186 Vali Acc: 0.540 Test Loss: 5.186 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3787600994110107
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.207 Vali Acc: 0.580 Test Loss: 4.207 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3588945865631104
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.577 Vali Acc: 0.540 Test Loss: 4.577 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4791011810302734
Epoch: 19, Steps: 7 | Train Loss: 0.129 Vali Loss: 4.333 Vali Acc: 0.540 Test Loss: 4.333 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4621949195861816
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.610 Vali Acc: 0.500 Test Loss: 7.610 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3895950317382812
Epoch: 21, Steps: 7 | Train Loss: 0.152 Vali Loss: 7.928 Vali Acc: 0.460 Test Loss: 7.928 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2878780364990234
Epoch: 22, Steps: 7 | Train Loss: 0.555 Vali Loss: 8.525 Vali Acc: 0.360 Test Loss: 8.525 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4373538494110107
Epoch: 23, Steps: 7 | Train Loss: 0.080 Vali Loss: 17.008 Vali Acc: 0.360 Test Loss: 17.008 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2349977493286133
Epoch: 24, Steps: 7 | Train Loss: 0.248 Vali Loss: 9.175 Vali Acc: 0.360 Test Loss: 9.175 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.381007432937622
Epoch: 25, Steps: 7 | Train Loss: 0.605 Vali Loss: 8.806 Vali Acc: 0.480 Test Loss: 8.806 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2015263
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.141516923904419
Epoch: 1, Steps: 7 | Train Loss: 1.616 Vali Loss: 1.392 Vali Acc: 0.420 Test Loss: 1.392 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 1.3370213508605957
Epoch: 2, Steps: 7 | Train Loss: 0.306 Vali Loss: 2.836 Vali Acc: 0.420 Test Loss: 2.836 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.220400333404541
Epoch: 3, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.942 Vali Acc: 0.460 Test Loss: 1.942 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459981).  Saving model ...
Epoch: 4 cost time: 1.2252206802368164
Epoch: 4, Steps: 7 | Train Loss: 0.150 Vali Loss: 2.781 Vali Acc: 0.500 Test Loss: 2.781 Test Acc: 0.500
Validation loss decreased (-0.459981 --> -0.499972).  Saving model ...
Epoch: 5 cost time: 1.283524990081787
Epoch: 5, Steps: 7 | Train Loss: 0.023 Vali Loss: 3.327 Vali Acc: 0.460 Test Loss: 3.327 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.419177532196045
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.215 Vali Acc: 0.380 Test Loss: 5.215 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2403647899627686
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.565 Vali Acc: 0.400 Test Loss: 5.565 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.259504795074463
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.343 Vali Acc: 0.380 Test Loss: 5.343 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2418665885925293
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.218 Vali Acc: 0.400 Test Loss: 5.218 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2129204273223877
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.116 Vali Acc: 0.400 Test Loss: 5.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1848723888397217
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.047 Vali Acc: 0.400 Test Loss: 5.047 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3216702938079834
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.002 Vali Acc: 0.400 Test Loss: 5.002 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2486579418182373
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.975 Vali Acc: 0.400 Test Loss: 4.975 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2427153587341309
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.956 Vali Acc: 0.400 Test Loss: 4.956 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2013727
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7735819816589355
Epoch: 1, Steps: 7 | Train Loss: 1.620 Vali Loss: 1.350 Vali Acc: 0.420 Test Loss: 1.350 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.051457405090332
Epoch: 2, Steps: 7 | Train Loss: 0.258 Vali Loss: 1.770 Vali Acc: 0.520 Test Loss: 1.770 Test Acc: 0.520
Validation loss decreased (-0.419987 --> -0.519982).  Saving model ...
Epoch: 3 cost time: 1.2705919742584229
Epoch: 3, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.319 Vali Acc: 0.480 Test Loss: 2.319 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1871912479400635
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.743 Vali Acc: 0.440 Test Loss: 3.743 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2416002750396729
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.026 Vali Acc: 0.420 Test Loss: 4.026 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1494290828704834
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.948 Vali Acc: 0.400 Test Loss: 3.948 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1570487022399902
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.901 Vali Acc: 0.440 Test Loss: 3.901 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1278374195098877
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.460 Test Loss: 3.870 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1790356636047363
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.840 Vali Acc: 0.460 Test Loss: 3.840 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1561639308929443
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.811 Vali Acc: 0.460 Test Loss: 3.811 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2711982727050781
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.770 Vali Acc: 0.460 Test Loss: 3.770 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1304404735565186
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.739 Vali Acc: 0.460 Test Loss: 3.739 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2011935
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1875057220458984
Epoch: 1, Steps: 7 | Train Loss: 1.651 Vali Loss: 1.449 Vali Acc: 0.420 Test Loss: 1.449 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 0.8711011409759521
Epoch: 2, Steps: 7 | Train Loss: 0.390 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
Validation loss decreased (-0.419986 --> -0.539985).  Saving model ...
Epoch: 3 cost time: 0.879683256149292
Epoch: 3, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.898 Vali Acc: 0.540 Test Loss: 1.898 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0010595321655273
Epoch: 4, Steps: 7 | Train Loss: 0.104 Vali Loss: 3.523 Vali Acc: 0.500 Test Loss: 3.523 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0011932849884033
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.939 Vali Acc: 0.480 Test Loss: 3.939 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9914834499359131
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.052 Vali Acc: 0.440 Test Loss: 5.052 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.025855302810669
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.667 Vali Acc: 0.440 Test Loss: 5.667 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0551791191101074
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.783 Vali Acc: 0.440 Test Loss: 5.783 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9975714683532715
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.759 Vali Acc: 0.420 Test Loss: 5.759 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0149714946746826
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.709 Vali Acc: 0.420 Test Loss: 5.709 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9595808982849121
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.664 Vali Acc: 0.420 Test Loss: 5.664 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9256315231323242
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.624 Vali Acc: 0.420 Test Loss: 5.624 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2010655
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0059731006622314
Epoch: 1, Steps: 7 | Train Loss: 1.619 Vali Loss: 1.525 Vali Acc: 0.440 Test Loss: 1.525 Test Acc: 0.440
Validation loss decreased (inf --> -0.439985).  Saving model ...
Epoch: 2 cost time: 0.7664406299591064
Epoch: 2, Steps: 7 | Train Loss: 0.235 Vali Loss: 1.730 Vali Acc: 0.460 Test Loss: 1.730 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459983).  Saving model ...
Epoch: 3 cost time: 0.8027582168579102
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.646 Vali Acc: 0.540 Test Loss: 1.646 Test Acc: 0.540
Validation loss decreased (-0.459983 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 0.8238751888275146
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.029 Vali Acc: 0.460 Test Loss: 3.029 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8657054901123047
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.029 Vali Acc: 0.440 Test Loss: 4.029 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8693222999572754
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.768 Vali Acc: 0.380 Test Loss: 4.768 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9140617847442627
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.017 Vali Acc: 0.380 Test Loss: 5.017 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7723052501678467
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.064 Vali Acc: 0.380 Test Loss: 5.064 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7848711013793945
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.994 Vali Acc: 0.400 Test Loss: 4.994 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7886838912963867
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.890 Vali Acc: 0.400 Test Loss: 4.890 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7839908599853516
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.809 Vali Acc: 0.420 Test Loss: 4.809 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8834719657897949
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.757 Vali Acc: 0.420 Test Loss: 4.757 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7737035751342773
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.718 Vali Acc: 0.440 Test Loss: 4.718 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2009887
model size : 7.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1774535179138184
Epoch: 1, Steps: 7 | Train Loss: 1.692 Vali Loss: 1.301 Vali Acc: 0.440 Test Loss: 1.301 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 0.9677984714508057
Epoch: 2, Steps: 7 | Train Loss: 0.215 Vali Loss: 1.651 Vali Acc: 0.480 Test Loss: 1.651 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479983).  Saving model ...
Epoch: 3 cost time: 0.8234870433807373
Epoch: 3, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.610 Vali Acc: 0.560 Test Loss: 2.610 Test Acc: 0.560
Validation loss decreased (-0.479983 --> -0.559974).  Saving model ...
Epoch: 4 cost time: 0.8080501556396484
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.988 Vali Acc: 0.380 Test Loss: 2.988 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9148778915405273
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.018 Vali Acc: 0.480 Test Loss: 3.018 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9612748622894287
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.015 Vali Acc: 0.560 Test Loss: 3.015 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8549537658691406
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.611 Vali Acc: 0.460 Test Loss: 4.611 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8711860179901123
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.475 Vali Acc: 0.460 Test Loss: 5.475 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8893778324127197
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.769 Vali Acc: 0.460 Test Loss: 5.769 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8910737037658691
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.920 Vali Acc: 0.460 Test Loss: 5.920 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8356544971466064
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.970 Vali Acc: 0.440 Test Loss: 5.970 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8927943706512451
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.984 Vali Acc: 0.440 Test Loss: 5.984 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9002118110656738
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.983 Vali Acc: 0.440 Test Loss: 5.983 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2009119
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0291976928710938
Epoch: 1, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.340 Vali Acc: 0.440 Test Loss: 1.340 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 0.8309834003448486
Epoch: 2, Steps: 7 | Train Loss: 0.242 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
Validation loss decreased (-0.439987 --> -0.599986).  Saving model ...
Epoch: 3 cost time: 0.7616047859191895
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.050 Vali Acc: 0.560 Test Loss: 2.050 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8895962238311768
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.458 Vali Acc: 0.500 Test Loss: 3.458 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8106400966644287
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.490 Vali Acc: 0.580 Test Loss: 2.490 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8061704635620117
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.139 Vali Acc: 0.660 Test Loss: 2.139 Test Acc: 0.660
Validation loss decreased (-0.599986 --> -0.659979).  Saving model ...
Epoch: 7 cost time: 0.8592545986175537
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.250 Vali Acc: 0.620 Test Loss: 2.250 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8127615451812744
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.383 Vali Acc: 0.580 Test Loss: 2.383 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7315011024475098
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.580 Test Loss: 2.469 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7790062427520752
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.508 Vali Acc: 0.580 Test Loss: 2.508 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7582833766937256
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.580 Test Loss: 2.522 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7761561870574951
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.580 Test Loss: 2.509 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.755279541015625
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.580 Test Loss: 2.494 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7785251140594482
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.482 Vali Acc: 0.620 Test Loss: 2.482 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7972583770751953
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.620 Test Loss: 2.475 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6952364444732666
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.620 Test Loss: 2.470 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2008607
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.592543125152588
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.511 Vali Acc: 0.320 Test Loss: 1.511 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.429811716079712
Epoch: 2, Steps: 7 | Train Loss: 0.519 Vali Loss: 2.073 Vali Acc: 0.440 Test Loss: 2.073 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439979).  Saving model ...
Epoch: 3 cost time: 1.4929978847503662
Epoch: 3, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.284 Vali Acc: 0.520 Test Loss: 2.284 Test Acc: 0.520
Validation loss decreased (-0.439979 --> -0.519977).  Saving model ...
Epoch: 4 cost time: 1.3824224472045898
Epoch: 4, Steps: 7 | Train Loss: 0.112 Vali Loss: 3.685 Vali Acc: 0.400 Test Loss: 3.685 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5703356266021729
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.550 Vali Acc: 0.420 Test Loss: 3.550 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4951303005218506
Epoch: 6, Steps: 7 | Train Loss: 0.110 Vali Loss: 6.115 Vali Acc: 0.380 Test Loss: 6.115 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3428418636322021
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.170 Vali Acc: 0.600 Test Loss: 3.170 Test Acc: 0.600
Validation loss decreased (-0.519977 --> -0.599968).  Saving model ...
Epoch: 8 cost time: 1.33404541015625
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.652 Vali Acc: 0.460 Test Loss: 3.652 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3007464408874512
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 5.495 Vali Acc: 0.440 Test Loss: 5.495 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6024296283721924
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 7.578 Vali Acc: 0.400 Test Loss: 7.578 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3438870906829834
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 9.270 Vali Acc: 0.360 Test Loss: 9.270 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.416048288345337
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.197 Vali Acc: 0.440 Test Loss: 8.197 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.404482364654541
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.462 Vali Acc: 0.400 Test Loss: 8.462 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3960554599761963
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.982 Vali Acc: 0.420 Test Loss: 8.982 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5391550064086914
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.623 Vali Acc: 0.400 Test Loss: 9.623 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.536426067352295
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.722 Vali Acc: 0.400 Test Loss: 9.722 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.497039794921875
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.748 Vali Acc: 0.400 Test Loss: 9.748 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1995527
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7153255939483643
Epoch: 1, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.663 Vali Acc: 0.240 Test Loss: 1.663 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.411550521850586
Epoch: 2, Steps: 7 | Train Loss: 0.647 Vali Loss: 1.992 Vali Acc: 0.460 Test Loss: 1.992 Test Acc: 0.460
Validation loss decreased (-0.239983 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 1.512763500213623
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 3.039 Vali Acc: 0.440 Test Loss: 3.039 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6047720909118652
Epoch: 4, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.052 Vali Acc: 0.440 Test Loss: 2.052 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4084901809692383
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.622 Vali Acc: 0.500 Test Loss: 2.622 Test Acc: 0.500
Validation loss decreased (-0.459980 --> -0.499974).  Saving model ...
Epoch: 6 cost time: 1.303246021270752
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.539 Vali Acc: 0.420 Test Loss: 3.539 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4227089881896973
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.113 Vali Acc: 0.440 Test Loss: 4.113 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4236433506011963
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.311 Vali Acc: 0.460 Test Loss: 4.311 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3435466289520264
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.355 Vali Acc: 0.460 Test Loss: 4.355 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4428951740264893
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.344 Vali Acc: 0.460 Test Loss: 4.344 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4026274681091309
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.308 Vali Acc: 0.460 Test Loss: 4.308 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3130309581756592
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.266 Vali Acc: 0.460 Test Loss: 4.266 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3893308639526367
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.223 Vali Acc: 0.460 Test Loss: 4.223 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4360241889953613
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.182 Vali Acc: 0.460 Test Loss: 4.182 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4512057304382324
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.150 Vali Acc: 0.460 Test Loss: 4.150 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1993735
model size : 7.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.731679916381836
Epoch: 1, Steps: 7 | Train Loss: 1.871 Vali Loss: 1.638 Vali Acc: 0.260 Test Loss: 1.638 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3606867790222168
Epoch: 2, Steps: 7 | Train Loss: 0.394 Vali Loss: 1.758 Vali Acc: 0.460 Test Loss: 1.758 Test Acc: 0.460
Validation loss decreased (-0.259984 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.4936120510101318
Epoch: 3, Steps: 7 | Train Loss: 0.288 Vali Loss: 2.148 Vali Acc: 0.500 Test Loss: 2.148 Test Acc: 0.500
Validation loss decreased (-0.459982 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 1.3950061798095703
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.116 Vali Acc: 0.540 Test Loss: 2.116 Test Acc: 0.540
Validation loss decreased (-0.499979 --> -0.539979).  Saving model ...
Epoch: 5 cost time: 1.364579439163208
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.791 Vali Acc: 0.580 Test Loss: 2.791 Test Acc: 0.580
Validation loss decreased (-0.539979 --> -0.579972).  Saving model ...
Epoch: 6 cost time: 1.3004629611968994
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.640 Test Loss: 2.485 Test Acc: 0.640
Validation loss decreased (-0.579972 --> -0.639975).  Saving model ...
Epoch: 7 cost time: 1.3075144290924072
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.734 Vali Acc: 0.620 Test Loss: 2.734 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4350087642669678
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.514 Vali Acc: 0.580 Test Loss: 4.514 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.342918872833252
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.925 Vali Acc: 0.500 Test Loss: 4.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4298813343048096
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.934 Vali Acc: 0.440 Test Loss: 4.934 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.103724479675293
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.132 Vali Acc: 0.400 Test Loss: 4.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3096749782562256
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.996 Vali Acc: 0.420 Test Loss: 3.996 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4080355167388916
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.994 Vali Acc: 0.400 Test Loss: 3.994 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.256986141204834
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.990 Vali Acc: 0.400 Test Loss: 3.990 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.194058895111084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.981 Vali Acc: 0.400 Test Loss: 3.981 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.214322566986084
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.953 Vali Acc: 0.420 Test Loss: 3.953 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 1992199
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.202028751373291
Epoch: 1, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.366 Vali Acc: 0.420 Test Loss: 1.366 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 1.0500991344451904
Epoch: 2, Steps: 7 | Train Loss: 0.335 Vali Loss: 1.785 Vali Acc: 0.460 Test Loss: 1.785 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 0.984166145324707
Epoch: 3, Steps: 7 | Train Loss: 0.085 Vali Loss: 2.241 Vali Acc: 0.520 Test Loss: 2.241 Test Acc: 0.520
Validation loss decreased (-0.459982 --> -0.519978).  Saving model ...
Epoch: 4 cost time: 1.0077600479125977
Epoch: 4, Steps: 7 | Train Loss: 0.052 Vali Loss: 2.176 Vali Acc: 0.620 Test Loss: 2.176 Test Acc: 0.620
Validation loss decreased (-0.519978 --> -0.619978).  Saving model ...
Epoch: 5 cost time: 0.9597089290618896
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.245 Vali Acc: 0.560 Test Loss: 3.245 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1068544387817383
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.580 Test Loss: 2.355 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1200487613677979
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.225 Vali Acc: 0.560 Test Loss: 2.225 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1171164512634277
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.160 Vali Acc: 0.500 Test Loss: 3.160 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1425120830535889
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.789 Vali Acc: 0.480 Test Loss: 3.789 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0632703304290771
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.788 Vali Acc: 0.520 Test Loss: 2.788 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0338466167449951
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.790 Vali Acc: 0.500 Test Loss: 2.790 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.021287441253662
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.144 Vali Acc: 0.480 Test Loss: 3.144 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0778889656066895
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.358 Vali Acc: 0.500 Test Loss: 3.358 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0892317295074463
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.329 Vali Acc: 0.500 Test Loss: 3.329 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1990407
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.068666934967041
Epoch: 1, Steps: 7 | Train Loss: 1.695 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 0.9045586585998535
Epoch: 2, Steps: 7 | Train Loss: 0.443 Vali Loss: 1.760 Vali Acc: 0.320 Test Loss: 1.760 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.906702995300293
Epoch: 3, Steps: 7 | Train Loss: 0.188 Vali Loss: 2.114 Vali Acc: 0.440 Test Loss: 2.114 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439979).  Saving model ...
Epoch: 4 cost time: 0.8959939479827881
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.256 Vali Acc: 0.420 Test Loss: 2.256 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9456007480621338
Epoch: 5, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.994 Vali Acc: 0.440 Test Loss: 2.994 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0055780410766602
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.245 Vali Acc: 0.540 Test Loss: 3.245 Test Acc: 0.540
Validation loss decreased (-0.439979 --> -0.539968).  Saving model ...
Epoch: 7 cost time: 0.976238489151001
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.481 Vali Acc: 0.460 Test Loss: 4.481 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0170705318450928
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.424 Vali Acc: 0.500 Test Loss: 4.424 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1397149562835693
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.038 Vali Acc: 0.500 Test Loss: 4.038 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0426762104034424
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.837 Vali Acc: 0.500 Test Loss: 3.837 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.93556809425354
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.727 Vali Acc: 0.500 Test Loss: 3.727 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1455581188201904
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.667 Vali Acc: 0.520 Test Loss: 3.667 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0140759944915771
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.634 Vali Acc: 0.520 Test Loss: 3.634 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.066084861755371
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.616 Vali Acc: 0.520 Test Loss: 3.616 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0897905826568604
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.605 Vali Acc: 0.500 Test Loss: 3.605 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0228662490844727
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.500 Test Loss: 3.597 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1989127
model size : 7.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0265324115753174
Epoch: 1, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.679 Vali Acc: 0.360 Test Loss: 1.679 Test Acc: 0.360
Validation loss decreased (inf --> -0.359983).  Saving model ...
Epoch: 2 cost time: 0.9154469966888428
Epoch: 2, Steps: 7 | Train Loss: 0.496 Vali Loss: 1.640 Vali Acc: 0.520 Test Loss: 1.640 Test Acc: 0.520
Validation loss decreased (-0.359983 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 0.8392744064331055
Epoch: 3, Steps: 7 | Train Loss: 0.086 Vali Loss: 2.116 Vali Acc: 0.440 Test Loss: 2.116 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8537347316741943
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.672 Vali Acc: 0.420 Test Loss: 2.672 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.743206262588501
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.520 Test Loss: 1.998 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8326833248138428
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.620 Test Loss: 1.914 Test Acc: 0.620
Validation loss decreased (-0.519984 --> -0.619981).  Saving model ...
Epoch: 7 cost time: 0.7949910163879395
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.620 Test Loss: 1.964 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8144769668579102
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.620 Test Loss: 2.016 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8616890907287598
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.620 Test Loss: 2.049 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8807742595672607
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.065 Vali Acc: 0.600 Test Loss: 2.065 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8349359035491943
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.070 Vali Acc: 0.600 Test Loss: 2.070 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8747601509094238
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.600 Test Loss: 2.068 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8586008548736572
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.620 Test Loss: 2.064 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8584809303283691
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.620 Test Loss: 2.058 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8641767501831055
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.053 Vali Acc: 0.620 Test Loss: 2.053 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9469687938690186
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.620 Test Loss: 2.047 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1988359
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.117133855819702
Epoch: 1, Steps: 7 | Train Loss: 1.692 Vali Loss: 1.623 Vali Acc: 0.340 Test Loss: 1.623 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 0.814885139465332
Epoch: 2, Steps: 7 | Train Loss: 0.517 Vali Loss: 2.761 Vali Acc: 0.440 Test Loss: 2.761 Test Acc: 0.440
Validation loss decreased (-0.339984 --> -0.439972).  Saving model ...
Epoch: 3 cost time: 0.8093976974487305
Epoch: 3, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.963 Vali Acc: 0.440 Test Loss: 1.963 Test Acc: 0.440
Validation loss decreased (-0.439972 --> -0.439980).  Saving model ...
Epoch: 4 cost time: 0.8236336708068848
Epoch: 4, Steps: 7 | Train Loss: 0.105 Vali Loss: 3.008 Vali Acc: 0.460 Test Loss: 3.008 Test Acc: 0.460
Validation loss decreased (-0.439980 --> -0.459970).  Saving model ...
Epoch: 5 cost time: 0.8721063137054443
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.543 Vali Acc: 0.440 Test Loss: 3.543 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8216631412506104
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.868 Vali Acc: 0.500 Test Loss: 3.868 Test Acc: 0.500
Validation loss decreased (-0.459970 --> -0.499961).  Saving model ...
Epoch: 7 cost time: 0.8274011611938477
Epoch: 7, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.882 Vali Acc: 0.580 Test Loss: 2.882 Test Acc: 0.580
Validation loss decreased (-0.499961 --> -0.579971).  Saving model ...
Epoch: 8 cost time: 0.8390309810638428
Epoch: 8, Steps: 7 | Train Loss: 0.060 Vali Loss: 3.705 Vali Acc: 0.460 Test Loss: 3.705 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7173972129821777
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.513 Vali Acc: 0.540 Test Loss: 4.513 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7751610279083252
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 9.140 Vali Acc: 0.400 Test Loss: 9.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7109935283660889
Epoch: 11, Steps: 7 | Train Loss: 0.671 Vali Loss: 5.006 Vali Acc: 0.500 Test Loss: 5.006 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7732014656066895
Epoch: 12, Steps: 7 | Train Loss: 0.059 Vali Loss: 8.897 Vali Acc: 0.480 Test Loss: 8.897 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8023664951324463
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 6.597 Vali Acc: 0.580 Test Loss: 6.597 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7167873382568359
Epoch: 14, Steps: 7 | Train Loss: 0.036 Vali Loss: 6.083 Vali Acc: 0.520 Test Loss: 6.083 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7950849533081055
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.766 Vali Acc: 0.440 Test Loss: 5.766 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8213069438934326
Epoch: 16, Steps: 7 | Train Loss: 0.148 Vali Loss: 5.793 Vali Acc: 0.500 Test Loss: 5.793 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7928779125213623
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.717 Vali Acc: 0.460 Test Loss: 6.717 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1987591
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1355302333831787
Epoch: 1, Steps: 7 | Train Loss: 1.535 Vali Loss: 1.315 Vali Acc: 0.420 Test Loss: 1.315 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.8461270332336426
Epoch: 2, Steps: 7 | Train Loss: 0.455 Vali Loss: 1.616 Vali Acc: 0.380 Test Loss: 1.616 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8189740180969238
Epoch: 3, Steps: 7 | Train Loss: 0.229 Vali Loss: 2.453 Vali Acc: 0.420 Test Loss: 2.453 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8577046394348145
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.930 Vali Acc: 0.440 Test Loss: 3.930 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439961).  Saving model ...
Epoch: 5 cost time: 0.9558742046356201
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.140 Vali Acc: 0.400 Test Loss: 4.140 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8763022422790527
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.738 Vali Acc: 0.440 Test Loss: 3.738 Test Acc: 0.440
Validation loss decreased (-0.439961 --> -0.439963).  Saving model ...
Epoch: 7 cost time: 0.807056188583374
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.600 Vali Acc: 0.440 Test Loss: 3.600 Test Acc: 0.440
Validation loss decreased (-0.439963 --> -0.439964).  Saving model ...
Epoch: 8 cost time: 0.8077805042266846
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.541 Vali Acc: 0.440 Test Loss: 3.541 Test Acc: 0.440
Validation loss decreased (-0.439964 --> -0.439965).  Saving model ...
Epoch: 9 cost time: 1.030944585800171
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.503 Vali Acc: 0.440 Test Loss: 3.503 Test Acc: 0.440
Validation loss decreased (-0.439965 --> -0.439965).  Saving model ...
Epoch: 10 cost time: 0.803175687789917
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.480 Vali Acc: 0.440 Test Loss: 3.480 Test Acc: 0.440
Validation loss decreased (-0.439965 --> -0.439965).  Saving model ...
Epoch: 11 cost time: 0.9707527160644531
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.454 Vali Acc: 0.440 Test Loss: 3.454 Test Acc: 0.440
Validation loss decreased (-0.439965 --> -0.439965).  Saving model ...
Epoch: 12 cost time: 0.8807032108306885
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.440 Test Loss: 3.433 Test Acc: 0.440
Validation loss decreased (-0.439965 --> -0.439966).  Saving model ...
Epoch: 13 cost time: 0.8695230484008789
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.415 Vali Acc: 0.440 Test Loss: 3.415 Test Acc: 0.440
Validation loss decreased (-0.439966 --> -0.439966).  Saving model ...
Epoch: 14 cost time: 0.8667645454406738
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.396 Vali Acc: 0.440 Test Loss: 3.396 Test Acc: 0.440
Validation loss decreased (-0.439966 --> -0.439966).  Saving model ...
Epoch: 15 cost time: 1.0537545680999756
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.379 Vali Acc: 0.440 Test Loss: 3.379 Test Acc: 0.440
Validation loss decreased (-0.439966 --> -0.439966).  Saving model ...
Epoch: 16 cost time: 0.8859236240386963
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.440 Test Loss: 3.356 Test Acc: 0.440
Validation loss decreased (-0.439966 --> -0.439966).  Saving model ...
Epoch: 17 cost time: 0.914473295211792
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.440 Test Loss: 3.339 Test Acc: 0.440
Validation loss decreased (-0.439966 --> -0.439967).  Saving model ...
Epoch: 18 cost time: 0.8950157165527344
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.325 Vali Acc: 0.440 Test Loss: 3.325 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439967).  Saving model ...
Epoch: 19 cost time: 0.871706485748291
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.311 Vali Acc: 0.440 Test Loss: 3.311 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439967).  Saving model ...
Epoch: 20 cost time: 0.8852410316467285
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.440 Test Loss: 3.294 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439967).  Saving model ...
Epoch: 21 cost time: 0.7117037773132324
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.280 Vali Acc: 0.440 Test Loss: 3.280 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439967).  Saving model ...
Epoch: 22 cost time: 0.853247880935669
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.263 Vali Acc: 0.440 Test Loss: 3.263 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439967).  Saving model ...
Epoch: 23 cost time: 0.8438520431518555
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.440 Test Loss: 3.249 Test Acc: 0.440
Validation loss decreased (-0.439967 --> -0.439968).  Saving model ...
Epoch: 24 cost time: 0.8507230281829834
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.234 Vali Acc: 0.440 Test Loss: 3.234 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 25 cost time: 0.7655777931213379
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.223 Vali Acc: 0.440 Test Loss: 3.223 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 26 cost time: 0.8459885120391846
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.212 Vali Acc: 0.440 Test Loss: 3.212 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 27 cost time: 0.8981528282165527
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.203 Vali Acc: 0.440 Test Loss: 3.203 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 28 cost time: 0.7346916198730469
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.195 Vali Acc: 0.440 Test Loss: 3.195 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 29 cost time: 0.8511638641357422
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.186 Vali Acc: 0.440 Test Loss: 3.186 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 30 cost time: 0.764686107635498
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.177 Vali Acc: 0.440 Test Loss: 3.177 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 31 cost time: 0.8431854248046875
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.169 Vali Acc: 0.440 Test Loss: 3.169 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 32 cost time: 0.7920172214508057
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.440 Test Loss: 3.162 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 33 cost time: 0.8199141025543213
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.154 Vali Acc: 0.440 Test Loss: 3.154 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439968).  Saving model ...
Epoch: 34 cost time: 0.8003702163696289
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.147 Vali Acc: 0.440 Test Loss: 3.147 Test Acc: 0.440
Validation loss decreased (-0.439968 --> -0.439969).  Saving model ...
Epoch: 35 cost time: 0.7215027809143066
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.140 Vali Acc: 0.440 Test Loss: 3.140 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 36 cost time: 0.7024497985839844
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.132 Vali Acc: 0.440 Test Loss: 3.132 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 37 cost time: 0.7870910167694092
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.125 Vali Acc: 0.440 Test Loss: 3.125 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 38 cost time: 0.8868021965026855
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.118 Vali Acc: 0.440 Test Loss: 3.118 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 39 cost time: 0.8232402801513672
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.109 Vali Acc: 0.440 Test Loss: 3.109 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 40 cost time: 0.8495440483093262
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.440 Test Loss: 3.101 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 41 cost time: 0.7429904937744141
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.091 Vali Acc: 0.440 Test Loss: 3.091 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 42 cost time: 0.8797035217285156
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.082 Vali Acc: 0.440 Test Loss: 3.082 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 43 cost time: 0.8886549472808838
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.073 Vali Acc: 0.440 Test Loss: 3.073 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 44 cost time: 0.7623281478881836
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.065 Vali Acc: 0.440 Test Loss: 3.065 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 45 cost time: 0.8231990337371826
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.440 Test Loss: 3.057 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 46 cost time: 0.808098554611206
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.440 Test Loss: 3.051 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439969).  Saving model ...
Epoch: 47 cost time: 0.8379859924316406
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.440 Test Loss: 3.044 Test Acc: 0.440
Validation loss decreased (-0.439969 --> -0.439970).  Saving model ...
Epoch: 48 cost time: 0.8661150932312012
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.038 Vali Acc: 0.440 Test Loss: 3.038 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 49 cost time: 0.8121123313903809
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.440 Test Loss: 3.032 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 50 cost time: 0.9466478824615479
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.026 Vali Acc: 0.440 Test Loss: 3.026 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 51 cost time: 0.79673171043396
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.440 Test Loss: 3.021 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 52 cost time: 0.9006245136260986
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.440 Test Loss: 3.016 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 53 cost time: 0.8801710605621338
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.010 Vali Acc: 0.440 Test Loss: 3.010 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 54 cost time: 0.89583420753479
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.003 Vali Acc: 0.440 Test Loss: 3.003 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 55 cost time: 0.9212596416473389
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.998 Vali Acc: 0.440 Test Loss: 2.998 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 56 cost time: 0.8495559692382812
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.992 Vali Acc: 0.440 Test Loss: 2.992 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 57 cost time: 0.956047534942627
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.986 Vali Acc: 0.440 Test Loss: 2.986 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 58 cost time: 0.7862634658813477
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.440 Test Loss: 2.981 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 59 cost time: 0.7474210262298584
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.975 Vali Acc: 0.440 Test Loss: 2.975 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 60 cost time: 0.7722105979919434
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.969 Vali Acc: 0.440 Test Loss: 2.969 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 61 cost time: 0.8391644954681396
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.963 Vali Acc: 0.440 Test Loss: 2.963 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 62 cost time: 0.8144881725311279
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.958 Vali Acc: 0.440 Test Loss: 2.958 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 63 cost time: 0.7441630363464355
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.954 Vali Acc: 0.440 Test Loss: 2.954 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439970).  Saving model ...
Epoch: 64 cost time: 0.731102705001831
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.440 Test Loss: 2.948 Test Acc: 0.440
Validation loss decreased (-0.439970 --> -0.439971).  Saving model ...
Epoch: 65 cost time: 0.7133791446685791
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.944 Vali Acc: 0.440 Test Loss: 2.944 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 66 cost time: 0.7621166706085205
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.940 Vali Acc: 0.440 Test Loss: 2.940 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 67 cost time: 0.7790484428405762
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.440 Test Loss: 2.935 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 68 cost time: 0.779951810836792
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.440 Test Loss: 2.930 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 69 cost time: 0.7288436889648438
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.926 Vali Acc: 0.440 Test Loss: 2.926 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 70 cost time: 0.7079815864562988
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.921 Vali Acc: 0.440 Test Loss: 2.921 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 71 cost time: 0.7559027671813965
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.916 Vali Acc: 0.440 Test Loss: 2.916 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 72 cost time: 0.7018561363220215
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.911 Vali Acc: 0.440 Test Loss: 2.911 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 73 cost time: 0.6733090877532959
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.440 Test Loss: 2.907 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 74 cost time: 0.7303082942962646
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.903 Vali Acc: 0.440 Test Loss: 2.903 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 75 cost time: 0.7122392654418945
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.900 Vali Acc: 0.440 Test Loss: 2.900 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 76 cost time: 0.7877686023712158
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.896 Vali Acc: 0.440 Test Loss: 2.896 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 77 cost time: 0.7707052230834961
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.440 Test Loss: 2.893 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 78 cost time: 0.7805144786834717
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.440 Test Loss: 2.889 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 79 cost time: 0.9191548824310303
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.884 Vali Acc: 0.440 Test Loss: 2.884 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 80 cost time: 0.8150515556335449
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.881 Vali Acc: 0.440 Test Loss: 2.881 Test Acc: 0.440
Validation loss decreased (-0.439971 --> -0.439971).  Saving model ...
Epoch: 81 cost time: 0.8485665321350098
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.877 Vali Acc: 0.460 Test Loss: 2.877 Test Acc: 0.460
Validation loss decreased (-0.439971 --> -0.459971).  Saving model ...
Epoch: 82 cost time: 0.8631775379180908
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.873 Vali Acc: 0.460 Test Loss: 2.873 Test Acc: 0.460
Validation loss decreased (-0.459971 --> -0.459971).  Saving model ...
Epoch: 83 cost time: 0.8467497825622559
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.460 Test Loss: 2.869 Test Acc: 0.460
Validation loss decreased (-0.459971 --> -0.459971).  Saving model ...
Epoch: 84 cost time: 0.8320837020874023
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.865 Vali Acc: 0.460 Test Loss: 2.865 Test Acc: 0.460
Validation loss decreased (-0.459971 --> -0.459971).  Saving model ...
Epoch: 85 cost time: 0.9836666584014893
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.861 Vali Acc: 0.480 Test Loss: 2.861 Test Acc: 0.480
Validation loss decreased (-0.459971 --> -0.479971).  Saving model ...
Epoch: 86 cost time: 0.8042259216308594
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.857 Vali Acc: 0.480 Test Loss: 2.857 Test Acc: 0.480
Validation loss decreased (-0.479971 --> -0.479971).  Saving model ...
Epoch: 87 cost time: 0.8039624691009521
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.853 Vali Acc: 0.480 Test Loss: 2.853 Test Acc: 0.480
Validation loss decreased (-0.479971 --> -0.479971).  Saving model ...
Epoch: 88 cost time: 0.7915561199188232
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.850 Vali Acc: 0.480 Test Loss: 2.850 Test Acc: 0.480
Validation loss decreased (-0.479971 --> -0.479972).  Saving model ...
Epoch: 89 cost time: 0.878756046295166
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.480 Test Loss: 2.846 Test Acc: 0.480
Validation loss decreased (-0.479972 --> -0.479972).  Saving model ...
Epoch: 90 cost time: 0.8158309459686279
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.842 Vali Acc: 0.480 Test Loss: 2.842 Test Acc: 0.480
Validation loss decreased (-0.479972 --> -0.479972).  Saving model ...
Epoch: 91 cost time: 0.8065392971038818
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.480 Test Loss: 2.839 Test Acc: 0.480
Validation loss decreased (-0.479972 --> -0.479972).  Saving model ...
Epoch: 92 cost time: 0.8333792686462402
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.480 Test Loss: 2.836 Test Acc: 0.480
Validation loss decreased (-0.479972 --> -0.479972).  Saving model ...
Epoch: 93 cost time: 0.8118953704833984
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.833 Vali Acc: 0.480 Test Loss: 2.833 Test Acc: 0.480
Validation loss decreased (-0.479972 --> -0.479972).  Saving model ...
Epoch: 94 cost time: 0.8018093109130859
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.829 Vali Acc: 0.500 Test Loss: 2.829 Test Acc: 0.500
Validation loss decreased (-0.479972 --> -0.499972).  Saving model ...
Epoch: 95 cost time: 0.844623327255249
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.826 Vali Acc: 0.500 Test Loss: 2.826 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
Epoch: 96 cost time: 0.87070631980896
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.823 Vali Acc: 0.500 Test Loss: 2.823 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
Epoch: 97 cost time: 0.8308999538421631
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.500 Test Loss: 2.820 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
Epoch: 98 cost time: 0.8426179885864258
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.500 Test Loss: 2.818 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
Epoch: 99 cost time: 0.7587652206420898
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.815 Vali Acc: 0.500 Test Loss: 2.815 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
Epoch: 100 cost time: 0.754403829574585
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.500 Test Loss: 2.812 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499972).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1987079
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7199769020080566
Epoch: 1, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.932 Vali Acc: 0.180 Test Loss: 1.932 Test Acc: 0.180
Validation loss decreased (inf --> -0.179981).  Saving model ...
Epoch: 2 cost time: 1.5229873657226562
Epoch: 2, Steps: 7 | Train Loss: 1.238 Vali Loss: 2.667 Vali Acc: 0.340 Test Loss: 2.667 Test Acc: 0.340
Validation loss decreased (-0.179981 --> -0.339973).  Saving model ...
Epoch: 3 cost time: 1.511012315750122
Epoch: 3, Steps: 7 | Train Loss: 0.209 Vali Loss: 1.814 Vali Acc: 0.600 Test Loss: 1.814 Test Acc: 0.600
Validation loss decreased (-0.339973 --> -0.599982).  Saving model ...
Epoch: 4 cost time: 1.6639060974121094
Epoch: 4, Steps: 7 | Train Loss: 0.083 Vali Loss: 4.149 Vali Acc: 0.380 Test Loss: 4.149 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5229520797729492
Epoch: 5, Steps: 7 | Train Loss: 0.123 Vali Loss: 2.201 Vali Acc: 0.460 Test Loss: 2.201 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5589940547943115
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 7.830 Vali Acc: 0.420 Test Loss: 7.830 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5773398876190186
Epoch: 7, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.257 Vali Acc: 0.580 Test Loss: 2.257 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.600578784942627
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 6.583 Vali Acc: 0.320 Test Loss: 6.583 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.686638593673706
Epoch: 9, Steps: 7 | Train Loss: 0.077 Vali Loss: 4.999 Vali Acc: 0.440 Test Loss: 4.999 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4800209999084473
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.312 Vali Acc: 0.440 Test Loss: 5.312 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.876936674118042
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 6.232 Vali Acc: 0.460 Test Loss: 6.232 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5925540924072266
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 9.042 Vali Acc: 0.460 Test Loss: 9.042 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6745104789733887
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 11.224 Vali Acc: 0.480 Test Loss: 11.224 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1984763
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.485496997833252
Epoch: 1, Steps: 7 | Train Loss: 1.695 Vali Loss: 1.500 Vali Acc: 0.320 Test Loss: 1.500 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.3091769218444824
Epoch: 2, Steps: 7 | Train Loss: 0.555 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.278005599975586
Epoch: 3, Steps: 7 | Train Loss: 0.052 Vali Loss: 2.674 Vali Acc: 0.440 Test Loss: 2.674 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439973).  Saving model ...
Epoch: 4 cost time: 1.3130006790161133
Epoch: 4, Steps: 7 | Train Loss: 0.167 Vali Loss: 3.183 Vali Acc: 0.380 Test Loss: 3.183 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3624992370605469
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.217 Vali Acc: 0.500 Test Loss: 3.217 Test Acc: 0.500
Validation loss decreased (-0.439973 --> -0.499968).  Saving model ...
Epoch: 6 cost time: 1.281872272491455
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 4.055 Vali Acc: 0.380 Test Loss: 4.055 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3535475730895996
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.229 Vali Acc: 0.540 Test Loss: 2.229 Test Acc: 0.540
Validation loss decreased (-0.499968 --> -0.539978).  Saving model ...
Epoch: 8 cost time: 1.251227617263794
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.826 Vali Acc: 0.420 Test Loss: 3.826 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3624577522277832
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.252 Vali Acc: 0.600 Test Loss: 2.252 Test Acc: 0.600
Validation loss decreased (-0.539978 --> -0.599977).  Saving model ...
Epoch: 10 cost time: 1.2514777183532715
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.040 Vali Acc: 0.480 Test Loss: 4.040 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4169392585754395
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.091 Vali Acc: 0.480 Test Loss: 5.091 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.348245620727539
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.620 Vali Acc: 0.480 Test Loss: 4.620 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4212212562561035
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.085 Vali Acc: 0.520 Test Loss: 4.085 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.354374885559082
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.836 Vali Acc: 0.540 Test Loss: 3.836 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4666717052459717
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.721 Vali Acc: 0.540 Test Loss: 3.721 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3964359760284424
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.666 Vali Acc: 0.540 Test Loss: 3.666 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4338529109954834
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.644 Vali Acc: 0.540 Test Loss: 3.644 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3502414226531982
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.540 Test Loss: 3.637 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3424265384674072
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.635 Vali Acc: 0.540 Test Loss: 3.635 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1982971
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.205265760421753
Epoch: 1, Steps: 7 | Train Loss: 1.916 Vali Loss: 2.209 Vali Acc: 0.320 Test Loss: 2.209 Test Acc: 0.320
Validation loss decreased (inf --> -0.319978).  Saving model ...
Epoch: 2 cost time: 1.09698486328125
Epoch: 2, Steps: 7 | Train Loss: 0.783 Vali Loss: 1.801 Vali Acc: 0.380 Test Loss: 1.801 Test Acc: 0.380
Validation loss decreased (-0.319978 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 0.9860141277313232
Epoch: 3, Steps: 7 | Train Loss: 0.314 Vali Loss: 2.282 Vali Acc: 0.340 Test Loss: 2.282 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0589227676391602
Epoch: 4, Steps: 7 | Train Loss: 0.174 Vali Loss: 2.979 Vali Acc: 0.420 Test Loss: 2.979 Test Acc: 0.420
Validation loss decreased (-0.379982 --> -0.419970).  Saving model ...
Epoch: 5 cost time: 1.1067278385162354
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.530 Vali Acc: 0.480 Test Loss: 2.530 Test Acc: 0.480
Validation loss decreased (-0.419970 --> -0.479975).  Saving model ...
Epoch: 6 cost time: 1.1224231719970703
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.864 Vali Acc: 0.580 Test Loss: 2.864 Test Acc: 0.580
Validation loss decreased (-0.479975 --> -0.579971).  Saving model ...
Epoch: 7 cost time: 1.1871414184570312
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.334 Vali Acc: 0.500 Test Loss: 4.334 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1240363121032715
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.394 Vali Acc: 0.520 Test Loss: 4.394 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1070542335510254
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.715 Vali Acc: 0.540 Test Loss: 3.715 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.068638801574707
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.540 Test Loss: 3.434 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1040012836456299
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.311 Vali Acc: 0.540 Test Loss: 3.311 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1188204288482666
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.257 Vali Acc: 0.540 Test Loss: 3.257 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0787880420684814
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.239 Vali Acc: 0.520 Test Loss: 3.239 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2182788848876953
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.237 Vali Acc: 0.500 Test Loss: 3.237 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1127285957336426
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.500 Test Loss: 3.243 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1044151782989502
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.500 Test Loss: 3.249 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1981435
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.422731876373291
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 2.076 Vali Acc: 0.260 Test Loss: 2.076 Test Acc: 0.260
Validation loss decreased (inf --> -0.259979).  Saving model ...
Epoch: 2 cost time: 1.0270898342132568
Epoch: 2, Steps: 7 | Train Loss: 0.969 Vali Loss: 2.277 Vali Acc: 0.480 Test Loss: 2.277 Test Acc: 0.480
Validation loss decreased (-0.259979 --> -0.479977).  Saving model ...
Epoch: 3 cost time: 0.9724109172821045
Epoch: 3, Steps: 7 | Train Loss: 0.311 Vali Loss: 2.388 Vali Acc: 0.460 Test Loss: 2.388 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9712417125701904
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.463 Vali Acc: 0.440 Test Loss: 3.463 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.020843267440796
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.363 Vali Acc: 0.340 Test Loss: 3.363 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.109084129333496
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.829 Vali Acc: 0.520 Test Loss: 3.829 Test Acc: 0.520
Validation loss decreased (-0.479977 --> -0.519962).  Saving model ...
Epoch: 7 cost time: 0.9685382843017578
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 3.879 Vali Acc: 0.540 Test Loss: 3.879 Test Acc: 0.540
Validation loss decreased (-0.519962 --> -0.539961).  Saving model ...
Epoch: 8 cost time: 1.0283968448638916
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.205 Vali Acc: 0.440 Test Loss: 5.205 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.033529281616211
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.843 Vali Acc: 0.440 Test Loss: 4.843 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.026731252670288
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.586 Vali Acc: 0.420 Test Loss: 4.586 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0096733570098877
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.449 Vali Acc: 0.440 Test Loss: 4.449 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9303324222564697
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.378 Vali Acc: 0.440 Test Loss: 4.378 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0301215648651123
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.340 Vali Acc: 0.440 Test Loss: 4.340 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0025620460510254
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.317 Vali Acc: 0.440 Test Loss: 4.317 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.051731824874878
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.302 Vali Acc: 0.440 Test Loss: 4.302 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9613335132598877
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.291 Vali Acc: 0.440 Test Loss: 4.291 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9428403377532959
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.283 Vali Acc: 0.440 Test Loss: 4.283 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1979643
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.320680618286133
Epoch: 1, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.742 Vali Acc: 0.440 Test Loss: 1.742 Test Acc: 0.440
Validation loss decreased (inf --> -0.439983).  Saving model ...
Epoch: 2 cost time: 0.9536118507385254
Epoch: 2, Steps: 7 | Train Loss: 0.507 Vali Loss: 2.186 Vali Acc: 0.360 Test Loss: 2.186 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.03981351852417
Epoch: 3, Steps: 7 | Train Loss: 0.081 Vali Loss: 2.356 Vali Acc: 0.480 Test Loss: 2.356 Test Acc: 0.480
Validation loss decreased (-0.439983 --> -0.479976).  Saving model ...
Epoch: 4 cost time: 0.9485161304473877
Epoch: 4, Steps: 7 | Train Loss: 0.123 Vali Loss: 1.720 Vali Acc: 0.420 Test Loss: 1.720 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0647282600402832
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.008 Vali Acc: 0.480 Test Loss: 3.008 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9238677024841309
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.809 Vali Acc: 0.500 Test Loss: 2.809 Test Acc: 0.500
Validation loss decreased (-0.479976 --> -0.499972).  Saving model ...
Epoch: 7 cost time: 0.9182178974151611
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.520 Test Loss: 3.294 Test Acc: 0.520
Validation loss decreased (-0.499972 --> -0.519967).  Saving model ...
Epoch: 8 cost time: 0.9061622619628906
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.258 Vali Acc: 0.500 Test Loss: 3.258 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9964234828948975
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.990 Vali Acc: 0.500 Test Loss: 2.990 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9878885746002197
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.807 Vali Acc: 0.480 Test Loss: 2.807 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9959766864776611
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.705 Vali Acc: 0.520 Test Loss: 2.705 Test Acc: 0.520
Validation loss decreased (-0.519967 --> -0.519973).  Saving model ...
Epoch: 12 cost time: 0.9578332901000977
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.645 Vali Acc: 0.540 Test Loss: 2.645 Test Acc: 0.540
Validation loss decreased (-0.519973 --> -0.539974).  Saving model ...
Epoch: 13 cost time: 0.9448211193084717
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.540 Test Loss: 2.606 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 14 cost time: 0.8792023658752441
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.540 Test Loss: 2.581 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 15 cost time: 0.9670987129211426
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.554 Vali Acc: 0.540 Test Loss: 2.554 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539974).  Saving model ...
Epoch: 16 cost time: 0.963308572769165
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.535 Vali Acc: 0.540 Test Loss: 2.535 Test Acc: 0.540
Validation loss decreased (-0.539974 --> -0.539975).  Saving model ...
Epoch: 17 cost time: 0.9078414440155029
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.540 Test Loss: 2.522 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 18 cost time: 0.9493141174316406
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.540 Test Loss: 2.509 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 19 cost time: 0.8997211456298828
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.501 Vali Acc: 0.540 Test Loss: 2.501 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 20 cost time: 0.8419983386993408
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.491 Vali Acc: 0.540 Test Loss: 2.491 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 21 cost time: 0.9352772235870361
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.482 Vali Acc: 0.540 Test Loss: 2.482 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 22 cost time: 0.9937756061553955
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.540 Test Loss: 2.474 Test Acc: 0.540
Validation loss decreased (-0.539975 --> -0.539975).  Saving model ...
Epoch: 23 cost time: 0.8488647937774658
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.466 Vali Acc: 0.560 Test Loss: 2.466 Test Acc: 0.560
Validation loss decreased (-0.539975 --> -0.559975).  Saving model ...
Epoch: 24 cost time: 0.8708178997039795
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.540 Test Loss: 2.457 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8818743228912354
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.540 Test Loss: 2.449 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9319589138031006
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.540 Test Loss: 2.441 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.938734769821167
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.434 Vali Acc: 0.540 Test Loss: 2.434 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9222211837768555
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.428 Vali Acc: 0.540 Test Loss: 2.428 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9496850967407227
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.422 Vali Acc: 0.540 Test Loss: 2.422 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8151950836181641
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.417 Vali Acc: 0.540 Test Loss: 2.417 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8002283573150635
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.540 Test Loss: 2.411 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9881482124328613
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.406 Vali Acc: 0.540 Test Loss: 2.406 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0678513050079346
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.540 Test Loss: 2.400 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1978363
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3711299896240234
Epoch: 1, Steps: 7 | Train Loss: 1.783 Vali Loss: 1.682 Vali Acc: 0.300 Test Loss: 1.682 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.938591718673706
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 1.215 Vali Acc: 0.480 Test Loss: 1.215 Test Acc: 0.480
Validation loss decreased (-0.299983 --> -0.479988).  Saving model ...
Epoch: 3 cost time: 0.8420920372009277
Epoch: 3, Steps: 7 | Train Loss: 0.164 Vali Loss: 2.562 Vali Acc: 0.420 Test Loss: 2.562 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.904731035232544
Epoch: 4, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.750 Vali Acc: 0.460 Test Loss: 2.750 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9282958507537842
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.744 Vali Acc: 0.420 Test Loss: 2.744 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8724822998046875
Epoch: 6, Steps: 7 | Train Loss: 0.078 Vali Loss: 3.387 Vali Acc: 0.400 Test Loss: 3.387 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9379146099090576
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 4.773 Vali Acc: 0.420 Test Loss: 4.773 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8853387832641602
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.008 Vali Acc: 0.360 Test Loss: 4.008 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8327577114105225
Epoch: 9, Steps: 7 | Train Loss: 0.127 Vali Loss: 5.558 Vali Acc: 0.400 Test Loss: 5.558 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.865095853805542
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 5.858 Vali Acc: 0.440 Test Loss: 5.858 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8525919914245605
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 6.386 Vali Acc: 0.420 Test Loss: 6.386 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8239467144012451
Epoch: 12, Steps: 7 | Train Loss: 0.222 Vali Loss: 8.202 Vali Acc: 0.300 Test Loss: 8.202 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1977595
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9756746292114258
Epoch: 1, Steps: 7 | Train Loss: 1.782 Vali Loss: 1.902 Vali Acc: 0.180 Test Loss: 1.902 Test Acc: 0.180
Validation loss decreased (inf --> -0.179981).  Saving model ...
Epoch: 2 cost time: 0.7033660411834717
Epoch: 2, Steps: 7 | Train Loss: 0.722 Vali Loss: 2.487 Vali Acc: 0.320 Test Loss: 2.487 Test Acc: 0.320
Validation loss decreased (-0.179981 --> -0.319975).  Saving model ...
Epoch: 3 cost time: 0.8106451034545898
Epoch: 3, Steps: 7 | Train Loss: 0.227 Vali Loss: 2.676 Vali Acc: 0.360 Test Loss: 2.676 Test Acc: 0.360
Validation loss decreased (-0.319975 --> -0.359973).  Saving model ...
Epoch: 4 cost time: 0.7157721519470215
Epoch: 4, Steps: 7 | Train Loss: 0.134 Vali Loss: 5.224 Vali Acc: 0.420 Test Loss: 5.224 Test Acc: 0.420
Validation loss decreased (-0.359973 --> -0.419948).  Saving model ...
Epoch: 5 cost time: 0.70503830909729
Epoch: 5, Steps: 7 | Train Loss: 0.080 Vali Loss: 4.180 Vali Acc: 0.460 Test Loss: 4.180 Test Acc: 0.460
Validation loss decreased (-0.419948 --> -0.459958).  Saving model ...
Epoch: 6 cost time: 0.7931485176086426
Epoch: 6, Steps: 7 | Train Loss: 0.262 Vali Loss: 3.068 Vali Acc: 0.520 Test Loss: 3.068 Test Acc: 0.520
Validation loss decreased (-0.459958 --> -0.519969).  Saving model ...
Epoch: 7 cost time: 0.7730038166046143
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 5.363 Vali Acc: 0.500 Test Loss: 5.363 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7649831771850586
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.831 Vali Acc: 0.480 Test Loss: 4.831 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7782249450683594
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.190 Vali Acc: 0.480 Test Loss: 5.190 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8024649620056152
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.106 Vali Acc: 0.460 Test Loss: 6.106 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7661843299865723
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.689 Vali Acc: 0.460 Test Loss: 6.689 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8122067451477051
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.509 Vali Acc: 0.480 Test Loss: 6.509 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8360886573791504
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.288 Vali Acc: 0.460 Test Loss: 6.288 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8343870639801025
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.162 Vali Acc: 0.460 Test Loss: 6.162 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.83717942237854
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.086 Vali Acc: 0.460 Test Loss: 6.086 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8313608169555664
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.040 Vali Acc: 0.460 Test Loss: 6.040 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1976827
model size : 7.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.074437141418457
Epoch: 1, Steps: 7 | Train Loss: 1.811 Vali Loss: 2.017 Vali Acc: 0.320 Test Loss: 2.017 Test Acc: 0.320
Validation loss decreased (inf --> -0.319980).  Saving model ...
Epoch: 2 cost time: 0.7823717594146729
Epoch: 2, Steps: 7 | Train Loss: 0.710 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.319980 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.8119063377380371
Epoch: 3, Steps: 7 | Train Loss: 0.112 Vali Loss: 2.884 Vali Acc: 0.420 Test Loss: 2.884 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.939091682434082
Epoch: 4, Steps: 7 | Train Loss: 0.042 Vali Loss: 2.434 Vali Acc: 0.540 Test Loss: 2.434 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539976).  Saving model ...
Epoch: 5 cost time: 0.8091959953308105
Epoch: 5, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.626 Vali Acc: 0.500 Test Loss: 2.626 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9231863021850586
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.127 Vali Acc: 0.400 Test Loss: 3.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8783307075500488
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.936 Vali Acc: 0.620 Test Loss: 2.936 Test Acc: 0.620
Validation loss decreased (-0.539976 --> -0.619971).  Saving model ...
Epoch: 8 cost time: 0.704641580581665
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.145 Vali Acc: 0.580 Test Loss: 3.145 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7748675346374512
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.498 Vali Acc: 0.480 Test Loss: 3.498 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.716010332107544
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.723 Vali Acc: 0.400 Test Loss: 3.723 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7442202568054199
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.780 Vali Acc: 0.420 Test Loss: 3.780 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7635135650634766
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.719 Vali Acc: 0.480 Test Loss: 3.719 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6921019554138184
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.677 Vali Acc: 0.500 Test Loss: 3.677 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7336571216583252
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.646 Vali Acc: 0.520 Test Loss: 3.646 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7518455982208252
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.614 Vali Acc: 0.520 Test Loss: 3.614 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7606439590454102
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.595 Vali Acc: 0.520 Test Loss: 3.595 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8285233974456787
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.582 Vali Acc: 0.540 Test Loss: 3.582 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1976315
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.182450771331787
Epoch: 1, Steps: 7 | Train Loss: 1.652 Vali Loss: 1.361 Vali Acc: 0.380 Test Loss: 1.361 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.44313645362854
Epoch: 2, Steps: 7 | Train Loss: 0.277 Vali Loss: 1.755 Vali Acc: 0.500 Test Loss: 1.755 Test Acc: 0.500
Validation loss decreased (-0.379986 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.6573131084442139
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.954 Vali Acc: 0.500 Test Loss: 1.954 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6300702095031738
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.039 Vali Acc: 0.560 Test Loss: 2.039 Test Acc: 0.560
Validation loss decreased (-0.499982 --> -0.559980).  Saving model ...
Epoch: 5 cost time: 1.4833931922912598
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.540 Test Loss: 2.223 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.578514814376831
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.362 Vali Acc: 0.520 Test Loss: 2.362 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4364328384399414
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.520 Test Loss: 2.458 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7540690898895264
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.515 Vali Acc: 0.520 Test Loss: 2.515 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3800840377807617
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.520 Test Loss: 2.547 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5126805305480957
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.520 Test Loss: 2.565 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5950162410736084
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.520 Test Loss: 2.575 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4771013259887695
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.520 Test Loss: 2.581 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.637549877166748
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.520 Test Loss: 2.584 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5647618770599365
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.520 Test Loss: 2.586 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w34_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1971309
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.567080020904541
Epoch: 1, Steps: 7 | Train Loss: 1.479 Vali Loss: 1.347 Vali Acc: 0.380 Test Loss: 1.347 Test Acc: 0.380
Validation loss decreased (inf --> -0.379987).  Saving model ...
Epoch: 2 cost time: 1.2310221195220947
Epoch: 2, Steps: 7 | Train Loss: 0.199 Vali Loss: 1.414 Vali Acc: 0.580 Test Loss: 1.414 Test Acc: 0.580
Validation loss decreased (-0.379987 --> -0.579986).  Saving model ...
Epoch: 3 cost time: 1.3033981323242188
Epoch: 3, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.767 Vali Acc: 0.540 Test Loss: 1.767 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2469427585601807
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.642 Vali Acc: 0.460 Test Loss: 2.642 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3949429988861084
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.412 Vali Acc: 0.460 Test Loss: 3.412 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5658555030822754
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.727 Vali Acc: 0.440 Test Loss: 3.727 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4199132919311523
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.908 Vali Acc: 0.440 Test Loss: 3.908 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3393871784210205
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.009 Vali Acc: 0.440 Test Loss: 4.009 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2782316207885742
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.064 Vali Acc: 0.440 Test Loss: 4.064 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3042325973510742
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.094 Vali Acc: 0.440 Test Loss: 4.094 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.350351095199585
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.109 Vali Acc: 0.440 Test Loss: 4.109 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3603873252868652
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.118 Vali Acc: 0.440 Test Loss: 4.118 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w27_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1969517
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4793691635131836
Epoch: 1, Steps: 7 | Train Loss: 1.596 Vali Loss: 1.309 Vali Acc: 0.420 Test Loss: 1.309 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 1.1427371501922607
Epoch: 2, Steps: 7 | Train Loss: 0.174 Vali Loss: 1.584 Vali Acc: 0.460 Test Loss: 1.584 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459984).  Saving model ...
Epoch: 3 cost time: 1.2508249282836914
Epoch: 3, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.284 Vali Acc: 0.400 Test Loss: 2.284 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2716333866119385
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.520 Test Loss: 2.448 Test Acc: 0.520
Validation loss decreased (-0.459984 --> -0.519976).  Saving model ...
Epoch: 5 cost time: 1.067265510559082
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.682 Vali Acc: 0.520 Test Loss: 2.682 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1653141975402832
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.520 Test Loss: 2.820 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.124204158782959
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.885 Vali Acc: 0.520 Test Loss: 2.885 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1629061698913574
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.918 Vali Acc: 0.520 Test Loss: 2.918 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1686279773712158
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.520 Test Loss: 2.930 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0714352130889893
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.520 Test Loss: 2.934 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1503314971923828
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.520 Test Loss: 2.934 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.121823787689209
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.932 Vali Acc: 0.520 Test Loss: 2.932 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2158350944519043
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.520 Test Loss: 2.930 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0545532703399658
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.926 Vali Acc: 0.520 Test Loss: 2.926 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1967981
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.420421600341797
Epoch: 1, Steps: 7 | Train Loss: 1.524 Vali Loss: 1.202 Vali Acc: 0.480 Test Loss: 1.202 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 1.2180507183074951
Epoch: 2, Steps: 7 | Train Loss: 0.178 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.0260145664215088
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.696 Vali Acc: 0.540 Test Loss: 2.696 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539973).  Saving model ...
Epoch: 4 cost time: 1.160940170288086
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.065 Vali Acc: 0.520 Test Loss: 3.065 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.015347957611084
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.296 Vali Acc: 0.520 Test Loss: 3.296 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.081049919128418
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.540 Test Loss: 3.434 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0890343189239502
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.512 Vali Acc: 0.540 Test Loss: 3.512 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0408942699432373
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.556 Vali Acc: 0.520 Test Loss: 3.556 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2212820053100586
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.580 Vali Acc: 0.520 Test Loss: 3.580 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1982617378234863
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.593 Vali Acc: 0.520 Test Loss: 3.593 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0971853733062744
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.599 Vali Acc: 0.520 Test Loss: 3.599 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.142794132232666
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.602 Vali Acc: 0.520 Test Loss: 3.602 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1719999313354492
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.604 Vali Acc: 0.520 Test Loss: 3.604 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w14_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1966189
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2401766777038574
Epoch: 1, Steps: 7 | Train Loss: 1.594 Vali Loss: 1.252 Vali Acc: 0.440 Test Loss: 1.252 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 1.0051178932189941
Epoch: 2, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.793 Vali Acc: 0.520 Test Loss: 1.793 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519982).  Saving model ...
Epoch: 3 cost time: 0.9844589233398438
Epoch: 3, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.944 Vali Acc: 0.560 Test Loss: 1.944 Test Acc: 0.560
Validation loss decreased (-0.519982 --> -0.559981).  Saving model ...
Epoch: 4 cost time: 1.049508810043335
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.560 Test Loss: 2.158 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0178284645080566
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.520 Test Loss: 2.349 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0027315616607666
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.491 Vali Acc: 0.500 Test Loss: 2.491 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1323494911193848
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.500 Test Loss: 2.574 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0251214504241943
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.480 Test Loss: 2.621 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.146796464920044
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.647 Vali Acc: 0.480 Test Loss: 2.647 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1024725437164307
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.480 Test Loss: 2.661 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2140297889709473
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.668 Vali Acc: 0.480 Test Loss: 2.668 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.038426160812378
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.672 Vali Acc: 0.480 Test Loss: 2.672 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1229805946350098
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.673 Vali Acc: 0.480 Test Loss: 2.673 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1964909
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4144461154937744
Epoch: 1, Steps: 7 | Train Loss: 1.613 Vali Loss: 1.344 Vali Acc: 0.420 Test Loss: 1.344 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 0.8845500946044922
Epoch: 2, Steps: 7 | Train Loss: 0.160 Vali Loss: 1.745 Vali Acc: 0.400 Test Loss: 1.745 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9254982471466064
Epoch: 3, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.392 Vali Acc: 0.420 Test Loss: 2.392 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8881080150604248
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.878 Vali Acc: 0.440 Test Loss: 2.878 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439971).  Saving model ...
Epoch: 5 cost time: 0.8457460403442383
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.194 Vali Acc: 0.440 Test Loss: 3.194 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8761501312255859
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.385 Vali Acc: 0.460 Test Loss: 3.385 Test Acc: 0.460
Validation loss decreased (-0.439971 --> -0.459966).  Saving model ...
Epoch: 7 cost time: 0.9525456428527832
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.495 Vali Acc: 0.440 Test Loss: 3.495 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9156134128570557
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.557 Vali Acc: 0.440 Test Loss: 3.557 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9096105098724365
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.591 Vali Acc: 0.440 Test Loss: 3.591 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8795192241668701
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.608 Vali Acc: 0.440 Test Loss: 3.608 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8476059436798096
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.440 Test Loss: 3.617 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9367117881774902
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.621 Vali Acc: 0.440 Test Loss: 3.621 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9002258777618408
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.440 Test Loss: 3.623 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9002134799957275
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.440 Test Loss: 3.623 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.826899528503418
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.440 Test Loss: 3.623 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9296202659606934
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.622 Vali Acc: 0.440 Test Loss: 3.622 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w6_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1964141
model size : 7.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1643831729888916
Epoch: 1, Steps: 7 | Train Loss: 1.558 Vali Loss: 1.331 Vali Acc: 0.460 Test Loss: 1.331 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 0.8426265716552734
Epoch: 2, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.023 Vali Acc: 0.480 Test Loss: 2.023 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479980).  Saving model ...
Epoch: 3 cost time: 0.8639447689056396
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.134 Vali Acc: 0.520 Test Loss: 3.134 Test Acc: 0.520
Validation loss decreased (-0.479980 --> -0.519969).  Saving model ...
Epoch: 4 cost time: 0.881009578704834
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.757 Vali Acc: 0.520 Test Loss: 3.757 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8821451663970947
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.141 Vali Acc: 0.520 Test Loss: 4.141 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8358376026153564
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.520 Test Loss: 4.366 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9688646793365479
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.493 Vali Acc: 0.520 Test Loss: 4.493 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8042185306549072
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.563 Vali Acc: 0.520 Test Loss: 4.563 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7320561408996582
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.601 Vali Acc: 0.520 Test Loss: 4.601 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8762879371643066
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.620 Vali Acc: 0.520 Test Loss: 4.620 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8469669818878174
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.630 Vali Acc: 0.520 Test Loss: 4.630 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7603328227996826
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.633 Vali Acc: 0.520 Test Loss: 4.633 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.670769214630127
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.520 Test Loss: 4.634 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1963373
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.956099510192871
Epoch: 1, Steps: 7 | Train Loss: 1.523 Vali Loss: 1.227 Vali Acc: 0.480 Test Loss: 1.227 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 0.8269262313842773
Epoch: 2, Steps: 7 | Train Loss: 0.196 Vali Loss: 1.792 Vali Acc: 0.480 Test Loss: 1.792 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8032846450805664
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.043 Vali Acc: 0.520 Test Loss: 3.043 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519970).  Saving model ...
Epoch: 4 cost time: 0.9450538158416748
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.777 Vali Acc: 0.480 Test Loss: 3.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8602020740509033
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.213 Vali Acc: 0.480 Test Loss: 4.213 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.063061237335205
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.468 Vali Acc: 0.480 Test Loss: 4.468 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.784804105758667
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.611 Vali Acc: 0.480 Test Loss: 4.611 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8487331867218018
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.690 Vali Acc: 0.480 Test Loss: 4.690 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9858376979827881
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.732 Vali Acc: 0.480 Test Loss: 4.732 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.825951337814331
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.480 Test Loss: 4.753 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8800497055053711
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.764 Vali Acc: 0.480 Test Loss: 4.764 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9132657051086426
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.769 Vali Acc: 0.480 Test Loss: 4.769 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8623912334442139
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.771 Vali Acc: 0.480 Test Loss: 4.771 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_MTSMixer_UEA_ftM_sl270_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1962861
model size : 7.49MB
