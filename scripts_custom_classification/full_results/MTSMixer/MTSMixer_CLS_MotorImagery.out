Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.494545698165894
Epoch: 1, Steps: 18 | Train Loss: 1.123 Vali Loss: 0.771 Vali Acc: 0.580 Test Loss: 0.771 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 34.05186200141907
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.287 Vali Acc: 0.510 Test Loss: 1.287 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.27660083770752
Epoch: 3, Steps: 18 | Train Loss: 0.724 Vali Loss: 2.411 Vali Acc: 0.580 Test Loss: 2.411 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.77979564666748
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 1.859 Vali Acc: 0.550 Test Loss: 1.859 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 33.49492645263672
Epoch: 5, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.695 Vali Acc: 0.590 Test Loss: 1.695 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589983).  Saving model ...
Epoch: 6 cost time: 42.20168924331665
Epoch: 6, Steps: 18 | Train Loss: 0.967 Vali Loss: 4.463 Vali Acc: 0.540 Test Loss: 4.463 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 38.49467897415161
Epoch: 7, Steps: 18 | Train Loss: 0.558 Vali Loss: 2.094 Vali Acc: 0.510 Test Loss: 2.094 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.532545566558838
Epoch: 8, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.221 Vali Acc: 0.570 Test Loss: 2.221 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 37.2946355342865
Epoch: 9, Steps: 18 | Train Loss: 0.758 Vali Loss: 3.005 Vali Acc: 0.550 Test Loss: 3.005 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 42.86406373977661
Epoch: 10, Steps: 18 | Train Loss: 0.670 Vali Loss: 5.207 Vali Acc: 0.490 Test Loss: 5.207 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.879338264465332
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 9.873 Vali Acc: 0.440 Test Loss: 9.873 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.68802809715271
Epoch: 12, Steps: 18 | Train Loss: 0.571 Vali Loss: 3.738 Vali Acc: 0.500 Test Loss: 3.738 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 30.34628939628601
Epoch: 13, Steps: 18 | Train Loss: 0.628 Vali Loss: 7.617 Vali Acc: 0.490 Test Loss: 7.617 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 29.997198581695557
Epoch: 14, Steps: 18 | Train Loss: 0.691 Vali Loss: 6.536 Vali Acc: 0.530 Test Loss: 6.536 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 27.333293676376343
Epoch: 15, Steps: 18 | Train Loss: 0.420 Vali Loss: 8.535 Vali Acc: 0.470 Test Loss: 8.535 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 13454770
model size : 52.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.005127429962158
Epoch: 1, Steps: 18 | Train Loss: 0.977 Vali Loss: 1.603 Vali Acc: 0.590 Test Loss: 1.603 Test Acc: 0.590
Validation loss decreased (inf --> -0.589984).  Saving model ...
Epoch: 2 cost time: 24.17058777809143
Epoch: 2, Steps: 18 | Train Loss: 0.734 Vali Loss: 1.699 Vali Acc: 0.470 Test Loss: 1.699 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.475990056991577
Epoch: 3, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.273 Vali Acc: 0.560 Test Loss: 1.273 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.84980273246765
Epoch: 4, Steps: 18 | Train Loss: 0.821 Vali Loss: 2.074 Vali Acc: 0.530 Test Loss: 2.074 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.905951499938965
Epoch: 5, Steps: 18 | Train Loss: 0.405 Vali Loss: 2.019 Vali Acc: 0.470 Test Loss: 2.019 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 24.03157687187195
Epoch: 6, Steps: 18 | Train Loss: 0.690 Vali Loss: 2.634 Vali Acc: 0.530 Test Loss: 2.634 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.036137342453003
Epoch: 7, Steps: 18 | Train Loss: 0.445 Vali Loss: 2.242 Vali Acc: 0.490 Test Loss: 2.242 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 24.819572687149048
Epoch: 8, Steps: 18 | Train Loss: 0.446 Vali Loss: 3.261 Vali Acc: 0.530 Test Loss: 3.261 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.950520277023315
Epoch: 9, Steps: 18 | Train Loss: 0.544 Vali Loss: 7.564 Vali Acc: 0.460 Test Loss: 7.564 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 32.99444603919983
Epoch: 10, Steps: 18 | Train Loss: 1.068 Vali Loss: 9.260 Vali Acc: 0.500 Test Loss: 9.260 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 30.12216854095459
Epoch: 11, Steps: 18 | Train Loss: 1.111 Vali Loss: 4.128 Vali Acc: 0.520 Test Loss: 4.128 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 13301170
model size : 51.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.960901260375977
Epoch: 1, Steps: 18 | Train Loss: 0.911 Vali Loss: 0.918 Vali Acc: 0.460 Test Loss: 0.918 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 22.236427307128906
Epoch: 2, Steps: 18 | Train Loss: 0.787 Vali Loss: 1.401 Vali Acc: 0.560 Test Loss: 1.401 Test Acc: 0.560
Validation loss decreased (-0.459991 --> -0.559986).  Saving model ...
Epoch: 3 cost time: 23.894074201583862
Epoch: 3, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.663 Vali Acc: 0.490 Test Loss: 1.663 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.575809955596924
Epoch: 4, Steps: 18 | Train Loss: 0.705 Vali Loss: 3.215 Vali Acc: 0.540 Test Loss: 3.215 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.295788764953613
Epoch: 5, Steps: 18 | Train Loss: 0.699 Vali Loss: 2.033 Vali Acc: 0.550 Test Loss: 2.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.39705491065979
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 5.155 Vali Acc: 0.440 Test Loss: 5.155 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.74488139152527
Epoch: 7, Steps: 18 | Train Loss: 0.572 Vali Loss: 4.388 Vali Acc: 0.470 Test Loss: 4.388 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.138463735580444
Epoch: 8, Steps: 18 | Train Loss: 0.912 Vali Loss: 5.413 Vali Acc: 0.550 Test Loss: 5.413 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.311473846435547
Epoch: 9, Steps: 18 | Train Loss: 1.875 Vali Loss: 3.311 Vali Acc: 0.520 Test Loss: 3.311 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.89080023765564
Epoch: 10, Steps: 18 | Train Loss: 1.996 Vali Loss: 6.451 Vali Acc: 0.490 Test Loss: 6.451 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 21.244890928268433
Epoch: 11, Steps: 18 | Train Loss: 0.832 Vali Loss: 4.693 Vali Acc: 0.510 Test Loss: 4.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 20.415404081344604
Epoch: 12, Steps: 18 | Train Loss: 0.372 Vali Loss: 4.208 Vali Acc: 0.510 Test Loss: 4.208 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 13147570
model size : 50.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.57771062850952
Epoch: 1, Steps: 18 | Train Loss: 0.840 Vali Loss: 0.924 Vali Acc: 0.540 Test Loss: 0.924 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 15.240827798843384
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 1.238 Vali Acc: 0.480 Test Loss: 1.238 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.417027950286865
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.808 Vali Acc: 0.470 Test Loss: 1.808 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.439140319824219
Epoch: 4, Steps: 18 | Train Loss: 0.843 Vali Loss: 2.041 Vali Acc: 0.490 Test Loss: 2.041 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.650631427764893
Epoch: 5, Steps: 18 | Train Loss: 0.571 Vali Loss: 3.523 Vali Acc: 0.450 Test Loss: 3.523 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.195096492767334
Epoch: 6, Steps: 18 | Train Loss: 0.597 Vali Loss: 1.795 Vali Acc: 0.520 Test Loss: 1.795 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.366198778152466
Epoch: 7, Steps: 18 | Train Loss: 0.369 Vali Loss: 3.159 Vali Acc: 0.490 Test Loss: 3.159 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.232933282852173
Epoch: 8, Steps: 18 | Train Loss: 0.845 Vali Loss: 3.688 Vali Acc: 0.520 Test Loss: 3.688 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.541896343231201
Epoch: 9, Steps: 18 | Train Loss: 0.902 Vali Loss: 5.376 Vali Acc: 0.470 Test Loss: 5.376 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.321602821350098
Epoch: 10, Steps: 18 | Train Loss: 0.634 Vali Loss: 3.845 Vali Acc: 0.480 Test Loss: 3.845 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.824195861816406
Epoch: 11, Steps: 18 | Train Loss: 0.941 Vali Loss: 6.834 Vali Acc: 0.560 Test Loss: 6.834 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559932).  Saving model ...
Epoch: 12 cost time: 15.456051349639893
Epoch: 12, Steps: 18 | Train Loss: 0.736 Vali Loss: 4.718 Vali Acc: 0.460 Test Loss: 4.718 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.401766300201416
Epoch: 13, Steps: 18 | Train Loss: 0.397 Vali Loss: 4.962 Vali Acc: 0.530 Test Loss: 4.962 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.07101583480835
Epoch: 14, Steps: 18 | Train Loss: 0.512 Vali Loss: 5.133 Vali Acc: 0.520 Test Loss: 5.133 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.61835241317749
Epoch: 15, Steps: 18 | Train Loss: 0.640 Vali Loss: 5.890 Vali Acc: 0.480 Test Loss: 5.890 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.815899848937988
Epoch: 16, Steps: 18 | Train Loss: 0.654 Vali Loss: 5.450 Vali Acc: 0.560 Test Loss: 5.450 Test Acc: 0.560
Validation loss decreased (-0.559932 --> -0.559945).  Saving model ...
Epoch: 17 cost time: 10.57059121131897
Epoch: 17, Steps: 18 | Train Loss: 0.669 Vali Loss: 7.408 Vali Acc: 0.450 Test Loss: 7.408 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.421029806137085
Epoch: 18, Steps: 18 | Train Loss: 0.472 Vali Loss: 7.712 Vali Acc: 0.480 Test Loss: 7.712 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.776616334915161
Epoch: 19, Steps: 18 | Train Loss: 0.764 Vali Loss: 12.813 Vali Acc: 0.510 Test Loss: 12.813 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.737968444824219
Epoch: 20, Steps: 18 | Train Loss: 0.615 Vali Loss: 13.327 Vali Acc: 0.520 Test Loss: 13.327 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.440402030944824
Epoch: 21, Steps: 18 | Train Loss: 0.595 Vali Loss: 17.165 Vali Acc: 0.440 Test Loss: 17.165 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.339576244354248
Epoch: 22, Steps: 18 | Train Loss: 0.445 Vali Loss: 11.869 Vali Acc: 0.500 Test Loss: 11.869 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.153482437133789
Epoch: 23, Steps: 18 | Train Loss: 0.979 Vali Loss: 9.342 Vali Acc: 0.480 Test Loss: 9.342 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.25643253326416
Epoch: 24, Steps: 18 | Train Loss: 0.355 Vali Loss: 10.660 Vali Acc: 0.400 Test Loss: 10.660 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 14.626261234283447
Epoch: 25, Steps: 18 | Train Loss: 0.443 Vali Loss: 8.825 Vali Acc: 0.430 Test Loss: 8.825 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 15.324876308441162
Epoch: 26, Steps: 18 | Train Loss: 0.179 Vali Loss: 7.526 Vali Acc: 0.500 Test Loss: 7.526 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 12993970
model size : 50.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.500817775726318
Epoch: 1, Steps: 18 | Train Loss: 0.917 Vali Loss: 0.869 Vali Acc: 0.610 Test Loss: 0.869 Test Acc: 0.610
Validation loss decreased (inf --> -0.609991).  Saving model ...
Epoch: 2 cost time: 8.400997877120972
Epoch: 2, Steps: 18 | Train Loss: 0.807 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.150325059890747
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.193 Vali Acc: 0.510 Test Loss: 1.193 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.697119951248169
Epoch: 4, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.756 Vali Acc: 0.540 Test Loss: 1.756 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.8763391971588135
Epoch: 5, Steps: 18 | Train Loss: 0.529 Vali Loss: 2.395 Vali Acc: 0.450 Test Loss: 2.395 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.482425928115845
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 2.833 Vali Acc: 0.530 Test Loss: 2.833 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.180447340011597
Epoch: 7, Steps: 18 | Train Loss: 0.609 Vali Loss: 3.902 Vali Acc: 0.510 Test Loss: 3.902 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.65894603729248
Epoch: 8, Steps: 18 | Train Loss: 0.482 Vali Loss: 3.187 Vali Acc: 0.530 Test Loss: 3.187 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.682815074920654
Epoch: 9, Steps: 18 | Train Loss: 0.990 Vali Loss: 5.744 Vali Acc: 0.530 Test Loss: 5.744 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.156430721282959
Epoch: 10, Steps: 18 | Train Loss: 0.937 Vali Loss: 4.595 Vali Acc: 0.490 Test Loss: 4.595 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.805558919906616
Epoch: 11, Steps: 18 | Train Loss: 1.891 Vali Loss: 7.145 Vali Acc: 0.530 Test Loss: 7.145 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 12871090
model size : 49.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.409388065338135
Epoch: 1, Steps: 18 | Train Loss: 0.943 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 4.962583780288696
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.961 Vali Acc: 0.570 Test Loss: 0.961 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.757347345352173
Epoch: 3, Steps: 18 | Train Loss: 0.560 Vali Loss: 2.167 Vali Acc: 0.500 Test Loss: 2.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.706337213516235
Epoch: 4, Steps: 18 | Train Loss: 0.434 Vali Loss: 2.445 Vali Acc: 0.440 Test Loss: 2.445 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.895304203033447
Epoch: 5, Steps: 18 | Train Loss: 0.907 Vali Loss: 3.506 Vali Acc: 0.490 Test Loss: 3.506 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.915037393569946
Epoch: 6, Steps: 18 | Train Loss: 0.753 Vali Loss: 2.670 Vali Acc: 0.570 Test Loss: 2.670 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.906966209411621
Epoch: 7, Steps: 18 | Train Loss: 0.646 Vali Loss: 4.649 Vali Acc: 0.470 Test Loss: 4.649 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.9674601554870605
Epoch: 8, Steps: 18 | Train Loss: 0.784 Vali Loss: 4.293 Vali Acc: 0.520 Test Loss: 4.293 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.0842320919036865
Epoch: 9, Steps: 18 | Train Loss: 0.604 Vali Loss: 5.348 Vali Acc: 0.530 Test Loss: 5.348 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.086543560028076
Epoch: 10, Steps: 18 | Train Loss: 1.562 Vali Loss: 7.025 Vali Acc: 0.490 Test Loss: 7.025 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.65503191947937
Epoch: 11, Steps: 18 | Train Loss: 0.382 Vali Loss: 5.792 Vali Acc: 0.430 Test Loss: 5.792 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 12809650
model size : 49.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.465577125549316
Epoch: 1, Steps: 18 | Train Loss: 0.959 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 3.1179864406585693
Epoch: 2, Steps: 18 | Train Loss: 1.405 Vali Loss: 1.417 Vali Acc: 0.540 Test Loss: 1.417 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3394172191619873
Epoch: 3, Steps: 18 | Train Loss: 1.207 Vali Loss: 1.697 Vali Acc: 0.540 Test Loss: 1.697 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.813080072402954
Epoch: 4, Steps: 18 | Train Loss: 0.545 Vali Loss: 2.146 Vali Acc: 0.470 Test Loss: 2.146 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.323127269744873
Epoch: 5, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.634 Vali Acc: 0.580 Test Loss: 1.634 Test Acc: 0.580
Validation loss decreased (-0.549986 --> -0.579984).  Saving model ...
Epoch: 6 cost time: 4.30230188369751
Epoch: 6, Steps: 18 | Train Loss: 0.292 Vali Loss: 3.158 Vali Acc: 0.510 Test Loss: 3.158 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.368218421936035
Epoch: 7, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.041 Vali Acc: 0.460 Test Loss: 3.041 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.35903787612915
Epoch: 8, Steps: 18 | Train Loss: 0.436 Vali Loss: 4.261 Vali Acc: 0.490 Test Loss: 4.261 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.1798295974731445
Epoch: 9, Steps: 18 | Train Loss: 0.562 Vali Loss: 3.846 Vali Acc: 0.470 Test Loss: 3.846 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.803963661193848
Epoch: 10, Steps: 18 | Train Loss: 0.483 Vali Loss: 4.915 Vali Acc: 0.530 Test Loss: 4.915 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.622778415679932
Epoch: 11, Steps: 18 | Train Loss: 0.690 Vali Loss: 4.706 Vali Acc: 0.460 Test Loss: 4.706 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.292999505996704
Epoch: 12, Steps: 18 | Train Loss: 0.428 Vali Loss: 4.326 Vali Acc: 0.500 Test Loss: 4.326 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.600933790206909
Epoch: 13, Steps: 18 | Train Loss: 0.603 Vali Loss: 6.137 Vali Acc: 0.490 Test Loss: 6.137 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.7468366622924805
Epoch: 14, Steps: 18 | Train Loss: 0.239 Vali Loss: 7.909 Vali Acc: 0.470 Test Loss: 7.909 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.6971042156219482
Epoch: 15, Steps: 18 | Train Loss: 0.464 Vali Loss: 7.714 Vali Acc: 0.500 Test Loss: 7.714 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12748210
model size : 48.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4746031761169434
Epoch: 1, Steps: 18 | Train Loss: 0.865 Vali Loss: 1.135 Vali Acc: 0.510 Test Loss: 1.135 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 1.9344050884246826
Epoch: 2, Steps: 18 | Train Loss: 0.767 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.509989 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.8802070617675781
Epoch: 3, Steps: 18 | Train Loss: 0.556 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.85853910446167
Epoch: 4, Steps: 18 | Train Loss: 0.710 Vali Loss: 2.167 Vali Acc: 0.510 Test Loss: 2.167 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8004670143127441
Epoch: 5, Steps: 18 | Train Loss: 0.699 Vali Loss: 2.615 Vali Acc: 0.510 Test Loss: 2.615 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8355777263641357
Epoch: 6, Steps: 18 | Train Loss: 0.943 Vali Loss: 3.147 Vali Acc: 0.460 Test Loss: 3.147 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8673593997955322
Epoch: 7, Steps: 18 | Train Loss: 0.612 Vali Loss: 3.119 Vali Acc: 0.430 Test Loss: 3.119 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8590030670166016
Epoch: 8, Steps: 18 | Train Loss: 0.998 Vali Loss: 2.521 Vali Acc: 0.470 Test Loss: 2.521 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7966585159301758
Epoch: 9, Steps: 18 | Train Loss: 0.545 Vali Loss: 3.219 Vali Acc: 0.480 Test Loss: 3.219 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.881380558013916
Epoch: 10, Steps: 18 | Train Loss: 0.633 Vali Loss: 6.030 Vali Acc: 0.480 Test Loss: 6.030 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8672783374786377
Epoch: 11, Steps: 18 | Train Loss: 0.746 Vali Loss: 5.137 Vali Acc: 0.590 Test Loss: 5.137 Test Acc: 0.590
Validation loss decreased (-0.549987 --> -0.589949).  Saving model ...
Epoch: 12 cost time: 1.8441250324249268
Epoch: 12, Steps: 18 | Train Loss: 0.536 Vali Loss: 6.438 Vali Acc: 0.470 Test Loss: 6.438 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.868464469909668
Epoch: 13, Steps: 18 | Train Loss: 0.480 Vali Loss: 4.993 Vali Acc: 0.500 Test Loss: 4.993 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8848226070404053
Epoch: 14, Steps: 18 | Train Loss: 0.942 Vali Loss: 7.915 Vali Acc: 0.610 Test Loss: 7.915 Test Acc: 0.610
Validation loss decreased (-0.589949 --> -0.609921).  Saving model ...
Epoch: 15 cost time: 2.139613389968872
Epoch: 15, Steps: 18 | Train Loss: 1.086 Vali Loss: 5.322 Vali Acc: 0.500 Test Loss: 5.322 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9082016944885254
Epoch: 16, Steps: 18 | Train Loss: 1.916 Vali Loss: 10.826 Vali Acc: 0.490 Test Loss: 10.826 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9468271732330322
Epoch: 17, Steps: 18 | Train Loss: 1.359 Vali Loss: 13.888 Vali Acc: 0.440 Test Loss: 13.888 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.926624059677124
Epoch: 18, Steps: 18 | Train Loss: 0.935 Vali Loss: 6.843 Vali Acc: 0.450 Test Loss: 6.843 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8914504051208496
Epoch: 19, Steps: 18 | Train Loss: 1.330 Vali Loss: 7.310 Vali Acc: 0.600 Test Loss: 7.310 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.968869686126709
Epoch: 20, Steps: 18 | Train Loss: 0.966 Vali Loss: 8.149 Vali Acc: 0.510 Test Loss: 8.149 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0594844818115234
Epoch: 21, Steps: 18 | Train Loss: 1.066 Vali Loss: 9.594 Vali Acc: 0.530 Test Loss: 9.594 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0470564365386963
Epoch: 22, Steps: 18 | Train Loss: 1.542 Vali Loss: 6.839 Vali Acc: 0.580 Test Loss: 6.839 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.055665969848633
Epoch: 23, Steps: 18 | Train Loss: 1.356 Vali Loss: 8.735 Vali Acc: 0.530 Test Loss: 8.735 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0121660232543945
Epoch: 24, Steps: 18 | Train Loss: 2.450 Vali Loss: 8.799 Vali Acc: 0.540 Test Loss: 8.799 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 12688818
model size : 48.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.341427326202393
Epoch: 1, Steps: 18 | Train Loss: 1.183 Vali Loss: 1.539 Vali Acc: 0.490 Test Loss: 1.539 Test Acc: 0.490
Validation loss decreased (inf --> -0.489985).  Saving model ...
Epoch: 2 cost time: 27.817748069763184
Epoch: 2, Steps: 18 | Train Loss: 1.117 Vali Loss: 2.748 Vali Acc: 0.480 Test Loss: 2.748 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.484960317611694
Epoch: 3, Steps: 18 | Train Loss: 1.133 Vali Loss: 1.637 Vali Acc: 0.540 Test Loss: 1.637 Test Acc: 0.540
Validation loss decreased (-0.489985 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 28.83885383605957
Epoch: 4, Steps: 18 | Train Loss: 1.159 Vali Loss: 3.795 Vali Acc: 0.500 Test Loss: 3.795 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.620287656784058
Epoch: 5, Steps: 18 | Train Loss: 0.697 Vali Loss: 2.397 Vali Acc: 0.540 Test Loss: 2.397 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 37.129894733428955
Epoch: 6, Steps: 18 | Train Loss: 0.753 Vali Loss: 4.018 Vali Acc: 0.500 Test Loss: 4.018 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 36.92531228065491
Epoch: 7, Steps: 18 | Train Loss: 0.715 Vali Loss: 4.057 Vali Acc: 0.460 Test Loss: 4.057 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 41.31686973571777
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 2.596 Vali Acc: 0.590 Test Loss: 2.596 Test Acc: 0.590
Validation loss decreased (-0.539984 --> -0.589974).  Saving model ...
Epoch: 9 cost time: 29.07580542564392
Epoch: 9, Steps: 18 | Train Loss: 0.767 Vali Loss: 6.362 Vali Acc: 0.500 Test Loss: 6.362 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.928310871124268
Epoch: 10, Steps: 18 | Train Loss: 0.939 Vali Loss: 7.609 Vali Acc: 0.460 Test Loss: 7.609 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.296170473098755
Epoch: 11, Steps: 18 | Train Loss: 0.874 Vali Loss: 3.613 Vali Acc: 0.560 Test Loss: 3.613 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 32.4383327960968
Epoch: 12, Steps: 18 | Train Loss: 0.369 Vali Loss: 4.355 Vali Acc: 0.590 Test Loss: 4.355 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.061105489730835
Epoch: 13, Steps: 18 | Train Loss: 0.727 Vali Loss: 8.437 Vali Acc: 0.520 Test Loss: 8.437 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 28.252801179885864
Epoch: 14, Steps: 18 | Train Loss: 1.166 Vali Loss: 8.960 Vali Acc: 0.540 Test Loss: 8.960 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 37.13792824745178
Epoch: 15, Steps: 18 | Train Loss: 0.458 Vali Loss: 9.834 Vali Acc: 0.470 Test Loss: 9.834 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 30.03323221206665
Epoch: 16, Steps: 18 | Train Loss: 0.710 Vali Loss: 7.344 Vali Acc: 0.550 Test Loss: 7.344 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 33.51984477043152
Epoch: 17, Steps: 18 | Train Loss: 1.256 Vali Loss: 11.324 Vali Acc: 0.480 Test Loss: 11.324 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 31.314321517944336
Epoch: 18, Steps: 18 | Train Loss: 0.807 Vali Loss: 9.655 Vali Acc: 0.530 Test Loss: 9.655 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 13450642
model size : 52.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.04312753677368
Epoch: 1, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 27.073113441467285
Epoch: 2, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539988).  Saving model ...
Epoch: 3 cost time: 24.57637858390808
Epoch: 3, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.591 Vali Acc: 0.480 Test Loss: 1.591 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.708627939224243
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 3.020 Vali Acc: 0.530 Test Loss: 3.020 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.081568956375122
Epoch: 5, Steps: 18 | Train Loss: 0.896 Vali Loss: 3.448 Vali Acc: 0.440 Test Loss: 3.448 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.629199504852295
Epoch: 6, Steps: 18 | Train Loss: 0.627 Vali Loss: 2.616 Vali Acc: 0.460 Test Loss: 2.616 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.40612530708313
Epoch: 7, Steps: 18 | Train Loss: 0.292 Vali Loss: 3.154 Vali Acc: 0.530 Test Loss: 3.154 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.968806743621826
Epoch: 8, Steps: 18 | Train Loss: 0.964 Vali Loss: 4.967 Vali Acc: 0.560 Test Loss: 4.967 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559950).  Saving model ...
Epoch: 9 cost time: 25.878333568572998
Epoch: 9, Steps: 18 | Train Loss: 1.203 Vali Loss: 5.920 Vali Acc: 0.510 Test Loss: 5.920 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.654290676116943
Epoch: 10, Steps: 18 | Train Loss: 2.540 Vali Loss: 7.938 Vali Acc: 0.490 Test Loss: 7.938 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.367010593414307
Epoch: 11, Steps: 18 | Train Loss: 0.667 Vali Loss: 7.312 Vali Acc: 0.490 Test Loss: 7.312 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.423105716705322
Epoch: 12, Steps: 18 | Train Loss: 0.645 Vali Loss: 8.205 Vali Acc: 0.450 Test Loss: 8.205 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.88149666786194
Epoch: 13, Steps: 18 | Train Loss: 0.684 Vali Loss: 5.434 Vali Acc: 0.470 Test Loss: 5.434 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 30.079558610916138
Epoch: 14, Steps: 18 | Train Loss: 0.275 Vali Loss: 6.203 Vali Acc: 0.480 Test Loss: 6.203 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 30.047418355941772
Epoch: 15, Steps: 18 | Train Loss: 0.781 Vali Loss: 9.578 Vali Acc: 0.500 Test Loss: 9.578 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 31.286081552505493
Epoch: 16, Steps: 18 | Train Loss: 0.988 Vali Loss: 4.998 Vali Acc: 0.530 Test Loss: 4.998 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 28.073341131210327
Epoch: 17, Steps: 18 | Train Loss: 0.306 Vali Loss: 5.680 Vali Acc: 0.540 Test Loss: 5.680 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 30.85643172264099
Epoch: 18, Steps: 18 | Train Loss: 0.326 Vali Loss: 6.068 Vali Acc: 0.540 Test Loss: 6.068 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 13297042
model size : 51.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.729214429855347
Epoch: 1, Steps: 18 | Train Loss: 0.973 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 15.367101669311523
Epoch: 2, Steps: 18 | Train Loss: 0.753 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 24.328768014907837
Epoch: 3, Steps: 18 | Train Loss: 0.436 Vali Loss: 2.593 Vali Acc: 0.520 Test Loss: 2.593 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.276753425598145
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 2.255 Vali Acc: 0.530 Test Loss: 2.255 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.402076721191406
Epoch: 5, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.069 Vali Acc: 0.510 Test Loss: 3.069 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.691878080368042
Epoch: 6, Steps: 18 | Train Loss: 0.534 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.54378604888916
Epoch: 7, Steps: 18 | Train Loss: 0.572 Vali Loss: 2.521 Vali Acc: 0.450 Test Loss: 2.521 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.925443410873413
Epoch: 8, Steps: 18 | Train Loss: 0.547 Vali Loss: 2.739 Vali Acc: 0.530 Test Loss: 2.739 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.866478443145752
Epoch: 9, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.085 Vali Acc: 0.510 Test Loss: 3.085 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.0164532661438
Epoch: 10, Steps: 18 | Train Loss: 0.872 Vali Loss: 4.346 Vali Acc: 0.510 Test Loss: 4.346 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.45018434524536
Epoch: 11, Steps: 18 | Train Loss: 0.495 Vali Loss: 4.719 Vali Acc: 0.440 Test Loss: 4.719 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.859104633331299
Epoch: 12, Steps: 18 | Train Loss: 0.565 Vali Loss: 6.556 Vali Acc: 0.520 Test Loss: 6.556 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 13143442
model size : 50.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.92429494857788
Epoch: 1, Steps: 18 | Train Loss: 0.979 Vali Loss: 1.287 Vali Acc: 0.590 Test Loss: 1.287 Test Acc: 0.590
Validation loss decreased (inf --> -0.589987).  Saving model ...
Epoch: 2 cost time: 16.24763798713684
Epoch: 2, Steps: 18 | Train Loss: 0.904 Vali Loss: 2.626 Vali Acc: 0.540 Test Loss: 2.626 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.807286262512207
Epoch: 3, Steps: 18 | Train Loss: 1.182 Vali Loss: 2.980 Vali Acc: 0.450 Test Loss: 2.980 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.510355710983276
Epoch: 4, Steps: 18 | Train Loss: 0.898 Vali Loss: 4.185 Vali Acc: 0.520 Test Loss: 4.185 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.772986888885498
Epoch: 5, Steps: 18 | Train Loss: 0.615 Vali Loss: 3.375 Vali Acc: 0.500 Test Loss: 3.375 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.850317001342773
Epoch: 6, Steps: 18 | Train Loss: 0.910 Vali Loss: 3.061 Vali Acc: 0.520 Test Loss: 3.061 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.817965745925903
Epoch: 7, Steps: 18 | Train Loss: 0.270 Vali Loss: 3.680 Vali Acc: 0.510 Test Loss: 3.680 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.723824739456177
Epoch: 8, Steps: 18 | Train Loss: 0.891 Vali Loss: 4.112 Vali Acc: 0.540 Test Loss: 4.112 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.815943241119385
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 4.590 Vali Acc: 0.450 Test Loss: 4.590 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.308923721313477
Epoch: 10, Steps: 18 | Train Loss: 0.643 Vali Loss: 5.621 Vali Acc: 0.540 Test Loss: 5.621 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.94684624671936
Epoch: 11, Steps: 18 | Train Loss: 0.512 Vali Loss: 4.029 Vali Acc: 0.490 Test Loss: 4.029 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 12989842
model size : 50.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.439746856689453
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 6.693489074707031
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.316162824630737
Epoch: 3, Steps: 18 | Train Loss: 0.952 Vali Loss: 2.765 Vali Acc: 0.500 Test Loss: 2.765 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.390256881713867
Epoch: 4, Steps: 18 | Train Loss: 1.546 Vali Loss: 3.187 Vali Acc: 0.500 Test Loss: 3.187 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.751767158508301
Epoch: 5, Steps: 18 | Train Loss: 0.771 Vali Loss: 3.138 Vali Acc: 0.640 Test Loss: 3.138 Test Acc: 0.640
Validation loss decreased (-0.519990 --> -0.639969).  Saving model ...
Epoch: 6 cost time: 8.096762657165527
Epoch: 6, Steps: 18 | Train Loss: 0.740 Vali Loss: 2.524 Vali Acc: 0.480 Test Loss: 2.524 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.846877336502075
Epoch: 7, Steps: 18 | Train Loss: 0.656 Vali Loss: 2.635 Vali Acc: 0.550 Test Loss: 2.635 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.51718783378601
Epoch: 8, Steps: 18 | Train Loss: 0.651 Vali Loss: 3.969 Vali Acc: 0.530 Test Loss: 3.969 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.28490686416626
Epoch: 9, Steps: 18 | Train Loss: 1.364 Vali Loss: 5.947 Vali Acc: 0.570 Test Loss: 5.947 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.877393007278442
Epoch: 10, Steps: 18 | Train Loss: 1.430 Vali Loss: 6.268 Vali Acc: 0.550 Test Loss: 6.268 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.221261501312256
Epoch: 11, Steps: 18 | Train Loss: 0.641 Vali Loss: 6.739 Vali Acc: 0.540 Test Loss: 6.739 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.4496541023254395
Epoch: 12, Steps: 18 | Train Loss: 0.550 Vali Loss: 4.835 Vali Acc: 0.450 Test Loss: 4.835 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.771965503692627
Epoch: 13, Steps: 18 | Train Loss: 0.439 Vali Loss: 6.337 Vali Acc: 0.450 Test Loss: 6.337 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.50795578956604
Epoch: 14, Steps: 18 | Train Loss: 0.346 Vali Loss: 5.403 Vali Acc: 0.500 Test Loss: 5.403 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.941558361053467
Epoch: 15, Steps: 18 | Train Loss: 0.436 Vali Loss: 5.850 Vali Acc: 0.560 Test Loss: 5.850 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 12866962
model size : 49.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.435167551040649
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.899636507034302
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 6.814897775650024
Epoch: 3, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.560 Vali Acc: 0.540 Test Loss: 1.560 Test Acc: 0.540
Validation loss decreased (-0.499984 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 6.482917547225952
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 2.223 Vali Acc: 0.510 Test Loss: 2.223 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.045504808425903
Epoch: 5, Steps: 18 | Train Loss: 0.431 Vali Loss: 2.789 Vali Acc: 0.580 Test Loss: 2.789 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579972).  Saving model ...
Epoch: 6 cost time: 5.081564664840698
Epoch: 6, Steps: 18 | Train Loss: 0.936 Vali Loss: 2.556 Vali Acc: 0.580 Test Loss: 2.556 Test Acc: 0.580
Validation loss decreased (-0.579972 --> -0.579974).  Saving model ...
Epoch: 7 cost time: 5.4420247077941895
Epoch: 7, Steps: 18 | Train Loss: 0.592 Vali Loss: 2.911 Vali Acc: 0.530 Test Loss: 2.911 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.356518983840942
Epoch: 8, Steps: 18 | Train Loss: 0.954 Vali Loss: 2.987 Vali Acc: 0.500 Test Loss: 2.987 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.261350393295288
Epoch: 9, Steps: 18 | Train Loss: 0.550 Vali Loss: 2.720 Vali Acc: 0.510 Test Loss: 2.720 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.620841026306152
Epoch: 10, Steps: 18 | Train Loss: 0.467 Vali Loss: 9.163 Vali Acc: 0.510 Test Loss: 9.163 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.984767913818359
Epoch: 11, Steps: 18 | Train Loss: 0.871 Vali Loss: 4.644 Vali Acc: 0.510 Test Loss: 4.644 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.8012025356292725
Epoch: 12, Steps: 18 | Train Loss: 0.621 Vali Loss: 5.420 Vali Acc: 0.530 Test Loss: 5.420 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.965475797653198
Epoch: 13, Steps: 18 | Train Loss: 0.431 Vali Loss: 5.510 Vali Acc: 0.520 Test Loss: 5.510 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.5843470096588135
Epoch: 14, Steps: 18 | Train Loss: 0.834 Vali Loss: 6.804 Vali Acc: 0.500 Test Loss: 6.804 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.6379172801971436
Epoch: 15, Steps: 18 | Train Loss: 1.503 Vali Loss: 6.814 Vali Acc: 0.500 Test Loss: 6.814 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.42011833190918
Epoch: 16, Steps: 18 | Train Loss: 0.335 Vali Loss: 4.869 Vali Acc: 0.570 Test Loss: 4.869 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12805522
model size : 49.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.289113759994507
Epoch: 1, Steps: 18 | Train Loss: 0.963 Vali Loss: 0.871 Vali Acc: 0.570 Test Loss: 0.871 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 4.02677845954895
Epoch: 2, Steps: 18 | Train Loss: 0.615 Vali Loss: 1.383 Vali Acc: 0.540 Test Loss: 1.383 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.493464231491089
Epoch: 3, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.533 Vali Acc: 0.500 Test Loss: 1.533 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.266904354095459
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 1.682 Vali Acc: 0.540 Test Loss: 1.682 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4972217082977295
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 2.694 Vali Acc: 0.510 Test Loss: 2.694 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2552642822265625
Epoch: 6, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.820 Vali Acc: 0.530 Test Loss: 2.820 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5479776859283447
Epoch: 7, Steps: 18 | Train Loss: 0.679 Vali Loss: 2.772 Vali Acc: 0.450 Test Loss: 2.772 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4217045307159424
Epoch: 8, Steps: 18 | Train Loss: 0.497 Vali Loss: 3.483 Vali Acc: 0.590 Test Loss: 3.483 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589965).  Saving model ...
Epoch: 9 cost time: 3.522592067718506
Epoch: 9, Steps: 18 | Train Loss: 1.561 Vali Loss: 4.230 Vali Acc: 0.500 Test Loss: 4.230 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5664772987365723
Epoch: 10, Steps: 18 | Train Loss: 0.551 Vali Loss: 4.490 Vali Acc: 0.500 Test Loss: 4.490 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7115445137023926
Epoch: 11, Steps: 18 | Train Loss: 0.408 Vali Loss: 4.174 Vali Acc: 0.550 Test Loss: 4.174 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4183409214019775
Epoch: 12, Steps: 18 | Train Loss: 0.612 Vali Loss: 8.684 Vali Acc: 0.480 Test Loss: 8.684 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.66127610206604
Epoch: 13, Steps: 18 | Train Loss: 0.600 Vali Loss: 5.745 Vali Acc: 0.560 Test Loss: 5.745 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.287288665771484
Epoch: 14, Steps: 18 | Train Loss: 0.949 Vali Loss: 11.152 Vali Acc: 0.480 Test Loss: 11.152 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.826983690261841
Epoch: 15, Steps: 18 | Train Loss: 0.892 Vali Loss: 7.120 Vali Acc: 0.540 Test Loss: 7.120 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.648651599884033
Epoch: 16, Steps: 18 | Train Loss: 0.505 Vali Loss: 14.743 Vali Acc: 0.530 Test Loss: 14.743 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.349028587341309
Epoch: 17, Steps: 18 | Train Loss: 1.961 Vali Loss: 9.608 Vali Acc: 0.510 Test Loss: 9.608 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.1648759841918945
Epoch: 18, Steps: 18 | Train Loss: 0.529 Vali Loss: 9.746 Vali Acc: 0.520 Test Loss: 9.746 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 12744082
model size : 48.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6797358989715576
Epoch: 1, Steps: 18 | Train Loss: 0.899 Vali Loss: 0.902 Vali Acc: 0.480 Test Loss: 0.902 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 1.964322805404663
Epoch: 2, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.137 Vali Acc: 0.490 Test Loss: 1.137 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 2.054112434387207
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 3.098 Vali Acc: 0.530 Test Loss: 3.098 Test Acc: 0.530
Validation loss decreased (-0.489989 --> -0.529969).  Saving model ...
Epoch: 4 cost time: 2.197110891342163
Epoch: 4, Steps: 18 | Train Loss: 0.787 Vali Loss: 1.732 Vali Acc: 0.450 Test Loss: 1.732 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.574448347091675
Epoch: 5, Steps: 18 | Train Loss: 0.454 Vali Loss: 2.499 Vali Acc: 0.560 Test Loss: 2.499 Test Acc: 0.560
Validation loss decreased (-0.529969 --> -0.559975).  Saving model ...
Epoch: 6 cost time: 2.128628969192505
Epoch: 6, Steps: 18 | Train Loss: 0.640 Vali Loss: 2.804 Vali Acc: 0.540 Test Loss: 2.804 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.496429443359375
Epoch: 7, Steps: 18 | Train Loss: 0.827 Vali Loss: 2.859 Vali Acc: 0.500 Test Loss: 2.859 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4237210750579834
Epoch: 8, Steps: 18 | Train Loss: 0.370 Vali Loss: 3.471 Vali Acc: 0.560 Test Loss: 3.471 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.043975591659546
Epoch: 9, Steps: 18 | Train Loss: 0.611 Vali Loss: 6.846 Vali Acc: 0.540 Test Loss: 6.846 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.385780096054077
Epoch: 10, Steps: 18 | Train Loss: 1.434 Vali Loss: 4.005 Vali Acc: 0.500 Test Loss: 4.005 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5521113872528076
Epoch: 11, Steps: 18 | Train Loss: 0.622 Vali Loss: 4.111 Vali Acc: 0.520 Test Loss: 4.111 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1077589988708496
Epoch: 12, Steps: 18 | Train Loss: 0.477 Vali Loss: 6.350 Vali Acc: 0.540 Test Loss: 6.350 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4270858764648438
Epoch: 13, Steps: 18 | Train Loss: 1.044 Vali Loss: 6.303 Vali Acc: 0.540 Test Loss: 6.303 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9343476295471191
Epoch: 14, Steps: 18 | Train Loss: 1.100 Vali Loss: 6.294 Vali Acc: 0.550 Test Loss: 6.294 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.172978162765503
Epoch: 15, Steps: 18 | Train Loss: 1.470 Vali Loss: 9.262 Vali Acc: 0.510 Test Loss: 9.262 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 12684690
model size : 48.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.670312881469727
Epoch: 1, Steps: 18 | Train Loss: 0.886 Vali Loss: 0.923 Vali Acc: 0.580 Test Loss: 0.923 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 36.79228615760803
Epoch: 2, Steps: 18 | Train Loss: 0.809 Vali Loss: 2.396 Vali Acc: 0.500 Test Loss: 2.396 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.456584453582764
Epoch: 3, Steps: 18 | Train Loss: 0.885 Vali Loss: 1.567 Vali Acc: 0.520 Test Loss: 1.567 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.34770703315735
Epoch: 4, Steps: 18 | Train Loss: 1.074 Vali Loss: 1.470 Vali Acc: 0.570 Test Loss: 1.470 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 25.023963451385498
Epoch: 5, Steps: 18 | Train Loss: 0.774 Vali Loss: 2.476 Vali Acc: 0.490 Test Loss: 2.476 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 36.27973961830139
Epoch: 6, Steps: 18 | Train Loss: 1.348 Vali Loss: 3.296 Vali Acc: 0.540 Test Loss: 3.296 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 35.93655204772949
Epoch: 7, Steps: 18 | Train Loss: 0.451 Vali Loss: 2.304 Vali Acc: 0.570 Test Loss: 2.304 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 32.8546028137207
Epoch: 8, Steps: 18 | Train Loss: 0.697 Vali Loss: 4.165 Vali Acc: 0.530 Test Loss: 4.165 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 36.712165117263794
Epoch: 9, Steps: 18 | Train Loss: 0.782 Vali Loss: 3.188 Vali Acc: 0.550 Test Loss: 3.188 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 24.84229850769043
Epoch: 10, Steps: 18 | Train Loss: 0.514 Vali Loss: 5.647 Vali Acc: 0.540 Test Loss: 5.647 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 28.6738440990448
Epoch: 11, Steps: 18 | Train Loss: 0.481 Vali Loss: 4.570 Vali Acc: 0.480 Test Loss: 4.570 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 13448578
model size : 52.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.460059881210327
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 24.629759073257446
Epoch: 2, Steps: 18 | Train Loss: 0.742 Vali Loss: 1.180 Vali Acc: 0.510 Test Loss: 1.180 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509988).  Saving model ...
Epoch: 3 cost time: 26.63753080368042
Epoch: 3, Steps: 18 | Train Loss: 1.157 Vali Loss: 1.838 Vali Acc: 0.530 Test Loss: 1.838 Test Acc: 0.530
Validation loss decreased (-0.509988 --> -0.529982).  Saving model ...
Epoch: 4 cost time: 19.36313486099243
Epoch: 4, Steps: 18 | Train Loss: 0.875 Vali Loss: 1.650 Vali Acc: 0.580 Test Loss: 1.650 Test Acc: 0.580
Validation loss decreased (-0.529982 --> -0.579983).  Saving model ...
Epoch: 5 cost time: 23.704039812088013
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 2.431 Vali Acc: 0.530 Test Loss: 2.431 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.77799391746521
Epoch: 6, Steps: 18 | Train Loss: 0.915 Vali Loss: 2.610 Vali Acc: 0.520 Test Loss: 2.610 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.474133491516113
Epoch: 7, Steps: 18 | Train Loss: 0.960 Vali Loss: 4.266 Vali Acc: 0.520 Test Loss: 4.266 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.725834369659424
Epoch: 8, Steps: 18 | Train Loss: 0.649 Vali Loss: 2.712 Vali Acc: 0.460 Test Loss: 2.712 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.10191774368286
Epoch: 9, Steps: 18 | Train Loss: 0.861 Vali Loss: 3.674 Vali Acc: 0.580 Test Loss: 3.674 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.02951431274414
Epoch: 10, Steps: 18 | Train Loss: 1.384 Vali Loss: 4.046 Vali Acc: 0.550 Test Loss: 4.046 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.12761616706848
Epoch: 11, Steps: 18 | Train Loss: 0.411 Vali Loss: 3.682 Vali Acc: 0.600 Test Loss: 3.682 Test Acc: 0.600
Validation loss decreased (-0.579983 --> -0.599963).  Saving model ...
Epoch: 12 cost time: 20.723687887191772
Epoch: 12, Steps: 18 | Train Loss: 0.842 Vali Loss: 5.500 Vali Acc: 0.530 Test Loss: 5.500 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 28.057474374771118
Epoch: 13, Steps: 18 | Train Loss: 0.988 Vali Loss: 7.368 Vali Acc: 0.500 Test Loss: 7.368 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 26.70546531677246
Epoch: 14, Steps: 18 | Train Loss: 1.143 Vali Loss: 5.193 Vali Acc: 0.520 Test Loss: 5.193 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 27.469983339309692
Epoch: 15, Steps: 18 | Train Loss: 0.932 Vali Loss: 7.836 Vali Acc: 0.480 Test Loss: 7.836 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.78561568260193
Epoch: 16, Steps: 18 | Train Loss: 0.611 Vali Loss: 10.801 Vali Acc: 0.500 Test Loss: 10.801 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 28.55693221092224
Epoch: 17, Steps: 18 | Train Loss: 0.555 Vali Loss: 5.589 Vali Acc: 0.560 Test Loss: 5.589 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 28.8866069316864
Epoch: 18, Steps: 18 | Train Loss: 0.557 Vali Loss: 8.412 Vali Acc: 0.530 Test Loss: 8.412 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 28.268850803375244
Epoch: 19, Steps: 18 | Train Loss: 0.322 Vali Loss: 7.287 Vali Acc: 0.460 Test Loss: 7.287 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.03050422668457
Epoch: 20, Steps: 18 | Train Loss: 0.270 Vali Loss: 8.156 Vali Acc: 0.440 Test Loss: 8.156 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 24.549402236938477
Epoch: 21, Steps: 18 | Train Loss: 0.273 Vali Loss: 7.415 Vali Acc: 0.570 Test Loss: 7.415 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13294978
model size : 51.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.114598035812378
Epoch: 1, Steps: 18 | Train Loss: 0.982 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 20.3599693775177
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 2.177 Vali Acc: 0.510 Test Loss: 2.177 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509978).  Saving model ...
Epoch: 3 cost time: 15.78341794013977
Epoch: 3, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.659 Vali Acc: 0.470 Test Loss: 1.659 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.636561155319214
Epoch: 4, Steps: 18 | Train Loss: 0.456 Vali Loss: 2.383 Vali Acc: 0.530 Test Loss: 2.383 Test Acc: 0.530
Validation loss decreased (-0.509978 --> -0.529976).  Saving model ...
Epoch: 5 cost time: 19.306593894958496
Epoch: 5, Steps: 18 | Train Loss: 0.939 Vali Loss: 4.469 Vali Acc: 0.460 Test Loss: 4.469 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.48401975631714
Epoch: 6, Steps: 18 | Train Loss: 0.900 Vali Loss: 3.060 Vali Acc: 0.540 Test Loss: 3.060 Test Acc: 0.540
Validation loss decreased (-0.529976 --> -0.539969).  Saving model ...
Epoch: 7 cost time: 17.789341688156128
Epoch: 7, Steps: 18 | Train Loss: 0.725 Vali Loss: 5.682 Vali Acc: 0.480 Test Loss: 5.682 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.775603532791138
Epoch: 8, Steps: 18 | Train Loss: 0.985 Vali Loss: 3.005 Vali Acc: 0.560 Test Loss: 3.005 Test Acc: 0.560
Validation loss decreased (-0.539969 --> -0.559970).  Saving model ...
Epoch: 9 cost time: 18.922635078430176
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 3.985 Vali Acc: 0.560 Test Loss: 3.985 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.75578999519348
Epoch: 10, Steps: 18 | Train Loss: 0.693 Vali Loss: 3.736 Vali Acc: 0.510 Test Loss: 3.736 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.450424194335938
Epoch: 11, Steps: 18 | Train Loss: 0.872 Vali Loss: 6.854 Vali Acc: 0.500 Test Loss: 6.854 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.567855834960938
Epoch: 12, Steps: 18 | Train Loss: 0.445 Vali Loss: 4.257 Vali Acc: 0.550 Test Loss: 4.257 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.91636872291565
Epoch: 13, Steps: 18 | Train Loss: 0.534 Vali Loss: 4.306 Vali Acc: 0.600 Test Loss: 4.306 Test Acc: 0.600
Validation loss decreased (-0.559970 --> -0.599957).  Saving model ...
Epoch: 14 cost time: 16.80413842201233
Epoch: 14, Steps: 18 | Train Loss: 0.516 Vali Loss: 5.390 Vali Acc: 0.490 Test Loss: 5.390 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.407361268997192
Epoch: 15, Steps: 18 | Train Loss: 1.309 Vali Loss: 5.459 Vali Acc: 0.520 Test Loss: 5.459 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.621367692947388
Epoch: 16, Steps: 18 | Train Loss: 0.573 Vali Loss: 11.126 Vali Acc: 0.500 Test Loss: 11.126 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.33849811553955
Epoch: 17, Steps: 18 | Train Loss: 0.502 Vali Loss: 11.335 Vali Acc: 0.500 Test Loss: 11.335 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.113619089126587
Epoch: 18, Steps: 18 | Train Loss: 0.213 Vali Loss: 7.507 Vali Acc: 0.470 Test Loss: 7.507 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.379608869552612
Epoch: 19, Steps: 18 | Train Loss: 0.283 Vali Loss: 7.067 Vali Acc: 0.510 Test Loss: 7.067 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 15.865618228912354
Epoch: 20, Steps: 18 | Train Loss: 0.378 Vali Loss: 6.701 Vali Acc: 0.520 Test Loss: 6.701 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.82366442680359
Epoch: 21, Steps: 18 | Train Loss: 0.273 Vali Loss: 9.435 Vali Acc: 0.500 Test Loss: 9.435 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 18.871980667114258
Epoch: 22, Steps: 18 | Train Loss: 0.358 Vali Loss: 8.407 Vali Acc: 0.420 Test Loss: 8.407 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.546998262405396
Epoch: 23, Steps: 18 | Train Loss: 0.510 Vali Loss: 12.733 Vali Acc: 0.480 Test Loss: 12.733 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13141378
model size : 50.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.792212963104248
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 0.739 Vali Acc: 0.580 Test Loss: 0.739 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 17.412907361984253
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.483383893966675
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 2.090 Vali Acc: 0.530 Test Loss: 2.090 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.127235174179077
Epoch: 4, Steps: 18 | Train Loss: 0.516 Vali Loss: 1.416 Vali Acc: 0.480 Test Loss: 1.416 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.812909603118896
Epoch: 5, Steps: 18 | Train Loss: 0.359 Vali Loss: 2.244 Vali Acc: 0.510 Test Loss: 2.244 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.53553056716919
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 2.860 Vali Acc: 0.490 Test Loss: 2.860 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.224762439727783
Epoch: 7, Steps: 18 | Train Loss: 0.466 Vali Loss: 2.505 Vali Acc: 0.530 Test Loss: 2.505 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.827391386032104
Epoch: 8, Steps: 18 | Train Loss: 0.492 Vali Loss: 4.314 Vali Acc: 0.500 Test Loss: 4.314 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.307934284210205
Epoch: 9, Steps: 18 | Train Loss: 1.067 Vali Loss: 7.182 Vali Acc: 0.470 Test Loss: 7.182 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.944764375686646
Epoch: 10, Steps: 18 | Train Loss: 0.526 Vali Loss: 10.297 Vali Acc: 0.470 Test Loss: 10.297 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.08305597305298
Epoch: 11, Steps: 18 | Train Loss: 0.747 Vali Loss: 4.908 Vali Acc: 0.550 Test Loss: 4.908 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12987778
model size : 50.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.385812520980835
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.765 Vali Acc: 0.590 Test Loss: 0.765 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 10.950401067733765
Epoch: 2, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.966 Vali Acc: 0.440 Test Loss: 0.966 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.941293239593506
Epoch: 3, Steps: 18 | Train Loss: 0.516 Vali Loss: 1.337 Vali Acc: 0.570 Test Loss: 1.337 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.477480888366699
Epoch: 4, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.703 Vali Acc: 0.560 Test Loss: 1.703 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.920020580291748
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 5.866 Vali Acc: 0.510 Test Loss: 5.866 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.67435359954834
Epoch: 6, Steps: 18 | Train Loss: 0.639 Vali Loss: 2.718 Vali Acc: 0.610 Test Loss: 2.718 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609973).  Saving model ...
Epoch: 7 cost time: 11.405090808868408
Epoch: 7, Steps: 18 | Train Loss: 0.396 Vali Loss: 2.617 Vali Acc: 0.530 Test Loss: 2.617 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.426763772964478
Epoch: 8, Steps: 18 | Train Loss: 0.425 Vali Loss: 6.796 Vali Acc: 0.460 Test Loss: 6.796 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.606040000915527
Epoch: 9, Steps: 18 | Train Loss: 0.639 Vali Loss: 5.417 Vali Acc: 0.500 Test Loss: 5.417 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.688440322875977
Epoch: 10, Steps: 18 | Train Loss: 0.541 Vali Loss: 4.911 Vali Acc: 0.540 Test Loss: 4.911 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.78002667427063
Epoch: 11, Steps: 18 | Train Loss: 0.844 Vali Loss: 7.963 Vali Acc: 0.570 Test Loss: 7.963 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.04516053199768
Epoch: 12, Steps: 18 | Train Loss: 0.415 Vali Loss: 6.028 Vali Acc: 0.480 Test Loss: 6.028 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.442353963851929
Epoch: 13, Steps: 18 | Train Loss: 0.444 Vali Loss: 4.630 Vali Acc: 0.550 Test Loss: 4.630 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.2743239402771
Epoch: 14, Steps: 18 | Train Loss: 0.374 Vali Loss: 6.070 Vali Acc: 0.490 Test Loss: 6.070 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.5109217166900635
Epoch: 15, Steps: 18 | Train Loss: 0.313 Vali Loss: 6.223 Vali Acc: 0.450 Test Loss: 6.223 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.297482252120972
Epoch: 16, Steps: 18 | Train Loss: 0.305 Vali Loss: 6.505 Vali Acc: 0.450 Test Loss: 6.505 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 12864898
model size : 49.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.298948526382446
Epoch: 1, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.321 Vali Acc: 0.480 Test Loss: 1.321 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 8.757447004318237
Epoch: 2, Steps: 18 | Train Loss: 0.725 Vali Loss: 1.010 Vali Acc: 0.540 Test Loss: 1.010 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539990).  Saving model ...
Epoch: 3 cost time: 6.9202704429626465
Epoch: 3, Steps: 18 | Train Loss: 0.509 Vali Loss: 1.159 Vali Acc: 0.540 Test Loss: 1.159 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.2832581996917725
Epoch: 4, Steps: 18 | Train Loss: 0.451 Vali Loss: 2.150 Vali Acc: 0.660 Test Loss: 2.150 Test Acc: 0.660
Validation loss decreased (-0.539990 --> -0.659979).  Saving model ...
Epoch: 5 cost time: 6.294445753097534
Epoch: 5, Steps: 18 | Train Loss: 0.555 Vali Loss: 3.307 Vali Acc: 0.480 Test Loss: 3.307 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.9600958824157715
Epoch: 6, Steps: 18 | Train Loss: 1.181 Vali Loss: 7.146 Vali Acc: 0.520 Test Loss: 7.146 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.814053297042847
Epoch: 7, Steps: 18 | Train Loss: 1.588 Vali Loss: 4.093 Vali Acc: 0.520 Test Loss: 4.093 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.508028745651245
Epoch: 8, Steps: 18 | Train Loss: 0.533 Vali Loss: 4.534 Vali Acc: 0.540 Test Loss: 4.534 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.0473597049713135
Epoch: 9, Steps: 18 | Train Loss: 0.430 Vali Loss: 3.905 Vali Acc: 0.520 Test Loss: 3.905 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.762866973876953
Epoch: 10, Steps: 18 | Train Loss: 0.548 Vali Loss: 4.272 Vali Acc: 0.450 Test Loss: 4.272 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.359641313552856
Epoch: 11, Steps: 18 | Train Loss: 0.541 Vali Loss: 5.973 Vali Acc: 0.500 Test Loss: 5.973 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.952708005905151
Epoch: 12, Steps: 18 | Train Loss: 1.397 Vali Loss: 6.232 Vali Acc: 0.510 Test Loss: 6.232 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.08234715461731
Epoch: 13, Steps: 18 | Train Loss: 0.814 Vali Loss: 5.546 Vali Acc: 0.460 Test Loss: 5.546 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.084112644195557
Epoch: 14, Steps: 18 | Train Loss: 0.236 Vali Loss: 7.913 Vali Acc: 0.460 Test Loss: 7.913 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 12803458
model size : 49.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.7993879318237305
Epoch: 1, Steps: 18 | Train Loss: 0.911 Vali Loss: 0.873 Vali Acc: 0.480 Test Loss: 0.873 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 5.062987327575684
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.596 Vali Acc: 0.450 Test Loss: 1.596 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.836034059524536
Epoch: 3, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.599 Vali Acc: 0.530 Test Loss: 1.599 Test Acc: 0.530
Validation loss decreased (-0.479991 --> -0.529984).  Saving model ...
Epoch: 4 cost time: 4.51633358001709
Epoch: 4, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529986).  Saving model ...
Epoch: 5 cost time: 5.456643581390381
Epoch: 5, Steps: 18 | Train Loss: 0.506 Vali Loss: 3.066 Vali Acc: 0.560 Test Loss: 3.066 Test Acc: 0.560
Validation loss decreased (-0.529986 --> -0.559969).  Saving model ...
Epoch: 6 cost time: 3.8625879287719727
Epoch: 6, Steps: 18 | Train Loss: 0.622 Vali Loss: 3.495 Vali Acc: 0.540 Test Loss: 3.495 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.754244327545166
Epoch: 7, Steps: 18 | Train Loss: 0.845 Vali Loss: 3.159 Vali Acc: 0.530 Test Loss: 3.159 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.036144256591797
Epoch: 8, Steps: 18 | Train Loss: 0.652 Vali Loss: 4.157 Vali Acc: 0.510 Test Loss: 4.157 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6270575523376465
Epoch: 9, Steps: 18 | Train Loss: 0.353 Vali Loss: 3.371 Vali Acc: 0.520 Test Loss: 3.371 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4333887100219727
Epoch: 10, Steps: 18 | Train Loss: 1.518 Vali Loss: 4.758 Vali Acc: 0.530 Test Loss: 4.758 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.585355043411255
Epoch: 11, Steps: 18 | Train Loss: 0.423 Vali Loss: 4.983 Vali Acc: 0.540 Test Loss: 4.983 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.807753324508667
Epoch: 12, Steps: 18 | Train Loss: 0.629 Vali Loss: 6.342 Vali Acc: 0.590 Test Loss: 6.342 Test Acc: 0.590
Validation loss decreased (-0.559969 --> -0.589937).  Saving model ...
Epoch: 13 cost time: 4.179610013961792
Epoch: 13, Steps: 18 | Train Loss: 0.425 Vali Loss: 5.377 Vali Acc: 0.510 Test Loss: 5.377 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.695319414138794
Epoch: 14, Steps: 18 | Train Loss: 0.673 Vali Loss: 8.605 Vali Acc: 0.420 Test Loss: 8.605 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.280095815658569
Epoch: 15, Steps: 18 | Train Loss: 0.594 Vali Loss: 4.465 Vali Acc: 0.510 Test Loss: 4.465 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9058837890625
Epoch: 16, Steps: 18 | Train Loss: 0.536 Vali Loss: 5.982 Vali Acc: 0.550 Test Loss: 5.982 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.173754692077637
Epoch: 17, Steps: 18 | Train Loss: 0.075 Vali Loss: 6.661 Vali Acc: 0.530 Test Loss: 6.661 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.173331260681152
Epoch: 18, Steps: 18 | Train Loss: 0.381 Vali Loss: 6.021 Vali Acc: 0.550 Test Loss: 6.021 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.629385471343994
Epoch: 19, Steps: 18 | Train Loss: 0.627 Vali Loss: 16.504 Vali Acc: 0.470 Test Loss: 16.504 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.785492181777954
Epoch: 20, Steps: 18 | Train Loss: 0.835 Vali Loss: 9.830 Vali Acc: 0.570 Test Loss: 9.830 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.108127117156982
Epoch: 21, Steps: 18 | Train Loss: 0.502 Vali Loss: 11.299 Vali Acc: 0.540 Test Loss: 11.299 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.1419219970703125
Epoch: 22, Steps: 18 | Train Loss: 0.399 Vali Loss: 7.251 Vali Acc: 0.610 Test Loss: 7.251 Test Acc: 0.610
Validation loss decreased (-0.589937 --> -0.609927).  Saving model ...
Epoch: 23 cost time: 3.806082010269165
Epoch: 23, Steps: 18 | Train Loss: 0.162 Vali Loss: 11.800 Vali Acc: 0.560 Test Loss: 11.800 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.007929563522339
Epoch: 24, Steps: 18 | Train Loss: 0.293 Vali Loss: 15.118 Vali Acc: 0.430 Test Loss: 15.118 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.5391058921813965
Epoch: 25, Steps: 18 | Train Loss: 0.578 Vali Loss: 11.467 Vali Acc: 0.500 Test Loss: 11.467 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.434128761291504
Epoch: 26, Steps: 18 | Train Loss: 0.255 Vali Loss: 13.400 Vali Acc: 0.500 Test Loss: 13.400 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.868473768234253
Epoch: 27, Steps: 18 | Train Loss: 0.767 Vali Loss: 15.865 Vali Acc: 0.520 Test Loss: 15.865 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.130955696105957
Epoch: 28, Steps: 18 | Train Loss: 0.461 Vali Loss: 13.032 Vali Acc: 0.470 Test Loss: 13.032 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.655411720275879
Epoch: 29, Steps: 18 | Train Loss: 0.223 Vali Loss: 11.168 Vali Acc: 0.540 Test Loss: 11.168 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.937252998352051
Epoch: 30, Steps: 18 | Train Loss: 0.630 Vali Loss: 12.334 Vali Acc: 0.480 Test Loss: 12.334 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.4792580604553223
Epoch: 31, Steps: 18 | Train Loss: 0.215 Vali Loss: 24.578 Vali Acc: 0.470 Test Loss: 24.578 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.8168561458587646
Epoch: 32, Steps: 18 | Train Loss: 0.147 Vali Loss: 15.493 Vali Acc: 0.420 Test Loss: 15.493 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 12742018
model size : 48.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.409600019454956
Epoch: 1, Steps: 18 | Train Loss: 0.954 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.8107309341430664
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 1.8754606246948242
Epoch: 3, Steps: 18 | Train Loss: 0.524 Vali Loss: 1.836 Vali Acc: 0.530 Test Loss: 1.836 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9155845642089844
Epoch: 4, Steps: 18 | Train Loss: 0.401 Vali Loss: 2.764 Vali Acc: 0.530 Test Loss: 2.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.138098955154419
Epoch: 5, Steps: 18 | Train Loss: 0.750 Vali Loss: 2.310 Vali Acc: 0.550 Test Loss: 2.310 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549977).  Saving model ...
Epoch: 6 cost time: 2.0083093643188477
Epoch: 6, Steps: 18 | Train Loss: 0.482 Vali Loss: 3.401 Vali Acc: 0.440 Test Loss: 3.401 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0364677906036377
Epoch: 7, Steps: 18 | Train Loss: 2.079 Vali Loss: 5.517 Vali Acc: 0.550 Test Loss: 5.517 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9710731506347656
Epoch: 8, Steps: 18 | Train Loss: 1.665 Vali Loss: 3.343 Vali Acc: 0.470 Test Loss: 3.343 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9455199241638184
Epoch: 9, Steps: 18 | Train Loss: 0.713 Vali Loss: 4.247 Vali Acc: 0.490 Test Loss: 4.247 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9782609939575195
Epoch: 10, Steps: 18 | Train Loss: 1.103 Vali Loss: 5.826 Vali Acc: 0.530 Test Loss: 5.826 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.390345811843872
Epoch: 11, Steps: 18 | Train Loss: 1.023 Vali Loss: 7.715 Vali Acc: 0.480 Test Loss: 7.715 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.173168659210205
Epoch: 12, Steps: 18 | Train Loss: 0.996 Vali Loss: 7.006 Vali Acc: 0.530 Test Loss: 7.006 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.087759494781494
Epoch: 13, Steps: 18 | Train Loss: 1.577 Vali Loss: 5.742 Vali Acc: 0.650 Test Loss: 5.742 Test Acc: 0.650
Validation loss decreased (-0.549977 --> -0.649943).  Saving model ...
Epoch: 14 cost time: 1.930069923400879
Epoch: 14, Steps: 18 | Train Loss: 1.055 Vali Loss: 5.543 Vali Acc: 0.560 Test Loss: 5.543 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.06830096244812
Epoch: 15, Steps: 18 | Train Loss: 0.730 Vali Loss: 5.727 Vali Acc: 0.580 Test Loss: 5.727 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9233286380767822
Epoch: 16, Steps: 18 | Train Loss: 0.435 Vali Loss: 7.587 Vali Acc: 0.500 Test Loss: 7.587 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1113016605377197
Epoch: 17, Steps: 18 | Train Loss: 0.647 Vali Loss: 7.853 Vali Acc: 0.520 Test Loss: 7.853 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.237858533859253
Epoch: 18, Steps: 18 | Train Loss: 1.482 Vali Loss: 6.829 Vali Acc: 0.490 Test Loss: 6.829 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8052542209625244
Epoch: 19, Steps: 18 | Train Loss: 2.534 Vali Loss: 6.069 Vali Acc: 0.480 Test Loss: 6.069 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5596890449523926
Epoch: 20, Steps: 18 | Train Loss: 1.574 Vali Loss: 15.079 Vali Acc: 0.430 Test Loss: 15.079 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4827187061309814
Epoch: 21, Steps: 18 | Train Loss: 1.190 Vali Loss: 11.912 Vali Acc: 0.530 Test Loss: 11.912 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7566065788269043
Epoch: 22, Steps: 18 | Train Loss: 2.493 Vali Loss: 7.879 Vali Acc: 0.510 Test Loss: 7.879 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2232296466827393
Epoch: 23, Steps: 18 | Train Loss: 1.385 Vali Loss: 8.486 Vali Acc: 0.490 Test Loss: 8.486 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 12682626
model size : 48.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 35.475115060806274
Epoch: 1, Steps: 18 | Train Loss: 0.937 Vali Loss: 1.044 Vali Acc: 0.420 Test Loss: 1.044 Test Acc: 0.420
Validation loss decreased (inf --> -0.419990).  Saving model ...
Epoch: 2 cost time: 30.787242889404297
Epoch: 2, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.078 Vali Acc: 0.510 Test Loss: 1.078 Test Acc: 0.510
Validation loss decreased (-0.419990 --> -0.509989).  Saving model ...
Epoch: 3 cost time: 37.604384899139404
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 1.498 Vali Acc: 0.510 Test Loss: 1.498 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 38.791144371032715
Epoch: 4, Steps: 18 | Train Loss: 0.564 Vali Loss: 2.402 Vali Acc: 0.550 Test Loss: 2.402 Test Acc: 0.550
Validation loss decreased (-0.509989 --> -0.549976).  Saving model ...
Epoch: 5 cost time: 34.641273021698
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 3.701 Vali Acc: 0.530 Test Loss: 3.701 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 31.05151677131653
Epoch: 6, Steps: 18 | Train Loss: 0.374 Vali Loss: 4.638 Vali Acc: 0.490 Test Loss: 4.638 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 36.3224515914917
Epoch: 7, Steps: 18 | Train Loss: 0.804 Vali Loss: 2.010 Vali Acc: 0.520 Test Loss: 2.010 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 35.63297414779663
Epoch: 8, Steps: 18 | Train Loss: 0.795 Vali Loss: 3.774 Vali Acc: 0.480 Test Loss: 3.774 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.75934410095215
Epoch: 9, Steps: 18 | Train Loss: 0.892 Vali Loss: 2.883 Vali Acc: 0.510 Test Loss: 2.883 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 33.75940251350403
Epoch: 10, Steps: 18 | Train Loss: 1.054 Vali Loss: 5.694 Vali Acc: 0.560 Test Loss: 5.694 Test Acc: 0.560
Validation loss decreased (-0.549976 --> -0.559943).  Saving model ...
Epoch: 11 cost time: 31.62776255607605
Epoch: 11, Steps: 18 | Train Loss: 1.314 Vali Loss: 3.300 Vali Acc: 0.490 Test Loss: 3.300 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.19717812538147
Epoch: 12, Steps: 18 | Train Loss: 0.601 Vali Loss: 3.750 Vali Acc: 0.540 Test Loss: 3.750 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 29.2077054977417
Epoch: 13, Steps: 18 | Train Loss: 0.521 Vali Loss: 5.471 Vali Acc: 0.540 Test Loss: 5.471 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 30.99184489250183
Epoch: 14, Steps: 18 | Train Loss: 0.620 Vali Loss: 5.411 Vali Acc: 0.470 Test Loss: 5.411 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.674625396728516
Epoch: 15, Steps: 18 | Train Loss: 0.513 Vali Loss: 4.801 Vali Acc: 0.580 Test Loss: 4.801 Test Acc: 0.580
Validation loss decreased (-0.559943 --> -0.579952).  Saving model ...
Epoch: 16 cost time: 27.055598974227905
Epoch: 16, Steps: 18 | Train Loss: 0.183 Vali Loss: 8.870 Vali Acc: 0.510 Test Loss: 8.870 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 29.03236198425293
Epoch: 17, Steps: 18 | Train Loss: 1.705 Vali Loss: 5.418 Vali Acc: 0.520 Test Loss: 5.418 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 29.618526220321655
Epoch: 18, Steps: 18 | Train Loss: 0.486 Vali Loss: 6.634 Vali Acc: 0.520 Test Loss: 6.634 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 27.979124784469604
Epoch: 19, Steps: 18 | Train Loss: 0.474 Vali Loss: 6.446 Vali Acc: 0.570 Test Loss: 6.446 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 31.481597423553467
Epoch: 20, Steps: 18 | Train Loss: 0.941 Vali Loss: 10.647 Vali Acc: 0.530 Test Loss: 10.647 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 33.35018610954285
Epoch: 21, Steps: 18 | Train Loss: 0.460 Vali Loss: 6.416 Vali Acc: 0.560 Test Loss: 6.416 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 29.304813385009766
Epoch: 22, Steps: 18 | Train Loss: 0.815 Vali Loss: 10.829 Vali Acc: 0.510 Test Loss: 10.829 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 32.90169811248779
Epoch: 23, Steps: 18 | Train Loss: 0.229 Vali Loss: 7.514 Vali Acc: 0.520 Test Loss: 7.514 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 27.496976137161255
Epoch: 24, Steps: 18 | Train Loss: 0.136 Vali Loss: 10.422 Vali Acc: 0.440 Test Loss: 10.422 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 43.78726625442505
Epoch: 25, Steps: 18 | Train Loss: 0.856 Vali Loss: 11.667 Vali Acc: 0.520 Test Loss: 11.667 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 13447546
model size : 52.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.143893241882324
Epoch: 1, Steps: 18 | Train Loss: 0.842 Vali Loss: 1.061 Vali Acc: 0.460 Test Loss: 1.061 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 28.131458282470703
Epoch: 2, Steps: 18 | Train Loss: 1.047 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
Validation loss decreased (-0.459989 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 33.16731142997742
Epoch: 3, Steps: 18 | Train Loss: 0.892 Vali Loss: 3.202 Vali Acc: 0.490 Test Loss: 3.202 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.824533224105835
Epoch: 4, Steps: 18 | Train Loss: 0.550 Vali Loss: 1.603 Vali Acc: 0.490 Test Loss: 1.603 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.31773090362549
Epoch: 5, Steps: 18 | Train Loss: 0.628 Vali Loss: 3.480 Vali Acc: 0.550 Test Loss: 3.480 Test Acc: 0.550
Validation loss decreased (-0.519990 --> -0.549965).  Saving model ...
Epoch: 6 cost time: 33.24947738647461
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 2.385 Vali Acc: 0.570 Test Loss: 2.385 Test Acc: 0.570
Validation loss decreased (-0.549965 --> -0.569976).  Saving model ...
Epoch: 7 cost time: 28.501086235046387
Epoch: 7, Steps: 18 | Train Loss: 0.568 Vali Loss: 3.797 Vali Acc: 0.520 Test Loss: 3.797 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.974451541900635
Epoch: 8, Steps: 18 | Train Loss: 0.524 Vali Loss: 3.277 Vali Acc: 0.520 Test Loss: 3.277 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 30.301844358444214
Epoch: 9, Steps: 18 | Train Loss: 0.320 Vali Loss: 3.730 Vali Acc: 0.490 Test Loss: 3.730 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 28.25727891921997
Epoch: 10, Steps: 18 | Train Loss: 0.303 Vali Loss: 3.680 Vali Acc: 0.430 Test Loss: 3.680 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.082329750061035
Epoch: 11, Steps: 18 | Train Loss: 0.501 Vali Loss: 2.912 Vali Acc: 0.530 Test Loss: 2.912 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 26.749847888946533
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 5.216 Vali Acc: 0.480 Test Loss: 5.216 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 25.33851170539856
Epoch: 13, Steps: 18 | Train Loss: 0.396 Vali Loss: 4.807 Vali Acc: 0.610 Test Loss: 4.807 Test Acc: 0.610
Validation loss decreased (-0.569976 --> -0.609952).  Saving model ...
Epoch: 14 cost time: 28.89008331298828
Epoch: 14, Steps: 18 | Train Loss: 0.700 Vali Loss: 6.019 Vali Acc: 0.500 Test Loss: 6.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.842013835906982
Epoch: 15, Steps: 18 | Train Loss: 0.862 Vali Loss: 5.626 Vali Acc: 0.500 Test Loss: 5.626 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.19301438331604
Epoch: 16, Steps: 18 | Train Loss: 1.020 Vali Loss: 4.720 Vali Acc: 0.470 Test Loss: 4.720 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 27.58886194229126
Epoch: 17, Steps: 18 | Train Loss: 0.825 Vali Loss: 16.392 Vali Acc: 0.460 Test Loss: 16.392 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.175917625427246
Epoch: 18, Steps: 18 | Train Loss: 0.638 Vali Loss: 5.156 Vali Acc: 0.570 Test Loss: 5.156 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 25.111640691757202
Epoch: 19, Steps: 18 | Train Loss: 0.171 Vali Loss: 8.673 Vali Acc: 0.520 Test Loss: 8.673 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 22.18662118911743
Epoch: 20, Steps: 18 | Train Loss: 0.334 Vali Loss: 7.164 Vali Acc: 0.500 Test Loss: 7.164 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 22.613796949386597
Epoch: 21, Steps: 18 | Train Loss: 0.342 Vali Loss: 6.800 Vali Acc: 0.470 Test Loss: 6.800 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 25.071765184402466
Epoch: 22, Steps: 18 | Train Loss: 0.344 Vali Loss: 6.688 Vali Acc: 0.510 Test Loss: 6.688 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.40851879119873
Epoch: 23, Steps: 18 | Train Loss: 0.581 Vali Loss: 7.107 Vali Acc: 0.490 Test Loss: 7.107 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 13293946
model size : 51.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.562963008880615
Epoch: 1, Steps: 18 | Train Loss: 0.999 Vali Loss: 0.855 Vali Acc: 0.610 Test Loss: 0.855 Test Acc: 0.610
Validation loss decreased (inf --> -0.609991).  Saving model ...
Epoch: 2 cost time: 20.828428268432617
Epoch: 2, Steps: 18 | Train Loss: 1.014 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.30342721939087
Epoch: 3, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.291 Vali Acc: 0.510 Test Loss: 1.291 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.077290296554565
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.531 Vali Acc: 0.530 Test Loss: 1.531 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.774726152420044
Epoch: 5, Steps: 18 | Train Loss: 0.591 Vali Loss: 1.588 Vali Acc: 0.480 Test Loss: 1.588 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.43900156021118
Epoch: 6, Steps: 18 | Train Loss: 0.444 Vali Loss: 2.295 Vali Acc: 0.460 Test Loss: 2.295 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.29931950569153
Epoch: 7, Steps: 18 | Train Loss: 0.939 Vali Loss: 3.344 Vali Acc: 0.510 Test Loss: 3.344 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.339678049087524
Epoch: 8, Steps: 18 | Train Loss: 0.567 Vali Loss: 3.787 Vali Acc: 0.520 Test Loss: 3.787 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.346391677856445
Epoch: 9, Steps: 18 | Train Loss: 1.399 Vali Loss: 3.290 Vali Acc: 0.540 Test Loss: 3.290 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.943252086639404
Epoch: 10, Steps: 18 | Train Loss: 0.966 Vali Loss: 3.679 Vali Acc: 0.510 Test Loss: 3.679 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 20.57830810546875
Epoch: 11, Steps: 18 | Train Loss: 0.622 Vali Loss: 3.892 Vali Acc: 0.530 Test Loss: 3.892 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 13140346
model size : 50.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.030664682388306
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 12.655513763427734
Epoch: 2, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.110 Vali Acc: 0.620 Test Loss: 1.110 Test Acc: 0.620
Validation loss decreased (-0.469991 --> -0.619989).  Saving model ...
Epoch: 3 cost time: 14.100629568099976
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 1.940 Vali Acc: 0.570 Test Loss: 1.940 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.859747648239136
Epoch: 4, Steps: 18 | Train Loss: 0.519 Vali Loss: 3.323 Vali Acc: 0.500 Test Loss: 3.323 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.82042384147644
Epoch: 5, Steps: 18 | Train Loss: 1.018 Vali Loss: 3.612 Vali Acc: 0.490 Test Loss: 3.612 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.461692571640015
Epoch: 6, Steps: 18 | Train Loss: 0.649 Vali Loss: 2.846 Vali Acc: 0.530 Test Loss: 2.846 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.31868600845337
Epoch: 7, Steps: 18 | Train Loss: 0.898 Vali Loss: 2.256 Vali Acc: 0.510 Test Loss: 2.256 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.329188585281372
Epoch: 8, Steps: 18 | Train Loss: 0.754 Vali Loss: 5.015 Vali Acc: 0.520 Test Loss: 5.015 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.100029945373535
Epoch: 9, Steps: 18 | Train Loss: 0.623 Vali Loss: 4.917 Vali Acc: 0.530 Test Loss: 4.917 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.25377345085144
Epoch: 10, Steps: 18 | Train Loss: 0.286 Vali Loss: 3.657 Vali Acc: 0.550 Test Loss: 3.657 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.873248815536499
Epoch: 11, Steps: 18 | Train Loss: 0.632 Vali Loss: 5.356 Vali Acc: 0.480 Test Loss: 5.356 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.802541732788086
Epoch: 12, Steps: 18 | Train Loss: 1.702 Vali Loss: 8.535 Vali Acc: 0.570 Test Loss: 8.535 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 12986746
model size : 50.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.535558700561523
Epoch: 1, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.288 Vali Acc: 0.540 Test Loss: 1.288 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 9.283859729766846
Epoch: 2, Steps: 18 | Train Loss: 0.775 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.00186824798584
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.838 Vali Acc: 0.490 Test Loss: 1.838 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.030516862869263
Epoch: 4, Steps: 18 | Train Loss: 0.613 Vali Loss: 1.498 Vali Acc: 0.550 Test Loss: 1.498 Test Acc: 0.550
Validation loss decreased (-0.539987 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 10.240017890930176
Epoch: 5, Steps: 18 | Train Loss: 0.759 Vali Loss: 2.396 Vali Acc: 0.490 Test Loss: 2.396 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.697323322296143
Epoch: 6, Steps: 18 | Train Loss: 0.953 Vali Loss: 4.437 Vali Acc: 0.500 Test Loss: 4.437 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.501426696777344
Epoch: 7, Steps: 18 | Train Loss: 0.496 Vali Loss: 3.260 Vali Acc: 0.480 Test Loss: 3.260 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.5118248462677
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 2.997 Vali Acc: 0.560 Test Loss: 2.997 Test Acc: 0.560
Validation loss decreased (-0.549985 --> -0.559970).  Saving model ...
Epoch: 9 cost time: 9.300332069396973
Epoch: 9, Steps: 18 | Train Loss: 0.567 Vali Loss: 5.448 Vali Acc: 0.560 Test Loss: 5.448 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.967920303344727
Epoch: 10, Steps: 18 | Train Loss: 0.756 Vali Loss: 4.534 Vali Acc: 0.520 Test Loss: 4.534 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.572997570037842
Epoch: 11, Steps: 18 | Train Loss: 0.780 Vali Loss: 5.243 Vali Acc: 0.550 Test Loss: 5.243 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.51475191116333
Epoch: 12, Steps: 18 | Train Loss: 0.656 Vali Loss: 6.178 Vali Acc: 0.520 Test Loss: 6.178 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.97545599937439
Epoch: 13, Steps: 18 | Train Loss: 0.390 Vali Loss: 4.153 Vali Acc: 0.560 Test Loss: 4.153 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.428502321243286
Epoch: 14, Steps: 18 | Train Loss: 0.368 Vali Loss: 7.120 Vali Acc: 0.540 Test Loss: 7.120 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.115165710449219
Epoch: 15, Steps: 18 | Train Loss: 0.693 Vali Loss: 5.866 Vali Acc: 0.510 Test Loss: 5.866 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.008963823318481
Epoch: 16, Steps: 18 | Train Loss: 0.609 Vali Loss: 9.143 Vali Acc: 0.520 Test Loss: 9.143 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.237643003463745
Epoch: 17, Steps: 18 | Train Loss: 1.027 Vali Loss: 12.321 Vali Acc: 0.490 Test Loss: 12.321 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.687818765640259
Epoch: 18, Steps: 18 | Train Loss: 1.413 Vali Loss: 7.389 Vali Acc: 0.520 Test Loss: 7.389 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 12863866
model size : 49.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.594198942184448
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.851 Vali Acc: 0.600 Test Loss: 0.851 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 6.707878828048706
Epoch: 2, Steps: 18 | Train Loss: 0.792 Vali Loss: 3.110 Vali Acc: 0.510 Test Loss: 3.110 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.500782012939453
Epoch: 3, Steps: 18 | Train Loss: 0.669 Vali Loss: 2.533 Vali Acc: 0.550 Test Loss: 2.533 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.975491762161255
Epoch: 4, Steps: 18 | Train Loss: 0.806 Vali Loss: 3.641 Vali Acc: 0.510 Test Loss: 3.641 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.662461757659912
Epoch: 5, Steps: 18 | Train Loss: 0.483 Vali Loss: 3.628 Vali Acc: 0.480 Test Loss: 3.628 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.012854099273682
Epoch: 6, Steps: 18 | Train Loss: 0.950 Vali Loss: 2.545 Vali Acc: 0.510 Test Loss: 2.545 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.5344557762146
Epoch: 7, Steps: 18 | Train Loss: 0.833 Vali Loss: 2.413 Vali Acc: 0.530 Test Loss: 2.413 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.755895376205444
Epoch: 8, Steps: 18 | Train Loss: 0.305 Vali Loss: 2.556 Vali Acc: 0.580 Test Loss: 2.556 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.940926551818848
Epoch: 9, Steps: 18 | Train Loss: 0.854 Vali Loss: 5.912 Vali Acc: 0.530 Test Loss: 5.912 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.875849485397339
Epoch: 10, Steps: 18 | Train Loss: 1.255 Vali Loss: 6.766 Vali Acc: 0.480 Test Loss: 6.766 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.2739832401275635
Epoch: 11, Steps: 18 | Train Loss: 1.522 Vali Loss: 4.891 Vali Acc: 0.500 Test Loss: 4.891 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 12802426
model size : 49.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.025250673294067
Epoch: 1, Steps: 18 | Train Loss: 0.941 Vali Loss: 0.918 Vali Acc: 0.610 Test Loss: 0.918 Test Acc: 0.610
Validation loss decreased (inf --> -0.609991).  Saving model ...
Epoch: 2 cost time: 4.269854307174683
Epoch: 2, Steps: 18 | Train Loss: 1.011 Vali Loss: 1.541 Vali Acc: 0.510 Test Loss: 1.541 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.558622360229492
Epoch: 3, Steps: 18 | Train Loss: 0.992 Vali Loss: 1.605 Vali Acc: 0.570 Test Loss: 1.605 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.289958953857422
Epoch: 4, Steps: 18 | Train Loss: 0.795 Vali Loss: 2.382 Vali Acc: 0.530 Test Loss: 2.382 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9806954860687256
Epoch: 5, Steps: 18 | Train Loss: 0.639 Vali Loss: 2.506 Vali Acc: 0.490 Test Loss: 2.506 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.118545293807983
Epoch: 6, Steps: 18 | Train Loss: 0.721 Vali Loss: 2.438 Vali Acc: 0.530 Test Loss: 2.438 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.388641357421875
Epoch: 7, Steps: 18 | Train Loss: 0.497 Vali Loss: 3.626 Vali Acc: 0.470 Test Loss: 3.626 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6964364051818848
Epoch: 8, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.778 Vali Acc: 0.470 Test Loss: 2.778 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6560604572296143
Epoch: 9, Steps: 18 | Train Loss: 0.390 Vali Loss: 4.129 Vali Acc: 0.530 Test Loss: 4.129 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.530913352966309
Epoch: 10, Steps: 18 | Train Loss: 1.165 Vali Loss: 4.048 Vali Acc: 0.520 Test Loss: 4.048 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.686013698577881
Epoch: 11, Steps: 18 | Train Loss: 0.730 Vali Loss: 6.216 Vali Acc: 0.520 Test Loss: 6.216 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 12740986
model size : 48.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.195175886154175
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 0.912 Vali Acc: 0.580 Test Loss: 0.912 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 2.185107946395874
Epoch: 2, Steps: 18 | Train Loss: 1.066 Vali Loss: 1.285 Vali Acc: 0.480 Test Loss: 1.285 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.162952184677124
Epoch: 3, Steps: 18 | Train Loss: 1.052 Vali Loss: 2.507 Vali Acc: 0.500 Test Loss: 2.507 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.284072160720825
Epoch: 4, Steps: 18 | Train Loss: 0.729 Vali Loss: 2.930 Vali Acc: 0.550 Test Loss: 2.930 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1741726398468018
Epoch: 5, Steps: 18 | Train Loss: 0.520 Vali Loss: 1.835 Vali Acc: 0.550 Test Loss: 1.835 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.379570960998535
Epoch: 6, Steps: 18 | Train Loss: 0.475 Vali Loss: 2.055 Vali Acc: 0.490 Test Loss: 2.055 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.401885747909546
Epoch: 7, Steps: 18 | Train Loss: 0.444 Vali Loss: 3.195 Vali Acc: 0.470 Test Loss: 3.195 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1287789344787598
Epoch: 8, Steps: 18 | Train Loss: 1.150 Vali Loss: 3.753 Vali Acc: 0.580 Test Loss: 3.753 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2590231895446777
Epoch: 9, Steps: 18 | Train Loss: 2.214 Vali Loss: 5.884 Vali Acc: 0.520 Test Loss: 5.884 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.006286144256592
Epoch: 10, Steps: 18 | Train Loss: 0.588 Vali Loss: 3.998 Vali Acc: 0.490 Test Loss: 3.998 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.096461296081543
Epoch: 11, Steps: 18 | Train Loss: 0.728 Vali Loss: 4.090 Vali Acc: 0.510 Test Loss: 4.090 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12681594
model size : 48.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.1302125453949
Epoch: 1, Steps: 18 | Train Loss: 0.887 Vali Loss: 1.063 Vali Acc: 0.490 Test Loss: 1.063 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 30.47935700416565
Epoch: 2, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.177 Vali Acc: 0.480 Test Loss: 1.177 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.132580518722534
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 2.706 Vali Acc: 0.530 Test Loss: 2.706 Test Acc: 0.530
Validation loss decreased (-0.489989 --> -0.529973).  Saving model ...
Epoch: 4 cost time: 29.977800369262695
Epoch: 4, Steps: 18 | Train Loss: 1.234 Vali Loss: 1.156 Vali Acc: 0.480 Test Loss: 1.156 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.04746961593628
Epoch: 5, Steps: 18 | Train Loss: 0.672 Vali Loss: 2.260 Vali Acc: 0.550 Test Loss: 2.260 Test Acc: 0.550
Validation loss decreased (-0.529973 --> -0.549977).  Saving model ...
Epoch: 6 cost time: 32.48214530944824
Epoch: 6, Steps: 18 | Train Loss: 0.825 Vali Loss: 2.543 Vali Acc: 0.460 Test Loss: 2.543 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 38.98416876792908
Epoch: 7, Steps: 18 | Train Loss: 0.805 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 37.1986083984375
Epoch: 8, Steps: 18 | Train Loss: 1.146 Vali Loss: 3.937 Vali Acc: 0.530 Test Loss: 3.937 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 37.51496982574463
Epoch: 9, Steps: 18 | Train Loss: 0.598 Vali Loss: 2.864 Vali Acc: 0.480 Test Loss: 2.864 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 37.68700981140137
Epoch: 10, Steps: 18 | Train Loss: 0.485 Vali Loss: 3.017 Vali Acc: 0.580 Test Loss: 3.017 Test Acc: 0.580
Validation loss decreased (-0.549977 --> -0.579970).  Saving model ...
Epoch: 11 cost time: 32.24262046813965
Epoch: 11, Steps: 18 | Train Loss: 0.506 Vali Loss: 4.084 Vali Acc: 0.500 Test Loss: 4.084 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 41.44803524017334
Epoch: 12, Steps: 18 | Train Loss: 0.330 Vali Loss: 2.948 Vali Acc: 0.560 Test Loss: 2.948 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 41.49115824699402
Epoch: 13, Steps: 18 | Train Loss: 0.517 Vali Loss: 6.037 Vali Acc: 0.540 Test Loss: 6.037 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 31.987223625183105
Epoch: 14, Steps: 18 | Train Loss: 0.411 Vali Loss: 5.517 Vali Acc: 0.530 Test Loss: 5.517 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 36.73379564285278
Epoch: 15, Steps: 18 | Train Loss: 0.529 Vali Loss: 5.307 Vali Acc: 0.530 Test Loss: 5.307 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 33.14777684211731
Epoch: 16, Steps: 18 | Train Loss: 0.530 Vali Loss: 10.364 Vali Acc: 0.460 Test Loss: 10.364 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 33.4894061088562
Epoch: 17, Steps: 18 | Train Loss: 0.603 Vali Loss: 6.526 Vali Acc: 0.500 Test Loss: 6.526 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 30.142181634902954
Epoch: 18, Steps: 18 | Train Loss: 0.417 Vali Loss: 7.239 Vali Acc: 0.490 Test Loss: 7.239 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 28.572168350219727
Epoch: 19, Steps: 18 | Train Loss: 0.954 Vali Loss: 7.597 Vali Acc: 0.410 Test Loss: 7.597 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 30.72413158416748
Epoch: 20, Steps: 18 | Train Loss: 0.284 Vali Loss: 7.125 Vali Acc: 0.380 Test Loss: 7.125 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 13447030
model size : 52.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.948792695999146
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 0.797 Vali Acc: 0.630 Test Loss: 0.797 Test Acc: 0.630
Validation loss decreased (inf --> -0.629992).  Saving model ...
Epoch: 2 cost time: 28.006059885025024
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 1.105 Vali Acc: 0.460 Test Loss: 1.105 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.358981609344482
Epoch: 3, Steps: 18 | Train Loss: 0.904 Vali Loss: 1.702 Vali Acc: 0.590 Test Loss: 1.702 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.1026873588562
Epoch: 4, Steps: 18 | Train Loss: 0.717 Vali Loss: 2.309 Vali Acc: 0.480 Test Loss: 2.309 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.585464239120483
Epoch: 5, Steps: 18 | Train Loss: 0.798 Vali Loss: 1.944 Vali Acc: 0.580 Test Loss: 1.944 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 28.15919780731201
Epoch: 6, Steps: 18 | Train Loss: 0.736 Vali Loss: 3.069 Vali Acc: 0.440 Test Loss: 3.069 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 26.30997323989868
Epoch: 7, Steps: 18 | Train Loss: 0.645 Vali Loss: 2.240 Vali Acc: 0.620 Test Loss: 2.240 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 26.04909038543701
Epoch: 8, Steps: 18 | Train Loss: 0.795 Vali Loss: 2.512 Vali Acc: 0.470 Test Loss: 2.512 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 28.703067779541016
Epoch: 9, Steps: 18 | Train Loss: 0.731 Vali Loss: 2.580 Vali Acc: 0.550 Test Loss: 2.580 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 28.55598735809326
Epoch: 10, Steps: 18 | Train Loss: 0.824 Vali Loss: 5.157 Vali Acc: 0.430 Test Loss: 5.157 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 26.59256887435913
Epoch: 11, Steps: 18 | Train Loss: 0.561 Vali Loss: 4.098 Vali Acc: 0.500 Test Loss: 4.098 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 13293430
model size : 51.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.9775390625
Epoch: 1, Steps: 18 | Train Loss: 0.938 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 21.65704035758972
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.524 Vali Acc: 0.460 Test Loss: 1.524 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.58563208580017
Epoch: 3, Steps: 18 | Train Loss: 0.556 Vali Loss: 1.087 Vali Acc: 0.540 Test Loss: 1.087 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.52246403694153
Epoch: 4, Steps: 18 | Train Loss: 1.036 Vali Loss: 1.308 Vali Acc: 0.510 Test Loss: 1.308 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.113638639450073
Epoch: 5, Steps: 18 | Train Loss: 0.606 Vali Loss: 3.528 Vali Acc: 0.490 Test Loss: 3.528 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.553982973098755
Epoch: 6, Steps: 18 | Train Loss: 0.502 Vali Loss: 2.562 Vali Acc: 0.510 Test Loss: 2.562 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.859644889831543
Epoch: 7, Steps: 18 | Train Loss: 0.546 Vali Loss: 2.584 Vali Acc: 0.570 Test Loss: 2.584 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569974).  Saving model ...
Epoch: 8 cost time: 21.160030841827393
Epoch: 8, Steps: 18 | Train Loss: 0.479 Vali Loss: 4.667 Vali Acc: 0.510 Test Loss: 4.667 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.30881428718567
Epoch: 9, Steps: 18 | Train Loss: 0.241 Vali Loss: 3.436 Vali Acc: 0.490 Test Loss: 3.436 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.942923545837402
Epoch: 10, Steps: 18 | Train Loss: 0.640 Vali Loss: 4.058 Vali Acc: 0.450 Test Loss: 4.058 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.331016540527344
Epoch: 11, Steps: 18 | Train Loss: 0.822 Vali Loss: 3.656 Vali Acc: 0.570 Test Loss: 3.656 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.717912912368774
Epoch: 12, Steps: 18 | Train Loss: 0.562 Vali Loss: 5.037 Vali Acc: 0.500 Test Loss: 5.037 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.212746143341064
Epoch: 13, Steps: 18 | Train Loss: 0.275 Vali Loss: 4.300 Vali Acc: 0.520 Test Loss: 4.300 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.95402216911316
Epoch: 14, Steps: 18 | Train Loss: 0.699 Vali Loss: 4.475 Vali Acc: 0.530 Test Loss: 4.475 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 24.41097378730774
Epoch: 15, Steps: 18 | Train Loss: 0.386 Vali Loss: 5.268 Vali Acc: 0.510 Test Loss: 5.268 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 23.970696449279785
Epoch: 16, Steps: 18 | Train Loss: 0.308 Vali Loss: 5.450 Vali Acc: 0.500 Test Loss: 5.450 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 17.165290355682373
Epoch: 17, Steps: 18 | Train Loss: 0.533 Vali Loss: 6.512 Vali Acc: 0.470 Test Loss: 6.512 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 13139830
model size : 50.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.869982719421387
Epoch: 1, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 17.076656818389893
Epoch: 2, Steps: 18 | Train Loss: 0.812 Vali Loss: 2.087 Vali Acc: 0.590 Test Loss: 2.087 Test Acc: 0.590
Validation loss decreased (-0.519989 --> -0.589979).  Saving model ...
Epoch: 3 cost time: 13.945810079574585
Epoch: 3, Steps: 18 | Train Loss: 0.785 Vali Loss: 1.089 Vali Acc: 0.530 Test Loss: 1.089 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.444276332855225
Epoch: 4, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.686 Vali Acc: 0.470 Test Loss: 1.686 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.181042432785034
Epoch: 5, Steps: 18 | Train Loss: 0.484 Vali Loss: 3.044 Vali Acc: 0.510 Test Loss: 3.044 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.078521251678467
Epoch: 6, Steps: 18 | Train Loss: 0.696 Vali Loss: 2.891 Vali Acc: 0.500 Test Loss: 2.891 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.46466875076294
Epoch: 7, Steps: 18 | Train Loss: 1.665 Vali Loss: 5.624 Vali Acc: 0.510 Test Loss: 5.624 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.54452657699585
Epoch: 8, Steps: 18 | Train Loss: 1.083 Vali Loss: 3.840 Vali Acc: 0.490 Test Loss: 3.840 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.480254888534546
Epoch: 9, Steps: 18 | Train Loss: 0.758 Vali Loss: 3.598 Vali Acc: 0.470 Test Loss: 3.598 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.242663860321045
Epoch: 10, Steps: 18 | Train Loss: 0.419 Vali Loss: 3.640 Vali Acc: 0.530 Test Loss: 3.640 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.041236639022827
Epoch: 11, Steps: 18 | Train Loss: 0.455 Vali Loss: 3.969 Vali Acc: 0.500 Test Loss: 3.969 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.561322450637817
Epoch: 12, Steps: 18 | Train Loss: 0.435 Vali Loss: 4.406 Vali Acc: 0.550 Test Loss: 4.406 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 12986230
model size : 50.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.21804666519165
Epoch: 1, Steps: 18 | Train Loss: 0.936 Vali Loss: 1.232 Vali Acc: 0.450 Test Loss: 1.232 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 8.214795112609863
Epoch: 2, Steps: 18 | Train Loss: 0.982 Vali Loss: 1.766 Vali Acc: 0.530 Test Loss: 1.766 Test Acc: 0.530
Validation loss decreased (-0.449988 --> -0.529982).  Saving model ...
Epoch: 3 cost time: 9.464345693588257
Epoch: 3, Steps: 18 | Train Loss: 0.973 Vali Loss: 1.269 Vali Acc: 0.580 Test Loss: 1.269 Test Acc: 0.580
Validation loss decreased (-0.529982 --> -0.579987).  Saving model ...
Epoch: 4 cost time: 8.946475505828857
Epoch: 4, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.717 Vali Acc: 0.630 Test Loss: 1.717 Test Acc: 0.630
Validation loss decreased (-0.579987 --> -0.629983).  Saving model ...
Epoch: 5 cost time: 9.550485610961914
Epoch: 5, Steps: 18 | Train Loss: 0.702 Vali Loss: 4.457 Vali Acc: 0.500 Test Loss: 4.457 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.331954002380371
Epoch: 6, Steps: 18 | Train Loss: 0.748 Vali Loss: 3.905 Vali Acc: 0.510 Test Loss: 3.905 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.29535961151123
Epoch: 7, Steps: 18 | Train Loss: 0.770 Vali Loss: 3.244 Vali Acc: 0.560 Test Loss: 3.244 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.515859127044678
Epoch: 8, Steps: 18 | Train Loss: 0.747 Vali Loss: 2.600 Vali Acc: 0.510 Test Loss: 2.600 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.035777807235718
Epoch: 9, Steps: 18 | Train Loss: 0.456 Vali Loss: 2.664 Vali Acc: 0.560 Test Loss: 2.664 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.16251015663147
Epoch: 10, Steps: 18 | Train Loss: 0.912 Vali Loss: 6.520 Vali Acc: 0.480 Test Loss: 6.520 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.624737739562988
Epoch: 11, Steps: 18 | Train Loss: 1.100 Vali Loss: 4.994 Vali Acc: 0.530 Test Loss: 4.994 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.467902183532715
Epoch: 12, Steps: 18 | Train Loss: 0.406 Vali Loss: 4.748 Vali Acc: 0.570 Test Loss: 4.748 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.548640489578247
Epoch: 13, Steps: 18 | Train Loss: 0.701 Vali Loss: 7.874 Vali Acc: 0.550 Test Loss: 7.874 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.907939672470093
Epoch: 14, Steps: 18 | Train Loss: 0.778 Vali Loss: 12.247 Vali Acc: 0.460 Test Loss: 12.247 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 12863350
model size : 49.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.796566009521484
Epoch: 1, Steps: 18 | Train Loss: 0.865 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 9.080307245254517
Epoch: 2, Steps: 18 | Train Loss: 0.878 Vali Loss: 1.002 Vali Acc: 0.460 Test Loss: 1.002 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.691413640975952
Epoch: 3, Steps: 18 | Train Loss: 0.715 Vali Loss: 1.341 Vali Acc: 0.490 Test Loss: 1.341 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.383607387542725
Epoch: 4, Steps: 18 | Train Loss: 0.854 Vali Loss: 2.273 Vali Acc: 0.510 Test Loss: 2.273 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509977).  Saving model ...
Epoch: 5 cost time: 5.115357398986816
Epoch: 5, Steps: 18 | Train Loss: 0.464 Vali Loss: 2.457 Vali Acc: 0.510 Test Loss: 2.457 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.346390008926392
Epoch: 6, Steps: 18 | Train Loss: 0.586 Vali Loss: 2.131 Vali Acc: 0.530 Test Loss: 2.131 Test Acc: 0.530
Validation loss decreased (-0.509977 --> -0.529979).  Saving model ...
Epoch: 7 cost time: 6.491490364074707
Epoch: 7, Steps: 18 | Train Loss: 0.568 Vali Loss: 3.653 Vali Acc: 0.520 Test Loss: 3.653 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.525663137435913
Epoch: 8, Steps: 18 | Train Loss: 0.546 Vali Loss: 5.488 Vali Acc: 0.530 Test Loss: 5.488 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.911917686462402
Epoch: 9, Steps: 18 | Train Loss: 0.653 Vali Loss: 4.586 Vali Acc: 0.540 Test Loss: 4.586 Test Acc: 0.540
Validation loss decreased (-0.529979 --> -0.539954).  Saving model ...
Epoch: 10 cost time: 6.77579665184021
Epoch: 10, Steps: 18 | Train Loss: 0.471 Vali Loss: 3.137 Vali Acc: 0.500 Test Loss: 3.137 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.292437791824341
Epoch: 11, Steps: 18 | Train Loss: 0.507 Vali Loss: 5.665 Vali Acc: 0.510 Test Loss: 5.665 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.527366876602173
Epoch: 12, Steps: 18 | Train Loss: 0.522 Vali Loss: 3.901 Vali Acc: 0.510 Test Loss: 3.901 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.322044849395752
Epoch: 13, Steps: 18 | Train Loss: 0.573 Vali Loss: 5.017 Vali Acc: 0.520 Test Loss: 5.017 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.7806854248046875
Epoch: 14, Steps: 18 | Train Loss: 0.516 Vali Loss: 4.986 Vali Acc: 0.550 Test Loss: 4.986 Test Acc: 0.550
Validation loss decreased (-0.539954 --> -0.549950).  Saving model ...
Epoch: 15 cost time: 6.24544358253479
Epoch: 15, Steps: 18 | Train Loss: 0.573 Vali Loss: 6.633 Vali Acc: 0.490 Test Loss: 6.633 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.668573379516602
Epoch: 16, Steps: 18 | Train Loss: 0.568 Vali Loss: 5.376 Vali Acc: 0.580 Test Loss: 5.376 Test Acc: 0.580
Validation loss decreased (-0.549950 --> -0.579946).  Saving model ...
Epoch: 17 cost time: 5.862653732299805
Epoch: 17, Steps: 18 | Train Loss: 0.306 Vali Loss: 7.843 Vali Acc: 0.490 Test Loss: 7.843 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.629622936248779
Epoch: 18, Steps: 18 | Train Loss: 0.517 Vali Loss: 8.320 Vali Acc: 0.490 Test Loss: 8.320 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.414259672164917
Epoch: 19, Steps: 18 | Train Loss: 0.668 Vali Loss: 12.069 Vali Acc: 0.510 Test Loss: 12.069 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.455206871032715
Epoch: 20, Steps: 18 | Train Loss: 0.478 Vali Loss: 11.143 Vali Acc: 0.470 Test Loss: 11.143 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.24374794960022
Epoch: 21, Steps: 18 | Train Loss: 0.520 Vali Loss: 9.050 Vali Acc: 0.530 Test Loss: 9.050 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.413074016571045
Epoch: 22, Steps: 18 | Train Loss: 0.686 Vali Loss: 8.498 Vali Acc: 0.510 Test Loss: 8.498 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.405311107635498
Epoch: 23, Steps: 18 | Train Loss: 0.733 Vali Loss: 9.140 Vali Acc: 0.520 Test Loss: 9.140 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.456983804702759
Epoch: 24, Steps: 18 | Train Loss: 0.398 Vali Loss: 12.225 Vali Acc: 0.500 Test Loss: 12.225 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.3845436573028564
Epoch: 25, Steps: 18 | Train Loss: 0.316 Vali Loss: 15.225 Vali Acc: 0.440 Test Loss: 15.225 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.508281469345093
Epoch: 26, Steps: 18 | Train Loss: 0.372 Vali Loss: 12.186 Vali Acc: 0.470 Test Loss: 12.186 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12801910
model size : 49.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.713247060775757
Epoch: 1, Steps: 18 | Train Loss: 0.903 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 4.224837779998779
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 2.418 Vali Acc: 0.500 Test Loss: 2.418 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086470603942871
Epoch: 3, Steps: 18 | Train Loss: 1.377 Vali Loss: 1.399 Vali Acc: 0.540 Test Loss: 1.399 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539986).  Saving model ...
Epoch: 4 cost time: 4.460856199264526
Epoch: 4, Steps: 18 | Train Loss: 0.777 Vali Loss: 2.382 Vali Acc: 0.530 Test Loss: 2.382 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.647797584533691
Epoch: 5, Steps: 18 | Train Loss: 0.723 Vali Loss: 1.932 Vali Acc: 0.530 Test Loss: 1.932 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.046945095062256
Epoch: 6, Steps: 18 | Train Loss: 0.698 Vali Loss: 2.705 Vali Acc: 0.520 Test Loss: 2.705 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.373211860656738
Epoch: 7, Steps: 18 | Train Loss: 0.833 Vali Loss: 4.902 Vali Acc: 0.520 Test Loss: 4.902 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.340212106704712
Epoch: 8, Steps: 18 | Train Loss: 1.227 Vali Loss: 3.051 Vali Acc: 0.470 Test Loss: 3.051 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.044991731643677
Epoch: 9, Steps: 18 | Train Loss: 0.963 Vali Loss: 5.199 Vali Acc: 0.480 Test Loss: 5.199 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.4994237422943115
Epoch: 10, Steps: 18 | Train Loss: 0.869 Vali Loss: 4.459 Vali Acc: 0.510 Test Loss: 4.459 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.6058735847473145
Epoch: 11, Steps: 18 | Train Loss: 0.548 Vali Loss: 2.641 Vali Acc: 0.620 Test Loss: 2.641 Test Acc: 0.620
Validation loss decreased (-0.539986 --> -0.619974).  Saving model ...
Epoch: 12 cost time: 4.839199542999268
Epoch: 12, Steps: 18 | Train Loss: 0.874 Vali Loss: 5.889 Vali Acc: 0.510 Test Loss: 5.889 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0037384033203125
Epoch: 13, Steps: 18 | Train Loss: 1.202 Vali Loss: 6.897 Vali Acc: 0.540 Test Loss: 6.897 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.086336374282837
Epoch: 14, Steps: 18 | Train Loss: 0.946 Vali Loss: 9.092 Vali Acc: 0.510 Test Loss: 9.092 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.068484544754028
Epoch: 15, Steps: 18 | Train Loss: 0.627 Vali Loss: 5.477 Vali Acc: 0.520 Test Loss: 5.477 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8839921951293945
Epoch: 16, Steps: 18 | Train Loss: 0.102 Vali Loss: 9.035 Vali Acc: 0.540 Test Loss: 9.035 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.145930290222168
Epoch: 17, Steps: 18 | Train Loss: 0.457 Vali Loss: 8.477 Vali Acc: 0.510 Test Loss: 8.477 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.870230197906494
Epoch: 18, Steps: 18 | Train Loss: 0.312 Vali Loss: 12.669 Vali Acc: 0.470 Test Loss: 12.669 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.537431716918945
Epoch: 19, Steps: 18 | Train Loss: 0.521 Vali Loss: 9.429 Vali Acc: 0.510 Test Loss: 9.429 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.542425155639648
Epoch: 20, Steps: 18 | Train Loss: 0.769 Vali Loss: 11.914 Vali Acc: 0.520 Test Loss: 11.914 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.138998031616211
Epoch: 21, Steps: 18 | Train Loss: 1.505 Vali Loss: 14.509 Vali Acc: 0.490 Test Loss: 14.509 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 12740470
model size : 48.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9775078296661377
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.8427181243896484
Epoch: 2, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.874 Vali Acc: 0.570 Test Loss: 0.874 Test Acc: 0.570
Validation loss decreased (-0.479992 --> -0.569991).  Saving model ...
Epoch: 3 cost time: 1.860809326171875
Epoch: 3, Steps: 18 | Train Loss: 1.123 Vali Loss: 1.768 Vali Acc: 0.600 Test Loss: 1.768 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599982).  Saving model ...
Epoch: 4 cost time: 2.1703436374664307
Epoch: 4, Steps: 18 | Train Loss: 0.865 Vali Loss: 3.499 Vali Acc: 0.510 Test Loss: 3.499 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2016165256500244
Epoch: 5, Steps: 18 | Train Loss: 0.771 Vali Loss: 3.241 Vali Acc: 0.510 Test Loss: 3.241 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.095846652984619
Epoch: 6, Steps: 18 | Train Loss: 0.862 Vali Loss: 1.869 Vali Acc: 0.570 Test Loss: 1.869 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.217498302459717
Epoch: 7, Steps: 18 | Train Loss: 0.649 Vali Loss: 4.219 Vali Acc: 0.440 Test Loss: 4.219 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.161635637283325
Epoch: 8, Steps: 18 | Train Loss: 1.150 Vali Loss: 3.507 Vali Acc: 0.570 Test Loss: 3.507 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.906574010848999
Epoch: 9, Steps: 18 | Train Loss: 1.066 Vali Loss: 5.686 Vali Acc: 0.460 Test Loss: 5.686 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9130394458770752
Epoch: 10, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.243 Vali Acc: 0.520 Test Loss: 3.243 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9802935123443604
Epoch: 11, Steps: 18 | Train Loss: 0.650 Vali Loss: 2.868 Vali Acc: 0.530 Test Loss: 2.868 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.234140157699585
Epoch: 12, Steps: 18 | Train Loss: 1.256 Vali Loss: 4.441 Vali Acc: 0.540 Test Loss: 4.441 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1448638439178467
Epoch: 13, Steps: 18 | Train Loss: 1.595 Vali Loss: 4.046 Vali Acc: 0.530 Test Loss: 4.046 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 12681078
model size : 48.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.072869062423706
Epoch: 1, Steps: 18 | Train Loss: 1.102 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 32.42625975608826
Epoch: 2, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.218 Vali Acc: 0.530 Test Loss: 1.218 Test Acc: 0.530
Validation loss decreased (-0.449987 --> -0.529988).  Saving model ...
Epoch: 3 cost time: 28.804754972457886
Epoch: 3, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.730 Vali Acc: 0.520 Test Loss: 1.730 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 39.78531742095947
Epoch: 4, Steps: 18 | Train Loss: 0.373 Vali Loss: 3.164 Vali Acc: 0.530 Test Loss: 3.164 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 41.84299397468567
Epoch: 5, Steps: 18 | Train Loss: 0.544 Vali Loss: 2.083 Vali Acc: 0.540 Test Loss: 2.083 Test Acc: 0.540
Validation loss decreased (-0.529988 --> -0.539979).  Saving model ...
Epoch: 6 cost time: 36.42329120635986
Epoch: 6, Steps: 18 | Train Loss: 0.577 Vali Loss: 3.363 Vali Acc: 0.570 Test Loss: 3.363 Test Acc: 0.570
Validation loss decreased (-0.539979 --> -0.569966).  Saving model ...
Epoch: 7 cost time: 34.66722226142883
Epoch: 7, Steps: 18 | Train Loss: 0.630 Vali Loss: 5.656 Vali Acc: 0.470 Test Loss: 5.656 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.42863893508911
Epoch: 8, Steps: 18 | Train Loss: 1.289 Vali Loss: 2.757 Vali Acc: 0.560 Test Loss: 2.757 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 39.789016008377075
Epoch: 9, Steps: 18 | Train Loss: 0.376 Vali Loss: 6.632 Vali Acc: 0.480 Test Loss: 6.632 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 37.52064538002014
Epoch: 10, Steps: 18 | Train Loss: 0.638 Vali Loss: 7.434 Vali Acc: 0.490 Test Loss: 7.434 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 38.248140811920166
Epoch: 11, Steps: 18 | Train Loss: 0.552 Vali Loss: 5.892 Vali Acc: 0.480 Test Loss: 5.892 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 40.59251666069031
Epoch: 12, Steps: 18 | Train Loss: 0.729 Vali Loss: 3.059 Vali Acc: 0.510 Test Loss: 3.059 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 35.905450105667114
Epoch: 13, Steps: 18 | Train Loss: 0.650 Vali Loss: 4.509 Vali Acc: 0.480 Test Loss: 4.509 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 42.14326000213623
Epoch: 14, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.224 Vali Acc: 0.550 Test Loss: 4.224 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 40.81814122200012
Epoch: 15, Steps: 18 | Train Loss: 0.456 Vali Loss: 4.115 Vali Acc: 0.540 Test Loss: 4.115 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 39.30502390861511
Epoch: 16, Steps: 18 | Train Loss: 0.554 Vali Loss: 4.855 Vali Acc: 0.520 Test Loss: 4.855 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 13446386
model size : 52.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.041303634643555
Epoch: 1, Steps: 18 | Train Loss: 0.903 Vali Loss: 1.413 Vali Acc: 0.530 Test Loss: 1.413 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 33.11598515510559
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 2.027 Vali Acc: 0.450 Test Loss: 2.027 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.96933627128601
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.665 Vali Acc: 0.560 Test Loss: 1.665 Test Acc: 0.560
Validation loss decreased (-0.529986 --> -0.559983).  Saving model ...
Epoch: 4 cost time: 29.118953466415405
Epoch: 4, Steps: 18 | Train Loss: 0.346 Vali Loss: 3.766 Vali Acc: 0.480 Test Loss: 3.766 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.714167833328247
Epoch: 5, Steps: 18 | Train Loss: 0.274 Vali Loss: 2.124 Vali Acc: 0.500 Test Loss: 2.124 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.383383989334106
Epoch: 6, Steps: 18 | Train Loss: 0.484 Vali Loss: 2.927 Vali Acc: 0.510 Test Loss: 2.927 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.586944341659546
Epoch: 7, Steps: 18 | Train Loss: 1.017 Vali Loss: 5.542 Vali Acc: 0.460 Test Loss: 5.542 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.681859016418457
Epoch: 8, Steps: 18 | Train Loss: 0.624 Vali Loss: 5.136 Vali Acc: 0.470 Test Loss: 5.136 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.878455638885498
Epoch: 9, Steps: 18 | Train Loss: 1.094 Vali Loss: 5.624 Vali Acc: 0.490 Test Loss: 5.624 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.654663562774658
Epoch: 10, Steps: 18 | Train Loss: 0.712 Vali Loss: 3.730 Vali Acc: 0.530 Test Loss: 3.730 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 27.009082555770874
Epoch: 11, Steps: 18 | Train Loss: 0.447 Vali Loss: 4.575 Vali Acc: 0.470 Test Loss: 4.575 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 27.111906051635742
Epoch: 12, Steps: 18 | Train Loss: 0.545 Vali Loss: 3.755 Vali Acc: 0.500 Test Loss: 3.755 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.573829174041748
Epoch: 13, Steps: 18 | Train Loss: 0.433 Vali Loss: 4.690 Vali Acc: 0.530 Test Loss: 4.690 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 13292786
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.08263850212097
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.004 Vali Acc: 0.480 Test Loss: 1.004 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 18.727408170700073
Epoch: 2, Steps: 18 | Train Loss: 0.568 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
Validation loss decreased (-0.479990 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 19.760006427764893
Epoch: 3, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.823448657989502
Epoch: 4, Steps: 18 | Train Loss: 0.709 Vali Loss: 2.297 Vali Acc: 0.590 Test Loss: 2.297 Test Acc: 0.590
Validation loss decreased (-0.549988 --> -0.589977).  Saving model ...
Epoch: 5 cost time: 20.39756751060486
Epoch: 5, Steps: 18 | Train Loss: 0.706 Vali Loss: 2.601 Vali Acc: 0.530 Test Loss: 2.601 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.778287649154663
Epoch: 6, Steps: 18 | Train Loss: 0.336 Vali Loss: 3.882 Vali Acc: 0.460 Test Loss: 3.882 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.55427384376526
Epoch: 7, Steps: 18 | Train Loss: 0.510 Vali Loss: 3.603 Vali Acc: 0.560 Test Loss: 3.603 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.49269413948059
Epoch: 8, Steps: 18 | Train Loss: 0.649 Vali Loss: 3.504 Vali Acc: 0.560 Test Loss: 3.504 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.33536458015442
Epoch: 9, Steps: 18 | Train Loss: 0.986 Vali Loss: 4.883 Vali Acc: 0.640 Test Loss: 4.883 Test Acc: 0.640
Validation loss decreased (-0.589977 --> -0.639951).  Saving model ...
Epoch: 10 cost time: 24.230031967163086
Epoch: 10, Steps: 18 | Train Loss: 0.663 Vali Loss: 4.198 Vali Acc: 0.530 Test Loss: 4.198 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.764317512512207
Epoch: 11, Steps: 18 | Train Loss: 0.555 Vali Loss: 3.594 Vali Acc: 0.510 Test Loss: 3.594 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.126012325286865
Epoch: 12, Steps: 18 | Train Loss: 0.636 Vali Loss: 4.004 Vali Acc: 0.560 Test Loss: 4.004 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.647717237472534
Epoch: 13, Steps: 18 | Train Loss: 0.873 Vali Loss: 7.043 Vali Acc: 0.500 Test Loss: 7.043 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.663190841674805
Epoch: 14, Steps: 18 | Train Loss: 1.124 Vali Loss: 6.043 Vali Acc: 0.560 Test Loss: 6.043 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.983604431152344
Epoch: 15, Steps: 18 | Train Loss: 0.904 Vali Loss: 7.365 Vali Acc: 0.490 Test Loss: 7.365 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 20.664169788360596
Epoch: 16, Steps: 18 | Train Loss: 0.459 Vali Loss: 7.517 Vali Acc: 0.500 Test Loss: 7.517 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 21.116007804870605
Epoch: 17, Steps: 18 | Train Loss: 0.427 Vali Loss: 5.275 Vali Acc: 0.540 Test Loss: 5.275 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.892017126083374
Epoch: 18, Steps: 18 | Train Loss: 0.847 Vali Loss: 11.616 Vali Acc: 0.460 Test Loss: 11.616 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 21.717198848724365
Epoch: 19, Steps: 18 | Train Loss: 0.534 Vali Loss: 13.413 Vali Acc: 0.460 Test Loss: 13.413 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 13139186
model size : 50.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.389132261276245
Epoch: 1, Steps: 18 | Train Loss: 1.122 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 13.710890769958496
Epoch: 2, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.019 Vali Acc: 0.560 Test Loss: 1.019 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 12.115274429321289
Epoch: 3, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.712 Vali Acc: 0.520 Test Loss: 1.712 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.302928447723389
Epoch: 4, Steps: 18 | Train Loss: 0.428 Vali Loss: 4.827 Vali Acc: 0.480 Test Loss: 4.827 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.36388611793518
Epoch: 5, Steps: 18 | Train Loss: 0.918 Vali Loss: 2.384 Vali Acc: 0.490 Test Loss: 2.384 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.53160548210144
Epoch: 6, Steps: 18 | Train Loss: 0.687 Vali Loss: 4.587 Vali Acc: 0.520 Test Loss: 4.587 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.132675409317017
Epoch: 7, Steps: 18 | Train Loss: 0.599 Vali Loss: 3.287 Vali Acc: 0.500 Test Loss: 3.287 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.801458358764648
Epoch: 8, Steps: 18 | Train Loss: 1.010 Vali Loss: 4.649 Vali Acc: 0.490 Test Loss: 4.649 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.384212255477905
Epoch: 9, Steps: 18 | Train Loss: 0.470 Vali Loss: 5.261 Vali Acc: 0.530 Test Loss: 5.261 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.154365062713623
Epoch: 10, Steps: 18 | Train Loss: 1.294 Vali Loss: 4.964 Vali Acc: 0.540 Test Loss: 4.964 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.735646963119507
Epoch: 11, Steps: 18 | Train Loss: 0.542 Vali Loss: 8.208 Vali Acc: 0.490 Test Loss: 8.208 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.85464096069336
Epoch: 12, Steps: 18 | Train Loss: 0.530 Vali Loss: 3.297 Vali Acc: 0.580 Test Loss: 3.297 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579967).  Saving model ...
Epoch: 13 cost time: 15.020727396011353
Epoch: 13, Steps: 18 | Train Loss: 1.295 Vali Loss: 5.605 Vali Acc: 0.560 Test Loss: 5.605 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.082316637039185
Epoch: 14, Steps: 18 | Train Loss: 0.926 Vali Loss: 7.853 Vali Acc: 0.490 Test Loss: 7.853 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.198323011398315
Epoch: 15, Steps: 18 | Train Loss: 1.191 Vali Loss: 7.625 Vali Acc: 0.570 Test Loss: 7.625 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.483227968215942
Epoch: 16, Steps: 18 | Train Loss: 0.779 Vali Loss: 6.197 Vali Acc: 0.450 Test Loss: 6.197 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.278934717178345
Epoch: 17, Steps: 18 | Train Loss: 0.347 Vali Loss: 4.962 Vali Acc: 0.570 Test Loss: 4.962 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.018933296203613
Epoch: 18, Steps: 18 | Train Loss: 0.457 Vali Loss: 8.435 Vali Acc: 0.510 Test Loss: 8.435 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.463583707809448
Epoch: 19, Steps: 18 | Train Loss: 0.204 Vali Loss: 7.165 Vali Acc: 0.490 Test Loss: 7.165 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.420042753219604
Epoch: 20, Steps: 18 | Train Loss: 0.556 Vali Loss: 6.561 Vali Acc: 0.530 Test Loss: 6.561 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.101270198822021
Epoch: 21, Steps: 18 | Train Loss: 0.401 Vali Loss: 7.113 Vali Acc: 0.540 Test Loss: 7.113 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.587167978286743
Epoch: 22, Steps: 18 | Train Loss: 0.530 Vali Loss: 15.891 Vali Acc: 0.470 Test Loss: 15.891 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12985586
model size : 50.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.354077339172363
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.100 Vali Acc: 0.480 Test Loss: 1.100 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 7.401448965072632
Epoch: 2, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
Validation loss decreased (-0.479989 --> -0.529986).  Saving model ...
Epoch: 3 cost time: 7.339522838592529
Epoch: 3, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.774 Vali Acc: 0.470 Test Loss: 2.774 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.453210353851318
Epoch: 4, Steps: 18 | Train Loss: 0.324 Vali Loss: 2.037 Vali Acc: 0.570 Test Loss: 2.037 Test Acc: 0.570
Validation loss decreased (-0.529986 --> -0.569980).  Saving model ...
Epoch: 5 cost time: 7.5499794483184814
Epoch: 5, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.71250581741333
Epoch: 6, Steps: 18 | Train Loss: 0.516 Vali Loss: 3.244 Vali Acc: 0.480 Test Loss: 3.244 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.173663854598999
Epoch: 7, Steps: 18 | Train Loss: 0.358 Vali Loss: 4.591 Vali Acc: 0.500 Test Loss: 4.591 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.7602434158325195
Epoch: 8, Steps: 18 | Train Loss: 0.528 Vali Loss: 5.080 Vali Acc: 0.470 Test Loss: 5.080 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.506994247436523
Epoch: 9, Steps: 18 | Train Loss: 1.293 Vali Loss: 3.803 Vali Acc: 0.530 Test Loss: 3.803 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.172141075134277
Epoch: 10, Steps: 18 | Train Loss: 0.489 Vali Loss: 4.863 Vali Acc: 0.520 Test Loss: 4.863 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.552127838134766
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 5.355 Vali Acc: 0.480 Test Loss: 5.355 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.633632659912109
Epoch: 12, Steps: 18 | Train Loss: 0.623 Vali Loss: 5.280 Vali Acc: 0.590 Test Loss: 5.280 Test Acc: 0.590
Validation loss decreased (-0.569980 --> -0.589947).  Saving model ...
Epoch: 13 cost time: 7.9665446281433105
Epoch: 13, Steps: 18 | Train Loss: 0.372 Vali Loss: 5.263 Vali Acc: 0.500 Test Loss: 5.263 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.501128673553467
Epoch: 14, Steps: 18 | Train Loss: 0.276 Vali Loss: 4.311 Vali Acc: 0.540 Test Loss: 4.311 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.437779426574707
Epoch: 15, Steps: 18 | Train Loss: 0.583 Vali Loss: 5.270 Vali Acc: 0.570 Test Loss: 5.270 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.3293986320495605
Epoch: 16, Steps: 18 | Train Loss: 0.916 Vali Loss: 6.839 Vali Acc: 0.540 Test Loss: 6.839 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.082762002944946
Epoch: 17, Steps: 18 | Train Loss: 1.089 Vali Loss: 5.810 Vali Acc: 0.600 Test Loss: 5.810 Test Acc: 0.600
Validation loss decreased (-0.589947 --> -0.599942).  Saving model ...
Epoch: 18 cost time: 7.934589385986328
Epoch: 18, Steps: 18 | Train Loss: 0.405 Vali Loss: 10.522 Vali Acc: 0.500 Test Loss: 10.522 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.23251748085022
Epoch: 19, Steps: 18 | Train Loss: 0.961 Vali Loss: 6.448 Vali Acc: 0.510 Test Loss: 6.448 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.995532274246216
Epoch: 20, Steps: 18 | Train Loss: 0.384 Vali Loss: 7.098 Vali Acc: 0.450 Test Loss: 7.098 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.802554130554199
Epoch: 21, Steps: 18 | Train Loss: 0.170 Vali Loss: 11.009 Vali Acc: 0.500 Test Loss: 11.009 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.012075662612915
Epoch: 22, Steps: 18 | Train Loss: 0.660 Vali Loss: 7.913 Vali Acc: 0.530 Test Loss: 7.913 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.183568477630615
Epoch: 23, Steps: 18 | Train Loss: 2.317 Vali Loss: 13.547 Vali Acc: 0.530 Test Loss: 13.547 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.785340785980225
Epoch: 24, Steps: 18 | Train Loss: 0.980 Vali Loss: 8.145 Vali Acc: 0.450 Test Loss: 8.145 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.526865005493164
Epoch: 25, Steps: 18 | Train Loss: 0.288 Vali Loss: 10.576 Vali Acc: 0.450 Test Loss: 10.576 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.695111274719238
Epoch: 26, Steps: 18 | Train Loss: 0.543 Vali Loss: 12.624 Vali Acc: 0.470 Test Loss: 12.624 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.327570676803589
Epoch: 27, Steps: 18 | Train Loss: 0.720 Vali Loss: 14.411 Vali Acc: 0.490 Test Loss: 14.411 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 12862706
model size : 49.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.902026891708374
Epoch: 1, Steps: 18 | Train Loss: 1.079 Vali Loss: 0.865 Vali Acc: 0.580 Test Loss: 0.865 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 7.481981992721558
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 1.959 Vali Acc: 0.490 Test Loss: 1.959 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.279247760772705
Epoch: 3, Steps: 18 | Train Loss: 0.999 Vali Loss: 2.294 Vali Acc: 0.530 Test Loss: 2.294 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.158017635345459
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 2.879 Vali Acc: 0.470 Test Loss: 2.879 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.307467937469482
Epoch: 5, Steps: 18 | Train Loss: 0.418 Vali Loss: 4.165 Vali Acc: 0.570 Test Loss: 4.165 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.33030891418457
Epoch: 6, Steps: 18 | Train Loss: 0.411 Vali Loss: 3.214 Vali Acc: 0.460 Test Loss: 3.214 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.123136043548584
Epoch: 7, Steps: 18 | Train Loss: 0.361 Vali Loss: 3.746 Vali Acc: 0.490 Test Loss: 3.746 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.503662824630737
Epoch: 8, Steps: 18 | Train Loss: 0.875 Vali Loss: 4.897 Vali Acc: 0.440 Test Loss: 4.897 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.491425275802612
Epoch: 9, Steps: 18 | Train Loss: 0.738 Vali Loss: 4.247 Vali Acc: 0.500 Test Loss: 4.247 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.599670171737671
Epoch: 10, Steps: 18 | Train Loss: 0.734 Vali Loss: 6.483 Vali Acc: 0.530 Test Loss: 6.483 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.686515808105469
Epoch: 11, Steps: 18 | Train Loss: 1.171 Vali Loss: 7.324 Vali Acc: 0.410 Test Loss: 7.324 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12801266
model size : 49.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.018885850906372
Epoch: 1, Steps: 18 | Train Loss: 0.928 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (inf --> -0.579988).  Saving model ...
Epoch: 2 cost time: 4.812358856201172
Epoch: 2, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.095 Vali Acc: 0.490 Test Loss: 2.095 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.302470445632935
Epoch: 3, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.820 Vali Acc: 0.540 Test Loss: 1.820 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.818201303482056
Epoch: 4, Steps: 18 | Train Loss: 0.168 Vali Loss: 2.291 Vali Acc: 0.520 Test Loss: 2.291 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.719938516616821
Epoch: 5, Steps: 18 | Train Loss: 0.457 Vali Loss: 2.858 Vali Acc: 0.430 Test Loss: 2.858 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.456389665603638
Epoch: 6, Steps: 18 | Train Loss: 0.302 Vali Loss: 4.297 Vali Acc: 0.490 Test Loss: 4.297 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.977336168289185
Epoch: 7, Steps: 18 | Train Loss: 0.705 Vali Loss: 2.540 Vali Acc: 0.530 Test Loss: 2.540 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.571688413619995
Epoch: 8, Steps: 18 | Train Loss: 0.409 Vali Loss: 3.868 Vali Acc: 0.580 Test Loss: 3.868 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.646074295043945
Epoch: 9, Steps: 18 | Train Loss: 0.623 Vali Loss: 7.751 Vali Acc: 0.500 Test Loss: 7.751 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.730429410934448
Epoch: 10, Steps: 18 | Train Loss: 1.535 Vali Loss: 3.866 Vali Acc: 0.540 Test Loss: 3.866 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.477556467056274
Epoch: 11, Steps: 18 | Train Loss: 0.498 Vali Loss: 5.682 Vali Acc: 0.530 Test Loss: 5.682 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 12739826
model size : 48.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9357612133026123
Epoch: 1, Steps: 18 | Train Loss: 1.122 Vali Loss: 1.513 Vali Acc: 0.530 Test Loss: 1.513 Test Acc: 0.530
Validation loss decreased (inf --> -0.529985).  Saving model ...
Epoch: 2 cost time: 1.5268597602844238
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 1.837 Vali Acc: 0.440 Test Loss: 1.837 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5415480136871338
Epoch: 3, Steps: 18 | Train Loss: 0.798 Vali Loss: 2.756 Vali Acc: 0.500 Test Loss: 2.756 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6870522499084473
Epoch: 4, Steps: 18 | Train Loss: 1.264 Vali Loss: 3.676 Vali Acc: 0.450 Test Loss: 3.676 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5594475269317627
Epoch: 5, Steps: 18 | Train Loss: 0.937 Vali Loss: 2.583 Vali Acc: 0.560 Test Loss: 2.583 Test Acc: 0.560
Validation loss decreased (-0.529985 --> -0.559974).  Saving model ...
Epoch: 6 cost time: 1.6209418773651123
Epoch: 6, Steps: 18 | Train Loss: 1.817 Vali Loss: 4.202 Vali Acc: 0.520 Test Loss: 4.202 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.68341064453125
Epoch: 7, Steps: 18 | Train Loss: 1.116 Vali Loss: 2.586 Vali Acc: 0.540 Test Loss: 2.586 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.595287799835205
Epoch: 8, Steps: 18 | Train Loss: 1.158 Vali Loss: 6.214 Vali Acc: 0.460 Test Loss: 6.214 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6339073181152344
Epoch: 9, Steps: 18 | Train Loss: 1.643 Vali Loss: 4.047 Vali Acc: 0.510 Test Loss: 4.047 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8603284358978271
Epoch: 10, Steps: 18 | Train Loss: 1.000 Vali Loss: 4.809 Vali Acc: 0.530 Test Loss: 4.809 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6374163627624512
Epoch: 11, Steps: 18 | Train Loss: 0.892 Vali Loss: 3.633 Vali Acc: 0.540 Test Loss: 3.633 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2053682804107666
Epoch: 12, Steps: 18 | Train Loss: 1.361 Vali Loss: 5.397 Vali Acc: 0.490 Test Loss: 5.397 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9834635257720947
Epoch: 13, Steps: 18 | Train Loss: 1.403 Vali Loss: 6.049 Vali Acc: 0.450 Test Loss: 6.049 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7784335613250732
Epoch: 14, Steps: 18 | Train Loss: 1.545 Vali Loss: 11.055 Vali Acc: 0.480 Test Loss: 11.055 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.825138807296753
Epoch: 15, Steps: 18 | Train Loss: 0.876 Vali Loss: 5.052 Vali Acc: 0.490 Test Loss: 5.052 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 12680434
model size : 48.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.675373792648315
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 1.109 Vali Acc: 0.510 Test Loss: 1.109 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 27.590450286865234
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.958 Vali Acc: 0.530 Test Loss: 0.958 Test Acc: 0.530
Validation loss decreased (-0.509989 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 29.76529026031494
Epoch: 3, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.076 Vali Acc: 0.490 Test Loss: 1.076 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.86115837097168
Epoch: 4, Steps: 18 | Train Loss: 0.769 Vali Loss: 2.267 Vali Acc: 0.560 Test Loss: 2.267 Test Acc: 0.560
Validation loss decreased (-0.529990 --> -0.559977).  Saving model ...
Epoch: 5 cost time: 28.903255701065063
Epoch: 5, Steps: 18 | Train Loss: 1.158 Vali Loss: 5.532 Vali Acc: 0.520 Test Loss: 5.532 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.951123476028442
Epoch: 6, Steps: 18 | Train Loss: 1.440 Vali Loss: 4.584 Vali Acc: 0.500 Test Loss: 4.584 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.495500326156616
Epoch: 7, Steps: 18 | Train Loss: 0.758 Vali Loss: 4.233 Vali Acc: 0.520 Test Loss: 4.233 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 29.697798013687134
Epoch: 8, Steps: 18 | Train Loss: 0.932 Vali Loss: 3.381 Vali Acc: 0.500 Test Loss: 3.381 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 29.5916006565094
Epoch: 9, Steps: 18 | Train Loss: 0.289 Vali Loss: 2.711 Vali Acc: 0.550 Test Loss: 2.711 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.57596182823181
Epoch: 10, Steps: 18 | Train Loss: 0.440 Vali Loss: 3.506 Vali Acc: 0.500 Test Loss: 3.506 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.7387797832489
Epoch: 11, Steps: 18 | Train Loss: 0.645 Vali Loss: 3.900 Vali Acc: 0.550 Test Loss: 3.900 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 29.048874855041504
Epoch: 12, Steps: 18 | Train Loss: 0.468 Vali Loss: 4.464 Vali Acc: 0.550 Test Loss: 4.464 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 30.19444751739502
Epoch: 13, Steps: 18 | Train Loss: 0.231 Vali Loss: 4.676 Vali Acc: 0.510 Test Loss: 4.676 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 28.6843159198761
Epoch: 14, Steps: 18 | Train Loss: 0.491 Vali Loss: 4.497 Vali Acc: 0.560 Test Loss: 4.497 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 6926770
model size : 27.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.856176376342773
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.140 Vali Acc: 0.580 Test Loss: 1.140 Test Acc: 0.580
Validation loss decreased (inf --> -0.579989).  Saving model ...
Epoch: 2 cost time: 29.1994526386261
Epoch: 2, Steps: 18 | Train Loss: 0.899 Vali Loss: 2.641 Vali Acc: 0.520 Test Loss: 2.641 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.390700578689575
Epoch: 3, Steps: 18 | Train Loss: 0.966 Vali Loss: 2.832 Vali Acc: 0.520 Test Loss: 2.832 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.268516778945923
Epoch: 4, Steps: 18 | Train Loss: 0.638 Vali Loss: 3.167 Vali Acc: 0.590 Test Loss: 3.167 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589968).  Saving model ...
Epoch: 5 cost time: 28.925418615341187
Epoch: 5, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.982 Vali Acc: 0.510 Test Loss: 1.982 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.740875959396362
Epoch: 6, Steps: 18 | Train Loss: 0.675 Vali Loss: 3.851 Vali Acc: 0.500 Test Loss: 3.851 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.51433777809143
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.255 Vali Acc: 0.520 Test Loss: 2.255 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 28.565353631973267
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 4.501 Vali Acc: 0.470 Test Loss: 4.501 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.492117881774902
Epoch: 9, Steps: 18 | Train Loss: 0.567 Vali Loss: 5.259 Vali Acc: 0.460 Test Loss: 5.259 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.23023009300232
Epoch: 10, Steps: 18 | Train Loss: 0.643 Vali Loss: 7.094 Vali Acc: 0.520 Test Loss: 7.094 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 24.988414764404297
Epoch: 11, Steps: 18 | Train Loss: 0.874 Vali Loss: 5.042 Vali Acc: 0.490 Test Loss: 5.042 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 25.53230094909668
Epoch: 12, Steps: 18 | Train Loss: 0.419 Vali Loss: 5.011 Vali Acc: 0.530 Test Loss: 5.011 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.319539785385132
Epoch: 13, Steps: 18 | Train Loss: 0.368 Vali Loss: 4.445 Vali Acc: 0.520 Test Loss: 4.445 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 25.175581216812134
Epoch: 14, Steps: 18 | Train Loss: 0.312 Vali Loss: 5.123 Vali Acc: 0.510 Test Loss: 5.123 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6849970
model size : 27.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.964940547943115
Epoch: 1, Steps: 18 | Train Loss: 0.903 Vali Loss: 0.994 Vali Acc: 0.470 Test Loss: 0.994 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 17.170873641967773
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
Validation loss decreased (-0.469990 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 18.15669536590576
Epoch: 3, Steps: 18 | Train Loss: 0.562 Vali Loss: 1.554 Vali Acc: 0.510 Test Loss: 1.554 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.804523706436157
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 3.997 Vali Acc: 0.490 Test Loss: 3.997 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.2884521484375
Epoch: 5, Steps: 18 | Train Loss: 0.897 Vali Loss: 2.589 Vali Acc: 0.560 Test Loss: 2.589 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559974).  Saving model ...
Epoch: 6 cost time: 17.468108654022217
Epoch: 6, Steps: 18 | Train Loss: 0.850 Vali Loss: 4.253 Vali Acc: 0.470 Test Loss: 4.253 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.20778226852417
Epoch: 7, Steps: 18 | Train Loss: 0.679 Vali Loss: 3.257 Vali Acc: 0.490 Test Loss: 3.257 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.679245233535767
Epoch: 8, Steps: 18 | Train Loss: 0.876 Vali Loss: 4.686 Vali Acc: 0.500 Test Loss: 4.686 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.854340076446533
Epoch: 9, Steps: 18 | Train Loss: 0.450 Vali Loss: 3.602 Vali Acc: 0.430 Test Loss: 3.602 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 16.841092109680176
Epoch: 10, Steps: 18 | Train Loss: 0.393 Vali Loss: 8.377 Vali Acc: 0.440 Test Loss: 8.377 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.329662322998047
Epoch: 11, Steps: 18 | Train Loss: 0.666 Vali Loss: 9.170 Vali Acc: 0.500 Test Loss: 9.170 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.332355499267578
Epoch: 12, Steps: 18 | Train Loss: 0.591 Vali Loss: 6.283 Vali Acc: 0.540 Test Loss: 6.283 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.21060800552368
Epoch: 13, Steps: 18 | Train Loss: 0.319 Vali Loss: 6.131 Vali Acc: 0.580 Test Loss: 6.131 Test Acc: 0.580
Validation loss decreased (-0.559974 --> -0.579939).  Saving model ...
Epoch: 14 cost time: 20.87953233718872
Epoch: 14, Steps: 18 | Train Loss: 0.402 Vali Loss: 5.379 Vali Acc: 0.510 Test Loss: 5.379 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.12374448776245
Epoch: 15, Steps: 18 | Train Loss: 0.556 Vali Loss: 5.093 Vali Acc: 0.550 Test Loss: 5.093 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.962762355804443
Epoch: 16, Steps: 18 | Train Loss: 0.944 Vali Loss: 8.975 Vali Acc: 0.480 Test Loss: 8.975 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 16.174373149871826
Epoch: 17, Steps: 18 | Train Loss: 0.334 Vali Loss: 6.167 Vali Acc: 0.520 Test Loss: 6.167 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 20.352699279785156
Epoch: 18, Steps: 18 | Train Loss: 0.563 Vali Loss: 9.090 Vali Acc: 0.510 Test Loss: 9.090 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.697513580322266
Epoch: 19, Steps: 18 | Train Loss: 2.022 Vali Loss: 8.306 Vali Acc: 0.530 Test Loss: 8.306 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 17.035588264465332
Epoch: 20, Steps: 18 | Train Loss: 0.312 Vali Loss: 7.912 Vali Acc: 0.500 Test Loss: 7.912 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.479041814804077
Epoch: 21, Steps: 18 | Train Loss: 0.104 Vali Loss: 7.811 Vali Acc: 0.520 Test Loss: 7.811 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 19.913937091827393
Epoch: 22, Steps: 18 | Train Loss: 0.230 Vali Loss: 7.600 Vali Acc: 0.560 Test Loss: 7.600 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 20.81784439086914
Epoch: 23, Steps: 18 | Train Loss: 0.215 Vali Loss: 8.081 Vali Acc: 0.540 Test Loss: 8.081 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6773170
model size : 26.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.837221622467041
Epoch: 1, Steps: 18 | Train Loss: 0.867 Vali Loss: 0.877 Vali Acc: 0.500 Test Loss: 0.877 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 9.41448187828064
Epoch: 2, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
Validation loss decreased (-0.499991 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 11.444207906723022
Epoch: 3, Steps: 18 | Train Loss: 0.518 Vali Loss: 2.685 Vali Acc: 0.500 Test Loss: 2.685 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.971002578735352
Epoch: 4, Steps: 18 | Train Loss: 0.657 Vali Loss: 2.586 Vali Acc: 0.530 Test Loss: 2.586 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.689831733703613
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 2.052 Vali Acc: 0.540 Test Loss: 2.052 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.13770580291748
Epoch: 6, Steps: 18 | Train Loss: 0.706 Vali Loss: 2.643 Vali Acc: 0.490 Test Loss: 2.643 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.943416833877563
Epoch: 7, Steps: 18 | Train Loss: 0.801 Vali Loss: 2.426 Vali Acc: 0.470 Test Loss: 2.426 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.58532452583313
Epoch: 8, Steps: 18 | Train Loss: 0.441 Vali Loss: 5.344 Vali Acc: 0.440 Test Loss: 5.344 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.427685976028442
Epoch: 9, Steps: 18 | Train Loss: 0.914 Vali Loss: 5.394 Vali Acc: 0.490 Test Loss: 5.394 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.130834341049194
Epoch: 10, Steps: 18 | Train Loss: 0.785 Vali Loss: 2.755 Vali Acc: 0.550 Test Loss: 2.755 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.37110424041748
Epoch: 11, Steps: 18 | Train Loss: 0.627 Vali Loss: 4.801 Vali Acc: 0.520 Test Loss: 4.801 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.077088117599487
Epoch: 12, Steps: 18 | Train Loss: 0.230 Vali Loss: 4.610 Vali Acc: 0.520 Test Loss: 4.610 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6696370
model size : 26.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.777003526687622
Epoch: 1, Steps: 18 | Train Loss: 0.838 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 7.420407295227051
Epoch: 2, Steps: 18 | Train Loss: 0.621 Vali Loss: 1.338 Vali Acc: 0.510 Test Loss: 1.338 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509987).  Saving model ...
Epoch: 3 cost time: 6.721061944961548
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.290 Vali Acc: 0.590 Test Loss: 1.290 Test Acc: 0.590
Validation loss decreased (-0.509987 --> -0.589987).  Saving model ...
Epoch: 4 cost time: 6.4022417068481445
Epoch: 4, Steps: 18 | Train Loss: 0.326 Vali Loss: 2.304 Vali Acc: 0.590 Test Loss: 2.304 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.244267463684082
Epoch: 5, Steps: 18 | Train Loss: 0.632 Vali Loss: 4.035 Vali Acc: 0.510 Test Loss: 4.035 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.665143251419067
Epoch: 6, Steps: 18 | Train Loss: 0.438 Vali Loss: 2.399 Vali Acc: 0.500 Test Loss: 2.399 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.556004285812378
Epoch: 7, Steps: 18 | Train Loss: 0.487 Vali Loss: 2.188 Vali Acc: 0.530 Test Loss: 2.188 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.426691055297852
Epoch: 8, Steps: 18 | Train Loss: 0.330 Vali Loss: 3.195 Vali Acc: 0.570 Test Loss: 3.195 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.549586772918701
Epoch: 9, Steps: 18 | Train Loss: 0.572 Vali Loss: 5.122 Vali Acc: 0.550 Test Loss: 5.122 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.5842015743255615
Epoch: 10, Steps: 18 | Train Loss: 0.484 Vali Loss: 4.264 Vali Acc: 0.500 Test Loss: 4.264 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.805655241012573
Epoch: 11, Steps: 18 | Train Loss: 0.166 Vali Loss: 6.485 Vali Acc: 0.490 Test Loss: 6.485 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.563712120056152
Epoch: 12, Steps: 18 | Train Loss: 0.569 Vali Loss: 5.374 Vali Acc: 0.470 Test Loss: 5.374 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.0835301876068115
Epoch: 13, Steps: 18 | Train Loss: 0.516 Vali Loss: 5.651 Vali Acc: 0.560 Test Loss: 5.651 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6634930
model size : 25.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.882311105728149
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 0.749 Vali Acc: 0.570 Test Loss: 0.749 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 5.927335977554321
Epoch: 2, Steps: 18 | Train Loss: 0.768 Vali Loss: 2.151 Vali Acc: 0.500 Test Loss: 2.151 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.718229293823242
Epoch: 3, Steps: 18 | Train Loss: 0.746 Vali Loss: 1.714 Vali Acc: 0.550 Test Loss: 1.714 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.407145261764526
Epoch: 4, Steps: 18 | Train Loss: 0.709 Vali Loss: 2.284 Vali Acc: 0.620 Test Loss: 2.284 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619977).  Saving model ...
Epoch: 5 cost time: 7.238527059555054
Epoch: 5, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.812 Vali Acc: 0.470 Test Loss: 1.812 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.91502571105957
Epoch: 6, Steps: 18 | Train Loss: 0.436 Vali Loss: 2.579 Vali Acc: 0.510 Test Loss: 2.579 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.470881938934326
Epoch: 7, Steps: 18 | Train Loss: 0.514 Vali Loss: 5.986 Vali Acc: 0.500 Test Loss: 5.986 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.665672540664673
Epoch: 8, Steps: 18 | Train Loss: 0.445 Vali Loss: 4.024 Vali Acc: 0.470 Test Loss: 4.024 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.629958391189575
Epoch: 9, Steps: 18 | Train Loss: 0.254 Vali Loss: 5.272 Vali Acc: 0.510 Test Loss: 5.272 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.7538347244262695
Epoch: 10, Steps: 18 | Train Loss: 0.439 Vali Loss: 9.328 Vali Acc: 0.460 Test Loss: 9.328 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.7316648960113525
Epoch: 11, Steps: 18 | Train Loss: 0.437 Vali Loss: 6.233 Vali Acc: 0.440 Test Loss: 6.233 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.027892351150513
Epoch: 12, Steps: 18 | Train Loss: 0.232 Vali Loss: 7.484 Vali Acc: 0.480 Test Loss: 7.484 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.921520471572876
Epoch: 13, Steps: 18 | Train Loss: 0.301 Vali Loss: 7.972 Vali Acc: 0.480 Test Loss: 7.972 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.015173673629761
Epoch: 14, Steps: 18 | Train Loss: 1.070 Vali Loss: 8.039 Vali Acc: 0.550 Test Loss: 8.039 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6604210
model size : 25.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.536549806594849
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.848 Vali Acc: 0.620 Test Loss: 0.848 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 3.6117467880249023
Epoch: 2, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.879 Vali Acc: 0.540 Test Loss: 0.879 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.93851637840271
Epoch: 3, Steps: 18 | Train Loss: 0.540 Vali Loss: 3.812 Vali Acc: 0.490 Test Loss: 3.812 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8205389976501465
Epoch: 4, Steps: 18 | Train Loss: 0.660 Vali Loss: 4.172 Vali Acc: 0.510 Test Loss: 4.172 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7307050228118896
Epoch: 5, Steps: 18 | Train Loss: 0.877 Vali Loss: 4.096 Vali Acc: 0.500 Test Loss: 4.096 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9177794456481934
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 2.501 Vali Acc: 0.540 Test Loss: 2.501 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.7797417640686035
Epoch: 7, Steps: 18 | Train Loss: 0.490 Vali Loss: 2.084 Vali Acc: 0.490 Test Loss: 2.084 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.566567897796631
Epoch: 8, Steps: 18 | Train Loss: 0.972 Vali Loss: 4.752 Vali Acc: 0.500 Test Loss: 4.752 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6802563667297363
Epoch: 9, Steps: 18 | Train Loss: 0.416 Vali Loss: 7.925 Vali Acc: 0.540 Test Loss: 7.925 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.6562156677246094
Epoch: 10, Steps: 18 | Train Loss: 0.691 Vali Loss: 4.848 Vali Acc: 0.610 Test Loss: 4.848 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.630511522293091
Epoch: 11, Steps: 18 | Train Loss: 0.571 Vali Loss: 3.711 Vali Acc: 0.520 Test Loss: 3.711 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6573490
model size : 25.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.620891571044922
Epoch: 1, Steps: 18 | Train Loss: 0.892 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.2937450408935547
Epoch: 2, Steps: 18 | Train Loss: 0.754 Vali Loss: 1.270 Vali Acc: 0.540 Test Loss: 1.270 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539987).  Saving model ...
Epoch: 3 cost time: 2.1189980506896973
Epoch: 3, Steps: 18 | Train Loss: 0.827 Vali Loss: 2.049 Vali Acc: 0.510 Test Loss: 2.049 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.073704242706299
Epoch: 4, Steps: 18 | Train Loss: 0.733 Vali Loss: 1.677 Vali Acc: 0.520 Test Loss: 1.677 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9891221523284912
Epoch: 5, Steps: 18 | Train Loss: 0.657 Vali Loss: 4.360 Vali Acc: 0.500 Test Loss: 4.360 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8876433372497559
Epoch: 6, Steps: 18 | Train Loss: 0.792 Vali Loss: 3.630 Vali Acc: 0.480 Test Loss: 3.630 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5037436485290527
Epoch: 7, Steps: 18 | Train Loss: 0.885 Vali Loss: 2.427 Vali Acc: 0.520 Test Loss: 2.427 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.63435697555542
Epoch: 8, Steps: 18 | Train Loss: 0.386 Vali Loss: 3.207 Vali Acc: 0.510 Test Loss: 3.207 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5846529006958008
Epoch: 9, Steps: 18 | Train Loss: 0.607 Vali Loss: 3.978 Vali Acc: 0.510 Test Loss: 3.978 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7243046760559082
Epoch: 10, Steps: 18 | Train Loss: 1.337 Vali Loss: 4.267 Vali Acc: 0.460 Test Loss: 4.267 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6373639106750488
Epoch: 11, Steps: 18 | Train Loss: 1.099 Vali Loss: 4.716 Vali Acc: 0.480 Test Loss: 4.716 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6832802295684814
Epoch: 12, Steps: 18 | Train Loss: 0.630 Vali Loss: 6.922 Vali Acc: 0.500 Test Loss: 6.922 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 6543794
model size : 24.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.38319540023804
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 1.182 Vali Acc: 0.480 Test Loss: 1.182 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 28.682921171188354
Epoch: 2, Steps: 18 | Train Loss: 0.955 Vali Loss: 1.043 Vali Acc: 0.540 Test Loss: 1.043 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539990).  Saving model ...
Epoch: 3 cost time: 26.778546571731567
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.107 Vali Acc: 0.460 Test Loss: 1.107 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.25525450706482
Epoch: 4, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.652 Vali Acc: 0.570 Test Loss: 1.652 Test Acc: 0.570
Validation loss decreased (-0.539990 --> -0.569983).  Saving model ...
Epoch: 5 cost time: 23.55173969268799
Epoch: 5, Steps: 18 | Train Loss: 0.370 Vali Loss: 2.068 Vali Acc: 0.500 Test Loss: 2.068 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.412282705307007
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 2.355 Vali Acc: 0.510 Test Loss: 2.355 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 29.82326912879944
Epoch: 7, Steps: 18 | Train Loss: 0.420 Vali Loss: 2.010 Vali Acc: 0.580 Test Loss: 2.010 Test Acc: 0.580
Validation loss decreased (-0.569983 --> -0.579980).  Saving model ...
Epoch: 8 cost time: 28.11777377128601
Epoch: 8, Steps: 18 | Train Loss: 0.776 Vali Loss: 4.111 Vali Acc: 0.520 Test Loss: 4.111 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.128782987594604
Epoch: 9, Steps: 18 | Train Loss: 0.938 Vali Loss: 3.393 Vali Acc: 0.570 Test Loss: 3.393 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.22069787979126
Epoch: 10, Steps: 18 | Train Loss: 0.725 Vali Loss: 5.997 Vali Acc: 0.560 Test Loss: 5.997 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 27.2487530708313
Epoch: 11, Steps: 18 | Train Loss: 0.845 Vali Loss: 7.466 Vali Acc: 0.480 Test Loss: 7.466 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 27.503544330596924
Epoch: 12, Steps: 18 | Train Loss: 0.395 Vali Loss: 7.974 Vali Acc: 0.480 Test Loss: 7.974 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 27.42446517944336
Epoch: 13, Steps: 18 | Train Loss: 1.869 Vali Loss: 6.387 Vali Acc: 0.520 Test Loss: 6.387 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 30.688248872756958
Epoch: 14, Steps: 18 | Train Loss: 0.967 Vali Loss: 7.354 Vali Acc: 0.480 Test Loss: 7.354 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 32.236448764801025
Epoch: 15, Steps: 18 | Train Loss: 0.642 Vali Loss: 6.608 Vali Acc: 0.460 Test Loss: 6.608 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 35.03594255447388
Epoch: 16, Steps: 18 | Train Loss: 0.364 Vali Loss: 6.477 Vali Acc: 0.500 Test Loss: 6.477 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 25.576838970184326
Epoch: 17, Steps: 18 | Train Loss: 0.301 Vali Loss: 6.010 Vali Acc: 0.560 Test Loss: 6.010 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6922642
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.025523900985718
Epoch: 1, Steps: 18 | Train Loss: 0.908 Vali Loss: 0.931 Vali Acc: 0.510 Test Loss: 0.931 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 20.677231788635254
Epoch: 2, Steps: 18 | Train Loss: 0.955 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.88684320449829
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 26.758184671401978
Epoch: 4, Steps: 18 | Train Loss: 0.634 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 22.143320322036743
Epoch: 5, Steps: 18 | Train Loss: 0.795 Vali Loss: 3.813 Vali Acc: 0.510 Test Loss: 3.813 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.858808994293213
Epoch: 6, Steps: 18 | Train Loss: 1.054 Vali Loss: 1.644 Vali Acc: 0.560 Test Loss: 1.644 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559984).  Saving model ...
Epoch: 7 cost time: 22.74263095855713
Epoch: 7, Steps: 18 | Train Loss: 0.295 Vali Loss: 3.262 Vali Acc: 0.500 Test Loss: 3.262 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.563401222229004
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 5.426 Vali Acc: 0.530 Test Loss: 5.426 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.009288787841797
Epoch: 9, Steps: 18 | Train Loss: 0.908 Vali Loss: 5.900 Vali Acc: 0.510 Test Loss: 5.900 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.44352912902832
Epoch: 10, Steps: 18 | Train Loss: 0.906 Vali Loss: 3.743 Vali Acc: 0.520 Test Loss: 3.743 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.752910375595093
Epoch: 11, Steps: 18 | Train Loss: 0.434 Vali Loss: 3.699 Vali Acc: 0.470 Test Loss: 3.699 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 19.291956424713135
Epoch: 12, Steps: 18 | Train Loss: 0.473 Vali Loss: 5.733 Vali Acc: 0.440 Test Loss: 5.733 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.697670936584473
Epoch: 13, Steps: 18 | Train Loss: 0.959 Vali Loss: 7.614 Vali Acc: 0.520 Test Loss: 7.614 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.48181390762329
Epoch: 14, Steps: 18 | Train Loss: 0.499 Vali Loss: 3.774 Vali Acc: 0.470 Test Loss: 3.774 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.71048593521118
Epoch: 15, Steps: 18 | Train Loss: 0.159 Vali Loss: 8.561 Vali Acc: 0.480 Test Loss: 8.561 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.353031158447266
Epoch: 16, Steps: 18 | Train Loss: 0.966 Vali Loss: 5.568 Vali Acc: 0.510 Test Loss: 5.568 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 6845842
model size : 27.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.10658574104309
Epoch: 1, Steps: 18 | Train Loss: 0.856 Vali Loss: 1.113 Vali Acc: 0.480 Test Loss: 1.113 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 14.572117328643799
Epoch: 2, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.731 Vali Acc: 0.560 Test Loss: 1.731 Test Acc: 0.560
Validation loss decreased (-0.479989 --> -0.559983).  Saving model ...
Epoch: 3 cost time: 15.111006259918213
Epoch: 3, Steps: 18 | Train Loss: 1.033 Vali Loss: 1.930 Vali Acc: 0.510 Test Loss: 1.930 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.341830492019653
Epoch: 4, Steps: 18 | Train Loss: 0.899 Vali Loss: 1.320 Vali Acc: 0.580 Test Loss: 1.320 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579987).  Saving model ...
Epoch: 5 cost time: 16.63020086288452
Epoch: 5, Steps: 18 | Train Loss: 0.920 Vali Loss: 5.145 Vali Acc: 0.530 Test Loss: 5.145 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.508186340332031
Epoch: 6, Steps: 18 | Train Loss: 1.315 Vali Loss: 2.702 Vali Acc: 0.580 Test Loss: 2.702 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.624287843704224
Epoch: 7, Steps: 18 | Train Loss: 0.400 Vali Loss: 3.789 Vali Acc: 0.550 Test Loss: 3.789 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.885690212249756
Epoch: 8, Steps: 18 | Train Loss: 0.579 Vali Loss: 2.873 Vali Acc: 0.470 Test Loss: 2.873 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.611035346984863
Epoch: 9, Steps: 18 | Train Loss: 0.724 Vali Loss: 2.785 Vali Acc: 0.530 Test Loss: 2.785 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.96649956703186
Epoch: 10, Steps: 18 | Train Loss: 0.811 Vali Loss: 3.187 Vali Acc: 0.590 Test Loss: 3.187 Test Acc: 0.590
Validation loss decreased (-0.579987 --> -0.589968).  Saving model ...
Epoch: 11 cost time: 15.270394802093506
Epoch: 11, Steps: 18 | Train Loss: 0.910 Vali Loss: 3.158 Vali Acc: 0.600 Test Loss: 3.158 Test Acc: 0.600
Validation loss decreased (-0.589968 --> -0.599968).  Saving model ...
Epoch: 12 cost time: 15.086246013641357
Epoch: 12, Steps: 18 | Train Loss: 0.625 Vali Loss: 4.642 Vali Acc: 0.510 Test Loss: 4.642 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.130635499954224
Epoch: 13, Steps: 18 | Train Loss: 0.401 Vali Loss: 6.009 Vali Acc: 0.520 Test Loss: 6.009 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.286091089248657
Epoch: 14, Steps: 18 | Train Loss: 0.250 Vali Loss: 5.048 Vali Acc: 0.500 Test Loss: 5.048 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.355322360992432
Epoch: 15, Steps: 18 | Train Loss: 0.360 Vali Loss: 6.572 Vali Acc: 0.490 Test Loss: 6.572 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.36823010444641
Epoch: 16, Steps: 18 | Train Loss: 0.513 Vali Loss: 4.885 Vali Acc: 0.560 Test Loss: 4.885 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.739094495773315
Epoch: 17, Steps: 18 | Train Loss: 0.677 Vali Loss: 7.445 Vali Acc: 0.520 Test Loss: 7.445 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.027395725250244
Epoch: 18, Steps: 18 | Train Loss: 0.300 Vali Loss: 6.293 Vali Acc: 0.430 Test Loss: 6.293 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.29323387145996
Epoch: 19, Steps: 18 | Train Loss: 0.713 Vali Loss: 5.262 Vali Acc: 0.600 Test Loss: 5.262 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 17.084578037261963
Epoch: 20, Steps: 18 | Train Loss: 1.103 Vali Loss: 11.648 Vali Acc: 0.500 Test Loss: 11.648 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.31005573272705
Epoch: 21, Steps: 18 | Train Loss: 0.223 Vali Loss: 8.515 Vali Acc: 0.450 Test Loss: 8.515 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6769042
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.823160409927368
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.857 Vali Acc: 0.630 Test Loss: 0.857 Test Acc: 0.630
Validation loss decreased (inf --> -0.629991).  Saving model ...
Epoch: 2 cost time: 11.788641452789307
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 1.079 Vali Acc: 0.520 Test Loss: 1.079 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.955821514129639
Epoch: 3, Steps: 18 | Train Loss: 0.715 Vali Loss: 1.333 Vali Acc: 0.470 Test Loss: 1.333 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.94618821144104
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.701 Vali Acc: 0.610 Test Loss: 1.701 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.008096694946289
Epoch: 5, Steps: 18 | Train Loss: 0.634 Vali Loss: 1.816 Vali Acc: 0.490 Test Loss: 1.816 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.238999843597412
Epoch: 6, Steps: 18 | Train Loss: 0.814 Vali Loss: 2.699 Vali Acc: 0.510 Test Loss: 2.699 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.30400800704956
Epoch: 7, Steps: 18 | Train Loss: 0.410 Vali Loss: 2.854 Vali Acc: 0.520 Test Loss: 2.854 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.452075481414795
Epoch: 8, Steps: 18 | Train Loss: 0.478 Vali Loss: 2.601 Vali Acc: 0.570 Test Loss: 2.601 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.938316345214844
Epoch: 9, Steps: 18 | Train Loss: 0.376 Vali Loss: 4.958 Vali Acc: 0.480 Test Loss: 4.958 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.61426067352295
Epoch: 10, Steps: 18 | Train Loss: 0.470 Vali Loss: 5.439 Vali Acc: 0.470 Test Loss: 5.439 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.138240814208984
Epoch: 11, Steps: 18 | Train Loss: 0.757 Vali Loss: 6.289 Vali Acc: 0.480 Test Loss: 6.289 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6692242
model size : 26.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.55997109413147
Epoch: 1, Steps: 18 | Train Loss: 1.186 Vali Loss: 1.137 Vali Acc: 0.590 Test Loss: 1.137 Test Acc: 0.590
Validation loss decreased (inf --> -0.589989).  Saving model ...
Epoch: 2 cost time: 7.599040746688843
Epoch: 2, Steps: 18 | Train Loss: 0.968 Vali Loss: 0.959 Vali Acc: 0.580 Test Loss: 0.959 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.143099308013916
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 1.390 Vali Acc: 0.540 Test Loss: 1.390 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.544041633605957
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 2.002 Vali Acc: 0.480 Test Loss: 2.002 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.632021903991699
Epoch: 5, Steps: 18 | Train Loss: 1.008 Vali Loss: 2.539 Vali Acc: 0.530 Test Loss: 2.539 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.062396764755249
Epoch: 6, Steps: 18 | Train Loss: 1.836 Vali Loss: 3.463 Vali Acc: 0.550 Test Loss: 3.463 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.587044715881348
Epoch: 7, Steps: 18 | Train Loss: 0.713 Vali Loss: 4.390 Vali Acc: 0.520 Test Loss: 4.390 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.247654914855957
Epoch: 8, Steps: 18 | Train Loss: 0.559 Vali Loss: 6.568 Vali Acc: 0.560 Test Loss: 6.568 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.644420385360718
Epoch: 9, Steps: 18 | Train Loss: 0.764 Vali Loss: 6.021 Vali Acc: 0.540 Test Loss: 6.021 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.552281856536865
Epoch: 10, Steps: 18 | Train Loss: 0.665 Vali Loss: 7.061 Vali Acc: 0.540 Test Loss: 7.061 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.47998309135437
Epoch: 11, Steps: 18 | Train Loss: 0.882 Vali Loss: 4.457 Vali Acc: 0.490 Test Loss: 4.457 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6630802
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.4109649658203125
Epoch: 1, Steps: 18 | Train Loss: 0.921 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 5.963611841201782
Epoch: 2, Steps: 18 | Train Loss: 0.832 Vali Loss: 1.204 Vali Acc: 0.470 Test Loss: 1.204 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.053288459777832
Epoch: 3, Steps: 18 | Train Loss: 0.458 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 4.687729358673096
Epoch: 4, Steps: 18 | Train Loss: 0.828 Vali Loss: 2.098 Vali Acc: 0.510 Test Loss: 2.098 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.697106599807739
Epoch: 5, Steps: 18 | Train Loss: 0.858 Vali Loss: 2.866 Vali Acc: 0.550 Test Loss: 2.866 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.543461322784424
Epoch: 6, Steps: 18 | Train Loss: 1.185 Vali Loss: 3.606 Vali Acc: 0.530 Test Loss: 3.606 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.637907266616821
Epoch: 7, Steps: 18 | Train Loss: 0.380 Vali Loss: 3.277 Vali Acc: 0.560 Test Loss: 3.277 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.227615594863892
Epoch: 8, Steps: 18 | Train Loss: 0.329 Vali Loss: 3.840 Vali Acc: 0.590 Test Loss: 3.840 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.21351432800293
Epoch: 9, Steps: 18 | Train Loss: 1.021 Vali Loss: 7.064 Vali Acc: 0.530 Test Loss: 7.064 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.440562725067139
Epoch: 10, Steps: 18 | Train Loss: 0.530 Vali Loss: 5.396 Vali Acc: 0.510 Test Loss: 5.396 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.784518241882324
Epoch: 11, Steps: 18 | Train Loss: 0.334 Vali Loss: 4.871 Vali Acc: 0.550 Test Loss: 4.871 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.737042427062988
Epoch: 12, Steps: 18 | Train Loss: 1.096 Vali Loss: 5.857 Vali Acc: 0.560 Test Loss: 5.857 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.735877275466919
Epoch: 13, Steps: 18 | Train Loss: 0.592 Vali Loss: 5.855 Vali Acc: 0.540 Test Loss: 5.855 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6600082
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.9555535316467285
Epoch: 1, Steps: 18 | Train Loss: 0.910 Vali Loss: 1.161 Vali Acc: 0.440 Test Loss: 1.161 Test Acc: 0.440
Validation loss decreased (inf --> -0.439988).  Saving model ...
Epoch: 2 cost time: 3.668800115585327
Epoch: 2, Steps: 18 | Train Loss: 0.969 Vali Loss: 2.261 Vali Acc: 0.460 Test Loss: 2.261 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459977).  Saving model ...
Epoch: 3 cost time: 3.383965015411377
Epoch: 3, Steps: 18 | Train Loss: 0.806 Vali Loss: 2.349 Vali Acc: 0.530 Test Loss: 2.349 Test Acc: 0.530
Validation loss decreased (-0.459977 --> -0.529977).  Saving model ...
Epoch: 4 cost time: 3.742501735687256
Epoch: 4, Steps: 18 | Train Loss: 1.003 Vali Loss: 1.429 Vali Acc: 0.530 Test Loss: 1.429 Test Acc: 0.530
Validation loss decreased (-0.529977 --> -0.529986).  Saving model ...
Epoch: 5 cost time: 3.7204861640930176
Epoch: 5, Steps: 18 | Train Loss: 0.471 Vali Loss: 3.885 Vali Acc: 0.480 Test Loss: 3.885 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.815114974975586
Epoch: 6, Steps: 18 | Train Loss: 0.453 Vali Loss: 2.669 Vali Acc: 0.490 Test Loss: 2.669 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7595388889312744
Epoch: 7, Steps: 18 | Train Loss: 0.560 Vali Loss: 4.518 Vali Acc: 0.540 Test Loss: 4.518 Test Acc: 0.540
Validation loss decreased (-0.529986 --> -0.539955).  Saving model ...
Epoch: 8 cost time: 3.3547775745391846
Epoch: 8, Steps: 18 | Train Loss: 0.556 Vali Loss: 4.162 Vali Acc: 0.430 Test Loss: 4.162 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5491955280303955
Epoch: 9, Steps: 18 | Train Loss: 0.321 Vali Loss: 3.377 Vali Acc: 0.460 Test Loss: 3.377 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6777713298797607
Epoch: 10, Steps: 18 | Train Loss: 1.040 Vali Loss: 4.365 Vali Acc: 0.470 Test Loss: 4.365 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.351804256439209
Epoch: 11, Steps: 18 | Train Loss: 0.693 Vali Loss: 6.013 Vali Acc: 0.500 Test Loss: 6.013 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.46673583984375
Epoch: 12, Steps: 18 | Train Loss: 0.197 Vali Loss: 5.103 Vali Acc: 0.530 Test Loss: 5.103 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.582732677459717
Epoch: 13, Steps: 18 | Train Loss: 0.558 Vali Loss: 5.171 Vali Acc: 0.550 Test Loss: 5.171 Test Acc: 0.550
Validation loss decreased (-0.539955 --> -0.549948).  Saving model ...
Epoch: 14 cost time: 3.365432024002075
Epoch: 14, Steps: 18 | Train Loss: 0.557 Vali Loss: 6.451 Vali Acc: 0.570 Test Loss: 6.451 Test Acc: 0.570
Validation loss decreased (-0.549948 --> -0.569935).  Saving model ...
Epoch: 15 cost time: 3.595553398132324
Epoch: 15, Steps: 18 | Train Loss: 1.138 Vali Loss: 7.507 Vali Acc: 0.510 Test Loss: 7.507 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.228571653366089
Epoch: 16, Steps: 18 | Train Loss: 0.622 Vali Loss: 9.053 Vali Acc: 0.490 Test Loss: 9.053 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.092844009399414
Epoch: 17, Steps: 18 | Train Loss: 0.303 Vali Loss: 9.104 Vali Acc: 0.470 Test Loss: 9.104 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4201035499572754
Epoch: 18, Steps: 18 | Train Loss: 0.676 Vali Loss: 7.265 Vali Acc: 0.510 Test Loss: 7.265 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2542078495025635
Epoch: 19, Steps: 18 | Train Loss: 0.146 Vali Loss: 6.965 Vali Acc: 0.530 Test Loss: 6.965 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2177608013153076
Epoch: 20, Steps: 18 | Train Loss: 0.236 Vali Loss: 10.923 Vali Acc: 0.490 Test Loss: 10.923 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.22983455657959
Epoch: 21, Steps: 18 | Train Loss: 0.156 Vali Loss: 8.380 Vali Acc: 0.490 Test Loss: 8.380 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3546454906463623
Epoch: 22, Steps: 18 | Train Loss: 0.272 Vali Loss: 9.052 Vali Acc: 0.510 Test Loss: 9.052 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3914594650268555
Epoch: 23, Steps: 18 | Train Loss: 0.308 Vali Loss: 15.327 Vali Acc: 0.460 Test Loss: 15.327 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2644858360290527
Epoch: 24, Steps: 18 | Train Loss: 0.301 Vali Loss: 10.180 Vali Acc: 0.470 Test Loss: 10.180 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6569362
model size : 25.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.787526845932007
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 1.644670009613037
Epoch: 2, Steps: 18 | Train Loss: 0.787 Vali Loss: 2.708 Vali Acc: 0.500 Test Loss: 2.708 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5807807445526123
Epoch: 3, Steps: 18 | Train Loss: 1.206 Vali Loss: 2.635 Vali Acc: 0.500 Test Loss: 2.635 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5759062767028809
Epoch: 4, Steps: 18 | Train Loss: 0.584 Vali Loss: 1.482 Vali Acc: 0.520 Test Loss: 1.482 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7808630466461182
Epoch: 5, Steps: 18 | Train Loss: 0.538 Vali Loss: 2.417 Vali Acc: 0.550 Test Loss: 2.417 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6662089824676514
Epoch: 6, Steps: 18 | Train Loss: 1.051 Vali Loss: 2.646 Vali Acc: 0.580 Test Loss: 2.646 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579974).  Saving model ...
Epoch: 7 cost time: 1.649278163909912
Epoch: 7, Steps: 18 | Train Loss: 0.736 Vali Loss: 2.485 Vali Acc: 0.450 Test Loss: 2.485 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6886606216430664
Epoch: 8, Steps: 18 | Train Loss: 0.839 Vali Loss: 5.814 Vali Acc: 0.480 Test Loss: 5.814 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7207231521606445
Epoch: 9, Steps: 18 | Train Loss: 0.823 Vali Loss: 6.434 Vali Acc: 0.440 Test Loss: 6.434 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5836384296417236
Epoch: 10, Steps: 18 | Train Loss: 0.736 Vali Loss: 4.351 Vali Acc: 0.530 Test Loss: 4.351 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.628730297088623
Epoch: 11, Steps: 18 | Train Loss: 0.666 Vali Loss: 4.254 Vali Acc: 0.550 Test Loss: 4.254 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6216025352478027
Epoch: 12, Steps: 18 | Train Loss: 1.096 Vali Loss: 4.652 Vali Acc: 0.480 Test Loss: 4.652 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.543330430984497
Epoch: 13, Steps: 18 | Train Loss: 0.705 Vali Loss: 5.873 Vali Acc: 0.480 Test Loss: 5.873 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4632625579833984
Epoch: 14, Steps: 18 | Train Loss: 0.498 Vali Loss: 4.229 Vali Acc: 0.530 Test Loss: 4.229 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.649886131286621
Epoch: 15, Steps: 18 | Train Loss: 0.845 Vali Loss: 6.110 Vali Acc: 0.480 Test Loss: 6.110 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.50569486618042
Epoch: 16, Steps: 18 | Train Loss: 0.695 Vali Loss: 5.169 Vali Acc: 0.560 Test Loss: 5.169 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6539666
model size : 24.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.197999238967896
Epoch: 1, Steps: 18 | Train Loss: 0.901 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 23.875766277313232
Epoch: 2, Steps: 18 | Train Loss: 0.730 Vali Loss: 1.480 Vali Acc: 0.610 Test Loss: 1.480 Test Acc: 0.610
Validation loss decreased (-0.509990 --> -0.609985).  Saving model ...
Epoch: 3 cost time: 27.08035969734192
Epoch: 3, Steps: 18 | Train Loss: 1.068 Vali Loss: 1.461 Vali Acc: 0.470 Test Loss: 1.461 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.425715446472168
Epoch: 4, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.975 Vali Acc: 0.520 Test Loss: 1.975 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.84169316291809
Epoch: 5, Steps: 18 | Train Loss: 0.896 Vali Loss: 2.333 Vali Acc: 0.620 Test Loss: 2.333 Test Acc: 0.620
Validation loss decreased (-0.609985 --> -0.619977).  Saving model ...
Epoch: 6 cost time: 25.648163318634033
Epoch: 6, Steps: 18 | Train Loss: 0.702 Vali Loss: 3.456 Vali Acc: 0.570 Test Loss: 3.456 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.03446936607361
Epoch: 7, Steps: 18 | Train Loss: 0.758 Vali Loss: 3.715 Vali Acc: 0.500 Test Loss: 3.715 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.675001859664917
Epoch: 8, Steps: 18 | Train Loss: 0.716 Vali Loss: 3.903 Vali Acc: 0.480 Test Loss: 3.903 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.11300563812256
Epoch: 9, Steps: 18 | Train Loss: 0.584 Vali Loss: 3.891 Vali Acc: 0.490 Test Loss: 3.891 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 28.249337434768677
Epoch: 10, Steps: 18 | Train Loss: 0.441 Vali Loss: 3.226 Vali Acc: 0.540 Test Loss: 3.226 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.54646348953247
Epoch: 11, Steps: 18 | Train Loss: 1.245 Vali Loss: 4.372 Vali Acc: 0.520 Test Loss: 4.372 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 23.23702383041382
Epoch: 12, Steps: 18 | Train Loss: 0.388 Vali Loss: 3.924 Vali Acc: 0.520 Test Loss: 3.924 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 26.241936683654785
Epoch: 13, Steps: 18 | Train Loss: 0.414 Vali Loss: 6.945 Vali Acc: 0.540 Test Loss: 6.945 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 25.590578079223633
Epoch: 14, Steps: 18 | Train Loss: 0.443 Vali Loss: 4.654 Vali Acc: 0.550 Test Loss: 4.654 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 29.17768669128418
Epoch: 15, Steps: 18 | Train Loss: 0.217 Vali Loss: 5.858 Vali Acc: 0.540 Test Loss: 5.858 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6920578
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.695473194122314
Epoch: 1, Steps: 18 | Train Loss: 0.896 Vali Loss: 1.068 Vali Acc: 0.590 Test Loss: 1.068 Test Acc: 0.590
Validation loss decreased (inf --> -0.589989).  Saving model ...
Epoch: 2 cost time: 21.760953187942505
Epoch: 2, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.326 Vali Acc: 0.460 Test Loss: 1.326 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.635236740112305
Epoch: 3, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.582303762435913
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 1.578 Vali Acc: 0.480 Test Loss: 1.578 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 20.402282238006592
Epoch: 5, Steps: 18 | Train Loss: 0.652 Vali Loss: 2.134 Vali Acc: 0.530 Test Loss: 2.134 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.648142099380493
Epoch: 6, Steps: 18 | Train Loss: 0.640 Vali Loss: 2.077 Vali Acc: 0.500 Test Loss: 2.077 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 21.917786359786987
Epoch: 7, Steps: 18 | Train Loss: 0.555 Vali Loss: 2.228 Vali Acc: 0.540 Test Loss: 2.228 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.75003218650818
Epoch: 8, Steps: 18 | Train Loss: 0.273 Vali Loss: 4.141 Vali Acc: 0.490 Test Loss: 4.141 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 20.75792384147644
Epoch: 9, Steps: 18 | Train Loss: 0.362 Vali Loss: 2.854 Vali Acc: 0.570 Test Loss: 2.854 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 22.596028804779053
Epoch: 10, Steps: 18 | Train Loss: 0.300 Vali Loss: 4.579 Vali Acc: 0.490 Test Loss: 4.579 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 21.327950716018677
Epoch: 11, Steps: 18 | Train Loss: 0.622 Vali Loss: 5.132 Vali Acc: 0.560 Test Loss: 5.132 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6843778
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.2870614528656
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 15.375802516937256
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 1.231 Vali Acc: 0.620 Test Loss: 1.231 Test Acc: 0.620
Validation loss decreased (-0.529992 --> -0.619988).  Saving model ...
Epoch: 3 cost time: 14.110087633132935
Epoch: 3, Steps: 18 | Train Loss: 1.006 Vali Loss: 1.994 Vali Acc: 0.560 Test Loss: 1.994 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.765145540237427
Epoch: 4, Steps: 18 | Train Loss: 0.540 Vali Loss: 2.993 Vali Acc: 0.530 Test Loss: 2.993 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.056454181671143
Epoch: 5, Steps: 18 | Train Loss: 1.231 Vali Loss: 3.567 Vali Acc: 0.520 Test Loss: 3.567 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.047369480133057
Epoch: 6, Steps: 18 | Train Loss: 0.756 Vali Loss: 2.204 Vali Acc: 0.560 Test Loss: 2.204 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.397943258285522
Epoch: 7, Steps: 18 | Train Loss: 0.869 Vali Loss: 3.136 Vali Acc: 0.570 Test Loss: 3.136 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.79423451423645
Epoch: 8, Steps: 18 | Train Loss: 0.780 Vali Loss: 2.754 Vali Acc: 0.570 Test Loss: 2.754 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.69893741607666
Epoch: 9, Steps: 18 | Train Loss: 0.518 Vali Loss: 3.939 Vali Acc: 0.490 Test Loss: 3.939 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.459158420562744
Epoch: 10, Steps: 18 | Train Loss: 0.660 Vali Loss: 3.749 Vali Acc: 0.450 Test Loss: 3.749 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.64430284500122
Epoch: 11, Steps: 18 | Train Loss: 0.641 Vali Loss: 4.374 Vali Acc: 0.520 Test Loss: 4.374 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.169849395751953
Epoch: 12, Steps: 18 | Train Loss: 0.592 Vali Loss: 4.229 Vali Acc: 0.510 Test Loss: 4.229 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6766978
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.557007074356079
Epoch: 1, Steps: 18 | Train Loss: 0.904 Vali Loss: 0.841 Vali Acc: 0.590 Test Loss: 0.841 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 9.904984474182129
Epoch: 2, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.232 Vali Acc: 0.510 Test Loss: 1.232 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.944958448410034
Epoch: 3, Steps: 18 | Train Loss: 1.199 Vali Loss: 1.243 Vali Acc: 0.580 Test Loss: 1.243 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.322061777114868
Epoch: 4, Steps: 18 | Train Loss: 0.804 Vali Loss: 1.612 Vali Acc: 0.510 Test Loss: 1.612 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.887918949127197
Epoch: 5, Steps: 18 | Train Loss: 0.774 Vali Loss: 1.878 Vali Acc: 0.600 Test Loss: 1.878 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599981).  Saving model ...
Epoch: 6 cost time: 9.34837555885315
Epoch: 6, Steps: 18 | Train Loss: 0.789 Vali Loss: 3.354 Vali Acc: 0.540 Test Loss: 3.354 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.868623971939087
Epoch: 7, Steps: 18 | Train Loss: 0.855 Vali Loss: 4.360 Vali Acc: 0.570 Test Loss: 4.360 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.946852922439575
Epoch: 8, Steps: 18 | Train Loss: 0.901 Vali Loss: 3.185 Vali Acc: 0.490 Test Loss: 3.185 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.21496295928955
Epoch: 9, Steps: 18 | Train Loss: 1.009 Vali Loss: 3.776 Vali Acc: 0.510 Test Loss: 3.776 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.097177505493164
Epoch: 10, Steps: 18 | Train Loss: 0.927 Vali Loss: 3.703 Vali Acc: 0.530 Test Loss: 3.703 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.088959693908691
Epoch: 11, Steps: 18 | Train Loss: 0.211 Vali Loss: 4.442 Vali Acc: 0.540 Test Loss: 4.442 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.312798976898193
Epoch: 12, Steps: 18 | Train Loss: 0.203 Vali Loss: 4.733 Vali Acc: 0.530 Test Loss: 4.733 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.177496910095215
Epoch: 13, Steps: 18 | Train Loss: 0.460 Vali Loss: 4.627 Vali Acc: 0.460 Test Loss: 4.627 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.994571924209595
Epoch: 14, Steps: 18 | Train Loss: 0.452 Vali Loss: 5.490 Vali Acc: 0.440 Test Loss: 5.490 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.351179838180542
Epoch: 15, Steps: 18 | Train Loss: 0.434 Vali Loss: 6.064 Vali Acc: 0.510 Test Loss: 6.064 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6690178
model size : 26.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.226582050323486
Epoch: 1, Steps: 18 | Train Loss: 0.947 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 6.549440145492554
Epoch: 2, Steps: 18 | Train Loss: 0.884 Vali Loss: 1.600 Vali Acc: 0.470 Test Loss: 1.600 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.340589284896851
Epoch: 3, Steps: 18 | Train Loss: 1.187 Vali Loss: 2.691 Vali Acc: 0.490 Test Loss: 2.691 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.302460670471191
Epoch: 4, Steps: 18 | Train Loss: 0.858 Vali Loss: 3.563 Vali Acc: 0.500 Test Loss: 3.563 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.594401597976685
Epoch: 5, Steps: 18 | Train Loss: 0.822 Vali Loss: 2.997 Vali Acc: 0.510 Test Loss: 2.997 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.563758850097656
Epoch: 6, Steps: 18 | Train Loss: 0.844 Vali Loss: 5.711 Vali Acc: 0.550 Test Loss: 5.711 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.789372682571411
Epoch: 7, Steps: 18 | Train Loss: 1.007 Vali Loss: 2.862 Vali Acc: 0.580 Test Loss: 2.862 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.38684868812561
Epoch: 8, Steps: 18 | Train Loss: 0.674 Vali Loss: 4.331 Vali Acc: 0.440 Test Loss: 4.331 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.372239828109741
Epoch: 9, Steps: 18 | Train Loss: 0.518 Vali Loss: 3.636 Vali Acc: 0.530 Test Loss: 3.636 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.724656581878662
Epoch: 10, Steps: 18 | Train Loss: 0.497 Vali Loss: 3.103 Vali Acc: 0.540 Test Loss: 3.103 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.67591118812561
Epoch: 11, Steps: 18 | Train Loss: 0.494 Vali Loss: 4.494 Vali Acc: 0.560 Test Loss: 4.494 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6628738
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.1256091594696045
Epoch: 1, Steps: 18 | Train Loss: 1.000 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 4.584268569946289
Epoch: 2, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.649 Vali Acc: 0.440 Test Loss: 1.649 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.544488430023193
Epoch: 3, Steps: 18 | Train Loss: 0.805 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.117796182632446
Epoch: 4, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.842 Vali Acc: 0.500 Test Loss: 1.842 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.8676440715789795
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 1.874 Vali Acc: 0.500 Test Loss: 1.874 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.627560377120972
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 2.268 Vali Acc: 0.470 Test Loss: 2.268 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.707036972045898
Epoch: 7, Steps: 18 | Train Loss: 0.517 Vali Loss: 1.844 Vali Acc: 0.590 Test Loss: 1.844 Test Acc: 0.590
Validation loss decreased (-0.529992 --> -0.589982).  Saving model ...
Epoch: 8 cost time: 4.857831239700317
Epoch: 8, Steps: 18 | Train Loss: 0.417 Vali Loss: 4.306 Vali Acc: 0.560 Test Loss: 4.306 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.570231676101685
Epoch: 9, Steps: 18 | Train Loss: 0.679 Vali Loss: 3.544 Vali Acc: 0.570 Test Loss: 3.544 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.761361122131348
Epoch: 10, Steps: 18 | Train Loss: 0.380 Vali Loss: 6.992 Vali Acc: 0.490 Test Loss: 6.992 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.881832838058472
Epoch: 11, Steps: 18 | Train Loss: 0.411 Vali Loss: 4.253 Vali Acc: 0.600 Test Loss: 4.253 Test Acc: 0.600
Validation loss decreased (-0.589982 --> -0.599957).  Saving model ...
Epoch: 12 cost time: 4.853502035140991
Epoch: 12, Steps: 18 | Train Loss: 0.466 Vali Loss: 8.039 Vali Acc: 0.530 Test Loss: 8.039 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.585742235183716
Epoch: 13, Steps: 18 | Train Loss: 0.835 Vali Loss: 4.155 Vali Acc: 0.520 Test Loss: 4.155 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.415906190872192
Epoch: 14, Steps: 18 | Train Loss: 0.551 Vali Loss: 6.919 Vali Acc: 0.470 Test Loss: 6.919 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.388306617736816
Epoch: 15, Steps: 18 | Train Loss: 0.954 Vali Loss: 8.662 Vali Acc: 0.470 Test Loss: 8.662 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.3113625049591064
Epoch: 16, Steps: 18 | Train Loss: 0.195 Vali Loss: 11.772 Vali Acc: 0.460 Test Loss: 11.772 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.005406141281128
Epoch: 17, Steps: 18 | Train Loss: 0.896 Vali Loss: 6.420 Vali Acc: 0.560 Test Loss: 6.420 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.197842836380005
Epoch: 18, Steps: 18 | Train Loss: 0.380 Vali Loss: 8.272 Vali Acc: 0.600 Test Loss: 8.272 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.611896514892578
Epoch: 19, Steps: 18 | Train Loss: 0.576 Vali Loss: 7.417 Vali Acc: 0.530 Test Loss: 7.417 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.842567205429077
Epoch: 20, Steps: 18 | Train Loss: 0.229 Vali Loss: 11.892 Vali Acc: 0.510 Test Loss: 11.892 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.737181663513184
Epoch: 21, Steps: 18 | Train Loss: 0.301 Vali Loss: 9.845 Vali Acc: 0.480 Test Loss: 9.845 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6598018
model size : 25.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.571066856384277
Epoch: 1, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.966352939605713
Epoch: 2, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0741586685180664
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 1.363 Vali Acc: 0.570 Test Loss: 1.363 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569986).  Saving model ...
Epoch: 4 cost time: 3.6120662689208984
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 2.058 Vali Acc: 0.460 Test Loss: 2.058 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9567952156066895
Epoch: 5, Steps: 18 | Train Loss: 0.654 Vali Loss: 3.848 Vali Acc: 0.520 Test Loss: 3.848 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.470968246459961
Epoch: 6, Steps: 18 | Train Loss: 0.920 Vali Loss: 3.743 Vali Acc: 0.570 Test Loss: 3.743 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.71165132522583
Epoch: 7, Steps: 18 | Train Loss: 0.699 Vali Loss: 2.872 Vali Acc: 0.530 Test Loss: 2.872 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.049023151397705
Epoch: 8, Steps: 18 | Train Loss: 0.560 Vali Loss: 5.219 Vali Acc: 0.510 Test Loss: 5.219 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3996968269348145
Epoch: 9, Steps: 18 | Train Loss: 1.069 Vali Loss: 4.283 Vali Acc: 0.610 Test Loss: 4.283 Test Acc: 0.610
Validation loss decreased (-0.569986 --> -0.609957).  Saving model ...
Epoch: 10 cost time: 3.18530535697937
Epoch: 10, Steps: 18 | Train Loss: 1.247 Vali Loss: 3.890 Vali Acc: 0.540 Test Loss: 3.890 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.085688829421997
Epoch: 11, Steps: 18 | Train Loss: 1.255 Vali Loss: 7.461 Vali Acc: 0.460 Test Loss: 7.461 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.456263303756714
Epoch: 12, Steps: 18 | Train Loss: 0.463 Vali Loss: 6.936 Vali Acc: 0.540 Test Loss: 6.936 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9608545303344727
Epoch: 13, Steps: 18 | Train Loss: 0.550 Vali Loss: 7.205 Vali Acc: 0.530 Test Loss: 7.205 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8950154781341553
Epoch: 14, Steps: 18 | Train Loss: 0.564 Vali Loss: 4.994 Vali Acc: 0.540 Test Loss: 4.994 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.162630319595337
Epoch: 15, Steps: 18 | Train Loss: 0.101 Vali Loss: 5.575 Vali Acc: 0.510 Test Loss: 5.575 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.1428945064544678
Epoch: 16, Steps: 18 | Train Loss: 0.590 Vali Loss: 12.366 Vali Acc: 0.450 Test Loss: 12.366 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.920203685760498
Epoch: 17, Steps: 18 | Train Loss: 0.810 Vali Loss: 6.540 Vali Acc: 0.580 Test Loss: 6.540 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.937906265258789
Epoch: 18, Steps: 18 | Train Loss: 0.653 Vali Loss: 10.356 Vali Acc: 0.480 Test Loss: 10.356 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7249975204467773
Epoch: 19, Steps: 18 | Train Loss: 0.501 Vali Loss: 10.330 Vali Acc: 0.480 Test Loss: 10.330 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6567298
model size : 25.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8368942737579346
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 1.5915465354919434
Epoch: 2, Steps: 18 | Train Loss: 0.870 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.474543809890747
Epoch: 3, Steps: 18 | Train Loss: 0.777 Vali Loss: 2.198 Vali Acc: 0.520 Test Loss: 2.198 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7690064907073975
Epoch: 4, Steps: 18 | Train Loss: 0.691 Vali Loss: 2.359 Vali Acc: 0.530 Test Loss: 2.359 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9274520874023438
Epoch: 5, Steps: 18 | Train Loss: 0.754 Vali Loss: 2.313 Vali Acc: 0.500 Test Loss: 2.313 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.746389627456665
Epoch: 6, Steps: 18 | Train Loss: 0.807 Vali Loss: 2.211 Vali Acc: 0.540 Test Loss: 2.211 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6500279903411865
Epoch: 7, Steps: 18 | Train Loss: 0.449 Vali Loss: 2.271 Vali Acc: 0.510 Test Loss: 2.271 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.718317985534668
Epoch: 8, Steps: 18 | Train Loss: 0.726 Vali Loss: 2.445 Vali Acc: 0.570 Test Loss: 2.445 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569976).  Saving model ...
Epoch: 9 cost time: 1.5375726222991943
Epoch: 9, Steps: 18 | Train Loss: 1.088 Vali Loss: 3.375 Vali Acc: 0.580 Test Loss: 3.375 Test Acc: 0.580
Validation loss decreased (-0.569976 --> -0.579966).  Saving model ...
Epoch: 10 cost time: 1.6864516735076904
Epoch: 10, Steps: 18 | Train Loss: 1.049 Vali Loss: 4.167 Vali Acc: 0.540 Test Loss: 4.167 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6736550331115723
Epoch: 11, Steps: 18 | Train Loss: 0.534 Vali Loss: 5.985 Vali Acc: 0.520 Test Loss: 5.985 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5812265872955322
Epoch: 12, Steps: 18 | Train Loss: 0.573 Vali Loss: 3.969 Vali Acc: 0.570 Test Loss: 3.969 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.50937819480896
Epoch: 13, Steps: 18 | Train Loss: 1.459 Vali Loss: 5.435 Vali Acc: 0.530 Test Loss: 5.435 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4963316917419434
Epoch: 14, Steps: 18 | Train Loss: 0.871 Vali Loss: 7.887 Vali Acc: 0.470 Test Loss: 7.887 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5237860679626465
Epoch: 15, Steps: 18 | Train Loss: 1.440 Vali Loss: 5.686 Vali Acc: 0.540 Test Loss: 5.686 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.485109567642212
Epoch: 16, Steps: 18 | Train Loss: 0.608 Vali Loss: 6.763 Vali Acc: 0.510 Test Loss: 6.763 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5177371501922607
Epoch: 17, Steps: 18 | Train Loss: 0.973 Vali Loss: 4.817 Vali Acc: 0.530 Test Loss: 4.817 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6603732109069824
Epoch: 18, Steps: 18 | Train Loss: 1.173 Vali Loss: 7.550 Vali Acc: 0.570 Test Loss: 7.550 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5230567455291748
Epoch: 19, Steps: 18 | Train Loss: 0.846 Vali Loss: 5.252 Vali Acc: 0.560 Test Loss: 5.252 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6537602
model size : 24.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.28223967552185
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 24.543382167816162
Epoch: 2, Steps: 18 | Train Loss: 0.974 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.89681625366211
Epoch: 3, Steps: 18 | Train Loss: 0.822 Vali Loss: 2.013 Vali Acc: 0.490 Test Loss: 2.013 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.023106575012207
Epoch: 4, Steps: 18 | Train Loss: 0.982 Vali Loss: 2.557 Vali Acc: 0.530 Test Loss: 2.557 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529974).  Saving model ...
Epoch: 5 cost time: 23.496772289276123
Epoch: 5, Steps: 18 | Train Loss: 0.559 Vali Loss: 1.456 Vali Acc: 0.500 Test Loss: 1.456 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.684990882873535
Epoch: 6, Steps: 18 | Train Loss: 0.331 Vali Loss: 4.057 Vali Acc: 0.450 Test Loss: 4.057 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.951693534851074
Epoch: 7, Steps: 18 | Train Loss: 0.694 Vali Loss: 3.923 Vali Acc: 0.570 Test Loss: 3.923 Test Acc: 0.570
Validation loss decreased (-0.529974 --> -0.569961).  Saving model ...
Epoch: 8 cost time: 23.5138156414032
Epoch: 8, Steps: 18 | Train Loss: 0.577 Vali Loss: 3.396 Vali Acc: 0.620 Test Loss: 3.396 Test Acc: 0.620
Validation loss decreased (-0.569961 --> -0.619966).  Saving model ...
Epoch: 9 cost time: 25.550610780715942
Epoch: 9, Steps: 18 | Train Loss: 0.724 Vali Loss: 6.279 Vali Acc: 0.490 Test Loss: 6.279 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.16080141067505
Epoch: 10, Steps: 18 | Train Loss: 1.260 Vali Loss: 10.141 Vali Acc: 0.470 Test Loss: 10.141 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.54985761642456
Epoch: 11, Steps: 18 | Train Loss: 2.053 Vali Loss: 6.514 Vali Acc: 0.540 Test Loss: 6.514 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.669190406799316
Epoch: 12, Steps: 18 | Train Loss: 0.655 Vali Loss: 4.547 Vali Acc: 0.510 Test Loss: 4.547 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.70832896232605
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 4.518 Vali Acc: 0.500 Test Loss: 4.518 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 27.572525024414062
Epoch: 14, Steps: 18 | Train Loss: 0.292 Vali Loss: 5.389 Vali Acc: 0.570 Test Loss: 5.389 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 27.529057264328003
Epoch: 15, Steps: 18 | Train Loss: 0.657 Vali Loss: 7.516 Vali Acc: 0.530 Test Loss: 7.516 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 23.323471784591675
Epoch: 16, Steps: 18 | Train Loss: 0.830 Vali Loss: 4.878 Vali Acc: 0.530 Test Loss: 4.878 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 26.463525533676147
Epoch: 17, Steps: 18 | Train Loss: 0.254 Vali Loss: 4.716 Vali Acc: 0.550 Test Loss: 4.716 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 27.084537744522095
Epoch: 18, Steps: 18 | Train Loss: 0.530 Vali Loss: 7.040 Vali Acc: 0.490 Test Loss: 7.040 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6919546
model size : 27.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.005131483078003
Epoch: 1, Steps: 18 | Train Loss: 0.858 Vali Loss: 1.273 Vali Acc: 0.530 Test Loss: 1.273 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 20.911977529525757
Epoch: 2, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.334 Vali Acc: 0.540 Test Loss: 1.334 Test Acc: 0.540
Validation loss decreased (-0.529987 --> -0.539987).  Saving model ...
Epoch: 3 cost time: 21.11015796661377
Epoch: 3, Steps: 18 | Train Loss: 0.831 Vali Loss: 2.105 Vali Acc: 0.450 Test Loss: 2.105 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.61049795150757
Epoch: 4, Steps: 18 | Train Loss: 0.610 Vali Loss: 1.336 Vali Acc: 0.550 Test Loss: 1.336 Test Acc: 0.550
Validation loss decreased (-0.539987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 21.355758905410767
Epoch: 5, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.721 Vali Acc: 0.490 Test Loss: 1.721 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.35942053794861
Epoch: 6, Steps: 18 | Train Loss: 0.945 Vali Loss: 2.032 Vali Acc: 0.590 Test Loss: 2.032 Test Acc: 0.590
Validation loss decreased (-0.549987 --> -0.589980).  Saving model ...
Epoch: 7 cost time: 20.55927038192749
Epoch: 7, Steps: 18 | Train Loss: 0.893 Vali Loss: 4.595 Vali Acc: 0.490 Test Loss: 4.595 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.839175939559937
Epoch: 8, Steps: 18 | Train Loss: 0.778 Vali Loss: 3.173 Vali Acc: 0.530 Test Loss: 3.173 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.898028135299683
Epoch: 9, Steps: 18 | Train Loss: 0.426 Vali Loss: 3.323 Vali Acc: 0.570 Test Loss: 3.323 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.645930528640747
Epoch: 10, Steps: 18 | Train Loss: 0.292 Vali Loss: 3.339 Vali Acc: 0.440 Test Loss: 3.339 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.859375953674316
Epoch: 11, Steps: 18 | Train Loss: 0.328 Vali Loss: 3.944 Vali Acc: 0.530 Test Loss: 3.944 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.4345600605011
Epoch: 12, Steps: 18 | Train Loss: 0.344 Vali Loss: 3.917 Vali Acc: 0.530 Test Loss: 3.917 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.33131980895996
Epoch: 13, Steps: 18 | Train Loss: 0.342 Vali Loss: 3.553 Vali Acc: 0.540 Test Loss: 3.553 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 20.486801385879517
Epoch: 14, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.779 Vali Acc: 0.480 Test Loss: 4.779 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 20.43464708328247
Epoch: 15, Steps: 18 | Train Loss: 1.061 Vali Loss: 7.369 Vali Acc: 0.490 Test Loss: 7.369 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 19.730563640594482
Epoch: 16, Steps: 18 | Train Loss: 0.580 Vali Loss: 7.517 Vali Acc: 0.560 Test Loss: 7.517 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6842746
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.705348253250122
Epoch: 1, Steps: 18 | Train Loss: 1.089 Vali Loss: 1.181 Vali Acc: 0.600 Test Loss: 1.181 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 13.568166255950928
Epoch: 2, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.379696369171143
Epoch: 3, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.614 Vali Acc: 0.540 Test Loss: 1.614 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.865628957748413
Epoch: 4, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.823 Vali Acc: 0.480 Test Loss: 2.823 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.175262928009033
Epoch: 5, Steps: 18 | Train Loss: 0.800 Vali Loss: 3.227 Vali Acc: 0.490 Test Loss: 3.227 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.567647218704224
Epoch: 6, Steps: 18 | Train Loss: 1.220 Vali Loss: 2.508 Vali Acc: 0.600 Test Loss: 2.508 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.793657541275024
Epoch: 7, Steps: 18 | Train Loss: 0.339 Vali Loss: 2.483 Vali Acc: 0.530 Test Loss: 2.483 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.968823194503784
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 2.752 Vali Acc: 0.570 Test Loss: 2.752 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.99742293357849
Epoch: 9, Steps: 18 | Train Loss: 0.388 Vali Loss: 4.408 Vali Acc: 0.590 Test Loss: 4.408 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.482847929000854
Epoch: 10, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.709 Vali Acc: 0.540 Test Loss: 2.709 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.0454421043396
Epoch: 11, Steps: 18 | Train Loss: 0.878 Vali Loss: 5.624 Vali Acc: 0.510 Test Loss: 5.624 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6765946
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.384974479675293
Epoch: 1, Steps: 18 | Train Loss: 1.233 Vali Loss: 1.214 Vali Acc: 0.620 Test Loss: 1.214 Test Acc: 0.620
Validation loss decreased (inf --> -0.619988).  Saving model ...
Epoch: 2 cost time: 12.201107025146484
Epoch: 2, Steps: 18 | Train Loss: 1.121 Vali Loss: 1.466 Vali Acc: 0.520 Test Loss: 1.466 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.80005931854248
Epoch: 3, Steps: 18 | Train Loss: 0.565 Vali Loss: 1.083 Vali Acc: 0.460 Test Loss: 1.083 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.86269736289978
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 1.513 Vali Acc: 0.530 Test Loss: 1.513 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.547482967376709
Epoch: 5, Steps: 18 | Train Loss: 0.551 Vali Loss: 4.288 Vali Acc: 0.480 Test Loss: 4.288 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.04060959815979
Epoch: 6, Steps: 18 | Train Loss: 0.637 Vali Loss: 3.078 Vali Acc: 0.550 Test Loss: 3.078 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.972172975540161
Epoch: 7, Steps: 18 | Train Loss: 0.553 Vali Loss: 2.858 Vali Acc: 0.520 Test Loss: 2.858 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.420791149139404
Epoch: 8, Steps: 18 | Train Loss: 0.603 Vali Loss: 5.016 Vali Acc: 0.550 Test Loss: 5.016 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.335971355438232
Epoch: 9, Steps: 18 | Train Loss: 0.853 Vali Loss: 3.414 Vali Acc: 0.610 Test Loss: 3.414 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.583038806915283
Epoch: 10, Steps: 18 | Train Loss: 0.274 Vali Loss: 3.085 Vali Acc: 0.520 Test Loss: 3.085 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.463809728622437
Epoch: 11, Steps: 18 | Train Loss: 0.508 Vali Loss: 3.204 Vali Acc: 0.550 Test Loss: 3.204 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6689146
model size : 25.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.37586259841919
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 8.326088666915894
Epoch: 2, Steps: 18 | Train Loss: 0.756 Vali Loss: 1.321 Vali Acc: 0.490 Test Loss: 1.321 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.1317720413208
Epoch: 3, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.558 Vali Acc: 0.490 Test Loss: 1.558 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.029529571533203
Epoch: 4, Steps: 18 | Train Loss: 0.508 Vali Loss: 1.295 Vali Acc: 0.590 Test Loss: 1.295 Test Acc: 0.590
Validation loss decreased (-0.489992 --> -0.589987).  Saving model ...
Epoch: 5 cost time: 6.5736048221588135
Epoch: 5, Steps: 18 | Train Loss: 0.492 Vali Loss: 2.052 Vali Acc: 0.510 Test Loss: 2.052 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.040270090103149
Epoch: 6, Steps: 18 | Train Loss: 0.712 Vali Loss: 2.266 Vali Acc: 0.520 Test Loss: 2.266 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.351143836975098
Epoch: 7, Steps: 18 | Train Loss: 0.523 Vali Loss: 5.571 Vali Acc: 0.530 Test Loss: 5.571 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.790118932723999
Epoch: 8, Steps: 18 | Train Loss: 0.938 Vali Loss: 2.688 Vali Acc: 0.490 Test Loss: 2.688 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.021862030029297
Epoch: 9, Steps: 18 | Train Loss: 0.890 Vali Loss: 4.472 Vali Acc: 0.470 Test Loss: 4.472 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.554034233093262
Epoch: 10, Steps: 18 | Train Loss: 0.982 Vali Loss: 7.581 Vali Acc: 0.480 Test Loss: 7.581 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.037240028381348
Epoch: 11, Steps: 18 | Train Loss: 0.728 Vali Loss: 7.088 Vali Acc: 0.490 Test Loss: 7.088 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.215601682662964
Epoch: 12, Steps: 18 | Train Loss: 0.766 Vali Loss: 5.096 Vali Acc: 0.500 Test Loss: 5.096 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.18495774269104
Epoch: 13, Steps: 18 | Train Loss: 0.378 Vali Loss: 4.654 Vali Acc: 0.500 Test Loss: 4.654 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.423814296722412
Epoch: 14, Steps: 18 | Train Loss: 0.663 Vali Loss: 7.547 Vali Acc: 0.500 Test Loss: 7.547 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6627706
model size : 25.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.983967304229736
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.935 Vali Acc: 0.460 Test Loss: 0.935 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 5.150964736938477
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.934 Vali Acc: 0.490 Test Loss: 0.934 Test Acc: 0.490
Validation loss decreased (-0.459991 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 5.352972745895386
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 2.433 Vali Acc: 0.420 Test Loss: 2.433 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.775356769561768
Epoch: 4, Steps: 18 | Train Loss: 0.524 Vali Loss: 1.583 Vali Acc: 0.470 Test Loss: 1.583 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.212823867797852
Epoch: 5, Steps: 18 | Train Loss: 0.550 Vali Loss: 2.702 Vali Acc: 0.490 Test Loss: 2.702 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.828526735305786
Epoch: 6, Steps: 18 | Train Loss: 0.952 Vali Loss: 2.103 Vali Acc: 0.500 Test Loss: 2.103 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 5.0613112449646
Epoch: 7, Steps: 18 | Train Loss: 0.313 Vali Loss: 2.795 Vali Acc: 0.500 Test Loss: 2.795 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.943910121917725
Epoch: 8, Steps: 18 | Train Loss: 0.537 Vali Loss: 4.384 Vali Acc: 0.510 Test Loss: 4.384 Test Acc: 0.510
Validation loss decreased (-0.499979 --> -0.509956).  Saving model ...
Epoch: 9 cost time: 5.102920293807983
Epoch: 9, Steps: 18 | Train Loss: 0.676 Vali Loss: 3.480 Vali Acc: 0.530 Test Loss: 3.480 Test Acc: 0.530
Validation loss decreased (-0.509956 --> -0.529965).  Saving model ...
Epoch: 10 cost time: 5.753226280212402
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 3.890 Vali Acc: 0.460 Test Loss: 3.890 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.513915061950684
Epoch: 11, Steps: 18 | Train Loss: 1.475 Vali Loss: 6.970 Vali Acc: 0.430 Test Loss: 6.970 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.167015314102173
Epoch: 12, Steps: 18 | Train Loss: 0.936 Vali Loss: 8.257 Vali Acc: 0.480 Test Loss: 8.257 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.775145769119263
Epoch: 13, Steps: 18 | Train Loss: 0.294 Vali Loss: 3.896 Vali Acc: 0.490 Test Loss: 3.896 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.865231037139893
Epoch: 14, Steps: 18 | Train Loss: 0.461 Vali Loss: 5.597 Vali Acc: 0.470 Test Loss: 5.597 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.397222995758057
Epoch: 15, Steps: 18 | Train Loss: 0.167 Vali Loss: 5.755 Vali Acc: 0.480 Test Loss: 5.755 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.195849657058716
Epoch: 16, Steps: 18 | Train Loss: 0.347 Vali Loss: 9.163 Vali Acc: 0.480 Test Loss: 9.163 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.946640729904175
Epoch: 17, Steps: 18 | Train Loss: 0.385 Vali Loss: 6.775 Vali Acc: 0.510 Test Loss: 6.775 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.241710662841797
Epoch: 18, Steps: 18 | Train Loss: 0.522 Vali Loss: 8.209 Vali Acc: 0.510 Test Loss: 8.209 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.883949041366577
Epoch: 19, Steps: 18 | Train Loss: 0.428 Vali Loss: 10.553 Vali Acc: 0.540 Test Loss: 10.553 Test Acc: 0.540
Validation loss decreased (-0.529965 --> -0.539894).  Saving model ...
Epoch: 20 cost time: 5.71903395652771
Epoch: 20, Steps: 18 | Train Loss: 0.583 Vali Loss: 11.668 Vali Acc: 0.460 Test Loss: 11.668 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.498051166534424
Epoch: 21, Steps: 18 | Train Loss: 0.492 Vali Loss: 8.257 Vali Acc: 0.520 Test Loss: 8.257 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.283879518508911
Epoch: 22, Steps: 18 | Train Loss: 0.439 Vali Loss: 9.014 Vali Acc: 0.580 Test Loss: 9.014 Test Acc: 0.580
Validation loss decreased (-0.539894 --> -0.579910).  Saving model ...
Epoch: 23 cost time: 5.455454587936401
Epoch: 23, Steps: 18 | Train Loss: 0.267 Vali Loss: 8.663 Vali Acc: 0.510 Test Loss: 8.663 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.293247699737549
Epoch: 24, Steps: 18 | Train Loss: 0.150 Vali Loss: 8.193 Vali Acc: 0.460 Test Loss: 8.193 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.220049142837524
Epoch: 25, Steps: 18 | Train Loss: 0.305 Vali Loss: 10.151 Vali Acc: 0.510 Test Loss: 10.151 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.737019062042236
Epoch: 26, Steps: 18 | Train Loss: 0.094 Vali Loss: 11.248 Vali Acc: 0.460 Test Loss: 11.248 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.04541540145874
Epoch: 27, Steps: 18 | Train Loss: 0.120 Vali Loss: 13.006 Vali Acc: 0.550 Test Loss: 13.006 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.244976282119751
Epoch: 28, Steps: 18 | Train Loss: 0.413 Vali Loss: 11.602 Vali Acc: 0.530 Test Loss: 11.602 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.547601222991943
Epoch: 29, Steps: 18 | Train Loss: 0.248 Vali Loss: 9.850 Vali Acc: 0.500 Test Loss: 9.850 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.535468816757202
Epoch: 30, Steps: 18 | Train Loss: 0.153 Vali Loss: 14.778 Vali Acc: 0.500 Test Loss: 14.778 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.430495977401733
Epoch: 31, Steps: 18 | Train Loss: 0.203 Vali Loss: 11.089 Vali Acc: 0.530 Test Loss: 11.089 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.592326641082764
Epoch: 32, Steps: 18 | Train Loss: 0.123 Vali Loss: 11.301 Vali Acc: 0.530 Test Loss: 11.301 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6596986
model size : 25.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.200497150421143
Epoch: 1, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.933 Vali Acc: 0.440 Test Loss: 0.933 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 3.8657264709472656
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.731 Vali Acc: 0.470 Test Loss: 1.731 Test Acc: 0.470
Validation loss decreased (-0.439991 --> -0.469983).  Saving model ...
Epoch: 3 cost time: 4.0750062465667725
Epoch: 3, Steps: 18 | Train Loss: 0.987 Vali Loss: 3.433 Vali Acc: 0.470 Test Loss: 3.433 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.115657806396484
Epoch: 4, Steps: 18 | Train Loss: 0.782 Vali Loss: 1.486 Vali Acc: 0.550 Test Loss: 1.486 Test Acc: 0.550
Validation loss decreased (-0.469983 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 3.5827889442443848
Epoch: 5, Steps: 18 | Train Loss: 0.654 Vali Loss: 2.072 Vali Acc: 0.590 Test Loss: 2.072 Test Acc: 0.590
Validation loss decreased (-0.549985 --> -0.589979).  Saving model ...
Epoch: 6 cost time: 3.776599884033203
Epoch: 6, Steps: 18 | Train Loss: 0.579 Vali Loss: 2.077 Vali Acc: 0.520 Test Loss: 2.077 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.021845579147339
Epoch: 7, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.913 Vali Acc: 0.450 Test Loss: 2.913 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.184241533279419
Epoch: 8, Steps: 18 | Train Loss: 0.712 Vali Loss: 4.702 Vali Acc: 0.490 Test Loss: 4.702 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.753319263458252
Epoch: 9, Steps: 18 | Train Loss: 0.419 Vali Loss: 2.959 Vali Acc: 0.530 Test Loss: 2.959 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.783604145050049
Epoch: 10, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.741 Vali Acc: 0.490 Test Loss: 3.741 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.775792360305786
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 4.511 Vali Acc: 0.610 Test Loss: 4.511 Test Acc: 0.610
Validation loss decreased (-0.589979 --> -0.609955).  Saving model ...
Epoch: 12 cost time: 3.128247022628784
Epoch: 12, Steps: 18 | Train Loss: 0.608 Vali Loss: 3.781 Vali Acc: 0.530 Test Loss: 3.781 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.274914503097534
Epoch: 13, Steps: 18 | Train Loss: 0.258 Vali Loss: 5.902 Vali Acc: 0.460 Test Loss: 5.902 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.177130937576294
Epoch: 14, Steps: 18 | Train Loss: 0.234 Vali Loss: 5.189 Vali Acc: 0.520 Test Loss: 5.189 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2283363342285156
Epoch: 15, Steps: 18 | Train Loss: 0.189 Vali Loss: 6.510 Vali Acc: 0.450 Test Loss: 6.510 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.566757917404175
Epoch: 16, Steps: 18 | Train Loss: 0.357 Vali Loss: 6.363 Vali Acc: 0.500 Test Loss: 6.363 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6404590606689453
Epoch: 17, Steps: 18 | Train Loss: 1.150 Vali Loss: 8.609 Vali Acc: 0.480 Test Loss: 8.609 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.496471643447876
Epoch: 18, Steps: 18 | Train Loss: 0.853 Vali Loss: 7.244 Vali Acc: 0.490 Test Loss: 7.244 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.6054270267486572
Epoch: 19, Steps: 18 | Train Loss: 0.069 Vali Loss: 8.416 Vali Acc: 0.510 Test Loss: 8.416 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.256361246109009
Epoch: 20, Steps: 18 | Train Loss: 0.175 Vali Loss: 9.318 Vali Acc: 0.500 Test Loss: 9.318 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0860464572906494
Epoch: 21, Steps: 18 | Train Loss: 0.482 Vali Loss: 6.428 Vali Acc: 0.520 Test Loss: 6.428 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6566266
model size : 25.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.046903371810913
Epoch: 1, Steps: 18 | Train Loss: 0.829 Vali Loss: 1.074 Vali Acc: 0.480 Test Loss: 1.074 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 1.5628979206085205
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 2.251 Vali Acc: 0.500 Test Loss: 2.251 Test Acc: 0.500
Validation loss decreased (-0.479989 --> -0.499977).  Saving model ...
Epoch: 3 cost time: 1.4429442882537842
Epoch: 3, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.630 Vali Acc: 0.540 Test Loss: 1.630 Test Acc: 0.540
Validation loss decreased (-0.499977 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 1.7408168315887451
Epoch: 4, Steps: 18 | Train Loss: 1.041 Vali Loss: 4.200 Vali Acc: 0.500 Test Loss: 4.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.762378454208374
Epoch: 5, Steps: 18 | Train Loss: 1.514 Vali Loss: 3.176 Vali Acc: 0.470 Test Loss: 3.176 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.782621145248413
Epoch: 6, Steps: 18 | Train Loss: 0.653 Vali Loss: 1.659 Vali Acc: 0.500 Test Loss: 1.659 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7164547443389893
Epoch: 7, Steps: 18 | Train Loss: 0.431 Vali Loss: 2.255 Vali Acc: 0.500 Test Loss: 2.255 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7793681621551514
Epoch: 8, Steps: 18 | Train Loss: 0.707 Vali Loss: 4.344 Vali Acc: 0.450 Test Loss: 4.344 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6751399040222168
Epoch: 9, Steps: 18 | Train Loss: 1.013 Vali Loss: 4.401 Vali Acc: 0.500 Test Loss: 4.401 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7816174030303955
Epoch: 10, Steps: 18 | Train Loss: 0.597 Vali Loss: 4.530 Vali Acc: 0.560 Test Loss: 4.530 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559955).  Saving model ...
Epoch: 11 cost time: 1.7567641735076904
Epoch: 11, Steps: 18 | Train Loss: 0.775 Vali Loss: 3.289 Vali Acc: 0.600 Test Loss: 3.289 Test Acc: 0.600
Validation loss decreased (-0.559955 --> -0.599967).  Saving model ...
Epoch: 12 cost time: 1.6719558238983154
Epoch: 12, Steps: 18 | Train Loss: 1.215 Vali Loss: 9.127 Vali Acc: 0.480 Test Loss: 9.127 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7789132595062256
Epoch: 13, Steps: 18 | Train Loss: 0.718 Vali Loss: 3.338 Vali Acc: 0.510 Test Loss: 3.338 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7629203796386719
Epoch: 14, Steps: 18 | Train Loss: 0.426 Vali Loss: 6.378 Vali Acc: 0.520 Test Loss: 6.378 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6814594268798828
Epoch: 15, Steps: 18 | Train Loss: 1.252 Vali Loss: 7.771 Vali Acc: 0.630 Test Loss: 7.771 Test Acc: 0.630
Validation loss decreased (-0.599967 --> -0.629922).  Saving model ...
Epoch: 16 cost time: 1.786428689956665
Epoch: 16, Steps: 18 | Train Loss: 1.530 Vali Loss: 5.346 Vali Acc: 0.560 Test Loss: 5.346 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.695319652557373
Epoch: 17, Steps: 18 | Train Loss: 0.870 Vali Loss: 6.525 Vali Acc: 0.520 Test Loss: 6.525 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7188162803649902
Epoch: 18, Steps: 18 | Train Loss: 0.767 Vali Loss: 6.680 Vali Acc: 0.560 Test Loss: 6.680 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7036902904510498
Epoch: 19, Steps: 18 | Train Loss: 1.486 Vali Loss: 9.630 Vali Acc: 0.530 Test Loss: 9.630 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6974456310272217
Epoch: 20, Steps: 18 | Train Loss: 0.550 Vali Loss: 10.502 Vali Acc: 0.540 Test Loss: 10.502 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5794107913970947
Epoch: 21, Steps: 18 | Train Loss: 1.688 Vali Loss: 11.386 Vali Acc: 0.490 Test Loss: 11.386 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.668666124343872
Epoch: 22, Steps: 18 | Train Loss: 2.595 Vali Loss: 11.497 Vali Acc: 0.550 Test Loss: 11.497 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.527726411819458
Epoch: 23, Steps: 18 | Train Loss: 0.298 Vali Loss: 9.202 Vali Acc: 0.460 Test Loss: 9.202 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.541297435760498
Epoch: 24, Steps: 18 | Train Loss: 0.866 Vali Loss: 10.095 Vali Acc: 0.530 Test Loss: 10.095 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4153213500976562
Epoch: 25, Steps: 18 | Train Loss: 0.988 Vali Loss: 7.833 Vali Acc: 0.580 Test Loss: 7.833 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6536570
model size : 24.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.512685775756836
Epoch: 1, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 30.958845138549805
Epoch: 2, Steps: 18 | Train Loss: 1.038 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.529992 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 34.945131063461304
Epoch: 3, Steps: 18 | Train Loss: 0.929 Vali Loss: 1.531 Vali Acc: 0.510 Test Loss: 1.531 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.926764726638794
Epoch: 4, Steps: 18 | Train Loss: 0.542 Vali Loss: 3.564 Vali Acc: 0.530 Test Loss: 3.564 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 29.967261791229248
Epoch: 5, Steps: 18 | Train Loss: 0.956 Vali Loss: 2.189 Vali Acc: 0.520 Test Loss: 2.189 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.43704390525818
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 2.086 Vali Acc: 0.580 Test Loss: 2.086 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.745530128479004
Epoch: 7, Steps: 18 | Train Loss: 0.526 Vali Loss: 2.615 Vali Acc: 0.500 Test Loss: 2.615 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.99114465713501
Epoch: 8, Steps: 18 | Train Loss: 0.490 Vali Loss: 2.471 Vali Acc: 0.470 Test Loss: 2.471 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.255130767822266
Epoch: 9, Steps: 18 | Train Loss: 0.626 Vali Loss: 2.330 Vali Acc: 0.550 Test Loss: 2.330 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 29.549337148666382
Epoch: 10, Steps: 18 | Train Loss: 0.884 Vali Loss: 2.468 Vali Acc: 0.540 Test Loss: 2.468 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 30.335524320602417
Epoch: 11, Steps: 18 | Train Loss: 0.603 Vali Loss: 7.226 Vali Acc: 0.450 Test Loss: 7.226 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 30.317888021469116
Epoch: 12, Steps: 18 | Train Loss: 0.365 Vali Loss: 5.472 Vali Acc: 0.530 Test Loss: 5.472 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6919030
model size : 27.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.53611969947815
Epoch: 1, Steps: 18 | Train Loss: 0.911 Vali Loss: 1.275 Vali Acc: 0.460 Test Loss: 1.275 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 22.98006248474121
Epoch: 2, Steps: 18 | Train Loss: 0.962 Vali Loss: 1.362 Vali Acc: 0.460 Test Loss: 1.362 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.64534878730774
Epoch: 3, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.730 Vali Acc: 0.500 Test Loss: 1.730 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 21.90235662460327
Epoch: 4, Steps: 18 | Train Loss: 0.530 Vali Loss: 1.647 Vali Acc: 0.470 Test Loss: 1.647 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.780593395233154
Epoch: 5, Steps: 18 | Train Loss: 0.695 Vali Loss: 1.997 Vali Acc: 0.480 Test Loss: 1.997 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.279856204986572
Epoch: 6, Steps: 18 | Train Loss: 0.879 Vali Loss: 2.253 Vali Acc: 0.510 Test Loss: 2.253 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509977).  Saving model ...
Epoch: 7 cost time: 22.6596577167511
Epoch: 7, Steps: 18 | Train Loss: 0.511 Vali Loss: 3.577 Vali Acc: 0.480 Test Loss: 3.577 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.76348090171814
Epoch: 8, Steps: 18 | Train Loss: 0.309 Vali Loss: 3.241 Vali Acc: 0.480 Test Loss: 3.241 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.50753378868103
Epoch: 9, Steps: 18 | Train Loss: 0.580 Vali Loss: 3.556 Vali Acc: 0.470 Test Loss: 3.556 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.28684163093567
Epoch: 10, Steps: 18 | Train Loss: 0.877 Vali Loss: 4.156 Vali Acc: 0.470 Test Loss: 4.156 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.17572569847107
Epoch: 11, Steps: 18 | Train Loss: 0.675 Vali Loss: 3.556 Vali Acc: 0.490 Test Loss: 3.556 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.14485764503479
Epoch: 12, Steps: 18 | Train Loss: 0.582 Vali Loss: 7.579 Vali Acc: 0.460 Test Loss: 7.579 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.617238521575928
Epoch: 13, Steps: 18 | Train Loss: 0.631 Vali Loss: 3.980 Vali Acc: 0.490 Test Loss: 3.980 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.996577501296997
Epoch: 14, Steps: 18 | Train Loss: 0.274 Vali Loss: 8.220 Vali Acc: 0.500 Test Loss: 8.220 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 21.48707127571106
Epoch: 15, Steps: 18 | Train Loss: 0.593 Vali Loss: 10.520 Vali Acc: 0.480 Test Loss: 10.520 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 20.915648460388184
Epoch: 16, Steps: 18 | Train Loss: 0.960 Vali Loss: 4.504 Vali Acc: 0.540 Test Loss: 4.504 Test Acc: 0.540
Validation loss decreased (-0.509977 --> -0.539955).  Saving model ...
Epoch: 17 cost time: 21.33151078224182
Epoch: 17, Steps: 18 | Train Loss: 0.339 Vali Loss: 6.688 Vali Acc: 0.480 Test Loss: 6.688 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.02328395843506
Epoch: 18, Steps: 18 | Train Loss: 0.429 Vali Loss: 6.319 Vali Acc: 0.550 Test Loss: 6.319 Test Acc: 0.550
Validation loss decreased (-0.539955 --> -0.549937).  Saving model ...
Epoch: 19 cost time: 21.111578941345215
Epoch: 19, Steps: 18 | Train Loss: 1.395 Vali Loss: 6.393 Vali Acc: 0.520 Test Loss: 6.393 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.01561975479126
Epoch: 20, Steps: 18 | Train Loss: 0.439 Vali Loss: 11.657 Vali Acc: 0.450 Test Loss: 11.657 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.33032989501953
Epoch: 21, Steps: 18 | Train Loss: 0.469 Vali Loss: 11.116 Vali Acc: 0.510 Test Loss: 11.116 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.033493041992188
Epoch: 22, Steps: 18 | Train Loss: 0.483 Vali Loss: 9.611 Vali Acc: 0.530 Test Loss: 9.611 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 20.417698621749878
Epoch: 23, Steps: 18 | Train Loss: 0.223 Vali Loss: 10.261 Vali Acc: 0.460 Test Loss: 10.261 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 21.172075986862183
Epoch: 24, Steps: 18 | Train Loss: 0.206 Vali Loss: 7.904 Vali Acc: 0.540 Test Loss: 7.904 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 21.471741437911987
Epoch: 25, Steps: 18 | Train Loss: 0.401 Vali Loss: 7.620 Vali Acc: 0.540 Test Loss: 7.620 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 20.627732515335083
Epoch: 26, Steps: 18 | Train Loss: 0.411 Vali Loss: 9.821 Vali Acc: 0.500 Test Loss: 9.821 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 20.274609804153442
Epoch: 27, Steps: 18 | Train Loss: 0.292 Vali Loss: 10.206 Vali Acc: 0.480 Test Loss: 10.206 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 19.31311559677124
Epoch: 28, Steps: 18 | Train Loss: 0.329 Vali Loss: 9.796 Vali Acc: 0.500 Test Loss: 9.796 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6842230
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.203455209732056
Epoch: 1, Steps: 18 | Train Loss: 0.876 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 15.095544338226318
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 1.893 Vali Acc: 0.500 Test Loss: 1.893 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.469669818878174
Epoch: 3, Steps: 18 | Train Loss: 0.956 Vali Loss: 1.583 Vali Acc: 0.530 Test Loss: 1.583 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529984).  Saving model ...
Epoch: 4 cost time: 20.5874502658844
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 2.486 Vali Acc: 0.490 Test Loss: 2.486 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.67303466796875
Epoch: 5, Steps: 18 | Train Loss: 1.033 Vali Loss: 1.684 Vali Acc: 0.520 Test Loss: 1.684 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.44575572013855
Epoch: 6, Steps: 18 | Train Loss: 0.562 Vali Loss: 1.589 Vali Acc: 0.440 Test Loss: 1.589 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.85916018486023
Epoch: 7, Steps: 18 | Train Loss: 0.361 Vali Loss: 2.354 Vali Acc: 0.470 Test Loss: 2.354 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.009661436080933
Epoch: 8, Steps: 18 | Train Loss: 0.599 Vali Loss: 2.978 Vali Acc: 0.470 Test Loss: 2.978 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.28673267364502
Epoch: 9, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.293 Vali Acc: 0.560 Test Loss: 2.293 Test Acc: 0.560
Validation loss decreased (-0.529984 --> -0.559977).  Saving model ...
Epoch: 10 cost time: 15.229622602462769
Epoch: 10, Steps: 18 | Train Loss: 1.035 Vali Loss: 5.008 Vali Acc: 0.450 Test Loss: 5.008 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.391855716705322
Epoch: 11, Steps: 18 | Train Loss: 0.629 Vali Loss: 3.764 Vali Acc: 0.530 Test Loss: 3.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.054089069366455
Epoch: 12, Steps: 18 | Train Loss: 0.717 Vali Loss: 6.213 Vali Acc: 0.580 Test Loss: 6.213 Test Acc: 0.580
Validation loss decreased (-0.559977 --> -0.579938).  Saving model ...
Epoch: 13 cost time: 14.329849481582642
Epoch: 13, Steps: 18 | Train Loss: 0.519 Vali Loss: 5.616 Vali Acc: 0.540 Test Loss: 5.616 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.566448211669922
Epoch: 14, Steps: 18 | Train Loss: 0.288 Vali Loss: 3.782 Vali Acc: 0.490 Test Loss: 3.782 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 15.281217098236084
Epoch: 15, Steps: 18 | Train Loss: 0.272 Vali Loss: 6.902 Vali Acc: 0.490 Test Loss: 6.902 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.14416742324829
Epoch: 16, Steps: 18 | Train Loss: 0.490 Vali Loss: 5.837 Vali Acc: 0.500 Test Loss: 5.837 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.22517704963684
Epoch: 17, Steps: 18 | Train Loss: 0.630 Vali Loss: 17.811 Vali Acc: 0.430 Test Loss: 17.811 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 16.195611715316772
Epoch: 18, Steps: 18 | Train Loss: 1.913 Vali Loss: 7.585 Vali Acc: 0.570 Test Loss: 7.585 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.341253757476807
Epoch: 19, Steps: 18 | Train Loss: 0.650 Vali Loss: 6.658 Vali Acc: 0.540 Test Loss: 6.658 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.793416738510132
Epoch: 20, Steps: 18 | Train Loss: 0.389 Vali Loss: 6.855 Vali Acc: 0.510 Test Loss: 6.855 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.852703094482422
Epoch: 21, Steps: 18 | Train Loss: 0.184 Vali Loss: 5.874 Vali Acc: 0.540 Test Loss: 5.874 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.178605556488037
Epoch: 22, Steps: 18 | Train Loss: 0.099 Vali Loss: 10.147 Vali Acc: 0.560 Test Loss: 10.147 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6765430
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.863665580749512
Epoch: 1, Steps: 18 | Train Loss: 0.942 Vali Loss: 1.191 Vali Acc: 0.470 Test Loss: 1.191 Test Acc: 0.470
Validation loss decreased (inf --> -0.469988).  Saving model ...
Epoch: 2 cost time: 10.082024335861206
Epoch: 2, Steps: 18 | Train Loss: 1.064 Vali Loss: 1.201 Vali Acc: 0.530 Test Loss: 1.201 Test Acc: 0.530
Validation loss decreased (-0.469988 --> -0.529988).  Saving model ...
Epoch: 3 cost time: 10.215994119644165
Epoch: 3, Steps: 18 | Train Loss: 1.304 Vali Loss: 2.257 Vali Acc: 0.550 Test Loss: 2.257 Test Acc: 0.550
Validation loss decreased (-0.529988 --> -0.549977).  Saving model ...
Epoch: 4 cost time: 10.728111505508423
Epoch: 4, Steps: 18 | Train Loss: 0.972 Vali Loss: 1.393 Vali Acc: 0.490 Test Loss: 1.393 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.91814923286438
Epoch: 5, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.324588060379028
Epoch: 6, Steps: 18 | Train Loss: 1.031 Vali Loss: 2.568 Vali Acc: 0.620 Test Loss: 2.568 Test Acc: 0.620
Validation loss decreased (-0.549977 --> -0.619974).  Saving model ...
Epoch: 7 cost time: 10.306854486465454
Epoch: 7, Steps: 18 | Train Loss: 0.726 Vali Loss: 3.667 Vali Acc: 0.520 Test Loss: 3.667 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.468262195587158
Epoch: 8, Steps: 18 | Train Loss: 0.618 Vali Loss: 2.116 Vali Acc: 0.540 Test Loss: 2.116 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.315487623214722
Epoch: 9, Steps: 18 | Train Loss: 0.335 Vali Loss: 2.079 Vali Acc: 0.490 Test Loss: 2.079 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.629940032958984
Epoch: 10, Steps: 18 | Train Loss: 0.172 Vali Loss: 3.709 Vali Acc: 0.540 Test Loss: 3.709 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.625360488891602
Epoch: 11, Steps: 18 | Train Loss: 0.475 Vali Loss: 3.621 Vali Acc: 0.460 Test Loss: 3.621 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.204572677612305
Epoch: 12, Steps: 18 | Train Loss: 0.885 Vali Loss: 3.732 Vali Acc: 0.580 Test Loss: 3.732 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.310341358184814
Epoch: 13, Steps: 18 | Train Loss: 0.882 Vali Loss: 10.135 Vali Acc: 0.480 Test Loss: 10.135 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.284667491912842
Epoch: 14, Steps: 18 | Train Loss: 1.371 Vali Loss: 5.560 Vali Acc: 0.570 Test Loss: 5.560 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.10921025276184
Epoch: 15, Steps: 18 | Train Loss: 0.301 Vali Loss: 5.970 Vali Acc: 0.440 Test Loss: 5.970 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.44323468208313
Epoch: 16, Steps: 18 | Train Loss: 1.222 Vali Loss: 8.266 Vali Acc: 0.460 Test Loss: 8.266 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6688630
model size : 25.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.117456436157227
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 7.263957977294922
Epoch: 2, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.785 Vali Acc: 0.550 Test Loss: 1.785 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 6.668609619140625
Epoch: 3, Steps: 18 | Train Loss: 0.685 Vali Loss: 2.669 Vali Acc: 0.470 Test Loss: 2.669 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.689473390579224
Epoch: 4, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.364 Vali Acc: 0.540 Test Loss: 1.364 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.28974461555481
Epoch: 5, Steps: 18 | Train Loss: 0.757 Vali Loss: 3.674 Vali Acc: 0.450 Test Loss: 3.674 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.1809563636779785
Epoch: 6, Steps: 18 | Train Loss: 0.666 Vali Loss: 5.273 Vali Acc: 0.490 Test Loss: 5.273 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.901578187942505
Epoch: 7, Steps: 18 | Train Loss: 0.731 Vali Loss: 4.224 Vali Acc: 0.490 Test Loss: 4.224 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.911675453186035
Epoch: 8, Steps: 18 | Train Loss: 0.760 Vali Loss: 2.921 Vali Acc: 0.540 Test Loss: 2.921 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.839723110198975
Epoch: 9, Steps: 18 | Train Loss: 0.435 Vali Loss: 3.255 Vali Acc: 0.590 Test Loss: 3.255 Test Acc: 0.590
Validation loss decreased (-0.549982 --> -0.589967).  Saving model ...
Epoch: 10 cost time: 6.468744993209839
Epoch: 10, Steps: 18 | Train Loss: 0.593 Vali Loss: 3.340 Vali Acc: 0.630 Test Loss: 3.340 Test Acc: 0.630
Validation loss decreased (-0.589967 --> -0.629967).  Saving model ...
Epoch: 11 cost time: 6.8836588859558105
Epoch: 11, Steps: 18 | Train Loss: 0.468 Vali Loss: 3.981 Vali Acc: 0.610 Test Loss: 3.981 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.848790168762207
Epoch: 12, Steps: 18 | Train Loss: 0.533 Vali Loss: 3.798 Vali Acc: 0.530 Test Loss: 3.798 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.414489269256592
Epoch: 13, Steps: 18 | Train Loss: 0.493 Vali Loss: 9.714 Vali Acc: 0.510 Test Loss: 9.714 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.988062620162964
Epoch: 14, Steps: 18 | Train Loss: 0.440 Vali Loss: 7.800 Vali Acc: 0.510 Test Loss: 7.800 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.534336566925049
Epoch: 15, Steps: 18 | Train Loss: 0.211 Vali Loss: 6.814 Vali Acc: 0.540 Test Loss: 6.814 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.715492248535156
Epoch: 16, Steps: 18 | Train Loss: 0.318 Vali Loss: 6.717 Vali Acc: 0.500 Test Loss: 6.717 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.455695390701294
Epoch: 17, Steps: 18 | Train Loss: 0.681 Vali Loss: 9.539 Vali Acc: 0.510 Test Loss: 9.539 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.321483850479126
Epoch: 18, Steps: 18 | Train Loss: 0.670 Vali Loss: 9.453 Vali Acc: 0.470 Test Loss: 9.453 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.353774785995483
Epoch: 19, Steps: 18 | Train Loss: 0.320 Vali Loss: 10.788 Vali Acc: 0.490 Test Loss: 10.788 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.96770715713501
Epoch: 20, Steps: 18 | Train Loss: 0.111 Vali Loss: 11.907 Vali Acc: 0.530 Test Loss: 11.907 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6627190
model size : 25.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.854976654052734
Epoch: 1, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.145 Vali Acc: 0.480 Test Loss: 1.145 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 4.8196446895599365
Epoch: 2, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
Validation loss decreased (-0.479989 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 5.165984869003296
Epoch: 3, Steps: 18 | Train Loss: 1.116 Vali Loss: 1.879 Vali Acc: 0.580 Test Loss: 1.879 Test Acc: 0.580
Validation loss decreased (-0.499991 --> -0.579981).  Saving model ...
Epoch: 4 cost time: 5.168986082077026
Epoch: 4, Steps: 18 | Train Loss: 1.299 Vali Loss: 2.170 Vali Acc: 0.530 Test Loss: 2.170 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.129866600036621
Epoch: 5, Steps: 18 | Train Loss: 1.011 Vali Loss: 2.222 Vali Acc: 0.530 Test Loss: 2.222 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.795783519744873
Epoch: 6, Steps: 18 | Train Loss: 1.099 Vali Loss: 2.942 Vali Acc: 0.480 Test Loss: 2.942 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.997698545455933
Epoch: 7, Steps: 18 | Train Loss: 0.673 Vali Loss: 2.759 Vali Acc: 0.460 Test Loss: 2.759 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.217100143432617
Epoch: 8, Steps: 18 | Train Loss: 1.087 Vali Loss: 2.726 Vali Acc: 0.510 Test Loss: 2.726 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.251619577407837
Epoch: 9, Steps: 18 | Train Loss: 0.512 Vali Loss: 4.866 Vali Acc: 0.570 Test Loss: 4.866 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.043820142745972
Epoch: 10, Steps: 18 | Train Loss: 1.181 Vali Loss: 4.674 Vali Acc: 0.560 Test Loss: 4.674 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.795859336853027
Epoch: 11, Steps: 18 | Train Loss: 0.936 Vali Loss: 3.717 Vali Acc: 0.540 Test Loss: 3.717 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.86456298828125
Epoch: 12, Steps: 18 | Train Loss: 0.329 Vali Loss: 4.086 Vali Acc: 0.510 Test Loss: 4.086 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.901564836502075
Epoch: 13, Steps: 18 | Train Loss: 0.887 Vali Loss: 5.121 Vali Acc: 0.500 Test Loss: 5.121 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6596470
model size : 25.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.364054203033447
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 3.2086849212646484
Epoch: 2, Steps: 18 | Train Loss: 0.725 Vali Loss: 1.037 Vali Acc: 0.500 Test Loss: 1.037 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.077319860458374
Epoch: 3, Steps: 18 | Train Loss: 0.876 Vali Loss: 1.296 Vali Acc: 0.490 Test Loss: 1.296 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3447823524475098
Epoch: 4, Steps: 18 | Train Loss: 0.746 Vali Loss: 1.464 Vali Acc: 0.600 Test Loss: 1.464 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 3.2336630821228027
Epoch: 5, Steps: 18 | Train Loss: 0.663 Vali Loss: 2.675 Vali Acc: 0.470 Test Loss: 2.675 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.359381675720215
Epoch: 6, Steps: 18 | Train Loss: 0.828 Vali Loss: 2.025 Vali Acc: 0.470 Test Loss: 2.025 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4371235370635986
Epoch: 7, Steps: 18 | Train Loss: 0.610 Vali Loss: 2.598 Vali Acc: 0.480 Test Loss: 2.598 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.166743755340576
Epoch: 8, Steps: 18 | Train Loss: 0.990 Vali Loss: 5.556 Vali Acc: 0.510 Test Loss: 5.556 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.536879777908325
Epoch: 9, Steps: 18 | Train Loss: 0.813 Vali Loss: 4.086 Vali Acc: 0.450 Test Loss: 4.086 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.336834669113159
Epoch: 10, Steps: 18 | Train Loss: 0.347 Vali Loss: 5.248 Vali Acc: 0.500 Test Loss: 5.248 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.346853494644165
Epoch: 11, Steps: 18 | Train Loss: 0.514 Vali Loss: 4.524 Vali Acc: 0.580 Test Loss: 4.524 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1654181480407715
Epoch: 12, Steps: 18 | Train Loss: 0.358 Vali Loss: 4.740 Vali Acc: 0.480 Test Loss: 4.740 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.393920421600342
Epoch: 13, Steps: 18 | Train Loss: 0.347 Vali Loss: 3.771 Vali Acc: 0.500 Test Loss: 3.771 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.057194471359253
Epoch: 14, Steps: 18 | Train Loss: 0.949 Vali Loss: 8.045 Vali Acc: 0.520 Test Loss: 8.045 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6565750
model size : 25.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.642716407775879
Epoch: 1, Steps: 18 | Train Loss: 1.012 Vali Loss: 0.905 Vali Acc: 0.510 Test Loss: 0.905 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 1.5302734375
Epoch: 2, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.764 Vali Acc: 0.510 Test Loss: 1.764 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3809139728546143
Epoch: 3, Steps: 18 | Train Loss: 0.680 Vali Loss: 1.542 Vali Acc: 0.630 Test Loss: 1.542 Test Acc: 0.630
Validation loss decreased (-0.509991 --> -0.629985).  Saving model ...
Epoch: 4 cost time: 1.6368803977966309
Epoch: 4, Steps: 18 | Train Loss: 0.813 Vali Loss: 5.922 Vali Acc: 0.500 Test Loss: 5.922 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.588430643081665
Epoch: 5, Steps: 18 | Train Loss: 1.913 Vali Loss: 2.350 Vali Acc: 0.470 Test Loss: 2.350 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5231618881225586
Epoch: 6, Steps: 18 | Train Loss: 0.934 Vali Loss: 3.295 Vali Acc: 0.520 Test Loss: 3.295 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6050875186920166
Epoch: 7, Steps: 18 | Train Loss: 0.435 Vali Loss: 3.136 Vali Acc: 0.540 Test Loss: 3.136 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5286240577697754
Epoch: 8, Steps: 18 | Train Loss: 0.801 Vali Loss: 3.418 Vali Acc: 0.510 Test Loss: 3.418 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4254634380340576
Epoch: 9, Steps: 18 | Train Loss: 1.037 Vali Loss: 4.060 Vali Acc: 0.570 Test Loss: 4.060 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3687629699707031
Epoch: 10, Steps: 18 | Train Loss: 0.453 Vali Loss: 2.670 Vali Acc: 0.540 Test Loss: 2.670 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.573103904724121
Epoch: 11, Steps: 18 | Train Loss: 0.473 Vali Loss: 7.970 Vali Acc: 0.460 Test Loss: 7.970 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5529232025146484
Epoch: 12, Steps: 18 | Train Loss: 0.882 Vali Loss: 4.094 Vali Acc: 0.510 Test Loss: 4.094 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5426647663116455
Epoch: 13, Steps: 18 | Train Loss: 0.926 Vali Loss: 6.524 Vali Acc: 0.480 Test Loss: 6.524 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6536054
model size : 24.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.984864950180054
Epoch: 1, Steps: 18 | Train Loss: 0.834 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 24.23909068107605
Epoch: 2, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.249 Vali Acc: 0.530 Test Loss: 1.249 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.78588891029358
Epoch: 3, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.670 Vali Acc: 0.500 Test Loss: 1.670 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.99857187271118
Epoch: 4, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.263 Vali Acc: 0.480 Test Loss: 2.263 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 25.617854595184326
Epoch: 5, Steps: 18 | Train Loss: 0.381 Vali Loss: 2.953 Vali Acc: 0.490 Test Loss: 2.953 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.10139536857605
Epoch: 6, Steps: 18 | Train Loss: 0.414 Vali Loss: 4.014 Vali Acc: 0.460 Test Loss: 4.014 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.685786962509155
Epoch: 7, Steps: 18 | Train Loss: 0.271 Vali Loss: 2.628 Vali Acc: 0.580 Test Loss: 2.628 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579974).  Saving model ...
Epoch: 8 cost time: 27.731462001800537
Epoch: 8, Steps: 18 | Train Loss: 0.450 Vali Loss: 4.182 Vali Acc: 0.550 Test Loss: 4.182 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.58480930328369
Epoch: 9, Steps: 18 | Train Loss: 1.094 Vali Loss: 4.047 Vali Acc: 0.530 Test Loss: 4.047 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.78585386276245
Epoch: 10, Steps: 18 | Train Loss: 0.460 Vali Loss: 4.552 Vali Acc: 0.540 Test Loss: 4.552 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.000789403915405
Epoch: 11, Steps: 18 | Train Loss: 0.510 Vali Loss: 4.979 Vali Acc: 0.500 Test Loss: 4.979 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 26.17069125175476
Epoch: 12, Steps: 18 | Train Loss: 1.010 Vali Loss: 6.185 Vali Acc: 0.540 Test Loss: 6.185 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.418947458267212
Epoch: 13, Steps: 18 | Train Loss: 0.178 Vali Loss: 6.374 Vali Acc: 0.520 Test Loss: 6.374 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.21150040626526
Epoch: 14, Steps: 18 | Train Loss: 0.567 Vali Loss: 5.150 Vali Acc: 0.550 Test Loss: 5.150 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 25.80859637260437
Epoch: 15, Steps: 18 | Train Loss: 0.436 Vali Loss: 5.239 Vali Acc: 0.530 Test Loss: 5.239 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 25.22377371788025
Epoch: 16, Steps: 18 | Train Loss: 0.709 Vali Loss: 5.883 Vali Acc: 0.540 Test Loss: 5.883 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 25.049195528030396
Epoch: 17, Steps: 18 | Train Loss: 0.295 Vali Loss: 4.935 Vali Acc: 0.570 Test Loss: 4.935 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6918386
model size : 27.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.720080852508545
Epoch: 1, Steps: 18 | Train Loss: 0.941 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 19.495360851287842
Epoch: 2, Steps: 18 | Train Loss: 0.745 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 19.0998477935791
Epoch: 3, Steps: 18 | Train Loss: 0.331 Vali Loss: 2.280 Vali Acc: 0.520 Test Loss: 2.280 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.035245180130005
Epoch: 4, Steps: 18 | Train Loss: 0.480 Vali Loss: 2.271 Vali Acc: 0.560 Test Loss: 2.271 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559977).  Saving model ...
Epoch: 5 cost time: 19.86475133895874
Epoch: 5, Steps: 18 | Train Loss: 0.826 Vali Loss: 2.933 Vali Acc: 0.480 Test Loss: 2.933 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.712139129638672
Epoch: 6, Steps: 18 | Train Loss: 0.624 Vali Loss: 3.157 Vali Acc: 0.470 Test Loss: 3.157 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.15950632095337
Epoch: 7, Steps: 18 | Train Loss: 0.303 Vali Loss: 4.766 Vali Acc: 0.560 Test Loss: 4.766 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.58614158630371
Epoch: 8, Steps: 18 | Train Loss: 0.527 Vali Loss: 3.341 Vali Acc: 0.550 Test Loss: 3.341 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.15725302696228
Epoch: 9, Steps: 18 | Train Loss: 1.025 Vali Loss: 4.362 Vali Acc: 0.530 Test Loss: 4.362 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.081496953964233
Epoch: 10, Steps: 18 | Train Loss: 0.499 Vali Loss: 2.966 Vali Acc: 0.630 Test Loss: 2.966 Test Acc: 0.630
Validation loss decreased (-0.559977 --> -0.629970).  Saving model ...
Epoch: 11 cost time: 19.526347637176514
Epoch: 11, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.869 Vali Acc: 0.490 Test Loss: 3.869 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.373390913009644
Epoch: 12, Steps: 18 | Train Loss: 0.170 Vali Loss: 3.949 Vali Acc: 0.460 Test Loss: 3.949 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.63377618789673
Epoch: 13, Steps: 18 | Train Loss: 0.403 Vali Loss: 5.309 Vali Acc: 0.530 Test Loss: 5.309 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.85590934753418
Epoch: 14, Steps: 18 | Train Loss: 0.438 Vali Loss: 10.415 Vali Acc: 0.520 Test Loss: 10.415 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.08557939529419
Epoch: 15, Steps: 18 | Train Loss: 0.473 Vali Loss: 5.130 Vali Acc: 0.560 Test Loss: 5.130 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 19.154302835464478
Epoch: 16, Steps: 18 | Train Loss: 0.416 Vali Loss: 5.093 Vali Acc: 0.490 Test Loss: 5.093 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.781795263290405
Epoch: 17, Steps: 18 | Train Loss: 0.225 Vali Loss: 5.435 Vali Acc: 0.540 Test Loss: 5.435 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.419635772705078
Epoch: 18, Steps: 18 | Train Loss: 0.835 Vali Loss: 10.404 Vali Acc: 0.470 Test Loss: 10.404 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.470823526382446
Epoch: 19, Steps: 18 | Train Loss: 1.803 Vali Loss: 10.937 Vali Acc: 0.470 Test Loss: 10.937 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 18.627400875091553
Epoch: 20, Steps: 18 | Train Loss: 0.803 Vali Loss: 8.734 Vali Acc: 0.520 Test Loss: 8.734 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6841586
model size : 27.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.639972686767578
Epoch: 1, Steps: 18 | Train Loss: 0.869 Vali Loss: 0.901 Vali Acc: 0.570 Test Loss: 0.901 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 13.881794929504395
Epoch: 2, Steps: 18 | Train Loss: 0.597 Vali Loss: 1.165 Vali Acc: 0.530 Test Loss: 1.165 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.671074628829956
Epoch: 3, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.251 Vali Acc: 0.490 Test Loss: 1.251 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.348649978637695
Epoch: 4, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.644 Vali Acc: 0.590 Test Loss: 1.644 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589984).  Saving model ...
Epoch: 5 cost time: 14.340853214263916
Epoch: 5, Steps: 18 | Train Loss: 0.342 Vali Loss: 3.555 Vali Acc: 0.530 Test Loss: 3.555 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.001548767089844
Epoch: 6, Steps: 18 | Train Loss: 0.429 Vali Loss: 5.804 Vali Acc: 0.510 Test Loss: 5.804 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.37453842163086
Epoch: 7, Steps: 18 | Train Loss: 1.022 Vali Loss: 5.717 Vali Acc: 0.470 Test Loss: 5.717 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.676849842071533
Epoch: 8, Steps: 18 | Train Loss: 0.872 Vali Loss: 5.407 Vali Acc: 0.580 Test Loss: 5.407 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.561608076095581
Epoch: 9, Steps: 18 | Train Loss: 0.332 Vali Loss: 5.078 Vali Acc: 0.480 Test Loss: 5.078 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.584707260131836
Epoch: 10, Steps: 18 | Train Loss: 0.240 Vali Loss: 4.075 Vali Acc: 0.550 Test Loss: 4.075 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.3161461353302
Epoch: 11, Steps: 18 | Train Loss: 0.386 Vali Loss: 3.892 Vali Acc: 0.530 Test Loss: 3.892 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.801854133605957
Epoch: 12, Steps: 18 | Train Loss: 0.447 Vali Loss: 4.968 Vali Acc: 0.560 Test Loss: 4.968 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.14006233215332
Epoch: 13, Steps: 18 | Train Loss: 0.891 Vali Loss: 5.657 Vali Acc: 0.520 Test Loss: 5.657 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.525553464889526
Epoch: 14, Steps: 18 | Train Loss: 0.728 Vali Loss: 6.229 Vali Acc: 0.510 Test Loss: 6.229 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6764786
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.377398252487183
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 0.977 Vali Acc: 0.490 Test Loss: 0.977 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 10.283892393112183
Epoch: 2, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.359 Vali Acc: 0.550 Test Loss: 1.359 Test Acc: 0.550
Validation loss decreased (-0.489990 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 9.737514972686768
Epoch: 3, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.354 Vali Acc: 0.540 Test Loss: 1.354 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.21256160736084
Epoch: 4, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.937 Vali Acc: 0.550 Test Loss: 1.937 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.430181980133057
Epoch: 5, Steps: 18 | Train Loss: 0.420 Vali Loss: 2.454 Vali Acc: 0.540 Test Loss: 2.454 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.096275091171265
Epoch: 6, Steps: 18 | Train Loss: 0.295 Vali Loss: 2.942 Vali Acc: 0.500 Test Loss: 2.942 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.106666088104248
Epoch: 7, Steps: 18 | Train Loss: 0.335 Vali Loss: 3.644 Vali Acc: 0.510 Test Loss: 3.644 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.714825630187988
Epoch: 8, Steps: 18 | Train Loss: 0.301 Vali Loss: 6.005 Vali Acc: 0.460 Test Loss: 6.005 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.222148656845093
Epoch: 9, Steps: 18 | Train Loss: 0.484 Vali Loss: 5.613 Vali Acc: 0.440 Test Loss: 5.613 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.102973699569702
Epoch: 10, Steps: 18 | Train Loss: 0.422 Vali Loss: 4.991 Vali Acc: 0.490 Test Loss: 4.991 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.759284734725952
Epoch: 11, Steps: 18 | Train Loss: 0.762 Vali Loss: 5.042 Vali Acc: 0.520 Test Loss: 5.042 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.163495540618896
Epoch: 12, Steps: 18 | Train Loss: 1.005 Vali Loss: 3.627 Vali Acc: 0.520 Test Loss: 3.627 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6687986
model size : 25.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.884638071060181
Epoch: 1, Steps: 18 | Train Loss: 0.884 Vali Loss: 1.421 Vali Acc: 0.470 Test Loss: 1.421 Test Acc: 0.470
Validation loss decreased (inf --> -0.469986).  Saving model ...
Epoch: 2 cost time: 6.570652484893799
Epoch: 2, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.912 Vali Acc: 0.590 Test Loss: 0.912 Test Acc: 0.590
Validation loss decreased (-0.469986 --> -0.589991).  Saving model ...
Epoch: 3 cost time: 6.253035545349121
Epoch: 3, Steps: 18 | Train Loss: 0.441 Vali Loss: 2.237 Vali Acc: 0.460 Test Loss: 2.237 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.6984169483184814
Epoch: 4, Steps: 18 | Train Loss: 0.368 Vali Loss: 3.007 Vali Acc: 0.480 Test Loss: 3.007 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.447477579116821
Epoch: 5, Steps: 18 | Train Loss: 0.371 Vali Loss: 2.972 Vali Acc: 0.580 Test Loss: 2.972 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.309080123901367
Epoch: 6, Steps: 18 | Train Loss: 0.524 Vali Loss: 2.791 Vali Acc: 0.630 Test Loss: 2.791 Test Acc: 0.630
Validation loss decreased (-0.589991 --> -0.629972).  Saving model ...
Epoch: 7 cost time: 6.615130424499512
Epoch: 7, Steps: 18 | Train Loss: 0.313 Vali Loss: 2.886 Vali Acc: 0.530 Test Loss: 2.886 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.174434661865234
Epoch: 8, Steps: 18 | Train Loss: 0.248 Vali Loss: 3.948 Vali Acc: 0.530 Test Loss: 3.948 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.892500400543213
Epoch: 9, Steps: 18 | Train Loss: 0.399 Vali Loss: 4.194 Vali Acc: 0.450 Test Loss: 4.194 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.253183841705322
Epoch: 10, Steps: 18 | Train Loss: 0.621 Vali Loss: 4.530 Vali Acc: 0.520 Test Loss: 4.530 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.568827390670776
Epoch: 11, Steps: 18 | Train Loss: 0.332 Vali Loss: 3.273 Vali Acc: 0.600 Test Loss: 3.273 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.272994756698608
Epoch: 12, Steps: 18 | Train Loss: 0.622 Vali Loss: 4.924 Vali Acc: 0.590 Test Loss: 4.924 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.505735635757446
Epoch: 13, Steps: 18 | Train Loss: 0.395 Vali Loss: 5.151 Vali Acc: 0.480 Test Loss: 5.151 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.43578577041626
Epoch: 14, Steps: 18 | Train Loss: 0.743 Vali Loss: 5.919 Vali Acc: 0.480 Test Loss: 5.919 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.414740085601807
Epoch: 15, Steps: 18 | Train Loss: 0.523 Vali Loss: 7.413 Vali Acc: 0.500 Test Loss: 7.413 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.375282287597656
Epoch: 16, Steps: 18 | Train Loss: 0.687 Vali Loss: 6.945 Vali Acc: 0.500 Test Loss: 6.945 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6626546
model size : 25.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.226715564727783
Epoch: 1, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 4.780541181564331
Epoch: 2, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.352 Vali Acc: 0.480 Test Loss: 1.352 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.639119625091553
Epoch: 3, Steps: 18 | Train Loss: 0.206 Vali Loss: 2.116 Vali Acc: 0.520 Test Loss: 2.116 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.727301597595215
Epoch: 4, Steps: 18 | Train Loss: 0.332 Vali Loss: 2.103 Vali Acc: 0.500 Test Loss: 2.103 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.596342325210571
Epoch: 5, Steps: 18 | Train Loss: 0.398 Vali Loss: 2.603 Vali Acc: 0.550 Test Loss: 2.603 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.69683837890625
Epoch: 6, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.575 Vali Acc: 0.510 Test Loss: 2.575 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.786957025527954
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 7.261 Vali Acc: 0.480 Test Loss: 7.261 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.7681355476379395
Epoch: 8, Steps: 18 | Train Loss: 0.685 Vali Loss: 5.015 Vali Acc: 0.490 Test Loss: 5.015 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.68956995010376
Epoch: 9, Steps: 18 | Train Loss: 1.031 Vali Loss: 4.724 Vali Acc: 0.540 Test Loss: 4.724 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.676695346832275
Epoch: 10, Steps: 18 | Train Loss: 0.783 Vali Loss: 4.490 Vali Acc: 0.510 Test Loss: 4.490 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.536777019500732
Epoch: 11, Steps: 18 | Train Loss: 0.219 Vali Loss: 5.492 Vali Acc: 0.470 Test Loss: 5.492 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6595826
model size : 25.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.513812780380249
Epoch: 1, Steps: 18 | Train Loss: 0.909 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 2.9988787174224854
Epoch: 2, Steps: 18 | Train Loss: 0.498 Vali Loss: 2.612 Vali Acc: 0.500 Test Loss: 2.612 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0318996906280518
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 1.648 Vali Acc: 0.490 Test Loss: 1.648 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0029797554016113
Epoch: 4, Steps: 18 | Train Loss: 0.737 Vali Loss: 2.971 Vali Acc: 0.580 Test Loss: 2.971 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9256606101989746
Epoch: 5, Steps: 18 | Train Loss: 1.468 Vali Loss: 3.793 Vali Acc: 0.470 Test Loss: 3.793 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.990455150604248
Epoch: 6, Steps: 18 | Train Loss: 0.595 Vali Loss: 5.806 Vali Acc: 0.530 Test Loss: 5.806 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7621753215789795
Epoch: 7, Steps: 18 | Train Loss: 0.521 Vali Loss: 3.886 Vali Acc: 0.520 Test Loss: 3.886 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.925861120223999
Epoch: 8, Steps: 18 | Train Loss: 0.613 Vali Loss: 5.886 Vali Acc: 0.560 Test Loss: 5.886 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8742125034332275
Epoch: 9, Steps: 18 | Train Loss: 0.645 Vali Loss: 6.035 Vali Acc: 0.490 Test Loss: 6.035 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.851231098175049
Epoch: 10, Steps: 18 | Train Loss: 0.456 Vali Loss: 7.311 Vali Acc: 0.500 Test Loss: 7.311 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.948326826095581
Epoch: 11, Steps: 18 | Train Loss: 0.596 Vali Loss: 5.219 Vali Acc: 0.460 Test Loss: 5.219 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6565106
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.4407577514648438
Epoch: 1, Steps: 18 | Train Loss: 0.978 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 1.2651481628417969
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.130 Vali Acc: 0.540 Test Loss: 1.130 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 1.385540246963501
Epoch: 3, Steps: 18 | Train Loss: 0.797 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.298201560974121
Epoch: 4, Steps: 18 | Train Loss: 1.227 Vali Loss: 2.813 Vali Acc: 0.540 Test Loss: 2.813 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3681602478027344
Epoch: 5, Steps: 18 | Train Loss: 0.737 Vali Loss: 3.194 Vali Acc: 0.450 Test Loss: 3.194 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.324528694152832
Epoch: 6, Steps: 18 | Train Loss: 0.901 Vali Loss: 3.210 Vali Acc: 0.590 Test Loss: 3.210 Test Acc: 0.590
Validation loss decreased (-0.539989 --> -0.589968).  Saving model ...
Epoch: 7 cost time: 1.3515784740447998
Epoch: 7, Steps: 18 | Train Loss: 0.691 Vali Loss: 2.567 Vali Acc: 0.510 Test Loss: 2.567 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3221156597137451
Epoch: 8, Steps: 18 | Train Loss: 1.146 Vali Loss: 3.181 Vali Acc: 0.450 Test Loss: 3.181 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.396693468093872
Epoch: 9, Steps: 18 | Train Loss: 1.970 Vali Loss: 5.113 Vali Acc: 0.430 Test Loss: 5.113 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.328059196472168
Epoch: 10, Steps: 18 | Train Loss: 1.473 Vali Loss: 9.135 Vali Acc: 0.430 Test Loss: 9.135 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4095304012298584
Epoch: 11, Steps: 18 | Train Loss: 0.950 Vali Loss: 11.063 Vali Acc: 0.480 Test Loss: 11.063 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2789981365203857
Epoch: 12, Steps: 18 | Train Loss: 2.367 Vali Loss: 6.099 Vali Acc: 0.510 Test Loss: 6.099 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2663865089416504
Epoch: 13, Steps: 18 | Train Loss: 0.985 Vali Loss: 5.667 Vali Acc: 0.480 Test Loss: 5.667 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1556615829467773
Epoch: 14, Steps: 18 | Train Loss: 0.769 Vali Loss: 7.592 Vali Acc: 0.530 Test Loss: 7.592 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2300457954406738
Epoch: 15, Steps: 18 | Train Loss: 1.570 Vali Loss: 9.197 Vali Acc: 0.530 Test Loss: 9.197 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1592962741851807
Epoch: 16, Steps: 18 | Train Loss: 2.382 Vali Loss: 7.149 Vali Acc: 0.500 Test Loss: 7.149 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6535410
model size : 24.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.51198410987854
Epoch: 1, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 24.626355409622192
Epoch: 2, Steps: 18 | Train Loss: 0.794 Vali Loss: 1.886 Vali Acc: 0.480 Test Loss: 1.886 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.968485355377197
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 1.984 Vali Acc: 0.620 Test Loss: 1.984 Test Acc: 0.620
Validation loss decreased (-0.529991 --> -0.619980).  Saving model ...
Epoch: 4 cost time: 24.920471906661987
Epoch: 4, Steps: 18 | Train Loss: 0.864 Vali Loss: 2.219 Vali Acc: 0.490 Test Loss: 2.219 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.92848253250122
Epoch: 5, Steps: 18 | Train Loss: 0.855 Vali Loss: 2.687 Vali Acc: 0.600 Test Loss: 2.687 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.87469720840454
Epoch: 6, Steps: 18 | Train Loss: 0.563 Vali Loss: 4.587 Vali Acc: 0.490 Test Loss: 4.587 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.26438570022583
Epoch: 7, Steps: 18 | Train Loss: 0.927 Vali Loss: 2.562 Vali Acc: 0.510 Test Loss: 2.562 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.595372200012207
Epoch: 8, Steps: 18 | Train Loss: 0.418 Vali Loss: 3.379 Vali Acc: 0.490 Test Loss: 3.379 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.719892501831055
Epoch: 9, Steps: 18 | Train Loss: 0.643 Vali Loss: 3.347 Vali Acc: 0.540 Test Loss: 3.347 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.19136619567871
Epoch: 10, Steps: 18 | Train Loss: 0.471 Vali Loss: 3.336 Vali Acc: 0.570 Test Loss: 3.336 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.021328449249268
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 4.096 Vali Acc: 0.510 Test Loss: 4.096 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.908193588256836
Epoch: 12, Steps: 18 | Train Loss: 0.406 Vali Loss: 7.588 Vali Acc: 0.460 Test Loss: 7.588 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.411830186843872
Epoch: 13, Steps: 18 | Train Loss: 0.668 Vali Loss: 4.864 Vali Acc: 0.490 Test Loss: 4.864 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3662770
model size : 15.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.05730175971985
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 19.031002044677734
Epoch: 2, Steps: 18 | Train Loss: 1.047 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
Validation loss decreased (-0.499990 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 19.074023246765137
Epoch: 3, Steps: 18 | Train Loss: 0.769 Vali Loss: 2.109 Vali Acc: 0.470 Test Loss: 2.109 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.946367502212524
Epoch: 4, Steps: 18 | Train Loss: 1.006 Vali Loss: 2.840 Vali Acc: 0.490 Test Loss: 2.840 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.73350954055786
Epoch: 5, Steps: 18 | Train Loss: 0.718 Vali Loss: 2.179 Vali Acc: 0.530 Test Loss: 2.179 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.47803521156311
Epoch: 6, Steps: 18 | Train Loss: 0.908 Vali Loss: 3.531 Vali Acc: 0.510 Test Loss: 3.531 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.6225802898407
Epoch: 7, Steps: 18 | Train Loss: 0.753 Vali Loss: 2.777 Vali Acc: 0.430 Test Loss: 2.777 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.967469692230225
Epoch: 8, Steps: 18 | Train Loss: 0.368 Vali Loss: 3.151 Vali Acc: 0.480 Test Loss: 3.151 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.28260827064514
Epoch: 9, Steps: 18 | Train Loss: 0.619 Vali Loss: 3.505 Vali Acc: 0.480 Test Loss: 3.505 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.992867469787598
Epoch: 10, Steps: 18 | Train Loss: 0.239 Vali Loss: 3.807 Vali Acc: 0.510 Test Loss: 3.807 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.481027126312256
Epoch: 11, Steps: 18 | Train Loss: 0.322 Vali Loss: 3.575 Vali Acc: 0.500 Test Loss: 3.575 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 19.642165422439575
Epoch: 12, Steps: 18 | Train Loss: 0.791 Vali Loss: 7.491 Vali Acc: 0.480 Test Loss: 7.491 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3624370
model size : 14.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.901564121246338
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.049 Vali Acc: 0.470 Test Loss: 1.049 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 13.516266107559204
Epoch: 2, Steps: 18 | Train Loss: 0.810 Vali Loss: 1.043 Vali Acc: 0.550 Test Loss: 1.043 Test Acc: 0.550
Validation loss decreased (-0.469990 --> -0.549990).  Saving model ...
Epoch: 3 cost time: 14.152149438858032
Epoch: 3, Steps: 18 | Train Loss: 0.592 Vali Loss: 1.176 Vali Acc: 0.510 Test Loss: 1.176 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.905216693878174
Epoch: 4, Steps: 18 | Train Loss: 0.770 Vali Loss: 1.516 Vali Acc: 0.550 Test Loss: 1.516 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.929635047912598
Epoch: 5, Steps: 18 | Train Loss: 0.573 Vali Loss: 2.966 Vali Acc: 0.530 Test Loss: 2.966 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.485507011413574
Epoch: 6, Steps: 18 | Train Loss: 0.806 Vali Loss: 1.706 Vali Acc: 0.540 Test Loss: 1.706 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.70705246925354
Epoch: 7, Steps: 18 | Train Loss: 0.445 Vali Loss: 4.209 Vali Acc: 0.490 Test Loss: 4.209 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.354292869567871
Epoch: 8, Steps: 18 | Train Loss: 0.579 Vali Loss: 3.132 Vali Acc: 0.520 Test Loss: 3.132 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.665978193283081
Epoch: 9, Steps: 18 | Train Loss: 0.551 Vali Loss: 3.110 Vali Acc: 0.530 Test Loss: 3.110 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.764869689941406
Epoch: 10, Steps: 18 | Train Loss: 0.589 Vali Loss: 3.491 Vali Acc: 0.420 Test Loss: 3.491 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.055183172225952
Epoch: 11, Steps: 18 | Train Loss: 0.656 Vali Loss: 4.001 Vali Acc: 0.420 Test Loss: 4.001 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.38570237159729
Epoch: 12, Steps: 18 | Train Loss: 0.459 Vali Loss: 3.954 Vali Acc: 0.470 Test Loss: 3.954 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3585970
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.168412685394287
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.905 Vali Acc: 0.510 Test Loss: 0.905 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 10.790207624435425
Epoch: 2, Steps: 18 | Train Loss: 0.757 Vali Loss: 1.234 Vali Acc: 0.610 Test Loss: 1.234 Test Acc: 0.610
Validation loss decreased (-0.509991 --> -0.609988).  Saving model ...
Epoch: 3 cost time: 10.136873006820679
Epoch: 3, Steps: 18 | Train Loss: 1.013 Vali Loss: 2.423 Vali Acc: 0.530 Test Loss: 2.423 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.27017092704773
Epoch: 4, Steps: 18 | Train Loss: 0.492 Vali Loss: 2.161 Vali Acc: 0.550 Test Loss: 2.161 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.26103138923645
Epoch: 5, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.662 Vali Acc: 0.580 Test Loss: 1.662 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.464818477630615
Epoch: 6, Steps: 18 | Train Loss: 0.398 Vali Loss: 2.557 Vali Acc: 0.450 Test Loss: 2.557 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.97933316230774
Epoch: 7, Steps: 18 | Train Loss: 0.454 Vali Loss: 4.036 Vali Acc: 0.480 Test Loss: 4.036 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.415631294250488
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 4.195 Vali Acc: 0.520 Test Loss: 4.195 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.015218734741211
Epoch: 9, Steps: 18 | Train Loss: 0.468 Vali Loss: 5.322 Vali Acc: 0.460 Test Loss: 5.322 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.545505285263062
Epoch: 10, Steps: 18 | Train Loss: 0.697 Vali Loss: 3.510 Vali Acc: 0.470 Test Loss: 3.510 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.281612634658813
Epoch: 11, Steps: 18 | Train Loss: 0.465 Vali Loss: 8.408 Vali Acc: 0.520 Test Loss: 8.408 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.542572975158691
Epoch: 12, Steps: 18 | Train Loss: 0.589 Vali Loss: 4.413 Vali Acc: 0.540 Test Loss: 4.413 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3547570
model size : 14.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.849543571472168
Epoch: 1, Steps: 18 | Train Loss: 0.949 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 6.535017013549805
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 2.365 Vali Acc: 0.470 Test Loss: 2.365 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.573257684707642
Epoch: 3, Steps: 18 | Train Loss: 0.939 Vali Loss: 1.374 Vali Acc: 0.520 Test Loss: 1.374 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.91782283782959
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 4.260 Vali Acc: 0.440 Test Loss: 4.260 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.464179039001465
Epoch: 5, Steps: 18 | Train Loss: 1.135 Vali Loss: 4.375 Vali Acc: 0.450 Test Loss: 4.375 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.063194036483765
Epoch: 6, Steps: 18 | Train Loss: 2.265 Vali Loss: 4.452 Vali Acc: 0.560 Test Loss: 4.452 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559955).  Saving model ...
Epoch: 7 cost time: 6.894364356994629
Epoch: 7, Steps: 18 | Train Loss: 0.559 Vali Loss: 3.032 Vali Acc: 0.500 Test Loss: 3.032 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.732475519180298
Epoch: 8, Steps: 18 | Train Loss: 0.422 Vali Loss: 3.346 Vali Acc: 0.480 Test Loss: 3.346 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.211052894592285
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 3.003 Vali Acc: 0.520 Test Loss: 3.003 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.236731052398682
Epoch: 10, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.606 Vali Acc: 0.480 Test Loss: 2.606 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.3053905963897705
Epoch: 11, Steps: 18 | Train Loss: 0.590 Vali Loss: 7.430 Vali Acc: 0.480 Test Loss: 7.430 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.167925119400024
Epoch: 12, Steps: 18 | Train Loss: 0.633 Vali Loss: 6.370 Vali Acc: 0.520 Test Loss: 6.370 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.8349316120147705
Epoch: 13, Steps: 18 | Train Loss: 0.499 Vali Loss: 4.208 Vali Acc: 0.440 Test Loss: 4.208 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.471209764480591
Epoch: 14, Steps: 18 | Train Loss: 0.257 Vali Loss: 4.598 Vali Acc: 0.470 Test Loss: 4.598 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.214966773986816
Epoch: 15, Steps: 18 | Train Loss: 0.346 Vali Loss: 3.584 Vali Acc: 0.530 Test Loss: 3.584 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.666294813156128
Epoch: 16, Steps: 18 | Train Loss: 1.125 Vali Loss: 5.512 Vali Acc: 0.520 Test Loss: 5.512 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3516850
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.12071418762207
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 4.757197141647339
Epoch: 2, Steps: 18 | Train Loss: 1.056 Vali Loss: 1.952 Vali Acc: 0.530 Test Loss: 1.952 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.302894115447998
Epoch: 3, Steps: 18 | Train Loss: 0.830 Vali Loss: 1.532 Vali Acc: 0.530 Test Loss: 1.532 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.005356311798096
Epoch: 4, Steps: 18 | Train Loss: 0.792 Vali Loss: 2.118 Vali Acc: 0.600 Test Loss: 2.118 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599979).  Saving model ...
Epoch: 5 cost time: 5.197477579116821
Epoch: 5, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.979 Vali Acc: 0.460 Test Loss: 1.979 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.734174489974976
Epoch: 6, Steps: 18 | Train Loss: 0.283 Vali Loss: 2.797 Vali Acc: 0.570 Test Loss: 2.797 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.921077728271484
Epoch: 7, Steps: 18 | Train Loss: 0.428 Vali Loss: 2.584 Vali Acc: 0.470 Test Loss: 2.584 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.814507961273193
Epoch: 8, Steps: 18 | Train Loss: 1.242 Vali Loss: 4.667 Vali Acc: 0.440 Test Loss: 4.667 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.559373378753662
Epoch: 9, Steps: 18 | Train Loss: 0.642 Vali Loss: 2.874 Vali Acc: 0.480 Test Loss: 2.874 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.7990758419036865
Epoch: 10, Steps: 18 | Train Loss: 0.285 Vali Loss: 4.391 Vali Acc: 0.470 Test Loss: 4.391 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.596174478530884
Epoch: 11, Steps: 18 | Train Loss: 0.275 Vali Loss: 4.820 Vali Acc: 0.560 Test Loss: 4.820 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.427283048629761
Epoch: 12, Steps: 18 | Train Loss: 0.241 Vali Loss: 4.819 Vali Acc: 0.520 Test Loss: 4.819 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.477921962738037
Epoch: 13, Steps: 18 | Train Loss: 0.311 Vali Loss: 4.721 Vali Acc: 0.500 Test Loss: 4.721 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.720028877258301
Epoch: 14, Steps: 18 | Train Loss: 0.306 Vali Loss: 5.775 Vali Acc: 0.510 Test Loss: 5.775 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3501490
model size : 13.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.23724889755249
Epoch: 1, Steps: 18 | Train Loss: 1.202 Vali Loss: 1.298 Vali Acc: 0.510 Test Loss: 1.298 Test Acc: 0.510
Validation loss decreased (inf --> -0.509987).  Saving model ...
Epoch: 2 cost time: 3.0811214447021484
Epoch: 2, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.125 Vali Acc: 0.530 Test Loss: 1.125 Test Acc: 0.530
Validation loss decreased (-0.509987 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 3.254384756088257
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.204 Vali Acc: 0.620 Test Loss: 1.204 Test Acc: 0.620
Validation loss decreased (-0.529989 --> -0.619988).  Saving model ...
Epoch: 4 cost time: 3.0608410835266113
Epoch: 4, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.597 Vali Acc: 0.540 Test Loss: 1.597 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.844688892364502
Epoch: 5, Steps: 18 | Train Loss: 0.970 Vali Loss: 2.256 Vali Acc: 0.580 Test Loss: 2.256 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9205071926116943
Epoch: 6, Steps: 18 | Train Loss: 0.766 Vali Loss: 2.768 Vali Acc: 0.530 Test Loss: 2.768 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.284240961074829
Epoch: 7, Steps: 18 | Train Loss: 0.558 Vali Loss: 3.055 Vali Acc: 0.530 Test Loss: 3.055 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0862133502960205
Epoch: 8, Steps: 18 | Train Loss: 0.692 Vali Loss: 5.898 Vali Acc: 0.530 Test Loss: 5.898 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9097707271575928
Epoch: 9, Steps: 18 | Train Loss: 0.585 Vali Loss: 7.485 Vali Acc: 0.520 Test Loss: 7.485 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9470279216766357
Epoch: 10, Steps: 18 | Train Loss: 0.835 Vali Loss: 8.416 Vali Acc: 0.510 Test Loss: 8.416 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.2779643535614014
Epoch: 11, Steps: 18 | Train Loss: 0.633 Vali Loss: 4.330 Vali Acc: 0.510 Test Loss: 4.330 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.985304832458496
Epoch: 12, Steps: 18 | Train Loss: 0.620 Vali Loss: 5.192 Vali Acc: 0.540 Test Loss: 5.192 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.927157402038574
Epoch: 13, Steps: 18 | Train Loss: 0.847 Vali Loss: 8.707 Vali Acc: 0.480 Test Loss: 8.707 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3486130
model size : 13.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.6376163959503174
Epoch: 1, Steps: 18 | Train Loss: 0.841 Vali Loss: 1.187 Vali Acc: 0.510 Test Loss: 1.187 Test Acc: 0.510
Validation loss decreased (inf --> -0.509988).  Saving model ...
Epoch: 2 cost time: 1.4422099590301514
Epoch: 2, Steps: 18 | Train Loss: 0.766 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4838435649871826
Epoch: 3, Steps: 18 | Train Loss: 0.751 Vali Loss: 2.604 Vali Acc: 0.480 Test Loss: 2.604 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4417839050292969
Epoch: 4, Steps: 18 | Train Loss: 0.716 Vali Loss: 2.543 Vali Acc: 0.520 Test Loss: 2.543 Test Acc: 0.520
Validation loss decreased (-0.509988 --> -0.519975).  Saving model ...
Epoch: 5 cost time: 1.5231256484985352
Epoch: 5, Steps: 18 | Train Loss: 0.867 Vali Loss: 3.168 Vali Acc: 0.560 Test Loss: 3.168 Test Acc: 0.560
Validation loss decreased (-0.519975 --> -0.559968).  Saving model ...
Epoch: 6 cost time: 1.2680578231811523
Epoch: 6, Steps: 18 | Train Loss: 0.948 Vali Loss: 3.222 Vali Acc: 0.470 Test Loss: 3.222 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.442150354385376
Epoch: 7, Steps: 18 | Train Loss: 0.490 Vali Loss: 5.069 Vali Acc: 0.490 Test Loss: 5.069 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4932119846343994
Epoch: 8, Steps: 18 | Train Loss: 0.426 Vali Loss: 3.833 Vali Acc: 0.480 Test Loss: 3.833 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.464895486831665
Epoch: 9, Steps: 18 | Train Loss: 1.703 Vali Loss: 3.155 Vali Acc: 0.550 Test Loss: 3.155 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4027440547943115
Epoch: 10, Steps: 18 | Train Loss: 0.738 Vali Loss: 4.564 Vali Acc: 0.550 Test Loss: 4.564 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.417898416519165
Epoch: 11, Steps: 18 | Train Loss: 1.063 Vali Loss: 5.923 Vali Acc: 0.530 Test Loss: 5.923 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3327901363372803
Epoch: 12, Steps: 18 | Train Loss: 1.167 Vali Loss: 9.020 Vali Acc: 0.520 Test Loss: 9.020 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4977836608886719
Epoch: 13, Steps: 18 | Train Loss: 1.076 Vali Loss: 6.419 Vali Acc: 0.460 Test Loss: 6.419 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5070216655731201
Epoch: 14, Steps: 18 | Train Loss: 1.177 Vali Loss: 6.050 Vali Acc: 0.480 Test Loss: 6.050 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4874753952026367
Epoch: 15, Steps: 18 | Train Loss: 0.430 Vali Loss: 6.485 Vali Acc: 0.440 Test Loss: 6.485 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3471282
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.346856355667114
Epoch: 1, Steps: 18 | Train Loss: 1.011 Vali Loss: 1.592 Vali Acc: 0.460 Test Loss: 1.592 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 25.53387451171875
Epoch: 2, Steps: 18 | Train Loss: 1.078 Vali Loss: 1.144 Vali Acc: 0.630 Test Loss: 1.144 Test Acc: 0.630
Validation loss decreased (-0.459984 --> -0.629989).  Saving model ...
Epoch: 3 cost time: 26.22994565963745
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 1.293 Vali Acc: 0.510 Test Loss: 1.293 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.213051319122314
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.422 Vali Acc: 0.510 Test Loss: 1.422 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.793687105178833
Epoch: 5, Steps: 18 | Train Loss: 0.427 Vali Loss: 2.040 Vali Acc: 0.470 Test Loss: 2.040 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.78019666671753
Epoch: 6, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.607 Vali Acc: 0.540 Test Loss: 2.607 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.875415802001953
Epoch: 7, Steps: 18 | Train Loss: 0.406 Vali Loss: 2.415 Vali Acc: 0.520 Test Loss: 2.415 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 24.40755271911621
Epoch: 8, Steps: 18 | Train Loss: 0.561 Vali Loss: 3.755 Vali Acc: 0.510 Test Loss: 3.755 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 24.73463535308838
Epoch: 9, Steps: 18 | Train Loss: 0.985 Vali Loss: 4.477 Vali Acc: 0.560 Test Loss: 4.477 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.4331636428833
Epoch: 10, Steps: 18 | Train Loss: 0.498 Vali Loss: 3.739 Vali Acc: 0.500 Test Loss: 3.739 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.107152700424194
Epoch: 11, Steps: 18 | Train Loss: 0.447 Vali Loss: 3.658 Vali Acc: 0.510 Test Loss: 3.658 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 23.71811032295227
Epoch: 12, Steps: 18 | Train Loss: 0.742 Vali Loss: 5.199 Vali Acc: 0.510 Test Loss: 5.199 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3658642
model size : 15.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.76629376411438
Epoch: 1, Steps: 18 | Train Loss: 0.883 Vali Loss: 0.924 Vali Acc: 0.480 Test Loss: 0.924 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 19.306225299835205
Epoch: 2, Steps: 18 | Train Loss: 0.882 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.479991 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 18.392987489700317
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.275 Vali Acc: 0.480 Test Loss: 1.275 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.890456199645996
Epoch: 4, Steps: 18 | Train Loss: 1.077 Vali Loss: 2.582 Vali Acc: 0.500 Test Loss: 2.582 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.983957529067993
Epoch: 5, Steps: 18 | Train Loss: 0.720 Vali Loss: 2.326 Vali Acc: 0.530 Test Loss: 2.326 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.659472942352295
Epoch: 6, Steps: 18 | Train Loss: 0.903 Vali Loss: 3.416 Vali Acc: 0.480 Test Loss: 3.416 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.177310466766357
Epoch: 7, Steps: 18 | Train Loss: 0.753 Vali Loss: 2.022 Vali Acc: 0.540 Test Loss: 2.022 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.70259714126587
Epoch: 8, Steps: 18 | Train Loss: 0.517 Vali Loss: 3.511 Vali Acc: 0.540 Test Loss: 3.511 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.55614924430847
Epoch: 9, Steps: 18 | Train Loss: 0.617 Vali Loss: 4.294 Vali Acc: 0.550 Test Loss: 4.294 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.60150671005249
Epoch: 10, Steps: 18 | Train Loss: 0.580 Vali Loss: 3.509 Vali Acc: 0.520 Test Loss: 3.509 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.023913145065308
Epoch: 11, Steps: 18 | Train Loss: 0.548 Vali Loss: 5.024 Vali Acc: 0.470 Test Loss: 5.024 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.626721620559692
Epoch: 12, Steps: 18 | Train Loss: 0.564 Vali Loss: 10.098 Vali Acc: 0.490 Test Loss: 10.098 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3620242
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.598973751068115
Epoch: 1, Steps: 18 | Train Loss: 1.000 Vali Loss: 1.342 Vali Acc: 0.530 Test Loss: 1.342 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 14.383497714996338
Epoch: 2, Steps: 18 | Train Loss: 1.175 Vali Loss: 1.165 Vali Acc: 0.470 Test Loss: 1.165 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.190184354782104
Epoch: 3, Steps: 18 | Train Loss: 0.780 Vali Loss: 1.246 Vali Acc: 0.560 Test Loss: 1.246 Test Acc: 0.560
Validation loss decreased (-0.529987 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 13.576927661895752
Epoch: 4, Steps: 18 | Train Loss: 0.874 Vali Loss: 3.309 Vali Acc: 0.440 Test Loss: 3.309 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.642287015914917
Epoch: 5, Steps: 18 | Train Loss: 0.668 Vali Loss: 2.070 Vali Acc: 0.510 Test Loss: 2.070 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.677416801452637
Epoch: 6, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.198 Vali Acc: 0.530 Test Loss: 2.198 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.821553707122803
Epoch: 7, Steps: 18 | Train Loss: 0.424 Vali Loss: 2.227 Vali Acc: 0.500 Test Loss: 2.227 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.209985494613647
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 4.946 Vali Acc: 0.480 Test Loss: 4.946 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.3686203956604
Epoch: 9, Steps: 18 | Train Loss: 0.927 Vali Loss: 3.626 Vali Acc: 0.500 Test Loss: 3.626 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.319271802902222
Epoch: 10, Steps: 18 | Train Loss: 0.448 Vali Loss: 10.752 Vali Acc: 0.480 Test Loss: 10.752 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.343846082687378
Epoch: 11, Steps: 18 | Train Loss: 0.649 Vali Loss: 6.910 Vali Acc: 0.540 Test Loss: 6.910 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.209910869598389
Epoch: 12, Steps: 18 | Train Loss: 1.483 Vali Loss: 5.171 Vali Acc: 0.470 Test Loss: 5.171 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.583032846450806
Epoch: 13, Steps: 18 | Train Loss: 0.164 Vali Loss: 4.931 Vali Acc: 0.520 Test Loss: 4.931 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3581842
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.706997871398926
Epoch: 1, Steps: 18 | Train Loss: 0.856 Vali Loss: 1.388 Vali Acc: 0.610 Test Loss: 1.388 Test Acc: 0.610
Validation loss decreased (inf --> -0.609986).  Saving model ...
Epoch: 2 cost time: 9.144057750701904
Epoch: 2, Steps: 18 | Train Loss: 1.581 Vali Loss: 1.476 Vali Acc: 0.610 Test Loss: 1.476 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.368664741516113
Epoch: 3, Steps: 18 | Train Loss: 0.951 Vali Loss: 1.828 Vali Acc: 0.510 Test Loss: 1.828 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.585422992706299
Epoch: 4, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.488 Vali Acc: 0.490 Test Loss: 1.488 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.708991765975952
Epoch: 5, Steps: 18 | Train Loss: 0.627 Vali Loss: 3.269 Vali Acc: 0.500 Test Loss: 3.269 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.223543643951416
Epoch: 6, Steps: 18 | Train Loss: 0.761 Vali Loss: 2.359 Vali Acc: 0.500 Test Loss: 2.359 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.52914547920227
Epoch: 7, Steps: 18 | Train Loss: 0.646 Vali Loss: 4.337 Vali Acc: 0.450 Test Loss: 4.337 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.506315231323242
Epoch: 8, Steps: 18 | Train Loss: 0.612 Vali Loss: 2.094 Vali Acc: 0.560 Test Loss: 2.094 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.504118204116821
Epoch: 9, Steps: 18 | Train Loss: 0.197 Vali Loss: 3.070 Vali Acc: 0.530 Test Loss: 3.070 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.482213258743286
Epoch: 10, Steps: 18 | Train Loss: 0.509 Vali Loss: 3.556 Vali Acc: 0.560 Test Loss: 3.556 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.842728853225708
Epoch: 11, Steps: 18 | Train Loss: 0.518 Vali Loss: 4.648 Vali Acc: 0.550 Test Loss: 4.648 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3543442
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.7666425704956055
Epoch: 1, Steps: 18 | Train Loss: 0.875 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
Validation loss decreased (inf --> -0.559988).  Saving model ...
Epoch: 2 cost time: 6.053774118423462
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 2.388 Vali Acc: 0.490 Test Loss: 2.388 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.783096075057983
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.794 Vali Acc: 0.510 Test Loss: 1.794 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.3117218017578125
Epoch: 4, Steps: 18 | Train Loss: 0.710 Vali Loss: 2.791 Vali Acc: 0.540 Test Loss: 2.791 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.838277578353882
Epoch: 5, Steps: 18 | Train Loss: 0.730 Vali Loss: 2.614 Vali Acc: 0.470 Test Loss: 2.614 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.813918113708496
Epoch: 6, Steps: 18 | Train Loss: 0.437 Vali Loss: 2.142 Vali Acc: 0.480 Test Loss: 2.142 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.294813871383667
Epoch: 7, Steps: 18 | Train Loss: 0.293 Vali Loss: 2.874 Vali Acc: 0.500 Test Loss: 2.874 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.720902681350708
Epoch: 8, Steps: 18 | Train Loss: 0.604 Vali Loss: 3.354 Vali Acc: 0.480 Test Loss: 3.354 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.7199766635894775
Epoch: 9, Steps: 18 | Train Loss: 0.282 Vali Loss: 2.654 Vali Acc: 0.480 Test Loss: 2.654 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.34747576713562
Epoch: 10, Steps: 18 | Train Loss: 0.187 Vali Loss: 4.981 Vali Acc: 0.450 Test Loss: 4.981 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.6457719802856445
Epoch: 11, Steps: 18 | Train Loss: 1.104 Vali Loss: 3.444 Vali Acc: 0.500 Test Loss: 3.444 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3512722
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.728076457977295
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 1.193 Vali Acc: 0.530 Test Loss: 1.193 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 4.308352947235107
Epoch: 2, Steps: 18 | Train Loss: 0.785 Vali Loss: 1.380 Vali Acc: 0.510 Test Loss: 1.380 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.876017093658447
Epoch: 3, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.396 Vali Acc: 0.500 Test Loss: 2.396 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.972870349884033
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 1.691 Vali Acc: 0.610 Test Loss: 1.691 Test Acc: 0.610
Validation loss decreased (-0.529988 --> -0.609983).  Saving model ...
Epoch: 5 cost time: 4.729844570159912
Epoch: 5, Steps: 18 | Train Loss: 0.322 Vali Loss: 2.542 Vali Acc: 0.460 Test Loss: 2.542 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.925910711288452
Epoch: 6, Steps: 18 | Train Loss: 0.744 Vali Loss: 2.362 Vali Acc: 0.480 Test Loss: 2.362 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.711252450942993
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 3.040 Vali Acc: 0.500 Test Loss: 3.040 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.317495584487915
Epoch: 8, Steps: 18 | Train Loss: 1.059 Vali Loss: 5.063 Vali Acc: 0.460 Test Loss: 5.063 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.691856384277344
Epoch: 9, Steps: 18 | Train Loss: 1.547 Vali Loss: 4.872 Vali Acc: 0.520 Test Loss: 4.872 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.3362717628479
Epoch: 10, Steps: 18 | Train Loss: 0.734 Vali Loss: 3.052 Vali Acc: 0.520 Test Loss: 3.052 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.566362142562866
Epoch: 11, Steps: 18 | Train Loss: 0.257 Vali Loss: 3.372 Vali Acc: 0.490 Test Loss: 3.372 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.433290958404541
Epoch: 12, Steps: 18 | Train Loss: 0.278 Vali Loss: 3.744 Vali Acc: 0.500 Test Loss: 3.744 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.644510746002197
Epoch: 13, Steps: 18 | Train Loss: 0.356 Vali Loss: 7.161 Vali Acc: 0.510 Test Loss: 7.161 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.795857667922974
Epoch: 14, Steps: 18 | Train Loss: 0.479 Vali Loss: 8.297 Vali Acc: 0.480 Test Loss: 8.297 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3497362
model size : 13.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.427602291107178
Epoch: 1, Steps: 18 | Train Loss: 0.850 Vali Loss: 1.220 Vali Acc: 0.460 Test Loss: 1.220 Test Acc: 0.460
Validation loss decreased (inf --> -0.459988).  Saving model ...
Epoch: 2 cost time: 2.905993700027466
Epoch: 2, Steps: 18 | Train Loss: 0.936 Vali Loss: 1.518 Vali Acc: 0.550 Test Loss: 1.518 Test Acc: 0.550
Validation loss decreased (-0.459988 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 2.96915340423584
Epoch: 3, Steps: 18 | Train Loss: 1.080 Vali Loss: 1.519 Vali Acc: 0.470 Test Loss: 1.519 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0347986221313477
Epoch: 4, Steps: 18 | Train Loss: 0.709 Vali Loss: 1.292 Vali Acc: 0.530 Test Loss: 1.292 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2690536975860596
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 3.888 Vali Acc: 0.480 Test Loss: 3.888 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3876166343688965
Epoch: 6, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.458 Vali Acc: 0.520 Test Loss: 2.458 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.032989978790283
Epoch: 7, Steps: 18 | Train Loss: 0.667 Vali Loss: 2.438 Vali Acc: 0.470 Test Loss: 2.438 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.852736234664917
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 3.319 Vali Acc: 0.490 Test Loss: 3.319 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7671828269958496
Epoch: 9, Steps: 18 | Train Loss: 0.527 Vali Loss: 3.316 Vali Acc: 0.570 Test Loss: 3.316 Test Acc: 0.570
Validation loss decreased (-0.549985 --> -0.569967).  Saving model ...
Epoch: 10 cost time: 2.9520211219787598
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 3.520 Vali Acc: 0.510 Test Loss: 3.520 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6179308891296387
Epoch: 11, Steps: 18 | Train Loss: 0.223 Vali Loss: 3.882 Vali Acc: 0.520 Test Loss: 3.882 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5330467224121094
Epoch: 12, Steps: 18 | Train Loss: 0.409 Vali Loss: 5.014 Vali Acc: 0.480 Test Loss: 5.014 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.565807819366455
Epoch: 13, Steps: 18 | Train Loss: 0.564 Vali Loss: 5.719 Vali Acc: 0.510 Test Loss: 5.719 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7639334201812744
Epoch: 14, Steps: 18 | Train Loss: 0.284 Vali Loss: 6.567 Vali Acc: 0.550 Test Loss: 6.567 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.744767427444458
Epoch: 15, Steps: 18 | Train Loss: 0.165 Vali Loss: 5.461 Vali Acc: 0.500 Test Loss: 5.461 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7967588901519775
Epoch: 16, Steps: 18 | Train Loss: 0.211 Vali Loss: 5.889 Vali Acc: 0.470 Test Loss: 5.889 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0149004459381104
Epoch: 17, Steps: 18 | Train Loss: 0.091 Vali Loss: 12.950 Vali Acc: 0.510 Test Loss: 12.950 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.902128219604492
Epoch: 18, Steps: 18 | Train Loss: 0.413 Vali Loss: 9.606 Vali Acc: 0.480 Test Loss: 9.606 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.864971876144409
Epoch: 19, Steps: 18 | Train Loss: 0.416 Vali Loss: 6.715 Vali Acc: 0.530 Test Loss: 6.715 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3482002
model size : 13.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.6864726543426514
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.893 Vali Acc: 0.600 Test Loss: 0.893 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 1.3477325439453125
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3467228412628174
Epoch: 3, Steps: 18 | Train Loss: 0.905 Vali Loss: 4.565 Vali Acc: 0.500 Test Loss: 4.565 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3791306018829346
Epoch: 4, Steps: 18 | Train Loss: 0.973 Vali Loss: 1.723 Vali Acc: 0.500 Test Loss: 1.723 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3548657894134521
Epoch: 5, Steps: 18 | Train Loss: 0.651 Vali Loss: 2.726 Vali Acc: 0.540 Test Loss: 2.726 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3442027568817139
Epoch: 6, Steps: 18 | Train Loss: 0.904 Vali Loss: 2.211 Vali Acc: 0.540 Test Loss: 2.211 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4079687595367432
Epoch: 7, Steps: 18 | Train Loss: 0.468 Vali Loss: 1.935 Vali Acc: 0.520 Test Loss: 1.935 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3102798461914062
Epoch: 8, Steps: 18 | Train Loss: 0.513 Vali Loss: 5.823 Vali Acc: 0.510 Test Loss: 5.823 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3791866302490234
Epoch: 9, Steps: 18 | Train Loss: 0.436 Vali Loss: 3.689 Vali Acc: 0.530 Test Loss: 3.689 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4023523330688477
Epoch: 10, Steps: 18 | Train Loss: 0.585 Vali Loss: 3.571 Vali Acc: 0.510 Test Loss: 3.571 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2306361198425293
Epoch: 11, Steps: 18 | Train Loss: 0.617 Vali Loss: 2.942 Vali Acc: 0.510 Test Loss: 2.942 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3467154
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.630521059036255
Epoch: 1, Steps: 18 | Train Loss: 0.850 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 21.331583976745605
Epoch: 2, Steps: 18 | Train Loss: 0.754 Vali Loss: 1.624 Vali Acc: 0.570 Test Loss: 1.624 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569984).  Saving model ...
Epoch: 3 cost time: 22.73530077934265
Epoch: 3, Steps: 18 | Train Loss: 1.099 Vali Loss: 3.040 Vali Acc: 0.540 Test Loss: 3.040 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.233866453170776
Epoch: 4, Steps: 18 | Train Loss: 1.189 Vali Loss: 2.183 Vali Acc: 0.440 Test Loss: 2.183 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.90296506881714
Epoch: 5, Steps: 18 | Train Loss: 0.761 Vali Loss: 2.107 Vali Acc: 0.500 Test Loss: 2.107 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.27452301979065
Epoch: 6, Steps: 18 | Train Loss: 0.961 Vali Loss: 3.115 Vali Acc: 0.510 Test Loss: 3.115 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.03927516937256
Epoch: 7, Steps: 18 | Train Loss: 0.553 Vali Loss: 4.764 Vali Acc: 0.540 Test Loss: 4.764 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.67643976211548
Epoch: 8, Steps: 18 | Train Loss: 1.107 Vali Loss: 2.617 Vali Acc: 0.560 Test Loss: 2.617 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 23.95330548286438
Epoch: 9, Steps: 18 | Train Loss: 0.734 Vali Loss: 2.818 Vali Acc: 0.510 Test Loss: 2.818 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.539884328842163
Epoch: 10, Steps: 18 | Train Loss: 0.565 Vali Loss: 2.762 Vali Acc: 0.480 Test Loss: 2.762 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.003937482833862
Epoch: 11, Steps: 18 | Train Loss: 0.458 Vali Loss: 4.466 Vali Acc: 0.550 Test Loss: 4.466 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.883816957473755
Epoch: 12, Steps: 18 | Train Loss: 0.757 Vali Loss: 3.802 Vali Acc: 0.450 Test Loss: 3.802 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3656578
model size : 15.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.672316074371338
Epoch: 1, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 17.126463174819946
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 1.256 Vali Acc: 0.470 Test Loss: 1.256 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.056562900543213
Epoch: 3, Steps: 18 | Train Loss: 0.688 Vali Loss: 1.148 Vali Acc: 0.530 Test Loss: 1.148 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.511271953582764
Epoch: 4, Steps: 18 | Train Loss: 0.886 Vali Loss: 2.943 Vali Acc: 0.460 Test Loss: 2.943 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.131351232528687
Epoch: 5, Steps: 18 | Train Loss: 1.395 Vali Loss: 2.404 Vali Acc: 0.540 Test Loss: 2.404 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.149964809417725
Epoch: 6, Steps: 18 | Train Loss: 1.116 Vali Loss: 2.692 Vali Acc: 0.530 Test Loss: 2.692 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.676077604293823
Epoch: 7, Steps: 18 | Train Loss: 0.603 Vali Loss: 2.992 Vali Acc: 0.530 Test Loss: 2.992 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.777275323867798
Epoch: 8, Steps: 18 | Train Loss: 0.932 Vali Loss: 3.530 Vali Acc: 0.520 Test Loss: 3.530 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.987082958221436
Epoch: 9, Steps: 18 | Train Loss: 1.229 Vali Loss: 6.225 Vali Acc: 0.480 Test Loss: 6.225 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.955052137374878
Epoch: 10, Steps: 18 | Train Loss: 0.369 Vali Loss: 5.911 Vali Acc: 0.520 Test Loss: 5.911 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.854581117630005
Epoch: 11, Steps: 18 | Train Loss: 0.272 Vali Loss: 3.139 Vali Acc: 0.550 Test Loss: 3.139 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3618178
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.441726684570312
Epoch: 1, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 14.155946016311646
Epoch: 2, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.506874084472656
Epoch: 3, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.945 Vali Acc: 0.470 Test Loss: 1.945 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.358621835708618
Epoch: 4, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.527 Vali Acc: 0.500 Test Loss: 1.527 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.939778089523315
Epoch: 5, Steps: 18 | Train Loss: 0.378 Vali Loss: 2.342 Vali Acc: 0.540 Test Loss: 2.342 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539977).  Saving model ...
Epoch: 6 cost time: 13.660560607910156
Epoch: 6, Steps: 18 | Train Loss: 0.388 Vali Loss: 3.485 Vali Acc: 0.450 Test Loss: 3.485 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.350708961486816
Epoch: 7, Steps: 18 | Train Loss: 0.437 Vali Loss: 3.528 Vali Acc: 0.480 Test Loss: 3.528 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.345458984375
Epoch: 8, Steps: 18 | Train Loss: 0.521 Vali Loss: 3.311 Vali Acc: 0.490 Test Loss: 3.311 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.39494013786316
Epoch: 9, Steps: 18 | Train Loss: 0.827 Vali Loss: 4.209 Vali Acc: 0.510 Test Loss: 4.209 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.710476875305176
Epoch: 10, Steps: 18 | Train Loss: 0.799 Vali Loss: 2.412 Vali Acc: 0.470 Test Loss: 2.412 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.06029987335205
Epoch: 11, Steps: 18 | Train Loss: 0.369 Vali Loss: 5.374 Vali Acc: 0.470 Test Loss: 5.374 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.987358093261719
Epoch: 12, Steps: 18 | Train Loss: 0.344 Vali Loss: 4.604 Vali Acc: 0.530 Test Loss: 4.604 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.032109498977661
Epoch: 13, Steps: 18 | Train Loss: 0.674 Vali Loss: 6.007 Vali Acc: 0.520 Test Loss: 6.007 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.746849775314331
Epoch: 14, Steps: 18 | Train Loss: 0.477 Vali Loss: 8.276 Vali Acc: 0.530 Test Loss: 8.276 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.084196090698242
Epoch: 15, Steps: 18 | Train Loss: 0.293 Vali Loss: 12.162 Vali Acc: 0.500 Test Loss: 12.162 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 3579778
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.193515300750732
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 8.905518531799316
Epoch: 2, Steps: 18 | Train Loss: 0.961 Vali Loss: 1.637 Vali Acc: 0.540 Test Loss: 1.637 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 8.871320962905884
Epoch: 3, Steps: 18 | Train Loss: 0.818 Vali Loss: 2.316 Vali Acc: 0.520 Test Loss: 2.316 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.637217998504639
Epoch: 4, Steps: 18 | Train Loss: 0.757 Vali Loss: 3.131 Vali Acc: 0.620 Test Loss: 3.131 Test Acc: 0.620
Validation loss decreased (-0.539984 --> -0.619969).  Saving model ...
Epoch: 5 cost time: 9.017083406448364
Epoch: 5, Steps: 18 | Train Loss: 1.283 Vali Loss: 2.177 Vali Acc: 0.620 Test Loss: 2.177 Test Acc: 0.620
Validation loss decreased (-0.619969 --> -0.619978).  Saving model ...
Epoch: 6 cost time: 8.78223180770874
Epoch: 6, Steps: 18 | Train Loss: 0.631 Vali Loss: 2.361 Vali Acc: 0.540 Test Loss: 2.361 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.801767110824585
Epoch: 7, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.134 Vali Acc: 0.500 Test Loss: 3.134 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.938107013702393
Epoch: 8, Steps: 18 | Train Loss: 0.965 Vali Loss: 2.537 Vali Acc: 0.500 Test Loss: 2.537 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.664371252059937
Epoch: 9, Steps: 18 | Train Loss: 0.579 Vali Loss: 5.117 Vali Acc: 0.500 Test Loss: 5.117 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.026617288589478
Epoch: 10, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.920 Vali Acc: 0.470 Test Loss: 2.920 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.584950685501099
Epoch: 11, Steps: 18 | Train Loss: 0.632 Vali Loss: 3.613 Vali Acc: 0.530 Test Loss: 3.613 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.72959041595459
Epoch: 12, Steps: 18 | Train Loss: 1.271 Vali Loss: 6.840 Vali Acc: 0.540 Test Loss: 6.840 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.21873426437378
Epoch: 13, Steps: 18 | Train Loss: 0.676 Vali Loss: 4.445 Vali Acc: 0.530 Test Loss: 4.445 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.582981586456299
Epoch: 14, Steps: 18 | Train Loss: 0.292 Vali Loss: 4.780 Vali Acc: 0.540 Test Loss: 4.780 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.8805513381958
Epoch: 15, Steps: 18 | Train Loss: 0.148 Vali Loss: 6.130 Vali Acc: 0.500 Test Loss: 6.130 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3541378
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.475769519805908
Epoch: 1, Steps: 18 | Train Loss: 0.936 Vali Loss: 0.951 Vali Acc: 0.450 Test Loss: 0.951 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 6.180524587631226
Epoch: 2, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.403 Vali Acc: 0.510 Test Loss: 1.403 Test Acc: 0.510
Validation loss decreased (-0.449990 --> -0.509986).  Saving model ...
Epoch: 3 cost time: 5.834139347076416
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.916 Vali Acc: 0.540 Test Loss: 1.916 Test Acc: 0.540
Validation loss decreased (-0.509986 --> -0.539981).  Saving model ...
Epoch: 4 cost time: 5.336104393005371
Epoch: 4, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.759 Vali Acc: 0.470 Test Loss: 1.759 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.662919282913208
Epoch: 5, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.736 Vali Acc: 0.440 Test Loss: 1.736 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.3043177127838135
Epoch: 6, Steps: 18 | Train Loss: 0.440 Vali Loss: 2.069 Vali Acc: 0.460 Test Loss: 2.069 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.992865085601807
Epoch: 7, Steps: 18 | Train Loss: 0.482 Vali Loss: 2.151 Vali Acc: 0.480 Test Loss: 2.151 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.880970239639282
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 4.294 Vali Acc: 0.450 Test Loss: 4.294 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.251854181289673
Epoch: 9, Steps: 18 | Train Loss: 0.305 Vali Loss: 3.816 Vali Acc: 0.530 Test Loss: 3.816 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.846060037612915
Epoch: 10, Steps: 18 | Train Loss: 0.909 Vali Loss: 5.107 Vali Acc: 0.530 Test Loss: 5.107 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.9770753383636475
Epoch: 11, Steps: 18 | Train Loss: 0.475 Vali Loss: 3.484 Vali Acc: 0.540 Test Loss: 3.484 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.731060028076172
Epoch: 12, Steps: 18 | Train Loss: 0.414 Vali Loss: 5.703 Vali Acc: 0.500 Test Loss: 5.703 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.851574420928955
Epoch: 13, Steps: 18 | Train Loss: 0.262 Vali Loss: 6.101 Vali Acc: 0.530 Test Loss: 6.101 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 3510658
model size : 13.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.85287618637085
Epoch: 1, Steps: 18 | Train Loss: 0.994 Vali Loss: 1.062 Vali Acc: 0.520 Test Loss: 1.062 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 4.477314233779907
Epoch: 2, Steps: 18 | Train Loss: 0.898 Vali Loss: 2.131 Vali Acc: 0.500 Test Loss: 2.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7120208740234375
Epoch: 3, Steps: 18 | Train Loss: 0.836 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 4.451098442077637
Epoch: 4, Steps: 18 | Train Loss: 0.787 Vali Loss: 1.840 Vali Acc: 0.600 Test Loss: 1.840 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 4.569190979003906
Epoch: 5, Steps: 18 | Train Loss: 0.587 Vali Loss: 3.340 Vali Acc: 0.520 Test Loss: 3.340 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.441342353820801
Epoch: 6, Steps: 18 | Train Loss: 0.561 Vali Loss: 3.020 Vali Acc: 0.590 Test Loss: 3.020 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.777414321899414
Epoch: 7, Steps: 18 | Train Loss: 0.608 Vali Loss: 5.080 Vali Acc: 0.480 Test Loss: 5.080 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.381963729858398
Epoch: 8, Steps: 18 | Train Loss: 1.025 Vali Loss: 3.849 Vali Acc: 0.510 Test Loss: 3.849 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.593505620956421
Epoch: 9, Steps: 18 | Train Loss: 1.055 Vali Loss: 5.083 Vali Acc: 0.530 Test Loss: 5.083 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.362671375274658
Epoch: 10, Steps: 18 | Train Loss: 0.375 Vali Loss: 4.506 Vali Acc: 0.540 Test Loss: 4.506 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.476163625717163
Epoch: 11, Steps: 18 | Train Loss: 0.308 Vali Loss: 4.446 Vali Acc: 0.510 Test Loss: 4.446 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6569132804870605
Epoch: 12, Steps: 18 | Train Loss: 0.897 Vali Loss: 4.879 Vali Acc: 0.500 Test Loss: 4.879 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.6205668449401855
Epoch: 13, Steps: 18 | Train Loss: 0.665 Vali Loss: 10.174 Vali Acc: 0.550 Test Loss: 10.174 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.614574670791626
Epoch: 14, Steps: 18 | Train Loss: 0.275 Vali Loss: 7.675 Vali Acc: 0.480 Test Loss: 7.675 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3495298
model size : 13.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.170595169067383
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 0.919 Vali Acc: 0.570 Test Loss: 0.919 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 2.895941734313965
Epoch: 2, Steps: 18 | Train Loss: 0.889 Vali Loss: 2.006 Vali Acc: 0.450 Test Loss: 2.006 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7074761390686035
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.486 Vali Acc: 0.460 Test Loss: 1.486 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.647996425628662
Epoch: 4, Steps: 18 | Train Loss: 0.651 Vali Loss: 2.842 Vali Acc: 0.500 Test Loss: 2.842 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8135972023010254
Epoch: 5, Steps: 18 | Train Loss: 0.561 Vali Loss: 3.366 Vali Acc: 0.510 Test Loss: 3.366 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.869504451751709
Epoch: 6, Steps: 18 | Train Loss: 0.882 Vali Loss: 2.543 Vali Acc: 0.550 Test Loss: 2.543 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.672545909881592
Epoch: 7, Steps: 18 | Train Loss: 0.717 Vali Loss: 4.513 Vali Acc: 0.510 Test Loss: 4.513 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9531383514404297
Epoch: 8, Steps: 18 | Train Loss: 0.994 Vali Loss: 2.484 Vali Acc: 0.470 Test Loss: 2.484 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8957250118255615
Epoch: 9, Steps: 18 | Train Loss: 1.060 Vali Loss: 4.496 Vali Acc: 0.530 Test Loss: 4.496 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.979830026626587
Epoch: 10, Steps: 18 | Train Loss: 1.311 Vali Loss: 5.171 Vali Acc: 0.500 Test Loss: 5.171 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.92688250541687
Epoch: 11, Steps: 18 | Train Loss: 0.403 Vali Loss: 4.680 Vali Acc: 0.530 Test Loss: 4.680 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3479938
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.6530752182006836
Epoch: 1, Steps: 18 | Train Loss: 1.057 Vali Loss: 0.848 Vali Acc: 0.620 Test Loss: 0.848 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 1.4199550151824951
Epoch: 2, Steps: 18 | Train Loss: 0.971 Vali Loss: 1.770 Vali Acc: 0.470 Test Loss: 1.770 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.369805097579956
Epoch: 3, Steps: 18 | Train Loss: 0.862 Vali Loss: 2.038 Vali Acc: 0.530 Test Loss: 2.038 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3980889320373535
Epoch: 4, Steps: 18 | Train Loss: 0.716 Vali Loss: 2.086 Vali Acc: 0.540 Test Loss: 2.086 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3701770305633545
Epoch: 5, Steps: 18 | Train Loss: 0.854 Vali Loss: 2.254 Vali Acc: 0.500 Test Loss: 2.254 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3561830520629883
Epoch: 6, Steps: 18 | Train Loss: 0.477 Vali Loss: 2.106 Vali Acc: 0.540 Test Loss: 2.106 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3483290672302246
Epoch: 7, Steps: 18 | Train Loss: 0.453 Vali Loss: 4.105 Vali Acc: 0.520 Test Loss: 4.105 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3476462364196777
Epoch: 8, Steps: 18 | Train Loss: 0.514 Vali Loss: 3.853 Vali Acc: 0.560 Test Loss: 3.853 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.521454095840454
Epoch: 9, Steps: 18 | Train Loss: 0.834 Vali Loss: 3.306 Vali Acc: 0.490 Test Loss: 3.306 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.478747844696045
Epoch: 10, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.426 Vali Acc: 0.470 Test Loss: 3.426 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3443410396575928
Epoch: 11, Steps: 18 | Train Loss: 0.335 Vali Loss: 5.337 Vali Acc: 0.510 Test Loss: 5.337 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3465090
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.49133825302124
Epoch: 1, Steps: 18 | Train Loss: 0.843 Vali Loss: 1.152 Vali Acc: 0.470 Test Loss: 1.152 Test Acc: 0.470
Validation loss decreased (inf --> -0.469988).  Saving model ...
Epoch: 2 cost time: 22.133999586105347
Epoch: 2, Steps: 18 | Train Loss: 0.932 Vali Loss: 1.332 Vali Acc: 0.530 Test Loss: 1.332 Test Acc: 0.530
Validation loss decreased (-0.469988 --> -0.529987).  Saving model ...
Epoch: 3 cost time: 21.554662227630615
Epoch: 3, Steps: 18 | Train Loss: 0.931 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.321876049041748
Epoch: 4, Steps: 18 | Train Loss: 0.842 Vali Loss: 1.711 Vali Acc: 0.580 Test Loss: 1.711 Test Acc: 0.580
Validation loss decreased (-0.529987 --> -0.579983).  Saving model ...
Epoch: 5 cost time: 20.387544870376587
Epoch: 5, Steps: 18 | Train Loss: 0.849 Vali Loss: 1.963 Vali Acc: 0.550 Test Loss: 1.963 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.76330256462097
Epoch: 6, Steps: 18 | Train Loss: 0.741 Vali Loss: 2.744 Vali Acc: 0.510 Test Loss: 2.744 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.350623607635498
Epoch: 7, Steps: 18 | Train Loss: 1.956 Vali Loss: 9.570 Vali Acc: 0.510 Test Loss: 9.570 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.79242253303528
Epoch: 8, Steps: 18 | Train Loss: 1.708 Vali Loss: 4.063 Vali Acc: 0.540 Test Loss: 4.063 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.675740480422974
Epoch: 9, Steps: 18 | Train Loss: 0.861 Vali Loss: 3.559 Vali Acc: 0.510 Test Loss: 3.559 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.06136131286621
Epoch: 10, Steps: 18 | Train Loss: 1.120 Vali Loss: 4.678 Vali Acc: 0.540 Test Loss: 4.678 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.079389333724976
Epoch: 11, Steps: 18 | Train Loss: 0.850 Vali Loss: 5.046 Vali Acc: 0.520 Test Loss: 5.046 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 21.15339183807373
Epoch: 12, Steps: 18 | Train Loss: 0.596 Vali Loss: 3.396 Vali Acc: 0.520 Test Loss: 3.396 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 21.742770195007324
Epoch: 13, Steps: 18 | Train Loss: 0.459 Vali Loss: 5.073 Vali Acc: 0.500 Test Loss: 5.073 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 21.747350931167603
Epoch: 14, Steps: 18 | Train Loss: 0.518 Vali Loss: 6.669 Vali Acc: 0.540 Test Loss: 6.669 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3655546
model size : 15.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.90401577949524
Epoch: 1, Steps: 18 | Train Loss: 0.998 Vali Loss: 0.980 Vali Acc: 0.440 Test Loss: 0.980 Test Acc: 0.440
Validation loss decreased (inf --> -0.439990).  Saving model ...
Epoch: 2 cost time: 18.563026189804077
Epoch: 2, Steps: 18 | Train Loss: 0.927 Vali Loss: 0.985 Vali Acc: 0.590 Test Loss: 0.985 Test Acc: 0.590
Validation loss decreased (-0.439990 --> -0.589990).  Saving model ...
Epoch: 3 cost time: 18.477238655090332
Epoch: 3, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.225 Vali Acc: 0.490 Test Loss: 1.225 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.224819898605347
Epoch: 4, Steps: 18 | Train Loss: 0.846 Vali Loss: 1.981 Vali Acc: 0.520 Test Loss: 1.981 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.268009424209595
Epoch: 5, Steps: 18 | Train Loss: 0.639 Vali Loss: 3.997 Vali Acc: 0.510 Test Loss: 3.997 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.660189628601074
Epoch: 6, Steps: 18 | Train Loss: 1.061 Vali Loss: 1.461 Vali Acc: 0.540 Test Loss: 1.461 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.956563711166382
Epoch: 7, Steps: 18 | Train Loss: 0.933 Vali Loss: 3.247 Vali Acc: 0.540 Test Loss: 3.247 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.534111499786377
Epoch: 8, Steps: 18 | Train Loss: 0.929 Vali Loss: 3.310 Vali Acc: 0.520 Test Loss: 3.310 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 18.2363920211792
Epoch: 9, Steps: 18 | Train Loss: 0.530 Vali Loss: 4.864 Vali Acc: 0.530 Test Loss: 4.864 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.409167766571045
Epoch: 10, Steps: 18 | Train Loss: 0.809 Vali Loss: 4.446 Vali Acc: 0.560 Test Loss: 4.446 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.31453776359558
Epoch: 11, Steps: 18 | Train Loss: 1.098 Vali Loss: 3.338 Vali Acc: 0.580 Test Loss: 3.338 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.970828771591187
Epoch: 12, Steps: 18 | Train Loss: 0.555 Vali Loss: 5.065 Vali Acc: 0.550 Test Loss: 5.065 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3617146
model size : 14.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.91849422454834
Epoch: 1, Steps: 18 | Train Loss: 0.925 Vali Loss: 0.922 Vali Acc: 0.610 Test Loss: 0.922 Test Acc: 0.610
Validation loss decreased (inf --> -0.609991).  Saving model ...
Epoch: 2 cost time: 14.114047765731812
Epoch: 2, Steps: 18 | Train Loss: 0.814 Vali Loss: 1.655 Vali Acc: 0.530 Test Loss: 1.655 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.235605955123901
Epoch: 3, Steps: 18 | Train Loss: 1.017 Vali Loss: 1.722 Vali Acc: 0.460 Test Loss: 1.722 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.701122999191284
Epoch: 4, Steps: 18 | Train Loss: 0.878 Vali Loss: 2.933 Vali Acc: 0.510 Test Loss: 2.933 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.308289289474487
Epoch: 5, Steps: 18 | Train Loss: 1.326 Vali Loss: 1.574 Vali Acc: 0.630 Test Loss: 1.574 Test Acc: 0.630
Validation loss decreased (-0.609991 --> -0.629984).  Saving model ...
Epoch: 6 cost time: 14.418343305587769
Epoch: 6, Steps: 18 | Train Loss: 0.723 Vali Loss: 3.388 Vali Acc: 0.510 Test Loss: 3.388 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.044854164123535
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.108 Vali Acc: 0.510 Test Loss: 2.108 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.311652660369873
Epoch: 8, Steps: 18 | Train Loss: 0.499 Vali Loss: 3.849 Vali Acc: 0.470 Test Loss: 3.849 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.02355146408081
Epoch: 9, Steps: 18 | Train Loss: 0.483 Vali Loss: 2.821 Vali Acc: 0.460 Test Loss: 2.821 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.970782041549683
Epoch: 10, Steps: 18 | Train Loss: 0.692 Vali Loss: 2.536 Vali Acc: 0.530 Test Loss: 2.536 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.055612087249756
Epoch: 11, Steps: 18 | Train Loss: 0.279 Vali Loss: 5.018 Vali Acc: 0.450 Test Loss: 5.018 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.791101694107056
Epoch: 12, Steps: 18 | Train Loss: 0.499 Vali Loss: 3.200 Vali Acc: 0.500 Test Loss: 3.200 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.86072063446045
Epoch: 13, Steps: 18 | Train Loss: 0.250 Vali Loss: 3.783 Vali Acc: 0.520 Test Loss: 3.783 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.249172925949097
Epoch: 14, Steps: 18 | Train Loss: 0.906 Vali Loss: 4.390 Vali Acc: 0.530 Test Loss: 4.390 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.49931001663208
Epoch: 15, Steps: 18 | Train Loss: 0.232 Vali Loss: 6.208 Vali Acc: 0.480 Test Loss: 6.208 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3578746
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.297969341278076
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.956 Vali Acc: 0.430 Test Loss: 0.956 Test Acc: 0.430
Validation loss decreased (inf --> -0.429990).  Saving model ...
Epoch: 2 cost time: 9.203745126724243
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.923 Vali Acc: 0.510 Test Loss: 0.923 Test Acc: 0.510
Validation loss decreased (-0.429990 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 8.775070428848267
Epoch: 3, Steps: 18 | Train Loss: 0.808 Vali Loss: 1.465 Vali Acc: 0.500 Test Loss: 1.465 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.553691148757935
Epoch: 4, Steps: 18 | Train Loss: 0.790 Vali Loss: 1.491 Vali Acc: 0.560 Test Loss: 1.491 Test Acc: 0.560
Validation loss decreased (-0.509991 --> -0.559985).  Saving model ...
Epoch: 5 cost time: 9.28230905532837
Epoch: 5, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.633 Vali Acc: 0.590 Test Loss: 1.633 Test Acc: 0.590
Validation loss decreased (-0.559985 --> -0.589984).  Saving model ...
Epoch: 6 cost time: 9.2332923412323
Epoch: 6, Steps: 18 | Train Loss: 0.491 Vali Loss: 2.266 Vali Acc: 0.500 Test Loss: 2.266 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.529515981674194
Epoch: 7, Steps: 18 | Train Loss: 0.528 Vali Loss: 4.140 Vali Acc: 0.490 Test Loss: 4.140 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.958591938018799
Epoch: 8, Steps: 18 | Train Loss: 0.717 Vali Loss: 6.043 Vali Acc: 0.530 Test Loss: 6.043 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.782237529754639
Epoch: 9, Steps: 18 | Train Loss: 0.784 Vali Loss: 4.667 Vali Acc: 0.510 Test Loss: 4.667 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.450479745864868
Epoch: 10, Steps: 18 | Train Loss: 1.179 Vali Loss: 5.341 Vali Acc: 0.510 Test Loss: 5.341 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.492826461791992
Epoch: 11, Steps: 18 | Train Loss: 0.599 Vali Loss: 6.716 Vali Acc: 0.500 Test Loss: 6.716 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.43408751487732
Epoch: 12, Steps: 18 | Train Loss: 0.968 Vali Loss: 6.435 Vali Acc: 0.520 Test Loss: 6.435 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.629786729812622
Epoch: 13, Steps: 18 | Train Loss: 0.161 Vali Loss: 3.645 Vali Acc: 0.490 Test Loss: 3.645 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.654426336288452
Epoch: 14, Steps: 18 | Train Loss: 0.386 Vali Loss: 5.821 Vali Acc: 0.540 Test Loss: 5.821 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.124424934387207
Epoch: 15, Steps: 18 | Train Loss: 0.708 Vali Loss: 9.296 Vali Acc: 0.560 Test Loss: 9.296 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3540346
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.573762893676758
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.023 Vali Acc: 0.510 Test Loss: 1.023 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 7.2965922355651855
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.909 Vali Acc: 0.530 Test Loss: 1.909 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529981).  Saving model ...
Epoch: 3 cost time: 6.994544267654419
Epoch: 3, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.420 Vali Acc: 0.610 Test Loss: 1.420 Test Acc: 0.610
Validation loss decreased (-0.529981 --> -0.609986).  Saving model ...
Epoch: 4 cost time: 6.47119140625
Epoch: 4, Steps: 18 | Train Loss: 0.714 Vali Loss: 2.179 Vali Acc: 0.540 Test Loss: 2.179 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.5050413608551025
Epoch: 5, Steps: 18 | Train Loss: 0.698 Vali Loss: 3.193 Vali Acc: 0.480 Test Loss: 3.193 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.429654359817505
Epoch: 6, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.113 Vali Acc: 0.530 Test Loss: 2.113 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.459131479263306
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 3.864 Vali Acc: 0.570 Test Loss: 3.864 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.796732425689697
Epoch: 8, Steps: 18 | Train Loss: 0.760 Vali Loss: 2.645 Vali Acc: 0.480 Test Loss: 2.645 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.383877992630005
Epoch: 9, Steps: 18 | Train Loss: 0.694 Vali Loss: 2.263 Vali Acc: 0.510 Test Loss: 2.263 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.541183710098267
Epoch: 10, Steps: 18 | Train Loss: 0.905 Vali Loss: 5.569 Vali Acc: 0.560 Test Loss: 5.569 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.211534261703491
Epoch: 11, Steps: 18 | Train Loss: 1.165 Vali Loss: 4.154 Vali Acc: 0.570 Test Loss: 4.154 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.060433864593506
Epoch: 12, Steps: 18 | Train Loss: 1.256 Vali Loss: 6.780 Vali Acc: 0.530 Test Loss: 6.780 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.106238842010498
Epoch: 13, Steps: 18 | Train Loss: 1.394 Vali Loss: 5.075 Vali Acc: 0.530 Test Loss: 5.075 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3509626
model size : 13.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.817834854125977
Epoch: 1, Steps: 18 | Train Loss: 0.847 Vali Loss: 1.257 Vali Acc: 0.510 Test Loss: 1.257 Test Acc: 0.510
Validation loss decreased (inf --> -0.509987).  Saving model ...
Epoch: 2 cost time: 5.195208549499512
Epoch: 2, Steps: 18 | Train Loss: 0.851 Vali Loss: 2.223 Vali Acc: 0.480 Test Loss: 2.223 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.789659023284912
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
Validation loss decreased (-0.509987 --> -0.519987).  Saving model ...
Epoch: 4 cost time: 4.780535697937012
Epoch: 4, Steps: 18 | Train Loss: 0.495 Vali Loss: 2.259 Vali Acc: 0.510 Test Loss: 2.259 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.997446298599243
Epoch: 5, Steps: 18 | Train Loss: 0.555 Vali Loss: 2.743 Vali Acc: 0.540 Test Loss: 2.743 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539973).  Saving model ...
Epoch: 6 cost time: 4.571936845779419
Epoch: 6, Steps: 18 | Train Loss: 0.527 Vali Loss: 3.689 Vali Acc: 0.480 Test Loss: 3.689 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.731683015823364
Epoch: 7, Steps: 18 | Train Loss: 0.676 Vali Loss: 2.616 Vali Acc: 0.530 Test Loss: 2.616 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.910626173019409
Epoch: 8, Steps: 18 | Train Loss: 0.832 Vali Loss: 3.491 Vali Acc: 0.530 Test Loss: 3.491 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.725644588470459
Epoch: 9, Steps: 18 | Train Loss: 0.555 Vali Loss: 3.495 Vali Acc: 0.440 Test Loss: 3.495 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.71396017074585
Epoch: 10, Steps: 18 | Train Loss: 0.516 Vali Loss: 3.909 Vali Acc: 0.430 Test Loss: 3.909 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.784855604171753
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 3.742 Vali Acc: 0.550 Test Loss: 3.742 Test Acc: 0.550
Validation loss decreased (-0.539973 --> -0.549963).  Saving model ...
Epoch: 12 cost time: 4.67146110534668
Epoch: 12, Steps: 18 | Train Loss: 0.144 Vali Loss: 3.943 Vali Acc: 0.530 Test Loss: 3.943 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.717599391937256
Epoch: 13, Steps: 18 | Train Loss: 0.435 Vali Loss: 4.310 Vali Acc: 0.540 Test Loss: 4.310 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8304994106292725
Epoch: 14, Steps: 18 | Train Loss: 0.856 Vali Loss: 4.938 Vali Acc: 0.500 Test Loss: 4.938 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.110155344009399
Epoch: 15, Steps: 18 | Train Loss: 0.122 Vali Loss: 3.983 Vali Acc: 0.470 Test Loss: 3.983 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.858078241348267
Epoch: 16, Steps: 18 | Train Loss: 0.550 Vali Loss: 5.464 Vali Acc: 0.500 Test Loss: 5.464 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.1819140911102295
Epoch: 17, Steps: 18 | Train Loss: 0.077 Vali Loss: 8.036 Vali Acc: 0.480 Test Loss: 8.036 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.341728210449219
Epoch: 18, Steps: 18 | Train Loss: 0.389 Vali Loss: 8.702 Vali Acc: 0.490 Test Loss: 8.702 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.846656799316406
Epoch: 19, Steps: 18 | Train Loss: 0.283 Vali Loss: 14.022 Vali Acc: 0.480 Test Loss: 14.022 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.282235383987427
Epoch: 20, Steps: 18 | Train Loss: 0.336 Vali Loss: 8.447 Vali Acc: 0.530 Test Loss: 8.447 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.874203681945801
Epoch: 21, Steps: 18 | Train Loss: 0.358 Vali Loss: 9.793 Vali Acc: 0.500 Test Loss: 9.793 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3494266
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.818443775177002
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.979720115661621
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 2.652 Vali Acc: 0.430 Test Loss: 2.652 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1446454524993896
Epoch: 3, Steps: 18 | Train Loss: 0.650 Vali Loss: 1.916 Vali Acc: 0.520 Test Loss: 1.916 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519981).  Saving model ...
Epoch: 4 cost time: 3.1971874237060547
Epoch: 4, Steps: 18 | Train Loss: 0.662 Vali Loss: 2.064 Vali Acc: 0.520 Test Loss: 2.064 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.090684413909912
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.530 Vali Acc: 0.590 Test Loss: 1.530 Test Acc: 0.590
Validation loss decreased (-0.519981 --> -0.589985).  Saving model ...
Epoch: 6 cost time: 3.0822432041168213
Epoch: 6, Steps: 18 | Train Loss: 0.491 Vali Loss: 3.229 Vali Acc: 0.500 Test Loss: 3.229 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.297211170196533
Epoch: 7, Steps: 18 | Train Loss: 0.448 Vali Loss: 3.069 Vali Acc: 0.530 Test Loss: 3.069 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8628292083740234
Epoch: 8, Steps: 18 | Train Loss: 1.759 Vali Loss: 3.483 Vali Acc: 0.480 Test Loss: 3.483 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.954406499862671
Epoch: 9, Steps: 18 | Train Loss: 0.550 Vali Loss: 3.315 Vali Acc: 0.470 Test Loss: 3.315 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.972332715988159
Epoch: 10, Steps: 18 | Train Loss: 0.413 Vali Loss: 2.760 Vali Acc: 0.440 Test Loss: 2.760 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2646026611328125
Epoch: 11, Steps: 18 | Train Loss: 0.301 Vali Loss: 4.445 Vali Acc: 0.520 Test Loss: 4.445 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4992799758911133
Epoch: 12, Steps: 18 | Train Loss: 1.991 Vali Loss: 6.952 Vali Acc: 0.510 Test Loss: 6.952 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.673647403717041
Epoch: 13, Steps: 18 | Train Loss: 0.569 Vali Loss: 4.038 Vali Acc: 0.530 Test Loss: 4.038 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.356031656265259
Epoch: 14, Steps: 18 | Train Loss: 0.320 Vali Loss: 5.851 Vali Acc: 0.520 Test Loss: 5.851 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.528325080871582
Epoch: 15, Steps: 18 | Train Loss: 0.425 Vali Loss: 12.449 Vali Acc: 0.470 Test Loss: 12.449 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3478906
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.943073272705078
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.5690760612487793
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.173 Vali Acc: 0.490 Test Loss: 1.173 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.554563045501709
Epoch: 3, Steps: 18 | Train Loss: 0.751 Vali Loss: 1.608 Vali Acc: 0.510 Test Loss: 1.608 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.50822114944458
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.448 Vali Acc: 0.450 Test Loss: 1.448 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4214355945587158
Epoch: 5, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.999 Vali Acc: 0.540 Test Loss: 1.999 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4461948871612549
Epoch: 6, Steps: 18 | Train Loss: 0.444 Vali Loss: 2.963 Vali Acc: 0.570 Test Loss: 2.963 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569970).  Saving model ...
Epoch: 7 cost time: 1.4264757633209229
Epoch: 7, Steps: 18 | Train Loss: 0.419 Vali Loss: 3.451 Vali Acc: 0.440 Test Loss: 3.451 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.36773681640625
Epoch: 8, Steps: 18 | Train Loss: 0.540 Vali Loss: 4.311 Vali Acc: 0.540 Test Loss: 4.311 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4071087837219238
Epoch: 9, Steps: 18 | Train Loss: 0.855 Vali Loss: 8.302 Vali Acc: 0.490 Test Loss: 8.302 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3956613540649414
Epoch: 10, Steps: 18 | Train Loss: 1.163 Vali Loss: 2.903 Vali Acc: 0.570 Test Loss: 2.903 Test Acc: 0.570
Validation loss decreased (-0.569970 --> -0.569971).  Saving model ...
Epoch: 11 cost time: 1.4341988563537598
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 3.262 Vali Acc: 0.580 Test Loss: 3.262 Test Acc: 0.580
Validation loss decreased (-0.569971 --> -0.579967).  Saving model ...
Epoch: 12 cost time: 1.4280381202697754
Epoch: 12, Steps: 18 | Train Loss: 0.556 Vali Loss: 4.436 Vali Acc: 0.500 Test Loss: 4.436 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.313976526260376
Epoch: 13, Steps: 18 | Train Loss: 0.709 Vali Loss: 7.324 Vali Acc: 0.470 Test Loss: 7.324 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3367938995361328
Epoch: 14, Steps: 18 | Train Loss: 0.732 Vali Loss: 5.549 Vali Acc: 0.510 Test Loss: 5.549 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3134715557098389
Epoch: 15, Steps: 18 | Train Loss: 0.386 Vali Loss: 7.025 Vali Acc: 0.410 Test Loss: 7.025 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3784315586090088
Epoch: 16, Steps: 18 | Train Loss: 0.942 Vali Loss: 9.978 Vali Acc: 0.530 Test Loss: 9.978 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3978381156921387
Epoch: 17, Steps: 18 | Train Loss: 0.579 Vali Loss: 6.448 Vali Acc: 0.550 Test Loss: 6.448 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3639423847198486
Epoch: 18, Steps: 18 | Train Loss: 0.495 Vali Loss: 7.535 Vali Acc: 0.510 Test Loss: 7.535 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.446521282196045
Epoch: 19, Steps: 18 | Train Loss: 0.987 Vali Loss: 7.362 Vali Acc: 0.510 Test Loss: 7.362 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3675720691680908
Epoch: 20, Steps: 18 | Train Loss: 1.891 Vali Loss: 10.944 Vali Acc: 0.470 Test Loss: 10.944 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4161617755889893
Epoch: 21, Steps: 18 | Train Loss: 0.585 Vali Loss: 8.399 Vali Acc: 0.570 Test Loss: 8.399 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3464058
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.382882356643677
Epoch: 1, Steps: 18 | Train Loss: 0.858 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 24.430717706680298
Epoch: 2, Steps: 18 | Train Loss: 0.742 Vali Loss: 1.157 Vali Acc: 0.630 Test Loss: 1.157 Test Acc: 0.630
Validation loss decreased (-0.449988 --> -0.629988).  Saving model ...
Epoch: 3 cost time: 24.23596739768982
Epoch: 3, Steps: 18 | Train Loss: 0.886 Vali Loss: 1.316 Vali Acc: 0.520 Test Loss: 1.316 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.656476259231567
Epoch: 4, Steps: 18 | Train Loss: 0.732 Vali Loss: 1.202 Vali Acc: 0.560 Test Loss: 1.202 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.698335886001587
Epoch: 5, Steps: 18 | Train Loss: 0.486 Vali Loss: 1.837 Vali Acc: 0.600 Test Loss: 1.837 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.177162647247314
Epoch: 6, Steps: 18 | Train Loss: 0.927 Vali Loss: 3.222 Vali Acc: 0.490 Test Loss: 3.222 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.65168046951294
Epoch: 7, Steps: 18 | Train Loss: 1.429 Vali Loss: 5.241 Vali Acc: 0.470 Test Loss: 5.241 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.051135778427124
Epoch: 8, Steps: 18 | Train Loss: 0.994 Vali Loss: 4.600 Vali Acc: 0.500 Test Loss: 4.600 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.71773862838745
Epoch: 9, Steps: 18 | Train Loss: 0.536 Vali Loss: 2.533 Vali Acc: 0.430 Test Loss: 2.533 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.682990789413452
Epoch: 10, Steps: 18 | Train Loss: 0.494 Vali Loss: 3.071 Vali Acc: 0.440 Test Loss: 3.071 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.48456335067749
Epoch: 11, Steps: 18 | Train Loss: 0.432 Vali Loss: 3.534 Vali Acc: 0.510 Test Loss: 3.534 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.811325550079346
Epoch: 12, Steps: 18 | Train Loss: 0.522 Vali Loss: 4.193 Vali Acc: 0.490 Test Loss: 4.193 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3655030
model size : 15.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.058359622955322
Epoch: 1, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.820 Vali Acc: 0.600 Test Loss: 0.820 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 19.703928232192993
Epoch: 2, Steps: 18 | Train Loss: 0.778 Vali Loss: 1.947 Vali Acc: 0.490 Test Loss: 1.947 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.201512098312378
Epoch: 3, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.292 Vali Acc: 0.510 Test Loss: 1.292 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.534724950790405
Epoch: 4, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.323 Vali Acc: 0.510 Test Loss: 1.323 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.24963068962097
Epoch: 5, Steps: 18 | Train Loss: 0.462 Vali Loss: 2.950 Vali Acc: 0.520 Test Loss: 2.950 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.94227957725525
Epoch: 6, Steps: 18 | Train Loss: 0.702 Vali Loss: 2.517 Vali Acc: 0.510 Test Loss: 2.517 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.42376399040222
Epoch: 7, Steps: 18 | Train Loss: 0.636 Vali Loss: 1.859 Vali Acc: 0.610 Test Loss: 1.859 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609981).  Saving model ...
Epoch: 8 cost time: 20.2323899269104
Epoch: 8, Steps: 18 | Train Loss: 0.624 Vali Loss: 5.825 Vali Acc: 0.500 Test Loss: 5.825 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.91173815727234
Epoch: 9, Steps: 18 | Train Loss: 1.147 Vali Loss: 7.268 Vali Acc: 0.480 Test Loss: 7.268 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.054373741149902
Epoch: 10, Steps: 18 | Train Loss: 0.401 Vali Loss: 3.709 Vali Acc: 0.530 Test Loss: 3.709 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.146721363067627
Epoch: 11, Steps: 18 | Train Loss: 0.389 Vali Loss: 3.160 Vali Acc: 0.480 Test Loss: 3.160 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.290167570114136
Epoch: 12, Steps: 18 | Train Loss: 0.550 Vali Loss: 5.956 Vali Acc: 0.490 Test Loss: 5.956 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 19.07420778274536
Epoch: 13, Steps: 18 | Train Loss: 0.896 Vali Loss: 6.358 Vali Acc: 0.480 Test Loss: 6.358 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 18.441854238510132
Epoch: 14, Steps: 18 | Train Loss: 0.461 Vali Loss: 3.208 Vali Acc: 0.590 Test Loss: 3.208 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.13265585899353
Epoch: 15, Steps: 18 | Train Loss: 0.416 Vali Loss: 6.211 Vali Acc: 0.510 Test Loss: 6.211 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.321701526641846
Epoch: 16, Steps: 18 | Train Loss: 0.187 Vali Loss: 4.173 Vali Acc: 0.560 Test Loss: 4.173 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 17.97684335708618
Epoch: 17, Steps: 18 | Train Loss: 0.658 Vali Loss: 4.074 Vali Acc: 0.490 Test Loss: 4.074 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3616630
model size : 14.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.65390133857727
Epoch: 1, Steps: 18 | Train Loss: 0.807 Vali Loss: 1.185 Vali Acc: 0.480 Test Loss: 1.185 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 13.489104270935059
Epoch: 2, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
Validation loss decreased (-0.479988 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 13.364118099212646
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.522 Vali Acc: 0.480 Test Loss: 1.522 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.993123531341553
Epoch: 4, Steps: 18 | Train Loss: 1.080 Vali Loss: 3.408 Vali Acc: 0.510 Test Loss: 3.408 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.749696731567383
Epoch: 5, Steps: 18 | Train Loss: 1.719 Vali Loss: 1.309 Vali Acc: 0.580 Test Loss: 1.309 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579987).  Saving model ...
Epoch: 6 cost time: 14.720088005065918
Epoch: 6, Steps: 18 | Train Loss: 0.819 Vali Loss: 2.261 Vali Acc: 0.480 Test Loss: 2.261 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.94038200378418
Epoch: 7, Steps: 18 | Train Loss: 0.928 Vali Loss: 3.493 Vali Acc: 0.480 Test Loss: 3.493 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.58303952217102
Epoch: 8, Steps: 18 | Train Loss: 0.584 Vali Loss: 3.457 Vali Acc: 0.580 Test Loss: 3.457 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.80461049079895
Epoch: 9, Steps: 18 | Train Loss: 0.634 Vali Loss: 2.173 Vali Acc: 0.460 Test Loss: 2.173 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.751466035842896
Epoch: 10, Steps: 18 | Train Loss: 0.592 Vali Loss: 4.308 Vali Acc: 0.490 Test Loss: 4.308 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.249464511871338
Epoch: 11, Steps: 18 | Train Loss: 0.425 Vali Loss: 4.214 Vali Acc: 0.470 Test Loss: 4.214 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.000580549240112
Epoch: 12, Steps: 18 | Train Loss: 0.337 Vali Loss: 3.612 Vali Acc: 0.540 Test Loss: 3.612 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.328071117401123
Epoch: 13, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.753 Vali Acc: 0.530 Test Loss: 2.753 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.488192796707153
Epoch: 14, Steps: 18 | Train Loss: 0.356 Vali Loss: 7.684 Vali Acc: 0.500 Test Loss: 7.684 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.705629825592041
Epoch: 15, Steps: 18 | Train Loss: 0.568 Vali Loss: 5.830 Vali Acc: 0.500 Test Loss: 5.830 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3578230
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.238241195678711
Epoch: 1, Steps: 18 | Train Loss: 0.989 Vali Loss: 0.964 Vali Acc: 0.550 Test Loss: 0.964 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 8.852324962615967
Epoch: 2, Steps: 18 | Train Loss: 0.855 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.754878520965576
Epoch: 3, Steps: 18 | Train Loss: 0.793 Vali Loss: 1.710 Vali Acc: 0.470 Test Loss: 1.710 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.934898853302002
Epoch: 4, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.380 Vali Acc: 0.570 Test Loss: 1.380 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569986).  Saving model ...
Epoch: 5 cost time: 10.19608998298645
Epoch: 5, Steps: 18 | Train Loss: 0.987 Vali Loss: 1.839 Vali Acc: 0.490 Test Loss: 1.839 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.72645378112793
Epoch: 6, Steps: 18 | Train Loss: 0.992 Vali Loss: 1.766 Vali Acc: 0.540 Test Loss: 1.766 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.884013175964355
Epoch: 7, Steps: 18 | Train Loss: 0.402 Vali Loss: 2.191 Vali Acc: 0.520 Test Loss: 2.191 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.426986932754517
Epoch: 8, Steps: 18 | Train Loss: 0.541 Vali Loss: 5.472 Vali Acc: 0.500 Test Loss: 5.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.659660816192627
Epoch: 9, Steps: 18 | Train Loss: 2.146 Vali Loss: 5.300 Vali Acc: 0.480 Test Loss: 5.300 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.489204168319702
Epoch: 10, Steps: 18 | Train Loss: 1.421 Vali Loss: 5.849 Vali Acc: 0.550 Test Loss: 5.849 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.269845962524414
Epoch: 11, Steps: 18 | Train Loss: 1.626 Vali Loss: 3.714 Vali Acc: 0.570 Test Loss: 3.714 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.194754362106323
Epoch: 12, Steps: 18 | Train Loss: 0.921 Vali Loss: 2.953 Vali Acc: 0.500 Test Loss: 2.953 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.372454643249512
Epoch: 13, Steps: 18 | Train Loss: 1.141 Vali Loss: 3.927 Vali Acc: 0.470 Test Loss: 3.927 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.103410959243774
Epoch: 14, Steps: 18 | Train Loss: 1.536 Vali Loss: 11.018 Vali Acc: 0.470 Test Loss: 11.018 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3539830
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.122854232788086
Epoch: 1, Steps: 18 | Train Loss: 1.096 Vali Loss: 1.151 Vali Acc: 0.490 Test Loss: 1.151 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 6.125914573669434
Epoch: 2, Steps: 18 | Train Loss: 0.926 Vali Loss: 1.371 Vali Acc: 0.540 Test Loss: 1.371 Test Acc: 0.540
Validation loss decreased (-0.489988 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 6.090604066848755
Epoch: 3, Steps: 18 | Train Loss: 0.854 Vali Loss: 2.661 Vali Acc: 0.510 Test Loss: 2.661 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.832990884780884
Epoch: 4, Steps: 18 | Train Loss: 1.478 Vali Loss: 2.745 Vali Acc: 0.470 Test Loss: 2.745 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.819963216781616
Epoch: 5, Steps: 18 | Train Loss: 0.951 Vali Loss: 1.819 Vali Acc: 0.490 Test Loss: 1.819 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.8029279708862305
Epoch: 6, Steps: 18 | Train Loss: 0.777 Vali Loss: 2.547 Vali Acc: 0.560 Test Loss: 2.547 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559975).  Saving model ...
Epoch: 7 cost time: 6.08649468421936
Epoch: 7, Steps: 18 | Train Loss: 0.754 Vali Loss: 3.652 Vali Acc: 0.490 Test Loss: 3.652 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.229475736618042
Epoch: 8, Steps: 18 | Train Loss: 0.964 Vali Loss: 4.504 Vali Acc: 0.500 Test Loss: 4.504 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8841657638549805
Epoch: 9, Steps: 18 | Train Loss: 0.350 Vali Loss: 5.540 Vali Acc: 0.480 Test Loss: 5.540 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.640507698059082
Epoch: 10, Steps: 18 | Train Loss: 1.028 Vali Loss: 8.157 Vali Acc: 0.510 Test Loss: 8.157 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.588079214096069
Epoch: 11, Steps: 18 | Train Loss: 1.864 Vali Loss: 6.373 Vali Acc: 0.520 Test Loss: 6.373 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.373760223388672
Epoch: 12, Steps: 18 | Train Loss: 0.642 Vali Loss: 3.137 Vali Acc: 0.550 Test Loss: 3.137 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.929901838302612
Epoch: 13, Steps: 18 | Train Loss: 0.613 Vali Loss: 5.035 Vali Acc: 0.570 Test Loss: 5.035 Test Acc: 0.570
Validation loss decreased (-0.559975 --> -0.569950).  Saving model ...
Epoch: 14 cost time: 5.694580078125
Epoch: 14, Steps: 18 | Train Loss: 0.874 Vali Loss: 4.622 Vali Acc: 0.530 Test Loss: 4.622 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.056562662124634
Epoch: 15, Steps: 18 | Train Loss: 0.277 Vali Loss: 7.187 Vali Acc: 0.560 Test Loss: 7.187 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.8119587898254395
Epoch: 16, Steps: 18 | Train Loss: 0.335 Vali Loss: 5.395 Vali Acc: 0.510 Test Loss: 5.395 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.482219457626343
Epoch: 17, Steps: 18 | Train Loss: 0.240 Vali Loss: 4.725 Vali Acc: 0.530 Test Loss: 4.725 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.712075710296631
Epoch: 18, Steps: 18 | Train Loss: 0.177 Vali Loss: 7.445 Vali Acc: 0.500 Test Loss: 7.445 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.881215333938599
Epoch: 19, Steps: 18 | Train Loss: 0.779 Vali Loss: 9.925 Vali Acc: 0.500 Test Loss: 9.925 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.81386137008667
Epoch: 20, Steps: 18 | Train Loss: 1.875 Vali Loss: 8.103 Vali Acc: 0.570 Test Loss: 8.103 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.87596583366394
Epoch: 21, Steps: 18 | Train Loss: 0.526 Vali Loss: 7.117 Vali Acc: 0.550 Test Loss: 7.117 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.8607988357543945
Epoch: 22, Steps: 18 | Train Loss: 0.317 Vali Loss: 9.476 Vali Acc: 0.500 Test Loss: 9.476 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.855085372924805
Epoch: 23, Steps: 18 | Train Loss: 0.268 Vali Loss: 8.204 Vali Acc: 0.500 Test Loss: 8.204 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3509110
model size : 13.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.057342052459717
Epoch: 1, Steps: 18 | Train Loss: 1.017 Vali Loss: 1.539 Vali Acc: 0.500 Test Loss: 1.539 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 4.706926584243774
Epoch: 2, Steps: 18 | Train Loss: 1.116 Vali Loss: 1.328 Vali Acc: 0.560 Test Loss: 1.328 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559987).  Saving model ...
Epoch: 3 cost time: 4.971713066101074
Epoch: 3, Steps: 18 | Train Loss: 0.965 Vali Loss: 1.960 Vali Acc: 0.480 Test Loss: 1.960 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.055252552032471
Epoch: 4, Steps: 18 | Train Loss: 0.635 Vali Loss: 1.231 Vali Acc: 0.530 Test Loss: 1.231 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.550755500793457
Epoch: 5, Steps: 18 | Train Loss: 0.797 Vali Loss: 1.777 Vali Acc: 0.540 Test Loss: 1.777 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.363434314727783
Epoch: 6, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.752 Vali Acc: 0.540 Test Loss: 1.752 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.493051767349243
Epoch: 7, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.331 Vali Acc: 0.520 Test Loss: 1.331 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.514706611633301
Epoch: 8, Steps: 18 | Train Loss: 0.469 Vali Loss: 2.018 Vali Acc: 0.510 Test Loss: 2.018 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.428368091583252
Epoch: 9, Steps: 18 | Train Loss: 0.805 Vali Loss: 3.415 Vali Acc: 0.640 Test Loss: 3.415 Test Acc: 0.640
Validation loss decreased (-0.559987 --> -0.639966).  Saving model ...
Epoch: 10 cost time: 4.555434465408325
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 2.749 Vali Acc: 0.520 Test Loss: 2.749 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.271845579147339
Epoch: 11, Steps: 18 | Train Loss: 0.562 Vali Loss: 5.187 Vali Acc: 0.510 Test Loss: 5.187 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.438815593719482
Epoch: 12, Steps: 18 | Train Loss: 0.244 Vali Loss: 3.270 Vali Acc: 0.440 Test Loss: 3.270 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.618619441986084
Epoch: 13, Steps: 18 | Train Loss: 0.691 Vali Loss: 7.447 Vali Acc: 0.510 Test Loss: 7.447 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.2511632442474365
Epoch: 14, Steps: 18 | Train Loss: 1.474 Vali Loss: 5.525 Vali Acc: 0.500 Test Loss: 5.525 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.545689105987549
Epoch: 15, Steps: 18 | Train Loss: 0.648 Vali Loss: 8.350 Vali Acc: 0.490 Test Loss: 8.350 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.975109338760376
Epoch: 16, Steps: 18 | Train Loss: 0.293 Vali Loss: 14.084 Vali Acc: 0.470 Test Loss: 14.084 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.564682483673096
Epoch: 17, Steps: 18 | Train Loss: 0.910 Vali Loss: 11.473 Vali Acc: 0.500 Test Loss: 11.473 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.413665056228638
Epoch: 18, Steps: 18 | Train Loss: 0.605 Vali Loss: 6.858 Vali Acc: 0.540 Test Loss: 6.858 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.8041441440582275
Epoch: 19, Steps: 18 | Train Loss: 0.339 Vali Loss: 8.468 Vali Acc: 0.450 Test Loss: 8.468 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3493750
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.789879083633423
Epoch: 1, Steps: 18 | Train Loss: 0.906 Vali Loss: 1.054 Vali Acc: 0.490 Test Loss: 1.054 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 2.668257236480713
Epoch: 2, Steps: 18 | Train Loss: 0.823 Vali Loss: 1.384 Vali Acc: 0.510 Test Loss: 1.384 Test Acc: 0.510
Validation loss decreased (-0.489989 --> -0.509986).  Saving model ...
Epoch: 3 cost time: 2.735431432723999
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.250 Vali Acc: 0.560 Test Loss: 1.250 Test Acc: 0.560
Validation loss decreased (-0.509986 --> -0.559987).  Saving model ...
Epoch: 4 cost time: 2.68326473236084
Epoch: 4, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.645 Vali Acc: 0.460 Test Loss: 1.645 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6380558013916016
Epoch: 5, Steps: 18 | Train Loss: 0.722 Vali Loss: 3.012 Vali Acc: 0.530 Test Loss: 3.012 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.599501371383667
Epoch: 6, Steps: 18 | Train Loss: 0.797 Vali Loss: 2.003 Vali Acc: 0.530 Test Loss: 2.003 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6793813705444336
Epoch: 7, Steps: 18 | Train Loss: 0.408 Vali Loss: 2.703 Vali Acc: 0.540 Test Loss: 2.703 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8256797790527344
Epoch: 8, Steps: 18 | Train Loss: 0.546 Vali Loss: 4.829 Vali Acc: 0.560 Test Loss: 4.829 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7609989643096924
Epoch: 9, Steps: 18 | Train Loss: 1.408 Vali Loss: 2.689 Vali Acc: 0.550 Test Loss: 2.689 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6819708347320557
Epoch: 10, Steps: 18 | Train Loss: 0.625 Vali Loss: 2.223 Vali Acc: 0.530 Test Loss: 2.223 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.690459728240967
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 7.074 Vali Acc: 0.500 Test Loss: 7.074 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7166662216186523
Epoch: 12, Steps: 18 | Train Loss: 0.539 Vali Loss: 5.375 Vali Acc: 0.510 Test Loss: 5.375 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7133772373199463
Epoch: 13, Steps: 18 | Train Loss: 0.932 Vali Loss: 10.505 Vali Acc: 0.500 Test Loss: 10.505 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3478390
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.595288038253784
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.4154326915740967
Epoch: 2, Steps: 18 | Train Loss: 0.911 Vali Loss: 1.086 Vali Acc: 0.510 Test Loss: 1.086 Test Acc: 0.510
Validation loss decreased (-0.499988 --> -0.509989).  Saving model ...
Epoch: 3 cost time: 1.4008684158325195
Epoch: 3, Steps: 18 | Train Loss: 0.704 Vali Loss: 1.433 Vali Acc: 0.480 Test Loss: 1.433 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3735644817352295
Epoch: 4, Steps: 18 | Train Loss: 0.772 Vali Loss: 1.483 Vali Acc: 0.440 Test Loss: 1.483 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.418717861175537
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 1.639 Vali Acc: 0.510 Test Loss: 1.639 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.363755702972412
Epoch: 6, Steps: 18 | Train Loss: 0.753 Vali Loss: 1.304 Vali Acc: 0.520 Test Loss: 1.304 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 1.339202880859375
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.986 Vali Acc: 0.510 Test Loss: 1.986 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2694730758666992
Epoch: 8, Steps: 18 | Train Loss: 0.453 Vali Loss: 3.637 Vali Acc: 0.540 Test Loss: 3.637 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539964).  Saving model ...
Epoch: 9 cost time: 1.362837314605713
Epoch: 9, Steps: 18 | Train Loss: 0.393 Vali Loss: 3.948 Vali Acc: 0.500 Test Loss: 3.948 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5031177997589111
Epoch: 10, Steps: 18 | Train Loss: 1.159 Vali Loss: 7.142 Vali Acc: 0.460 Test Loss: 7.142 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2862558364868164
Epoch: 11, Steps: 18 | Train Loss: 0.871 Vali Loss: 3.872 Vali Acc: 0.560 Test Loss: 3.872 Test Acc: 0.560
Validation loss decreased (-0.539964 --> -0.559961).  Saving model ...
Epoch: 12 cost time: 1.223095178604126
Epoch: 12, Steps: 18 | Train Loss: 0.572 Vali Loss: 3.792 Vali Acc: 0.500 Test Loss: 3.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.301867961883545
Epoch: 13, Steps: 18 | Train Loss: 1.325 Vali Loss: 6.075 Vali Acc: 0.500 Test Loss: 6.075 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.201700210571289
Epoch: 14, Steps: 18 | Train Loss: 1.025 Vali Loss: 7.836 Vali Acc: 0.510 Test Loss: 7.836 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.292173147201538
Epoch: 15, Steps: 18 | Train Loss: 0.466 Vali Loss: 5.091 Vali Acc: 0.540 Test Loss: 5.091 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2541093826293945
Epoch: 16, Steps: 18 | Train Loss: 0.873 Vali Loss: 4.981 Vali Acc: 0.500 Test Loss: 4.981 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2927966117858887
Epoch: 17, Steps: 18 | Train Loss: 0.406 Vali Loss: 4.721 Vali Acc: 0.450 Test Loss: 4.721 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2687065601348877
Epoch: 18, Steps: 18 | Train Loss: 1.153 Vali Loss: 5.582 Vali Acc: 0.520 Test Loss: 5.582 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2548637390136719
Epoch: 19, Steps: 18 | Train Loss: 0.500 Vali Loss: 4.764 Vali Acc: 0.560 Test Loss: 4.764 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2509479522705078
Epoch: 20, Steps: 18 | Train Loss: 0.993 Vali Loss: 8.621 Vali Acc: 0.510 Test Loss: 8.621 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.375641107559204
Epoch: 21, Steps: 18 | Train Loss: 1.039 Vali Loss: 6.817 Vali Acc: 0.450 Test Loss: 6.817 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3463542
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.3353750705719
Epoch: 1, Steps: 18 | Train Loss: 0.880 Vali Loss: 0.916 Vali Acc: 0.590 Test Loss: 0.916 Test Acc: 0.590
Validation loss decreased (inf --> -0.589991).  Saving model ...
Epoch: 2 cost time: 22.82117247581482
Epoch: 2, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.294698476791382
Epoch: 3, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.525 Vali Acc: 0.560 Test Loss: 1.525 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.473490476608276
Epoch: 4, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.090 Vali Acc: 0.480 Test Loss: 2.090 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.266571760177612
Epoch: 5, Steps: 18 | Train Loss: 0.223 Vali Loss: 3.195 Vali Acc: 0.430 Test Loss: 3.195 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.04570508003235
Epoch: 6, Steps: 18 | Train Loss: 0.644 Vali Loss: 2.312 Vali Acc: 0.590 Test Loss: 2.312 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.144375562667847
Epoch: 7, Steps: 18 | Train Loss: 0.142 Vali Loss: 2.345 Vali Acc: 0.590 Test Loss: 2.345 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.88265061378479
Epoch: 8, Steps: 18 | Train Loss: 0.310 Vali Loss: 3.558 Vali Acc: 0.520 Test Loss: 3.558 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.204782485961914
Epoch: 9, Steps: 18 | Train Loss: 0.883 Vali Loss: 5.832 Vali Acc: 0.480 Test Loss: 5.832 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 22.414122104644775
Epoch: 10, Steps: 18 | Train Loss: 0.379 Vali Loss: 3.933 Vali Acc: 0.480 Test Loss: 3.933 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.61698627471924
Epoch: 11, Steps: 18 | Train Loss: 0.428 Vali Loss: 5.716 Vali Acc: 0.550 Test Loss: 5.716 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3654386
model size : 15.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.80793261528015
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.841 Vali Acc: 0.540 Test Loss: 0.841 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 17.933406352996826
Epoch: 2, Steps: 18 | Train Loss: 0.794 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.583263158798218
Epoch: 3, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.647 Vali Acc: 0.510 Test Loss: 1.647 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.56875205039978
Epoch: 4, Steps: 18 | Train Loss: 0.277 Vali Loss: 3.567 Vali Acc: 0.480 Test Loss: 3.567 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.83089256286621
Epoch: 5, Steps: 18 | Train Loss: 0.337 Vali Loss: 2.901 Vali Acc: 0.480 Test Loss: 2.901 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.392903327941895
Epoch: 6, Steps: 18 | Train Loss: 0.211 Vali Loss: 2.360 Vali Acc: 0.530 Test Loss: 2.360 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.52142572402954
Epoch: 7, Steps: 18 | Train Loss: 0.406 Vali Loss: 4.431 Vali Acc: 0.490 Test Loss: 4.431 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.54342222213745
Epoch: 8, Steps: 18 | Train Loss: 0.310 Vali Loss: 4.318 Vali Acc: 0.550 Test Loss: 4.318 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549957).  Saving model ...
Epoch: 9 cost time: 20.04842185974121
Epoch: 9, Steps: 18 | Train Loss: 0.598 Vali Loss: 4.101 Vali Acc: 0.490 Test Loss: 4.101 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.794008255004883
Epoch: 10, Steps: 18 | Train Loss: 0.271 Vali Loss: 4.946 Vali Acc: 0.480 Test Loss: 4.946 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.917046070098877
Epoch: 11, Steps: 18 | Train Loss: 0.483 Vali Loss: 4.164 Vali Acc: 0.500 Test Loss: 4.164 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.56193494796753
Epoch: 12, Steps: 18 | Train Loss: 0.313 Vali Loss: 5.202 Vali Acc: 0.470 Test Loss: 5.202 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.771292686462402
Epoch: 13, Steps: 18 | Train Loss: 0.219 Vali Loss: 6.521 Vali Acc: 0.540 Test Loss: 6.521 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.314756393432617
Epoch: 14, Steps: 18 | Train Loss: 0.849 Vali Loss: 5.547 Vali Acc: 0.510 Test Loss: 5.547 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.581804037094116
Epoch: 15, Steps: 18 | Train Loss: 0.595 Vali Loss: 9.204 Vali Acc: 0.490 Test Loss: 9.204 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 18.555397510528564
Epoch: 16, Steps: 18 | Train Loss: 0.642 Vali Loss: 8.012 Vali Acc: 0.450 Test Loss: 8.012 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.91861081123352
Epoch: 17, Steps: 18 | Train Loss: 0.526 Vali Loss: 5.130 Vali Acc: 0.420 Test Loss: 5.130 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 19.32096815109253
Epoch: 18, Steps: 18 | Train Loss: 0.124 Vali Loss: 8.852 Vali Acc: 0.520 Test Loss: 8.852 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3615986
model size : 14.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.347804546356201
Epoch: 1, Steps: 18 | Train Loss: 0.913 Vali Loss: 1.080 Vali Acc: 0.470 Test Loss: 1.080 Test Acc: 0.470
Validation loss decreased (inf --> -0.469989).  Saving model ...
Epoch: 2 cost time: 13.050847291946411
Epoch: 2, Steps: 18 | Train Loss: 0.529 Vali Loss: 1.137 Vali Acc: 0.490 Test Loss: 1.137 Test Acc: 0.490
Validation loss decreased (-0.469989 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 13.274916887283325
Epoch: 3, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.935 Vali Acc: 0.530 Test Loss: 1.935 Test Acc: 0.530
Validation loss decreased (-0.489989 --> -0.529981).  Saving model ...
Epoch: 4 cost time: 13.895667791366577
Epoch: 4, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.985 Vali Acc: 0.500 Test Loss: 1.985 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.750799894332886
Epoch: 5, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.285 Vali Acc: 0.570 Test Loss: 2.285 Test Acc: 0.570
Validation loss decreased (-0.529981 --> -0.569977).  Saving model ...
Epoch: 6 cost time: 12.546099424362183
Epoch: 6, Steps: 18 | Train Loss: 0.242 Vali Loss: 2.140 Vali Acc: 0.500 Test Loss: 2.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.12588119506836
Epoch: 7, Steps: 18 | Train Loss: 0.321 Vali Loss: 4.018 Vali Acc: 0.470 Test Loss: 4.018 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.068641662597656
Epoch: 8, Steps: 18 | Train Loss: 0.426 Vali Loss: 3.906 Vali Acc: 0.510 Test Loss: 3.906 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.383460283279419
Epoch: 9, Steps: 18 | Train Loss: 0.379 Vali Loss: 4.113 Vali Acc: 0.530 Test Loss: 4.113 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.88374662399292
Epoch: 10, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.586 Vali Acc: 0.500 Test Loss: 4.586 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.767961502075195
Epoch: 11, Steps: 18 | Train Loss: 0.191 Vali Loss: 3.705 Vali Acc: 0.480 Test Loss: 3.705 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.30828332901001
Epoch: 12, Steps: 18 | Train Loss: 0.469 Vali Loss: 4.730 Vali Acc: 0.530 Test Loss: 4.730 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.639966249465942
Epoch: 13, Steps: 18 | Train Loss: 0.293 Vali Loss: 10.104 Vali Acc: 0.480 Test Loss: 10.104 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.408386707305908
Epoch: 14, Steps: 18 | Train Loss: 0.586 Vali Loss: 6.715 Vali Acc: 0.490 Test Loss: 6.715 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.814471244812012
Epoch: 15, Steps: 18 | Train Loss: 0.460 Vali Loss: 5.717 Vali Acc: 0.520 Test Loss: 5.717 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3577586
model size : 14.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.452005863189697
Epoch: 1, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.996 Vali Acc: 0.530 Test Loss: 0.996 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 9.03629755973816
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.928 Vali Acc: 0.500 Test Loss: 1.928 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.363264083862305
Epoch: 3, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.833 Vali Acc: 0.510 Test Loss: 1.833 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.366365671157837
Epoch: 4, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.474 Vali Acc: 0.550 Test Loss: 2.474 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549975).  Saving model ...
Epoch: 5 cost time: 8.93201994895935
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 4.954 Vali Acc: 0.440 Test Loss: 4.954 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.857990980148315
Epoch: 6, Steps: 18 | Train Loss: 0.624 Vali Loss: 2.665 Vali Acc: 0.530 Test Loss: 2.665 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.655199527740479
Epoch: 7, Steps: 18 | Train Loss: 0.228 Vali Loss: 3.473 Vali Acc: 0.580 Test Loss: 3.473 Test Acc: 0.580
Validation loss decreased (-0.549975 --> -0.579965).  Saving model ...
Epoch: 8 cost time: 9.257705450057983
Epoch: 8, Steps: 18 | Train Loss: 0.629 Vali Loss: 4.417 Vali Acc: 0.490 Test Loss: 4.417 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.051970481872559
Epoch: 9, Steps: 18 | Train Loss: 0.576 Vali Loss: 4.667 Vali Acc: 0.500 Test Loss: 4.667 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.23305892944336
Epoch: 10, Steps: 18 | Train Loss: 0.387 Vali Loss: 5.930 Vali Acc: 0.500 Test Loss: 5.930 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.785758018493652
Epoch: 11, Steps: 18 | Train Loss: 0.169 Vali Loss: 7.777 Vali Acc: 0.500 Test Loss: 7.777 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.400509595870972
Epoch: 12, Steps: 18 | Train Loss: 0.565 Vali Loss: 4.513 Vali Acc: 0.570 Test Loss: 4.513 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.594293117523193
Epoch: 13, Steps: 18 | Train Loss: 0.250 Vali Loss: 4.867 Vali Acc: 0.510 Test Loss: 4.867 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.746074914932251
Epoch: 14, Steps: 18 | Train Loss: 0.235 Vali Loss: 6.530 Vali Acc: 0.510 Test Loss: 6.530 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.030940532684326
Epoch: 15, Steps: 18 | Train Loss: 0.646 Vali Loss: 7.222 Vali Acc: 0.530 Test Loss: 7.222 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.580708742141724
Epoch: 16, Steps: 18 | Train Loss: 0.435 Vali Loss: 10.666 Vali Acc: 0.500 Test Loss: 10.666 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.72909164428711
Epoch: 17, Steps: 18 | Train Loss: 0.542 Vali Loss: 9.257 Vali Acc: 0.500 Test Loss: 9.257 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3539186
model size : 13.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.169569730758667
Epoch: 1, Steps: 18 | Train Loss: 0.844 Vali Loss: 1.902 Vali Acc: 0.480 Test Loss: 1.902 Test Acc: 0.480
Validation loss decreased (inf --> -0.479981).  Saving model ...
Epoch: 2 cost time: 6.210991621017456
Epoch: 2, Steps: 18 | Train Loss: 0.650 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 5.663793563842773
Epoch: 3, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.974 Vali Acc: 0.520 Test Loss: 1.974 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519980).  Saving model ...
Epoch: 4 cost time: 5.485937595367432
Epoch: 4, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.785 Vali Acc: 0.530 Test Loss: 1.785 Test Acc: 0.530
Validation loss decreased (-0.519980 --> -0.529982).  Saving model ...
Epoch: 5 cost time: 5.739063024520874
Epoch: 5, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.611 Vali Acc: 0.550 Test Loss: 2.611 Test Acc: 0.550
Validation loss decreased (-0.529982 --> -0.549974).  Saving model ...
Epoch: 6 cost time: 5.7337236404418945
Epoch: 6, Steps: 18 | Train Loss: 0.443 Vali Loss: 2.199 Vali Acc: 0.490 Test Loss: 2.199 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.339633464813232
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 3.115 Vali Acc: 0.470 Test Loss: 3.115 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.252696514129639
Epoch: 8, Steps: 18 | Train Loss: 0.299 Vali Loss: 5.684 Vali Acc: 0.440 Test Loss: 5.684 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.075096607208252
Epoch: 9, Steps: 18 | Train Loss: 0.132 Vali Loss: 5.673 Vali Acc: 0.560 Test Loss: 5.673 Test Acc: 0.560
Validation loss decreased (-0.549974 --> -0.559943).  Saving model ...
Epoch: 10 cost time: 5.850241422653198
Epoch: 10, Steps: 18 | Train Loss: 0.429 Vali Loss: 6.703 Vali Acc: 0.480 Test Loss: 6.703 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.778036594390869
Epoch: 11, Steps: 18 | Train Loss: 0.331 Vali Loss: 5.504 Vali Acc: 0.480 Test Loss: 5.504 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.284679651260376
Epoch: 12, Steps: 18 | Train Loss: 0.196 Vali Loss: 5.594 Vali Acc: 0.460 Test Loss: 5.594 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.063398122787476
Epoch: 13, Steps: 18 | Train Loss: 0.180 Vali Loss: 5.740 Vali Acc: 0.520 Test Loss: 5.740 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.6330626010894775
Epoch: 14, Steps: 18 | Train Loss: 0.518 Vali Loss: 10.594 Vali Acc: 0.480 Test Loss: 10.594 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.943567752838135
Epoch: 15, Steps: 18 | Train Loss: 0.188 Vali Loss: 7.680 Vali Acc: 0.470 Test Loss: 7.680 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.313707828521729
Epoch: 16, Steps: 18 | Train Loss: 0.410 Vali Loss: 6.518 Vali Acc: 0.560 Test Loss: 6.518 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.672968626022339
Epoch: 17, Steps: 18 | Train Loss: 0.601 Vali Loss: 6.485 Vali Acc: 0.540 Test Loss: 6.485 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.140923738479614
Epoch: 18, Steps: 18 | Train Loss: 0.259 Vali Loss: 7.094 Vali Acc: 0.510 Test Loss: 7.094 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.928019046783447
Epoch: 19, Steps: 18 | Train Loss: 0.476 Vali Loss: 10.477 Vali Acc: 0.490 Test Loss: 10.477 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3508466
model size : 13.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.315629243850708
Epoch: 1, Steps: 18 | Train Loss: 0.841 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.4690163135528564
Epoch: 2, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.183 Vali Acc: 0.490 Test Loss: 1.183 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0282697677612305
Epoch: 3, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.578 Vali Acc: 0.560 Test Loss: 1.578 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559984).  Saving model ...
Epoch: 4 cost time: 4.09824013710022
Epoch: 4, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.641 Vali Acc: 0.520 Test Loss: 2.641 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.179505348205566
Epoch: 5, Steps: 18 | Train Loss: 0.536 Vali Loss: 2.673 Vali Acc: 0.510 Test Loss: 2.673 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.089091539382935
Epoch: 6, Steps: 18 | Train Loss: 0.172 Vali Loss: 2.800 Vali Acc: 0.530 Test Loss: 2.800 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.919667959213257
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 3.663 Vali Acc: 0.560 Test Loss: 3.663 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.307257652282715
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 4.410 Vali Acc: 0.480 Test Loss: 4.410 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.19160795211792
Epoch: 9, Steps: 18 | Train Loss: 0.264 Vali Loss: 5.154 Vali Acc: 0.550 Test Loss: 5.154 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.143550157546997
Epoch: 10, Steps: 18 | Train Loss: 0.609 Vali Loss: 5.056 Vali Acc: 0.490 Test Loss: 5.056 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.087496995925903
Epoch: 11, Steps: 18 | Train Loss: 0.330 Vali Loss: 5.834 Vali Acc: 0.500 Test Loss: 5.834 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.104369163513184
Epoch: 12, Steps: 18 | Train Loss: 0.327 Vali Loss: 5.339 Vali Acc: 0.540 Test Loss: 5.339 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.238954544067383
Epoch: 13, Steps: 18 | Train Loss: 0.159 Vali Loss: 4.857 Vali Acc: 0.510 Test Loss: 4.857 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3493106
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.074704647064209
Epoch: 1, Steps: 18 | Train Loss: 0.896 Vali Loss: 0.886 Vali Acc: 0.620 Test Loss: 0.886 Test Acc: 0.620
Validation loss decreased (inf --> -0.619991).  Saving model ...
Epoch: 2 cost time: 2.809641122817993
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 1.403 Vali Acc: 0.550 Test Loss: 1.403 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.788987636566162
Epoch: 3, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.753835916519165
Epoch: 4, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.448 Vali Acc: 0.530 Test Loss: 1.448 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8115735054016113
Epoch: 5, Steps: 18 | Train Loss: 0.385 Vali Loss: 3.559 Vali Acc: 0.500 Test Loss: 3.559 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.854660749435425
Epoch: 6, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.613 Vali Acc: 0.510 Test Loss: 2.613 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9072227478027344
Epoch: 7, Steps: 18 | Train Loss: 0.169 Vali Loss: 3.970 Vali Acc: 0.500 Test Loss: 3.970 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7725932598114014
Epoch: 8, Steps: 18 | Train Loss: 0.378 Vali Loss: 5.561 Vali Acc: 0.470 Test Loss: 5.561 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8480286598205566
Epoch: 9, Steps: 18 | Train Loss: 0.433 Vali Loss: 3.134 Vali Acc: 0.480 Test Loss: 3.134 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7268097400665283
Epoch: 10, Steps: 18 | Train Loss: 0.293 Vali Loss: 4.701 Vali Acc: 0.480 Test Loss: 4.701 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.632047176361084
Epoch: 11, Steps: 18 | Train Loss: 0.315 Vali Loss: 5.983 Vali Acc: 0.500 Test Loss: 5.983 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3477746
model size : 13.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.094959020614624
Epoch: 1, Steps: 18 | Train Loss: 0.904 Vali Loss: 0.914 Vali Acc: 0.520 Test Loss: 0.914 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 1.0470502376556396
Epoch: 2, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.854 Vali Acc: 0.570 Test Loss: 0.854 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569991).  Saving model ...
Epoch: 3 cost time: 1.1667485237121582
Epoch: 3, Steps: 18 | Train Loss: 0.472 Vali Loss: 3.906 Vali Acc: 0.420 Test Loss: 3.906 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1323208808898926
Epoch: 4, Steps: 18 | Train Loss: 1.519 Vali Loss: 2.772 Vali Acc: 0.460 Test Loss: 2.772 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1852359771728516
Epoch: 5, Steps: 18 | Train Loss: 1.233 Vali Loss: 3.922 Vali Acc: 0.490 Test Loss: 3.922 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1794450283050537
Epoch: 6, Steps: 18 | Train Loss: 0.732 Vali Loss: 2.019 Vali Acc: 0.510 Test Loss: 2.019 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4975042343139648
Epoch: 7, Steps: 18 | Train Loss: 0.719 Vali Loss: 5.162 Vali Acc: 0.430 Test Loss: 5.162 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.284031629562378
Epoch: 8, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.787 Vali Acc: 0.540 Test Loss: 1.787 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.333313226699829
Epoch: 9, Steps: 18 | Train Loss: 0.923 Vali Loss: 3.138 Vali Acc: 0.540 Test Loss: 3.138 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2524023056030273
Epoch: 10, Steps: 18 | Train Loss: 1.015 Vali Loss: 3.869 Vali Acc: 0.570 Test Loss: 3.869 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3394582271575928
Epoch: 11, Steps: 18 | Train Loss: 1.074 Vali Loss: 3.815 Vali Acc: 0.580 Test Loss: 3.815 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579962).  Saving model ...
Epoch: 12 cost time: 1.3896541595458984
Epoch: 12, Steps: 18 | Train Loss: 1.315 Vali Loss: 5.969 Vali Acc: 0.440 Test Loss: 5.969 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4104831218719482
Epoch: 13, Steps: 18 | Train Loss: 1.347 Vali Loss: 5.952 Vali Acc: 0.550 Test Loss: 5.952 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2854712009429932
Epoch: 14, Steps: 18 | Train Loss: 0.365 Vali Loss: 5.457 Vali Acc: 0.490 Test Loss: 5.457 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2963101863861084
Epoch: 15, Steps: 18 | Train Loss: 0.986 Vali Loss: 5.856 Vali Acc: 0.470 Test Loss: 5.856 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.327045202255249
Epoch: 16, Steps: 18 | Train Loss: 1.162 Vali Loss: 7.930 Vali Acc: 0.500 Test Loss: 7.930 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2570304870605469
Epoch: 17, Steps: 18 | Train Loss: 1.256 Vali Loss: 6.633 Vali Acc: 0.530 Test Loss: 6.633 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.317884922027588
Epoch: 18, Steps: 18 | Train Loss: 0.759 Vali Loss: 7.833 Vali Acc: 0.620 Test Loss: 7.833 Test Acc: 0.620
Validation loss decreased (-0.579962 --> -0.619922).  Saving model ...
Epoch: 19 cost time: 1.2637708187103271
Epoch: 19, Steps: 18 | Train Loss: 0.954 Vali Loss: 13.751 Vali Acc: 0.490 Test Loss: 13.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2517716884613037
Epoch: 20, Steps: 18 | Train Loss: 1.708 Vali Loss: 9.578 Vali Acc: 0.550 Test Loss: 9.578 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1540803909301758
Epoch: 21, Steps: 18 | Train Loss: 0.929 Vali Loss: 8.034 Vali Acc: 0.550 Test Loss: 8.034 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1201422214508057
Epoch: 22, Steps: 18 | Train Loss: 0.804 Vali Loss: 9.777 Vali Acc: 0.520 Test Loss: 9.777 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.182687520980835
Epoch: 23, Steps: 18 | Train Loss: 0.846 Vali Loss: 11.538 Vali Acc: 0.530 Test Loss: 11.538 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.168567180633545
Epoch: 24, Steps: 18 | Train Loss: 0.636 Vali Loss: 9.386 Vali Acc: 0.480 Test Loss: 9.386 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1861884593963623
Epoch: 25, Steps: 18 | Train Loss: 0.969 Vali Loss: 8.570 Vali Acc: 0.470 Test Loss: 8.570 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3384923934936523
Epoch: 26, Steps: 18 | Train Loss: 0.896 Vali Loss: 10.735 Vali Acc: 0.470 Test Loss: 10.735 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.222618818283081
Epoch: 27, Steps: 18 | Train Loss: 1.423 Vali Loss: 9.392 Vali Acc: 0.540 Test Loss: 9.392 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2361023426055908
Epoch: 28, Steps: 18 | Train Loss: 0.294 Vali Loss: 17.494 Vali Acc: 0.460 Test Loss: 17.494 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3462898
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.85905385017395
Epoch: 1, Steps: 18 | Train Loss: 0.872 Vali Loss: 0.998 Vali Acc: 0.520 Test Loss: 0.998 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 21.682297945022583
Epoch: 2, Steps: 18 | Train Loss: 0.605 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
Validation loss decreased (-0.519990 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 22.04327392578125
Epoch: 3, Steps: 18 | Train Loss: 0.894 Vali Loss: 1.117 Vali Acc: 0.470 Test Loss: 1.117 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.716904878616333
Epoch: 4, Steps: 18 | Train Loss: 0.810 Vali Loss: 2.567 Vali Acc: 0.520 Test Loss: 2.567 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.138816356658936
Epoch: 5, Steps: 18 | Train Loss: 1.278 Vali Loss: 2.724 Vali Acc: 0.460 Test Loss: 2.724 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.581111192703247
Epoch: 6, Steps: 18 | Train Loss: 0.598 Vali Loss: 2.826 Vali Acc: 0.540 Test Loss: 2.826 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.17309069633484
Epoch: 7, Steps: 18 | Train Loss: 0.506 Vali Loss: 3.046 Vali Acc: 0.530 Test Loss: 3.046 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.78470468521118
Epoch: 8, Steps: 18 | Train Loss: 0.789 Vali Loss: 2.968 Vali Acc: 0.470 Test Loss: 2.968 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.06865429878235
Epoch: 9, Steps: 18 | Train Loss: 0.335 Vali Loss: 5.417 Vali Acc: 0.490 Test Loss: 5.417 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 21.82197666168213
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 3.733 Vali Acc: 0.460 Test Loss: 3.733 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.098905086517334
Epoch: 11, Steps: 18 | Train Loss: 0.973 Vali Loss: 7.757 Vali Acc: 0.500 Test Loss: 7.757 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 22.35182809829712
Epoch: 12, Steps: 18 | Train Loss: 0.422 Vali Loss: 5.972 Vali Acc: 0.530 Test Loss: 5.972 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2030770
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.608234405517578
Epoch: 1, Steps: 18 | Train Loss: 0.903 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 17.597795963287354
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.103 Vali Acc: 0.560 Test Loss: 1.103 Test Acc: 0.560
Validation loss decreased (-0.479991 --> -0.559989).  Saving model ...
Epoch: 3 cost time: 17.474790811538696
Epoch: 3, Steps: 18 | Train Loss: 0.678 Vali Loss: 1.333 Vali Acc: 0.470 Test Loss: 1.333 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.694580554962158
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.507 Vali Acc: 0.560 Test Loss: 1.507 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.080562114715576
Epoch: 5, Steps: 18 | Train Loss: 0.951 Vali Loss: 3.207 Vali Acc: 0.520 Test Loss: 3.207 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.314252138137817
Epoch: 6, Steps: 18 | Train Loss: 0.618 Vali Loss: 3.339 Vali Acc: 0.530 Test Loss: 3.339 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.556901454925537
Epoch: 7, Steps: 18 | Train Loss: 0.270 Vali Loss: 3.770 Vali Acc: 0.520 Test Loss: 3.770 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.551302433013916
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 4.760 Vali Acc: 0.520 Test Loss: 4.760 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.116585731506348
Epoch: 9, Steps: 18 | Train Loss: 0.676 Vali Loss: 3.687 Vali Acc: 0.530 Test Loss: 3.687 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.985907793045044
Epoch: 10, Steps: 18 | Train Loss: 0.519 Vali Loss: 4.095 Vali Acc: 0.520 Test Loss: 4.095 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.423343420028687
Epoch: 11, Steps: 18 | Train Loss: 0.458 Vali Loss: 6.188 Vali Acc: 0.540 Test Loss: 6.188 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.141779899597168
Epoch: 12, Steps: 18 | Train Loss: 1.045 Vali Loss: 6.172 Vali Acc: 0.510 Test Loss: 6.172 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2011570
model size : 8.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.182985782623291
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 1.764 Vali Acc: 0.540 Test Loss: 1.764 Test Acc: 0.540
Validation loss decreased (inf --> -0.539982).  Saving model ...
Epoch: 2 cost time: 13.29293417930603
Epoch: 2, Steps: 18 | Train Loss: 1.083 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.875504970550537
Epoch: 3, Steps: 18 | Train Loss: 0.870 Vali Loss: 1.928 Vali Acc: 0.610 Test Loss: 1.928 Test Acc: 0.610
Validation loss decreased (-0.539982 --> -0.609981).  Saving model ...
Epoch: 4 cost time: 12.892265558242798
Epoch: 4, Steps: 18 | Train Loss: 1.037 Vali Loss: 2.502 Vali Acc: 0.600 Test Loss: 2.502 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.455051183700562
Epoch: 5, Steps: 18 | Train Loss: 0.754 Vali Loss: 2.981 Vali Acc: 0.520 Test Loss: 2.981 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.937875747680664
Epoch: 6, Steps: 18 | Train Loss: 0.416 Vali Loss: 3.162 Vali Acc: 0.490 Test Loss: 3.162 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.151702165603638
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 5.153 Vali Acc: 0.430 Test Loss: 5.153 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.975811958312988
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 2.522 Vali Acc: 0.450 Test Loss: 2.522 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.307284832000732
Epoch: 9, Steps: 18 | Train Loss: 0.119 Vali Loss: 3.151 Vali Acc: 0.490 Test Loss: 3.151 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.564632177352905
Epoch: 10, Steps: 18 | Train Loss: 0.556 Vali Loss: 5.596 Vali Acc: 0.480 Test Loss: 5.596 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.431574583053589
Epoch: 11, Steps: 18 | Train Loss: 1.050 Vali Loss: 10.260 Vali Acc: 0.510 Test Loss: 10.260 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.946298360824585
Epoch: 12, Steps: 18 | Train Loss: 1.039 Vali Loss: 7.723 Vali Acc: 0.490 Test Loss: 7.723 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.9968421459198
Epoch: 13, Steps: 18 | Train Loss: 0.431 Vali Loss: 8.886 Vali Acc: 0.450 Test Loss: 8.886 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1992370
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.312684774398804
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 1.061 Vali Acc: 0.510 Test Loss: 1.061 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 9.26355767250061
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 2.277 Vali Acc: 0.530 Test Loss: 2.277 Test Acc: 0.530
Validation loss decreased (-0.509989 --> -0.529977).  Saving model ...
Epoch: 3 cost time: 8.835825681686401
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.844 Vali Acc: 0.490 Test Loss: 1.844 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.223777532577515
Epoch: 4, Steps: 18 | Train Loss: 0.769 Vali Loss: 2.788 Vali Acc: 0.470 Test Loss: 2.788 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.789504051208496
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 2.067 Vali Acc: 0.600 Test Loss: 2.067 Test Acc: 0.600
Validation loss decreased (-0.529977 --> -0.599979).  Saving model ...
Epoch: 6 cost time: 8.496135234832764
Epoch: 6, Steps: 18 | Train Loss: 0.772 Vali Loss: 2.507 Vali Acc: 0.530 Test Loss: 2.507 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.849538803100586
Epoch: 7, Steps: 18 | Train Loss: 0.658 Vali Loss: 3.008 Vali Acc: 0.550 Test Loss: 3.008 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.106012105941772
Epoch: 8, Steps: 18 | Train Loss: 1.135 Vali Loss: 3.873 Vali Acc: 0.510 Test Loss: 3.873 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.966521501541138
Epoch: 9, Steps: 18 | Train Loss: 1.042 Vali Loss: 3.754 Vali Acc: 0.500 Test Loss: 3.754 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.769182205200195
Epoch: 10, Steps: 18 | Train Loss: 0.632 Vali Loss: 3.255 Vali Acc: 0.530 Test Loss: 3.255 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.902905941009521
Epoch: 11, Steps: 18 | Train Loss: 0.558 Vali Loss: 4.679 Vali Acc: 0.500 Test Loss: 4.679 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.879632949829102
Epoch: 12, Steps: 18 | Train Loss: 0.351 Vali Loss: 5.080 Vali Acc: 0.440 Test Loss: 5.080 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.941600799560547
Epoch: 13, Steps: 18 | Train Loss: 0.274 Vali Loss: 7.521 Vali Acc: 0.480 Test Loss: 7.521 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.432441473007202
Epoch: 14, Steps: 18 | Train Loss: 0.402 Vali Loss: 7.533 Vali Acc: 0.520 Test Loss: 7.533 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.070540428161621
Epoch: 15, Steps: 18 | Train Loss: 0.214 Vali Loss: 7.076 Vali Acc: 0.520 Test Loss: 7.076 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1973170
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.753448724746704
Epoch: 1, Steps: 18 | Train Loss: 0.950 Vali Loss: 1.549 Vali Acc: 0.560 Test Loss: 1.549 Test Acc: 0.560
Validation loss decreased (inf --> -0.559985).  Saving model ...
Epoch: 2 cost time: 6.021667242050171
Epoch: 2, Steps: 18 | Train Loss: 0.968 Vali Loss: 1.499 Vali Acc: 0.580 Test Loss: 1.499 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579985).  Saving model ...
Epoch: 3 cost time: 5.859773874282837
Epoch: 3, Steps: 18 | Train Loss: 1.217 Vali Loss: 1.774 Vali Acc: 0.520 Test Loss: 1.774 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.8419952392578125
Epoch: 4, Steps: 18 | Train Loss: 1.248 Vali Loss: 2.886 Vali Acc: 0.480 Test Loss: 2.886 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.728286266326904
Epoch: 5, Steps: 18 | Train Loss: 0.586 Vali Loss: 3.033 Vali Acc: 0.550 Test Loss: 3.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.746570587158203
Epoch: 6, Steps: 18 | Train Loss: 0.606 Vali Loss: 2.485 Vali Acc: 0.470 Test Loss: 2.485 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.9449403285980225
Epoch: 7, Steps: 18 | Train Loss: 1.533 Vali Loss: 2.472 Vali Acc: 0.490 Test Loss: 2.472 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.542844533920288
Epoch: 8, Steps: 18 | Train Loss: 0.485 Vali Loss: 5.376 Vali Acc: 0.460 Test Loss: 5.376 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.010729074478149
Epoch: 9, Steps: 18 | Train Loss: 0.523 Vali Loss: 4.343 Vali Acc: 0.520 Test Loss: 4.343 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.014239311218262
Epoch: 10, Steps: 18 | Train Loss: 0.419 Vali Loss: 3.668 Vali Acc: 0.590 Test Loss: 3.668 Test Acc: 0.590
Validation loss decreased (-0.579985 --> -0.589963).  Saving model ...
Epoch: 11 cost time: 5.89333963394165
Epoch: 11, Steps: 18 | Train Loss: 0.250 Vali Loss: 3.778 Vali Acc: 0.480 Test Loss: 3.778 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.596714496612549
Epoch: 12, Steps: 18 | Train Loss: 0.156 Vali Loss: 4.313 Vali Acc: 0.470 Test Loss: 4.313 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.560476541519165
Epoch: 13, Steps: 18 | Train Loss: 0.243 Vali Loss: 4.895 Vali Acc: 0.450 Test Loss: 4.895 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.776017665863037
Epoch: 14, Steps: 18 | Train Loss: 0.086 Vali Loss: 9.102 Vali Acc: 0.520 Test Loss: 9.102 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.924114227294922
Epoch: 15, Steps: 18 | Train Loss: 0.326 Vali Loss: 7.423 Vali Acc: 0.520 Test Loss: 7.423 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.990606784820557
Epoch: 16, Steps: 18 | Train Loss: 0.913 Vali Loss: 5.549 Vali Acc: 0.500 Test Loss: 5.549 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.205093622207642
Epoch: 17, Steps: 18 | Train Loss: 1.196 Vali Loss: 6.517 Vali Acc: 0.540 Test Loss: 6.517 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.937848329544067
Epoch: 18, Steps: 18 | Train Loss: 0.435 Vali Loss: 7.660 Vali Acc: 0.480 Test Loss: 7.660 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.738270044326782
Epoch: 19, Steps: 18 | Train Loss: 0.276 Vali Loss: 6.877 Vali Acc: 0.540 Test Loss: 6.877 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.241727352142334
Epoch: 20, Steps: 18 | Train Loss: 0.095 Vali Loss: 8.273 Vali Acc: 0.570 Test Loss: 8.273 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1957810
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.9056007862091064
Epoch: 1, Steps: 18 | Train Loss: 0.886 Vali Loss: 0.982 Vali Acc: 0.500 Test Loss: 0.982 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 3.7786264419555664
Epoch: 2, Steps: 18 | Train Loss: 1.101 Vali Loss: 1.816 Vali Acc: 0.460 Test Loss: 1.816 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.035730838775635
Epoch: 3, Steps: 18 | Train Loss: 1.141 Vali Loss: 2.009 Vali Acc: 0.540 Test Loss: 2.009 Test Acc: 0.540
Validation loss decreased (-0.499990 --> -0.539980).  Saving model ...
Epoch: 4 cost time: 4.408182621002197
Epoch: 4, Steps: 18 | Train Loss: 0.813 Vali Loss: 2.391 Vali Acc: 0.630 Test Loss: 2.391 Test Acc: 0.630
Validation loss decreased (-0.539980 --> -0.629976).  Saving model ...
Epoch: 5 cost time: 4.31282901763916
Epoch: 5, Steps: 18 | Train Loss: 0.745 Vali Loss: 2.019 Vali Acc: 0.510 Test Loss: 2.019 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.448488712310791
Epoch: 6, Steps: 18 | Train Loss: 0.848 Vali Loss: 3.121 Vali Acc: 0.500 Test Loss: 3.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.137239456176758
Epoch: 7, Steps: 18 | Train Loss: 0.386 Vali Loss: 3.038 Vali Acc: 0.480 Test Loss: 3.038 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.4873621463775635
Epoch: 8, Steps: 18 | Train Loss: 0.491 Vali Loss: 2.578 Vali Acc: 0.490 Test Loss: 2.578 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1770920753479
Epoch: 9, Steps: 18 | Train Loss: 0.443 Vali Loss: 4.031 Vali Acc: 0.450 Test Loss: 4.031 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.226161003112793
Epoch: 10, Steps: 18 | Train Loss: 1.031 Vali Loss: 5.711 Vali Acc: 0.530 Test Loss: 5.711 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.284183740615845
Epoch: 11, Steps: 18 | Train Loss: 0.976 Vali Loss: 6.666 Vali Acc: 0.490 Test Loss: 6.666 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.550038576126099
Epoch: 12, Steps: 18 | Train Loss: 0.608 Vali Loss: 4.335 Vali Acc: 0.570 Test Loss: 4.335 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.525608062744141
Epoch: 13, Steps: 18 | Train Loss: 0.270 Vali Loss: 4.146 Vali Acc: 0.590 Test Loss: 4.146 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.368387222290039
Epoch: 14, Steps: 18 | Train Loss: 1.462 Vali Loss: 5.634 Vali Acc: 0.580 Test Loss: 5.634 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1950130
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.982834577560425
Epoch: 1, Steps: 18 | Train Loss: 0.791 Vali Loss: 1.070 Vali Acc: 0.470 Test Loss: 1.070 Test Acc: 0.470
Validation loss decreased (inf --> -0.469989).  Saving model ...
Epoch: 2 cost time: 2.876638889312744
Epoch: 2, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.301 Vali Acc: 0.580 Test Loss: 1.301 Test Acc: 0.580
Validation loss decreased (-0.469989 --> -0.579987).  Saving model ...
Epoch: 3 cost time: 2.8484292030334473
Epoch: 3, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.260 Vali Acc: 0.540 Test Loss: 1.260 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.805272102355957
Epoch: 4, Steps: 18 | Train Loss: 0.500 Vali Loss: 2.048 Vali Acc: 0.560 Test Loss: 2.048 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9868011474609375
Epoch: 5, Steps: 18 | Train Loss: 0.895 Vali Loss: 2.229 Vali Acc: 0.540 Test Loss: 2.229 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6186983585357666
Epoch: 6, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.683 Vali Acc: 0.520 Test Loss: 2.683 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8044745922088623
Epoch: 7, Steps: 18 | Train Loss: 0.318 Vali Loss: 3.537 Vali Acc: 0.540 Test Loss: 3.537 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9190149307250977
Epoch: 8, Steps: 18 | Train Loss: 0.351 Vali Loss: 3.329 Vali Acc: 0.490 Test Loss: 3.329 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.715759754180908
Epoch: 9, Steps: 18 | Train Loss: 0.398 Vali Loss: 2.719 Vali Acc: 0.510 Test Loss: 2.719 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7193870544433594
Epoch: 10, Steps: 18 | Train Loss: 0.649 Vali Loss: 4.851 Vali Acc: 0.520 Test Loss: 4.851 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6166610717773438
Epoch: 11, Steps: 18 | Train Loss: 0.779 Vali Loss: 4.569 Vali Acc: 0.540 Test Loss: 4.569 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7294881343841553
Epoch: 12, Steps: 18 | Train Loss: 0.890 Vali Loss: 4.634 Vali Acc: 0.540 Test Loss: 4.634 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1942450
model size : 7.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.432025194168091
Epoch: 1, Steps: 18 | Train Loss: 0.912 Vali Loss: 1.061 Vali Acc: 0.470 Test Loss: 1.061 Test Acc: 0.470
Validation loss decreased (inf --> -0.469989).  Saving model ...
Epoch: 2 cost time: 1.3260691165924072
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.981 Vali Acc: 0.510 Test Loss: 0.981 Test Acc: 0.510
Validation loss decreased (-0.469989 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 1.2850446701049805
Epoch: 3, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.038 Vali Acc: 0.460 Test Loss: 2.038 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2275168895721436
Epoch: 4, Steps: 18 | Train Loss: 0.616 Vali Loss: 1.409 Vali Acc: 0.540 Test Loss: 1.409 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539986).  Saving model ...
Epoch: 5 cost time: 1.28369140625
Epoch: 5, Steps: 18 | Train Loss: 0.722 Vali Loss: 3.281 Vali Acc: 0.590 Test Loss: 3.281 Test Acc: 0.590
Validation loss decreased (-0.539986 --> -0.589967).  Saving model ...
Epoch: 6 cost time: 1.1604735851287842
Epoch: 6, Steps: 18 | Train Loss: 0.616 Vali Loss: 1.957 Vali Acc: 0.530 Test Loss: 1.957 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3417079448699951
Epoch: 7, Steps: 18 | Train Loss: 1.043 Vali Loss: 7.336 Vali Acc: 0.420 Test Loss: 7.336 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2773668766021729
Epoch: 8, Steps: 18 | Train Loss: 1.151 Vali Loss: 3.031 Vali Acc: 0.530 Test Loss: 3.031 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3247921466827393
Epoch: 9, Steps: 18 | Train Loss: 0.599 Vali Loss: 2.599 Vali Acc: 0.520 Test Loss: 2.599 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2811980247497559
Epoch: 10, Steps: 18 | Train Loss: 0.724 Vali Loss: 3.096 Vali Acc: 0.540 Test Loss: 3.096 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.304957389831543
Epoch: 11, Steps: 18 | Train Loss: 0.344 Vali Loss: 4.313 Vali Acc: 0.500 Test Loss: 4.313 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2002801895141602
Epoch: 12, Steps: 18 | Train Loss: 0.507 Vali Loss: 3.477 Vali Acc: 0.520 Test Loss: 3.477 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.300083875656128
Epoch: 13, Steps: 18 | Train Loss: 0.847 Vali Loss: 4.105 Vali Acc: 0.520 Test Loss: 4.105 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2391932010650635
Epoch: 14, Steps: 18 | Train Loss: 0.262 Vali Loss: 5.452 Vali Acc: 0.460 Test Loss: 5.452 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.268822431564331
Epoch: 15, Steps: 18 | Train Loss: 1.231 Vali Loss: 6.120 Vali Acc: 0.520 Test Loss: 6.120 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1935026
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.71742033958435
Epoch: 1, Steps: 18 | Train Loss: 0.959 Vali Loss: 1.159 Vali Acc: 0.490 Test Loss: 1.159 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 22.50995373725891
Epoch: 2, Steps: 18 | Train Loss: 0.958 Vali Loss: 1.318 Vali Acc: 0.520 Test Loss: 1.318 Test Acc: 0.520
Validation loss decreased (-0.489988 --> -0.519987).  Saving model ...
Epoch: 3 cost time: 23.184765577316284
Epoch: 3, Steps: 18 | Train Loss: 0.703 Vali Loss: 2.241 Vali Acc: 0.490 Test Loss: 2.241 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.389134407043457
Epoch: 4, Steps: 18 | Train Loss: 0.681 Vali Loss: 1.489 Vali Acc: 0.550 Test Loss: 1.489 Test Acc: 0.550
Validation loss decreased (-0.519987 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 22.054500102996826
Epoch: 5, Steps: 18 | Train Loss: 0.590 Vali Loss: 2.055 Vali Acc: 0.610 Test Loss: 2.055 Test Acc: 0.610
Validation loss decreased (-0.549985 --> -0.609979).  Saving model ...
Epoch: 6 cost time: 22.39830994606018
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 2.022 Vali Acc: 0.630 Test Loss: 2.022 Test Acc: 0.630
Validation loss decreased (-0.609979 --> -0.629980).  Saving model ...
Epoch: 7 cost time: 24.48286485671997
Epoch: 7, Steps: 18 | Train Loss: 1.235 Vali Loss: 3.185 Vali Acc: 0.560 Test Loss: 3.185 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.67840814590454
Epoch: 8, Steps: 18 | Train Loss: 1.118 Vali Loss: 5.264 Vali Acc: 0.510 Test Loss: 5.264 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.76296353340149
Epoch: 9, Steps: 18 | Train Loss: 0.692 Vali Loss: 2.879 Vali Acc: 0.500 Test Loss: 2.879 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.08225655555725
Epoch: 10, Steps: 18 | Train Loss: 0.432 Vali Loss: 5.130 Vali Acc: 0.520 Test Loss: 5.130 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.21115469932556
Epoch: 11, Steps: 18 | Train Loss: 0.685 Vali Loss: 3.988 Vali Acc: 0.590 Test Loss: 3.988 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.34658432006836
Epoch: 12, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.768 Vali Acc: 0.510 Test Loss: 3.768 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.089845418930054
Epoch: 13, Steps: 18 | Train Loss: 1.113 Vali Loss: 3.833 Vali Acc: 0.520 Test Loss: 3.833 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 20.55256414413452
Epoch: 14, Steps: 18 | Train Loss: 0.813 Vali Loss: 5.991 Vali Acc: 0.550 Test Loss: 5.991 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 22.08887815475464
Epoch: 15, Steps: 18 | Train Loss: 0.192 Vali Loss: 4.907 Vali Acc: 0.560 Test Loss: 4.907 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.709720611572266
Epoch: 16, Steps: 18 | Train Loss: 0.451 Vali Loss: 5.360 Vali Acc: 0.610 Test Loss: 5.360 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2026642
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.593615293502808
Epoch: 1, Steps: 18 | Train Loss: 0.859 Vali Loss: 0.926 Vali Acc: 0.560 Test Loss: 0.926 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 17.63917589187622
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.715391159057617
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.342 Vali Acc: 0.490 Test Loss: 1.342 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.373396396636963
Epoch: 4, Steps: 18 | Train Loss: 0.620 Vali Loss: 1.575 Vali Acc: 0.490 Test Loss: 1.575 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.824796438217163
Epoch: 5, Steps: 18 | Train Loss: 0.390 Vali Loss: 2.054 Vali Acc: 0.490 Test Loss: 2.054 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.07516646385193
Epoch: 6, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.606 Vali Acc: 0.490 Test Loss: 2.606 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.165762901306152
Epoch: 7, Steps: 18 | Train Loss: 0.485 Vali Loss: 3.141 Vali Acc: 0.530 Test Loss: 3.141 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.09896159172058
Epoch: 8, Steps: 18 | Train Loss: 0.510 Vali Loss: 3.229 Vali Acc: 0.530 Test Loss: 3.229 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.633251905441284
Epoch: 9, Steps: 18 | Train Loss: 0.485 Vali Loss: 3.893 Vali Acc: 0.570 Test Loss: 3.893 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569961).  Saving model ...
Epoch: 10 cost time: 17.41563844680786
Epoch: 10, Steps: 18 | Train Loss: 0.886 Vali Loss: 3.537 Vali Acc: 0.520 Test Loss: 3.537 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.852773427963257
Epoch: 11, Steps: 18 | Train Loss: 0.405 Vali Loss: 5.017 Vali Acc: 0.520 Test Loss: 5.017 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.115848779678345
Epoch: 12, Steps: 18 | Train Loss: 0.227 Vali Loss: 3.442 Vali Acc: 0.510 Test Loss: 3.442 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.21845507621765
Epoch: 13, Steps: 18 | Train Loss: 0.282 Vali Loss: 4.184 Vali Acc: 0.560 Test Loss: 4.184 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.533825635910034
Epoch: 14, Steps: 18 | Train Loss: 0.141 Vali Loss: 3.451 Vali Acc: 0.600 Test Loss: 3.451 Test Acc: 0.600
Validation loss decreased (-0.569961 --> -0.599965).  Saving model ...
Epoch: 15 cost time: 17.830225229263306
Epoch: 15, Steps: 18 | Train Loss: 0.199 Vali Loss: 4.937 Vali Acc: 0.540 Test Loss: 4.937 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.816593647003174
Epoch: 16, Steps: 18 | Train Loss: 0.209 Vali Loss: 6.542 Vali Acc: 0.510 Test Loss: 6.542 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.565049409866333
Epoch: 17, Steps: 18 | Train Loss: 0.197 Vali Loss: 5.489 Vali Acc: 0.520 Test Loss: 5.489 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 18.51898717880249
Epoch: 18, Steps: 18 | Train Loss: 0.176 Vali Loss: 5.717 Vali Acc: 0.480 Test Loss: 5.717 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.776988744735718
Epoch: 19, Steps: 18 | Train Loss: 0.288 Vali Loss: 9.424 Vali Acc: 0.470 Test Loss: 9.424 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.300897359848022
Epoch: 20, Steps: 18 | Train Loss: 0.927 Vali Loss: 8.802 Vali Acc: 0.520 Test Loss: 8.802 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.116575956344604
Epoch: 21, Steps: 18 | Train Loss: 0.700 Vali Loss: 7.265 Vali Acc: 0.520 Test Loss: 7.265 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 17.714116096496582
Epoch: 22, Steps: 18 | Train Loss: 0.291 Vali Loss: 10.064 Vali Acc: 0.520 Test Loss: 10.064 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 17.21236824989319
Epoch: 23, Steps: 18 | Train Loss: 0.165 Vali Loss: 14.061 Vali Acc: 0.440 Test Loss: 14.061 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 17.073617458343506
Epoch: 24, Steps: 18 | Train Loss: 1.570 Vali Loss: 9.086 Vali Acc: 0.430 Test Loss: 9.086 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2007442
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.553487539291382
Epoch: 1, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.994 Vali Acc: 0.610 Test Loss: 0.994 Test Acc: 0.610
Validation loss decreased (inf --> -0.609990).  Saving model ...
Epoch: 2 cost time: 12.683088302612305
Epoch: 2, Steps: 18 | Train Loss: 0.801 Vali Loss: 1.460 Vali Acc: 0.520 Test Loss: 1.460 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.104870080947876
Epoch: 3, Steps: 18 | Train Loss: 1.020 Vali Loss: 1.772 Vali Acc: 0.550 Test Loss: 1.772 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.635764598846436
Epoch: 4, Steps: 18 | Train Loss: 0.734 Vali Loss: 1.832 Vali Acc: 0.510 Test Loss: 1.832 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.2539803981781
Epoch: 5, Steps: 18 | Train Loss: 1.032 Vali Loss: 3.833 Vali Acc: 0.470 Test Loss: 3.833 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.057609796524048
Epoch: 6, Steps: 18 | Train Loss: 1.235 Vali Loss: 4.979 Vali Acc: 0.480 Test Loss: 4.979 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.122414827346802
Epoch: 7, Steps: 18 | Train Loss: 0.757 Vali Loss: 2.331 Vali Acc: 0.520 Test Loss: 2.331 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.896489381790161
Epoch: 8, Steps: 18 | Train Loss: 0.323 Vali Loss: 3.999 Vali Acc: 0.560 Test Loss: 3.999 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.137792110443115
Epoch: 9, Steps: 18 | Train Loss: 0.525 Vali Loss: 4.584 Vali Acc: 0.550 Test Loss: 4.584 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.938955307006836
Epoch: 10, Steps: 18 | Train Loss: 0.445 Vali Loss: 3.481 Vali Acc: 0.500 Test Loss: 3.481 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.107107877731323
Epoch: 11, Steps: 18 | Train Loss: 0.847 Vali Loss: 3.023 Vali Acc: 0.530 Test Loss: 3.023 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1988242
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.866448879241943
Epoch: 1, Steps: 18 | Train Loss: 0.857 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 8.785575866699219
Epoch: 2, Steps: 18 | Train Loss: 0.842 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.715467691421509
Epoch: 3, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.827 Vali Acc: 0.520 Test Loss: 1.827 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.083437442779541
Epoch: 4, Steps: 18 | Train Loss: 0.723 Vali Loss: 1.397 Vali Acc: 0.480 Test Loss: 1.397 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.46070408821106
Epoch: 5, Steps: 18 | Train Loss: 0.750 Vali Loss: 2.669 Vali Acc: 0.550 Test Loss: 2.669 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.76198124885559
Epoch: 6, Steps: 18 | Train Loss: 0.771 Vali Loss: 3.281 Vali Acc: 0.570 Test Loss: 3.281 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.46365475654602
Epoch: 7, Steps: 18 | Train Loss: 0.701 Vali Loss: 2.440 Vali Acc: 0.480 Test Loss: 2.440 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.631333351135254
Epoch: 8, Steps: 18 | Train Loss: 0.717 Vali Loss: 3.520 Vali Acc: 0.470 Test Loss: 3.520 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.790672302246094
Epoch: 9, Steps: 18 | Train Loss: 0.558 Vali Loss: 4.040 Vali Acc: 0.500 Test Loss: 4.040 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.606124639511108
Epoch: 10, Steps: 18 | Train Loss: 0.491 Vali Loss: 3.885 Vali Acc: 0.530 Test Loss: 3.885 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.886979341506958
Epoch: 11, Steps: 18 | Train Loss: 0.219 Vali Loss: 4.884 Vali Acc: 0.490 Test Loss: 4.884 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1969042
model size : 7.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.250502347946167
Epoch: 1, Steps: 18 | Train Loss: 1.064 Vali Loss: 2.079 Vali Acc: 0.500 Test Loss: 2.079 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 5.693016767501831
Epoch: 2, Steps: 18 | Train Loss: 0.989 Vali Loss: 1.174 Vali Acc: 0.630 Test Loss: 1.174 Test Acc: 0.630
Validation loss decreased (-0.499979 --> -0.629988).  Saving model ...
Epoch: 3 cost time: 5.818168878555298
Epoch: 3, Steps: 18 | Train Loss: 0.675 Vali Loss: 3.120 Vali Acc: 0.480 Test Loss: 3.120 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.7173261642456055
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.198 Vali Acc: 0.560 Test Loss: 2.198 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.745305776596069
Epoch: 5, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.970 Vali Acc: 0.520 Test Loss: 1.970 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.805948495864868
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 3.843 Vali Acc: 0.500 Test Loss: 3.843 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.905044078826904
Epoch: 7, Steps: 18 | Train Loss: 0.274 Vali Loss: 3.070 Vali Acc: 0.500 Test Loss: 3.070 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.342928171157837
Epoch: 8, Steps: 18 | Train Loss: 0.552 Vali Loss: 3.269 Vali Acc: 0.540 Test Loss: 3.269 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.83232855796814
Epoch: 9, Steps: 18 | Train Loss: 0.842 Vali Loss: 3.140 Vali Acc: 0.520 Test Loss: 3.140 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.71268367767334
Epoch: 10, Steps: 18 | Train Loss: 0.359 Vali Loss: 4.213 Vali Acc: 0.580 Test Loss: 4.213 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.848895311355591
Epoch: 11, Steps: 18 | Train Loss: 0.248 Vali Loss: 3.726 Vali Acc: 0.540 Test Loss: 3.726 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.704997777938843
Epoch: 12, Steps: 18 | Train Loss: 0.520 Vali Loss: 5.063 Vali Acc: 0.460 Test Loss: 5.063 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1953682
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.17909574508667
Epoch: 1, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.9380221366882324
Epoch: 2, Steps: 18 | Train Loss: 0.807 Vali Loss: 1.384 Vali Acc: 0.530 Test Loss: 1.384 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529986).  Saving model ...
Epoch: 3 cost time: 4.418938875198364
Epoch: 3, Steps: 18 | Train Loss: 0.607 Vali Loss: 1.706 Vali Acc: 0.540 Test Loss: 1.706 Test Acc: 0.540
Validation loss decreased (-0.529986 --> -0.539983).  Saving model ...
Epoch: 4 cost time: 4.254887104034424
Epoch: 4, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.385 Vali Acc: 0.520 Test Loss: 3.385 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.238284111022949
Epoch: 5, Steps: 18 | Train Loss: 1.473 Vali Loss: 3.484 Vali Acc: 0.490 Test Loss: 3.484 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.149090528488159
Epoch: 6, Steps: 18 | Train Loss: 1.462 Vali Loss: 3.277 Vali Acc: 0.510 Test Loss: 3.277 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.206164836883545
Epoch: 7, Steps: 18 | Train Loss: 1.008 Vali Loss: 2.851 Vali Acc: 0.540 Test Loss: 2.851 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.45097804069519
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 3.358 Vali Acc: 0.530 Test Loss: 3.358 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.471372365951538
Epoch: 9, Steps: 18 | Train Loss: 0.697 Vali Loss: 4.924 Vali Acc: 0.440 Test Loss: 4.924 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.594537258148193
Epoch: 10, Steps: 18 | Train Loss: 1.349 Vali Loss: 8.034 Vali Acc: 0.500 Test Loss: 8.034 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.2374091148376465
Epoch: 11, Steps: 18 | Train Loss: 1.056 Vali Loss: 4.927 Vali Acc: 0.470 Test Loss: 4.927 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.717305898666382
Epoch: 12, Steps: 18 | Train Loss: 0.902 Vali Loss: 7.751 Vali Acc: 0.480 Test Loss: 7.751 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.354131460189819
Epoch: 13, Steps: 18 | Train Loss: 0.936 Vali Loss: 6.166 Vali Acc: 0.520 Test Loss: 6.166 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1946002
model size : 7.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.155693292617798
Epoch: 1, Steps: 18 | Train Loss: 0.924 Vali Loss: 1.412 Vali Acc: 0.510 Test Loss: 1.412 Test Acc: 0.510
Validation loss decreased (inf --> -0.509986).  Saving model ...
Epoch: 2 cost time: 2.7494730949401855
Epoch: 2, Steps: 18 | Train Loss: 1.286 Vali Loss: 1.086 Vali Acc: 0.640 Test Loss: 1.086 Test Acc: 0.640
Validation loss decreased (-0.509986 --> -0.639989).  Saving model ...
Epoch: 3 cost time: 2.8248937129974365
Epoch: 3, Steps: 18 | Train Loss: 0.749 Vali Loss: 2.408 Vali Acc: 0.460 Test Loss: 2.408 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.612461566925049
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 2.770 Vali Acc: 0.560 Test Loss: 2.770 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7280728816986084
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 2.461 Vali Acc: 0.510 Test Loss: 2.461 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8136463165283203
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 2.016 Vali Acc: 0.510 Test Loss: 2.016 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7512574195861816
Epoch: 7, Steps: 18 | Train Loss: 0.332 Vali Loss: 2.636 Vali Acc: 0.550 Test Loss: 2.636 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.862765312194824
Epoch: 8, Steps: 18 | Train Loss: 0.738 Vali Loss: 3.312 Vali Acc: 0.540 Test Loss: 3.312 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.684251546859741
Epoch: 9, Steps: 18 | Train Loss: 0.475 Vali Loss: 4.507 Vali Acc: 0.550 Test Loss: 4.507 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.54837965965271
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 4.814 Vali Acc: 0.490 Test Loss: 4.814 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.840270757675171
Epoch: 11, Steps: 18 | Train Loss: 0.451 Vali Loss: 5.862 Vali Acc: 0.490 Test Loss: 5.862 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.765033721923828
Epoch: 12, Steps: 18 | Train Loss: 0.773 Vali Loss: 6.075 Vali Acc: 0.530 Test Loss: 6.075 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1938322
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.302360773086548
Epoch: 1, Steps: 18 | Train Loss: 0.932 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.2007951736450195
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 2.033 Vali Acc: 0.510 Test Loss: 2.033 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.194918155670166
Epoch: 3, Steps: 18 | Train Loss: 0.542 Vali Loss: 1.173 Vali Acc: 0.560 Test Loss: 1.173 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 1.243971586227417
Epoch: 4, Steps: 18 | Train Loss: 0.422 Vali Loss: 2.430 Vali Acc: 0.530 Test Loss: 2.430 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2179982662200928
Epoch: 5, Steps: 18 | Train Loss: 0.420 Vali Loss: 4.092 Vali Acc: 0.470 Test Loss: 4.092 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1674695014953613
Epoch: 6, Steps: 18 | Train Loss: 0.567 Vali Loss: 3.836 Vali Acc: 0.550 Test Loss: 3.836 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2318942546844482
Epoch: 7, Steps: 18 | Train Loss: 0.905 Vali Loss: 4.524 Vali Acc: 0.480 Test Loss: 4.524 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2509994506835938
Epoch: 8, Steps: 18 | Train Loss: 0.838 Vali Loss: 3.953 Vali Acc: 0.540 Test Loss: 3.953 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2245714664459229
Epoch: 9, Steps: 18 | Train Loss: 0.883 Vali Loss: 3.628 Vali Acc: 0.480 Test Loss: 3.628 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2703940868377686
Epoch: 10, Steps: 18 | Train Loss: 0.792 Vali Loss: 3.148 Vali Acc: 0.550 Test Loss: 3.148 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4185667037963867
Epoch: 11, Steps: 18 | Train Loss: 0.655 Vali Loss: 3.972 Vali Acc: 0.550 Test Loss: 3.972 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.30342698097229
Epoch: 12, Steps: 18 | Train Loss: 1.026 Vali Loss: 3.903 Vali Acc: 0.520 Test Loss: 3.903 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3236305713653564
Epoch: 13, Steps: 18 | Train Loss: 0.640 Vali Loss: 5.182 Vali Acc: 0.520 Test Loss: 5.182 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1930898
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.371981859207153
Epoch: 1, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
Validation loss decreased (inf --> -0.539989).  Saving model ...
Epoch: 2 cost time: 20.67799401283264
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.539989 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 17.95242738723755
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 2.533 Vali Acc: 0.480 Test Loss: 2.533 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.285374402999878
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.763 Vali Acc: 0.600 Test Loss: 1.763 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.026994705200195
Epoch: 5, Steps: 18 | Train Loss: 0.620 Vali Loss: 2.121 Vali Acc: 0.560 Test Loss: 2.121 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.9742751121521
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 2.805 Vali Acc: 0.560 Test Loss: 2.805 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.270169019699097
Epoch: 7, Steps: 18 | Train Loss: 0.661 Vali Loss: 3.457 Vali Acc: 0.530 Test Loss: 3.457 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.5873064994812
Epoch: 8, Steps: 18 | Train Loss: 0.848 Vali Loss: 3.525 Vali Acc: 0.520 Test Loss: 3.525 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.909345865249634
Epoch: 9, Steps: 18 | Train Loss: 0.599 Vali Loss: 4.821 Vali Acc: 0.550 Test Loss: 4.821 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.069463968276978
Epoch: 10, Steps: 18 | Train Loss: 0.767 Vali Loss: 2.756 Vali Acc: 0.560 Test Loss: 2.756 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.64345932006836
Epoch: 11, Steps: 18 | Train Loss: 0.364 Vali Loss: 4.003 Vali Acc: 0.560 Test Loss: 4.003 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.055386543273926
Epoch: 12, Steps: 18 | Train Loss: 0.412 Vali Loss: 4.528 Vali Acc: 0.560 Test Loss: 4.528 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2024578
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.720773935317993
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 17.45801043510437
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.896 Vali Acc: 0.480 Test Loss: 0.896 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.847466230392456
Epoch: 3, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.776 Vali Acc: 0.550 Test Loss: 1.776 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.728302478790283
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.665 Vali Acc: 0.440 Test Loss: 1.665 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.346725940704346
Epoch: 5, Steps: 18 | Train Loss: 0.530 Vali Loss: 2.187 Vali Acc: 0.490 Test Loss: 2.187 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.65768575668335
Epoch: 6, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.213 Vali Acc: 0.510 Test Loss: 2.213 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.300750970840454
Epoch: 7, Steps: 18 | Train Loss: 0.531 Vali Loss: 4.685 Vali Acc: 0.490 Test Loss: 4.685 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.714231729507446
Epoch: 8, Steps: 18 | Train Loss: 1.112 Vali Loss: 4.139 Vali Acc: 0.550 Test Loss: 4.139 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.03535795211792
Epoch: 9, Steps: 18 | Train Loss: 0.579 Vali Loss: 3.967 Vali Acc: 0.540 Test Loss: 3.967 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.11319851875305
Epoch: 10, Steps: 18 | Train Loss: 0.514 Vali Loss: 4.115 Vali Acc: 0.490 Test Loss: 4.115 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.519333839416504
Epoch: 11, Steps: 18 | Train Loss: 0.711 Vali Loss: 5.548 Vali Acc: 0.540 Test Loss: 5.548 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2005378
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.589474201202393
Epoch: 1, Steps: 18 | Train Loss: 0.845 Vali Loss: 0.872 Vali Acc: 0.540 Test Loss: 0.872 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 12.774471998214722
Epoch: 2, Steps: 18 | Train Loss: 0.864 Vali Loss: 0.955 Vali Acc: 0.580 Test Loss: 0.955 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579990).  Saving model ...
Epoch: 3 cost time: 12.300252914428711
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.377 Vali Acc: 0.640 Test Loss: 1.377 Test Acc: 0.640
Validation loss decreased (-0.579990 --> -0.639986).  Saving model ...
Epoch: 4 cost time: 12.579233646392822
Epoch: 4, Steps: 18 | Train Loss: 0.915 Vali Loss: 1.826 Vali Acc: 0.470 Test Loss: 1.826 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.985040187835693
Epoch: 5, Steps: 18 | Train Loss: 0.827 Vali Loss: 2.265 Vali Acc: 0.490 Test Loss: 2.265 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.258523225784302
Epoch: 6, Steps: 18 | Train Loss: 0.555 Vali Loss: 2.668 Vali Acc: 0.610 Test Loss: 2.668 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.014132976531982
Epoch: 7, Steps: 18 | Train Loss: 0.449 Vali Loss: 1.788 Vali Acc: 0.540 Test Loss: 1.788 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.358181476593018
Epoch: 8, Steps: 18 | Train Loss: 0.343 Vali Loss: 2.098 Vali Acc: 0.550 Test Loss: 2.098 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.265117406845093
Epoch: 9, Steps: 18 | Train Loss: 0.415 Vali Loss: 3.492 Vali Acc: 0.460 Test Loss: 3.492 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.13240933418274
Epoch: 10, Steps: 18 | Train Loss: 0.305 Vali Loss: 2.255 Vali Acc: 0.540 Test Loss: 2.255 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.535595655441284
Epoch: 11, Steps: 18 | Train Loss: 1.057 Vali Loss: 4.936 Vali Acc: 0.560 Test Loss: 4.936 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.8124361038208
Epoch: 12, Steps: 18 | Train Loss: 0.381 Vali Loss: 2.961 Vali Acc: 0.520 Test Loss: 2.961 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.792968034744263
Epoch: 13, Steps: 18 | Train Loss: 0.545 Vali Loss: 5.283 Vali Acc: 0.530 Test Loss: 5.283 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1986178
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.119921684265137
Epoch: 1, Steps: 18 | Train Loss: 0.845 Vali Loss: 1.231 Vali Acc: 0.490 Test Loss: 1.231 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 8.035043478012085
Epoch: 2, Steps: 18 | Train Loss: 1.132 Vali Loss: 1.444 Vali Acc: 0.580 Test Loss: 1.444 Test Acc: 0.580
Validation loss decreased (-0.489988 --> -0.579986).  Saving model ...
Epoch: 3 cost time: 8.877835273742676
Epoch: 3, Steps: 18 | Train Loss: 0.848 Vali Loss: 1.069 Vali Acc: 0.520 Test Loss: 1.069 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.75843095779419
Epoch: 4, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.592 Vali Acc: 0.520 Test Loss: 1.592 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.552917242050171
Epoch: 5, Steps: 18 | Train Loss: 0.356 Vali Loss: 2.136 Vali Acc: 0.490 Test Loss: 2.136 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.34705638885498
Epoch: 6, Steps: 18 | Train Loss: 0.390 Vali Loss: 2.390 Vali Acc: 0.540 Test Loss: 2.390 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.451992988586426
Epoch: 7, Steps: 18 | Train Loss: 0.572 Vali Loss: 6.460 Vali Acc: 0.510 Test Loss: 6.460 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.758968114852905
Epoch: 8, Steps: 18 | Train Loss: 0.323 Vali Loss: 5.980 Vali Acc: 0.480 Test Loss: 5.980 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.822197675704956
Epoch: 9, Steps: 18 | Train Loss: 0.496 Vali Loss: 2.713 Vali Acc: 0.450 Test Loss: 2.713 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.752851724624634
Epoch: 10, Steps: 18 | Train Loss: 0.431 Vali Loss: 8.715 Vali Acc: 0.480 Test Loss: 8.715 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.796767473220825
Epoch: 11, Steps: 18 | Train Loss: 1.246 Vali Loss: 3.826 Vali Acc: 0.490 Test Loss: 3.826 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.267239332199097
Epoch: 12, Steps: 18 | Train Loss: 0.316 Vali Loss: 6.048 Vali Acc: 0.490 Test Loss: 6.048 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1966978
model size : 7.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.915732145309448
Epoch: 1, Steps: 18 | Train Loss: 0.841 Vali Loss: 1.360 Vali Acc: 0.490 Test Loss: 1.360 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 5.533855199813843
Epoch: 2, Steps: 18 | Train Loss: 0.620 Vali Loss: 1.800 Vali Acc: 0.470 Test Loss: 1.800 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.368560791015625
Epoch: 3, Steps: 18 | Train Loss: 0.947 Vali Loss: 1.602 Vali Acc: 0.570 Test Loss: 1.602 Test Acc: 0.570
Validation loss decreased (-0.489986 --> -0.569984).  Saving model ...
Epoch: 4 cost time: 5.545627117156982
Epoch: 4, Steps: 18 | Train Loss: 0.740 Vali Loss: 1.960 Vali Acc: 0.490 Test Loss: 1.960 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.992146253585815
Epoch: 5, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.526 Vali Acc: 0.530 Test Loss: 1.526 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9121105670928955
Epoch: 6, Steps: 18 | Train Loss: 0.863 Vali Loss: 2.346 Vali Acc: 0.540 Test Loss: 2.346 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.688137769699097
Epoch: 7, Steps: 18 | Train Loss: 0.652 Vali Loss: 3.704 Vali Acc: 0.520 Test Loss: 3.704 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.316132545471191
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 4.165 Vali Acc: 0.510 Test Loss: 4.165 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.38100266456604
Epoch: 9, Steps: 18 | Train Loss: 0.575 Vali Loss: 3.697 Vali Acc: 0.530 Test Loss: 3.697 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.586216926574707
Epoch: 10, Steps: 18 | Train Loss: 0.437 Vali Loss: 3.656 Vali Acc: 0.550 Test Loss: 3.656 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.222867012023926
Epoch: 11, Steps: 18 | Train Loss: 1.521 Vali Loss: 8.747 Vali Acc: 0.490 Test Loss: 8.747 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.511694669723511
Epoch: 12, Steps: 18 | Train Loss: 1.167 Vali Loss: 6.696 Vali Acc: 0.560 Test Loss: 6.696 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.067133903503418
Epoch: 13, Steps: 18 | Train Loss: 0.579 Vali Loss: 4.688 Vali Acc: 0.520 Test Loss: 4.688 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1951618
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.472659349441528
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 4.348996162414551
Epoch: 2, Steps: 18 | Train Loss: 1.174 Vali Loss: 1.617 Vali Acc: 0.540 Test Loss: 1.617 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 3.9178988933563232
Epoch: 3, Steps: 18 | Train Loss: 0.915 Vali Loss: 1.594 Vali Acc: 0.560 Test Loss: 1.594 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559984).  Saving model ...
Epoch: 4 cost time: 3.9377365112304688
Epoch: 4, Steps: 18 | Train Loss: 0.637 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.772998809814453
Epoch: 5, Steps: 18 | Train Loss: 0.777 Vali Loss: 2.281 Vali Acc: 0.520 Test Loss: 2.281 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0814714431762695
Epoch: 6, Steps: 18 | Train Loss: 0.498 Vali Loss: 2.211 Vali Acc: 0.450 Test Loss: 2.211 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.0965635776519775
Epoch: 7, Steps: 18 | Train Loss: 0.527 Vali Loss: 2.874 Vali Acc: 0.480 Test Loss: 2.874 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.069128751754761
Epoch: 8, Steps: 18 | Train Loss: 1.060 Vali Loss: 2.552 Vali Acc: 0.470 Test Loss: 2.552 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.116796493530273
Epoch: 9, Steps: 18 | Train Loss: 0.629 Vali Loss: 2.603 Vali Acc: 0.550 Test Loss: 2.603 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.923224687576294
Epoch: 10, Steps: 18 | Train Loss: 1.053 Vali Loss: 4.547 Vali Acc: 0.540 Test Loss: 4.547 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.7625010013580322
Epoch: 11, Steps: 18 | Train Loss: 1.403 Vali Loss: 4.015 Vali Acc: 0.510 Test Loss: 4.015 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.888923168182373
Epoch: 12, Steps: 18 | Train Loss: 0.303 Vali Loss: 5.997 Vali Acc: 0.610 Test Loss: 5.997 Test Acc: 0.610
Validation loss decreased (-0.559984 --> -0.609940).  Saving model ...
Epoch: 13 cost time: 3.7633187770843506
Epoch: 13, Steps: 18 | Train Loss: 0.403 Vali Loss: 4.433 Vali Acc: 0.440 Test Loss: 4.433 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.192624092102051
Epoch: 14, Steps: 18 | Train Loss: 0.506 Vali Loss: 10.282 Vali Acc: 0.500 Test Loss: 10.282 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.802297830581665
Epoch: 15, Steps: 18 | Train Loss: 0.353 Vali Loss: 6.723 Vali Acc: 0.510 Test Loss: 6.723 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.331636190414429
Epoch: 16, Steps: 18 | Train Loss: 0.426 Vali Loss: 6.388 Vali Acc: 0.470 Test Loss: 6.388 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.95933198928833
Epoch: 17, Steps: 18 | Train Loss: 0.257 Vali Loss: 5.195 Vali Acc: 0.460 Test Loss: 5.195 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.953214645385742
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 6.755 Vali Acc: 0.520 Test Loss: 6.755 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.1265339851379395
Epoch: 19, Steps: 18 | Train Loss: 0.190 Vali Loss: 6.144 Vali Acc: 0.520 Test Loss: 6.144 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9674224853515625
Epoch: 20, Steps: 18 | Train Loss: 0.454 Vali Loss: 5.716 Vali Acc: 0.500 Test Loss: 5.716 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.749512195587158
Epoch: 21, Steps: 18 | Train Loss: 0.757 Vali Loss: 7.479 Vali Acc: 0.540 Test Loss: 7.479 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.0803868770599365
Epoch: 22, Steps: 18 | Train Loss: 1.049 Vali Loss: 8.537 Vali Acc: 0.460 Test Loss: 8.537 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1943938
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.477816581726074
Epoch: 1, Steps: 18 | Train Loss: 0.934 Vali Loss: 2.172 Vali Acc: 0.500 Test Loss: 2.172 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 2.6250741481781006
Epoch: 2, Steps: 18 | Train Loss: 1.105 Vali Loss: 1.433 Vali Acc: 0.520 Test Loss: 1.433 Test Acc: 0.520
Validation loss decreased (-0.499978 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 2.8719699382781982
Epoch: 3, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.166 Vali Acc: 0.480 Test Loss: 1.166 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7992100715637207
Epoch: 4, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.515 Vali Acc: 0.540 Test Loss: 1.515 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539985).  Saving model ...
Epoch: 5 cost time: 2.5721213817596436
Epoch: 5, Steps: 18 | Train Loss: 0.757 Vali Loss: 1.957 Vali Acc: 0.540 Test Loss: 1.957 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6202919483184814
Epoch: 6, Steps: 18 | Train Loss: 0.988 Vali Loss: 4.917 Vali Acc: 0.480 Test Loss: 4.917 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.460728883743286
Epoch: 7, Steps: 18 | Train Loss: 0.605 Vali Loss: 2.513 Vali Acc: 0.540 Test Loss: 2.513 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5908443927764893
Epoch: 8, Steps: 18 | Train Loss: 0.445 Vali Loss: 2.136 Vali Acc: 0.570 Test Loss: 2.136 Test Acc: 0.570
Validation loss decreased (-0.539985 --> -0.569979).  Saving model ...
Epoch: 9 cost time: 2.547786235809326
Epoch: 9, Steps: 18 | Train Loss: 0.773 Vali Loss: 5.810 Vali Acc: 0.590 Test Loss: 5.810 Test Acc: 0.590
Validation loss decreased (-0.569979 --> -0.589942).  Saving model ...
Epoch: 10 cost time: 2.3744821548461914
Epoch: 10, Steps: 18 | Train Loss: 0.917 Vali Loss: 3.219 Vali Acc: 0.450 Test Loss: 3.219 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3577089309692383
Epoch: 11, Steps: 18 | Train Loss: 0.214 Vali Loss: 6.920 Vali Acc: 0.490 Test Loss: 6.920 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2643027305603027
Epoch: 12, Steps: 18 | Train Loss: 1.108 Vali Loss: 7.094 Vali Acc: 0.520 Test Loss: 7.094 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.318758726119995
Epoch: 13, Steps: 18 | Train Loss: 2.308 Vali Loss: 4.512 Vali Acc: 0.510 Test Loss: 4.512 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.286928415298462
Epoch: 14, Steps: 18 | Train Loss: 0.339 Vali Loss: 4.935 Vali Acc: 0.470 Test Loss: 4.935 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5939323902130127
Epoch: 15, Steps: 18 | Train Loss: 0.326 Vali Loss: 6.209 Vali Acc: 0.440 Test Loss: 6.209 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4721455574035645
Epoch: 16, Steps: 18 | Train Loss: 0.289 Vali Loss: 4.980 Vali Acc: 0.520 Test Loss: 4.980 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3947529792785645
Epoch: 17, Steps: 18 | Train Loss: 0.210 Vali Loss: 5.740 Vali Acc: 0.510 Test Loss: 5.740 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.480692148208618
Epoch: 18, Steps: 18 | Train Loss: 0.315 Vali Loss: 10.539 Vali Acc: 0.510 Test Loss: 10.539 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6582746505737305
Epoch: 19, Steps: 18 | Train Loss: 0.247 Vali Loss: 8.738 Vali Acc: 0.470 Test Loss: 8.738 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1936258
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.2924935817718506
Epoch: 1, Steps: 18 | Train Loss: 0.859 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 1.2544939517974854
Epoch: 2, Steps: 18 | Train Loss: 1.039 Vali Loss: 1.337 Vali Acc: 0.590 Test Loss: 1.337 Test Acc: 0.590
Validation loss decreased (-0.489991 --> -0.589987).  Saving model ...
Epoch: 3 cost time: 1.1834006309509277
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 1.100 Vali Acc: 0.530 Test Loss: 1.100 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2406821250915527
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 1.375 Vali Acc: 0.510 Test Loss: 1.375 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.156554937362671
Epoch: 5, Steps: 18 | Train Loss: 1.118 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.389305830001831
Epoch: 6, Steps: 18 | Train Loss: 0.679 Vali Loss: 1.703 Vali Acc: 0.540 Test Loss: 1.703 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.239748477935791
Epoch: 7, Steps: 18 | Train Loss: 0.567 Vali Loss: 2.258 Vali Acc: 0.550 Test Loss: 2.258 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1784849166870117
Epoch: 8, Steps: 18 | Train Loss: 0.909 Vali Loss: 4.293 Vali Acc: 0.590 Test Loss: 4.293 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.261612892150879
Epoch: 9, Steps: 18 | Train Loss: 0.936 Vali Loss: 5.275 Vali Acc: 0.510 Test Loss: 5.275 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2139792442321777
Epoch: 10, Steps: 18 | Train Loss: 0.567 Vali Loss: 4.067 Vali Acc: 0.440 Test Loss: 4.067 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0677611827850342
Epoch: 11, Steps: 18 | Train Loss: 0.544 Vali Loss: 4.029 Vali Acc: 0.470 Test Loss: 4.029 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0272245407104492
Epoch: 12, Steps: 18 | Train Loss: 0.251 Vali Loss: 3.531 Vali Acc: 0.460 Test Loss: 3.531 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1928834
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.18286943435669
Epoch: 1, Steps: 18 | Train Loss: 0.977 Vali Loss: 0.986 Vali Acc: 0.490 Test Loss: 0.986 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 19.444023370742798
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.404 Vali Acc: 0.490 Test Loss: 1.404 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.16075873374939
Epoch: 3, Steps: 18 | Train Loss: 0.813 Vali Loss: 2.101 Vali Acc: 0.550 Test Loss: 2.101 Test Acc: 0.550
Validation loss decreased (-0.489990 --> -0.549979).  Saving model ...
Epoch: 4 cost time: 21.406777381896973
Epoch: 4, Steps: 18 | Train Loss: 0.688 Vali Loss: 1.942 Vali Acc: 0.510 Test Loss: 1.942 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.318389654159546
Epoch: 5, Steps: 18 | Train Loss: 1.051 Vali Loss: 2.851 Vali Acc: 0.590 Test Loss: 2.851 Test Acc: 0.590
Validation loss decreased (-0.549979 --> -0.589971).  Saving model ...
Epoch: 6 cost time: 19.79608416557312
Epoch: 6, Steps: 18 | Train Loss: 1.216 Vali Loss: 2.542 Vali Acc: 0.550 Test Loss: 2.542 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.808242321014404
Epoch: 7, Steps: 18 | Train Loss: 0.516 Vali Loss: 5.167 Vali Acc: 0.540 Test Loss: 5.167 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.321943998336792
Epoch: 8, Steps: 18 | Train Loss: 0.687 Vali Loss: 2.356 Vali Acc: 0.440 Test Loss: 2.356 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.846121072769165
Epoch: 9, Steps: 18 | Train Loss: 0.564 Vali Loss: 2.988 Vali Acc: 0.520 Test Loss: 2.988 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.955965042114258
Epoch: 10, Steps: 18 | Train Loss: 0.539 Vali Loss: 3.650 Vali Acc: 0.520 Test Loss: 3.650 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.727830171585083
Epoch: 11, Steps: 18 | Train Loss: 0.422 Vali Loss: 4.310 Vali Acc: 0.480 Test Loss: 4.310 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 20.310683488845825
Epoch: 12, Steps: 18 | Train Loss: 0.613 Vali Loss: 10.946 Vali Acc: 0.490 Test Loss: 10.946 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.14459800720215
Epoch: 13, Steps: 18 | Train Loss: 0.408 Vali Loss: 9.290 Vali Acc: 0.460 Test Loss: 9.290 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 20.336857080459595
Epoch: 14, Steps: 18 | Train Loss: 0.296 Vali Loss: 5.923 Vali Acc: 0.540 Test Loss: 5.923 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 20.50612211227417
Epoch: 15, Steps: 18 | Train Loss: 0.051 Vali Loss: 3.923 Vali Acc: 0.520 Test Loss: 3.923 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2023546
model size : 8.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.702378511428833
Epoch: 1, Steps: 18 | Train Loss: 0.948 Vali Loss: 1.106 Vali Acc: 0.520 Test Loss: 1.106 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 17.321467876434326
Epoch: 2, Steps: 18 | Train Loss: 0.919 Vali Loss: 1.447 Vali Acc: 0.530 Test Loss: 1.447 Test Acc: 0.530
Validation loss decreased (-0.519989 --> -0.529986).  Saving model ...
Epoch: 3 cost time: 16.802834272384644
Epoch: 3, Steps: 18 | Train Loss: 1.274 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.321255445480347
Epoch: 4, Steps: 18 | Train Loss: 0.947 Vali Loss: 5.472 Vali Acc: 0.490 Test Loss: 5.472 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.012293577194214
Epoch: 5, Steps: 18 | Train Loss: 1.181 Vali Loss: 5.994 Vali Acc: 0.490 Test Loss: 5.994 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.3774311542511
Epoch: 6, Steps: 18 | Train Loss: 1.242 Vali Loss: 2.111 Vali Acc: 0.550 Test Loss: 2.111 Test Acc: 0.550
Validation loss decreased (-0.529986 --> -0.549979).  Saving model ...
Epoch: 7 cost time: 16.58190894126892
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 2.138 Vali Acc: 0.510 Test Loss: 2.138 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.579829216003418
Epoch: 8, Steps: 18 | Train Loss: 0.940 Vali Loss: 2.615 Vali Acc: 0.510 Test Loss: 2.615 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.19379711151123
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 2.598 Vali Acc: 0.480 Test Loss: 2.598 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.634469985961914
Epoch: 10, Steps: 18 | Train Loss: 0.727 Vali Loss: 2.463 Vali Acc: 0.560 Test Loss: 2.463 Test Acc: 0.560
Validation loss decreased (-0.549979 --> -0.559975).  Saving model ...
Epoch: 11 cost time: 17.356154918670654
Epoch: 11, Steps: 18 | Train Loss: 1.039 Vali Loss: 4.636 Vali Acc: 0.530 Test Loss: 4.636 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.22022294998169
Epoch: 12, Steps: 18 | Train Loss: 0.791 Vali Loss: 4.655 Vali Acc: 0.500 Test Loss: 4.655 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.11467456817627
Epoch: 13, Steps: 18 | Train Loss: 0.842 Vali Loss: 7.511 Vali Acc: 0.550 Test Loss: 7.511 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.9865665435791
Epoch: 14, Steps: 18 | Train Loss: 0.631 Vali Loss: 7.387 Vali Acc: 0.520 Test Loss: 7.387 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.21484661102295
Epoch: 15, Steps: 18 | Train Loss: 0.577 Vali Loss: 3.991 Vali Acc: 0.530 Test Loss: 3.991 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 17.41006898880005
Epoch: 16, Steps: 18 | Train Loss: 0.583 Vali Loss: 6.026 Vali Acc: 0.570 Test Loss: 6.026 Test Acc: 0.570
Validation loss decreased (-0.559975 --> -0.569940).  Saving model ...
Epoch: 17 cost time: 15.680756330490112
Epoch: 17, Steps: 18 | Train Loss: 0.160 Vali Loss: 5.074 Vali Acc: 0.570 Test Loss: 5.074 Test Acc: 0.570
Validation loss decreased (-0.569940 --> -0.569949).  Saving model ...
Epoch: 18 cost time: 17.97178339958191
Epoch: 18, Steps: 18 | Train Loss: 0.198 Vali Loss: 5.602 Vali Acc: 0.560 Test Loss: 5.602 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.666946411132812
Epoch: 19, Steps: 18 | Train Loss: 0.683 Vali Loss: 5.029 Vali Acc: 0.540 Test Loss: 5.029 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.004906177520752
Epoch: 20, Steps: 18 | Train Loss: 0.589 Vali Loss: 7.106 Vali Acc: 0.540 Test Loss: 7.106 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 20.36830711364746
Epoch: 21, Steps: 18 | Train Loss: 0.471 Vali Loss: 12.177 Vali Acc: 0.530 Test Loss: 12.177 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 20.603350162506104
Epoch: 22, Steps: 18 | Train Loss: 0.642 Vali Loss: 8.350 Vali Acc: 0.490 Test Loss: 8.350 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 17.505945205688477
Epoch: 23, Steps: 18 | Train Loss: 0.445 Vali Loss: 7.643 Vali Acc: 0.570 Test Loss: 7.643 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 17.62333607673645
Epoch: 24, Steps: 18 | Train Loss: 0.206 Vali Loss: 8.173 Vali Acc: 0.530 Test Loss: 8.173 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.068540573120117
Epoch: 25, Steps: 18 | Train Loss: 0.249 Vali Loss: 10.534 Vali Acc: 0.530 Test Loss: 10.534 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 19.70831608772278
Epoch: 26, Steps: 18 | Train Loss: 0.456 Vali Loss: 7.918 Vali Acc: 0.540 Test Loss: 7.918 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 19.508992910385132
Epoch: 27, Steps: 18 | Train Loss: 0.126 Vali Loss: 11.841 Vali Acc: 0.530 Test Loss: 11.841 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2004346
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.839112520217896
Epoch: 1, Steps: 18 | Train Loss: 0.834 Vali Loss: 0.937 Vali Acc: 0.620 Test Loss: 0.937 Test Acc: 0.620
Validation loss decreased (inf --> -0.619991).  Saving model ...
Epoch: 2 cost time: 13.240696907043457
Epoch: 2, Steps: 18 | Train Loss: 0.693 Vali Loss: 2.240 Vali Acc: 0.480 Test Loss: 2.240 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.869686365127563
Epoch: 3, Steps: 18 | Train Loss: 0.999 Vali Loss: 1.518 Vali Acc: 0.470 Test Loss: 1.518 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.300331830978394
Epoch: 4, Steps: 18 | Train Loss: 1.057 Vali Loss: 1.814 Vali Acc: 0.510 Test Loss: 1.814 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.542806625366211
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 3.681 Vali Acc: 0.540 Test Loss: 3.681 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.066110849380493
Epoch: 6, Steps: 18 | Train Loss: 0.454 Vali Loss: 2.593 Vali Acc: 0.500 Test Loss: 2.593 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.915459156036377
Epoch: 7, Steps: 18 | Train Loss: 1.251 Vali Loss: 3.353 Vali Acc: 0.510 Test Loss: 3.353 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.237430334091187
Epoch: 8, Steps: 18 | Train Loss: 1.032 Vali Loss: 4.860 Vali Acc: 0.440 Test Loss: 4.860 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.907785654067993
Epoch: 9, Steps: 18 | Train Loss: 0.866 Vali Loss: 4.811 Vali Acc: 0.480 Test Loss: 4.811 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.77428150177002
Epoch: 10, Steps: 18 | Train Loss: 1.249 Vali Loss: 5.640 Vali Acc: 0.520 Test Loss: 5.640 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.183377981185913
Epoch: 11, Steps: 18 | Train Loss: 0.637 Vali Loss: 4.025 Vali Acc: 0.480 Test Loss: 4.025 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1985146
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.425749778747559
Epoch: 1, Steps: 18 | Train Loss: 0.943 Vali Loss: 1.118 Vali Acc: 0.570 Test Loss: 1.118 Test Acc: 0.570
Validation loss decreased (inf --> -0.569989).  Saving model ...
Epoch: 2 cost time: 8.758748769760132
Epoch: 2, Steps: 18 | Train Loss: 1.164 Vali Loss: 1.104 Vali Acc: 0.530 Test Loss: 1.104 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.631867408752441
Epoch: 3, Steps: 18 | Train Loss: 0.517 Vali Loss: 2.095 Vali Acc: 0.510 Test Loss: 2.095 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.727177619934082
Epoch: 4, Steps: 18 | Train Loss: 0.532 Vali Loss: 2.086 Vali Acc: 0.540 Test Loss: 2.086 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.269409418106079
Epoch: 5, Steps: 18 | Train Loss: 0.655 Vali Loss: 1.542 Vali Acc: 0.580 Test Loss: 1.542 Test Acc: 0.580
Validation loss decreased (-0.569989 --> -0.579985).  Saving model ...
Epoch: 6 cost time: 8.743929862976074
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 3.394 Vali Acc: 0.490 Test Loss: 3.394 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.007007837295532
Epoch: 7, Steps: 18 | Train Loss: 0.520 Vali Loss: 3.751 Vali Acc: 0.480 Test Loss: 3.751 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.676032066345215
Epoch: 8, Steps: 18 | Train Loss: 1.188 Vali Loss: 5.757 Vali Acc: 0.470 Test Loss: 5.757 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.933821201324463
Epoch: 9, Steps: 18 | Train Loss: 0.354 Vali Loss: 2.905 Vali Acc: 0.520 Test Loss: 2.905 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.160068988800049
Epoch: 10, Steps: 18 | Train Loss: 0.696 Vali Loss: 3.458 Vali Acc: 0.530 Test Loss: 3.458 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.89621090888977
Epoch: 11, Steps: 18 | Train Loss: 0.317 Vali Loss: 3.846 Vali Acc: 0.480 Test Loss: 3.846 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.305009126663208
Epoch: 12, Steps: 18 | Train Loss: 0.180 Vali Loss: 5.782 Vali Acc: 0.560 Test Loss: 5.782 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.707969903945923
Epoch: 13, Steps: 18 | Train Loss: 0.587 Vali Loss: 4.445 Vali Acc: 0.540 Test Loss: 4.445 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.134393453598022
Epoch: 14, Steps: 18 | Train Loss: 0.467 Vali Loss: 7.453 Vali Acc: 0.510 Test Loss: 7.453 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.274372816085815
Epoch: 15, Steps: 18 | Train Loss: 0.113 Vali Loss: 5.595 Vali Acc: 0.520 Test Loss: 5.595 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1965946
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.212368726730347
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 1.171 Vali Acc: 0.450 Test Loss: 1.171 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 6.257318019866943
Epoch: 2, Steps: 18 | Train Loss: 1.138 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 6.738036632537842
Epoch: 3, Steps: 18 | Train Loss: 0.952 Vali Loss: 1.119 Vali Acc: 0.510 Test Loss: 1.119 Test Acc: 0.510
Validation loss decreased (-0.499988 --> -0.509989).  Saving model ...
Epoch: 4 cost time: 5.810410499572754
Epoch: 4, Steps: 18 | Train Loss: 0.873 Vali Loss: 2.896 Vali Acc: 0.550 Test Loss: 2.896 Test Acc: 0.550
Validation loss decreased (-0.509989 --> -0.549971).  Saving model ...
Epoch: 5 cost time: 5.349359512329102
Epoch: 5, Steps: 18 | Train Loss: 1.560 Vali Loss: 3.285 Vali Acc: 0.520 Test Loss: 3.285 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2650721073150635
Epoch: 6, Steps: 18 | Train Loss: 1.216 Vali Loss: 2.707 Vali Acc: 0.520 Test Loss: 2.707 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.658273696899414
Epoch: 7, Steps: 18 | Train Loss: 0.536 Vali Loss: 3.146 Vali Acc: 0.490 Test Loss: 3.146 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.008906126022339
Epoch: 8, Steps: 18 | Train Loss: 1.154 Vali Loss: 7.463 Vali Acc: 0.500 Test Loss: 7.463 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.668192148208618
Epoch: 9, Steps: 18 | Train Loss: 0.419 Vali Loss: 8.389 Vali Acc: 0.470 Test Loss: 8.389 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.990508794784546
Epoch: 10, Steps: 18 | Train Loss: 0.880 Vali Loss: 6.650 Vali Acc: 0.460 Test Loss: 6.650 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.883960485458374
Epoch: 11, Steps: 18 | Train Loss: 0.835 Vali Loss: 8.340 Vali Acc: 0.520 Test Loss: 8.340 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.541316032409668
Epoch: 12, Steps: 18 | Train Loss: 0.320 Vali Loss: 5.211 Vali Acc: 0.500 Test Loss: 5.211 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.038130521774292
Epoch: 13, Steps: 18 | Train Loss: 0.989 Vali Loss: 5.825 Vali Acc: 0.530 Test Loss: 5.825 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.561997175216675
Epoch: 14, Steps: 18 | Train Loss: 0.556 Vali Loss: 5.990 Vali Acc: 0.470 Test Loss: 5.990 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1950586
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.416815996170044
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 4.255394697189331
Epoch: 2, Steps: 18 | Train Loss: 0.640 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.302465200424194
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 1.838 Vali Acc: 0.530 Test Loss: 1.838 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529982).  Saving model ...
Epoch: 4 cost time: 4.397040843963623
Epoch: 4, Steps: 18 | Train Loss: 0.483 Vali Loss: 2.911 Vali Acc: 0.530 Test Loss: 2.911 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.259826421737671
Epoch: 5, Steps: 18 | Train Loss: 1.597 Vali Loss: 2.609 Vali Acc: 0.530 Test Loss: 2.609 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.272602558135986
Epoch: 6, Steps: 18 | Train Loss: 1.357 Vali Loss: 2.441 Vali Acc: 0.550 Test Loss: 2.441 Test Acc: 0.550
Validation loss decreased (-0.529982 --> -0.549976).  Saving model ...
Epoch: 7 cost time: 4.3800623416900635
Epoch: 7, Steps: 18 | Train Loss: 1.165 Vali Loss: 3.104 Vali Acc: 0.530 Test Loss: 3.104 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.1975462436676025
Epoch: 8, Steps: 18 | Train Loss: 1.166 Vali Loss: 3.472 Vali Acc: 0.480 Test Loss: 3.472 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.243912220001221
Epoch: 9, Steps: 18 | Train Loss: 1.192 Vali Loss: 4.301 Vali Acc: 0.540 Test Loss: 4.301 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.401061773300171
Epoch: 10, Steps: 18 | Train Loss: 0.496 Vali Loss: 4.437 Vali Acc: 0.520 Test Loss: 4.437 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.179999351501465
Epoch: 11, Steps: 18 | Train Loss: 0.218 Vali Loss: 3.459 Vali Acc: 0.530 Test Loss: 3.459 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.7241294384002686
Epoch: 12, Steps: 18 | Train Loss: 0.381 Vali Loss: 4.764 Vali Acc: 0.510 Test Loss: 4.764 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.248169898986816
Epoch: 13, Steps: 18 | Train Loss: 0.450 Vali Loss: 4.978 Vali Acc: 0.480 Test Loss: 4.978 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.280114650726318
Epoch: 14, Steps: 18 | Train Loss: 0.937 Vali Loss: 6.615 Vali Acc: 0.540 Test Loss: 6.615 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.605052709579468
Epoch: 15, Steps: 18 | Train Loss: 0.231 Vali Loss: 7.893 Vali Acc: 0.550 Test Loss: 7.893 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.102839469909668
Epoch: 16, Steps: 18 | Train Loss: 0.651 Vali Loss: 4.791 Vali Acc: 0.510 Test Loss: 4.791 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1942906
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6556434631347656
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 0.897 Vali Acc: 0.620 Test Loss: 0.897 Test Acc: 0.620
Validation loss decreased (inf --> -0.619991).  Saving model ...
Epoch: 2 cost time: 2.752678632736206
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.929 Vali Acc: 0.480 Test Loss: 1.929 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.697139263153076
Epoch: 3, Steps: 18 | Train Loss: 0.698 Vali Loss: 1.478 Vali Acc: 0.590 Test Loss: 1.478 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7692906856536865
Epoch: 4, Steps: 18 | Train Loss: 0.526 Vali Loss: 2.328 Vali Acc: 0.520 Test Loss: 2.328 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5346555709838867
Epoch: 5, Steps: 18 | Train Loss: 0.899 Vali Loss: 2.193 Vali Acc: 0.480 Test Loss: 2.193 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.529716968536377
Epoch: 6, Steps: 18 | Train Loss: 0.690 Vali Loss: 3.003 Vali Acc: 0.520 Test Loss: 3.003 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.583498239517212
Epoch: 7, Steps: 18 | Train Loss: 0.594 Vali Loss: 2.122 Vali Acc: 0.580 Test Loss: 2.122 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.477815628051758
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 3.298 Vali Acc: 0.520 Test Loss: 3.298 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8914194107055664
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 3.795 Vali Acc: 0.530 Test Loss: 3.795 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8892953395843506
Epoch: 10, Steps: 18 | Train Loss: 0.356 Vali Loss: 4.086 Vali Acc: 0.520 Test Loss: 4.086 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.703673839569092
Epoch: 11, Steps: 18 | Train Loss: 0.927 Vali Loss: 5.452 Vali Acc: 0.490 Test Loss: 5.452 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1935226
model size : 7.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.3343992233276367
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.3121252059936523
Epoch: 2, Steps: 18 | Train Loss: 0.867 Vali Loss: 1.585 Vali Acc: 0.540 Test Loss: 1.585 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 1.3462345600128174
Epoch: 3, Steps: 18 | Train Loss: 0.830 Vali Loss: 2.390 Vali Acc: 0.460 Test Loss: 2.390 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3013958930969238
Epoch: 4, Steps: 18 | Train Loss: 1.367 Vali Loss: 2.965 Vali Acc: 0.480 Test Loss: 2.965 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2575016021728516
Epoch: 5, Steps: 18 | Train Loss: 0.879 Vali Loss: 1.856 Vali Acc: 0.500 Test Loss: 1.856 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2934751510620117
Epoch: 6, Steps: 18 | Train Loss: 0.465 Vali Loss: 2.526 Vali Acc: 0.530 Test Loss: 2.526 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3950388431549072
Epoch: 7, Steps: 18 | Train Loss: 1.799 Vali Loss: 3.100 Vali Acc: 0.500 Test Loss: 3.100 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3357996940612793
Epoch: 8, Steps: 18 | Train Loss: 1.297 Vali Loss: 2.190 Vali Acc: 0.530 Test Loss: 2.190 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3042292594909668
Epoch: 9, Steps: 18 | Train Loss: 0.932 Vali Loss: 2.973 Vali Acc: 0.500 Test Loss: 2.973 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.236757755279541
Epoch: 10, Steps: 18 | Train Loss: 0.640 Vali Loss: 3.857 Vali Acc: 0.480 Test Loss: 3.857 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3005704879760742
Epoch: 11, Steps: 18 | Train Loss: 0.502 Vali Loss: 2.971 Vali Acc: 0.530 Test Loss: 2.971 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2995083332061768
Epoch: 12, Steps: 18 | Train Loss: 1.281 Vali Loss: 4.137 Vali Acc: 0.580 Test Loss: 4.137 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579959).  Saving model ...
Epoch: 13 cost time: 1.1136627197265625
Epoch: 13, Steps: 18 | Train Loss: 0.683 Vali Loss: 4.497 Vali Acc: 0.520 Test Loss: 4.497 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1621029376983643
Epoch: 14, Steps: 18 | Train Loss: 0.471 Vali Loss: 4.225 Vali Acc: 0.560 Test Loss: 4.225 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.101090908050537
Epoch: 15, Steps: 18 | Train Loss: 0.480 Vali Loss: 3.022 Vali Acc: 0.520 Test Loss: 3.022 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.169374704360962
Epoch: 16, Steps: 18 | Train Loss: 0.623 Vali Loss: 4.378 Vali Acc: 0.530 Test Loss: 4.378 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.111032485961914
Epoch: 17, Steps: 18 | Train Loss: 0.637 Vali Loss: 9.617 Vali Acc: 0.530 Test Loss: 9.617 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1243104934692383
Epoch: 18, Steps: 18 | Train Loss: 0.778 Vali Loss: 5.091 Vali Acc: 0.520 Test Loss: 5.091 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1861937046051025
Epoch: 19, Steps: 18 | Train Loss: 0.586 Vali Loss: 5.623 Vali Acc: 0.540 Test Loss: 5.623 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.172886610031128
Epoch: 20, Steps: 18 | Train Loss: 0.275 Vali Loss: 8.117 Vali Acc: 0.520 Test Loss: 8.117 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2267529964447021
Epoch: 21, Steps: 18 | Train Loss: 0.883 Vali Loss: 6.652 Vali Acc: 0.540 Test Loss: 6.652 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2117764949798584
Epoch: 22, Steps: 18 | Train Loss: 0.405 Vali Loss: 14.331 Vali Acc: 0.490 Test Loss: 14.331 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1927802
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.47328805923462
Epoch: 1, Steps: 18 | Train Loss: 0.929 Vali Loss: 1.346 Vali Acc: 0.440 Test Loss: 1.346 Test Acc: 0.440
Validation loss decreased (inf --> -0.439987).  Saving model ...
Epoch: 2 cost time: 25.10490345954895
Epoch: 2, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.936 Vali Acc: 0.620 Test Loss: 0.936 Test Acc: 0.620
Validation loss decreased (-0.439987 --> -0.619991).  Saving model ...
Epoch: 3 cost time: 22.98573398590088
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 2.602 Vali Acc: 0.480 Test Loss: 2.602 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.698445081710815
Epoch: 4, Steps: 18 | Train Loss: 0.829 Vali Loss: 1.650 Vali Acc: 0.480 Test Loss: 1.650 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.130828857421875
Epoch: 5, Steps: 18 | Train Loss: 0.627 Vali Loss: 1.525 Vali Acc: 0.560 Test Loss: 1.525 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.572981357574463
Epoch: 6, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.53299641609192
Epoch: 7, Steps: 18 | Train Loss: 0.581 Vali Loss: 3.024 Vali Acc: 0.560 Test Loss: 3.024 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.185991048812866
Epoch: 8, Steps: 18 | Train Loss: 0.661 Vali Loss: 4.256 Vali Acc: 0.500 Test Loss: 4.256 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.485013484954834
Epoch: 9, Steps: 18 | Train Loss: 1.009 Vali Loss: 3.434 Vali Acc: 0.530 Test Loss: 3.434 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.90054440498352
Epoch: 10, Steps: 18 | Train Loss: 0.536 Vali Loss: 5.709 Vali Acc: 0.540 Test Loss: 5.709 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.774350881576538
Epoch: 11, Steps: 18 | Train Loss: 1.161 Vali Loss: 2.887 Vali Acc: 0.580 Test Loss: 2.887 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 20.210529565811157
Epoch: 12, Steps: 18 | Train Loss: 1.057 Vali Loss: 5.360 Vali Acc: 0.530 Test Loss: 5.360 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2023030
model size : 8.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.382503271102905
Epoch: 1, Steps: 18 | Train Loss: 0.834 Vali Loss: 0.841 Vali Acc: 0.560 Test Loss: 0.841 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 19.552567958831787
Epoch: 2, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.837 Vali Acc: 0.480 Test Loss: 1.837 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.819361209869385
Epoch: 3, Steps: 18 | Train Loss: 0.966 Vali Loss: 1.387 Vali Acc: 0.510 Test Loss: 1.387 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.67643976211548
Epoch: 4, Steps: 18 | Train Loss: 0.616 Vali Loss: 2.020 Vali Acc: 0.480 Test Loss: 2.020 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.01429319381714
Epoch: 5, Steps: 18 | Train Loss: 0.540 Vali Loss: 2.886 Vali Acc: 0.480 Test Loss: 2.886 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.858416080474854
Epoch: 6, Steps: 18 | Train Loss: 0.484 Vali Loss: 2.620 Vali Acc: 0.570 Test Loss: 2.620 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569974).  Saving model ...
Epoch: 7 cost time: 19.980127573013306
Epoch: 7, Steps: 18 | Train Loss: 0.815 Vali Loss: 2.217 Vali Acc: 0.500 Test Loss: 2.217 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.61067771911621
Epoch: 8, Steps: 18 | Train Loss: 0.691 Vali Loss: 2.405 Vali Acc: 0.540 Test Loss: 2.405 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.18450403213501
Epoch: 9, Steps: 18 | Train Loss: 0.268 Vali Loss: 3.372 Vali Acc: 0.500 Test Loss: 3.372 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.434481859207153
Epoch: 10, Steps: 18 | Train Loss: 0.331 Vali Loss: 3.174 Vali Acc: 0.520 Test Loss: 3.174 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.933557510375977
Epoch: 11, Steps: 18 | Train Loss: 0.539 Vali Loss: 10.756 Vali Acc: 0.490 Test Loss: 10.756 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 19.9072048664093
Epoch: 12, Steps: 18 | Train Loss: 0.666 Vali Loss: 3.223 Vali Acc: 0.550 Test Loss: 3.223 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.847041130065918
Epoch: 13, Steps: 18 | Train Loss: 0.478 Vali Loss: 3.850 Vali Acc: 0.530 Test Loss: 3.850 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.015767574310303
Epoch: 14, Steps: 18 | Train Loss: 0.219 Vali Loss: 3.961 Vali Acc: 0.580 Test Loss: 3.961 Test Acc: 0.580
Validation loss decreased (-0.569974 --> -0.579960).  Saving model ...
Epoch: 15 cost time: 16.97104787826538
Epoch: 15, Steps: 18 | Train Loss: 0.079 Vali Loss: 6.216 Vali Acc: 0.520 Test Loss: 6.216 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.543176651000977
Epoch: 16, Steps: 18 | Train Loss: 0.175 Vali Loss: 4.307 Vali Acc: 0.560 Test Loss: 4.307 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 18.522515058517456
Epoch: 17, Steps: 18 | Train Loss: 0.584 Vali Loss: 4.593 Vali Acc: 0.540 Test Loss: 4.593 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.698442459106445
Epoch: 18, Steps: 18 | Train Loss: 0.698 Vali Loss: 5.263 Vali Acc: 0.560 Test Loss: 5.263 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.849283695220947
Epoch: 19, Steps: 18 | Train Loss: 0.158 Vali Loss: 4.837 Vali Acc: 0.510 Test Loss: 4.837 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.198237657546997
Epoch: 20, Steps: 18 | Train Loss: 0.740 Vali Loss: 10.539 Vali Acc: 0.530 Test Loss: 10.539 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.78080415725708
Epoch: 21, Steps: 18 | Train Loss: 0.886 Vali Loss: 6.541 Vali Acc: 0.490 Test Loss: 6.541 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 18.782022953033447
Epoch: 22, Steps: 18 | Train Loss: 1.037 Vali Loss: 8.125 Vali Acc: 0.500 Test Loss: 8.125 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 18.179593801498413
Epoch: 23, Steps: 18 | Train Loss: 0.587 Vali Loss: 17.490 Vali Acc: 0.480 Test Loss: 17.490 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 17.759403705596924
Epoch: 24, Steps: 18 | Train Loss: 0.481 Vali Loss: 10.403 Vali Acc: 0.510 Test Loss: 10.403 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2003830
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.689642429351807
Epoch: 1, Steps: 18 | Train Loss: 1.117 Vali Loss: 1.027 Vali Acc: 0.470 Test Loss: 1.027 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 14.416695833206177
Epoch: 2, Steps: 18 | Train Loss: 1.097 Vali Loss: 1.685 Vali Acc: 0.530 Test Loss: 1.685 Test Acc: 0.530
Validation loss decreased (-0.469990 --> -0.529983).  Saving model ...
Epoch: 3 cost time: 13.721543788909912
Epoch: 3, Steps: 18 | Train Loss: 1.645 Vali Loss: 1.752 Vali Acc: 0.630 Test Loss: 1.752 Test Acc: 0.630
Validation loss decreased (-0.529983 --> -0.629982).  Saving model ...
Epoch: 4 cost time: 12.370567560195923
Epoch: 4, Steps: 18 | Train Loss: 0.840 Vali Loss: 2.025 Vali Acc: 0.500 Test Loss: 2.025 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.374469518661499
Epoch: 5, Steps: 18 | Train Loss: 0.891 Vali Loss: 1.567 Vali Acc: 0.570 Test Loss: 1.567 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.73280668258667
Epoch: 6, Steps: 18 | Train Loss: 0.679 Vali Loss: 4.715 Vali Acc: 0.490 Test Loss: 4.715 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.101666688919067
Epoch: 7, Steps: 18 | Train Loss: 0.581 Vali Loss: 3.907 Vali Acc: 0.500 Test Loss: 3.907 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.800203800201416
Epoch: 8, Steps: 18 | Train Loss: 0.644 Vali Loss: 3.106 Vali Acc: 0.500 Test Loss: 3.106 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.561082601547241
Epoch: 9, Steps: 18 | Train Loss: 0.714 Vali Loss: 5.130 Vali Acc: 0.470 Test Loss: 5.130 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.241722583770752
Epoch: 10, Steps: 18 | Train Loss: 0.642 Vali Loss: 2.473 Vali Acc: 0.510 Test Loss: 2.473 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.857621908187866
Epoch: 11, Steps: 18 | Train Loss: 0.319 Vali Loss: 3.448 Vali Acc: 0.470 Test Loss: 3.448 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.684935569763184
Epoch: 12, Steps: 18 | Train Loss: 0.217 Vali Loss: 3.947 Vali Acc: 0.490 Test Loss: 3.947 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.97897720336914
Epoch: 13, Steps: 18 | Train Loss: 0.363 Vali Loss: 6.345 Vali Acc: 0.500 Test Loss: 6.345 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1984630
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.468019247055054
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 1.438 Vali Acc: 0.540 Test Loss: 1.438 Test Acc: 0.540
Validation loss decreased (inf --> -0.539986).  Saving model ...
Epoch: 2 cost time: 8.788922548294067
Epoch: 2, Steps: 18 | Train Loss: 0.926 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
Validation loss decreased (-0.539986 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 8.746612787246704
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 1.782 Vali Acc: 0.540 Test Loss: 1.782 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.615212202072144
Epoch: 4, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.333 Vali Acc: 0.510 Test Loss: 1.333 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.288856983184814
Epoch: 5, Steps: 18 | Train Loss: 1.518 Vali Loss: 3.003 Vali Acc: 0.520 Test Loss: 3.003 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.251548767089844
Epoch: 6, Steps: 18 | Train Loss: 0.556 Vali Loss: 2.258 Vali Acc: 0.540 Test Loss: 2.258 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.42605471611023
Epoch: 7, Steps: 18 | Train Loss: 0.725 Vali Loss: 1.853 Vali Acc: 0.550 Test Loss: 1.853 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 9.405928611755371
Epoch: 8, Steps: 18 | Train Loss: 0.956 Vali Loss: 2.459 Vali Acc: 0.530 Test Loss: 2.459 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.30336594581604
Epoch: 9, Steps: 18 | Train Loss: 0.958 Vali Loss: 3.751 Vali Acc: 0.560 Test Loss: 3.751 Test Acc: 0.560
Validation loss decreased (-0.549981 --> -0.559962).  Saving model ...
Epoch: 10 cost time: 8.906705379486084
Epoch: 10, Steps: 18 | Train Loss: 0.729 Vali Loss: 2.920 Vali Acc: 0.540 Test Loss: 2.920 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.854602813720703
Epoch: 11, Steps: 18 | Train Loss: 0.715 Vali Loss: 5.677 Vali Acc: 0.510 Test Loss: 5.677 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.107604503631592
Epoch: 12, Steps: 18 | Train Loss: 0.864 Vali Loss: 3.489 Vali Acc: 0.520 Test Loss: 3.489 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.239677906036377
Epoch: 13, Steps: 18 | Train Loss: 0.657 Vali Loss: 7.246 Vali Acc: 0.480 Test Loss: 7.246 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.085453510284424
Epoch: 14, Steps: 18 | Train Loss: 0.449 Vali Loss: 3.672 Vali Acc: 0.430 Test Loss: 3.672 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.859355688095093
Epoch: 15, Steps: 18 | Train Loss: 0.251 Vali Loss: 4.492 Vali Acc: 0.540 Test Loss: 4.492 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.369510650634766
Epoch: 16, Steps: 18 | Train Loss: 0.323 Vali Loss: 5.003 Vali Acc: 0.550 Test Loss: 5.003 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.956166505813599
Epoch: 17, Steps: 18 | Train Loss: 0.225 Vali Loss: 3.886 Vali Acc: 0.500 Test Loss: 3.886 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.266232967376709
Epoch: 18, Steps: 18 | Train Loss: 0.083 Vali Loss: 4.835 Vali Acc: 0.500 Test Loss: 4.835 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.206719636917114
Epoch: 19, Steps: 18 | Train Loss: 0.287 Vali Loss: 7.326 Vali Acc: 0.540 Test Loss: 7.326 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1965430
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.341494560241699
Epoch: 1, Steps: 18 | Train Loss: 0.870 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 6.542932033538818
Epoch: 2, Steps: 18 | Train Loss: 1.095 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9333271980285645
Epoch: 3, Steps: 18 | Train Loss: 1.260 Vali Loss: 2.648 Vali Acc: 0.520 Test Loss: 2.648 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.135863780975342
Epoch: 4, Steps: 18 | Train Loss: 1.438 Vali Loss: 1.782 Vali Acc: 0.620 Test Loss: 1.782 Test Acc: 0.620
Validation loss decreased (-0.519991 --> -0.619982).  Saving model ...
Epoch: 5 cost time: 5.846737861633301
Epoch: 5, Steps: 18 | Train Loss: 0.677 Vali Loss: 1.702 Vali Acc: 0.540 Test Loss: 1.702 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.775453090667725
Epoch: 6, Steps: 18 | Train Loss: 0.675 Vali Loss: 4.156 Vali Acc: 0.480 Test Loss: 4.156 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.130537271499634
Epoch: 7, Steps: 18 | Train Loss: 0.961 Vali Loss: 2.805 Vali Acc: 0.510 Test Loss: 2.805 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.707904815673828
Epoch: 8, Steps: 18 | Train Loss: 0.586 Vali Loss: 2.450 Vali Acc: 0.460 Test Loss: 2.450 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.102806329727173
Epoch: 9, Steps: 18 | Train Loss: 0.692 Vali Loss: 2.134 Vali Acc: 0.540 Test Loss: 2.134 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.959235429763794
Epoch: 10, Steps: 18 | Train Loss: 0.345 Vali Loss: 3.329 Vali Acc: 0.560 Test Loss: 3.329 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.947203874588013
Epoch: 11, Steps: 18 | Train Loss: 0.530 Vali Loss: 3.397 Vali Acc: 0.510 Test Loss: 3.397 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.127299547195435
Epoch: 12, Steps: 18 | Train Loss: 0.183 Vali Loss: 4.770 Vali Acc: 0.470 Test Loss: 4.770 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.604848384857178
Epoch: 13, Steps: 18 | Train Loss: 0.470 Vali Loss: 5.036 Vali Acc: 0.550 Test Loss: 5.036 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.328551530838013
Epoch: 14, Steps: 18 | Train Loss: 0.225 Vali Loss: 3.193 Vali Acc: 0.570 Test Loss: 3.193 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1950070
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.488194465637207
Epoch: 1, Steps: 18 | Train Loss: 0.930 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 4.2254040241241455
Epoch: 2, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.987 Vali Acc: 0.540 Test Loss: 0.987 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.300229787826538
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.898 Vali Acc: 0.510 Test Loss: 0.898 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.393511533737183
Epoch: 4, Steps: 18 | Train Loss: 1.140 Vali Loss: 2.123 Vali Acc: 0.510 Test Loss: 2.123 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.279024124145508
Epoch: 5, Steps: 18 | Train Loss: 1.285 Vali Loss: 2.085 Vali Acc: 0.540 Test Loss: 2.085 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.337665796279907
Epoch: 6, Steps: 18 | Train Loss: 1.080 Vali Loss: 1.600 Vali Acc: 0.430 Test Loss: 1.600 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.478942155838013
Epoch: 7, Steps: 18 | Train Loss: 0.588 Vali Loss: 4.847 Vali Acc: 0.480 Test Loss: 4.847 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.268846273422241
Epoch: 8, Steps: 18 | Train Loss: 0.947 Vali Loss: 4.173 Vali Acc: 0.530 Test Loss: 4.173 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.5352864265441895
Epoch: 9, Steps: 18 | Train Loss: 1.494 Vali Loss: 3.177 Vali Acc: 0.540 Test Loss: 3.177 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.115866661071777
Epoch: 10, Steps: 18 | Train Loss: 0.924 Vali Loss: 4.729 Vali Acc: 0.510 Test Loss: 4.729 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.778999328613281
Epoch: 11, Steps: 18 | Train Loss: 0.463 Vali Loss: 4.240 Vali Acc: 0.590 Test Loss: 4.240 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589958).  Saving model ...
Epoch: 12 cost time: 4.596494436264038
Epoch: 12, Steps: 18 | Train Loss: 0.386 Vali Loss: 6.161 Vali Acc: 0.540 Test Loss: 6.161 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.974193811416626
Epoch: 13, Steps: 18 | Train Loss: 0.382 Vali Loss: 6.809 Vali Acc: 0.530 Test Loss: 6.809 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.964889049530029
Epoch: 14, Steps: 18 | Train Loss: 1.445 Vali Loss: 4.397 Vali Acc: 0.510 Test Loss: 4.397 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.179681777954102
Epoch: 15, Steps: 18 | Train Loss: 0.438 Vali Loss: 4.670 Vali Acc: 0.580 Test Loss: 4.670 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.475691795349121
Epoch: 16, Steps: 18 | Train Loss: 0.408 Vali Loss: 8.566 Vali Acc: 0.520 Test Loss: 8.566 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.197955369949341
Epoch: 17, Steps: 18 | Train Loss: 0.759 Vali Loss: 6.653 Vali Acc: 0.520 Test Loss: 6.653 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.2770044803619385
Epoch: 18, Steps: 18 | Train Loss: 0.517 Vali Loss: 10.421 Vali Acc: 0.520 Test Loss: 10.421 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.2439494132995605
Epoch: 19, Steps: 18 | Train Loss: 0.486 Vali Loss: 9.107 Vali Acc: 0.530 Test Loss: 9.107 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.2493932247161865
Epoch: 20, Steps: 18 | Train Loss: 0.379 Vali Loss: 6.541 Vali Acc: 0.550 Test Loss: 6.541 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.614751815795898
Epoch: 21, Steps: 18 | Train Loss: 0.769 Vali Loss: 8.893 Vali Acc: 0.540 Test Loss: 8.893 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1942390
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.2154223918914795
Epoch: 1, Steps: 18 | Train Loss: 0.890 Vali Loss: 0.893 Vali Acc: 0.580 Test Loss: 0.893 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 3.2002649307250977
Epoch: 2, Steps: 18 | Train Loss: 0.953 Vali Loss: 2.605 Vali Acc: 0.500 Test Loss: 2.605 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9802498817443848
Epoch: 3, Steps: 18 | Train Loss: 0.898 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0701475143432617
Epoch: 4, Steps: 18 | Train Loss: 0.658 Vali Loss: 1.666 Vali Acc: 0.550 Test Loss: 1.666 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1162755489349365
Epoch: 5, Steps: 18 | Train Loss: 0.341 Vali Loss: 2.019 Vali Acc: 0.570 Test Loss: 2.019 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2712857723236084
Epoch: 6, Steps: 18 | Train Loss: 0.586 Vali Loss: 3.896 Vali Acc: 0.490 Test Loss: 3.896 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7743570804595947
Epoch: 7, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.795 Vali Acc: 0.590 Test Loss: 2.795 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589972).  Saving model ...
Epoch: 8 cost time: 2.7386868000030518
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 3.586 Vali Acc: 0.520 Test Loss: 3.586 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8906569480895996
Epoch: 9, Steps: 18 | Train Loss: 0.527 Vali Loss: 2.393 Vali Acc: 0.480 Test Loss: 2.393 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.825133800506592
Epoch: 10, Steps: 18 | Train Loss: 1.200 Vali Loss: 4.296 Vali Acc: 0.500 Test Loss: 4.296 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7977423667907715
Epoch: 11, Steps: 18 | Train Loss: 0.695 Vali Loss: 4.393 Vali Acc: 0.490 Test Loss: 4.393 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.707862377166748
Epoch: 12, Steps: 18 | Train Loss: 0.877 Vali Loss: 4.531 Vali Acc: 0.520 Test Loss: 4.531 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7253777980804443
Epoch: 13, Steps: 18 | Train Loss: 1.073 Vali Loss: 6.523 Vali Acc: 0.580 Test Loss: 6.523 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7712292671203613
Epoch: 14, Steps: 18 | Train Loss: 0.368 Vali Loss: 7.162 Vali Acc: 0.540 Test Loss: 7.162 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.86513090133667
Epoch: 15, Steps: 18 | Train Loss: 0.437 Vali Loss: 9.136 Vali Acc: 0.490 Test Loss: 9.136 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9423558712005615
Epoch: 16, Steps: 18 | Train Loss: 0.286 Vali Loss: 8.872 Vali Acc: 0.480 Test Loss: 8.872 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9678537845611572
Epoch: 17, Steps: 18 | Train Loss: 0.428 Vali Loss: 6.765 Vali Acc: 0.530 Test Loss: 6.765 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1934710
model size : 7.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.433459520339966
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 1.219231128692627
Epoch: 2, Steps: 18 | Train Loss: 0.945 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.251962661743164
Epoch: 3, Steps: 18 | Train Loss: 0.839 Vali Loss: 1.653 Vali Acc: 0.500 Test Loss: 1.653 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2701952457427979
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 1.493 Vali Acc: 0.510 Test Loss: 1.493 Test Acc: 0.510
Validation loss decreased (-0.499989 --> -0.509985).  Saving model ...
Epoch: 5 cost time: 1.2680535316467285
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.766 Vali Acc: 0.500 Test Loss: 1.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2835314273834229
Epoch: 6, Steps: 18 | Train Loss: 0.678 Vali Loss: 2.458 Vali Acc: 0.480 Test Loss: 2.458 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.227895736694336
Epoch: 7, Steps: 18 | Train Loss: 1.278 Vali Loss: 1.816 Vali Acc: 0.540 Test Loss: 1.816 Test Acc: 0.540
Validation loss decreased (-0.509985 --> -0.539982).  Saving model ...
Epoch: 8 cost time: 1.3044044971466064
Epoch: 8, Steps: 18 | Train Loss: 0.352 Vali Loss: 3.730 Vali Acc: 0.510 Test Loss: 3.730 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1941850185394287
Epoch: 9, Steps: 18 | Train Loss: 0.294 Vali Loss: 5.474 Vali Acc: 0.500 Test Loss: 5.474 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2693910598754883
Epoch: 10, Steps: 18 | Train Loss: 1.464 Vali Loss: 5.848 Vali Acc: 0.540 Test Loss: 5.848 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.242504596710205
Epoch: 11, Steps: 18 | Train Loss: 0.410 Vali Loss: 4.823 Vali Acc: 0.530 Test Loss: 4.823 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.078317403793335
Epoch: 12, Steps: 18 | Train Loss: 0.701 Vali Loss: 4.004 Vali Acc: 0.480 Test Loss: 4.004 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.136136531829834
Epoch: 13, Steps: 18 | Train Loss: 1.011 Vali Loss: 10.791 Vali Acc: 0.470 Test Loss: 10.791 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.185530185699463
Epoch: 14, Steps: 18 | Train Loss: 1.089 Vali Loss: 3.456 Vali Acc: 0.570 Test Loss: 3.456 Test Acc: 0.570
Validation loss decreased (-0.539982 --> -0.569965).  Saving model ...
Epoch: 15 cost time: 1.1904027462005615
Epoch: 15, Steps: 18 | Train Loss: 0.396 Vali Loss: 4.021 Vali Acc: 0.490 Test Loss: 4.021 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1109893321990967
Epoch: 16, Steps: 18 | Train Loss: 0.679 Vali Loss: 5.322 Vali Acc: 0.500 Test Loss: 5.322 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0949680805206299
Epoch: 17, Steps: 18 | Train Loss: 0.482 Vali Loss: 4.710 Vali Acc: 0.470 Test Loss: 4.710 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0967447757720947
Epoch: 18, Steps: 18 | Train Loss: 0.375 Vali Loss: 9.774 Vali Acc: 0.500 Test Loss: 9.774 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0432958602905273
Epoch: 19, Steps: 18 | Train Loss: 0.236 Vali Loss: 5.657 Vali Acc: 0.560 Test Loss: 5.657 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0966572761535645
Epoch: 20, Steps: 18 | Train Loss: 1.156 Vali Loss: 7.216 Vali Acc: 0.530 Test Loss: 7.216 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1390838623046875
Epoch: 21, Steps: 18 | Train Loss: 0.307 Vali Loss: 10.467 Vali Acc: 0.530 Test Loss: 10.467 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0915875434875488
Epoch: 22, Steps: 18 | Train Loss: 0.321 Vali Loss: 7.753 Vali Acc: 0.500 Test Loss: 7.753 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.122434139251709
Epoch: 23, Steps: 18 | Train Loss: 0.679 Vali Loss: 9.105 Vali Acc: 0.520 Test Loss: 9.105 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.055391788482666
Epoch: 24, Steps: 18 | Train Loss: 0.252 Vali Loss: 6.694 Vali Acc: 0.520 Test Loss: 6.694 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1927286
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.30296230316162
Epoch: 1, Steps: 18 | Train Loss: 0.814 Vali Loss: 1.020 Vali Acc: 0.510 Test Loss: 1.020 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 20.666038751602173
Epoch: 2, Steps: 18 | Train Loss: 0.528 Vali Loss: 1.359 Vali Acc: 0.510 Test Loss: 1.359 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.565423488616943
Epoch: 3, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
Validation loss decreased (-0.509990 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 23.391917943954468
Epoch: 4, Steps: 18 | Train Loss: 0.298 Vali Loss: 2.649 Vali Acc: 0.480 Test Loss: 2.649 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.07834029197693
Epoch: 5, Steps: 18 | Train Loss: 0.227 Vali Loss: 5.075 Vali Acc: 0.490 Test Loss: 5.075 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.130913734436035
Epoch: 6, Steps: 18 | Train Loss: 0.304 Vali Loss: 2.725 Vali Acc: 0.500 Test Loss: 2.725 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.369147777557373
Epoch: 7, Steps: 18 | Train Loss: 0.473 Vali Loss: 4.231 Vali Acc: 0.540 Test Loss: 4.231 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.416748762130737
Epoch: 8, Steps: 18 | Train Loss: 0.367 Vali Loss: 3.264 Vali Acc: 0.510 Test Loss: 3.264 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.305129528045654
Epoch: 9, Steps: 18 | Train Loss: 0.185 Vali Loss: 5.479 Vali Acc: 0.560 Test Loss: 5.479 Test Acc: 0.560
Validation loss decreased (-0.549987 --> -0.559945).  Saving model ...
Epoch: 10 cost time: 21.937175989151
Epoch: 10, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.894 Vali Acc: 0.520 Test Loss: 4.894 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.765711307525635
Epoch: 11, Steps: 18 | Train Loss: 0.343 Vali Loss: 4.230 Vali Acc: 0.540 Test Loss: 4.230 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.798256874084473
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 5.284 Vali Acc: 0.530 Test Loss: 5.284 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.354980945587158
Epoch: 13, Steps: 18 | Train Loss: 0.121 Vali Loss: 7.143 Vali Acc: 0.480 Test Loss: 7.143 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 22.460846185684204
Epoch: 14, Steps: 18 | Train Loss: 0.226 Vali Loss: 7.379 Vali Acc: 0.520 Test Loss: 7.379 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.997654676437378
Epoch: 15, Steps: 18 | Train Loss: 0.731 Vali Loss: 5.425 Vali Acc: 0.530 Test Loss: 5.425 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.221028327941895
Epoch: 16, Steps: 18 | Train Loss: 0.267 Vali Loss: 9.789 Vali Acc: 0.550 Test Loss: 9.789 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 20.653942584991455
Epoch: 17, Steps: 18 | Train Loss: 0.150 Vali Loss: 7.508 Vali Acc: 0.510 Test Loss: 7.508 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.249891757965088
Epoch: 18, Steps: 18 | Train Loss: 0.236 Vali Loss: 8.749 Vali Acc: 0.520 Test Loss: 8.749 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 22.582589149475098
Epoch: 19, Steps: 18 | Train Loss: 0.156 Vali Loss: 10.483 Vali Acc: 0.500 Test Loss: 10.483 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w375_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2022386
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.909981727600098
Epoch: 1, Steps: 18 | Train Loss: 0.857 Vali Loss: 1.060 Vali Acc: 0.450 Test Loss: 1.060 Test Acc: 0.450
Validation loss decreased (inf --> -0.449989).  Saving model ...
Epoch: 2 cost time: 17.202690362930298
Epoch: 2, Steps: 18 | Train Loss: 0.576 Vali Loss: 1.640 Vali Acc: 0.490 Test Loss: 1.640 Test Acc: 0.490
Validation loss decreased (-0.449989 --> -0.489984).  Saving model ...
Epoch: 3 cost time: 17.635715007781982
Epoch: 3, Steps: 18 | Train Loss: 0.404 Vali Loss: 2.893 Vali Acc: 0.460 Test Loss: 2.893 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.286616325378418
Epoch: 4, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.896 Vali Acc: 0.460 Test Loss: 2.896 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.98384189605713
Epoch: 5, Steps: 18 | Train Loss: 0.174 Vali Loss: 2.283 Vali Acc: 0.510 Test Loss: 2.283 Test Acc: 0.510
Validation loss decreased (-0.489984 --> -0.509977).  Saving model ...
Epoch: 6 cost time: 17.10278296470642
Epoch: 6, Steps: 18 | Train Loss: 0.620 Vali Loss: 3.480 Vali Acc: 0.540 Test Loss: 3.480 Test Acc: 0.540
Validation loss decreased (-0.509977 --> -0.539965).  Saving model ...
Epoch: 7 cost time: 16.968090057373047
Epoch: 7, Steps: 18 | Train Loss: 0.264 Vali Loss: 4.545 Vali Acc: 0.470 Test Loss: 4.545 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.98833131790161
Epoch: 8, Steps: 18 | Train Loss: 0.513 Vali Loss: 8.337 Vali Acc: 0.510 Test Loss: 8.337 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.795880794525146
Epoch: 9, Steps: 18 | Train Loss: 0.779 Vali Loss: 8.719 Vali Acc: 0.470 Test Loss: 8.719 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.64496946334839
Epoch: 10, Steps: 18 | Train Loss: 0.443 Vali Loss: 3.948 Vali Acc: 0.550 Test Loss: 3.948 Test Acc: 0.550
Validation loss decreased (-0.539965 --> -0.549961).  Saving model ...
Epoch: 11 cost time: 17.417306900024414
Epoch: 11, Steps: 18 | Train Loss: 0.237 Vali Loss: 5.138 Vali Acc: 0.510 Test Loss: 5.138 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.97945547103882
Epoch: 12, Steps: 18 | Train Loss: 0.145 Vali Loss: 4.626 Vali Acc: 0.520 Test Loss: 4.626 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.4923415184021
Epoch: 13, Steps: 18 | Train Loss: 0.271 Vali Loss: 5.102 Vali Acc: 0.530 Test Loss: 5.102 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.337523937225342
Epoch: 14, Steps: 18 | Train Loss: 0.299 Vali Loss: 7.225 Vali Acc: 0.480 Test Loss: 7.225 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.624317169189453
Epoch: 15, Steps: 18 | Train Loss: 0.385 Vali Loss: 8.366 Vali Acc: 0.500 Test Loss: 8.366 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.974633693695068
Epoch: 16, Steps: 18 | Train Loss: 0.046 Vali Loss: 7.330 Vali Acc: 0.500 Test Loss: 7.330 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.116485357284546
Epoch: 17, Steps: 18 | Train Loss: 0.268 Vali Loss: 6.658 Vali Acc: 0.490 Test Loss: 6.658 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.629584550857544
Epoch: 18, Steps: 18 | Train Loss: 0.063 Vali Loss: 6.429 Vali Acc: 0.490 Test Loss: 6.429 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.415897607803345
Epoch: 19, Steps: 18 | Train Loss: 0.625 Vali Loss: 7.472 Vali Acc: 0.560 Test Loss: 7.472 Test Acc: 0.560
Validation loss decreased (-0.549961 --> -0.559925).  Saving model ...
Epoch: 20 cost time: 16.704806566238403
Epoch: 20, Steps: 18 | Train Loss: 0.570 Vali Loss: 12.999 Vali Acc: 0.480 Test Loss: 12.999 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.325810432434082
Epoch: 21, Steps: 18 | Train Loss: 1.190 Vali Loss: 6.898 Vali Acc: 0.490 Test Loss: 6.898 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.274993896484375
Epoch: 22, Steps: 18 | Train Loss: 0.248 Vali Loss: 7.980 Vali Acc: 0.530 Test Loss: 7.980 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 16.699634790420532
Epoch: 23, Steps: 18 | Train Loss: 0.353 Vali Loss: 9.977 Vali Acc: 0.520 Test Loss: 9.977 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 17.36501431465149
Epoch: 24, Steps: 18 | Train Loss: 0.659 Vali Loss: 8.831 Vali Acc: 0.540 Test Loss: 8.831 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 16.90882396697998
Epoch: 25, Steps: 18 | Train Loss: 0.277 Vali Loss: 7.047 Vali Acc: 0.560 Test Loss: 7.047 Test Acc: 0.560
Validation loss decreased (-0.559925 --> -0.559930).  Saving model ...
Epoch: 26 cost time: 16.120577096939087
Epoch: 26, Steps: 18 | Train Loss: 0.047 Vali Loss: 7.859 Vali Acc: 0.550 Test Loss: 7.859 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 17.912163972854614
Epoch: 27, Steps: 18 | Train Loss: 0.101 Vali Loss: 7.769 Vali Acc: 0.530 Test Loss: 7.769 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 17.117124557495117
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 11.435 Vali Acc: 0.500 Test Loss: 11.435 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 16.731189489364624
Epoch: 29, Steps: 18 | Train Loss: 0.132 Vali Loss: 10.691 Vali Acc: 0.510 Test Loss: 10.691 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 15.904370546340942
Epoch: 30, Steps: 18 | Train Loss: 0.059 Vali Loss: 8.513 Vali Acc: 0.520 Test Loss: 8.513 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 16.568459033966064
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 8.525 Vali Acc: 0.480 Test Loss: 8.525 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 15.987807035446167
Epoch: 32, Steps: 18 | Train Loss: 0.157 Vali Loss: 8.631 Vali Acc: 0.500 Test Loss: 8.631 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 16.016853094100952
Epoch: 33, Steps: 18 | Train Loss: 0.245 Vali Loss: 9.642 Vali Acc: 0.460 Test Loss: 9.642 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 17.685402154922485
Epoch: 34, Steps: 18 | Train Loss: 0.084 Vali Loss: 10.244 Vali Acc: 0.560 Test Loss: 10.244 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 17.14124059677124
Epoch: 35, Steps: 18 | Train Loss: 0.137 Vali Loss: 17.414 Vali Acc: 0.540 Test Loss: 17.414 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w300_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2003186
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.088268756866455
Epoch: 1, Steps: 18 | Train Loss: 0.836 Vali Loss: 0.797 Vali Acc: 0.470 Test Loss: 0.797 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 12.285408973693848
Epoch: 2, Steps: 18 | Train Loss: 0.570 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539988).  Saving model ...
Epoch: 3 cost time: 12.252758502960205
Epoch: 3, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.971 Vali Acc: 0.420 Test Loss: 1.971 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.164503812789917
Epoch: 4, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.531 Vali Acc: 0.530 Test Loss: 1.531 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.189953804016113
Epoch: 5, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.038 Vali Acc: 0.550 Test Loss: 2.038 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549980).  Saving model ...
Epoch: 6 cost time: 11.931341648101807
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 2.402 Vali Acc: 0.520 Test Loss: 2.402 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.311856269836426
Epoch: 7, Steps: 18 | Train Loss: 0.511 Vali Loss: 3.452 Vali Acc: 0.530 Test Loss: 3.452 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.01544976234436
Epoch: 8, Steps: 18 | Train Loss: 0.357 Vali Loss: 2.326 Vali Acc: 0.570 Test Loss: 2.326 Test Acc: 0.570
Validation loss decreased (-0.549980 --> -0.569977).  Saving model ...
Epoch: 9 cost time: 13.261377573013306
Epoch: 9, Steps: 18 | Train Loss: 0.115 Vali Loss: 4.403 Vali Acc: 0.490 Test Loss: 4.403 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.68906855583191
Epoch: 10, Steps: 18 | Train Loss: 0.267 Vali Loss: 4.028 Vali Acc: 0.540 Test Loss: 4.028 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.148399353027344
Epoch: 11, Steps: 18 | Train Loss: 0.474 Vali Loss: 8.726 Vali Acc: 0.510 Test Loss: 8.726 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.152720212936401
Epoch: 12, Steps: 18 | Train Loss: 0.231 Vali Loss: 6.941 Vali Acc: 0.520 Test Loss: 6.941 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.304965734481812
Epoch: 13, Steps: 18 | Train Loss: 0.498 Vali Loss: 6.618 Vali Acc: 0.490 Test Loss: 6.618 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.558488845825195
Epoch: 14, Steps: 18 | Train Loss: 0.460 Vali Loss: 8.291 Vali Acc: 0.460 Test Loss: 8.291 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.971300601959229
Epoch: 15, Steps: 18 | Train Loss: 0.117 Vali Loss: 5.288 Vali Acc: 0.510 Test Loss: 5.288 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.942203283309937
Epoch: 16, Steps: 18 | Train Loss: 0.035 Vali Loss: 8.009 Vali Acc: 0.540 Test Loss: 8.009 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.510465145111084
Epoch: 17, Steps: 18 | Train Loss: 0.531 Vali Loss: 9.028 Vali Acc: 0.560 Test Loss: 9.028 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.48231053352356
Epoch: 18, Steps: 18 | Train Loss: 0.070 Vali Loss: 5.246 Vali Acc: 0.560 Test Loss: 5.246 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w225_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1983986
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.814554452896118
Epoch: 1, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 7.814647436141968
Epoch: 2, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.620 Vali Acc: 0.460 Test Loss: 1.620 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.922950506210327
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 1.498 Vali Acc: 0.540 Test Loss: 1.498 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539985).  Saving model ...
Epoch: 4 cost time: 8.389564514160156
Epoch: 4, Steps: 18 | Train Loss: 0.370 Vali Loss: 2.289 Vali Acc: 0.530 Test Loss: 2.289 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.004837989807129
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 2.909 Vali Acc: 0.530 Test Loss: 2.909 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.784052848815918
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 2.362 Vali Acc: 0.580 Test Loss: 2.362 Test Acc: 0.580
Validation loss decreased (-0.539985 --> -0.579976).  Saving model ...
Epoch: 7 cost time: 8.320674419403076
Epoch: 7, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.794 Vali Acc: 0.580 Test Loss: 1.794 Test Acc: 0.580
Validation loss decreased (-0.579976 --> -0.579982).  Saving model ...
Epoch: 8 cost time: 8.371425867080688
Epoch: 8, Steps: 18 | Train Loss: 0.170 Vali Loss: 2.967 Vali Acc: 0.590 Test Loss: 2.967 Test Acc: 0.590
Validation loss decreased (-0.579982 --> -0.589970).  Saving model ...
Epoch: 9 cost time: 8.431942462921143
Epoch: 9, Steps: 18 | Train Loss: 0.221 Vali Loss: 3.761 Vali Acc: 0.560 Test Loss: 3.761 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.909383535385132
Epoch: 10, Steps: 18 | Train Loss: 0.295 Vali Loss: 4.552 Vali Acc: 0.550 Test Loss: 4.552 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.820687770843506
Epoch: 11, Steps: 18 | Train Loss: 0.686 Vali Loss: 5.321 Vali Acc: 0.520 Test Loss: 5.321 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.06861686706543
Epoch: 12, Steps: 18 | Train Loss: 0.460 Vali Loss: 5.790 Vali Acc: 0.500 Test Loss: 5.790 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.164057970046997
Epoch: 13, Steps: 18 | Train Loss: 0.378 Vali Loss: 6.061 Vali Acc: 0.500 Test Loss: 6.061 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.9493913650512695
Epoch: 14, Steps: 18 | Train Loss: 0.060 Vali Loss: 6.855 Vali Acc: 0.530 Test Loss: 6.855 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.763931035995483
Epoch: 15, Steps: 18 | Train Loss: 0.170 Vali Loss: 5.026 Vali Acc: 0.460 Test Loss: 5.026 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.221136569976807
Epoch: 16, Steps: 18 | Train Loss: 0.162 Vali Loss: 6.187 Vali Acc: 0.540 Test Loss: 6.187 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.423249959945679
Epoch: 17, Steps: 18 | Train Loss: 0.215 Vali Loss: 4.420 Vali Acc: 0.520 Test Loss: 4.420 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.344446182250977
Epoch: 18, Steps: 18 | Train Loss: 0.116 Vali Loss: 5.618 Vali Acc: 0.430 Test Loss: 5.618 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w150_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1964786
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.112208604812622
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 1.426 Vali Acc: 0.440 Test Loss: 1.426 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 4.990668773651123
Epoch: 2, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.848 Vali Acc: 0.490 Test Loss: 1.848 Test Acc: 0.490
Validation loss decreased (-0.439986 --> -0.489982).  Saving model ...
Epoch: 3 cost time: 5.195425033569336
Epoch: 3, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.800 Vali Acc: 0.500 Test Loss: 1.800 Test Acc: 0.500
Validation loss decreased (-0.489982 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 5.08474063873291
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 2.210 Vali Acc: 0.500 Test Loss: 2.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.8707780838012695
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 2.216 Vali Acc: 0.530 Test Loss: 2.216 Test Acc: 0.530
Validation loss decreased (-0.499982 --> -0.529978).  Saving model ...
Epoch: 6 cost time: 5.176604986190796
Epoch: 6, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.135 Vali Acc: 0.510 Test Loss: 2.135 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.16098165512085
Epoch: 7, Steps: 18 | Train Loss: 0.106 Vali Loss: 4.200 Vali Acc: 0.460 Test Loss: 4.200 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.387621164321899
Epoch: 8, Steps: 18 | Train Loss: 0.206 Vali Loss: 5.849 Vali Acc: 0.450 Test Loss: 5.849 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.392238140106201
Epoch: 9, Steps: 18 | Train Loss: 0.967 Vali Loss: 8.313 Vali Acc: 0.480 Test Loss: 8.313 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.021810293197632
Epoch: 10, Steps: 18 | Train Loss: 0.495 Vali Loss: 4.113 Vali Acc: 0.530 Test Loss: 4.113 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.140258312225342
Epoch: 11, Steps: 18 | Train Loss: 0.635 Vali Loss: 5.557 Vali Acc: 0.510 Test Loss: 5.557 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.094176769256592
Epoch: 12, Steps: 18 | Train Loss: 0.720 Vali Loss: 4.891 Vali Acc: 0.550 Test Loss: 4.891 Test Acc: 0.550
Validation loss decreased (-0.529978 --> -0.549951).  Saving model ...
Epoch: 13 cost time: 5.164337873458862
Epoch: 13, Steps: 18 | Train Loss: 0.053 Vali Loss: 4.687 Vali Acc: 0.530 Test Loss: 4.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.141301155090332
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 4.124 Vali Acc: 0.560 Test Loss: 4.124 Test Acc: 0.560
Validation loss decreased (-0.549951 --> -0.559959).  Saving model ...
Epoch: 15 cost time: 5.198510408401489
Epoch: 15, Steps: 18 | Train Loss: 0.107 Vali Loss: 4.829 Vali Acc: 0.560 Test Loss: 4.829 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.112062692642212
Epoch: 16, Steps: 18 | Train Loss: 0.217 Vali Loss: 6.212 Vali Acc: 0.580 Test Loss: 6.212 Test Acc: 0.580
Validation loss decreased (-0.559959 --> -0.579938).  Saving model ...
Epoch: 17 cost time: 5.3615031242370605
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 11.498 Vali Acc: 0.540 Test Loss: 11.498 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.086000442504883
Epoch: 18, Steps: 18 | Train Loss: 0.128 Vali Loss: 8.996 Vali Acc: 0.550 Test Loss: 8.996 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.166138648986816
Epoch: 19, Steps: 18 | Train Loss: 0.147 Vali Loss: 6.164 Vali Acc: 0.520 Test Loss: 6.164 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.146710157394409
Epoch: 20, Steps: 18 | Train Loss: 0.977 Vali Loss: 14.646 Vali Acc: 0.470 Test Loss: 14.646 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.371225357055664
Epoch: 21, Steps: 18 | Train Loss: 0.453 Vali Loss: 7.736 Vali Acc: 0.570 Test Loss: 7.736 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.568899393081665
Epoch: 22, Steps: 18 | Train Loss: 0.093 Vali Loss: 6.995 Vali Acc: 0.550 Test Loss: 6.995 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.512343883514404
Epoch: 23, Steps: 18 | Train Loss: 0.124 Vali Loss: 7.598 Vali Acc: 0.560 Test Loss: 7.598 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.440711498260498
Epoch: 24, Steps: 18 | Train Loss: 0.368 Vali Loss: 6.473 Vali Acc: 0.530 Test Loss: 6.473 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.305760860443115
Epoch: 25, Steps: 18 | Train Loss: 0.283 Vali Loss: 6.195 Vali Acc: 0.570 Test Loss: 6.195 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.173446416854858
Epoch: 26, Steps: 18 | Train Loss: 0.840 Vali Loss: 14.302 Vali Acc: 0.530 Test Loss: 14.302 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w90_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1949426
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.643944263458252
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 0.878 Vali Acc: 0.600 Test Loss: 0.878 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 3.7568626403808594
Epoch: 2, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.905 Vali Acc: 0.510 Test Loss: 1.905 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7529397010803223
Epoch: 3, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.482 Vali Acc: 0.530 Test Loss: 1.482 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.72914719581604
Epoch: 4, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.621 Vali Acc: 0.530 Test Loss: 1.621 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.704498291015625
Epoch: 5, Steps: 18 | Train Loss: 0.162 Vali Loss: 3.357 Vali Acc: 0.490 Test Loss: 3.357 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.863962411880493
Epoch: 6, Steps: 18 | Train Loss: 0.219 Vali Loss: 2.550 Vali Acc: 0.520 Test Loss: 2.550 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.942934274673462
Epoch: 7, Steps: 18 | Train Loss: 0.541 Vali Loss: 3.611 Vali Acc: 0.500 Test Loss: 3.611 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9454996585845947
Epoch: 8, Steps: 18 | Train Loss: 0.459 Vali Loss: 5.402 Vali Acc: 0.550 Test Loss: 5.402 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.50841212272644
Epoch: 9, Steps: 18 | Train Loss: 0.662 Vali Loss: 4.555 Vali Acc: 0.520 Test Loss: 4.555 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.373110294342041
Epoch: 10, Steps: 18 | Train Loss: 0.618 Vali Loss: 6.637 Vali Acc: 0.520 Test Loss: 6.637 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5465567111968994
Epoch: 11, Steps: 18 | Train Loss: 0.439 Vali Loss: 8.046 Vali Acc: 0.490 Test Loss: 8.046 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w60_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1941746
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3821167945861816
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 2.2513701915740967
Epoch: 2, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.152 Vali Acc: 0.520 Test Loss: 1.152 Test Acc: 0.520
Validation loss decreased (-0.489991 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 2.3721554279327393
Epoch: 3, Steps: 18 | Train Loss: 0.727 Vali Loss: 3.572 Vali Acc: 0.500 Test Loss: 3.572 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4505321979522705
Epoch: 4, Steps: 18 | Train Loss: 0.653 Vali Loss: 3.039 Vali Acc: 0.420 Test Loss: 3.039 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3947207927703857
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 2.108 Vali Acc: 0.570 Test Loss: 2.108 Test Acc: 0.570
Validation loss decreased (-0.519988 --> -0.569979).  Saving model ...
Epoch: 6 cost time: 2.2281055450439453
Epoch: 6, Steps: 18 | Train Loss: 0.300 Vali Loss: 2.405 Vali Acc: 0.590 Test Loss: 2.405 Test Acc: 0.590
Validation loss decreased (-0.569979 --> -0.589976).  Saving model ...
Epoch: 7 cost time: 2.61879563331604
Epoch: 7, Steps: 18 | Train Loss: 0.840 Vali Loss: 3.678 Vali Acc: 0.560 Test Loss: 3.678 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5373685359954834
Epoch: 8, Steps: 18 | Train Loss: 0.447 Vali Loss: 4.508 Vali Acc: 0.620 Test Loss: 4.508 Test Acc: 0.620
Validation loss decreased (-0.589976 --> -0.619955).  Saving model ...
Epoch: 9 cost time: 2.2804200649261475
Epoch: 9, Steps: 18 | Train Loss: 0.850 Vali Loss: 3.347 Vali Acc: 0.490 Test Loss: 3.347 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3008229732513428
Epoch: 10, Steps: 18 | Train Loss: 0.143 Vali Loss: 4.527 Vali Acc: 0.490 Test Loss: 4.527 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.191575765609741
Epoch: 11, Steps: 18 | Train Loss: 0.181 Vali Loss: 4.409 Vali Acc: 0.480 Test Loss: 4.409 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.254812717437744
Epoch: 12, Steps: 18 | Train Loss: 0.186 Vali Loss: 4.073 Vali Acc: 0.540 Test Loss: 4.073 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3122315406799316
Epoch: 13, Steps: 18 | Train Loss: 0.176 Vali Loss: 5.220 Vali Acc: 0.530 Test Loss: 5.220 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3415560722351074
Epoch: 14, Steps: 18 | Train Loss: 0.237 Vali Loss: 5.118 Vali Acc: 0.610 Test Loss: 5.118 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.276972770690918
Epoch: 15, Steps: 18 | Train Loss: 0.200 Vali Loss: 5.219 Vali Acc: 0.590 Test Loss: 5.219 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7826991081237793
Epoch: 16, Steps: 18 | Train Loss: 0.208 Vali Loss: 7.945 Vali Acc: 0.540 Test Loss: 7.945 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5020198822021484
Epoch: 17, Steps: 18 | Train Loss: 0.764 Vali Loss: 5.578 Vali Acc: 0.560 Test Loss: 5.578 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.372156858444214
Epoch: 18, Steps: 18 | Train Loss: 0.561 Vali Loss: 9.254 Vali Acc: 0.500 Test Loss: 9.254 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1934066
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.1033148765563965
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 1.120 Vali Acc: 0.460 Test Loss: 1.120 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 1.087533950805664
Epoch: 2, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.020 Vali Acc: 0.470 Test Loss: 1.020 Test Acc: 0.470
Validation loss decreased (-0.459989 --> -0.469990).  Saving model ...
Epoch: 3 cost time: 1.091078281402588
Epoch: 3, Steps: 18 | Train Loss: 0.498 Vali Loss: 2.082 Vali Acc: 0.470 Test Loss: 2.082 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0203921794891357
Epoch: 4, Steps: 18 | Train Loss: 0.639 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
Validation loss decreased (-0.469990 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.0387992858886719
Epoch: 5, Steps: 18 | Train Loss: 0.405 Vali Loss: 2.170 Vali Acc: 0.540 Test Loss: 2.170 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539978).  Saving model ...
Epoch: 6 cost time: 0.9894587993621826
Epoch: 6, Steps: 18 | Train Loss: 0.703 Vali Loss: 2.641 Vali Acc: 0.580 Test Loss: 2.641 Test Acc: 0.580
Validation loss decreased (-0.539978 --> -0.579974).  Saving model ...
Epoch: 7 cost time: 0.9196758270263672
Epoch: 7, Steps: 18 | Train Loss: 0.494 Vali Loss: 2.718 Vali Acc: 0.510 Test Loss: 2.718 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.999326229095459
Epoch: 8, Steps: 18 | Train Loss: 0.799 Vali Loss: 2.295 Vali Acc: 0.480 Test Loss: 2.295 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9906306266784668
Epoch: 9, Steps: 18 | Train Loss: 0.859 Vali Loss: 3.192 Vali Acc: 0.470 Test Loss: 3.192 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0761702060699463
Epoch: 10, Steps: 18 | Train Loss: 0.579 Vali Loss: 4.828 Vali Acc: 0.550 Test Loss: 4.828 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0725486278533936
Epoch: 11, Steps: 18 | Train Loss: 0.558 Vali Loss: 5.033 Vali Acc: 0.510 Test Loss: 5.033 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2332162857055664
Epoch: 12, Steps: 18 | Train Loss: 0.772 Vali Loss: 4.942 Vali Acc: 0.560 Test Loss: 4.942 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0699326992034912
Epoch: 13, Steps: 18 | Train Loss: 1.018 Vali Loss: 6.671 Vali Acc: 0.510 Test Loss: 6.671 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0774016380310059
Epoch: 14, Steps: 18 | Train Loss: 0.792 Vali Loss: 5.273 Vali Acc: 0.520 Test Loss: 5.273 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0880844593048096
Epoch: 15, Steps: 18 | Train Loss: 1.026 Vali Loss: 6.146 Vali Acc: 0.460 Test Loss: 6.146 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.972914457321167
Epoch: 16, Steps: 18 | Train Loss: 0.884 Vali Loss: 6.655 Vali Acc: 0.500 Test Loss: 6.655 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_MTSMixer_UEA_ftM_sl3000_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1926642
model size : 7.36MB
