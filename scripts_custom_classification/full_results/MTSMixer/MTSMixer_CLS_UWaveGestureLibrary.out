Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.261457920074463
Epoch: 1, Steps: 8 | Train Loss: 2.052 Vali Loss: 2.010 Vali Acc: 0.200 Test Loss: 2.010 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 2.3723878860473633
Epoch: 2, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.899 Vali Acc: 0.312 Test Loss: 1.899 Test Acc: 0.312
Validation loss decreased (-0.199980 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 2.912494659423828
Epoch: 3, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.758 Vali Acc: 0.434 Test Loss: 1.758 Test Acc: 0.434
Validation loss decreased (-0.312481 --> -0.434357).  Saving model ...
Epoch: 4 cost time: 2.348073959350586
Epoch: 4, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.619 Vali Acc: 0.600 Test Loss: 1.619 Test Acc: 0.600
Validation loss decreased (-0.434357 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 2.7841286659240723
Epoch: 5, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.496 Vali Acc: 0.697 Test Loss: 1.496 Test Acc: 0.697
Validation loss decreased (-0.599984 --> -0.696860).  Saving model ...
Epoch: 6 cost time: 2.266948699951172
Epoch: 6, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.387 Vali Acc: 0.716 Test Loss: 1.387 Test Acc: 0.716
Validation loss decreased (-0.696860 --> -0.715611).  Saving model ...
Epoch: 7 cost time: 2.170445680618286
Epoch: 7, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.285 Vali Acc: 0.738 Test Loss: 1.285 Test Acc: 0.738
Validation loss decreased (-0.715611 --> -0.737487).  Saving model ...
Epoch: 8 cost time: 2.1310088634490967
Epoch: 8, Steps: 8 | Train Loss: 0.927 Vali Loss: 1.192 Vali Acc: 0.744 Test Loss: 1.192 Test Acc: 0.744
Validation loss decreased (-0.737487 --> -0.743738).  Saving model ...
Epoch: 9 cost time: 2.1741981506347656
Epoch: 9, Steps: 8 | Train Loss: 0.820 Vali Loss: 1.114 Vali Acc: 0.766 Test Loss: 1.114 Test Acc: 0.766
Validation loss decreased (-0.743738 --> -0.765614).  Saving model ...
Epoch: 10 cost time: 2.3104867935180664
Epoch: 10, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.045 Vali Acc: 0.772 Test Loss: 1.045 Test Acc: 0.772
Validation loss decreased (-0.765614 --> -0.771865).  Saving model ...
Epoch: 11 cost time: 2.3938751220703125
Epoch: 11, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.985 Vali Acc: 0.791 Test Loss: 0.985 Test Acc: 0.791
Validation loss decreased (-0.771865 --> -0.790615).  Saving model ...
Epoch: 12 cost time: 2.307338237762451
Epoch: 12, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.936 Vali Acc: 0.803 Test Loss: 0.936 Test Acc: 0.803
Validation loss decreased (-0.790615 --> -0.803116).  Saving model ...
Epoch: 13 cost time: 2.130903959274292
Epoch: 13, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.899 Vali Acc: 0.800 Test Loss: 0.899 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.534510850906372
Epoch: 14, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.863 Vali Acc: 0.806 Test Loss: 0.863 Test Acc: 0.806
Validation loss decreased (-0.803116 --> -0.806241).  Saving model ...
Epoch: 15 cost time: 2.2919209003448486
Epoch: 15, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.838 Vali Acc: 0.806 Test Loss: 0.838 Test Acc: 0.806
Validation loss decreased (-0.806241 --> -0.806242).  Saving model ...
Epoch: 16 cost time: 2.2361035346984863
Epoch: 16, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.812 Vali Acc: 0.812 Test Loss: 0.812 Test Acc: 0.812
Validation loss decreased (-0.806242 --> -0.812492).  Saving model ...
Epoch: 17 cost time: 2.2887752056121826
Epoch: 17, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.796 Vali Acc: 0.816 Test Loss: 0.796 Test Acc: 0.816
Validation loss decreased (-0.812492 --> -0.815617).  Saving model ...
Epoch: 18 cost time: 1.951357364654541
Epoch: 18, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.779 Vali Acc: 0.822 Test Loss: 0.779 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821867).  Saving model ...
Epoch: 19 cost time: 1.9253714084625244
Epoch: 19, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.821867 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 2.1723735332489014
Epoch: 20, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1577646732330322
Epoch: 21, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.730 Vali Acc: 0.822 Test Loss: 0.730 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2398009300231934
Epoch: 22, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.720 Vali Acc: 0.819 Test Loss: 0.720 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.706955671310425
Epoch: 23, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.711 Vali Acc: 0.816 Test Loss: 0.711 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4714748859405518
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.700 Vali Acc: 0.812 Test Loss: 0.700 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.322434425354004
Epoch: 25, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.692 Vali Acc: 0.819 Test Loss: 0.692 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5017218589782715
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.685 Vali Acc: 0.812 Test Loss: 0.685 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1061604022979736
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.686 Vali Acc: 0.812 Test Loss: 0.686 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2760567665100098
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.683 Vali Acc: 0.812 Test Loss: 0.683 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.259625196456909
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.680 Vali Acc: 0.812 Test Loss: 0.680 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 1380410
model size : 5.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7437312602996826
Epoch: 1, Steps: 8 | Train Loss: 2.102 Vali Loss: 2.077 Vali Acc: 0.225 Test Loss: 2.077 Test Acc: 0.225
Validation loss decreased (inf --> -0.224979).  Saving model ...
Epoch: 2 cost time: 2.33323335647583
Epoch: 2, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.943 Vali Acc: 0.297 Test Loss: 1.943 Test Acc: 0.297
Validation loss decreased (-0.224979 --> -0.296856).  Saving model ...
Epoch: 3 cost time: 2.4963326454162598
Epoch: 3, Steps: 8 | Train Loss: 1.719 Vali Loss: 1.776 Vali Acc: 0.425 Test Loss: 1.776 Test Acc: 0.425
Validation loss decreased (-0.296856 --> -0.424982).  Saving model ...
Epoch: 4 cost time: 2.0271925926208496
Epoch: 4, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.602 Vali Acc: 0.547 Test Loss: 1.602 Test Acc: 0.547
Validation loss decreased (-0.424982 --> -0.546859).  Saving model ...
Epoch: 5 cost time: 2.2240941524505615
Epoch: 5, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.451 Vali Acc: 0.616 Test Loss: 1.451 Test Acc: 0.616
Validation loss decreased (-0.546859 --> -0.615610).  Saving model ...
Epoch: 6 cost time: 2.222193717956543
Epoch: 6, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.322 Vali Acc: 0.653 Test Loss: 1.322 Test Acc: 0.653
Validation loss decreased (-0.615610 --> -0.653112).  Saving model ...
Epoch: 7 cost time: 2.044546127319336
Epoch: 7, Steps: 8 | Train Loss: 0.967 Vali Loss: 1.215 Vali Acc: 0.675 Test Loss: 1.215 Test Acc: 0.675
Validation loss decreased (-0.653112 --> -0.674988).  Saving model ...
Epoch: 8 cost time: 1.8460965156555176
Epoch: 8, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.131 Vali Acc: 0.713 Test Loss: 1.131 Test Acc: 0.713
Validation loss decreased (-0.674988 --> -0.712489).  Saving model ...
Epoch: 9 cost time: 2.4937233924865723
Epoch: 9, Steps: 8 | Train Loss: 0.724 Vali Loss: 1.064 Vali Acc: 0.713 Test Loss: 1.064 Test Acc: 0.713
Validation loss decreased (-0.712489 --> -0.712489).  Saving model ...
Epoch: 10 cost time: 1.7556583881378174
Epoch: 10, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.010 Vali Acc: 0.725 Test Loss: 1.010 Test Acc: 0.725
Validation loss decreased (-0.712489 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 2.224961519241333
Epoch: 11, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.955 Vali Acc: 0.728 Test Loss: 0.955 Test Acc: 0.728
Validation loss decreased (-0.724990 --> -0.728115).  Saving model ...
Epoch: 12 cost time: 2.2804691791534424
Epoch: 12, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.914 Vali Acc: 0.741 Test Loss: 0.914 Test Acc: 0.741
Validation loss decreased (-0.728115 --> -0.740616).  Saving model ...
Epoch: 13 cost time: 2.3888416290283203
Epoch: 13, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.877 Vali Acc: 0.738 Test Loss: 0.877 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.043912887573242
Epoch: 14, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.845 Vali Acc: 0.744 Test Loss: 0.845 Test Acc: 0.744
Validation loss decreased (-0.740616 --> -0.743742).  Saving model ...
Epoch: 15 cost time: 2.1864206790924072
Epoch: 15, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.821 Vali Acc: 0.753 Test Loss: 0.821 Test Acc: 0.753
Validation loss decreased (-0.743742 --> -0.753117).  Saving model ...
Epoch: 16 cost time: 1.8907222747802734
Epoch: 16, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.802 Vali Acc: 0.753 Test Loss: 0.802 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 17 cost time: 1.9765799045562744
Epoch: 17, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.786 Vali Acc: 0.753 Test Loss: 0.786 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 18 cost time: 2.2763452529907227
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.773 Vali Acc: 0.762 Test Loss: 0.773 Test Acc: 0.762
Validation loss decreased (-0.753117 --> -0.762492).  Saving model ...
Epoch: 19 cost time: 2.390968084335327
Epoch: 19, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.766 Vali Acc: 0.747 Test Loss: 0.766 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.235137939453125
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
Validation loss decreased (-0.762492 --> -0.771868).  Saving model ...
Epoch: 21 cost time: 2.1315600872039795
Epoch: 21, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.737 Vali Acc: 0.769 Test Loss: 0.737 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3382627964019775
Epoch: 22, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.730 Vali Acc: 0.772 Test Loss: 0.730 Test Acc: 0.772
Validation loss decreased (-0.771868 --> -0.771868).  Saving model ...
Epoch: 23 cost time: 2.6547999382019043
Epoch: 23, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.723 Vali Acc: 0.766 Test Loss: 0.723 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.470827579498291
Epoch: 24, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4204483032226562
Epoch: 25, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.719 Vali Acc: 0.766 Test Loss: 0.719 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.082087278366089
Epoch: 26, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.715 Vali Acc: 0.762 Test Loss: 0.715 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.318402051925659
Epoch: 27, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.709 Vali Acc: 0.769 Test Loss: 0.709 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1840925216674805
Epoch: 28, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
Validation loss decreased (-0.771868 --> -0.774993).  Saving model ...
Epoch: 29 cost time: 2.208496570587158
Epoch: 29, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.700 Vali Acc: 0.784 Test Loss: 0.700 Test Acc: 0.784
Validation loss decreased (-0.774993 --> -0.784368).  Saving model ...
Epoch: 30 cost time: 2.255570888519287
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.696 Vali Acc: 0.778 Test Loss: 0.696 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2212510108947754
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.686 Vali Acc: 0.791 Test Loss: 0.686 Test Acc: 0.791
Validation loss decreased (-0.784368 --> -0.790618).  Saving model ...
Epoch: 32 cost time: 2.0856144428253174
Epoch: 32, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.683 Vali Acc: 0.787 Test Loss: 0.683 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2285165786743164
Epoch: 33, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.790618 --> -0.799993).  Saving model ...
Epoch: 34 cost time: 1.7530243396759033
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.678 Vali Acc: 0.797 Test Loss: 0.678 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2439560890197754
Epoch: 35, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7814500331878662
Epoch: 36, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.675 Vali Acc: 0.787 Test Loss: 0.675 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6644155979156494
Epoch: 37, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.668 Vali Acc: 0.800 Test Loss: 0.668 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 1.961348056793213
Epoch: 38, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 39 cost time: 1.6313879489898682
Epoch: 39, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.797 Test Loss: 0.665 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5348665714263916
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7409396171569824
Epoch: 41, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806243).  Saving model ...
Epoch: 42 cost time: 2.0208053588867188
Epoch: 42, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 43 cost time: 2.0439951419830322
Epoch: 43, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0735371112823486
Epoch: 44, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.129330635070801
Epoch: 45, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.187138319015503
Epoch: 46, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.0179669857025146
Epoch: 47, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.6354639530181885
Epoch: 48, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.538926601409912
Epoch: 49, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.0853240489959717
Epoch: 50, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 51 cost time: 2.1572141647338867
Epoch: 51, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.7138285636901855
Epoch: 52, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.084021806716919
Epoch: 53, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.661 Vali Acc: 0.797 Test Loss: 0.661 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.2236733436584473
Epoch: 54, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.4812510013580322
Epoch: 55, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.8946020603179932
Epoch: 56, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.9996285438537598
Epoch: 57, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.8760643005371094
Epoch: 58, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.6656303405761719
Epoch: 59, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.954714059829712
Epoch: 60, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.80625
model parameter : 1364026
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.452918529510498
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.073 Vali Acc: 0.109 Test Loss: 2.073 Test Acc: 0.109
Validation loss decreased (inf --> -0.109354).  Saving model ...
Epoch: 2 cost time: 1.5877203941345215
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.928 Vali Acc: 0.209 Test Loss: 1.928 Test Acc: 0.209
Validation loss decreased (-0.109354 --> -0.209356).  Saving model ...
Epoch: 3 cost time: 1.281024694442749
Epoch: 3, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.755 Vali Acc: 0.456 Test Loss: 1.755 Test Acc: 0.456
Validation loss decreased (-0.209356 --> -0.456232).  Saving model ...
Epoch: 4 cost time: 1.5243525505065918
Epoch: 4, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.581 Vali Acc: 0.613 Test Loss: 1.581 Test Acc: 0.613
Validation loss decreased (-0.456232 --> -0.612484).  Saving model ...
Epoch: 5 cost time: 1.5722603797912598
Epoch: 5, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.427 Vali Acc: 0.688 Test Loss: 1.427 Test Acc: 0.688
Validation loss decreased (-0.612484 --> -0.687486).  Saving model ...
Epoch: 6 cost time: 1.3573834896087646
Epoch: 6, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.296 Vali Acc: 0.700 Test Loss: 1.296 Test Acc: 0.700
Validation loss decreased (-0.687486 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 1.3630263805389404
Epoch: 7, Steps: 8 | Train Loss: 0.933 Vali Loss: 1.188 Vali Acc: 0.716 Test Loss: 1.188 Test Acc: 0.716
Validation loss decreased (-0.699987 --> -0.715613).  Saving model ...
Epoch: 8 cost time: 1.6664390563964844
Epoch: 8, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.098 Vali Acc: 0.738 Test Loss: 1.098 Test Acc: 0.738
Validation loss decreased (-0.715613 --> -0.737489).  Saving model ...
Epoch: 9 cost time: 1.3190019130706787
Epoch: 9, Steps: 8 | Train Loss: 0.675 Vali Loss: 1.021 Vali Acc: 0.753 Test Loss: 1.021 Test Acc: 0.753
Validation loss decreased (-0.737489 --> -0.753115).  Saving model ...
Epoch: 10 cost time: 1.5660581588745117
Epoch: 10, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.951 Vali Acc: 0.766 Test Loss: 0.951 Test Acc: 0.766
Validation loss decreased (-0.753115 --> -0.765615).  Saving model ...
Epoch: 11 cost time: 1.438117265701294
Epoch: 11, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
Validation loss decreased (-0.765615 --> -0.771866).  Saving model ...
Epoch: 12 cost time: 1.5888681411743164
Epoch: 12, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.854 Vali Acc: 0.781 Test Loss: 0.854 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781241).  Saving model ...
Epoch: 13 cost time: 1.3789453506469727
Epoch: 13, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.825 Vali Acc: 0.787 Test Loss: 0.825 Test Acc: 0.787
Validation loss decreased (-0.781241 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 1.6712307929992676
Epoch: 14, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.796 Vali Acc: 0.787 Test Loss: 0.796 Test Acc: 0.787
Validation loss decreased (-0.787492 --> -0.787492).  Saving model ...
Epoch: 15 cost time: 1.3747942447662354
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
Validation loss decreased (-0.787492 --> -0.796867).  Saving model ...
Epoch: 16 cost time: 1.5848026275634766
Epoch: 16, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.751 Vali Acc: 0.809 Test Loss: 0.751 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809367).  Saving model ...
Epoch: 17 cost time: 1.3297243118286133
Epoch: 17, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.734 Vali Acc: 0.812 Test Loss: 0.734 Test Acc: 0.812
Validation loss decreased (-0.809367 --> -0.812493).  Saving model ...
Epoch: 18 cost time: 1.5117933750152588
Epoch: 18, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5151240825653076
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.714 Vali Acc: 0.806 Test Loss: 0.714 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.431272268295288
Epoch: 20, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.520334243774414
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4878008365631104
Epoch: 22, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.691 Vali Acc: 0.797 Test Loss: 0.691 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4374809265136719
Epoch: 23, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.684 Vali Acc: 0.812 Test Loss: 0.684 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 24 cost time: 1.3871605396270752
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.676 Vali Acc: 0.812 Test Loss: 0.676 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 25 cost time: 1.4646835327148438
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815618).  Saving model ...
Epoch: 26 cost time: 1.5089192390441895
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 27 cost time: 1.4454026222229004
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821868).  Saving model ...
Epoch: 28 cost time: 1.4503471851348877
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.495149850845337
Epoch: 29, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6539337635040283
Epoch: 30, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5758368968963623
Epoch: 31, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6358859539031982
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.64546799659729
Epoch: 33, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.020202159881592
Epoch: 34, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.651991844177246
Epoch: 35, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.641 Vali Acc: 0.816 Test Loss: 0.641 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7949697971343994
Epoch: 36, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6893081665039062
Epoch: 37, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.640 Vali Acc: 0.816 Test Loss: 0.640 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 1347642
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.920912265777588
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.069 Vali Acc: 0.141 Test Loss: 2.069 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.7680935859680176
Epoch: 2, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.951 Vali Acc: 0.225 Test Loss: 1.951 Test Acc: 0.225
Validation loss decreased (-0.140604 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 1.4825224876403809
Epoch: 3, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.791 Vali Acc: 0.463 Test Loss: 1.791 Test Acc: 0.463
Validation loss decreased (-0.224980 --> -0.462482).  Saving model ...
Epoch: 4 cost time: 1.2142665386199951
Epoch: 4, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.638 Vali Acc: 0.594 Test Loss: 1.638 Test Acc: 0.594
Validation loss decreased (-0.462482 --> -0.593734).  Saving model ...
Epoch: 5 cost time: 1.470625638961792
Epoch: 5, Steps: 8 | Train Loss: 1.283 Vali Loss: 1.500 Vali Acc: 0.666 Test Loss: 1.500 Test Acc: 0.666
Validation loss decreased (-0.593734 --> -0.665610).  Saving model ...
Epoch: 6 cost time: 1.3728737831115723
Epoch: 6, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.380 Vali Acc: 0.697 Test Loss: 1.380 Test Acc: 0.697
Validation loss decreased (-0.665610 --> -0.696861).  Saving model ...
Epoch: 7 cost time: 1.246166706085205
Epoch: 7, Steps: 8 | Train Loss: 0.927 Vali Loss: 1.273 Vali Acc: 0.728 Test Loss: 1.273 Test Acc: 0.728
Validation loss decreased (-0.696861 --> -0.728112).  Saving model ...
Epoch: 8 cost time: 1.6349425315856934
Epoch: 8, Steps: 8 | Train Loss: 0.779 Vali Loss: 1.181 Vali Acc: 0.744 Test Loss: 1.181 Test Acc: 0.744
Validation loss decreased (-0.728112 --> -0.743738).  Saving model ...
Epoch: 9 cost time: 1.5988733768463135
Epoch: 9, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.101 Vali Acc: 0.762 Test Loss: 1.101 Test Acc: 0.762
Validation loss decreased (-0.743738 --> -0.762489).  Saving model ...
Epoch: 10 cost time: 1.0559003353118896
Epoch: 10, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.037 Vali Acc: 0.769 Test Loss: 1.037 Test Acc: 0.769
Validation loss decreased (-0.762489 --> -0.768740).  Saving model ...
Epoch: 11 cost time: 1.7370662689208984
Epoch: 11, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.984 Vali Acc: 0.766 Test Loss: 0.984 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5967512130737305
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.936 Vali Acc: 0.772 Test Loss: 0.936 Test Acc: 0.772
Validation loss decreased (-0.768740 --> -0.771866).  Saving model ...
Epoch: 13 cost time: 1.4156060218811035
Epoch: 13, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.901 Vali Acc: 0.781 Test Loss: 0.901 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781241).  Saving model ...
Epoch: 14 cost time: 1.4428117275238037
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.869 Vali Acc: 0.794 Test Loss: 0.869 Test Acc: 0.794
Validation loss decreased (-0.781241 --> -0.793741).  Saving model ...
Epoch: 15 cost time: 1.5168542861938477
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.860363483428955
Epoch: 16, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.821 Vali Acc: 0.784 Test Loss: 0.821 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4495775699615479
Epoch: 17, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8495256900787354
Epoch: 18, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.781 Vali Acc: 0.791 Test Loss: 0.781 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4278616905212402
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.767 Vali Acc: 0.787 Test Loss: 0.767 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4794344902038574
Epoch: 20, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.760 Vali Acc: 0.778 Test Loss: 0.760 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5043554306030273
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.753 Vali Acc: 0.781 Test Loss: 0.753 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6172854900360107
Epoch: 22, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.738 Vali Acc: 0.781 Test Loss: 0.738 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4665908813476562
Epoch: 23, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.732 Vali Acc: 0.781 Test Loss: 0.732 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5137152671813965
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.723 Vali Acc: 0.791 Test Loss: 0.723 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.79375
model parameter : 1331258
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7973804473876953
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.024 Vali Acc: 0.209 Test Loss: 2.024 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 1.0663492679595947
Epoch: 2, Steps: 8 | Train Loss: 1.984 Vali Loss: 1.899 Vali Acc: 0.300 Test Loss: 1.899 Test Acc: 0.300
Validation loss decreased (-0.209355 --> -0.299981).  Saving model ...
Epoch: 3 cost time: 0.9746835231781006
Epoch: 3, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.741 Vali Acc: 0.528 Test Loss: 1.741 Test Acc: 0.528
Validation loss decreased (-0.299981 --> -0.528108).  Saving model ...
Epoch: 4 cost time: 1.1035892963409424
Epoch: 4, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.579 Vali Acc: 0.641 Test Loss: 1.579 Test Acc: 0.641
Validation loss decreased (-0.528108 --> -0.640609).  Saving model ...
Epoch: 5 cost time: 1.073911428451538
Epoch: 5, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.423 Vali Acc: 0.691 Test Loss: 1.423 Test Acc: 0.691
Validation loss decreased (-0.640609 --> -0.690611).  Saving model ...
Epoch: 6 cost time: 1.191676378250122
Epoch: 6, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.288 Vali Acc: 0.716 Test Loss: 1.288 Test Acc: 0.716
Validation loss decreased (-0.690611 --> -0.715612).  Saving model ...
Epoch: 7 cost time: 0.9924492835998535
Epoch: 7, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.180 Vali Acc: 0.728 Test Loss: 1.180 Test Acc: 0.728
Validation loss decreased (-0.715612 --> -0.728113).  Saving model ...
Epoch: 8 cost time: 1.0904970169067383
Epoch: 8, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.089 Vali Acc: 0.744 Test Loss: 1.089 Test Acc: 0.744
Validation loss decreased (-0.728113 --> -0.743739).  Saving model ...
Epoch: 9 cost time: 1.0243244171142578
Epoch: 9, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.012 Vali Acc: 0.747 Test Loss: 1.012 Test Acc: 0.747
Validation loss decreased (-0.743739 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 0.9584157466888428
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.949 Vali Acc: 0.759 Test Loss: 0.949 Test Acc: 0.759
Validation loss decreased (-0.746865 --> -0.759366).  Saving model ...
Epoch: 11 cost time: 0.9904754161834717
Epoch: 11, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
Validation loss decreased (-0.759366 --> -0.771866).  Saving model ...
Epoch: 12 cost time: 1.1726489067077637
Epoch: 12, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
Validation loss decreased (-0.771866 --> -0.793741).  Saving model ...
Epoch: 13 cost time: 1.208724021911621
Epoch: 13, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.831 Vali Acc: 0.797 Test Loss: 0.831 Test Acc: 0.797
Validation loss decreased (-0.793741 --> -0.796867).  Saving model ...
Epoch: 14 cost time: 0.9851024150848389
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.803 Vali Acc: 0.787 Test Loss: 0.803 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.01304030418396
Epoch: 15, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.783 Vali Acc: 0.787 Test Loss: 0.783 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9278297424316406
Epoch: 16, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.765 Vali Acc: 0.794 Test Loss: 0.765 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0419237613677979
Epoch: 17, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.751 Vali Acc: 0.787 Test Loss: 0.751 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9783992767333984
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.739 Vali Acc: 0.791 Test Loss: 0.739 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9084391593933105
Epoch: 19, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.729 Vali Acc: 0.794 Test Loss: 0.729 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.097325325012207
Epoch: 20, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1874518394470215
Epoch: 21, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.710 Vali Acc: 0.791 Test Loss: 0.710 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.016545295715332
Epoch: 22, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.704 Vali Acc: 0.791 Test Loss: 0.704 Test Acc: 0.791
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1614909172058105
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 1318970
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9469010829925537
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 2.070 Vali Acc: 0.194 Test Loss: 2.070 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.9461612701416016
Epoch: 2, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.970 Vali Acc: 0.247 Test Loss: 1.970 Test Acc: 0.247
Validation loss decreased (-0.193729 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 0.9240217208862305
Epoch: 3, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.838 Vali Acc: 0.334 Test Loss: 1.838 Test Acc: 0.334
Validation loss decreased (-0.246855 --> -0.334357).  Saving model ...
Epoch: 4 cost time: 0.8307671546936035
Epoch: 4, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.703 Vali Acc: 0.475 Test Loss: 1.703 Test Acc: 0.475
Validation loss decreased (-0.334357 --> -0.474983).  Saving model ...
Epoch: 5 cost time: 0.9110016822814941
Epoch: 5, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.578 Vali Acc: 0.597 Test Loss: 1.578 Test Acc: 0.597
Validation loss decreased (-0.474983 --> -0.596859).  Saving model ...
Epoch: 6 cost time: 0.9777157306671143
Epoch: 6, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.461 Vali Acc: 0.619 Test Loss: 1.461 Test Acc: 0.619
Validation loss decreased (-0.596859 --> -0.618735).  Saving model ...
Epoch: 7 cost time: 0.900054931640625
Epoch: 7, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.351 Vali Acc: 0.637 Test Loss: 1.351 Test Acc: 0.637
Validation loss decreased (-0.618735 --> -0.637486).  Saving model ...
Epoch: 8 cost time: 1.0848445892333984
Epoch: 8, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.251 Vali Acc: 0.678 Test Loss: 1.251 Test Acc: 0.678
Validation loss decreased (-0.637486 --> -0.678112).  Saving model ...
Epoch: 9 cost time: 0.8964018821716309
Epoch: 9, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.174 Vali Acc: 0.700 Test Loss: 1.174 Test Acc: 0.700
Validation loss decreased (-0.678112 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.8930730819702148
Epoch: 10, Steps: 8 | Train Loss: 0.842 Vali Loss: 1.098 Vali Acc: 0.709 Test Loss: 1.098 Test Acc: 0.709
Validation loss decreased (-0.699988 --> -0.709364).  Saving model ...
Epoch: 11 cost time: 1.007974624633789
Epoch: 11, Steps: 8 | Train Loss: 0.753 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3283166885375977
Epoch: 12, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.991 Vali Acc: 0.716 Test Loss: 0.991 Test Acc: 0.716
Validation loss decreased (-0.709364 --> -0.715615).  Saving model ...
Epoch: 13 cost time: 0.85982346534729
Epoch: 13, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.942 Vali Acc: 0.738 Test Loss: 0.942 Test Acc: 0.738
Validation loss decreased (-0.715615 --> -0.737491).  Saving model ...
Epoch: 14 cost time: 0.8371784687042236
Epoch: 14, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.899 Vali Acc: 0.747 Test Loss: 0.899 Test Acc: 0.747
Validation loss decreased (-0.737491 --> -0.746866).  Saving model ...
Epoch: 15 cost time: 1.3314290046691895
Epoch: 15, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
Validation loss decreased (-0.746866 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.0776755809783936
Epoch: 16, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756242).  Saving model ...
Epoch: 17 cost time: 0.9402139186859131
Epoch: 17, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 18 cost time: 1.1272056102752686
Epoch: 18, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0083000659942627
Epoch: 19, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.770 Vali Acc: 0.753 Test Loss: 0.770 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2483668327331543
Epoch: 20, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1862528324127197
Epoch: 21, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.747 Vali Acc: 0.762 Test Loss: 0.747 Test Acc: 0.762
Validation loss decreased (-0.756242 --> -0.762493).  Saving model ...
Epoch: 22 cost time: 1.03025221824646
Epoch: 22, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
Validation loss decreased (-0.762493 --> -0.778118).  Saving model ...
Epoch: 23 cost time: 1.2300348281860352
Epoch: 23, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.719 Vali Acc: 0.778 Test Loss: 0.719 Test Acc: 0.778
Validation loss decreased (-0.778118 --> -0.778118).  Saving model ...
Epoch: 24 cost time: 0.9268858432769775
Epoch: 24, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3065121173858643
Epoch: 25, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.708 Vali Acc: 0.781 Test Loss: 0.708 Test Acc: 0.781
Validation loss decreased (-0.778118 --> -0.781243).  Saving model ...
Epoch: 26 cost time: 0.9442405700683594
Epoch: 26, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.701 Vali Acc: 0.778 Test Loss: 0.701 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9912528991699219
Epoch: 27, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.686 Vali Acc: 0.778 Test Loss: 0.686 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9027621746063232
Epoch: 28, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.686 Vali Acc: 0.778 Test Loss: 0.686 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0437281131744385
Epoch: 29, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0527756214141846
Epoch: 30, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9760909080505371
Epoch: 31, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.152186393737793
Epoch: 32, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.692 Vali Acc: 0.772 Test Loss: 0.692 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0696544647216797
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.686 Vali Acc: 0.778 Test Loss: 0.686 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2602653503417969
Epoch: 34, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0599608421325684
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.689 Vali Acc: 0.778 Test Loss: 0.689 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.78125
model parameter : 1312826
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4974420070648193
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.039 Vali Acc: 0.178 Test Loss: 2.039 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.7932212352752686
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.889 Vali Acc: 0.281 Test Loss: 1.889 Test Acc: 0.281
Validation loss decreased (-0.178105 --> -0.281231).  Saving model ...
Epoch: 3 cost time: 0.7827420234680176
Epoch: 3, Steps: 8 | Train Loss: 1.779 Vali Loss: 1.702 Vali Acc: 0.487 Test Loss: 1.702 Test Acc: 0.487
Validation loss decreased (-0.281231 --> -0.487483).  Saving model ...
Epoch: 4 cost time: 0.8343431949615479
Epoch: 4, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.520 Vali Acc: 0.613 Test Loss: 1.520 Test Acc: 0.613
Validation loss decreased (-0.487483 --> -0.612485).  Saving model ...
Epoch: 5 cost time: 0.890446662902832
Epoch: 5, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.355 Vali Acc: 0.688 Test Loss: 1.355 Test Acc: 0.688
Validation loss decreased (-0.612485 --> -0.687486).  Saving model ...
Epoch: 6 cost time: 0.8623285293579102
Epoch: 6, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.224 Vali Acc: 0.694 Test Loss: 1.224 Test Acc: 0.694
Validation loss decreased (-0.687486 --> -0.693738).  Saving model ...
Epoch: 7 cost time: 0.8373010158538818
Epoch: 7, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.116 Vali Acc: 0.703 Test Loss: 1.116 Test Acc: 0.703
Validation loss decreased (-0.693738 --> -0.703114).  Saving model ...
Epoch: 8 cost time: 0.8424348831176758
Epoch: 8, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.031 Vali Acc: 0.719 Test Loss: 1.031 Test Acc: 0.719
Validation loss decreased (-0.703114 --> -0.718740).  Saving model ...
Epoch: 9 cost time: 0.8446187973022461
Epoch: 9, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.963 Vali Acc: 0.747 Test Loss: 0.963 Test Acc: 0.747
Validation loss decreased (-0.718740 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 0.8352630138397217
Epoch: 10, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.907 Vali Acc: 0.756 Test Loss: 0.907 Test Acc: 0.756
Validation loss decreased (-0.746865 --> -0.756241).  Saving model ...
Epoch: 11 cost time: 0.8337717056274414
Epoch: 11, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.860 Vali Acc: 0.762 Test Loss: 0.860 Test Acc: 0.762
Validation loss decreased (-0.756241 --> -0.762491).  Saving model ...
Epoch: 12 cost time: 0.8857190608978271
Epoch: 12, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.823 Vali Acc: 0.781 Test Loss: 0.823 Test Acc: 0.781
Validation loss decreased (-0.762491 --> -0.781242).  Saving model ...
Epoch: 13 cost time: 0.9819965362548828
Epoch: 13, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.792 Vali Acc: 0.787 Test Loss: 0.792 Test Acc: 0.787
Validation loss decreased (-0.781242 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 0.8522369861602783
Epoch: 14, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.765 Vali Acc: 0.791 Test Loss: 0.765 Test Acc: 0.791
Validation loss decreased (-0.787492 --> -0.790617).  Saving model ...
Epoch: 15 cost time: 0.9318618774414062
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 16 cost time: 0.7660017013549805
Epoch: 16, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.730 Vali Acc: 0.787 Test Loss: 0.730 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8585319519042969
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.711 Vali Acc: 0.791 Test Loss: 0.711 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8268392086029053
Epoch: 18, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.698 Vali Acc: 0.797 Test Loss: 0.698 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 19 cost time: 0.9992635250091553
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 20 cost time: 0.8052780628204346
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.680 Vali Acc: 0.797 Test Loss: 0.680 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 21 cost time: 0.8920097351074219
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.779038667678833
Epoch: 22, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.668 Vali Acc: 0.791 Test Loss: 0.668 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7018551826477051
Epoch: 23, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.662 Vali Acc: 0.794 Test Loss: 0.662 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7293446063995361
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8095507621765137
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.656 Vali Acc: 0.797 Test Loss: 0.656 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 26 cost time: 0.7790756225585938
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803118).  Saving model ...
Epoch: 27 cost time: 0.9000749588012695
Epoch: 27, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 28 cost time: 0.9936554431915283
Epoch: 28, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.649 Vali Acc: 0.806 Test Loss: 0.649 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8802688121795654
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.806 Test Loss: 0.648 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8804056644439697
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 31 cost time: 0.670295000076294
Epoch: 31, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9583268165588379
Epoch: 32, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8068628311157227
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8072247505187988
Epoch: 34, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9207134246826172
Epoch: 35, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 36 cost time: 0.8267261981964111
Epoch: 36, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 37 cost time: 0.8041870594024658
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0603632926940918
Epoch: 38, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.05369234085083
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 40 cost time: 0.8169565200805664
Epoch: 40, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 41 cost time: 1.1369588375091553
Epoch: 41, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1118113994598389
Epoch: 42, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.079892873764038
Epoch: 43, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9017188549041748
Epoch: 44, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9590651988983154
Epoch: 45, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.880643367767334
Epoch: 46, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 47 cost time: 0.7704892158508301
Epoch: 47, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.812 Test Loss: 0.640 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 48 cost time: 0.8519880771636963
Epoch: 48, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 49 cost time: 0.9049427509307861
Epoch: 49, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.969113826751709
Epoch: 50, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0397615432739258
Epoch: 51, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8741381168365479
Epoch: 52, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8889594078063965
Epoch: 53, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9588115215301514
Epoch: 54, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.081681251525879
Epoch: 55, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9023323059082031
Epoch: 56, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9720613956451416
Epoch: 57, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7597053050994873
Epoch: 58, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8125
model parameter : 1306682
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.510432481765747
Epoch: 1, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.998 Vali Acc: 0.263 Test Loss: 1.998 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 0.8429772853851318
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.837 Vali Acc: 0.388 Test Loss: 1.837 Test Acc: 0.388
Validation loss decreased (-0.262480 --> -0.387482).  Saving model ...
Epoch: 3 cost time: 0.7467892169952393
Epoch: 3, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.648 Vali Acc: 0.550 Test Loss: 1.648 Test Acc: 0.550
Validation loss decreased (-0.387482 --> -0.549984).  Saving model ...
Epoch: 4 cost time: 0.6640007495880127
Epoch: 4, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.471 Vali Acc: 0.600 Test Loss: 1.471 Test Acc: 0.600
Validation loss decreased (-0.549984 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 0.902271032333374
Epoch: 5, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.326 Vali Acc: 0.637 Test Loss: 1.326 Test Acc: 0.637
Validation loss decreased (-0.599985 --> -0.637487).  Saving model ...
Epoch: 6 cost time: 0.9703080654144287
Epoch: 6, Steps: 8 | Train Loss: 0.903 Vali Loss: 1.217 Vali Acc: 0.669 Test Loss: 1.217 Test Acc: 0.669
Validation loss decreased (-0.637487 --> -0.668738).  Saving model ...
Epoch: 7 cost time: 0.7584123611450195
Epoch: 7, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
Validation loss decreased (-0.668738 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.7751586437225342
Epoch: 8, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.072 Vali Acc: 0.669 Test Loss: 1.072 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7386164665222168
Epoch: 9, Steps: 8 | Train Loss: 0.594 Vali Loss: 1.012 Vali Acc: 0.706 Test Loss: 1.012 Test Acc: 0.706
Validation loss decreased (-0.674989 --> -0.706240).  Saving model ...
Epoch: 10 cost time: 0.6022891998291016
Epoch: 10, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.706240 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7078902721405029
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.918 Vali Acc: 0.738 Test Loss: 0.918 Test Acc: 0.738
Validation loss decreased (-0.724990 --> -0.737491).  Saving model ...
Epoch: 12 cost time: 0.7072381973266602
Epoch: 12, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8622260093688965
Epoch: 13, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.864 Vali Acc: 0.753 Test Loss: 0.864 Test Acc: 0.753
Validation loss decreased (-0.737491 --> -0.753116).  Saving model ...
Epoch: 14 cost time: 0.823814868927002
Epoch: 14, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.841 Vali Acc: 0.759 Test Loss: 0.841 Test Acc: 0.759
Validation loss decreased (-0.753116 --> -0.759367).  Saving model ...
Epoch: 15 cost time: 0.9434356689453125
Epoch: 15, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.826 Vali Acc: 0.747 Test Loss: 0.826 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0529601573944092
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.807 Vali Acc: 0.766 Test Loss: 0.807 Test Acc: 0.766
Validation loss decreased (-0.759367 --> -0.765617).  Saving model ...
Epoch: 17 cost time: 0.8060376644134521
Epoch: 17, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0651054382324219
Epoch: 18, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.786 Vali Acc: 0.753 Test Loss: 0.786 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.967442512512207
Epoch: 19, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.783 Vali Acc: 0.753 Test Loss: 0.783 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9237716197967529
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8298418521881104
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.754 Vali Acc: 0.759 Test Loss: 0.754 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7744617462158203
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.746 Vali Acc: 0.772 Test Loss: 0.746 Test Acc: 0.772
Validation loss decreased (-0.765617 --> -0.771868).  Saving model ...
Epoch: 23 cost time: 0.7297050952911377
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8130514621734619
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.730 Vali Acc: 0.769 Test Loss: 0.730 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7433481216430664
Epoch: 25, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.735 Vali Acc: 0.769 Test Loss: 0.735 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.72837233543396
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
Validation loss decreased (-0.771868 --> -0.774993).  Saving model ...
Epoch: 27 cost time: 0.810725212097168
Epoch: 27, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.774993 --> -0.778118).  Saving model ...
Epoch: 28 cost time: 0.7064247131347656
Epoch: 28, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.605881929397583
Epoch: 29, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.726 Vali Acc: 0.784 Test Loss: 0.726 Test Acc: 0.784
Validation loss decreased (-0.778118 --> -0.784368).  Saving model ...
Epoch: 30 cost time: 0.774057149887085
Epoch: 30, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.721 Vali Acc: 0.784 Test Loss: 0.721 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 31 cost time: 0.703477144241333
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.784 Test Loss: 0.720 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 32 cost time: 0.8626818656921387
Epoch: 32, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.721 Vali Acc: 0.781 Test Loss: 0.721 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9209246635437012
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.718 Vali Acc: 0.784 Test Loss: 0.718 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 34 cost time: 0.7034902572631836
Epoch: 34, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.717 Vali Acc: 0.791 Test Loss: 0.717 Test Acc: 0.791
Validation loss decreased (-0.784368 --> -0.790618).  Saving model ...
Epoch: 35 cost time: 0.7099409103393555
Epoch: 35, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.711 Vali Acc: 0.787 Test Loss: 0.711 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7218163013458252
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6759836673736572
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.784 Test Loss: 0.712 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6997978687286377
Epoch: 38, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6133546829223633
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.712 Vali Acc: 0.772 Test Loss: 0.712 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7341098785400391
Epoch: 40, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.778 Test Loss: 0.710 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8123550415039062
Epoch: 41, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.845958948135376
Epoch: 42, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7462220191955566
Epoch: 43, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.708 Vali Acc: 0.781 Test Loss: 0.708 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7620241641998291
Epoch: 44, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.706 Vali Acc: 0.784 Test Loss: 0.706 Test Acc: 0.784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.790625
model parameter : 1300538
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5332510471343994
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.069 Vali Acc: 0.188 Test Loss: 2.069 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 1.9248497486114502
Epoch: 2, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.776 Vali Acc: 0.400 Test Loss: 1.776 Test Acc: 0.400
Validation loss decreased (-0.187479 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.9586460590362549
Epoch: 3, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.513 Vali Acc: 0.550 Test Loss: 1.513 Test Acc: 0.550
Validation loss decreased (-0.399982 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 2.0010921955108643
Epoch: 4, Steps: 8 | Train Loss: 1.080 Vali Loss: 1.346 Vali Acc: 0.637 Test Loss: 1.346 Test Acc: 0.637
Validation loss decreased (-0.549985 --> -0.637487).  Saving model ...
Epoch: 5 cost time: 2.35794997215271
Epoch: 5, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.204 Vali Acc: 0.688 Test Loss: 1.204 Test Acc: 0.688
Validation loss decreased (-0.637487 --> -0.687488).  Saving model ...
Epoch: 6 cost time: 1.9224984645843506
Epoch: 6, Steps: 8 | Train Loss: 0.697 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
Validation loss decreased (-0.687488 --> -0.721864).  Saving model ...
Epoch: 7 cost time: 1.7924320697784424
Epoch: 7, Steps: 8 | Train Loss: 0.601 Vali Loss: 1.034 Vali Acc: 0.691 Test Loss: 1.034 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.019012689590454
Epoch: 8, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
Validation loss decreased (-0.721864 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 1.8336198329925537
Epoch: 9, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.946 Vali Acc: 0.753 Test Loss: 0.946 Test Acc: 0.753
Validation loss decreased (-0.724990 --> -0.753116).  Saving model ...
Epoch: 10 cost time: 1.8656084537506104
Epoch: 10, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.905 Vali Acc: 0.747 Test Loss: 0.905 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1539626121520996
Epoch: 11, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.859 Vali Acc: 0.769 Test Loss: 0.859 Test Acc: 0.769
Validation loss decreased (-0.753116 --> -0.768741).  Saving model ...
Epoch: 12 cost time: 1.9197099208831787
Epoch: 12, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
Validation loss decreased (-0.768741 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 1.8802437782287598
Epoch: 13, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8581154346466064
Epoch: 14, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.823 Vali Acc: 0.759 Test Loss: 0.823 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1384778022766113
Epoch: 15, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.808 Vali Acc: 0.753 Test Loss: 0.808 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0799005031585693
Epoch: 16, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2348687648773193
Epoch: 17, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.799 Vali Acc: 0.747 Test Loss: 0.799 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0842275619506836
Epoch: 18, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.794 Vali Acc: 0.759 Test Loss: 0.794 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.188018321990967
Epoch: 19, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.782 Vali Acc: 0.766 Test Loss: 0.782 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8200719356536865
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.782 Vali Acc: 0.766 Test Loss: 0.782 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1420376300811768
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.779 Vali Acc: 0.753 Test Loss: 0.779 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9449949264526367
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.766 Vali Acc: 0.759 Test Loss: 0.766 Test Acc: 0.759
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.775
model parameter : 1380376
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6907100677490234
Epoch: 1, Steps: 8 | Train Loss: 2.278 Vali Loss: 2.157 Vali Acc: 0.134 Test Loss: 2.157 Test Acc: 0.134
Validation loss decreased (inf --> -0.134353).  Saving model ...
Epoch: 2 cost time: 1.554563045501709
Epoch: 2, Steps: 8 | Train Loss: 1.940 Vali Loss: 1.860 Vali Acc: 0.359 Test Loss: 1.860 Test Acc: 0.359
Validation loss decreased (-0.134353 --> -0.359356).  Saving model ...
Epoch: 3 cost time: 1.8303256034851074
Epoch: 3, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.588 Vali Acc: 0.547 Test Loss: 1.588 Test Acc: 0.547
Validation loss decreased (-0.359356 --> -0.546859).  Saving model ...
Epoch: 4 cost time: 1.5749053955078125
Epoch: 4, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.386 Vali Acc: 0.644 Test Loss: 1.386 Test Acc: 0.644
Validation loss decreased (-0.546859 --> -0.643736).  Saving model ...
Epoch: 5 cost time: 1.6412951946258545
Epoch: 5, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.235 Vali Acc: 0.678 Test Loss: 1.235 Test Acc: 0.678
Validation loss decreased (-0.643736 --> -0.678113).  Saving model ...
Epoch: 6 cost time: 2.0520665645599365
Epoch: 6, Steps: 8 | Train Loss: 0.740 Vali Loss: 1.145 Vali Acc: 0.716 Test Loss: 1.145 Test Acc: 0.716
Validation loss decreased (-0.678113 --> -0.715614).  Saving model ...
Epoch: 7 cost time: 1.8649871349334717
Epoch: 7, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.079 Vali Acc: 0.709 Test Loss: 1.079 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2745683193206787
Epoch: 8, Steps: 8 | Train Loss: 0.492 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3796238899230957
Epoch: 9, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
Validation loss decreased (-0.715614 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 2.3468799591064453
Epoch: 10, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.915 Vali Acc: 0.722 Test Loss: 0.915 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9492459297180176
Epoch: 11, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.882 Vali Acc: 0.747 Test Loss: 0.882 Test Acc: 0.747
Validation loss decreased (-0.724990 --> -0.746866).  Saving model ...
Epoch: 12 cost time: 2.0230519771575928
Epoch: 12, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6336476802825928
Epoch: 13, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.833 Vali Acc: 0.741 Test Loss: 0.833 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9162535667419434
Epoch: 14, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.814 Vali Acc: 0.747 Test Loss: 0.814 Test Acc: 0.747
Validation loss decreased (-0.746866 --> -0.746867).  Saving model ...
Epoch: 15 cost time: 2.2082056999206543
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.786 Vali Acc: 0.766 Test Loss: 0.786 Test Acc: 0.766
Validation loss decreased (-0.746867 --> -0.765617).  Saving model ...
Epoch: 16 cost time: 1.8715083599090576
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.771 Vali Acc: 0.744 Test Loss: 0.771 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.665025472640991
Epoch: 17, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.774 Vali Acc: 0.762 Test Loss: 0.774 Test Acc: 0.762
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7241668701171875
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.772 Vali Acc: 0.759 Test Loss: 0.772 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2478959560394287
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.184288263320923
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.759 Vali Acc: 0.769 Test Loss: 0.759 Test Acc: 0.769
Validation loss decreased (-0.765617 --> -0.768742).  Saving model ...
Epoch: 21 cost time: 2.264193058013916
Epoch: 21, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.755 Vali Acc: 0.753 Test Loss: 0.755 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0598433017730713
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1374363899230957
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.761 Vali Acc: 0.753 Test Loss: 0.761 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6384661197662354
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.753 Test Loss: 0.760 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5716476440429688
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0060949325561523
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9679856300354004
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.755 Vali Acc: 0.738 Test Loss: 0.755 Test Acc: 0.738
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.133979082107544
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.756 Vali Acc: 0.741 Test Loss: 0.756 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2769906520843506
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.744 Test Loss: 0.757 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.044227123260498
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.760 Vali Acc: 0.734 Test Loss: 0.760 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.76875
model parameter : 1363992
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2713804244995117
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 2.081 Vali Acc: 0.163 Test Loss: 2.081 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.6504545211791992
Epoch: 2, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.827 Vali Acc: 0.394 Test Loss: 1.827 Test Acc: 0.394
Validation loss decreased (-0.162479 --> -0.393732).  Saving model ...
Epoch: 3 cost time: 1.3129353523254395
Epoch: 3, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.567 Vali Acc: 0.584 Test Loss: 1.567 Test Acc: 0.584
Validation loss decreased (-0.393732 --> -0.584359).  Saving model ...
Epoch: 4 cost time: 1.5235543251037598
Epoch: 4, Steps: 8 | Train Loss: 1.075 Vali Loss: 1.390 Vali Acc: 0.681 Test Loss: 1.390 Test Acc: 0.681
Validation loss decreased (-0.584359 --> -0.681236).  Saving model ...
Epoch: 5 cost time: 1.8028042316436768
Epoch: 5, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.255 Vali Acc: 0.700 Test Loss: 1.255 Test Acc: 0.700
Validation loss decreased (-0.681236 --> -0.699987).  Saving model ...
Epoch: 6 cost time: 1.7504303455352783
Epoch: 6, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.153 Vali Acc: 0.716 Test Loss: 1.153 Test Acc: 0.716
Validation loss decreased (-0.699987 --> -0.715613).  Saving model ...
Epoch: 7 cost time: 1.5174875259399414
Epoch: 7, Steps: 8 | Train Loss: 0.578 Vali Loss: 1.095 Vali Acc: 0.691 Test Loss: 1.095 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9833464622497559
Epoch: 8, Steps: 8 | Train Loss: 0.475 Vali Loss: 1.021 Vali Acc: 0.713 Test Loss: 1.021 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8281760215759277
Epoch: 9, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.977 Vali Acc: 0.738 Test Loss: 0.977 Test Acc: 0.738
Validation loss decreased (-0.715613 --> -0.737490).  Saving model ...
Epoch: 10 cost time: 1.73600172996521
Epoch: 10, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.941 Vali Acc: 0.741 Test Loss: 0.941 Test Acc: 0.741
Validation loss decreased (-0.737490 --> -0.740616).  Saving model ...
Epoch: 11 cost time: 1.5556113719940186
Epoch: 11, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.917 Vali Acc: 0.703 Test Loss: 0.917 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8235774040222168
Epoch: 12, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.886 Vali Acc: 0.741 Test Loss: 0.886 Test Acc: 0.741
Validation loss decreased (-0.740616 --> -0.740616).  Saving model ...
Epoch: 13 cost time: 1.8121154308319092
Epoch: 13, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3903319835662842
Epoch: 14, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7235679626464844
Epoch: 15, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.835 Vali Acc: 0.716 Test Loss: 0.835 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.952613115310669
Epoch: 16, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.824 Vali Acc: 0.738 Test Loss: 0.824 Test Acc: 0.738
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5668799877166748
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.811 Vali Acc: 0.738 Test Loss: 0.811 Test Acc: 0.738
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6014177799224854
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.803 Vali Acc: 0.738 Test Loss: 0.803 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4598760604858398
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.799 Vali Acc: 0.741 Test Loss: 0.799 Test Acc: 0.741
Validation loss decreased (-0.740616 --> -0.740617).  Saving model ...
Epoch: 20 cost time: 1.9617624282836914
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.801 Vali Acc: 0.747 Test Loss: 0.801 Test Acc: 0.747
Validation loss decreased (-0.740617 --> -0.746867).  Saving model ...
Epoch: 21 cost time: 1.617358922958374
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.799 Vali Acc: 0.734 Test Loss: 0.799 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.750276803970337
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.530979871749878
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.808 Vali Acc: 0.731 Test Loss: 0.808 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.563216209411621
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.805 Vali Acc: 0.728 Test Loss: 0.805 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.885678768157959
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.806 Vali Acc: 0.731 Test Loss: 0.806 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6545488834381104
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.808 Vali Acc: 0.731 Test Loss: 0.808 Test Acc: 0.731
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.670518398284912
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.731 Test Loss: 0.809 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4231281280517578
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.807 Vali Acc: 0.734 Test Loss: 0.807 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4106380939483643
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.734 Test Loss: 0.806 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7006056308746338
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.731 Test Loss: 0.809 Test Acc: 0.731
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.746875
model parameter : 1347608
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1629538536071777
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.022 Vali Acc: 0.244 Test Loss: 2.022 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 1.7009406089782715
Epoch: 2, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.759 Vali Acc: 0.459 Test Loss: 1.759 Test Acc: 0.459
Validation loss decreased (-0.243730 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 1.326937198638916
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.515 Vali Acc: 0.584 Test Loss: 1.515 Test Acc: 0.584
Validation loss decreased (-0.459357 --> -0.584360).  Saving model ...
Epoch: 4 cost time: 1.3443267345428467
Epoch: 4, Steps: 8 | Train Loss: 1.058 Vali Loss: 1.339 Vali Acc: 0.634 Test Loss: 1.339 Test Acc: 0.634
Validation loss decreased (-0.584360 --> -0.634362).  Saving model ...
Epoch: 5 cost time: 1.5262529850006104
Epoch: 5, Steps: 8 | Train Loss: 0.863 Vali Loss: 1.214 Vali Acc: 0.662 Test Loss: 1.214 Test Acc: 0.662
Validation loss decreased (-0.634362 --> -0.662488).  Saving model ...
Epoch: 6 cost time: 1.570758581161499
Epoch: 6, Steps: 8 | Train Loss: 0.669 Vali Loss: 1.125 Vali Acc: 0.675 Test Loss: 1.125 Test Acc: 0.675
Validation loss decreased (-0.662488 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.3893535137176514
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.688502311706543
Epoch: 8, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.000 Vali Acc: 0.719 Test Loss: 1.000 Test Acc: 0.719
Validation loss decreased (-0.699989 --> -0.718740).  Saving model ...
Epoch: 9 cost time: 1.1730871200561523
Epoch: 9, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
Validation loss decreased (-0.718740 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 1.566129207611084
Epoch: 10, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.900 Vali Acc: 0.738 Test Loss: 0.900 Test Acc: 0.738
Validation loss decreased (-0.724990 --> -0.737491).  Saving model ...
Epoch: 11 cost time: 1.4670138359069824
Epoch: 11, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.877 Vali Acc: 0.756 Test Loss: 0.877 Test Acc: 0.756
Validation loss decreased (-0.737491 --> -0.756241).  Saving model ...
Epoch: 12 cost time: 1.4082632064819336
Epoch: 12, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.850 Vali Acc: 0.738 Test Loss: 0.850 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.417609453201294
Epoch: 13, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.822 Vali Acc: 0.744 Test Loss: 0.822 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6414783000946045
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.810 Vali Acc: 0.738 Test Loss: 0.810 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0785999298095703
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756242).  Saving model ...
Epoch: 16 cost time: 1.3298299312591553
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4072694778442383
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.810 Vali Acc: 0.747 Test Loss: 0.810 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4892163276672363
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.803 Vali Acc: 0.762 Test Loss: 0.803 Test Acc: 0.762
Validation loss decreased (-0.756242 --> -0.762492).  Saving model ...
Epoch: 19 cost time: 1.5237236022949219
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.794 Vali Acc: 0.759 Test Loss: 0.794 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8247392177581787
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.594719648361206
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5589959621429443
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.789 Vali Acc: 0.747 Test Loss: 0.789 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.435129165649414
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.792 Vali Acc: 0.747 Test Loss: 0.792 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3755087852478027
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7570505142211914
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7182371616363525
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.797 Vali Acc: 0.753 Test Loss: 0.797 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3145112991333008
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.753 Test Loss: 0.799 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2002170085906982
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7625
model parameter : 1331224
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9843437671661377
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 2.131 Vali Acc: 0.103 Test Loss: 2.131 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 1.0229570865631104
Epoch: 2, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.852 Vali Acc: 0.331 Test Loss: 1.852 Test Acc: 0.331
Validation loss decreased (-0.103104 --> -0.331231).  Saving model ...
Epoch: 3 cost time: 0.9378583431243896
Epoch: 3, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.573 Vali Acc: 0.588 Test Loss: 1.573 Test Acc: 0.588
Validation loss decreased (-0.331231 --> -0.587484).  Saving model ...
Epoch: 4 cost time: 0.9391098022460938
Epoch: 4, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.356 Vali Acc: 0.659 Test Loss: 1.356 Test Acc: 0.659
Validation loss decreased (-0.587484 --> -0.659361).  Saving model ...
Epoch: 5 cost time: 1.012094497680664
Epoch: 5, Steps: 8 | Train Loss: 0.829 Vali Loss: 1.207 Vali Acc: 0.709 Test Loss: 1.207 Test Acc: 0.709
Validation loss decreased (-0.659361 --> -0.709363).  Saving model ...
Epoch: 6 cost time: 1.0916776657104492
Epoch: 6, Steps: 8 | Train Loss: 0.635 Vali Loss: 1.102 Vali Acc: 0.734 Test Loss: 1.102 Test Acc: 0.734
Validation loss decreased (-0.709363 --> -0.734364).  Saving model ...
Epoch: 7 cost time: 0.939842700958252
Epoch: 7, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.021 Vali Acc: 0.738 Test Loss: 1.021 Test Acc: 0.738
Validation loss decreased (-0.734364 --> -0.737490).  Saving model ...
Epoch: 8 cost time: 1.1049127578735352
Epoch: 8, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.948 Vali Acc: 0.744 Test Loss: 0.948 Test Acc: 0.744
Validation loss decreased (-0.737490 --> -0.743741).  Saving model ...
Epoch: 9 cost time: 0.9212095737457275
Epoch: 9, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.895 Vali Acc: 0.747 Test Loss: 0.895 Test Acc: 0.747
Validation loss decreased (-0.743741 --> -0.746866).  Saving model ...
Epoch: 10 cost time: 0.929351806640625
Epoch: 10, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
Validation loss decreased (-0.746866 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.097569465637207
Epoch: 11, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.836 Vali Acc: 0.741 Test Loss: 0.836 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0181756019592285
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.8197143077850342
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.791 Vali Acc: 0.753 Test Loss: 0.791 Test Acc: 0.753
Validation loss decreased (-0.749992 --> -0.753117).  Saving model ...
Epoch: 14 cost time: 1.1062626838684082
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4579417705535889
Epoch: 15, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.782 Vali Acc: 0.759 Test Loss: 0.782 Test Acc: 0.759
Validation loss decreased (-0.753117 --> -0.759367).  Saving model ...
Epoch: 16 cost time: 1.2227089405059814
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.778 Vali Acc: 0.756 Test Loss: 0.778 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0567214488983154
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.148428201675415
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.786 Vali Acc: 0.741 Test Loss: 0.786 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.207101583480835
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.784 Vali Acc: 0.753 Test Loss: 0.784 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3002192974090576
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9112873077392578
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.776 Vali Acc: 0.747 Test Loss: 0.776 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2375857830047607
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.776 Vali Acc: 0.747 Test Loss: 0.776 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1588916778564453
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.779 Vali Acc: 0.744 Test Loss: 0.779 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.027663230895996
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.781 Vali Acc: 0.744 Test Loss: 0.781 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4097096920013428
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.741 Test Loss: 0.782 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 1318936
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0327298641204834
Epoch: 1, Steps: 8 | Train Loss: 2.076 Vali Loss: 2.036 Vali Acc: 0.172 Test Loss: 2.036 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 1.1299312114715576
Epoch: 2, Steps: 8 | Train Loss: 1.753 Vali Loss: 1.741 Vali Acc: 0.444 Test Loss: 1.741 Test Acc: 0.444
Validation loss decreased (-0.171855 --> -0.443733).  Saving model ...
Epoch: 3 cost time: 1.1381542682647705
Epoch: 3, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.467 Vali Acc: 0.619 Test Loss: 1.467 Test Acc: 0.619
Validation loss decreased (-0.443733 --> -0.618735).  Saving model ...
Epoch: 4 cost time: 1.1229352951049805
Epoch: 4, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.269 Vali Acc: 0.688 Test Loss: 1.269 Test Acc: 0.688
Validation loss decreased (-0.618735 --> -0.687487).  Saving model ...
Epoch: 5 cost time: 0.9794144630432129
Epoch: 5, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.143 Vali Acc: 0.691 Test Loss: 1.143 Test Acc: 0.691
Validation loss decreased (-0.687487 --> -0.690614).  Saving model ...
Epoch: 6 cost time: 1.0592772960662842
Epoch: 6, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.052 Vali Acc: 0.722 Test Loss: 1.052 Test Acc: 0.722
Validation loss decreased (-0.690614 --> -0.721864).  Saving model ...
Epoch: 7 cost time: 0.97190260887146
Epoch: 7, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
Validation loss decreased (-0.721864 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.9902393817901611
Epoch: 8, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.926 Vali Acc: 0.741 Test Loss: 0.926 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8846290111541748
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.882 Vali Acc: 0.747 Test Loss: 0.882 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9727342128753662
Epoch: 10, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.839 Vali Acc: 0.762 Test Loss: 0.839 Test Acc: 0.762
Validation loss decreased (-0.749990 --> -0.762492).  Saving model ...
Epoch: 11 cost time: 0.88507080078125
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9163131713867188
Epoch: 12, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9057488441467285
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.793 Vali Acc: 0.766 Test Loss: 0.793 Test Acc: 0.766
Validation loss decreased (-0.762492 --> -0.765617).  Saving model ...
Epoch: 14 cost time: 0.9732153415679932
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.784 Vali Acc: 0.762 Test Loss: 0.784 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1892673969268799
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.786 Vali Acc: 0.759 Test Loss: 0.786 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9634439945220947
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.779 Vali Acc: 0.756 Test Loss: 0.779 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2297947406768799
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.768 Vali Acc: 0.762 Test Loss: 0.768 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0427274703979492
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.765 Vali Acc: 0.759 Test Loss: 0.765 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1365575790405273
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1571228504180908
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.765 Vali Acc: 0.762 Test Loss: 0.765 Test Acc: 0.762
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2046597003936768
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
Validation loss decreased (-0.765617 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.1525557041168213
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.781 Test Loss: 0.763 Test Acc: 0.781
Validation loss decreased (-0.774992 --> -0.781242).  Saving model ...
Epoch: 23 cost time: 1.16817045211792
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.768 Vali Acc: 0.778 Test Loss: 0.768 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2641031742095947
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1509766578674316
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0452520847320557
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1934607028961182
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.781 Test Loss: 0.772 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4644873142242432
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.781 Test Loss: 0.776 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2068595886230469
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9621617794036865
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2176415920257568
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0891335010528564
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.78125
model parameter : 1312792
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9918999671936035
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.092 Vali Acc: 0.169 Test Loss: 2.092 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 1.3062057495117188
Epoch: 2, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.765 Vali Acc: 0.406 Test Loss: 1.765 Test Acc: 0.406
Validation loss decreased (-0.168729 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.9846193790435791
Epoch: 3, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.502 Vali Acc: 0.566 Test Loss: 1.502 Test Acc: 0.566
Validation loss decreased (-0.406232 --> -0.565610).  Saving model ...
Epoch: 4 cost time: 0.7405409812927246
Epoch: 4, Steps: 8 | Train Loss: 1.012 Vali Loss: 1.283 Vali Acc: 0.653 Test Loss: 1.283 Test Acc: 0.653
Validation loss decreased (-0.565610 --> -0.653112).  Saving model ...
Epoch: 5 cost time: 0.9177186489105225
Epoch: 5, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.147 Vali Acc: 0.703 Test Loss: 1.147 Test Acc: 0.703
Validation loss decreased (-0.653112 --> -0.703114).  Saving model ...
Epoch: 6 cost time: 0.8497271537780762
Epoch: 6, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.062 Vali Acc: 0.703 Test Loss: 1.062 Test Acc: 0.703
Validation loss decreased (-0.703114 --> -0.703114).  Saving model ...
Epoch: 7 cost time: 0.793219804763794
Epoch: 7, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.995 Vali Acc: 0.703 Test Loss: 0.995 Test Acc: 0.703
Validation loss decreased (-0.703114 --> -0.703115).  Saving model ...
Epoch: 8 cost time: 0.9047725200653076
Epoch: 8, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.936 Vali Acc: 0.734 Test Loss: 0.936 Test Acc: 0.734
Validation loss decreased (-0.703115 --> -0.734366).  Saving model ...
Epoch: 9 cost time: 0.8925833702087402
Epoch: 9, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.734366 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.8137071132659912
Epoch: 10, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.872 Vali Acc: 0.747 Test Loss: 0.872 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.971168041229248
Epoch: 11, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.832 Vali Acc: 0.756 Test Loss: 0.832 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756242).  Saving model ...
Epoch: 12 cost time: 0.8578355312347412
Epoch: 12, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.817 Vali Acc: 0.759 Test Loss: 0.817 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 13 cost time: 0.9078590869903564
Epoch: 13, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.814 Vali Acc: 0.753 Test Loss: 0.814 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.122087001800537
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.804 Vali Acc: 0.753 Test Loss: 0.804 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7931313514709473
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.805 Vali Acc: 0.738 Test Loss: 0.805 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9395039081573486
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.797 Vali Acc: 0.741 Test Loss: 0.797 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1133716106414795
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.797 Vali Acc: 0.753 Test Loss: 0.797 Test Acc: 0.753
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9769880771636963
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.799 Vali Acc: 0.747 Test Loss: 0.799 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9533169269561768
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.800 Vali Acc: 0.759 Test Loss: 0.800 Test Acc: 0.759
Validation loss decreased (-0.759367 --> -0.759367).  Saving model ...
Epoch: 20 cost time: 0.882716178894043
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.796 Vali Acc: 0.756 Test Loss: 0.796 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0201053619384766
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1267924308776855
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.795 Vali Acc: 0.753 Test Loss: 0.795 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9832580089569092
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.799 Vali Acc: 0.753 Test Loss: 0.799 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0510799884796143
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.801 Vali Acc: 0.759 Test Loss: 0.801 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8794608116149902
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0543758869171143
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.753 Test Loss: 0.802 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9411427974700928
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0470969676971436
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.98777174949646
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 1306648
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3431236743927
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.048 Vali Acc: 0.184 Test Loss: 2.048 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.5941579341888428
Epoch: 2, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.723 Vali Acc: 0.472 Test Loss: 1.723 Test Acc: 0.472
Validation loss decreased (-0.184355 --> -0.471858).  Saving model ...
Epoch: 3 cost time: 0.7215785980224609
Epoch: 3, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.440 Vali Acc: 0.625 Test Loss: 1.440 Test Acc: 0.625
Validation loss decreased (-0.471858 --> -0.624986).  Saving model ...
Epoch: 4 cost time: 0.599113941192627
Epoch: 4, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.236 Vali Acc: 0.681 Test Loss: 1.236 Test Acc: 0.681
Validation loss decreased (-0.624986 --> -0.681238).  Saving model ...
Epoch: 5 cost time: 0.7209851741790771
Epoch: 5, Steps: 8 | Train Loss: 0.691 Vali Loss: 1.118 Vali Acc: 0.713 Test Loss: 1.118 Test Acc: 0.713
Validation loss decreased (-0.681238 --> -0.712489).  Saving model ...
Epoch: 6 cost time: 0.7331709861755371
Epoch: 6, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.030 Vali Acc: 0.719 Test Loss: 1.030 Test Acc: 0.719
Validation loss decreased (-0.712489 --> -0.718740).  Saving model ...
Epoch: 7 cost time: 0.7122495174407959
Epoch: 7, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.976 Vali Acc: 0.706 Test Loss: 0.976 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6472263336181641
Epoch: 8, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.921 Vali Acc: 0.753 Test Loss: 0.921 Test Acc: 0.753
Validation loss decreased (-0.718740 --> -0.753116).  Saving model ...
Epoch: 9 cost time: 0.5633420944213867
Epoch: 9, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5808842182159424
Epoch: 10, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.868 Vali Acc: 0.744 Test Loss: 0.868 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6016676425933838
Epoch: 11, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.842 Vali Acc: 0.731 Test Loss: 0.842 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7430033683776855
Epoch: 12, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.753116 --> -0.756242).  Saving model ...
Epoch: 13 cost time: 0.7610414028167725
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.822 Vali Acc: 0.747 Test Loss: 0.822 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6782608032226562
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.819 Vali Acc: 0.747 Test Loss: 0.819 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6312201023101807
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.824 Vali Acc: 0.741 Test Loss: 0.824 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5802774429321289
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.837 Vali Acc: 0.734 Test Loss: 0.837 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7084066867828369
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.834 Vali Acc: 0.738 Test Loss: 0.834 Test Acc: 0.738
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6615815162658691
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.833 Vali Acc: 0.738 Test Loss: 0.833 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.672511100769043
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6938223838806152
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.839 Vali Acc: 0.747 Test Loss: 0.839 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6728754043579102
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.843 Vali Acc: 0.738 Test Loss: 0.843 Test Acc: 0.738
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7132792472839355
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.843 Vali Acc: 0.741 Test Loss: 0.843 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75625
model parameter : 1300504
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6139771938323975
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.152 Vali Acc: 0.087 Test Loss: 2.152 Test Acc: 0.087
Validation loss decreased (inf --> -0.087478).  Saving model ...
Epoch: 2 cost time: 2.225311756134033
Epoch: 2, Steps: 8 | Train Loss: 2.080 Vali Loss: 2.063 Vali Acc: 0.153 Test Loss: 2.063 Test Acc: 0.153
Validation loss decreased (-0.087478 --> -0.153104).  Saving model ...
Epoch: 3 cost time: 2.14037823677063
Epoch: 3, Steps: 8 | Train Loss: 1.934 Vali Loss: 1.945 Vali Acc: 0.294 Test Loss: 1.945 Test Acc: 0.294
Validation loss decreased (-0.153104 --> -0.293731).  Saving model ...
Epoch: 4 cost time: 1.9433934688568115
Epoch: 4, Steps: 8 | Train Loss: 1.760 Vali Loss: 1.812 Vali Acc: 0.469 Test Loss: 1.812 Test Acc: 0.469
Validation loss decreased (-0.293731 --> -0.468732).  Saving model ...
Epoch: 5 cost time: 1.8511145114898682
Epoch: 5, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.677 Vali Acc: 0.541 Test Loss: 1.677 Test Acc: 0.541
Validation loss decreased (-0.468732 --> -0.540608).  Saving model ...
Epoch: 6 cost time: 2.2181973457336426
Epoch: 6, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.546 Vali Acc: 0.613 Test Loss: 1.546 Test Acc: 0.613
Validation loss decreased (-0.540608 --> -0.612485).  Saving model ...
Epoch: 7 cost time: 2.1998729705810547
Epoch: 7, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.428 Vali Acc: 0.644 Test Loss: 1.428 Test Acc: 0.644
Validation loss decreased (-0.612485 --> -0.643736).  Saving model ...
Epoch: 8 cost time: 1.968372106552124
Epoch: 8, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.315 Vali Acc: 0.672 Test Loss: 1.315 Test Acc: 0.672
Validation loss decreased (-0.643736 --> -0.671862).  Saving model ...
Epoch: 9 cost time: 2.117908239364624
Epoch: 9, Steps: 8 | Train Loss: 0.967 Vali Loss: 1.216 Vali Acc: 0.706 Test Loss: 1.216 Test Acc: 0.706
Validation loss decreased (-0.671862 --> -0.706238).  Saving model ...
Epoch: 10 cost time: 1.9264423847198486
Epoch: 10, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.133 Vali Acc: 0.728 Test Loss: 1.133 Test Acc: 0.728
Validation loss decreased (-0.706238 --> -0.728114).  Saving model ...
Epoch: 11 cost time: 1.9589393138885498
Epoch: 11, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.062 Vali Acc: 0.738 Test Loss: 1.062 Test Acc: 0.738
Validation loss decreased (-0.728114 --> -0.737489).  Saving model ...
Epoch: 12 cost time: 2.019618511199951
Epoch: 12, Steps: 8 | Train Loss: 0.663 Vali Loss: 1.009 Vali Acc: 0.756 Test Loss: 1.009 Test Acc: 0.756
Validation loss decreased (-0.737489 --> -0.756240).  Saving model ...
Epoch: 13 cost time: 1.9565751552581787
Epoch: 13, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.960 Vali Acc: 0.759 Test Loss: 0.960 Test Acc: 0.759
Validation loss decreased (-0.756240 --> -0.759365).  Saving model ...
Epoch: 14 cost time: 1.8885717391967773
Epoch: 14, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.921 Vali Acc: 0.762 Test Loss: 0.921 Test Acc: 0.762
Validation loss decreased (-0.759365 --> -0.762491).  Saving model ...
Epoch: 15 cost time: 1.7867212295532227
Epoch: 15, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.885 Vali Acc: 0.766 Test Loss: 0.885 Test Acc: 0.766
Validation loss decreased (-0.762491 --> -0.765616).  Saving model ...
Epoch: 16 cost time: 1.8903746604919434
Epoch: 16, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.857 Vali Acc: 0.759 Test Loss: 0.857 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9436750411987305
Epoch: 17, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.830 Vali Acc: 0.769 Test Loss: 0.830 Test Acc: 0.769
Validation loss decreased (-0.765616 --> -0.768742).  Saving model ...
Epoch: 18 cost time: 2.021425724029541
Epoch: 18, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.808 Vali Acc: 0.766 Test Loss: 0.808 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.931274652481079
Epoch: 19, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.792 Vali Acc: 0.769 Test Loss: 0.792 Test Acc: 0.769
Validation loss decreased (-0.768742 --> -0.768742).  Saving model ...
Epoch: 20 cost time: 1.8750238418579102
Epoch: 20, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.779 Vali Acc: 0.772 Test Loss: 0.779 Test Acc: 0.772
Validation loss decreased (-0.768742 --> -0.771867).  Saving model ...
Epoch: 21 cost time: 1.832679033279419
Epoch: 21, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.766 Vali Acc: 0.772 Test Loss: 0.766 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771867).  Saving model ...
Epoch: 22 cost time: 1.826869010925293
Epoch: 22, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.757 Vali Acc: 0.769 Test Loss: 0.757 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9050819873809814
Epoch: 23, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.747 Vali Acc: 0.769 Test Loss: 0.747 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9771642684936523
Epoch: 24, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771868).  Saving model ...
Epoch: 25 cost time: 2.0782735347747803
Epoch: 25, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
Validation loss decreased (-0.771868 --> -0.774993).  Saving model ...
Epoch: 26 cost time: 2.260361433029175
Epoch: 26, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8497042655944824
Epoch: 27, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.719 Vali Acc: 0.778 Test Loss: 0.719 Test Acc: 0.778
Validation loss decreased (-0.774993 --> -0.778118).  Saving model ...
Epoch: 28 cost time: 2.209444284439087
Epoch: 28, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.34171199798584
Epoch: 29, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.830894947052002
Epoch: 30, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8999745845794678
Epoch: 31, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.702 Vali Acc: 0.781 Test Loss: 0.702 Test Acc: 0.781
Validation loss decreased (-0.778118 --> -0.781243).  Saving model ...
Epoch: 32 cost time: 1.8976383209228516
Epoch: 32, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0627002716064453
Epoch: 33, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.696 Vali Acc: 0.781 Test Loss: 0.696 Test Acc: 0.781
Validation loss decreased (-0.781243 --> -0.781243).  Saving model ...
Epoch: 34 cost time: 1.966583490371704
Epoch: 34, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.695 Vali Acc: 0.781 Test Loss: 0.695 Test Acc: 0.781
Validation loss decreased (-0.781243 --> -0.781243).  Saving model ...
Epoch: 35 cost time: 1.8302209377288818
Epoch: 35, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.691 Vali Acc: 0.784 Test Loss: 0.691 Test Acc: 0.784
Validation loss decreased (-0.781243 --> -0.784368).  Saving model ...
Epoch: 36 cost time: 1.8605999946594238
Epoch: 36, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.690 Vali Acc: 0.791 Test Loss: 0.690 Test Acc: 0.791
Validation loss decreased (-0.784368 --> -0.790618).  Saving model ...
Epoch: 37 cost time: 1.9620001316070557
Epoch: 37, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.690 Vali Acc: 0.787 Test Loss: 0.690 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.003593921661377
Epoch: 38, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.691 Vali Acc: 0.784 Test Loss: 0.691 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8715002536773682
Epoch: 39, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.688 Vali Acc: 0.784 Test Loss: 0.688 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9898724555969238
Epoch: 40, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.684 Vali Acc: 0.787 Test Loss: 0.684 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.0914645195007324
Epoch: 41, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.683 Vali Acc: 0.791 Test Loss: 0.683 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 42 cost time: 2.1433448791503906
Epoch: 42, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.682 Vali Acc: 0.791 Test Loss: 0.682 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 43 cost time: 2.4761033058166504
Epoch: 43, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 44 cost time: 2.2514541149139404
Epoch: 44, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.677 Vali Acc: 0.797 Test Loss: 0.677 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 45 cost time: 2.5407063961029053
Epoch: 45, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.677 Vali Acc: 0.797 Test Loss: 0.677 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.0539238452911377
Epoch: 46, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 47 cost time: 2.0439276695251465
Epoch: 47, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.517350912094116
Epoch: 48, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.673 Vali Acc: 0.791 Test Loss: 0.673 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.323909044265747
Epoch: 49, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.787 Test Loss: 0.675 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.0843281745910645
Epoch: 50, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.675 Vali Acc: 0.784 Test Loss: 0.675 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.0018441677093506
Epoch: 51, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.675 Vali Acc: 0.787 Test Loss: 0.675 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.4796714782714844
Epoch: 52, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.675 Vali Acc: 0.791 Test Loss: 0.675 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.3545398712158203
Epoch: 53, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.674 Vali Acc: 0.791 Test Loss: 0.674 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.0767409801483154
Epoch: 54, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.673 Vali Acc: 0.791 Test Loss: 0.673 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.285550117492676
Epoch: 55, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.170450448989868
Epoch: 56, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.674 Vali Acc: 0.791 Test Loss: 0.674 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 694330
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.088465213775635
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.133 Vali Acc: 0.197 Test Loss: 2.133 Test Acc: 0.197
Validation loss decreased (inf --> -0.196854).  Saving model ...
Epoch: 2 cost time: 1.5889530181884766
Epoch: 2, Steps: 8 | Train Loss: 2.068 Vali Loss: 2.040 Vali Acc: 0.281 Test Loss: 2.040 Test Acc: 0.281
Validation loss decreased (-0.196854 --> -0.281230).  Saving model ...
Epoch: 3 cost time: 1.633561134338379
Epoch: 3, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.911 Vali Acc: 0.362 Test Loss: 1.911 Test Acc: 0.362
Validation loss decreased (-0.281230 --> -0.362481).  Saving model ...
Epoch: 4 cost time: 1.4867496490478516
Epoch: 4, Steps: 8 | Train Loss: 1.710 Vali Loss: 1.767 Vali Acc: 0.466 Test Loss: 1.767 Test Acc: 0.466
Validation loss decreased (-0.362481 --> -0.465607).  Saving model ...
Epoch: 5 cost time: 1.6749284267425537
Epoch: 5, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.620 Vali Acc: 0.559 Test Loss: 1.620 Test Acc: 0.559
Validation loss decreased (-0.465607 --> -0.559359).  Saving model ...
Epoch: 6 cost time: 2.1643238067626953
Epoch: 6, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.478 Vali Acc: 0.609 Test Loss: 1.478 Test Acc: 0.609
Validation loss decreased (-0.559359 --> -0.609360).  Saving model ...
Epoch: 7 cost time: 1.8377532958984375
Epoch: 7, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.349 Vali Acc: 0.653 Test Loss: 1.349 Test Acc: 0.653
Validation loss decreased (-0.609360 --> -0.653112).  Saving model ...
Epoch: 8 cost time: 1.5699567794799805
Epoch: 8, Steps: 8 | Train Loss: 0.974 Vali Loss: 1.236 Vali Acc: 0.681 Test Loss: 1.236 Test Acc: 0.681
Validation loss decreased (-0.653112 --> -0.681238).  Saving model ...
Epoch: 9 cost time: 1.5182476043701172
Epoch: 9, Steps: 8 | Train Loss: 0.811 Vali Loss: 1.142 Vali Acc: 0.691 Test Loss: 1.142 Test Acc: 0.691
Validation loss decreased (-0.681238 --> -0.690614).  Saving model ...
Epoch: 10 cost time: 1.436476707458496
Epoch: 10, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.065 Vali Acc: 0.725 Test Loss: 1.065 Test Acc: 0.725
Validation loss decreased (-0.690614 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 1.877150058746338
Epoch: 11, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.002 Vali Acc: 0.731 Test Loss: 1.002 Test Acc: 0.731
Validation loss decreased (-0.724989 --> -0.731240).  Saving model ...
Epoch: 12 cost time: 1.7549357414245605
Epoch: 12, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.949 Vali Acc: 0.738 Test Loss: 0.949 Test Acc: 0.738
Validation loss decreased (-0.731240 --> -0.737491).  Saving model ...
Epoch: 13 cost time: 1.715428352355957
Epoch: 13, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.906 Vali Acc: 0.744 Test Loss: 0.906 Test Acc: 0.744
Validation loss decreased (-0.737491 --> -0.743741).  Saving model ...
Epoch: 14 cost time: 1.7881650924682617
Epoch: 14, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.875 Vali Acc: 0.747 Test Loss: 0.875 Test Acc: 0.747
Validation loss decreased (-0.743741 --> -0.746866).  Saving model ...
Epoch: 15 cost time: 1.8165249824523926
Epoch: 15, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.746866 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 1.8665738105773926
Epoch: 16, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.822 Vali Acc: 0.756 Test Loss: 0.822 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.756242).  Saving model ...
Epoch: 17 cost time: 2.069653034210205
Epoch: 17, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.806 Vali Acc: 0.759 Test Loss: 0.806 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 18 cost time: 1.6277153491973877
Epoch: 18, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.791 Vali Acc: 0.753 Test Loss: 0.791 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7269690036773682
Epoch: 19, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.778 Vali Acc: 0.756 Test Loss: 0.778 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8327715396881104
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.765 Vali Acc: 0.766 Test Loss: 0.765 Test Acc: 0.766
Validation loss decreased (-0.759367 --> -0.765617).  Saving model ...
Epoch: 21 cost time: 1.6645927429199219
Epoch: 21, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.754 Vali Acc: 0.762 Test Loss: 0.754 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6995210647583008
Epoch: 22, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.750 Vali Acc: 0.766 Test Loss: 0.750 Test Acc: 0.766
Validation loss decreased (-0.765617 --> -0.765618).  Saving model ...
Epoch: 23 cost time: 1.6524772644042969
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.743 Vali Acc: 0.766 Test Loss: 0.743 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 24 cost time: 1.5107896327972412
Epoch: 24, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.736 Vali Acc: 0.762 Test Loss: 0.736 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7769989967346191
Epoch: 25, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.729 Vali Acc: 0.766 Test Loss: 0.729 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 26 cost time: 1.8686668872833252
Epoch: 26, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.726 Vali Acc: 0.762 Test Loss: 0.726 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8400747776031494
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.723 Vali Acc: 0.766 Test Loss: 0.723 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 28 cost time: 1.6837389469146729
Epoch: 28, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.725 Vali Acc: 0.762 Test Loss: 0.725 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5383760929107666
Epoch: 29, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.723 Vali Acc: 0.762 Test Loss: 0.723 Test Acc: 0.762
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8292059898376465
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.721 Vali Acc: 0.759 Test Loss: 0.721 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.595954179763794
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8984899520874023
Epoch: 32, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.715 Vali Acc: 0.766 Test Loss: 0.715 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 33 cost time: 1.7531099319458008
Epoch: 33, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.714 Vali Acc: 0.762 Test Loss: 0.714 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1998653411865234
Epoch: 34, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.716 Vali Acc: 0.759 Test Loss: 0.716 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6650912761688232
Epoch: 35, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.715 Vali Acc: 0.762 Test Loss: 0.715 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0713977813720703
Epoch: 36, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.715 Vali Acc: 0.762 Test Loss: 0.715 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.728696584701538
Epoch: 37, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7144067287445068
Epoch: 38, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
Validation loss decreased (-0.765618 --> -0.768743).  Saving model ...
Epoch: 39 cost time: 1.6311097145080566
Epoch: 39, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.718 Vali Acc: 0.766 Test Loss: 0.718 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.263699531555176
Epoch: 40, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.719 Vali Acc: 0.762 Test Loss: 0.719 Test Acc: 0.762
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.965900182723999
Epoch: 41, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7239468097686768
Epoch: 42, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.762 Test Loss: 0.720 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7893788814544678
Epoch: 43, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.719 Vali Acc: 0.762 Test Loss: 0.719 Test Acc: 0.762
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7746758460998535
Epoch: 44, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7123823165893555
Epoch: 45, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.719 Vali Acc: 0.762 Test Loss: 0.719 Test Acc: 0.762
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5978524684906006
Epoch: 46, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.720 Vali Acc: 0.762 Test Loss: 0.720 Test Acc: 0.762
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.674234390258789
Epoch: 47, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.0440971851348877
Epoch: 48, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.76875
model parameter : 686138
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3018929958343506
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.073 Vali Acc: 0.125 Test Loss: 2.073 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 1.4599645137786865
Epoch: 2, Steps: 8 | Train Loss: 2.023 Vali Loss: 1.977 Vali Acc: 0.169 Test Loss: 1.977 Test Acc: 0.169
Validation loss decreased (-0.124979 --> -0.168730).  Saving model ...
Epoch: 3 cost time: 1.329817295074463
Epoch: 3, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.852 Vali Acc: 0.353 Test Loss: 1.852 Test Acc: 0.353
Validation loss decreased (-0.168730 --> -0.353106).  Saving model ...
Epoch: 4 cost time: 1.626250982284546
Epoch: 4, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.716 Vali Acc: 0.550 Test Loss: 1.716 Test Acc: 0.550
Validation loss decreased (-0.353106 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 1.4035887718200684
Epoch: 5, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.581 Vali Acc: 0.628 Test Loss: 1.581 Test Acc: 0.628
Validation loss decreased (-0.549983 --> -0.628109).  Saving model ...
Epoch: 6 cost time: 1.3906519412994385
Epoch: 6, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.454 Vali Acc: 0.659 Test Loss: 1.454 Test Acc: 0.659
Validation loss decreased (-0.628109 --> -0.659360).  Saving model ...
Epoch: 7 cost time: 1.4340722560882568
Epoch: 7, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.338 Vali Acc: 0.684 Test Loss: 1.338 Test Acc: 0.684
Validation loss decreased (-0.659360 --> -0.684362).  Saving model ...
Epoch: 8 cost time: 1.3440585136413574
Epoch: 8, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.237 Vali Acc: 0.691 Test Loss: 1.237 Test Acc: 0.691
Validation loss decreased (-0.684362 --> -0.690613).  Saving model ...
Epoch: 9 cost time: 1.6050090789794922
Epoch: 9, Steps: 8 | Train Loss: 0.907 Vali Loss: 1.149 Vali Acc: 0.728 Test Loss: 1.149 Test Acc: 0.728
Validation loss decreased (-0.690613 --> -0.728114).  Saving model ...
Epoch: 10 cost time: 1.2795357704162598
Epoch: 10, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.078 Vali Acc: 0.738 Test Loss: 1.078 Test Acc: 0.738
Validation loss decreased (-0.728114 --> -0.737489).  Saving model ...
Epoch: 11 cost time: 1.3617329597473145
Epoch: 11, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.737489 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.370225429534912
Epoch: 12, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.756240).  Saving model ...
Epoch: 13 cost time: 1.5795860290527344
Epoch: 13, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.932 Vali Acc: 0.759 Test Loss: 0.932 Test Acc: 0.759
Validation loss decreased (-0.756240 --> -0.759366).  Saving model ...
Epoch: 14 cost time: 1.4686241149902344
Epoch: 14, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.897 Vali Acc: 0.753 Test Loss: 0.897 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6546368598937988
Epoch: 15, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.867 Vali Acc: 0.753 Test Loss: 0.867 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7556040287017822
Epoch: 16, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.675353765487671
Epoch: 17, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.819 Vali Acc: 0.762 Test Loss: 0.819 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762492).  Saving model ...
Epoch: 18 cost time: 1.6101572513580322
Epoch: 18, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.802 Vali Acc: 0.759 Test Loss: 0.802 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5497543811798096
Epoch: 19, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.785 Vali Acc: 0.772 Test Loss: 0.785 Test Acc: 0.772
Validation loss decreased (-0.762492 --> -0.771867).  Saving model ...
Epoch: 20 cost time: 1.7132134437561035
Epoch: 20, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.772 Vali Acc: 0.762 Test Loss: 0.772 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3974792957305908
Epoch: 21, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.763 Vali Acc: 0.762 Test Loss: 0.763 Test Acc: 0.762
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5045735836029053
Epoch: 22, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.752 Vali Acc: 0.766 Test Loss: 0.752 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6921370029449463
Epoch: 23, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.743 Vali Acc: 0.759 Test Loss: 0.743 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3618597984313965
Epoch: 24, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.734 Vali Acc: 0.762 Test Loss: 0.734 Test Acc: 0.762
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5092437267303467
Epoch: 25, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9375829696655273
Epoch: 26, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.710186243057251
Epoch: 27, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.721 Vali Acc: 0.766 Test Loss: 0.721 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4003686904907227
Epoch: 28, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.718 Vali Acc: 0.762 Test Loss: 0.718 Test Acc: 0.762
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7101774215698242
Epoch: 29, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.771875
model parameter : 677946
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.969986915588379
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 2.055 Vali Acc: 0.163 Test Loss: 2.055 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.4678831100463867
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.977 Vali Acc: 0.222 Test Loss: 1.977 Test Acc: 0.222
Validation loss decreased (-0.162479 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 1.9582483768463135
Epoch: 3, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.872 Vali Acc: 0.378 Test Loss: 1.872 Test Acc: 0.378
Validation loss decreased (-0.221855 --> -0.378106).  Saving model ...
Epoch: 4 cost time: 1.4166665077209473
Epoch: 4, Steps: 8 | Train Loss: 1.715 Vali Loss: 1.755 Vali Acc: 0.519 Test Loss: 1.755 Test Acc: 0.519
Validation loss decreased (-0.378106 --> -0.518732).  Saving model ...
Epoch: 5 cost time: 1.2922782897949219
Epoch: 5, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.640 Vali Acc: 0.616 Test Loss: 1.640 Test Acc: 0.616
Validation loss decreased (-0.518732 --> -0.615609).  Saving model ...
Epoch: 6 cost time: 1.294731616973877
Epoch: 6, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.523 Vali Acc: 0.656 Test Loss: 1.523 Test Acc: 0.656
Validation loss decreased (-0.615609 --> -0.656235).  Saving model ...
Epoch: 7 cost time: 1.342127799987793
Epoch: 7, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.411 Vali Acc: 0.694 Test Loss: 1.411 Test Acc: 0.694
Validation loss decreased (-0.656235 --> -0.693736).  Saving model ...
Epoch: 8 cost time: 1.3991904258728027
Epoch: 8, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.308 Vali Acc: 0.697 Test Loss: 1.308 Test Acc: 0.697
Validation loss decreased (-0.693736 --> -0.696862).  Saving model ...
Epoch: 9 cost time: 1.205406904220581
Epoch: 9, Steps: 8 | Train Loss: 0.952 Vali Loss: 1.218 Vali Acc: 0.703 Test Loss: 1.218 Test Acc: 0.703
Validation loss decreased (-0.696862 --> -0.703113).  Saving model ...
Epoch: 10 cost time: 1.6489388942718506
Epoch: 10, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.137 Vali Acc: 0.719 Test Loss: 1.137 Test Acc: 0.719
Validation loss decreased (-0.703113 --> -0.718739).  Saving model ...
Epoch: 11 cost time: 1.430469036102295
Epoch: 11, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.070 Vali Acc: 0.713 Test Loss: 1.070 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2592873573303223
Epoch: 12, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.013 Vali Acc: 0.738 Test Loss: 1.013 Test Acc: 0.738
Validation loss decreased (-0.718739 --> -0.737490).  Saving model ...
Epoch: 13 cost time: 1.2527382373809814
Epoch: 13, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.966 Vali Acc: 0.756 Test Loss: 0.966 Test Acc: 0.756
Validation loss decreased (-0.737490 --> -0.756240).  Saving model ...
Epoch: 14 cost time: 1.4822638034820557
Epoch: 14, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.921 Vali Acc: 0.753 Test Loss: 0.921 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4495398998260498
Epoch: 15, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.882 Vali Acc: 0.759 Test Loss: 0.882 Test Acc: 0.759
Validation loss decreased (-0.756240 --> -0.759366).  Saving model ...
Epoch: 16 cost time: 1.4717307090759277
Epoch: 16, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.853 Vali Acc: 0.762 Test Loss: 0.853 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762491).  Saving model ...
Epoch: 17 cost time: 1.567460060119629
Epoch: 17, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.830 Vali Acc: 0.753 Test Loss: 0.830 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.233642578125
Epoch: 18, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2773725986480713
Epoch: 19, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.794 Vali Acc: 0.747 Test Loss: 0.794 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2159130573272705
Epoch: 20, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.779 Vali Acc: 0.753 Test Loss: 0.779 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3775978088378906
Epoch: 21, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.771 Vali Acc: 0.753 Test Loss: 0.771 Test Acc: 0.753
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2470755577087402
Epoch: 22, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.762 Vali Acc: 0.759 Test Loss: 0.762 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.175884485244751
Epoch: 23, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.753 Vali Acc: 0.759 Test Loss: 0.753 Test Acc: 0.759
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1420843601226807
Epoch: 24, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.745 Vali Acc: 0.766 Test Loss: 0.745 Test Acc: 0.766
Validation loss decreased (-0.762491 --> -0.765618).  Saving model ...
Epoch: 25 cost time: 1.6633708477020264
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.739 Vali Acc: 0.759 Test Loss: 0.739 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.497819185256958
Epoch: 26, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.731 Vali Acc: 0.766 Test Loss: 0.731 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 27 cost time: 1.319410800933838
Epoch: 27, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.726 Vali Acc: 0.769 Test Loss: 0.726 Test Acc: 0.769
Validation loss decreased (-0.765618 --> -0.768743).  Saving model ...
Epoch: 28 cost time: 1.324099063873291
Epoch: 28, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
Validation loss decreased (-0.768743 --> -0.771868).  Saving model ...
Epoch: 29 cost time: 1.250504732131958
Epoch: 29, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
Validation loss decreased (-0.771868 --> -0.774993).  Saving model ...
Epoch: 30 cost time: 1.2705659866333008
Epoch: 30, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 31 cost time: 1.1802270412445068
Epoch: 31, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 32 cost time: 1.3058743476867676
Epoch: 32, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.712 Vali Acc: 0.772 Test Loss: 0.712 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5865166187286377
Epoch: 33, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.710 Vali Acc: 0.766 Test Loss: 0.710 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3442800045013428
Epoch: 34, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.709 Vali Acc: 0.766 Test Loss: 0.709 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1686315536499023
Epoch: 35, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.708 Vali Acc: 0.769 Test Loss: 0.708 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3355052471160889
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4473206996917725
Epoch: 37, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.708 Vali Acc: 0.769 Test Loss: 0.708 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4598448276519775
Epoch: 38, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3971822261810303
Epoch: 39, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3744351863861084
Epoch: 40, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.283182144165039
Epoch: 41, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.775
model parameter : 669754
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.774313449859619
Epoch: 1, Steps: 8 | Train Loss: 2.045 Vali Loss: 2.033 Vali Acc: 0.163 Test Loss: 2.033 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 1.020570993423462
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.939 Vali Acc: 0.259 Test Loss: 1.939 Test Acc: 0.259
Validation loss decreased (-0.162480 --> -0.259356).  Saving model ...
Epoch: 3 cost time: 1.048130989074707
Epoch: 3, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.815 Vali Acc: 0.459 Test Loss: 1.815 Test Acc: 0.459
Validation loss decreased (-0.259356 --> -0.459357).  Saving model ...
Epoch: 4 cost time: 0.8773190975189209
Epoch: 4, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.679 Vali Acc: 0.572 Test Loss: 1.679 Test Acc: 0.572
Validation loss decreased (-0.459357 --> -0.571858).  Saving model ...
Epoch: 5 cost time: 1.1588773727416992
Epoch: 5, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.544 Vali Acc: 0.656 Test Loss: 1.544 Test Acc: 0.656
Validation loss decreased (-0.571858 --> -0.656235).  Saving model ...
Epoch: 6 cost time: 1.0586140155792236
Epoch: 6, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.413 Vali Acc: 0.713 Test Loss: 1.413 Test Acc: 0.713
Validation loss decreased (-0.656235 --> -0.712486).  Saving model ...
Epoch: 7 cost time: 0.9942779541015625
Epoch: 7, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.301 Vali Acc: 0.734 Test Loss: 1.301 Test Acc: 0.734
Validation loss decreased (-0.712486 --> -0.734362).  Saving model ...
Epoch: 8 cost time: 1.0566020011901855
Epoch: 8, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.199 Vali Acc: 0.750 Test Loss: 1.199 Test Acc: 0.750
Validation loss decreased (-0.734362 --> -0.749988).  Saving model ...
Epoch: 9 cost time: 1.0815558433532715
Epoch: 9, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.113 Vali Acc: 0.766 Test Loss: 1.113 Test Acc: 0.766
Validation loss decreased (-0.749988 --> -0.765614).  Saving model ...
Epoch: 10 cost time: 1.1776623725891113
Epoch: 10, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.036 Vali Acc: 0.775 Test Loss: 1.036 Test Acc: 0.775
Validation loss decreased (-0.765614 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.9987194538116455
Epoch: 11, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.975 Vali Acc: 0.775 Test Loss: 0.975 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.9783360958099365
Epoch: 12, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.927 Vali Acc: 0.784 Test Loss: 0.927 Test Acc: 0.784
Validation loss decreased (-0.774990 --> -0.784366).  Saving model ...
Epoch: 13 cost time: 1.0208070278167725
Epoch: 13, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.888 Vali Acc: 0.784 Test Loss: 0.888 Test Acc: 0.784
Validation loss decreased (-0.784366 --> -0.784366).  Saving model ...
Epoch: 14 cost time: 1.162647008895874
Epoch: 14, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.854 Vali Acc: 0.797 Test Loss: 0.854 Test Acc: 0.797
Validation loss decreased (-0.784366 --> -0.796866).  Saving model ...
Epoch: 15 cost time: 1.027390718460083
Epoch: 15, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.796866 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.0334596633911133
Epoch: 16, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.0111746788024902
Epoch: 17, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803117).  Saving model ...
Epoch: 18 cost time: 0.9593892097473145
Epoch: 18, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
Validation loss decreased (-0.803117 --> -0.818742).  Saving model ...
Epoch: 19 cost time: 1.006077766418457
Epoch: 19, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0451173782348633
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9724946022033691
Epoch: 21, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.818742 --> -0.821868).  Saving model ...
Epoch: 22 cost time: 1.039013385772705
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.714 Vali Acc: 0.825 Test Loss: 0.714 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 1.0319874286651611
Epoch: 23, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.703 Vali Acc: 0.828 Test Loss: 0.703 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828118).  Saving model ...
Epoch: 24 cost time: 0.9704113006591797
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.695 Vali Acc: 0.831 Test Loss: 0.695 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831243).  Saving model ...
Epoch: 25 cost time: 1.0196187496185303
Epoch: 25, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.066779613494873
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.684 Vali Acc: 0.828 Test Loss: 0.684 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0068445205688477
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.001476764678955
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.678 Vali Acc: 0.825 Test Loss: 0.678 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9864292144775391
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.994227409362793
Epoch: 30, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0675570964813232
Epoch: 31, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9403634071350098
Epoch: 32, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9859347343444824
Epoch: 33, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1538059711456299
Epoch: 34, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 663610
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1472790241241455
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.062 Vali Acc: 0.169 Test Loss: 2.062 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 1.07088303565979
Epoch: 2, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.964 Vali Acc: 0.281 Test Loss: 1.964 Test Acc: 0.281
Validation loss decreased (-0.168729 --> -0.281230).  Saving model ...
Epoch: 3 cost time: 0.9507732391357422
Epoch: 3, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.830 Vali Acc: 0.403 Test Loss: 1.830 Test Acc: 0.403
Validation loss decreased (-0.281230 --> -0.403107).  Saving model ...
Epoch: 4 cost time: 1.2475700378417969
Epoch: 4, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.688 Vali Acc: 0.550 Test Loss: 1.688 Test Acc: 0.550
Validation loss decreased (-0.403107 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 1.2085590362548828
Epoch: 5, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.543 Vali Acc: 0.625 Test Loss: 1.543 Test Acc: 0.625
Validation loss decreased (-0.549983 --> -0.624985).  Saving model ...
Epoch: 6 cost time: 1.1251564025878906
Epoch: 6, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.400 Vali Acc: 0.719 Test Loss: 1.400 Test Acc: 0.719
Validation loss decreased (-0.624985 --> -0.718736).  Saving model ...
Epoch: 7 cost time: 1.1756293773651123
Epoch: 7, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.277 Vali Acc: 0.747 Test Loss: 1.277 Test Acc: 0.747
Validation loss decreased (-0.718736 --> -0.746862).  Saving model ...
Epoch: 8 cost time: 1.053144931793213
Epoch: 8, Steps: 8 | Train Loss: 0.914 Vali Loss: 1.169 Vali Acc: 0.762 Test Loss: 1.169 Test Acc: 0.762
Validation loss decreased (-0.746862 --> -0.762488).  Saving model ...
Epoch: 9 cost time: 1.026179552078247
Epoch: 9, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.080 Vali Acc: 0.772 Test Loss: 1.080 Test Acc: 0.772
Validation loss decreased (-0.762488 --> -0.771864).  Saving model ...
Epoch: 10 cost time: 1.0916755199432373
Epoch: 10, Steps: 8 | Train Loss: 0.677 Vali Loss: 1.006 Vali Acc: 0.772 Test Loss: 1.006 Test Acc: 0.772
Validation loss decreased (-0.771864 --> -0.771865).  Saving model ...
Epoch: 11 cost time: 1.3751752376556396
Epoch: 11, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.944 Vali Acc: 0.784 Test Loss: 0.944 Test Acc: 0.784
Validation loss decreased (-0.771865 --> -0.784366).  Saving model ...
Epoch: 12 cost time: 0.9656565189361572
Epoch: 12, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.896 Vali Acc: 0.787 Test Loss: 0.896 Test Acc: 0.787
Validation loss decreased (-0.784366 --> -0.787491).  Saving model ...
Epoch: 13 cost time: 1.101423978805542
Epoch: 13, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.857 Vali Acc: 0.794 Test Loss: 0.857 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793741).  Saving model ...
Epoch: 14 cost time: 1.0125517845153809
Epoch: 14, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.827 Vali Acc: 0.791 Test Loss: 0.827 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9815053939819336
Epoch: 15, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.801 Vali Acc: 0.803 Test Loss: 0.801 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803117).  Saving model ...
Epoch: 16 cost time: 1.2776362895965576
Epoch: 16, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0582497119903564
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.756 Vali Acc: 0.803 Test Loss: 0.756 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803117).  Saving model ...
Epoch: 18 cost time: 0.9356014728546143
Epoch: 18, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2910044193267822
Epoch: 19, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.725 Vali Acc: 0.797 Test Loss: 0.725 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0720713138580322
Epoch: 20, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.713 Vali Acc: 0.806 Test Loss: 0.713 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 21 cost time: 1.1327629089355469
Epoch: 21, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 22 cost time: 1.3582239151000977
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0152685642242432
Epoch: 23, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809368).  Saving model ...
Epoch: 24 cost time: 1.1627297401428223
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809368).  Saving model ...
Epoch: 25 cost time: 1.5532591342926025
Epoch: 25, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809368).  Saving model ...
Epoch: 26 cost time: 1.2079534530639648
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2346971035003662
Epoch: 27, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812493).  Saving model ...
Epoch: 28 cost time: 1.0424373149871826
Epoch: 28, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.16044282913208
Epoch: 29, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2919378280639648
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.655 Vali Acc: 0.809 Test Loss: 0.655 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1373841762542725
Epoch: 31, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0183765888214111
Epoch: 32, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.651 Vali Acc: 0.806 Test Loss: 0.651 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0197498798370361
Epoch: 33, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0433437824249268
Epoch: 34, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1394119262695312
Epoch: 35, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1318089962005615
Epoch: 36, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2775988578796387
Epoch: 37, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8125
model parameter : 660538
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0338995456695557
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.185 Vali Acc: 0.069 Test Loss: 2.185 Test Acc: 0.069
Validation loss decreased (inf --> -0.068728).  Saving model ...
Epoch: 2 cost time: 0.8728270530700684
Epoch: 2, Steps: 8 | Train Loss: 2.074 Vali Loss: 2.082 Vali Acc: 0.144 Test Loss: 2.082 Test Acc: 0.144
Validation loss decreased (-0.068728 --> -0.143729).  Saving model ...
Epoch: 3 cost time: 0.6910855770111084
Epoch: 3, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.938 Vali Acc: 0.247 Test Loss: 1.938 Test Acc: 0.247
Validation loss decreased (-0.143729 --> -0.246856).  Saving model ...
Epoch: 4 cost time: 0.7572345733642578
Epoch: 4, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.776 Vali Acc: 0.422 Test Loss: 1.776 Test Acc: 0.422
Validation loss decreased (-0.246856 --> -0.421857).  Saving model ...
Epoch: 5 cost time: 0.7386102676391602
Epoch: 5, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.618 Vali Acc: 0.578 Test Loss: 1.618 Test Acc: 0.578
Validation loss decreased (-0.421857 --> -0.578109).  Saving model ...
Epoch: 6 cost time: 0.8123226165771484
Epoch: 6, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.472 Vali Acc: 0.659 Test Loss: 1.472 Test Acc: 0.659
Validation loss decreased (-0.578109 --> -0.659360).  Saving model ...
Epoch: 7 cost time: 0.7922244071960449
Epoch: 7, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.343 Vali Acc: 0.675 Test Loss: 1.343 Test Acc: 0.675
Validation loss decreased (-0.659360 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 0.8353736400604248
Epoch: 8, Steps: 8 | Train Loss: 0.906 Vali Loss: 1.228 Vali Acc: 0.694 Test Loss: 1.228 Test Acc: 0.694
Validation loss decreased (-0.674987 --> -0.693738).  Saving model ...
Epoch: 9 cost time: 0.8505909442901611
Epoch: 9, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.135 Vali Acc: 0.713 Test Loss: 1.135 Test Acc: 0.713
Validation loss decreased (-0.693738 --> -0.712489).  Saving model ...
Epoch: 10 cost time: 0.9793593883514404
Epoch: 10, Steps: 8 | Train Loss: 0.671 Vali Loss: 1.060 Vali Acc: 0.728 Test Loss: 1.060 Test Acc: 0.728
Validation loss decreased (-0.712489 --> -0.728114).  Saving model ...
Epoch: 11 cost time: 0.7451446056365967
Epoch: 11, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.004 Vali Acc: 0.731 Test Loss: 1.004 Test Acc: 0.731
Validation loss decreased (-0.728114 --> -0.731240).  Saving model ...
Epoch: 12 cost time: 0.8569927215576172
Epoch: 12, Steps: 8 | Train Loss: 0.515 Vali Loss: 0.959 Vali Acc: 0.747 Test Loss: 0.959 Test Acc: 0.747
Validation loss decreased (-0.731240 --> -0.746865).  Saving model ...
Epoch: 13 cost time: 0.8680577278137207
Epoch: 13, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.746865 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7406892776489258
Epoch: 14, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.881 Vali Acc: 0.756 Test Loss: 0.881 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756241).  Saving model ...
Epoch: 15 cost time: 0.6947677135467529
Epoch: 15, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.854 Vali Acc: 0.762 Test Loss: 0.854 Test Acc: 0.762
Validation loss decreased (-0.756241 --> -0.762491).  Saving model ...
Epoch: 16 cost time: 0.828667402267456
Epoch: 16, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.833 Vali Acc: 0.759 Test Loss: 0.833 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9305334091186523
Epoch: 17, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.819 Vali Acc: 0.772 Test Loss: 0.819 Test Acc: 0.772
Validation loss decreased (-0.762491 --> -0.771867).  Saving model ...
Epoch: 18 cost time: 1.0513651371002197
Epoch: 18, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.799 Vali Acc: 0.778 Test Loss: 0.799 Test Acc: 0.778
Validation loss decreased (-0.771867 --> -0.778117).  Saving model ...
Epoch: 19 cost time: 0.7784061431884766
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.781 Vali Acc: 0.781 Test Loss: 0.781 Test Acc: 0.781
Validation loss decreased (-0.778117 --> -0.781242).  Saving model ...
Epoch: 20 cost time: 0.8394002914428711
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.773576021194458
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.755 Vali Acc: 0.766 Test Loss: 0.755 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9112100601196289
Epoch: 22, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.746 Vali Acc: 0.778 Test Loss: 0.746 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7412326335906982
Epoch: 23, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.739 Vali Acc: 0.781 Test Loss: 0.739 Test Acc: 0.781
Validation loss decreased (-0.781242 --> -0.781243).  Saving model ...
Epoch: 24 cost time: 0.6835527420043945
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.731 Vali Acc: 0.797 Test Loss: 0.731 Test Acc: 0.797
Validation loss decreased (-0.781243 --> -0.796868).  Saving model ...
Epoch: 25 cost time: 0.710599422454834
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.730 Vali Acc: 0.781 Test Loss: 0.730 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8189444541931152
Epoch: 26, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.721 Vali Acc: 0.778 Test Loss: 0.721 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8530831336975098
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.715 Vali Acc: 0.781 Test Loss: 0.715 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6358778476715088
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.714 Vali Acc: 0.772 Test Loss: 0.714 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8582134246826172
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8885500431060791
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.715 Vali Acc: 0.769 Test Loss: 0.715 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8919503688812256
Epoch: 31, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.709 Vali Acc: 0.781 Test Loss: 0.709 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9148895740509033
Epoch: 32, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.705 Vali Acc: 0.781 Test Loss: 0.705 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8174574375152588
Epoch: 33, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.699 Vali Acc: 0.781 Test Loss: 0.699 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7778780460357666
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.697 Vali Acc: 0.781 Test Loss: 0.697 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 657466
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.958045244216919
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.093 Vali Acc: 0.106 Test Loss: 2.093 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 0.7388193607330322
Epoch: 2, Steps: 8 | Train Loss: 2.038 Vali Loss: 1.983 Vali Acc: 0.181 Test Loss: 1.983 Test Acc: 0.181
Validation loss decreased (-0.106229 --> -0.181230).  Saving model ...
Epoch: 3 cost time: 0.7960445880889893
Epoch: 3, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.833 Vali Acc: 0.369 Test Loss: 1.833 Test Acc: 0.369
Validation loss decreased (-0.181230 --> -0.368732).  Saving model ...
Epoch: 4 cost time: 0.6118073463439941
Epoch: 4, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.678 Vali Acc: 0.553 Test Loss: 1.678 Test Acc: 0.553
Validation loss decreased (-0.368732 --> -0.553108).  Saving model ...
Epoch: 5 cost time: 0.6665372848510742
Epoch: 5, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.534 Vali Acc: 0.622 Test Loss: 1.534 Test Acc: 0.622
Validation loss decreased (-0.553108 --> -0.621860).  Saving model ...
Epoch: 6 cost time: 0.7473747730255127
Epoch: 6, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.397 Vali Acc: 0.672 Test Loss: 1.397 Test Acc: 0.672
Validation loss decreased (-0.621860 --> -0.671861).  Saving model ...
Epoch: 7 cost time: 0.9259686470031738
Epoch: 7, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.274 Vali Acc: 0.697 Test Loss: 1.274 Test Acc: 0.697
Validation loss decreased (-0.671861 --> -0.696862).  Saving model ...
Epoch: 8 cost time: 0.8295516967773438
Epoch: 8, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.162 Vali Acc: 0.709 Test Loss: 1.162 Test Acc: 0.709
Validation loss decreased (-0.696862 --> -0.709363).  Saving model ...
Epoch: 9 cost time: 0.6155829429626465
Epoch: 9, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.078 Vali Acc: 0.738 Test Loss: 1.078 Test Acc: 0.738
Validation loss decreased (-0.709363 --> -0.737489).  Saving model ...
Epoch: 10 cost time: 0.9208767414093018
Epoch: 10, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.003 Vali Acc: 0.747 Test Loss: 1.003 Test Acc: 0.747
Validation loss decreased (-0.737489 --> -0.746865).  Saving model ...
Epoch: 11 cost time: 0.7840402126312256
Epoch: 11, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.746865 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.6637659072875977
Epoch: 12, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.899 Vali Acc: 0.759 Test Loss: 0.899 Test Acc: 0.759
Validation loss decreased (-0.749991 --> -0.759366).  Saving model ...
Epoch: 13 cost time: 0.8579199314117432
Epoch: 13, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
Validation loss decreased (-0.759366 --> -0.771866).  Saving model ...
Epoch: 14 cost time: 0.7972867488861084
Epoch: 14, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.771866 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.8945193290710449
Epoch: 15, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
Validation loss decreased (-0.774992 --> -0.793742).  Saving model ...
Epoch: 16 cost time: 0.8794105052947998
Epoch: 16, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.887282133102417
Epoch: 17, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9105417728424072
Epoch: 18, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.745 Vali Acc: 0.781 Test Loss: 0.745 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7655084133148193
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.731 Vali Acc: 0.784 Test Loss: 0.731 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.837604284286499
Epoch: 20, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.720 Vali Acc: 0.784 Test Loss: 0.720 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.709597110748291
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.710 Vali Acc: 0.781 Test Loss: 0.710 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6474196910858154
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.700 Vali Acc: 0.784 Test Loss: 0.700 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7646148204803467
Epoch: 23, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.694 Vali Acc: 0.781 Test Loss: 0.694 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7524254322052002
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.689 Vali Acc: 0.787 Test Loss: 0.689 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9890773296356201
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.684 Vali Acc: 0.784 Test Loss: 0.684 Test Acc: 0.784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.79375
model parameter : 654394
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5833382606506348
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.038 Vali Acc: 0.206 Test Loss: 2.038 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 2.406153678894043
Epoch: 2, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.871 Vali Acc: 0.347 Test Loss: 1.871 Test Acc: 0.347
Validation loss decreased (-0.206230 --> -0.346856).  Saving model ...
Epoch: 3 cost time: 2.2617106437683105
Epoch: 3, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.676 Vali Acc: 0.484 Test Loss: 1.676 Test Acc: 0.484
Validation loss decreased (-0.346856 --> -0.484358).  Saving model ...
Epoch: 4 cost time: 1.8219647407531738
Epoch: 4, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.486 Vali Acc: 0.631 Test Loss: 1.486 Test Acc: 0.631
Validation loss decreased (-0.484358 --> -0.631235).  Saving model ...
Epoch: 5 cost time: 1.9093928337097168
Epoch: 5, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.334 Vali Acc: 0.688 Test Loss: 1.334 Test Acc: 0.688
Validation loss decreased (-0.631235 --> -0.687487).  Saving model ...
Epoch: 6 cost time: 1.8381261825561523
Epoch: 6, Steps: 8 | Train Loss: 0.890 Vali Loss: 1.227 Vali Acc: 0.719 Test Loss: 1.227 Test Acc: 0.719
Validation loss decreased (-0.687487 --> -0.718738).  Saving model ...
Epoch: 7 cost time: 2.364964485168457
Epoch: 7, Steps: 8 | Train Loss: 0.737 Vali Loss: 1.140 Vali Acc: 0.741 Test Loss: 1.140 Test Acc: 0.741
Validation loss decreased (-0.718738 --> -0.740614).  Saving model ...
Epoch: 8 cost time: 2.112783432006836
Epoch: 8, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.065 Vali Acc: 0.753 Test Loss: 1.065 Test Acc: 0.753
Validation loss decreased (-0.740614 --> -0.753114).  Saving model ...
Epoch: 9 cost time: 1.7560598850250244
Epoch: 9, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.998 Vali Acc: 0.756 Test Loss: 0.998 Test Acc: 0.756
Validation loss decreased (-0.753114 --> -0.756240).  Saving model ...
Epoch: 10 cost time: 1.874074935913086
Epoch: 10, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
Validation loss decreased (-0.756240 --> -0.756240).  Saving model ...
Epoch: 11 cost time: 1.903717279434204
Epoch: 11, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.925 Vali Acc: 0.741 Test Loss: 0.925 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1364033222198486
Epoch: 12, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.885 Vali Acc: 0.759 Test Loss: 0.885 Test Acc: 0.759
Validation loss decreased (-0.756240 --> -0.759366).  Saving model ...
Epoch: 13 cost time: 2.273385524749756
Epoch: 13, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.850 Vali Acc: 0.787 Test Loss: 0.850 Test Acc: 0.787
Validation loss decreased (-0.759366 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 1.9648590087890625
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.830 Vali Acc: 0.778 Test Loss: 0.830 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.070409059524536
Epoch: 15, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.809 Vali Acc: 0.781 Test Loss: 0.809 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7158281803131104
Epoch: 16, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.804 Vali Acc: 0.784 Test Loss: 0.804 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.274873971939087
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.801 Vali Acc: 0.787 Test Loss: 0.801 Test Acc: 0.787
Validation loss decreased (-0.787492 --> -0.787492).  Saving model ...
Epoch: 18 cost time: 2.0004422664642334
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8006982803344727
Epoch: 19, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.770 Vali Acc: 0.781 Test Loss: 0.770 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7913806438446045
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.787492 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 1.624953031539917
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.750 Vali Acc: 0.797 Test Loss: 0.750 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.038961887359619
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.751 Vali Acc: 0.787 Test Loss: 0.751 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.124387502670288
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.755 Vali Acc: 0.781 Test Loss: 0.755 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8882906436920166
Epoch: 24, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7534065246582031
Epoch: 25, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.755 Vali Acc: 0.784 Test Loss: 0.755 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1197891235351562
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1653740406036377
Epoch: 27, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.751 Vali Acc: 0.784 Test Loss: 0.751 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.350004196166992
Epoch: 28, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.749 Vali Acc: 0.794 Test Loss: 0.749 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0033750534057617
Epoch: 29, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 1.9470491409301758
Epoch: 30, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.740 Vali Acc: 0.797 Test Loss: 0.740 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0599238872528076
Epoch: 31, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.787 Test Loss: 0.738 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9267683029174805
Epoch: 32, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.740 Vali Acc: 0.784 Test Loss: 0.740 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.007772207260132
Epoch: 33, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.791 Test Loss: 0.740 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8039216995239258
Epoch: 34, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.1963083744049072
Epoch: 35, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.791 Test Loss: 0.741 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.2231969833374023
Epoch: 36, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.787 Test Loss: 0.743 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.2787671089172363
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.745 Vali Acc: 0.784 Test Loss: 0.745 Test Acc: 0.784
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.970808982849121
Epoch: 38, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.743 Vali Acc: 0.787 Test Loss: 0.743 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7862448692321777
Epoch: 39, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.791 Test Loss: 0.746 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8
model parameter : 694296
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.387269973754883
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.101 Vali Acc: 0.150 Test Loss: 2.101 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 1.7571320533752441
Epoch: 2, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.904 Vali Acc: 0.306 Test Loss: 1.904 Test Acc: 0.306
Validation loss decreased (-0.149979 --> -0.306231).  Saving model ...
Epoch: 3 cost time: 1.5690281391143799
Epoch: 3, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.687 Vali Acc: 0.512 Test Loss: 1.687 Test Acc: 0.512
Validation loss decreased (-0.306231 --> -0.512483).  Saving model ...
Epoch: 4 cost time: 1.6219685077667236
Epoch: 4, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.499 Vali Acc: 0.606 Test Loss: 1.499 Test Acc: 0.606
Validation loss decreased (-0.512483 --> -0.606235).  Saving model ...
Epoch: 5 cost time: 1.383965253829956
Epoch: 5, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.352 Vali Acc: 0.659 Test Loss: 1.352 Test Acc: 0.659
Validation loss decreased (-0.606235 --> -0.659361).  Saving model ...
Epoch: 6 cost time: 1.471238374710083
Epoch: 6, Steps: 8 | Train Loss: 0.883 Vali Loss: 1.245 Vali Acc: 0.659 Test Loss: 1.245 Test Acc: 0.659
Validation loss decreased (-0.659361 --> -0.659363).  Saving model ...
Epoch: 7 cost time: 1.7249219417572021
Epoch: 7, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.169 Vali Acc: 0.672 Test Loss: 1.169 Test Acc: 0.672
Validation loss decreased (-0.659363 --> -0.671863).  Saving model ...
Epoch: 8 cost time: 1.7154958248138428
Epoch: 8, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.103 Vali Acc: 0.672 Test Loss: 1.103 Test Acc: 0.672
Validation loss decreased (-0.671863 --> -0.671864).  Saving model ...
Epoch: 9 cost time: 1.6233649253845215
Epoch: 9, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.041 Vali Acc: 0.684 Test Loss: 1.041 Test Acc: 0.684
Validation loss decreased (-0.671864 --> -0.684365).  Saving model ...
Epoch: 10 cost time: 1.588616132736206
Epoch: 10, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.990 Vali Acc: 0.703 Test Loss: 0.990 Test Acc: 0.703
Validation loss decreased (-0.684365 --> -0.703115).  Saving model ...
Epoch: 11 cost time: 1.4466462135314941
Epoch: 11, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
Validation loss decreased (-0.703115 --> -0.721866).  Saving model ...
Epoch: 12 cost time: 1.47212815284729
Epoch: 12, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.896 Vali Acc: 0.728 Test Loss: 0.896 Test Acc: 0.728
Validation loss decreased (-0.721866 --> -0.728116).  Saving model ...
Epoch: 13 cost time: 1.7372193336486816
Epoch: 13, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.877 Vali Acc: 0.738 Test Loss: 0.877 Test Acc: 0.738
Validation loss decreased (-0.728116 --> -0.737491).  Saving model ...
Epoch: 14 cost time: 1.571082592010498
Epoch: 14, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.737491 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.5936450958251953
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.756242).  Saving model ...
Epoch: 16 cost time: 1.8624579906463623
Epoch: 16, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.792259931564331
Epoch: 17, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.809 Vali Acc: 0.747 Test Loss: 0.809 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.49229097366333
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.799 Vali Acc: 0.741 Test Loss: 0.799 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.580737590789795
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 20 cost time: 1.3815765380859375
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.779 Vali Acc: 0.753 Test Loss: 0.779 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7093768119812012
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.776 Vali Acc: 0.762 Test Loss: 0.776 Test Acc: 0.762
Validation loss decreased (-0.756242 --> -0.762492).  Saving model ...
Epoch: 22 cost time: 1.7367017269134521
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.383470058441162
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.770 Vali Acc: 0.753 Test Loss: 0.770 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.438744306564331
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.771 Vali Acc: 0.753 Test Loss: 0.771 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5028386116027832
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.769 Vali Acc: 0.753 Test Loss: 0.769 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.542208194732666
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.769 Vali Acc: 0.747 Test Loss: 0.769 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.45756196975708
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4119656085968018
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5093889236450195
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.765 Vali Acc: 0.753 Test Loss: 0.765 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3184723854064941
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3701863288879395
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7625
model parameter : 686104
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.954591989517212
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 2.031 Vali Acc: 0.197 Test Loss: 2.031 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 1.4829189777374268
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.850 Vali Acc: 0.356 Test Loss: 1.850 Test Acc: 0.356
Validation loss decreased (-0.196855 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 1.2096736431121826
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
Validation loss decreased (-0.356232 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 1.415935754776001
Epoch: 4, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.489 Vali Acc: 0.634 Test Loss: 1.489 Test Acc: 0.634
Validation loss decreased (-0.549983 --> -0.634360).  Saving model ...
Epoch: 5 cost time: 1.5674223899841309
Epoch: 5, Steps: 8 | Train Loss: 1.003 Vali Loss: 1.344 Vali Acc: 0.653 Test Loss: 1.344 Test Acc: 0.653
Validation loss decreased (-0.634360 --> -0.653112).  Saving model ...
Epoch: 6 cost time: 1.5943305492401123
Epoch: 6, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.221 Vali Acc: 0.678 Test Loss: 1.221 Test Acc: 0.678
Validation loss decreased (-0.653112 --> -0.678113).  Saving model ...
Epoch: 7 cost time: 1.574876308441162
Epoch: 7, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.135 Vali Acc: 0.697 Test Loss: 1.135 Test Acc: 0.697
Validation loss decreased (-0.678113 --> -0.696864).  Saving model ...
Epoch: 8 cost time: 1.454941987991333
Epoch: 8, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.069 Vali Acc: 0.706 Test Loss: 1.069 Test Acc: 0.706
Validation loss decreased (-0.696864 --> -0.706239).  Saving model ...
Epoch: 9 cost time: 1.198843240737915
Epoch: 9, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.706239 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 1.2161340713500977
Epoch: 10, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.957 Vali Acc: 0.719 Test Loss: 0.957 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.548907995223999
Epoch: 11, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.912 Vali Acc: 0.744 Test Loss: 0.912 Test Acc: 0.744
Validation loss decreased (-0.724990 --> -0.743741).  Saving model ...
Epoch: 12 cost time: 1.3554482460021973
Epoch: 12, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.875 Vali Acc: 0.753 Test Loss: 0.875 Test Acc: 0.753
Validation loss decreased (-0.743741 --> -0.753116).  Saving model ...
Epoch: 13 cost time: 1.2726056575775146
Epoch: 13, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.843 Vali Acc: 0.747 Test Loss: 0.843 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4124560356140137
Epoch: 14, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.822 Vali Acc: 0.753 Test Loss: 0.822 Test Acc: 0.753
Validation loss decreased (-0.753116 --> -0.753117).  Saving model ...
Epoch: 15 cost time: 1.471390724182129
Epoch: 15, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.803 Vali Acc: 0.762 Test Loss: 0.803 Test Acc: 0.762
Validation loss decreased (-0.753117 --> -0.762492).  Saving model ...
Epoch: 16 cost time: 1.614466905593872
Epoch: 16, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.788 Vali Acc: 0.766 Test Loss: 0.788 Test Acc: 0.766
Validation loss decreased (-0.762492 --> -0.765617).  Saving model ...
Epoch: 17 cost time: 1.2899775505065918
Epoch: 17, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2153959274291992
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.776 Vali Acc: 0.766 Test Loss: 0.776 Test Acc: 0.766
Validation loss decreased (-0.765617 --> -0.765617).  Saving model ...
Epoch: 19 cost time: 1.1687500476837158
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.343996286392212
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.760 Vali Acc: 0.759 Test Loss: 0.760 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4639899730682373
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.764 Vali Acc: 0.759 Test Loss: 0.764 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.354064702987671
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.765 Vali Acc: 0.753 Test Loss: 0.765 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3855865001678467
Epoch: 23, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.766 Vali Acc: 0.750 Test Loss: 0.766 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6312437057495117
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.763 Vali Acc: 0.753 Test Loss: 0.763 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4331095218658447
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.755 Vali Acc: 0.759 Test Loss: 0.755 Test Acc: 0.759
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.356245517730713
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.753 Vali Acc: 0.753 Test Loss: 0.753 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4983351230621338
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.385758399963379
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.748 Vali Acc: 0.759 Test Loss: 0.748 Test Acc: 0.759
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.765625
model parameter : 677912
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.797132968902588
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.068 Vali Acc: 0.191 Test Loss: 2.068 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 1.0326206684112549
Epoch: 2, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.902 Vali Acc: 0.331 Test Loss: 1.902 Test Acc: 0.331
Validation loss decreased (-0.190604 --> -0.331231).  Saving model ...
Epoch: 3 cost time: 1.1245732307434082
Epoch: 3, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.710 Vali Acc: 0.494 Test Loss: 1.710 Test Acc: 0.494
Validation loss decreased (-0.331231 --> -0.493733).  Saving model ...
Epoch: 4 cost time: 1.1108653545379639
Epoch: 4, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.534 Vali Acc: 0.566 Test Loss: 1.534 Test Acc: 0.566
Validation loss decreased (-0.493733 --> -0.565610).  Saving model ...
Epoch: 5 cost time: 0.9952445030212402
Epoch: 5, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.375 Vali Acc: 0.675 Test Loss: 1.375 Test Acc: 0.675
Validation loss decreased (-0.565610 --> -0.674986).  Saving model ...
Epoch: 6 cost time: 1.122560739517212
Epoch: 6, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.266 Vali Acc: 0.706 Test Loss: 1.266 Test Acc: 0.706
Validation loss decreased (-0.674986 --> -0.706237).  Saving model ...
Epoch: 7 cost time: 1.0673713684082031
Epoch: 7, Steps: 8 | Train Loss: 0.651 Vali Loss: 1.173 Vali Acc: 0.713 Test Loss: 1.173 Test Acc: 0.713
Validation loss decreased (-0.706237 --> -0.712488).  Saving model ...
Epoch: 8 cost time: 1.0570597648620605
Epoch: 8, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.110 Vali Acc: 0.703 Test Loss: 1.110 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0201871395111084
Epoch: 9, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.046 Vali Acc: 0.713 Test Loss: 1.046 Test Acc: 0.713
Validation loss decreased (-0.712488 --> -0.712490).  Saving model ...
Epoch: 10 cost time: 1.0951740741729736
Epoch: 10, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.999 Vali Acc: 0.719 Test Loss: 0.999 Test Acc: 0.719
Validation loss decreased (-0.712490 --> -0.718740).  Saving model ...
Epoch: 11 cost time: 0.9573845863342285
Epoch: 11, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
Validation loss decreased (-0.718740 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 1.0381324291229248
Epoch: 12, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.929 Vali Acc: 0.728 Test Loss: 0.929 Test Acc: 0.728
Validation loss decreased (-0.724990 --> -0.728116).  Saving model ...
Epoch: 13 cost time: 0.943828821182251
Epoch: 13, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0747771263122559
Epoch: 14, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.882 Vali Acc: 0.741 Test Loss: 0.882 Test Acc: 0.741
Validation loss decreased (-0.728116 --> -0.740616).  Saving model ...
Epoch: 15 cost time: 1.0475718975067139
Epoch: 15, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.868 Vali Acc: 0.734 Test Loss: 0.868 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9907641410827637
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.853 Vali Acc: 0.734 Test Loss: 0.853 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0418317317962646
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.843 Vali Acc: 0.744 Test Loss: 0.843 Test Acc: 0.744
Validation loss decreased (-0.740616 --> -0.743742).  Saving model ...
Epoch: 18 cost time: 0.9715776443481445
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.831 Vali Acc: 0.747 Test Loss: 0.831 Test Acc: 0.747
Validation loss decreased (-0.743742 --> -0.746867).  Saving model ...
Epoch: 19 cost time: 1.0067133903503418
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.828 Vali Acc: 0.734 Test Loss: 0.828 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9211218357086182
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.828 Vali Acc: 0.741 Test Loss: 0.828 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.971982479095459
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.828 Vali Acc: 0.734 Test Loss: 0.828 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9763579368591309
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.826 Vali Acc: 0.741 Test Loss: 0.826 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0359609127044678
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.823 Vali Acc: 0.741 Test Loss: 0.823 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9776690006256104
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.820 Vali Acc: 0.738 Test Loss: 0.820 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.063382863998413
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0234224796295166
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.824 Vali Acc: 0.734 Test Loss: 0.824 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0121769905090332
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.822 Vali Acc: 0.738 Test Loss: 0.822 Test Acc: 0.738
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0829172134399414
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.746875
model parameter : 669720
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.417389154434204
Epoch: 1, Steps: 8 | Train Loss: 2.042 Vali Loss: 2.013 Vali Acc: 0.178 Test Loss: 2.013 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.0540571212768555
Epoch: 2, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.832 Vali Acc: 0.353 Test Loss: 1.832 Test Acc: 0.353
Validation loss decreased (-0.178105 --> -0.353107).  Saving model ...
Epoch: 3 cost time: 0.8794777393341064
Epoch: 3, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.631 Vali Acc: 0.550 Test Loss: 1.631 Test Acc: 0.550
Validation loss decreased (-0.353107 --> -0.549984).  Saving model ...
Epoch: 4 cost time: 1.0295920372009277
Epoch: 4, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.454 Vali Acc: 0.666 Test Loss: 1.454 Test Acc: 0.666
Validation loss decreased (-0.549984 --> -0.665610).  Saving model ...
Epoch: 5 cost time: 0.8552987575531006
Epoch: 5, Steps: 8 | Train Loss: 0.961 Vali Loss: 1.316 Vali Acc: 0.713 Test Loss: 1.316 Test Acc: 0.713
Validation loss decreased (-0.665610 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 0.8709595203399658
Epoch: 6, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.219 Vali Acc: 0.694 Test Loss: 1.219 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0880563259124756
Epoch: 7, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.137 Vali Acc: 0.694 Test Loss: 1.137 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9229881763458252
Epoch: 8, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.060 Vali Acc: 0.709 Test Loss: 1.060 Test Acc: 0.709
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0023882389068604
Epoch: 9, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.009 Vali Acc: 0.728 Test Loss: 1.009 Test Acc: 0.728
Validation loss decreased (-0.712487 --> -0.728115).  Saving model ...
Epoch: 10 cost time: 1.0779752731323242
Epoch: 10, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.952 Vali Acc: 0.738 Test Loss: 0.952 Test Acc: 0.738
Validation loss decreased (-0.728115 --> -0.737490).  Saving model ...
Epoch: 11 cost time: 0.8280375003814697
Epoch: 11, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.912 Vali Acc: 0.747 Test Loss: 0.912 Test Acc: 0.747
Validation loss decreased (-0.737490 --> -0.746866).  Saving model ...
Epoch: 12 cost time: 0.8944151401519775
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.887 Vali Acc: 0.747 Test Loss: 0.887 Test Acc: 0.747
Validation loss decreased (-0.746866 --> -0.746866).  Saving model ...
Epoch: 13 cost time: 0.7964353561401367
Epoch: 13, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.865 Vali Acc: 0.728 Test Loss: 0.865 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1142499446868896
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.844 Vali Acc: 0.738 Test Loss: 0.844 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8348064422607422
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.822 Vali Acc: 0.756 Test Loss: 0.822 Test Acc: 0.756
Validation loss decreased (-0.746866 --> -0.756242).  Saving model ...
Epoch: 16 cost time: 0.8871397972106934
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.816 Vali Acc: 0.747 Test Loss: 0.816 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.757185697555542
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.816 Vali Acc: 0.741 Test Loss: 0.816 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8545668125152588
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8034248352050781
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.799 Vali Acc: 0.747 Test Loss: 0.799 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8636167049407959
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.802 Vali Acc: 0.744 Test Loss: 0.802 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7989871501922607
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9632384777069092
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9427700042724609
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8788092136383057
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 25 cost time: 0.9682435989379883
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0731048583984375
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.919769287109375
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.747 Test Loss: 0.802 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9045944213867188
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.801 Vali Acc: 0.747 Test Loss: 0.801 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.956451416015625
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9481723308563232
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9452428817749023
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2493724822998047
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2524785995483398
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.807 Vali Acc: 0.744 Test Loss: 0.807 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9727919101715088
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.806 Vali Acc: 0.741 Test Loss: 0.806 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75625
model parameter : 663576
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.133136749267578
Epoch: 1, Steps: 8 | Train Loss: 1.972 Vali Loss: 1.957 Vali Acc: 0.284 Test Loss: 1.957 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 0.8447794914245605
Epoch: 2, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.787 Vali Acc: 0.406 Test Loss: 1.787 Test Acc: 0.406
Validation loss decreased (-0.284355 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.8118288516998291
Epoch: 3, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.595 Vali Acc: 0.556 Test Loss: 1.595 Test Acc: 0.556
Validation loss decreased (-0.406232 --> -0.556234).  Saving model ...
Epoch: 4 cost time: 0.7656917572021484
Epoch: 4, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.428 Vali Acc: 0.628 Test Loss: 1.428 Test Acc: 0.628
Validation loss decreased (-0.556234 --> -0.628111).  Saving model ...
Epoch: 5 cost time: 0.7634649276733398
Epoch: 5, Steps: 8 | Train Loss: 0.936 Vali Loss: 1.293 Vali Acc: 0.653 Test Loss: 1.293 Test Acc: 0.653
Validation loss decreased (-0.628111 --> -0.653112).  Saving model ...
Epoch: 6 cost time: 0.9524385929107666
Epoch: 6, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.201 Vali Acc: 0.688 Test Loss: 1.201 Test Acc: 0.688
Validation loss decreased (-0.653112 --> -0.687488).  Saving model ...
Epoch: 7 cost time: 0.8004331588745117
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.130 Vali Acc: 0.703 Test Loss: 1.130 Test Acc: 0.703
Validation loss decreased (-0.687488 --> -0.703114).  Saving model ...
Epoch: 8 cost time: 0.9260947704315186
Epoch: 8, Steps: 8 | Train Loss: 0.460 Vali Loss: 1.057 Vali Acc: 0.709 Test Loss: 1.057 Test Acc: 0.709
Validation loss decreased (-0.703114 --> -0.709364).  Saving model ...
Epoch: 9 cost time: 0.822988748550415
Epoch: 9, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.995 Vali Acc: 0.731 Test Loss: 0.995 Test Acc: 0.731
Validation loss decreased (-0.709364 --> -0.731240).  Saving model ...
Epoch: 10 cost time: 0.7571706771850586
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.942 Vali Acc: 0.744 Test Loss: 0.942 Test Acc: 0.744
Validation loss decreased (-0.731240 --> -0.743741).  Saving model ...
Epoch: 11 cost time: 0.8188266754150391
Epoch: 11, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.902 Vali Acc: 0.741 Test Loss: 0.902 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9066746234893799
Epoch: 12, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.876 Vali Acc: 0.741 Test Loss: 0.876 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9184978008270264
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.743741 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.9383509159088135
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.838 Vali Acc: 0.738 Test Loss: 0.838 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9325375556945801
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8987634181976318
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.821 Vali Acc: 0.731 Test Loss: 0.821 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8706448078155518
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8548641204833984
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0293447971343994
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.804 Vali Acc: 0.722 Test Loss: 0.804 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0322437286376953
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.805 Vali Acc: 0.725 Test Loss: 0.805 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8930642604827881
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.807 Vali Acc: 0.728 Test Loss: 0.807 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9045915603637695
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.972508430480957
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75
model parameter : 660504
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6539087295532227
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 2.087 Vali Acc: 0.156 Test Loss: 2.087 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.7032263278961182
Epoch: 2, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.910 Vali Acc: 0.278 Test Loss: 1.910 Test Acc: 0.278
Validation loss decreased (-0.156229 --> -0.278106).  Saving model ...
Epoch: 3 cost time: 0.7024130821228027
Epoch: 3, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.711 Vali Acc: 0.459 Test Loss: 1.711 Test Acc: 0.459
Validation loss decreased (-0.278106 --> -0.459358).  Saving model ...
Epoch: 4 cost time: 0.7853090763092041
Epoch: 4, Steps: 8 | Train Loss: 1.260 Vali Loss: 1.524 Vali Acc: 0.600 Test Loss: 1.524 Test Acc: 0.600
Validation loss decreased (-0.459358 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 0.9055361747741699
Epoch: 5, Steps: 8 | Train Loss: 0.948 Vali Loss: 1.374 Vali Acc: 0.641 Test Loss: 1.374 Test Acc: 0.641
Validation loss decreased (-0.599985 --> -0.640611).  Saving model ...
Epoch: 6 cost time: 0.6930820941925049
Epoch: 6, Steps: 8 | Train Loss: 0.772 Vali Loss: 1.254 Vali Acc: 0.681 Test Loss: 1.254 Test Acc: 0.681
Validation loss decreased (-0.640611 --> -0.681237).  Saving model ...
Epoch: 7 cost time: 0.7373361587524414
Epoch: 7, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.151 Vali Acc: 0.694 Test Loss: 1.151 Test Acc: 0.694
Validation loss decreased (-0.681237 --> -0.693738).  Saving model ...
Epoch: 8 cost time: 0.6154520511627197
Epoch: 8, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.078 Vali Acc: 0.691 Test Loss: 1.078 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7494776248931885
Epoch: 9, Steps: 8 | Train Loss: 0.350 Vali Loss: 1.021 Vali Acc: 0.713 Test Loss: 1.021 Test Acc: 0.713
Validation loss decreased (-0.693738 --> -0.712490).  Saving model ...
Epoch: 10 cost time: 0.8295586109161377
Epoch: 10, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.946028470993042
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.933 Vali Acc: 0.716 Test Loss: 0.933 Test Acc: 0.716
Validation loss decreased (-0.712490 --> -0.715616).  Saving model ...
Epoch: 12 cost time: 0.7060179710388184
Epoch: 12, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.905 Vali Acc: 0.722 Test Loss: 0.905 Test Acc: 0.722
Validation loss decreased (-0.715616 --> -0.721866).  Saving model ...
Epoch: 13 cost time: 0.7101149559020996
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.721866 --> -0.728116).  Saving model ...
Epoch: 14 cost time: 0.7200949192047119
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.856 Vali Acc: 0.709 Test Loss: 0.856 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6719257831573486
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6526293754577637
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7238829135894775
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6655330657958984
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7876694202423096
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.829 Vali Acc: 0.719 Test Loss: 0.829 Test Acc: 0.719
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7089650630950928
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6797335147857666
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.828 Vali Acc: 0.725 Test Loss: 0.828 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7271873950958252
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.825 Vali Acc: 0.722 Test Loss: 0.825 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9935688972473145
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.728125
model parameter : 657432
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1033663749694824
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.047 Vali Acc: 0.169 Test Loss: 2.047 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.6205489635467529
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.829 Vali Acc: 0.397 Test Loss: 1.829 Test Acc: 0.397
Validation loss decreased (-0.168730 --> -0.396857).  Saving model ...
Epoch: 3 cost time: 0.7096781730651855
Epoch: 3, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.614 Vali Acc: 0.547 Test Loss: 1.614 Test Acc: 0.547
Validation loss decreased (-0.396857 --> -0.546859).  Saving model ...
Epoch: 4 cost time: 0.6323413848876953
Epoch: 4, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.418 Vali Acc: 0.613 Test Loss: 1.418 Test Acc: 0.613
Validation loss decreased (-0.546859 --> -0.612486).  Saving model ...
Epoch: 5 cost time: 0.5334289073944092
Epoch: 5, Steps: 8 | Train Loss: 0.908 Vali Loss: 1.265 Vali Acc: 0.650 Test Loss: 1.265 Test Acc: 0.650
Validation loss decreased (-0.612486 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 0.6562447547912598
Epoch: 6, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.154 Vali Acc: 0.688 Test Loss: 1.154 Test Acc: 0.688
Validation loss decreased (-0.649987 --> -0.687488).  Saving model ...
Epoch: 7 cost time: 0.5756287574768066
Epoch: 7, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.067 Vali Acc: 0.703 Test Loss: 1.067 Test Acc: 0.703
Validation loss decreased (-0.687488 --> -0.703114).  Saving model ...
Epoch: 8 cost time: 0.5772466659545898
Epoch: 8, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.006 Vali Acc: 0.713 Test Loss: 1.006 Test Acc: 0.713
Validation loss decreased (-0.703114 --> -0.712490).  Saving model ...
Epoch: 9 cost time: 0.5439929962158203
Epoch: 9, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.950 Vali Acc: 0.716 Test Loss: 0.950 Test Acc: 0.716
Validation loss decreased (-0.712490 --> -0.715616).  Saving model ...
Epoch: 10 cost time: 0.7034022808074951
Epoch: 10, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.918 Vali Acc: 0.706 Test Loss: 0.918 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5847320556640625
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.895 Vali Acc: 0.719 Test Loss: 0.895 Test Acc: 0.719
Validation loss decreased (-0.715616 --> -0.718741).  Saving model ...
Epoch: 12 cost time: 0.6951608657836914
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.868 Vali Acc: 0.725 Test Loss: 0.868 Test Acc: 0.725
Validation loss decreased (-0.718741 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.6341960430145264
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.855 Vali Acc: 0.731 Test Loss: 0.855 Test Acc: 0.731
Validation loss decreased (-0.724991 --> -0.731241).  Saving model ...
Epoch: 14 cost time: 0.548987627029419
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.845 Vali Acc: 0.738 Test Loss: 0.845 Test Acc: 0.738
Validation loss decreased (-0.731241 --> -0.737492).  Saving model ...
Epoch: 15 cost time: 0.7668933868408203
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.842 Vali Acc: 0.738 Test Loss: 0.842 Test Acc: 0.738
Validation loss decreased (-0.737492 --> -0.737492).  Saving model ...
Epoch: 16 cost time: 0.6430501937866211
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.713402509689331
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.836 Vali Acc: 0.703 Test Loss: 0.836 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5975992679595947
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.838 Vali Acc: 0.713 Test Loss: 0.838 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6364004611968994
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.841 Vali Acc: 0.716 Test Loss: 0.841 Test Acc: 0.716
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7305800914764404
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.843 Vali Acc: 0.719 Test Loss: 0.843 Test Acc: 0.719
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7651441097259521
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.846 Vali Acc: 0.713 Test Loss: 0.846 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5947339534759521
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.848 Vali Acc: 0.716 Test Loss: 0.848 Test Acc: 0.716
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5739486217498779
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.849 Vali Acc: 0.716 Test Loss: 0.849 Test Acc: 0.716
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6323888301849365
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.851 Vali Acc: 0.719 Test Loss: 0.851 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5557634830474854
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.853 Vali Acc: 0.716 Test Loss: 0.853 Test Acc: 0.716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7375
model parameter : 654360
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.904078960418701
Epoch: 1, Steps: 8 | Train Loss: 2.257 Vali Loss: 2.205 Vali Acc: 0.122 Test Loss: 2.205 Test Acc: 0.122
Validation loss decreased (inf --> -0.121853).  Saving model ...
Epoch: 2 cost time: 1.633068561553955
Epoch: 2, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.143 Vali Acc: 0.153 Test Loss: 2.143 Test Acc: 0.153
Validation loss decreased (-0.121853 --> -0.153104).  Saving model ...
Epoch: 3 cost time: 1.847710371017456
Epoch: 3, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.058 Vali Acc: 0.184 Test Loss: 2.058 Test Acc: 0.184
Validation loss decreased (-0.153104 --> -0.184354).  Saving model ...
Epoch: 4 cost time: 1.841020107269287
Epoch: 4, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.961 Vali Acc: 0.253 Test Loss: 1.961 Test Acc: 0.253
Validation loss decreased (-0.184354 --> -0.253105).  Saving model ...
Epoch: 5 cost time: 1.7770986557006836
Epoch: 5, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.859 Vali Acc: 0.397 Test Loss: 1.859 Test Acc: 0.397
Validation loss decreased (-0.253105 --> -0.396856).  Saving model ...
Epoch: 6 cost time: 1.8042149543762207
Epoch: 6, Steps: 8 | Train Loss: 1.717 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
Validation loss decreased (-0.396856 --> -0.499982).  Saving model ...
Epoch: 7 cost time: 2.103410482406616
Epoch: 7, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.662 Vali Acc: 0.572 Test Loss: 1.662 Test Acc: 0.572
Validation loss decreased (-0.499982 --> -0.571858).  Saving model ...
Epoch: 8 cost time: 1.766716718673706
Epoch: 8, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.566 Vali Acc: 0.613 Test Loss: 1.566 Test Acc: 0.613
Validation loss decreased (-0.571858 --> -0.612484).  Saving model ...
Epoch: 9 cost time: 1.6764030456542969
Epoch: 9, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.476 Vali Acc: 0.628 Test Loss: 1.476 Test Acc: 0.628
Validation loss decreased (-0.612484 --> -0.628110).  Saving model ...
Epoch: 10 cost time: 2.049257516860962
Epoch: 10, Steps: 8 | Train Loss: 1.166 Vali Loss: 1.392 Vali Acc: 0.641 Test Loss: 1.392 Test Acc: 0.641
Validation loss decreased (-0.628110 --> -0.640611).  Saving model ...
Epoch: 11 cost time: 1.794111728668213
Epoch: 11, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.318 Vali Acc: 0.653 Test Loss: 1.318 Test Acc: 0.653
Validation loss decreased (-0.640611 --> -0.653112).  Saving model ...
Epoch: 12 cost time: 2.070986270904541
Epoch: 12, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.250 Vali Acc: 0.662 Test Loss: 1.250 Test Acc: 0.662
Validation loss decreased (-0.653112 --> -0.662488).  Saving model ...
Epoch: 13 cost time: 1.695631504058838
Epoch: 13, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.185 Vali Acc: 0.672 Test Loss: 1.185 Test Acc: 0.672
Validation loss decreased (-0.662488 --> -0.671863).  Saving model ...
Epoch: 14 cost time: 1.893749713897705
Epoch: 14, Steps: 8 | Train Loss: 0.748 Vali Loss: 1.132 Vali Acc: 0.678 Test Loss: 1.132 Test Acc: 0.678
Validation loss decreased (-0.671863 --> -0.678114).  Saving model ...
Epoch: 15 cost time: 2.018673896789551
Epoch: 15, Steps: 8 | Train Loss: 0.654 Vali Loss: 1.089 Vali Acc: 0.678 Test Loss: 1.089 Test Acc: 0.678
Validation loss decreased (-0.678114 --> -0.678114).  Saving model ...
Epoch: 16 cost time: 1.7653677463531494
Epoch: 16, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.048 Vali Acc: 0.681 Test Loss: 1.048 Test Acc: 0.681
Validation loss decreased (-0.678114 --> -0.681240).  Saving model ...
Epoch: 17 cost time: 1.759868860244751
Epoch: 17, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.681240 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.7154767513275146
Epoch: 18, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.985 Vali Acc: 0.691 Test Loss: 0.985 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7521922588348389
Epoch: 19, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.957 Vali Acc: 0.709 Test Loss: 0.957 Test Acc: 0.709
Validation loss decreased (-0.699990 --> -0.709365).  Saving model ...
Epoch: 20 cost time: 1.7764801979064941
Epoch: 20, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.936 Vali Acc: 0.716 Test Loss: 0.936 Test Acc: 0.716
Validation loss decreased (-0.709365 --> -0.715616).  Saving model ...
Epoch: 21 cost time: 1.6022241115570068
Epoch: 21, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.919 Vali Acc: 0.719 Test Loss: 0.919 Test Acc: 0.719
Validation loss decreased (-0.715616 --> -0.718741).  Saving model ...
Epoch: 22 cost time: 1.6701698303222656
Epoch: 22, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.905 Vali Acc: 0.719 Test Loss: 0.905 Test Acc: 0.719
Validation loss decreased (-0.718741 --> -0.718741).  Saving model ...
Epoch: 23 cost time: 1.6513586044311523
Epoch: 23, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.893 Vali Acc: 0.722 Test Loss: 0.893 Test Acc: 0.722
Validation loss decreased (-0.718741 --> -0.721866).  Saving model ...
Epoch: 24 cost time: 1.6608870029449463
Epoch: 24, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
Validation loss decreased (-0.721866 --> -0.721866).  Saving model ...
Epoch: 25 cost time: 1.8278045654296875
Epoch: 25, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.870 Vali Acc: 0.731 Test Loss: 0.870 Test Acc: 0.731
Validation loss decreased (-0.721866 --> -0.731241).  Saving model ...
Epoch: 26 cost time: 1.895096778869629
Epoch: 26, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.860 Vali Acc: 0.731 Test Loss: 0.860 Test Acc: 0.731
Validation loss decreased (-0.731241 --> -0.731241).  Saving model ...
Epoch: 27 cost time: 1.935349702835083
Epoch: 27, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.853 Vali Acc: 0.722 Test Loss: 0.853 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7089922428131104
Epoch: 28, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.847 Vali Acc: 0.722 Test Loss: 0.847 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6936521530151367
Epoch: 29, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.840 Vali Acc: 0.731 Test Loss: 0.840 Test Acc: 0.731
Validation loss decreased (-0.731241 --> -0.731242).  Saving model ...
Epoch: 30 cost time: 2.0459792613983154
Epoch: 30, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.833 Vali Acc: 0.738 Test Loss: 0.833 Test Acc: 0.738
Validation loss decreased (-0.731242 --> -0.737492).  Saving model ...
Epoch: 31 cost time: 1.658508539199829
Epoch: 31, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.827 Vali Acc: 0.741 Test Loss: 0.827 Test Acc: 0.741
Validation loss decreased (-0.737492 --> -0.740617).  Saving model ...
Epoch: 32 cost time: 1.849041223526001
Epoch: 32, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.823 Vali Acc: 0.738 Test Loss: 0.823 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7740285396575928
Epoch: 33, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
Validation loss decreased (-0.740617 --> -0.740617).  Saving model ...
Epoch: 34 cost time: 1.8367235660552979
Epoch: 34, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.818 Vali Acc: 0.741 Test Loss: 0.818 Test Acc: 0.741
Validation loss decreased (-0.740617 --> -0.740617).  Saving model ...
Epoch: 35 cost time: 1.6825079917907715
Epoch: 35, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.819 Vali Acc: 0.744 Test Loss: 0.819 Test Acc: 0.744
Validation loss decreased (-0.740617 --> -0.743742).  Saving model ...
Epoch: 36 cost time: 1.849264144897461
Epoch: 36, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.819 Vali Acc: 0.747 Test Loss: 0.819 Test Acc: 0.747
Validation loss decreased (-0.743742 --> -0.746867).  Saving model ...
Epoch: 37 cost time: 1.6070151329040527
Epoch: 37, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.819 Vali Acc: 0.747 Test Loss: 0.819 Test Acc: 0.747
Validation loss decreased (-0.746867 --> -0.746867).  Saving model ...
Epoch: 38 cost time: 1.643714189529419
Epoch: 38, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.746867 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 1.7637195587158203
Epoch: 39, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 1.8856961727142334
Epoch: 40, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 1.794858455657959
Epoch: 41, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6986088752746582
Epoch: 42, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.812 Vali Acc: 0.753 Test Loss: 0.812 Test Acc: 0.753
Validation loss decreased (-0.749992 --> -0.753117).  Saving model ...
Epoch: 43 cost time: 1.6544296741485596
Epoch: 43, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.811 Vali Acc: 0.753 Test Loss: 0.811 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 44 cost time: 1.9588515758514404
Epoch: 44, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.812 Vali Acc: 0.753 Test Loss: 0.812 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.0191354751586914
Epoch: 45, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.992781162261963
Epoch: 46, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.813 Vali Acc: 0.753 Test Loss: 0.813 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.2708990573883057
Epoch: 47, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.813 Vali Acc: 0.753 Test Loss: 0.813 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.968317985534668
Epoch: 48, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.814 Vali Acc: 0.753 Test Loss: 0.814 Test Acc: 0.753
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.9534964561462402
Epoch: 49, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.1832211017608643
Epoch: 50, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.813 Vali Acc: 0.753 Test Loss: 0.813 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.974562406539917
Epoch: 51, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.814 Vali Acc: 0.756 Test Loss: 0.814 Test Acc: 0.756
Validation loss decreased (-0.753117 --> -0.756242).  Saving model ...
Epoch: 52 cost time: 1.9607608318328857
Epoch: 52, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 53 cost time: 1.9286177158355713
Epoch: 53, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.812 Vali Acc: 0.753 Test Loss: 0.812 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.1378462314605713
Epoch: 54, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.814 Vali Acc: 0.753 Test Loss: 0.814 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.205916404724121
Epoch: 55, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.7236838340759277
Epoch: 56, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.211566686630249
Epoch: 57, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.9854693412780762
Epoch: 58, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.815 Vali Acc: 0.759 Test Loss: 0.815 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 59 cost time: 2.0751733779907227
Epoch: 59, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8478147983551025
Epoch: 60, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.8425548076629639
Epoch: 61, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.756 Test Loss: 0.817 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.9106857776641846
Epoch: 62, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.818 Vali Acc: 0.756 Test Loss: 0.818 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.8229577541351318
Epoch: 63, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.819 Vali Acc: 0.759 Test Loss: 0.819 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.2306087017059326
Epoch: 64, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.817 Vali Acc: 0.759 Test Loss: 0.817 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 2.358905553817749
Epoch: 65, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.818 Vali Acc: 0.759 Test Loss: 0.818 Test Acc: 0.759
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 2.1598148345947266
Epoch: 66, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.819 Vali Acc: 0.762 Test Loss: 0.819 Test Acc: 0.762
Validation loss decreased (-0.759367 --> -0.762492).  Saving model ...
Epoch: 67 cost time: 1.9626951217651367
Epoch: 67, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.821 Vali Acc: 0.759 Test Loss: 0.821 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.0197408199310303
Epoch: 68, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.821 Vali Acc: 0.759 Test Loss: 0.821 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.8427817821502686
Epoch: 69, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.822 Vali Acc: 0.759 Test Loss: 0.822 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.12900710105896
Epoch: 70, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.824 Vali Acc: 0.759 Test Loss: 0.824 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.18819260597229
Epoch: 71, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.824 Vali Acc: 0.759 Test Loss: 0.824 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.9823036193847656
Epoch: 72, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.824 Vali Acc: 0.762 Test Loss: 0.824 Test Acc: 0.762
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.0195980072021484
Epoch: 73, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.825 Vali Acc: 0.762 Test Loss: 0.825 Test Acc: 0.762
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.2950592041015625
Epoch: 74, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.762 Test Loss: 0.826 Test Acc: 0.762
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.753000259399414
Epoch: 75, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.828 Vali Acc: 0.762 Test Loss: 0.828 Test Acc: 0.762
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.8883109092712402
Epoch: 76, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.828 Vali Acc: 0.762 Test Loss: 0.828 Test Acc: 0.762
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7625
model parameter : 351290
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.07712459564209
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.124 Vali Acc: 0.138 Test Loss: 2.124 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 1.4633018970489502
Epoch: 2, Steps: 8 | Train Loss: 2.091 Vali Loss: 2.055 Vali Acc: 0.191 Test Loss: 2.055 Test Acc: 0.191
Validation loss decreased (-0.137479 --> -0.190604).  Saving model ...
Epoch: 3 cost time: 1.4170501232147217
Epoch: 3, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.959 Vali Acc: 0.263 Test Loss: 1.959 Test Acc: 0.263
Validation loss decreased (-0.190604 --> -0.262480).  Saving model ...
Epoch: 4 cost time: 1.515836477279663
Epoch: 4, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.850 Vali Acc: 0.359 Test Loss: 1.850 Test Acc: 0.359
Validation loss decreased (-0.262480 --> -0.359356).  Saving model ...
Epoch: 5 cost time: 1.5089457035064697
Epoch: 5, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.728 Vali Acc: 0.469 Test Loss: 1.728 Test Acc: 0.469
Validation loss decreased (-0.359356 --> -0.468733).  Saving model ...
Epoch: 6 cost time: 1.549785852432251
Epoch: 6, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.606 Vali Acc: 0.572 Test Loss: 1.606 Test Acc: 0.572
Validation loss decreased (-0.468733 --> -0.571859).  Saving model ...
Epoch: 7 cost time: 1.4272708892822266
Epoch: 7, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.489 Vali Acc: 0.666 Test Loss: 1.489 Test Acc: 0.666
Validation loss decreased (-0.571859 --> -0.665610).  Saving model ...
Epoch: 8 cost time: 1.4315357208251953
Epoch: 8, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.381 Vali Acc: 0.706 Test Loss: 1.381 Test Acc: 0.706
Validation loss decreased (-0.665610 --> -0.706236).  Saving model ...
Epoch: 9 cost time: 1.5157370567321777
Epoch: 9, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.279 Vali Acc: 0.744 Test Loss: 1.279 Test Acc: 0.744
Validation loss decreased (-0.706236 --> -0.743737).  Saving model ...
Epoch: 10 cost time: 1.6977887153625488
Epoch: 10, Steps: 8 | Train Loss: 0.916 Vali Loss: 1.192 Vali Acc: 0.762 Test Loss: 1.192 Test Acc: 0.762
Validation loss decreased (-0.743737 --> -0.762488).  Saving model ...
Epoch: 11 cost time: 1.6388914585113525
Epoch: 11, Steps: 8 | Train Loss: 0.792 Vali Loss: 1.118 Vali Acc: 0.772 Test Loss: 1.118 Test Acc: 0.772
Validation loss decreased (-0.762488 --> -0.771864).  Saving model ...
Epoch: 12 cost time: 1.493154764175415
Epoch: 12, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.054 Vali Acc: 0.769 Test Loss: 1.054 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6971216201782227
Epoch: 13, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.002 Vali Acc: 0.766 Test Loss: 1.002 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7200849056243896
Epoch: 14, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.961 Vali Acc: 0.762 Test Loss: 0.961 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.842710018157959
Epoch: 15, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.922 Vali Acc: 0.772 Test Loss: 0.922 Test Acc: 0.772
Validation loss decreased (-0.771864 --> -0.771866).  Saving model ...
Epoch: 16 cost time: 1.5781950950622559
Epoch: 16, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.892 Vali Acc: 0.781 Test Loss: 0.892 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781241).  Saving model ...
Epoch: 17 cost time: 1.7624456882476807
Epoch: 17, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7640454769134521
Epoch: 18, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.847 Vali Acc: 0.791 Test Loss: 0.847 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790617).  Saving model ...
Epoch: 19 cost time: 1.596275806427002
Epoch: 19, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.829 Vali Acc: 0.794 Test Loss: 0.829 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793742).  Saving model ...
Epoch: 20 cost time: 1.4957871437072754
Epoch: 20, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.815 Vali Acc: 0.781 Test Loss: 0.815 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.718435525894165
Epoch: 21, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.800 Vali Acc: 0.787 Test Loss: 0.800 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8256926536560059
Epoch: 22, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.786 Vali Acc: 0.787 Test Loss: 0.786 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5582859516143799
Epoch: 23, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.773 Vali Acc: 0.791 Test Loss: 0.773 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6844654083251953
Epoch: 24, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.766 Vali Acc: 0.791 Test Loss: 0.766 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5323255062103271
Epoch: 25, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.759 Vali Acc: 0.787 Test Loss: 0.759 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5471417903900146
Epoch: 26, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.752 Vali Acc: 0.781 Test Loss: 0.752 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8562495708465576
Epoch: 27, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.746 Vali Acc: 0.787 Test Loss: 0.746 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8064873218536377
Epoch: 28, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.739 Vali Acc: 0.797 Test Loss: 0.739 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796868).  Saving model ...
Epoch: 29 cost time: 1.9691176414489746
Epoch: 29, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.734 Vali Acc: 0.791 Test Loss: 0.734 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.723703145980835
Epoch: 30, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.729 Vali Acc: 0.787 Test Loss: 0.729 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0272204875946045
Epoch: 31, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.726 Vali Acc: 0.787 Test Loss: 0.726 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5929319858551025
Epoch: 32, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.721 Vali Acc: 0.791 Test Loss: 0.721 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7533650398254395
Epoch: 33, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.719 Vali Acc: 0.781 Test Loss: 0.719 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4719982147216797
Epoch: 34, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.716 Vali Acc: 0.784 Test Loss: 0.716 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4577052593231201
Epoch: 35, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.715 Vali Acc: 0.787 Test Loss: 0.715 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4532122611999512
Epoch: 36, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.711 Vali Acc: 0.781 Test Loss: 0.711 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5423593521118164
Epoch: 37, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.709 Vali Acc: 0.778 Test Loss: 0.709 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6446545124053955
Epoch: 38, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.707 Vali Acc: 0.787 Test Loss: 0.707 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 347194
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8009555339813232
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.111 Vali Acc: 0.134 Test Loss: 2.111 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.2198224067687988
Epoch: 2, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.035 Vali Acc: 0.172 Test Loss: 2.035 Test Acc: 0.172
Validation loss decreased (-0.134354 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 1.1986126899719238
Epoch: 3, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.934 Vali Acc: 0.241 Test Loss: 1.934 Test Acc: 0.241
Validation loss decreased (-0.171855 --> -0.240606).  Saving model ...
Epoch: 4 cost time: 1.1707086563110352
Epoch: 4, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.820 Vali Acc: 0.412 Test Loss: 1.820 Test Acc: 0.412
Validation loss decreased (-0.240606 --> -0.412482).  Saving model ...
Epoch: 5 cost time: 1.1883718967437744
Epoch: 5, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.704 Vali Acc: 0.566 Test Loss: 1.704 Test Acc: 0.566
Validation loss decreased (-0.412482 --> -0.565608).  Saving model ...
Epoch: 6 cost time: 1.1559646129608154
Epoch: 6, Steps: 8 | Train Loss: 1.507 Vali Loss: 1.590 Vali Acc: 0.653 Test Loss: 1.590 Test Acc: 0.653
Validation loss decreased (-0.565608 --> -0.653109).  Saving model ...
Epoch: 7 cost time: 1.2310411930084229
Epoch: 7, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.478 Vali Acc: 0.700 Test Loss: 1.478 Test Acc: 0.700
Validation loss decreased (-0.653109 --> -0.699985).  Saving model ...
Epoch: 8 cost time: 1.3746614456176758
Epoch: 8, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.374 Vali Acc: 0.722 Test Loss: 1.374 Test Acc: 0.722
Validation loss decreased (-0.699985 --> -0.721861).  Saving model ...
Epoch: 9 cost time: 1.1674225330352783
Epoch: 9, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.277 Vali Acc: 0.750 Test Loss: 1.277 Test Acc: 0.750
Validation loss decreased (-0.721861 --> -0.749987).  Saving model ...
Epoch: 10 cost time: 1.4270401000976562
Epoch: 10, Steps: 8 | Train Loss: 0.978 Vali Loss: 1.189 Vali Acc: 0.759 Test Loss: 1.189 Test Acc: 0.759
Validation loss decreased (-0.749987 --> -0.759363).  Saving model ...
Epoch: 11 cost time: 1.445061445236206
Epoch: 11, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.114 Vali Acc: 0.775 Test Loss: 1.114 Test Acc: 0.775
Validation loss decreased (-0.759363 --> -0.774989).  Saving model ...
Epoch: 12 cost time: 1.1575820446014404
Epoch: 12, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.050 Vali Acc: 0.775 Test Loss: 1.050 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 1.2023587226867676
Epoch: 13, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.995 Vali Acc: 0.781 Test Loss: 0.995 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781240).  Saving model ...
Epoch: 14 cost time: 1.1561367511749268
Epoch: 14, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.949 Vali Acc: 0.778 Test Loss: 0.949 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1824920177459717
Epoch: 15, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.913 Vali Acc: 0.791 Test Loss: 0.913 Test Acc: 0.791
Validation loss decreased (-0.781240 --> -0.790616).  Saving model ...
Epoch: 16 cost time: 1.4308967590332031
Epoch: 16, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.881 Vali Acc: 0.791 Test Loss: 0.881 Test Acc: 0.791
Validation loss decreased (-0.790616 --> -0.790616).  Saving model ...
Epoch: 17 cost time: 1.2256159782409668
Epoch: 17, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.854 Vali Acc: 0.791 Test Loss: 0.854 Test Acc: 0.791
Validation loss decreased (-0.790616 --> -0.790616).  Saving model ...
Epoch: 18 cost time: 1.252347469329834
Epoch: 18, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.827 Vali Acc: 0.784 Test Loss: 0.827 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2427480220794678
Epoch: 19, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.809 Vali Acc: 0.784 Test Loss: 0.809 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3358447551727295
Epoch: 20, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.793 Vali Acc: 0.791 Test Loss: 0.793 Test Acc: 0.791
Validation loss decreased (-0.790616 --> -0.790617).  Saving model ...
Epoch: 21 cost time: 1.1412687301635742
Epoch: 21, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.779 Vali Acc: 0.787 Test Loss: 0.779 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2144238948822021
Epoch: 22, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.765 Vali Acc: 0.787 Test Loss: 0.765 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2447025775909424
Epoch: 23, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.755 Vali Acc: 0.781 Test Loss: 0.755 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4916224479675293
Epoch: 24, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 25 cost time: 1.2683343887329102
Epoch: 25, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.739 Vali Acc: 0.791 Test Loss: 0.739 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2560012340545654
Epoch: 26, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.733 Vali Acc: 0.791 Test Loss: 0.733 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2032029628753662
Epoch: 27, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.728 Vali Acc: 0.787 Test Loss: 0.728 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2228553295135498
Epoch: 28, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.151411533355713
Epoch: 29, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.717 Vali Acc: 0.787 Test Loss: 0.717 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3892557621002197
Epoch: 30, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.713 Vali Acc: 0.791 Test Loss: 0.713 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5103504657745361
Epoch: 31, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.710 Vali Acc: 0.791 Test Loss: 0.710 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2494370937347412
Epoch: 32, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.708 Vali Acc: 0.787 Test Loss: 0.708 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.124098300933838
Epoch: 33, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.705 Vali Acc: 0.794 Test Loss: 0.705 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 34 cost time: 1.0952391624450684
Epoch: 34, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.705 Vali Acc: 0.794 Test Loss: 0.705 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 35 cost time: 1.283719539642334
Epoch: 35, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.703 Vali Acc: 0.787 Test Loss: 0.703 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2371270656585693
Epoch: 36, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.701 Vali Acc: 0.791 Test Loss: 0.701 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1705622673034668
Epoch: 37, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.700 Vali Acc: 0.794 Test Loss: 0.700 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 38 cost time: 1.2621548175811768
Epoch: 38, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2172553539276123
Epoch: 39, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2553906440734863
Epoch: 40, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2782847881317139
Epoch: 41, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2553608417510986
Epoch: 42, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3208372592926025
Epoch: 43, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.698 Vali Acc: 0.787 Test Loss: 0.698 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1886558532714844
Epoch: 44, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.698 Vali Acc: 0.787 Test Loss: 0.698 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1907374858856201
Epoch: 45, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.698 Vali Acc: 0.791 Test Loss: 0.698 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3328990936279297
Epoch: 46, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.698 Vali Acc: 0.791 Test Loss: 0.698 Test Acc: 0.791
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2330949306488037
Epoch: 47, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.698 Vali Acc: 0.791 Test Loss: 0.698 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.79375
model parameter : 343098
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.548146963119507
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.052 Vali Acc: 0.212 Test Loss: 2.052 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 1.115217924118042
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.979 Vali Acc: 0.275 Test Loss: 1.979 Test Acc: 0.275
Validation loss decreased (-0.212479 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 0.9989166259765625
Epoch: 3, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.879 Vali Acc: 0.359 Test Loss: 1.879 Test Acc: 0.359
Validation loss decreased (-0.274980 --> -0.359356).  Saving model ...
Epoch: 4 cost time: 1.0295238494873047
Epoch: 4, Steps: 8 | Train Loss: 1.760 Vali Loss: 1.764 Vali Acc: 0.416 Test Loss: 1.764 Test Acc: 0.416
Validation loss decreased (-0.359356 --> -0.415607).  Saving model ...
Epoch: 5 cost time: 1.0143659114837646
Epoch: 5, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.646 Vali Acc: 0.541 Test Loss: 1.646 Test Acc: 0.541
Validation loss decreased (-0.415607 --> -0.540609).  Saving model ...
Epoch: 6 cost time: 0.894456148147583
Epoch: 6, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.532 Vali Acc: 0.619 Test Loss: 1.532 Test Acc: 0.619
Validation loss decreased (-0.540609 --> -0.618735).  Saving model ...
Epoch: 7 cost time: 0.9834315776824951
Epoch: 7, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.421 Vali Acc: 0.688 Test Loss: 1.421 Test Acc: 0.688
Validation loss decreased (-0.618735 --> -0.687486).  Saving model ...
Epoch: 8 cost time: 0.9970424175262451
Epoch: 8, Steps: 8 | Train Loss: 1.190 Vali Loss: 1.315 Vali Acc: 0.716 Test Loss: 1.315 Test Acc: 0.716
Validation loss decreased (-0.687486 --> -0.715612).  Saving model ...
Epoch: 9 cost time: 0.9995031356811523
Epoch: 9, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.224 Vali Acc: 0.750 Test Loss: 1.224 Test Acc: 0.750
Validation loss decreased (-0.715612 --> -0.749988).  Saving model ...
Epoch: 10 cost time: 1.0954108238220215
Epoch: 10, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.146 Vali Acc: 0.753 Test Loss: 1.146 Test Acc: 0.753
Validation loss decreased (-0.749988 --> -0.753114).  Saving model ...
Epoch: 11 cost time: 0.984041690826416
Epoch: 11, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.075 Vali Acc: 0.766 Test Loss: 1.075 Test Acc: 0.766
Validation loss decreased (-0.753114 --> -0.765614).  Saving model ...
Epoch: 12 cost time: 1.009378433227539
Epoch: 12, Steps: 8 | Train Loss: 0.739 Vali Loss: 1.017 Vali Acc: 0.772 Test Loss: 1.017 Test Acc: 0.772
Validation loss decreased (-0.765614 --> -0.771865).  Saving model ...
Epoch: 13 cost time: 1.1020941734313965
Epoch: 13, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.967 Vali Acc: 0.772 Test Loss: 0.967 Test Acc: 0.772
Validation loss decreased (-0.771865 --> -0.771865).  Saving model ...
Epoch: 14 cost time: 1.1428892612457275
Epoch: 14, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.921 Vali Acc: 0.791 Test Loss: 0.921 Test Acc: 0.791
Validation loss decreased (-0.771865 --> -0.790616).  Saving model ...
Epoch: 15 cost time: 0.9351391792297363
Epoch: 15, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.885 Vali Acc: 0.787 Test Loss: 0.885 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9924721717834473
Epoch: 16, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.853 Vali Acc: 0.791 Test Loss: 0.853 Test Acc: 0.791
Validation loss decreased (-0.790616 --> -0.790616).  Saving model ...
Epoch: 17 cost time: 1.0814990997314453
Epoch: 17, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.827 Vali Acc: 0.797 Test Loss: 0.827 Test Acc: 0.797
Validation loss decreased (-0.790616 --> -0.796867).  Saving model ...
Epoch: 18 cost time: 0.9225285053253174
Epoch: 18, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.807 Vali Acc: 0.794 Test Loss: 0.807 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9574904441833496
Epoch: 19, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803117).  Saving model ...
Epoch: 20 cost time: 1.1084039211273193
Epoch: 20, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803117).  Saving model ...
Epoch: 21 cost time: 0.9788835048675537
Epoch: 21, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0362911224365234
Epoch: 22, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803118).  Saving model ...
Epoch: 23 cost time: 0.9904158115386963
Epoch: 23, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806243).  Saving model ...
Epoch: 24 cost time: 0.9359476566314697
Epoch: 24, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.724 Vali Acc: 0.812 Test Loss: 0.724 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812493).  Saving model ...
Epoch: 25 cost time: 1.077296257019043
Epoch: 25, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.716 Vali Acc: 0.812 Test Loss: 0.716 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 26 cost time: 1.1275041103363037
Epoch: 26, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.709 Vali Acc: 0.812 Test Loss: 0.709 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 27 cost time: 1.098386287689209
Epoch: 27, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.703 Vali Acc: 0.816 Test Loss: 0.703 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815618).  Saving model ...
Epoch: 28 cost time: 1.1032793521881104
Epoch: 28, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.697 Vali Acc: 0.812 Test Loss: 0.697 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0703020095825195
Epoch: 29, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.692 Vali Acc: 0.816 Test Loss: 0.692 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 30 cost time: 0.9678242206573486
Epoch: 30, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.199918270111084
Epoch: 31, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1087360382080078
Epoch: 32, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.681 Vali Acc: 0.812 Test Loss: 0.681 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.038032054901123
Epoch: 33, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.678 Vali Acc: 0.812 Test Loss: 0.678 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0401403903961182
Epoch: 34, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9738249778747559
Epoch: 35, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0739951133728027
Epoch: 36, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 37 cost time: 0.9733078479766846
Epoch: 37, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.668 Vali Acc: 0.816 Test Loss: 0.668 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 38 cost time: 1.1232409477233887
Epoch: 38, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821868).  Saving model ...
Epoch: 39 cost time: 1.190373420715332
Epoch: 39, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 1.161388874053955
Epoch: 40, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 41 cost time: 1.0509583950042725
Epoch: 41, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9837000370025635
Epoch: 42, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0153672695159912
Epoch: 43, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 44 cost time: 1.0195045471191406
Epoch: 44, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 45 cost time: 0.9360702037811279
Epoch: 45, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0400214195251465
Epoch: 46, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9491651058197021
Epoch: 47, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0303492546081543
Epoch: 48, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9964182376861572
Epoch: 49, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9506123065948486
Epoch: 50, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0976369380950928
Epoch: 51, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9501128196716309
Epoch: 52, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0239598751068115
Epoch: 53, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.978154182434082
Epoch: 54, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 339002
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.32147216796875
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.102 Vali Acc: 0.134 Test Loss: 2.102 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.8038105964660645
Epoch: 2, Steps: 8 | Train Loss: 2.032 Vali Loss: 2.014 Vali Acc: 0.172 Test Loss: 2.014 Test Acc: 0.172
Validation loss decreased (-0.134354 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 0.9159872531890869
Epoch: 3, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.897 Vali Acc: 0.275 Test Loss: 1.897 Test Acc: 0.275
Validation loss decreased (-0.171855 --> -0.274981).  Saving model ...
Epoch: 4 cost time: 0.8454132080078125
Epoch: 4, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.770 Vali Acc: 0.425 Test Loss: 1.770 Test Acc: 0.425
Validation loss decreased (-0.274981 --> -0.424982).  Saving model ...
Epoch: 5 cost time: 0.9513583183288574
Epoch: 5, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.638 Vali Acc: 0.531 Test Loss: 1.638 Test Acc: 0.531
Validation loss decreased (-0.424982 --> -0.531234).  Saving model ...
Epoch: 6 cost time: 0.8708434104919434
Epoch: 6, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.508 Vali Acc: 0.603 Test Loss: 1.508 Test Acc: 0.603
Validation loss decreased (-0.531234 --> -0.603110).  Saving model ...
Epoch: 7 cost time: 0.9124934673309326
Epoch: 7, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.387 Vali Acc: 0.634 Test Loss: 1.387 Test Acc: 0.634
Validation loss decreased (-0.603110 --> -0.634361).  Saving model ...
Epoch: 8 cost time: 0.9338641166687012
Epoch: 8, Steps: 8 | Train Loss: 1.114 Vali Loss: 1.280 Vali Acc: 0.659 Test Loss: 1.280 Test Acc: 0.659
Validation loss decreased (-0.634361 --> -0.659362).  Saving model ...
Epoch: 9 cost time: 0.8872923851013184
Epoch: 9, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.192 Vali Acc: 0.678 Test Loss: 1.192 Test Acc: 0.678
Validation loss decreased (-0.659362 --> -0.678113).  Saving model ...
Epoch: 10 cost time: 0.9260587692260742
Epoch: 10, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.116 Vali Acc: 0.691 Test Loss: 1.116 Test Acc: 0.691
Validation loss decreased (-0.678113 --> -0.690614).  Saving model ...
Epoch: 11 cost time: 0.8304595947265625
Epoch: 11, Steps: 8 | Train Loss: 0.757 Vali Loss: 1.056 Vali Acc: 0.697 Test Loss: 1.056 Test Acc: 0.697
Validation loss decreased (-0.690614 --> -0.696864).  Saving model ...
Epoch: 12 cost time: 0.8872799873352051
Epoch: 12, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.003 Vali Acc: 0.719 Test Loss: 1.003 Test Acc: 0.719
Validation loss decreased (-0.696864 --> -0.718740).  Saving model ...
Epoch: 13 cost time: 0.940669059753418
Epoch: 13, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.958 Vali Acc: 0.731 Test Loss: 0.958 Test Acc: 0.731
Validation loss decreased (-0.718740 --> -0.731240).  Saving model ...
Epoch: 14 cost time: 0.869537353515625
Epoch: 14, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.920 Vali Acc: 0.738 Test Loss: 0.920 Test Acc: 0.738
Validation loss decreased (-0.731240 --> -0.737491).  Saving model ...
Epoch: 15 cost time: 0.9191203117370605
Epoch: 15, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.886 Vali Acc: 0.741 Test Loss: 0.886 Test Acc: 0.741
Validation loss decreased (-0.737491 --> -0.740616).  Saving model ...
Epoch: 16 cost time: 0.8787903785705566
Epoch: 16, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.856 Vali Acc: 0.756 Test Loss: 0.856 Test Acc: 0.756
Validation loss decreased (-0.740616 --> -0.756241).  Saving model ...
Epoch: 17 cost time: 0.8400976657867432
Epoch: 17, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756242).  Saving model ...
Epoch: 18 cost time: 0.8649022579193115
Epoch: 18, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.813 Vali Acc: 0.756 Test Loss: 0.813 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 19 cost time: 0.9251103401184082
Epoch: 19, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.797 Vali Acc: 0.759 Test Loss: 0.797 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 20 cost time: 0.972719669342041
Epoch: 20, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.781 Vali Acc: 0.769 Test Loss: 0.781 Test Acc: 0.769
Validation loss decreased (-0.759367 --> -0.768742).  Saving model ...
Epoch: 21 cost time: 0.9244377613067627
Epoch: 21, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.766 Vali Acc: 0.762 Test Loss: 0.766 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0350496768951416
Epoch: 22, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
Validation loss decreased (-0.768742 --> -0.778117).  Saving model ...
Epoch: 23 cost time: 0.9556884765625
Epoch: 23, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0754389762878418
Epoch: 24, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.734 Vali Acc: 0.772 Test Loss: 0.734 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0713236331939697
Epoch: 25, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
Validation loss decreased (-0.778117 --> -0.778118).  Saving model ...
Epoch: 26 cost time: 0.916717529296875
Epoch: 26, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.717 Vali Acc: 0.781 Test Loss: 0.717 Test Acc: 0.781
Validation loss decreased (-0.778118 --> -0.781243).  Saving model ...
Epoch: 27 cost time: 0.8786218166351318
Epoch: 27, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.708 Vali Acc: 0.781 Test Loss: 0.708 Test Acc: 0.781
Validation loss decreased (-0.781243 --> -0.781243).  Saving model ...
Epoch: 28 cost time: 0.9260330200195312
Epoch: 28, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9559428691864014
Epoch: 29, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.696 Vali Acc: 0.778 Test Loss: 0.696 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8145990371704102
Epoch: 30, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.691 Vali Acc: 0.778 Test Loss: 0.691 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9604952335357666
Epoch: 31, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.687 Vali Acc: 0.778 Test Loss: 0.687 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9334614276885986
Epoch: 32, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8620808124542236
Epoch: 33, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.680 Vali Acc: 0.781 Test Loss: 0.680 Test Acc: 0.781
Validation loss decreased (-0.781243 --> -0.781243).  Saving model ...
Epoch: 34 cost time: 0.9013402462005615
Epoch: 34, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.679 Vali Acc: 0.787 Test Loss: 0.679 Test Acc: 0.787
Validation loss decreased (-0.781243 --> -0.787493).  Saving model ...
Epoch: 35 cost time: 0.9811859130859375
Epoch: 35, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.675 Vali Acc: 0.784 Test Loss: 0.675 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8831996917724609
Epoch: 36, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.674 Vali Acc: 0.784 Test Loss: 0.674 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8392338752746582
Epoch: 37, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.674 Vali Acc: 0.784 Test Loss: 0.674 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8776340484619141
Epoch: 38, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.673 Vali Acc: 0.791 Test Loss: 0.673 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790618).  Saving model ...
Epoch: 39 cost time: 0.9432823657989502
Epoch: 39, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.670 Vali Acc: 0.787 Test Loss: 0.670 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8700265884399414
Epoch: 40, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.667 Vali Acc: 0.784 Test Loss: 0.667 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9147424697875977
Epoch: 41, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.665 Vali Acc: 0.784 Test Loss: 0.665 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8754160404205322
Epoch: 42, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.662 Vali Acc: 0.787 Test Loss: 0.662 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8915829658508301
Epoch: 43, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.661 Vali Acc: 0.784 Test Loss: 0.661 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9382801055908203
Epoch: 44, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.661 Vali Acc: 0.787 Test Loss: 0.661 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8363146781921387
Epoch: 45, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.662 Vali Acc: 0.794 Test Loss: 0.662 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 46 cost time: 0.8136625289916992
Epoch: 46, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.661 Vali Acc: 0.787 Test Loss: 0.661 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0179662704467773
Epoch: 47, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.660 Vali Acc: 0.787 Test Loss: 0.660 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8856303691864014
Epoch: 48, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.661 Vali Acc: 0.787 Test Loss: 0.661 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9386060237884521
Epoch: 49, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.662 Vali Acc: 0.778 Test Loss: 0.662 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9283187389373779
Epoch: 50, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.662 Vali Acc: 0.784 Test Loss: 0.662 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8799233436584473
Epoch: 51, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.661 Vali Acc: 0.791 Test Loss: 0.661 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8425900936126709
Epoch: 52, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.661 Vali Acc: 0.784 Test Loss: 0.661 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8898477554321289
Epoch: 53, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.661 Vali Acc: 0.787 Test Loss: 0.661 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8645486831665039
Epoch: 54, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.662 Vali Acc: 0.787 Test Loss: 0.662 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8153057098388672
Epoch: 55, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.787 Test Loss: 0.662 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.79375
model parameter : 335930
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.202986478805542
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.048 Vali Acc: 0.175 Test Loss: 2.048 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 0.7522842884063721
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 1.969 Vali Acc: 0.222 Test Loss: 1.969 Test Acc: 0.222
Validation loss decreased (-0.174980 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 0.7508652210235596
Epoch: 3, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.866 Vali Acc: 0.341 Test Loss: 1.866 Test Acc: 0.341
Validation loss decreased (-0.221855 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 0.727759599685669
Epoch: 4, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.750 Vali Acc: 0.481 Test Loss: 1.750 Test Acc: 0.481
Validation loss decreased (-0.340606 --> -0.481233).  Saving model ...
Epoch: 5 cost time: 0.6996324062347412
Epoch: 5, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.629 Vali Acc: 0.584 Test Loss: 1.629 Test Acc: 0.584
Validation loss decreased (-0.481233 --> -0.584359).  Saving model ...
Epoch: 6 cost time: 0.7732467651367188
Epoch: 6, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.507 Vali Acc: 0.656 Test Loss: 1.507 Test Acc: 0.656
Validation loss decreased (-0.584359 --> -0.656235).  Saving model ...
Epoch: 7 cost time: 0.6837193965911865
Epoch: 7, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.393 Vali Acc: 0.694 Test Loss: 1.393 Test Acc: 0.694
Validation loss decreased (-0.656235 --> -0.693736).  Saving model ...
Epoch: 8 cost time: 0.8030796051025391
Epoch: 8, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.285 Vali Acc: 0.750 Test Loss: 1.285 Test Acc: 0.750
Validation loss decreased (-0.693736 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 0.678314208984375
Epoch: 9, Steps: 8 | Train Loss: 0.974 Vali Loss: 1.189 Vali Acc: 0.769 Test Loss: 1.189 Test Acc: 0.769
Validation loss decreased (-0.749987 --> -0.768738).  Saving model ...
Epoch: 10 cost time: 0.703594446182251
Epoch: 10, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.106 Vali Acc: 0.772 Test Loss: 1.106 Test Acc: 0.772
Validation loss decreased (-0.768738 --> -0.771864).  Saving model ...
Epoch: 11 cost time: 0.7076876163482666
Epoch: 11, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.037 Vali Acc: 0.769 Test Loss: 1.037 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6641054153442383
Epoch: 12, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.980 Vali Acc: 0.784 Test Loss: 0.980 Test Acc: 0.784
Validation loss decreased (-0.771864 --> -0.784365).  Saving model ...
Epoch: 13 cost time: 0.7565536499023438
Epoch: 13, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.931 Vali Acc: 0.791 Test Loss: 0.931 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790616).  Saving model ...
Epoch: 14 cost time: 0.6783020496368408
Epoch: 14, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.889 Vali Acc: 0.809 Test Loss: 0.889 Test Acc: 0.809
Validation loss decreased (-0.790616 --> -0.809366).  Saving model ...
Epoch: 15 cost time: 0.6827514171600342
Epoch: 15, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.707465648651123
Epoch: 16, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.825 Vali Acc: 0.806 Test Loss: 0.825 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6913316249847412
Epoch: 17, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.800 Vali Acc: 0.806 Test Loss: 0.800 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8274729251861572
Epoch: 18, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.779 Vali Acc: 0.806 Test Loss: 0.779 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7794077396392822
Epoch: 19, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.761 Vali Acc: 0.812 Test Loss: 0.761 Test Acc: 0.812
Validation loss decreased (-0.809366 --> -0.812492).  Saving model ...
Epoch: 20 cost time: 0.6615381240844727
Epoch: 20, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.622218132019043
Epoch: 21, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7862086296081543
Epoch: 22, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.725 Vali Acc: 0.809 Test Loss: 0.725 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6779823303222656
Epoch: 23, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7845797538757324
Epoch: 24, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7169477939605713
Epoch: 25, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8284523487091064
Epoch: 26, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7877562046051025
Epoch: 27, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.688 Vali Acc: 0.806 Test Loss: 0.688 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8171203136444092
Epoch: 28, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8932318687438965
Epoch: 29, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8125
model parameter : 334394
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3215510845184326
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 2.049 Vali Acc: 0.200 Test Loss: 2.049 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.7379777431488037
Epoch: 2, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.966 Vali Acc: 0.284 Test Loss: 1.966 Test Acc: 0.284
Validation loss decreased (-0.199980 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 0.739891529083252
Epoch: 3, Steps: 8 | Train Loss: 1.884 Vali Loss: 1.856 Vali Acc: 0.378 Test Loss: 1.856 Test Acc: 0.378
Validation loss decreased (-0.284355 --> -0.378106).  Saving model ...
Epoch: 4 cost time: 0.6236155033111572
Epoch: 4, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.732 Vali Acc: 0.503 Test Loss: 1.732 Test Acc: 0.503
Validation loss decreased (-0.378106 --> -0.503108).  Saving model ...
Epoch: 5 cost time: 0.765655517578125
Epoch: 5, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.597 Vali Acc: 0.622 Test Loss: 1.597 Test Acc: 0.622
Validation loss decreased (-0.503108 --> -0.621859).  Saving model ...
Epoch: 6 cost time: 0.6663384437561035
Epoch: 6, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.470 Vali Acc: 0.672 Test Loss: 1.470 Test Acc: 0.672
Validation loss decreased (-0.621859 --> -0.671860).  Saving model ...
Epoch: 7 cost time: 0.6961729526519775
Epoch: 7, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.349 Vali Acc: 0.719 Test Loss: 1.349 Test Acc: 0.719
Validation loss decreased (-0.671860 --> -0.718737).  Saving model ...
Epoch: 8 cost time: 0.6616048812866211
Epoch: 8, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.240 Vali Acc: 0.747 Test Loss: 1.240 Test Acc: 0.747
Validation loss decreased (-0.718737 --> -0.746863).  Saving model ...
Epoch: 9 cost time: 0.7444071769714355
Epoch: 9, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.147 Vali Acc: 0.747 Test Loss: 1.147 Test Acc: 0.747
Validation loss decreased (-0.746863 --> -0.746864).  Saving model ...
Epoch: 10 cost time: 0.7407612800598145
Epoch: 10, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.065 Vali Acc: 0.756 Test Loss: 1.065 Test Acc: 0.756
Validation loss decreased (-0.746864 --> -0.756239).  Saving model ...
Epoch: 11 cost time: 0.6620502471923828
Epoch: 11, Steps: 8 | Train Loss: 0.674 Vali Loss: 1.000 Vali Acc: 0.775 Test Loss: 1.000 Test Acc: 0.775
Validation loss decreased (-0.756239 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.6955208778381348
Epoch: 12, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.6930680274963379
Epoch: 13, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.900 Vali Acc: 0.787 Test Loss: 0.900 Test Acc: 0.787
Validation loss decreased (-0.774991 --> -0.787491).  Saving model ...
Epoch: 14 cost time: 0.7096207141876221
Epoch: 14, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.862 Vali Acc: 0.787 Test Loss: 0.862 Test Acc: 0.787
Validation loss decreased (-0.787491 --> -0.787491).  Saving model ...
Epoch: 15 cost time: 0.7016620635986328
Epoch: 15, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.832 Vali Acc: 0.791 Test Loss: 0.832 Test Acc: 0.791
Validation loss decreased (-0.787491 --> -0.790617).  Saving model ...
Epoch: 16 cost time: 0.6796848773956299
Epoch: 16, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.804 Vali Acc: 0.784 Test Loss: 0.804 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7257933616638184
Epoch: 17, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.782 Vali Acc: 0.784 Test Loss: 0.782 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.748521089553833
Epoch: 18, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.763 Vali Acc: 0.787 Test Loss: 0.763 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8457989692687988
Epoch: 19, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 20 cost time: 0.7107985019683838
Epoch: 20, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.729 Vali Acc: 0.797 Test Loss: 0.729 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 21 cost time: 0.7440710067749023
Epoch: 21, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.714 Vali Acc: 0.797 Test Loss: 0.714 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 22 cost time: 0.7421383857727051
Epoch: 22, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.703 Vali Acc: 0.794 Test Loss: 0.703 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7518291473388672
Epoch: 23, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.694 Vali Acc: 0.791 Test Loss: 0.694 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8914914131164551
Epoch: 24, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.6750972270965576
Epoch: 25, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.678 Vali Acc: 0.791 Test Loss: 0.678 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7030620574951172
Epoch: 26, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7463042736053467
Epoch: 27, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.664 Vali Acc: 0.797 Test Loss: 0.664 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6360912322998047
Epoch: 28, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.658 Vali Acc: 0.797 Test Loss: 0.658 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6406562328338623
Epoch: 29, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.7531602382659912
Epoch: 30, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7596287727355957
Epoch: 31, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 32 cost time: 0.7934644222259521
Epoch: 32, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8045260906219482
Epoch: 33, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1013054847717285
Epoch: 34, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 35 cost time: 0.7748892307281494
Epoch: 35, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6941709518432617
Epoch: 36, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7714104652404785
Epoch: 37, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 38 cost time: 0.6750001907348633
Epoch: 38, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7275183200836182
Epoch: 39, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 40 cost time: 0.8241188526153564
Epoch: 40, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7210872173309326
Epoch: 41, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 42 cost time: 0.8062648773193359
Epoch: 42, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6391787528991699
Epoch: 43, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6647193431854248
Epoch: 44, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6800801753997803
Epoch: 45, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9213058948516846
Epoch: 46, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.625 Vali Acc: 0.797 Test Loss: 0.625 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8214387893676758
Epoch: 47, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7971951961517334
Epoch: 48, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9854378700256348
Epoch: 49, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7112436294555664
Epoch: 50, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.622 Vali Acc: 0.797 Test Loss: 0.622 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7053756713867188
Epoch: 51, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.80625
model parameter : 332858
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.065247058868408
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.072 Vali Acc: 0.116 Test Loss: 2.072 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.5643181800842285
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.993 Vali Acc: 0.147 Test Loss: 1.993 Test Acc: 0.147
Validation loss decreased (-0.115604 --> -0.146855).  Saving model ...
Epoch: 3 cost time: 0.6156895160675049
Epoch: 3, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.885 Vali Acc: 0.263 Test Loss: 1.885 Test Acc: 0.263
Validation loss decreased (-0.146855 --> -0.262481).  Saving model ...
Epoch: 4 cost time: 0.7594757080078125
Epoch: 4, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.763 Vali Acc: 0.403 Test Loss: 1.763 Test Acc: 0.403
Validation loss decreased (-0.262481 --> -0.403107).  Saving model ...
Epoch: 5 cost time: 0.5952517986297607
Epoch: 5, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.629 Vali Acc: 0.562 Test Loss: 1.629 Test Acc: 0.562
Validation loss decreased (-0.403107 --> -0.562484).  Saving model ...
Epoch: 6 cost time: 0.664543867111206
Epoch: 6, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.507 Vali Acc: 0.619 Test Loss: 1.507 Test Acc: 0.619
Validation loss decreased (-0.562484 --> -0.618735).  Saving model ...
Epoch: 7 cost time: 0.5290970802307129
Epoch: 7, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.391 Vali Acc: 0.669 Test Loss: 1.391 Test Acc: 0.669
Validation loss decreased (-0.618735 --> -0.668736).  Saving model ...
Epoch: 8 cost time: 0.5584073066711426
Epoch: 8, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.290 Vali Acc: 0.691 Test Loss: 1.290 Test Acc: 0.691
Validation loss decreased (-0.668736 --> -0.690612).  Saving model ...
Epoch: 9 cost time: 0.5065724849700928
Epoch: 9, Steps: 8 | Train Loss: 0.930 Vali Loss: 1.205 Vali Acc: 0.706 Test Loss: 1.205 Test Acc: 0.706
Validation loss decreased (-0.690612 --> -0.706238).  Saving model ...
Epoch: 10 cost time: 0.7009830474853516
Epoch: 10, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.123 Vali Acc: 0.713 Test Loss: 1.123 Test Acc: 0.713
Validation loss decreased (-0.706238 --> -0.712489).  Saving model ...
Epoch: 11 cost time: 0.5637204647064209
Epoch: 11, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.057 Vali Acc: 0.709 Test Loss: 1.057 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5400357246398926
Epoch: 12, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.998 Vali Acc: 0.722 Test Loss: 0.998 Test Acc: 0.722
Validation loss decreased (-0.712489 --> -0.721865).  Saving model ...
Epoch: 13 cost time: 0.5180971622467041
Epoch: 13, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.954 Vali Acc: 0.731 Test Loss: 0.954 Test Acc: 0.731
Validation loss decreased (-0.721865 --> -0.731240).  Saving model ...
Epoch: 14 cost time: 0.6076602935791016
Epoch: 14, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.919 Vali Acc: 0.731 Test Loss: 0.919 Test Acc: 0.731
Validation loss decreased (-0.731240 --> -0.731241).  Saving model ...
Epoch: 15 cost time: 0.689873456954956
Epoch: 15, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.886 Vali Acc: 0.744 Test Loss: 0.886 Test Acc: 0.744
Validation loss decreased (-0.731241 --> -0.743741).  Saving model ...
Epoch: 16 cost time: 0.595379114151001
Epoch: 16, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
Validation loss decreased (-0.743741 --> -0.743741).  Saving model ...
Epoch: 17 cost time: 0.5086534023284912
Epoch: 17, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.836 Vali Acc: 0.762 Test Loss: 0.836 Test Acc: 0.762
Validation loss decreased (-0.743741 --> -0.762492).  Saving model ...
Epoch: 18 cost time: 0.5353903770446777
Epoch: 18, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5677108764648438
Epoch: 19, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.810 Vali Acc: 0.753 Test Loss: 0.810 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.582470178604126
Epoch: 20, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.501293420791626
Epoch: 21, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7079036235809326
Epoch: 22, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5462949275970459
Epoch: 23, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.755 Vali Acc: 0.759 Test Loss: 0.755 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5521502494812012
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6052227020263672
Epoch: 25, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5684370994567871
Epoch: 26, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.737 Vali Acc: 0.762 Test Loss: 0.737 Test Acc: 0.762
Validation loss decreased (-0.762492 --> -0.762493).  Saving model ...
Epoch: 27 cost time: 0.6074793338775635
Epoch: 27, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.733 Vali Acc: 0.762 Test Loss: 0.733 Test Acc: 0.762
Validation loss decreased (-0.762493 --> -0.762493).  Saving model ...
Epoch: 28 cost time: 0.6103572845458984
Epoch: 28, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.726 Vali Acc: 0.766 Test Loss: 0.726 Test Acc: 0.766
Validation loss decreased (-0.762493 --> -0.765618).  Saving model ...
Epoch: 29 cost time: 0.6197266578674316
Epoch: 29, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.723 Vali Acc: 0.775 Test Loss: 0.723 Test Acc: 0.775
Validation loss decreased (-0.765618 --> -0.774993).  Saving model ...
Epoch: 30 cost time: 0.5127232074737549
Epoch: 30, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.721 Vali Acc: 0.772 Test Loss: 0.721 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.583261251449585
Epoch: 31, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.717 Vali Acc: 0.778 Test Loss: 0.717 Test Acc: 0.778
Validation loss decreased (-0.774993 --> -0.778118).  Saving model ...
Epoch: 32 cost time: 0.6312456130981445
Epoch: 32, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.719 Vali Acc: 0.769 Test Loss: 0.719 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5812380313873291
Epoch: 33, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5776658058166504
Epoch: 34, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.715 Vali Acc: 0.769 Test Loss: 0.715 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6050295829772949
Epoch: 35, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5443618297576904
Epoch: 36, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.717 Vali Acc: 0.769 Test Loss: 0.717 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5127427577972412
Epoch: 37, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5773851871490479
Epoch: 38, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.714 Vali Acc: 0.769 Test Loss: 0.714 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6292834281921387
Epoch: 39, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.715 Vali Acc: 0.766 Test Loss: 0.715 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5891711711883545
Epoch: 40, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.718 Vali Acc: 0.772 Test Loss: 0.718 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6287708282470703
Epoch: 41, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.718 Vali Acc: 0.772 Test Loss: 0.718 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.778125
model parameter : 331322
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.937582015991211
Epoch: 1, Steps: 8 | Train Loss: 2.205 Vali Loss: 2.164 Vali Acc: 0.056 Test Loss: 2.164 Test Acc: 0.056
Validation loss decreased (inf --> -0.056228).  Saving model ...
Epoch: 2 cost time: 1.495056390762329
Epoch: 2, Steps: 8 | Train Loss: 2.014 Vali Loss: 2.028 Vali Acc: 0.163 Test Loss: 2.028 Test Acc: 0.163
Validation loss decreased (-0.056228 --> -0.162480).  Saving model ...
Epoch: 3 cost time: 1.7224173545837402
Epoch: 3, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.861 Vali Acc: 0.341 Test Loss: 1.861 Test Acc: 0.341
Validation loss decreased (-0.162480 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 1.545588731765747
Epoch: 4, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.702 Vali Acc: 0.484 Test Loss: 1.702 Test Acc: 0.484
Validation loss decreased (-0.340606 --> -0.484358).  Saving model ...
Epoch: 5 cost time: 1.5488150119781494
Epoch: 5, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.556 Vali Acc: 0.591 Test Loss: 1.556 Test Acc: 0.591
Validation loss decreased (-0.484358 --> -0.590609).  Saving model ...
Epoch: 6 cost time: 1.5303549766540527
Epoch: 6, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.422 Vali Acc: 0.631 Test Loss: 1.422 Test Acc: 0.631
Validation loss decreased (-0.590609 --> -0.631236).  Saving model ...
Epoch: 7 cost time: 1.5043351650238037
Epoch: 7, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.320 Vali Acc: 0.647 Test Loss: 1.320 Test Acc: 0.647
Validation loss decreased (-0.631236 --> -0.646862).  Saving model ...
Epoch: 8 cost time: 1.6463029384613037
Epoch: 8, Steps: 8 | Train Loss: 0.796 Vali Loss: 1.228 Vali Acc: 0.666 Test Loss: 1.228 Test Acc: 0.666
Validation loss decreased (-0.646862 --> -0.665613).  Saving model ...
Epoch: 9 cost time: 1.4992938041687012
Epoch: 9, Steps: 8 | Train Loss: 0.653 Vali Loss: 1.150 Vali Acc: 0.706 Test Loss: 1.150 Test Acc: 0.706
Validation loss decreased (-0.665613 --> -0.706239).  Saving model ...
Epoch: 10 cost time: 1.235717535018921
Epoch: 10, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.087 Vali Acc: 0.728 Test Loss: 1.087 Test Acc: 0.728
Validation loss decreased (-0.706239 --> -0.728114).  Saving model ...
Epoch: 11 cost time: 1.359621524810791
Epoch: 11, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.042 Vali Acc: 0.716 Test Loss: 1.042 Test Acc: 0.716
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.550793170928955
Epoch: 12, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.998 Vali Acc: 0.722 Test Loss: 0.998 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.60054349899292
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.958 Vali Acc: 0.728 Test Loss: 0.958 Test Acc: 0.728
Validation loss decreased (-0.728114 --> -0.728115).  Saving model ...
Epoch: 14 cost time: 1.4684758186340332
Epoch: 14, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.923 Vali Acc: 0.728 Test Loss: 0.923 Test Acc: 0.728
Validation loss decreased (-0.728115 --> -0.728116).  Saving model ...
Epoch: 15 cost time: 1.297588586807251
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.897 Vali Acc: 0.734 Test Loss: 0.897 Test Acc: 0.734
Validation loss decreased (-0.728116 --> -0.734366).  Saving model ...
Epoch: 16 cost time: 1.4410810470581055
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4122483730316162
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
Validation loss decreased (-0.734366 --> -0.743741).  Saving model ...
Epoch: 18 cost time: 1.2770719528198242
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.837 Vali Acc: 0.731 Test Loss: 0.837 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4389467239379883
Epoch: 19, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.824 Vali Acc: 0.747 Test Loss: 0.824 Test Acc: 0.747
Validation loss decreased (-0.743741 --> -0.746867).  Saving model ...
Epoch: 20 cost time: 1.3963346481323242
Epoch: 20, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5266094207763672
Epoch: 21, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4996747970581055
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4026105403900146
Epoch: 23, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.803 Vali Acc: 0.738 Test Loss: 0.803 Test Acc: 0.738
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6076922416687012
Epoch: 24, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.800 Vali Acc: 0.753 Test Loss: 0.800 Test Acc: 0.753
Validation loss decreased (-0.746867 --> -0.753117).  Saving model ...
Epoch: 25 cost time: 1.5199387073516846
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.796 Vali Acc: 0.753 Test Loss: 0.796 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 26 cost time: 1.4056332111358643
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.793 Vali Acc: 0.747 Test Loss: 0.793 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5040309429168701
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.788 Vali Acc: 0.753 Test Loss: 0.788 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 28 cost time: 1.5904123783111572
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.784 Vali Acc: 0.744 Test Loss: 0.784 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5273041725158691
Epoch: 29, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.783 Vali Acc: 0.744 Test Loss: 0.783 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5859808921813965
Epoch: 30, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.782 Vali Acc: 0.747 Test Loss: 0.782 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.495162010192871
Epoch: 31, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.780 Vali Acc: 0.747 Test Loss: 0.780 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.449981689453125
Epoch: 32, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.780 Vali Acc: 0.731 Test Loss: 0.780 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.58577299118042
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.778 Vali Acc: 0.738 Test Loss: 0.778 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5320181846618652
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.779 Vali Acc: 0.741 Test Loss: 0.779 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5776946544647217
Epoch: 35, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.777 Vali Acc: 0.738 Test Loss: 0.777 Test Acc: 0.738
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5052969455718994
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.775 Vali Acc: 0.741 Test Loss: 0.775 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4571170806884766
Epoch: 37, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.772 Vali Acc: 0.741 Test Loss: 0.772 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.753125
model parameter : 351256
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.527289628982544
Epoch: 1, Steps: 8 | Train Loss: 2.023 Vali Loss: 1.974 Vali Acc: 0.231 Test Loss: 1.974 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 1.2414100170135498
Epoch: 2, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.863 Vali Acc: 0.347 Test Loss: 1.863 Test Acc: 0.347
Validation loss decreased (-0.231230 --> -0.346856).  Saving model ...
Epoch: 3 cost time: 1.2720305919647217
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.722 Vali Acc: 0.450 Test Loss: 1.722 Test Acc: 0.450
Validation loss decreased (-0.346856 --> -0.449983).  Saving model ...
Epoch: 4 cost time: 1.2695727348327637
Epoch: 4, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.577 Vali Acc: 0.569 Test Loss: 1.577 Test Acc: 0.569
Validation loss decreased (-0.449983 --> -0.568734).  Saving model ...
Epoch: 5 cost time: 1.1464383602142334
Epoch: 5, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.451 Vali Acc: 0.613 Test Loss: 1.451 Test Acc: 0.613
Validation loss decreased (-0.568734 --> -0.612485).  Saving model ...
Epoch: 6 cost time: 1.2922446727752686
Epoch: 6, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.352 Vali Acc: 0.659 Test Loss: 1.352 Test Acc: 0.659
Validation loss decreased (-0.612485 --> -0.659361).  Saving model ...
Epoch: 7 cost time: 1.230987310409546
Epoch: 7, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.254 Vali Acc: 0.681 Test Loss: 1.254 Test Acc: 0.681
Validation loss decreased (-0.659361 --> -0.681237).  Saving model ...
Epoch: 8 cost time: 1.3348028659820557
Epoch: 8, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.172 Vali Acc: 0.703 Test Loss: 1.172 Test Acc: 0.703
Validation loss decreased (-0.681237 --> -0.703113).  Saving model ...
Epoch: 9 cost time: 1.414961338043213
Epoch: 9, Steps: 8 | Train Loss: 0.621 Vali Loss: 1.104 Vali Acc: 0.716 Test Loss: 1.104 Test Acc: 0.716
Validation loss decreased (-0.703113 --> -0.715614).  Saving model ...
Epoch: 10 cost time: 1.4136850833892822
Epoch: 10, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.041 Vali Acc: 0.734 Test Loss: 1.041 Test Acc: 0.734
Validation loss decreased (-0.715614 --> -0.734365).  Saving model ...
Epoch: 11 cost time: 1.2636525630950928
Epoch: 11, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.996 Vali Acc: 0.731 Test Loss: 0.996 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3762435913085938
Epoch: 12, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.957 Vali Acc: 0.734 Test Loss: 0.957 Test Acc: 0.734
Validation loss decreased (-0.734365 --> -0.734365).  Saving model ...
Epoch: 13 cost time: 1.3290905952453613
Epoch: 13, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.922 Vali Acc: 0.738 Test Loss: 0.922 Test Acc: 0.738
Validation loss decreased (-0.734365 --> -0.737491).  Saving model ...
Epoch: 14 cost time: 1.3797633647918701
Epoch: 14, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
Validation loss decreased (-0.737491 --> -0.743741).  Saving model ...
Epoch: 15 cost time: 1.4383130073547363
Epoch: 15, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.743741 --> -0.743741).  Saving model ...
Epoch: 16 cost time: 1.6119883060455322
Epoch: 16, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.863 Vali Acc: 0.753 Test Loss: 0.863 Test Acc: 0.753
Validation loss decreased (-0.743741 --> -0.753116).  Saving model ...
Epoch: 17 cost time: 1.3711450099945068
Epoch: 17, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.850 Vali Acc: 0.759 Test Loss: 0.850 Test Acc: 0.759
Validation loss decreased (-0.753116 --> -0.759366).  Saving model ...
Epoch: 18 cost time: 1.419666051864624
Epoch: 18, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.833 Vali Acc: 0.759 Test Loss: 0.833 Test Acc: 0.759
Validation loss decreased (-0.759366 --> -0.759367).  Saving model ...
Epoch: 19 cost time: 1.3199560642242432
Epoch: 19, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3127999305725098
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.759367 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 1.1552867889404297
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.803 Vali Acc: 0.769 Test Loss: 0.803 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1419861316680908
Epoch: 22, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.797 Vali Acc: 0.769 Test Loss: 0.797 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2732176780700684
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.791 Vali Acc: 0.778 Test Loss: 0.791 Test Acc: 0.778
Validation loss decreased (-0.774992 --> -0.778117).  Saving model ...
Epoch: 24 cost time: 1.2926421165466309
Epoch: 24, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3977205753326416
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.787 Vali Acc: 0.769 Test Loss: 0.787 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4425077438354492
Epoch: 26, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.783 Vali Acc: 0.766 Test Loss: 0.783 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2459166049957275
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.779 Vali Acc: 0.766 Test Loss: 0.779 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1758084297180176
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.776 Vali Acc: 0.759 Test Loss: 0.776 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2813639640808105
Epoch: 29, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.771 Vali Acc: 0.769 Test Loss: 0.771 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.21466064453125
Epoch: 30, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.770 Vali Acc: 0.769 Test Loss: 0.770 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1930899620056152
Epoch: 31, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.768 Vali Acc: 0.759 Test Loss: 0.768 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3312945365905762
Epoch: 32, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.768 Vali Acc: 0.766 Test Loss: 0.768 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4652314186096191
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.766 Vali Acc: 0.762 Test Loss: 0.766 Test Acc: 0.762
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.778125
model parameter : 347160
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.534139633178711
Epoch: 1, Steps: 8 | Train Loss: 2.179 Vali Loss: 2.132 Vali Acc: 0.138 Test Loss: 2.132 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 1.1792912483215332
Epoch: 2, Steps: 8 | Train Loss: 2.026 Vali Loss: 2.013 Vali Acc: 0.219 Test Loss: 2.013 Test Acc: 0.219
Validation loss decreased (-0.137479 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 1.165187120437622
Epoch: 3, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.854 Vali Acc: 0.366 Test Loss: 1.854 Test Acc: 0.366
Validation loss decreased (-0.218730 --> -0.365606).  Saving model ...
Epoch: 4 cost time: 1.1100075244903564
Epoch: 4, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.701 Vali Acc: 0.459 Test Loss: 1.701 Test Acc: 0.459
Validation loss decreased (-0.365606 --> -0.459358).  Saving model ...
Epoch: 5 cost time: 1.016528606414795
Epoch: 5, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.555 Vali Acc: 0.559 Test Loss: 1.555 Test Acc: 0.559
Validation loss decreased (-0.459358 --> -0.559359).  Saving model ...
Epoch: 6 cost time: 1.2894048690795898
Epoch: 6, Steps: 8 | Train Loss: 1.085 Vali Loss: 1.430 Vali Acc: 0.584 Test Loss: 1.430 Test Acc: 0.584
Validation loss decreased (-0.559359 --> -0.584361).  Saving model ...
Epoch: 7 cost time: 1.1244397163391113
Epoch: 7, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.323 Vali Acc: 0.616 Test Loss: 1.323 Test Acc: 0.616
Validation loss decreased (-0.584361 --> -0.615612).  Saving model ...
Epoch: 8 cost time: 1.1295292377471924
Epoch: 8, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.233 Vali Acc: 0.644 Test Loss: 1.233 Test Acc: 0.644
Validation loss decreased (-0.615612 --> -0.643738).  Saving model ...
Epoch: 9 cost time: 1.1022558212280273
Epoch: 9, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
Validation loss decreased (-0.643738 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 1.036024570465088
Epoch: 10, Steps: 8 | Train Loss: 0.528 Vali Loss: 1.103 Vali Acc: 0.691 Test Loss: 1.103 Test Acc: 0.691
Validation loss decreased (-0.674988 --> -0.690614).  Saving model ...
Epoch: 11 cost time: 0.9971888065338135
Epoch: 11, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
Validation loss decreased (-0.690614 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.9374954700469971
Epoch: 12, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.001 Vali Acc: 0.709 Test Loss: 1.001 Test Acc: 0.709
Validation loss decreased (-0.699990 --> -0.709365).  Saving model ...
Epoch: 13 cost time: 0.9421787261962891
Epoch: 13, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.961 Vali Acc: 0.709 Test Loss: 0.961 Test Acc: 0.709
Validation loss decreased (-0.709365 --> -0.709365).  Saving model ...
Epoch: 14 cost time: 1.0665411949157715
Epoch: 14, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
Validation loss decreased (-0.709365 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.011596441268921
Epoch: 15, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.897 Vali Acc: 0.734 Test Loss: 0.897 Test Acc: 0.734
Validation loss decreased (-0.724991 --> -0.734366).  Saving model ...
Epoch: 16 cost time: 1.0972731113433838
Epoch: 16, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.878 Vali Acc: 0.731 Test Loss: 0.878 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0018794536590576
Epoch: 17, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.865 Vali Acc: 0.731 Test Loss: 0.865 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0237042903900146
Epoch: 18, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9179329872131348
Epoch: 19, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.838 Vali Acc: 0.741 Test Loss: 0.838 Test Acc: 0.741
Validation loss decreased (-0.734366 --> -0.740617).  Saving model ...
Epoch: 20 cost time: 1.0257563591003418
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
Validation loss decreased (-0.740617 --> -0.743742).  Saving model ...
Epoch: 21 cost time: 1.098191499710083
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.825 Vali Acc: 0.759 Test Loss: 0.825 Test Acc: 0.759
Validation loss decreased (-0.743742 --> -0.759367).  Saving model ...
Epoch: 22 cost time: 1.1144015789031982
Epoch: 22, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.821 Vali Acc: 0.747 Test Loss: 0.821 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0437819957733154
Epoch: 23, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0956964492797852
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.810 Vali Acc: 0.747 Test Loss: 0.810 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2317099571228027
Epoch: 25, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.806 Vali Acc: 0.747 Test Loss: 0.806 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.092115879058838
Epoch: 26, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1799578666687012
Epoch: 27, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.125166654586792
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.801 Vali Acc: 0.756 Test Loss: 0.801 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1004581451416016
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.105358362197876
Epoch: 30, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1399188041687012
Epoch: 31, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.791 Vali Acc: 0.753 Test Loss: 0.791 Test Acc: 0.753
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 343064
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.303499937057495
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.108 Vali Acc: 0.138 Test Loss: 2.108 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.9098911285400391
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.992 Vali Acc: 0.244 Test Loss: 1.992 Test Acc: 0.244
Validation loss decreased (-0.137479 --> -0.243730).  Saving model ...
Epoch: 3 cost time: 0.9315695762634277
Epoch: 3, Steps: 8 | Train Loss: 1.726 Vali Loss: 1.836 Vali Acc: 0.397 Test Loss: 1.836 Test Acc: 0.397
Validation loss decreased (-0.243730 --> -0.396857).  Saving model ...
Epoch: 4 cost time: 0.8595688343048096
Epoch: 4, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.681 Vali Acc: 0.497 Test Loss: 1.681 Test Acc: 0.497
Validation loss decreased (-0.396857 --> -0.496858).  Saving model ...
Epoch: 5 cost time: 0.9049811363220215
Epoch: 5, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.545 Vali Acc: 0.575 Test Loss: 1.545 Test Acc: 0.575
Validation loss decreased (-0.496858 --> -0.574985).  Saving model ...
Epoch: 6 cost time: 0.8740346431732178
Epoch: 6, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.417 Vali Acc: 0.622 Test Loss: 1.417 Test Acc: 0.622
Validation loss decreased (-0.574985 --> -0.621861).  Saving model ...
Epoch: 7 cost time: 0.9274508953094482
Epoch: 7, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.312 Vali Acc: 0.644 Test Loss: 1.312 Test Acc: 0.644
Validation loss decreased (-0.621861 --> -0.643737).  Saving model ...
Epoch: 8 cost time: 0.8566906452178955
Epoch: 8, Steps: 8 | Train Loss: 0.689 Vali Loss: 1.229 Vali Acc: 0.666 Test Loss: 1.229 Test Acc: 0.666
Validation loss decreased (-0.643737 --> -0.665613).  Saving model ...
Epoch: 9 cost time: 0.9557199478149414
Epoch: 9, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.154 Vali Acc: 0.681 Test Loss: 1.154 Test Acc: 0.681
Validation loss decreased (-0.665613 --> -0.681238).  Saving model ...
Epoch: 10 cost time: 0.9264812469482422
Epoch: 10, Steps: 8 | Train Loss: 0.464 Vali Loss: 1.090 Vali Acc: 0.697 Test Loss: 1.090 Test Acc: 0.697
Validation loss decreased (-0.681238 --> -0.696864).  Saving model ...
Epoch: 11 cost time: 0.9695022106170654
Epoch: 11, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.036 Vali Acc: 0.722 Test Loss: 1.036 Test Acc: 0.722
Validation loss decreased (-0.696864 --> -0.721865).  Saving model ...
Epoch: 12 cost time: 0.9759702682495117
Epoch: 12, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
Validation loss decreased (-0.721865 --> -0.721865).  Saving model ...
Epoch: 13 cost time: 0.9047451019287109
Epoch: 13, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.721865 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.8723640441894531
Epoch: 14, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.827174186706543
Epoch: 15, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.907 Vali Acc: 0.728 Test Loss: 0.907 Test Acc: 0.728
Validation loss decreased (-0.724990 --> -0.728116).  Saving model ...
Epoch: 16 cost time: 0.9953873157501221
Epoch: 16, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.728116 --> -0.728116).  Saving model ...
Epoch: 17 cost time: 0.9516220092773438
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.874 Vali Acc: 0.731 Test Loss: 0.874 Test Acc: 0.731
Validation loss decreased (-0.728116 --> -0.731241).  Saving model ...
Epoch: 18 cost time: 1.121654748916626
Epoch: 18, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.862 Vali Acc: 0.738 Test Loss: 0.862 Test Acc: 0.738
Validation loss decreased (-0.731241 --> -0.737491).  Saving model ...
Epoch: 19 cost time: 0.9772825241088867
Epoch: 19, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.850 Vali Acc: 0.738 Test Loss: 0.850 Test Acc: 0.738
Validation loss decreased (-0.737491 --> -0.737492).  Saving model ...
Epoch: 20 cost time: 0.9649162292480469
Epoch: 20, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
Validation loss decreased (-0.737492 --> -0.743742).  Saving model ...
Epoch: 21 cost time: 0.9339525699615479
Epoch: 21, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.834 Vali Acc: 0.741 Test Loss: 0.834 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.959820032119751
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.829 Vali Acc: 0.741 Test Loss: 0.829 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0905063152313232
Epoch: 23, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.821 Vali Acc: 0.741 Test Loss: 0.821 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9107785224914551
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.817 Vali Acc: 0.734 Test Loss: 0.817 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9181218147277832
Epoch: 25, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.814 Vali Acc: 0.738 Test Loss: 0.814 Test Acc: 0.738
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9801368713378906
Epoch: 26, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.810 Vali Acc: 0.738 Test Loss: 0.810 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.866086483001709
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.807 Vali Acc: 0.731 Test Loss: 0.807 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.985238790512085
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.803 Vali Acc: 0.731 Test Loss: 0.803 Test Acc: 0.731
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.993025541305542
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.800 Vali Acc: 0.728 Test Loss: 0.800 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9761254787445068
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.798 Vali Acc: 0.731 Test Loss: 0.798 Test Acc: 0.731
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.74375
model parameter : 338968
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.92289137840271
Epoch: 1, Steps: 8 | Train Loss: 2.230 Vali Loss: 2.189 Vali Acc: 0.072 Test Loss: 2.189 Test Acc: 0.072
Validation loss decreased (inf --> -0.071853).  Saving model ...
Epoch: 2 cost time: 0.6337571144104004
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 2.070 Vali Acc: 0.141 Test Loss: 2.070 Test Acc: 0.141
Validation loss decreased (-0.071853 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.6824970245361328
Epoch: 3, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.920 Vali Acc: 0.312 Test Loss: 1.920 Test Acc: 0.312
Validation loss decreased (-0.140604 --> -0.312481).  Saving model ...
Epoch: 4 cost time: 0.6525332927703857
Epoch: 4, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.754 Vali Acc: 0.494 Test Loss: 1.754 Test Acc: 0.494
Validation loss decreased (-0.312481 --> -0.493732).  Saving model ...
Epoch: 5 cost time: 0.8269641399383545
Epoch: 5, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.615 Vali Acc: 0.594 Test Loss: 1.615 Test Acc: 0.594
Validation loss decreased (-0.493732 --> -0.593734).  Saving model ...
Epoch: 6 cost time: 0.6452689170837402
Epoch: 6, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.477 Vali Acc: 0.647 Test Loss: 1.477 Test Acc: 0.647
Validation loss decreased (-0.593734 --> -0.646860).  Saving model ...
Epoch: 7 cost time: 0.7024948596954346
Epoch: 7, Steps: 8 | Train Loss: 0.898 Vali Loss: 1.355 Vali Acc: 0.678 Test Loss: 1.355 Test Acc: 0.678
Validation loss decreased (-0.646860 --> -0.678111).  Saving model ...
Epoch: 8 cost time: 0.6863410472869873
Epoch: 8, Steps: 8 | Train Loss: 0.753 Vali Loss: 1.254 Vali Acc: 0.700 Test Loss: 1.254 Test Acc: 0.700
Validation loss decreased (-0.678111 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 0.6523058414459229
Epoch: 9, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.173 Vali Acc: 0.716 Test Loss: 1.173 Test Acc: 0.716
Validation loss decreased (-0.699987 --> -0.715613).  Saving model ...
Epoch: 10 cost time: 0.6551282405853271
Epoch: 10, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.094 Vali Acc: 0.734 Test Loss: 1.094 Test Acc: 0.734
Validation loss decreased (-0.715613 --> -0.734364).  Saving model ...
Epoch: 11 cost time: 0.6799101829528809
Epoch: 11, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.040 Vali Acc: 0.731 Test Loss: 1.040 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6986911296844482
Epoch: 12, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.989 Vali Acc: 0.744 Test Loss: 0.989 Test Acc: 0.744
Validation loss decreased (-0.734364 --> -0.743740).  Saving model ...
Epoch: 13 cost time: 0.7467391490936279
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.743740 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.7066290378570557
Epoch: 14, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.920 Vali Acc: 0.741 Test Loss: 0.920 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8160221576690674
Epoch: 15, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.890 Vali Acc: 0.734 Test Loss: 0.890 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7491364479064941
Epoch: 16, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.7883837223052979
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.7219834327697754
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.685410737991333
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.846 Vali Acc: 0.744 Test Loss: 0.846 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.718639612197876
Epoch: 20, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.7890779972076416
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.829 Vali Acc: 0.747 Test Loss: 0.829 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7454288005828857
Epoch: 22, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.823 Vali Acc: 0.747 Test Loss: 0.823 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7689666748046875
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7604210376739502
Epoch: 24, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.818 Vali Acc: 0.747 Test Loss: 0.818 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8265752792358398
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.816 Vali Acc: 0.747 Test Loss: 0.816 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7665343284606934
Epoch: 26, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.813 Vali Acc: 0.747 Test Loss: 0.813 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7375223636627197
Epoch: 27, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 0.7725076675415039
Epoch: 28, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.807 Vali Acc: 0.753 Test Loss: 0.807 Test Acc: 0.753
Validation loss decreased (-0.749992 --> -0.753117).  Saving model ...
Epoch: 29 cost time: 0.7463281154632568
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.806 Vali Acc: 0.753 Test Loss: 0.806 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 30 cost time: 0.745020866394043
Epoch: 30, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.803 Vali Acc: 0.753 Test Loss: 0.803 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 31 cost time: 0.7436752319335938
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.753117 --> -0.756242).  Saving model ...
Epoch: 32 cost time: 0.7383005619049072
Epoch: 32, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 33 cost time: 0.7656528949737549
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.801 Vali Acc: 0.756 Test Loss: 0.801 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 34 cost time: 0.7419002056121826
Epoch: 34, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 35 cost time: 0.7962460517883301
Epoch: 35, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.794 Vali Acc: 0.753 Test Loss: 0.794 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7452361583709717
Epoch: 36, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 37 cost time: 0.7380547523498535
Epoch: 37, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 38 cost time: 0.7535312175750732
Epoch: 38, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 39 cost time: 0.6794469356536865
Epoch: 39, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.793 Vali Acc: 0.759 Test Loss: 0.793 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7112674713134766
Epoch: 40, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.683258056640625
Epoch: 41, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.793 Vali Acc: 0.753 Test Loss: 0.793 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7392399311065674
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.792 Vali Acc: 0.753 Test Loss: 0.792 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7700550556182861
Epoch: 43, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.793 Vali Acc: 0.753 Test Loss: 0.793 Test Acc: 0.753
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8606219291687012
Epoch: 44, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.756 Test Loss: 0.792 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7748384475708008
Epoch: 45, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.753 Test Loss: 0.792 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7808220386505127
Epoch: 46, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8053748607635498
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.753 Test Loss: 0.793 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7145187854766846
Epoch: 48, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 335896
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2795798778533936
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 2.130 Vali Acc: 0.125 Test Loss: 2.130 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 0.7073636054992676
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 2.009 Vali Acc: 0.191 Test Loss: 2.009 Test Acc: 0.191
Validation loss decreased (-0.124979 --> -0.190605).  Saving model ...
Epoch: 3 cost time: 0.7043218612670898
Epoch: 3, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.846 Vali Acc: 0.366 Test Loss: 1.846 Test Acc: 0.366
Validation loss decreased (-0.190605 --> -0.365607).  Saving model ...
Epoch: 4 cost time: 0.771451473236084
Epoch: 4, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.685 Vali Acc: 0.531 Test Loss: 1.685 Test Acc: 0.531
Validation loss decreased (-0.365607 --> -0.531233).  Saving model ...
Epoch: 5 cost time: 0.6985211372375488
Epoch: 5, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.536 Vali Acc: 0.619 Test Loss: 1.536 Test Acc: 0.619
Validation loss decreased (-0.531233 --> -0.618735).  Saving model ...
Epoch: 6 cost time: 0.7385294437408447
Epoch: 6, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.406 Vali Acc: 0.641 Test Loss: 1.406 Test Acc: 0.641
Validation loss decreased (-0.618735 --> -0.640611).  Saving model ...
Epoch: 7 cost time: 0.6836235523223877
Epoch: 7, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.294 Vali Acc: 0.666 Test Loss: 1.294 Test Acc: 0.666
Validation loss decreased (-0.640611 --> -0.665612).  Saving model ...
Epoch: 8 cost time: 0.6319808959960938
Epoch: 8, Steps: 8 | Train Loss: 0.673 Vali Loss: 1.194 Vali Acc: 0.703 Test Loss: 1.194 Test Acc: 0.703
Validation loss decreased (-0.665612 --> -0.703113).  Saving model ...
Epoch: 9 cost time: 0.6802845001220703
Epoch: 9, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.110 Vali Acc: 0.713 Test Loss: 1.110 Test Acc: 0.713
Validation loss decreased (-0.703113 --> -0.712489).  Saving model ...
Epoch: 10 cost time: 0.6842126846313477
Epoch: 10, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.043 Vali Acc: 0.725 Test Loss: 1.043 Test Acc: 0.725
Validation loss decreased (-0.712489 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.6373348236083984
Epoch: 11, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.997 Vali Acc: 0.731 Test Loss: 0.997 Test Acc: 0.731
Validation loss decreased (-0.724990 --> -0.731240).  Saving model ...
Epoch: 12 cost time: 0.6728484630584717
Epoch: 12, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.957 Vali Acc: 0.731 Test Loss: 0.957 Test Acc: 0.731
Validation loss decreased (-0.731240 --> -0.731240).  Saving model ...
Epoch: 13 cost time: 0.701284646987915
Epoch: 13, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
Validation loss decreased (-0.731240 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7034380435943604
Epoch: 14, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.899 Vali Acc: 0.747 Test Loss: 0.899 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6350176334381104
Epoch: 15, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.5360918045043945
Epoch: 16, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.609074592590332
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.850 Vali Acc: 0.766 Test Loss: 0.850 Test Acc: 0.766
Validation loss decreased (-0.749991 --> -0.765616).  Saving model ...
Epoch: 18 cost time: 0.711930513381958
Epoch: 18, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.840 Vali Acc: 0.762 Test Loss: 0.840 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6384727954864502
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6247837543487549
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6002731323242188
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.759 Test Loss: 0.818 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5846328735351562
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.647972583770752
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.807 Vali Acc: 0.753 Test Loss: 0.807 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7373180389404297
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7179946899414062
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7086877822875977
Epoch: 26, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.796 Vali Acc: 0.753 Test Loss: 0.796 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7253179550170898
Epoch: 27, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.765625
model parameter : 334360
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8634047508239746
Epoch: 1, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.196 Vali Acc: 0.072 Test Loss: 2.196 Test Acc: 0.072
Validation loss decreased (inf --> -0.071853).  Saving model ...
Epoch: 2 cost time: 0.564598798751831
Epoch: 2, Steps: 8 | Train Loss: 2.028 Vali Loss: 2.069 Vali Acc: 0.156 Test Loss: 2.069 Test Acc: 0.156
Validation loss decreased (-0.071853 --> -0.156229).  Saving model ...
Epoch: 3 cost time: 0.531503438949585
Epoch: 3, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.887 Vali Acc: 0.353 Test Loss: 1.887 Test Acc: 0.353
Validation loss decreased (-0.156229 --> -0.353106).  Saving model ...
Epoch: 4 cost time: 0.5501959323883057
Epoch: 4, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.700 Vali Acc: 0.525 Test Loss: 1.700 Test Acc: 0.525
Validation loss decreased (-0.353106 --> -0.524983).  Saving model ...
Epoch: 5 cost time: 0.5484542846679688
Epoch: 5, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.534 Vali Acc: 0.606 Test Loss: 1.534 Test Acc: 0.606
Validation loss decreased (-0.524983 --> -0.606235).  Saving model ...
Epoch: 6 cost time: 0.5831520557403564
Epoch: 6, Steps: 8 | Train Loss: 0.989 Vali Loss: 1.395 Vali Acc: 0.625 Test Loss: 1.395 Test Acc: 0.625
Validation loss decreased (-0.606235 --> -0.624986).  Saving model ...
Epoch: 7 cost time: 0.5724284648895264
Epoch: 7, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.284 Vali Acc: 0.656 Test Loss: 1.284 Test Acc: 0.656
Validation loss decreased (-0.624986 --> -0.656237).  Saving model ...
Epoch: 8 cost time: 0.5629842281341553
Epoch: 8, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.191 Vali Acc: 0.675 Test Loss: 1.191 Test Acc: 0.675
Validation loss decreased (-0.656237 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.5334930419921875
Epoch: 9, Steps: 8 | Train Loss: 0.475 Vali Loss: 1.114 Vali Acc: 0.716 Test Loss: 1.114 Test Acc: 0.716
Validation loss decreased (-0.674988 --> -0.715614).  Saving model ...
Epoch: 10 cost time: 0.5238611698150635
Epoch: 10, Steps: 8 | Train Loss: 0.374 Vali Loss: 1.054 Vali Acc: 0.725 Test Loss: 1.054 Test Acc: 0.725
Validation loss decreased (-0.715614 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.5955672264099121
Epoch: 11, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.006 Vali Acc: 0.716 Test Loss: 1.006 Test Acc: 0.716
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5939607620239258
Epoch: 12, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.573634147644043
Epoch: 13, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.5653786659240723
Epoch: 14, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.910 Vali Acc: 0.731 Test Loss: 0.910 Test Acc: 0.731
Validation loss decreased (-0.724991 --> -0.731241).  Saving model ...
Epoch: 15 cost time: 0.6225676536560059
Epoch: 15, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.898 Vali Acc: 0.734 Test Loss: 0.898 Test Acc: 0.734
Validation loss decreased (-0.731241 --> -0.734366).  Saving model ...
Epoch: 16 cost time: 0.5480761528015137
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6083831787109375
Epoch: 17, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.873 Vali Acc: 0.731 Test Loss: 0.873 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6082713603973389
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.862 Vali Acc: 0.731 Test Loss: 0.862 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5712976455688477
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.853 Vali Acc: 0.738 Test Loss: 0.853 Test Acc: 0.738
Validation loss decreased (-0.734366 --> -0.737491).  Saving model ...
Epoch: 20 cost time: 0.5436525344848633
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.845 Vali Acc: 0.738 Test Loss: 0.845 Test Acc: 0.738
Validation loss decreased (-0.737491 --> -0.737492).  Saving model ...
Epoch: 21 cost time: 0.4886598587036133
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.843 Vali Acc: 0.738 Test Loss: 0.843 Test Acc: 0.738
Validation loss decreased (-0.737492 --> -0.737492).  Saving model ...
Epoch: 22 cost time: 0.47913026809692383
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.841 Vali Acc: 0.731 Test Loss: 0.841 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5203921794891357
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5998039245605469
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.833 Vali Acc: 0.731 Test Loss: 0.833 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5093154907226562
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.830 Vali Acc: 0.731 Test Loss: 0.830 Test Acc: 0.731
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5443041324615479
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.827 Vali Acc: 0.731 Test Loss: 0.827 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5830767154693604
Epoch: 27, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.827 Vali Acc: 0.725 Test Loss: 0.827 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6352152824401855
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.824 Vali Acc: 0.725 Test Loss: 0.824 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5890593528747559
Epoch: 29, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5185408592224121
Epoch: 30, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.819 Vali Acc: 0.728 Test Loss: 0.819 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5513215065002441
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7375
model parameter : 332824
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6919281482696533
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.055 Vali Acc: 0.181 Test Loss: 2.055 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.5591657161712646
Epoch: 2, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.902 Vali Acc: 0.297 Test Loss: 1.902 Test Acc: 0.297
Validation loss decreased (-0.181229 --> -0.296856).  Saving model ...
Epoch: 3 cost time: 0.5326423645019531
Epoch: 3, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.722 Vali Acc: 0.450 Test Loss: 1.722 Test Acc: 0.450
Validation loss decreased (-0.296856 --> -0.449983).  Saving model ...
Epoch: 4 cost time: 0.5797369480133057
Epoch: 4, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.558 Vali Acc: 0.600 Test Loss: 1.558 Test Acc: 0.600
Validation loss decreased (-0.449983 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 0.5191559791564941
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.406 Vali Acc: 0.672 Test Loss: 1.406 Test Acc: 0.672
Validation loss decreased (-0.599984 --> -0.671861).  Saving model ...
Epoch: 6 cost time: 0.4297928810119629
Epoch: 6, Steps: 8 | Train Loss: 0.886 Vali Loss: 1.305 Vali Acc: 0.672 Test Loss: 1.305 Test Acc: 0.672
Validation loss decreased (-0.671861 --> -0.671862).  Saving model ...
Epoch: 7 cost time: 0.4354841709136963
Epoch: 7, Steps: 8 | Train Loss: 0.735 Vali Loss: 1.204 Vali Acc: 0.709 Test Loss: 1.204 Test Acc: 0.709
Validation loss decreased (-0.671862 --> -0.709363).  Saving model ...
Epoch: 8 cost time: 0.4653911590576172
Epoch: 8, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.123 Vali Acc: 0.719 Test Loss: 1.123 Test Acc: 0.719
Validation loss decreased (-0.709363 --> -0.718739).  Saving model ...
Epoch: 9 cost time: 0.5648453235626221
Epoch: 9, Steps: 8 | Train Loss: 0.466 Vali Loss: 1.054 Vali Acc: 0.741 Test Loss: 1.054 Test Acc: 0.741
Validation loss decreased (-0.718739 --> -0.740614).  Saving model ...
Epoch: 10 cost time: 0.5878870487213135
Epoch: 10, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.998 Vali Acc: 0.731 Test Loss: 0.998 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.558375358581543
Epoch: 11, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.947 Vali Acc: 0.741 Test Loss: 0.947 Test Acc: 0.741
Validation loss decreased (-0.740614 --> -0.740616).  Saving model ...
Epoch: 12 cost time: 0.5317161083221436
Epoch: 12, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.900 Vali Acc: 0.747 Test Loss: 0.900 Test Acc: 0.747
Validation loss decreased (-0.740616 --> -0.746866).  Saving model ...
Epoch: 13 cost time: 0.5347628593444824
Epoch: 13, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.877 Vali Acc: 0.756 Test Loss: 0.877 Test Acc: 0.756
Validation loss decreased (-0.746866 --> -0.756241).  Saving model ...
Epoch: 14 cost time: 0.5240578651428223
Epoch: 14, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.853 Vali Acc: 0.741 Test Loss: 0.853 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4934992790222168
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.839 Vali Acc: 0.738 Test Loss: 0.839 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.43444371223449707
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.845 Vali Acc: 0.738 Test Loss: 0.845 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4353299140930176
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.835 Vali Acc: 0.738 Test Loss: 0.835 Test Acc: 0.738
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5566701889038086
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.46713733673095703
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.829 Vali Acc: 0.738 Test Loss: 0.829 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4927101135253906
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.829 Vali Acc: 0.734 Test Loss: 0.829 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.41031551361083984
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.829 Vali Acc: 0.738 Test Loss: 0.829 Test Acc: 0.738
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.44928646087646484
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.828 Vali Acc: 0.734 Test Loss: 0.828 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.540520429611206
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.831 Vali Acc: 0.731 Test Loss: 0.831 Test Acc: 0.731
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75625
model parameter : 331288
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.028778553009033
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.059 Vali Acc: 0.134 Test Loss: 2.059 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.5990231037139893
Epoch: 2, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.990 Vali Acc: 0.209 Test Loss: 1.990 Test Acc: 0.209
Validation loss decreased (-0.134354 --> -0.209355).  Saving model ...
Epoch: 3 cost time: 1.6110601425170898
Epoch: 3, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.893 Vali Acc: 0.344 Test Loss: 1.893 Test Acc: 0.344
Validation loss decreased (-0.209355 --> -0.343731).  Saving model ...
Epoch: 4 cost time: 1.6192872524261475
Epoch: 4, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.787 Vali Acc: 0.472 Test Loss: 1.787 Test Acc: 0.472
Validation loss decreased (-0.343731 --> -0.471857).  Saving model ...
Epoch: 5 cost time: 1.6104822158813477
Epoch: 5, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.676 Vali Acc: 0.534 Test Loss: 1.676 Test Acc: 0.534
Validation loss decreased (-0.471857 --> -0.534358).  Saving model ...
Epoch: 6 cost time: 1.6156864166259766
Epoch: 6, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.564 Vali Acc: 0.616 Test Loss: 1.564 Test Acc: 0.616
Validation loss decreased (-0.534358 --> -0.615609).  Saving model ...
Epoch: 7 cost time: 1.4925811290740967
Epoch: 7, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.460 Vali Acc: 0.647 Test Loss: 1.460 Test Acc: 0.647
Validation loss decreased (-0.615609 --> -0.646860).  Saving model ...
Epoch: 8 cost time: 1.6033403873443604
Epoch: 8, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.358 Vali Acc: 0.669 Test Loss: 1.358 Test Acc: 0.669
Validation loss decreased (-0.646860 --> -0.668736).  Saving model ...
Epoch: 9 cost time: 1.5599992275238037
Epoch: 9, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.266 Vali Acc: 0.688 Test Loss: 1.266 Test Acc: 0.688
Validation loss decreased (-0.668736 --> -0.687487).  Saving model ...
Epoch: 10 cost time: 1.5394513607025146
Epoch: 10, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.184 Vali Acc: 0.703 Test Loss: 1.184 Test Acc: 0.703
Validation loss decreased (-0.687487 --> -0.703113).  Saving model ...
Epoch: 11 cost time: 1.4888477325439453
Epoch: 11, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.116 Vali Acc: 0.706 Test Loss: 1.116 Test Acc: 0.706
Validation loss decreased (-0.703113 --> -0.706239).  Saving model ...
Epoch: 12 cost time: 1.4534716606140137
Epoch: 12, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.060 Vali Acc: 0.709 Test Loss: 1.060 Test Acc: 0.709
Validation loss decreased (-0.706239 --> -0.709364).  Saving model ...
Epoch: 13 cost time: 1.4229552745819092
Epoch: 13, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.013 Vali Acc: 0.709 Test Loss: 1.013 Test Acc: 0.709
Validation loss decreased (-0.709364 --> -0.709365).  Saving model ...
Epoch: 14 cost time: 1.371255874633789
Epoch: 14, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.972 Vali Acc: 0.713 Test Loss: 0.972 Test Acc: 0.713
Validation loss decreased (-0.709365 --> -0.712490).  Saving model ...
Epoch: 15 cost time: 1.4748423099517822
Epoch: 15, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
Validation loss decreased (-0.712490 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 1.3796615600585938
Epoch: 16, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.908 Vali Acc: 0.731 Test Loss: 0.908 Test Acc: 0.731
Validation loss decreased (-0.724991 --> -0.731241).  Saving model ...
Epoch: 17 cost time: 1.4570167064666748
Epoch: 17, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5695335865020752
Epoch: 18, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.861 Vali Acc: 0.728 Test Loss: 0.861 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4782819747924805
Epoch: 19, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.839 Vali Acc: 0.738 Test Loss: 0.839 Test Acc: 0.738
Validation loss decreased (-0.731241 --> -0.737492).  Saving model ...
Epoch: 20 cost time: 1.422262191772461
Epoch: 20, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.822 Vali Acc: 0.738 Test Loss: 0.822 Test Acc: 0.738
Validation loss decreased (-0.737492 --> -0.737492).  Saving model ...
Epoch: 21 cost time: 1.4134409427642822
Epoch: 21, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.807 Vali Acc: 0.741 Test Loss: 0.807 Test Acc: 0.741
Validation loss decreased (-0.737492 --> -0.740617).  Saving model ...
Epoch: 22 cost time: 1.4174411296844482
Epoch: 22, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.740617 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.4554386138916016
Epoch: 23, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.786 Vali Acc: 0.753 Test Loss: 0.786 Test Acc: 0.753
Validation loss decreased (-0.749992 --> -0.753117).  Saving model ...
Epoch: 24 cost time: 1.489307165145874
Epoch: 24, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.775 Vali Acc: 0.753 Test Loss: 0.775 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 25 cost time: 1.5476903915405273
Epoch: 25, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.765 Vali Acc: 0.756 Test Loss: 0.765 Test Acc: 0.756
Validation loss decreased (-0.753117 --> -0.756242).  Saving model ...
Epoch: 26 cost time: 1.498459815979004
Epoch: 26, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.757 Vali Acc: 0.759 Test Loss: 0.757 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 27 cost time: 1.4418120384216309
Epoch: 27, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.749 Vali Acc: 0.766 Test Loss: 0.749 Test Acc: 0.766
Validation loss decreased (-0.759367 --> -0.765618).  Saving model ...
Epoch: 28 cost time: 1.5258233547210693
Epoch: 28, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.744 Vali Acc: 0.747 Test Loss: 0.744 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5257582664489746
Epoch: 29, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.737 Vali Acc: 0.744 Test Loss: 0.737 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4443609714508057
Epoch: 30, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.732 Vali Acc: 0.741 Test Loss: 0.732 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3991446495056152
Epoch: 31, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.323965311050415
Epoch: 32, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3289198875427246
Epoch: 33, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.718 Vali Acc: 0.747 Test Loss: 0.718 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2899250984191895
Epoch: 34, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.45157790184021
Epoch: 35, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.707 Vali Acc: 0.753 Test Loss: 0.707 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4555168151855469
Epoch: 36, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.706 Vali Acc: 0.753 Test Loss: 0.706 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.419832468032837
Epoch: 37, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.703 Vali Acc: 0.753 Test Loss: 0.703 Test Acc: 0.753
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.765625
model parameter : 179770
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6932973861694336
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 2.100 Vali Acc: 0.134 Test Loss: 2.100 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.4159107208251953
Epoch: 2, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.038 Vali Acc: 0.163 Test Loss: 2.038 Test Acc: 0.163
Validation loss decreased (-0.134354 --> -0.162480).  Saving model ...
Epoch: 3 cost time: 1.351241111755371
Epoch: 3, Steps: 8 | Train Loss: 1.986 Vali Loss: 1.952 Vali Acc: 0.231 Test Loss: 1.952 Test Acc: 0.231
Validation loss decreased (-0.162480 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 1.318073034286499
Epoch: 4, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.849 Vali Acc: 0.338 Test Loss: 1.849 Test Acc: 0.338
Validation loss decreased (-0.231230 --> -0.337482).  Saving model ...
Epoch: 5 cost time: 1.3506860733032227
Epoch: 5, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.740 Vali Acc: 0.484 Test Loss: 1.740 Test Acc: 0.484
Validation loss decreased (-0.337482 --> -0.484358).  Saving model ...
Epoch: 6 cost time: 1.3242135047912598
Epoch: 6, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.627 Vali Acc: 0.578 Test Loss: 1.627 Test Acc: 0.578
Validation loss decreased (-0.484358 --> -0.578109).  Saving model ...
Epoch: 7 cost time: 1.3743009567260742
Epoch: 7, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.521 Vali Acc: 0.625 Test Loss: 1.521 Test Acc: 0.625
Validation loss decreased (-0.578109 --> -0.624985).  Saving model ...
Epoch: 8 cost time: 1.441002368927002
Epoch: 8, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.416 Vali Acc: 0.656 Test Loss: 1.416 Test Acc: 0.656
Validation loss decreased (-0.624985 --> -0.656236).  Saving model ...
Epoch: 9 cost time: 1.2331018447875977
Epoch: 9, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.326 Vali Acc: 0.675 Test Loss: 1.326 Test Acc: 0.675
Validation loss decreased (-0.656236 --> -0.674987).  Saving model ...
Epoch: 10 cost time: 1.2372238636016846
Epoch: 10, Steps: 8 | Train Loss: 1.001 Vali Loss: 1.246 Vali Acc: 0.706 Test Loss: 1.246 Test Acc: 0.706
Validation loss decreased (-0.674987 --> -0.706238).  Saving model ...
Epoch: 11 cost time: 1.283339023590088
Epoch: 11, Steps: 8 | Train Loss: 0.893 Vali Loss: 1.171 Vali Acc: 0.722 Test Loss: 1.171 Test Acc: 0.722
Validation loss decreased (-0.706238 --> -0.721863).  Saving model ...
Epoch: 12 cost time: 1.2050201892852783
Epoch: 12, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.104 Vali Acc: 0.738 Test Loss: 1.104 Test Acc: 0.738
Validation loss decreased (-0.721863 --> -0.737489).  Saving model ...
Epoch: 13 cost time: 1.3565151691436768
Epoch: 13, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.047 Vali Acc: 0.750 Test Loss: 1.047 Test Acc: 0.750
Validation loss decreased (-0.737489 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.2495312690734863
Epoch: 14, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.994 Vali Acc: 0.753 Test Loss: 0.994 Test Acc: 0.753
Validation loss decreased (-0.749990 --> -0.753115).  Saving model ...
Epoch: 15 cost time: 1.372189998626709
Epoch: 15, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.948 Vali Acc: 0.756 Test Loss: 0.948 Test Acc: 0.756
Validation loss decreased (-0.753115 --> -0.756241).  Saving model ...
Epoch: 16 cost time: 1.3557426929473877
Epoch: 16, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.910 Vali Acc: 0.753 Test Loss: 0.910 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3306686878204346
Epoch: 17, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756241).  Saving model ...
Epoch: 18 cost time: 1.3665127754211426
Epoch: 18, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.848 Vali Acc: 0.769 Test Loss: 0.848 Test Acc: 0.769
Validation loss decreased (-0.756241 --> -0.768742).  Saving model ...
Epoch: 19 cost time: 1.298365831375122
Epoch: 19, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.823 Vali Acc: 0.769 Test Loss: 0.823 Test Acc: 0.769
Validation loss decreased (-0.768742 --> -0.768742).  Saving model ...
Epoch: 20 cost time: 1.4422402381896973
Epoch: 20, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.768742 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 1.2740795612335205
Epoch: 21, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.786 Vali Acc: 0.784 Test Loss: 0.786 Test Acc: 0.784
Validation loss decreased (-0.774992 --> -0.784367).  Saving model ...
Epoch: 22 cost time: 1.2612535953521729
Epoch: 22, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.769 Vali Acc: 0.784 Test Loss: 0.769 Test Acc: 0.784
Validation loss decreased (-0.784367 --> -0.784367).  Saving model ...
Epoch: 23 cost time: 1.3245313167572021
Epoch: 23, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
Validation loss decreased (-0.784367 --> -0.803117).  Saving model ...
Epoch: 24 cost time: 1.201047658920288
Epoch: 24, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.741 Vali Acc: 0.806 Test Loss: 0.741 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 25 cost time: 1.3669354915618896
Epoch: 25, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.732 Vali Acc: 0.806 Test Loss: 0.732 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 26 cost time: 1.2481000423431396
Epoch: 26, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2817354202270508
Epoch: 27, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.312448501586914
Epoch: 28, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 29 cost time: 1.2072534561157227
Epoch: 29, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 30 cost time: 1.3827977180480957
Epoch: 30, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3048386573791504
Epoch: 31, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2194254398345947
Epoch: 32, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809368).  Saving model ...
Epoch: 33 cost time: 1.3441357612609863
Epoch: 33, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809368).  Saving model ...
Epoch: 34 cost time: 1.3980283737182617
Epoch: 34, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812493).  Saving model ...
Epoch: 35 cost time: 1.4473364353179932
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.659 Vali Acc: 0.806 Test Loss: 0.659 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2449567317962646
Epoch: 36, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 37 cost time: 1.351283311843872
Epoch: 37, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3673415184020996
Epoch: 38, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 39 cost time: 1.231921672821045
Epoch: 39, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4238557815551758
Epoch: 40, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2706151008605957
Epoch: 41, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.221881628036499
Epoch: 42, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3131084442138672
Epoch: 43, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.611849308013916
Epoch: 44, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2437608242034912
Epoch: 45, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1275756359100342
Epoch: 46, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.32743239402771
Epoch: 47, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2196717262268066
Epoch: 48, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w32_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8125
model parameter : 177722
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.310173511505127
Epoch: 1, Steps: 8 | Train Loss: 2.246 Vali Loss: 2.178 Vali Acc: 0.062 Test Loss: 2.178 Test Acc: 0.062
Validation loss decreased (inf --> -0.062478).  Saving model ...
Epoch: 2 cost time: 1.1337430477142334
Epoch: 2, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.113 Vali Acc: 0.113 Test Loss: 2.113 Test Acc: 0.113
Validation loss decreased (-0.062478 --> -0.112479).  Saving model ...
Epoch: 3 cost time: 1.185549259185791
Epoch: 3, Steps: 8 | Train Loss: 2.051 Vali Loss: 2.022 Vali Acc: 0.212 Test Loss: 2.022 Test Acc: 0.212
Validation loss decreased (-0.112479 --> -0.212480).  Saving model ...
Epoch: 4 cost time: 1.068230390548706
Epoch: 4, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.916 Vali Acc: 0.338 Test Loss: 1.916 Test Acc: 0.338
Validation loss decreased (-0.212480 --> -0.337481).  Saving model ...
Epoch: 5 cost time: 1.1899456977844238
Epoch: 5, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.807 Vali Acc: 0.394 Test Loss: 1.807 Test Acc: 0.394
Validation loss decreased (-0.337481 --> -0.393732).  Saving model ...
Epoch: 6 cost time: 1.042853593826294
Epoch: 6, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.701 Vali Acc: 0.450 Test Loss: 1.701 Test Acc: 0.450
Validation loss decreased (-0.393732 --> -0.449983).  Saving model ...
Epoch: 7 cost time: 1.0778343677520752
Epoch: 7, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.601 Vali Acc: 0.481 Test Loss: 1.601 Test Acc: 0.481
Validation loss decreased (-0.449983 --> -0.481234).  Saving model ...
Epoch: 8 cost time: 1.3061816692352295
Epoch: 8, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.509 Vali Acc: 0.506 Test Loss: 1.509 Test Acc: 0.506
Validation loss decreased (-0.481234 --> -0.506235).  Saving model ...
Epoch: 9 cost time: 1.193455696105957
Epoch: 9, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.425 Vali Acc: 0.531 Test Loss: 1.425 Test Acc: 0.531
Validation loss decreased (-0.506235 --> -0.531236).  Saving model ...
Epoch: 10 cost time: 1.3150782585144043
Epoch: 10, Steps: 8 | Train Loss: 1.053 Vali Loss: 1.351 Vali Acc: 0.544 Test Loss: 1.351 Test Acc: 0.544
Validation loss decreased (-0.531236 --> -0.543736).  Saving model ...
Epoch: 11 cost time: 1.144543170928955
Epoch: 11, Steps: 8 | Train Loss: 0.951 Vali Loss: 1.285 Vali Acc: 0.575 Test Loss: 1.285 Test Acc: 0.575
Validation loss decreased (-0.543736 --> -0.574987).  Saving model ...
Epoch: 12 cost time: 1.209904432296753
Epoch: 12, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.229 Vali Acc: 0.588 Test Loss: 1.229 Test Acc: 0.588
Validation loss decreased (-0.574987 --> -0.587488).  Saving model ...
Epoch: 13 cost time: 1.186981439590454
Epoch: 13, Steps: 8 | Train Loss: 0.762 Vali Loss: 1.180 Vali Acc: 0.603 Test Loss: 1.180 Test Acc: 0.603
Validation loss decreased (-0.587488 --> -0.603113).  Saving model ...
Epoch: 14 cost time: 1.1605167388916016
Epoch: 14, Steps: 8 | Train Loss: 0.698 Vali Loss: 1.142 Vali Acc: 0.613 Test Loss: 1.142 Test Acc: 0.613
Validation loss decreased (-0.603113 --> -0.612489).  Saving model ...
Epoch: 15 cost time: 1.1865770816802979
Epoch: 15, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.106 Vali Acc: 0.619 Test Loss: 1.106 Test Acc: 0.619
Validation loss decreased (-0.612489 --> -0.618739).  Saving model ...
Epoch: 16 cost time: 1.295475721359253
Epoch: 16, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.074 Vali Acc: 0.619 Test Loss: 1.074 Test Acc: 0.619
Validation loss decreased (-0.618739 --> -0.618739).  Saving model ...
Epoch: 17 cost time: 1.2256245613098145
Epoch: 17, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.047 Vali Acc: 0.637 Test Loss: 1.047 Test Acc: 0.637
Validation loss decreased (-0.618739 --> -0.637490).  Saving model ...
Epoch: 18 cost time: 1.2341601848602295
Epoch: 18, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.023 Vali Acc: 0.647 Test Loss: 1.023 Test Acc: 0.647
Validation loss decreased (-0.637490 --> -0.646865).  Saving model ...
Epoch: 19 cost time: 1.1476716995239258
Epoch: 19, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.006 Vali Acc: 0.641 Test Loss: 1.006 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0361366271972656
Epoch: 20, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.987 Vali Acc: 0.631 Test Loss: 0.987 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1359288692474365
Epoch: 21, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.978 Vali Acc: 0.650 Test Loss: 0.978 Test Acc: 0.650
Validation loss decreased (-0.646865 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 1.0619850158691406
Epoch: 22, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.966 Vali Acc: 0.644 Test Loss: 0.966 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2050001621246338
Epoch: 23, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 1.1777856349945068
Epoch: 24, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.951 Vali Acc: 0.656 Test Loss: 0.951 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.656240).  Saving model ...
Epoch: 25 cost time: 1.1282978057861328
Epoch: 25, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.942 Vali Acc: 0.650 Test Loss: 0.942 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.160783052444458
Epoch: 26, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.936 Vali Acc: 0.659 Test Loss: 0.936 Test Acc: 0.659
Validation loss decreased (-0.656240 --> -0.659366).  Saving model ...
Epoch: 27 cost time: 1.104116439819336
Epoch: 27, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.924 Vali Acc: 0.669 Test Loss: 0.924 Test Acc: 0.669
Validation loss decreased (-0.659366 --> -0.668741).  Saving model ...
Epoch: 28 cost time: 1.2129411697387695
Epoch: 28, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.916 Vali Acc: 0.662 Test Loss: 0.916 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1066386699676514
Epoch: 29, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
Validation loss decreased (-0.668741 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 1.1843562126159668
Epoch: 30, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.907 Vali Acc: 0.681 Test Loss: 0.907 Test Acc: 0.681
Validation loss decreased (-0.674991 --> -0.681241).  Saving model ...
Epoch: 31 cost time: 1.1973745822906494
Epoch: 31, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.907 Vali Acc: 0.684 Test Loss: 0.907 Test Acc: 0.684
Validation loss decreased (-0.681241 --> -0.684366).  Saving model ...
Epoch: 32 cost time: 1.2370519638061523
Epoch: 32, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.900 Vali Acc: 0.678 Test Loss: 0.900 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2690727710723877
Epoch: 33, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.894 Vali Acc: 0.688 Test Loss: 0.894 Test Acc: 0.688
Validation loss decreased (-0.684366 --> -0.687491).  Saving model ...
Epoch: 34 cost time: 1.1589164733886719
Epoch: 34, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.892 Vali Acc: 0.681 Test Loss: 0.892 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2343964576721191
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.890 Vali Acc: 0.678 Test Loss: 0.890 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3038878440856934
Epoch: 36, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.888 Vali Acc: 0.678 Test Loss: 0.888 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2541983127593994
Epoch: 37, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.889 Vali Acc: 0.684 Test Loss: 0.889 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2559854984283447
Epoch: 38, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.890 Vali Acc: 0.681 Test Loss: 0.890 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.330869197845459
Epoch: 39, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.885 Vali Acc: 0.681 Test Loss: 0.885 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1539151668548584
Epoch: 40, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.883 Vali Acc: 0.688 Test Loss: 0.883 Test Acc: 0.688
Validation loss decreased (-0.687491 --> -0.687491).  Saving model ...
Epoch: 41 cost time: 1.2510309219360352
Epoch: 41, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.880 Vali Acc: 0.684 Test Loss: 0.880 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1952815055847168
Epoch: 42, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.876 Vali Acc: 0.688 Test Loss: 0.876 Test Acc: 0.688
Validation loss decreased (-0.687491 --> -0.687491).  Saving model ...
Epoch: 43 cost time: 1.2273533344268799
Epoch: 43, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.687491 --> -0.693741).  Saving model ...
Epoch: 44 cost time: 1.1312572956085205
Epoch: 44, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.870 Vali Acc: 0.694 Test Loss: 0.870 Test Acc: 0.694
Validation loss decreased (-0.693741 --> -0.693741).  Saving model ...
Epoch: 45 cost time: 1.2715365886688232
Epoch: 45, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.871 Vali Acc: 0.681 Test Loss: 0.871 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.17765212059021
Epoch: 46, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.870 Vali Acc: 0.681 Test Loss: 0.870 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0687792301177979
Epoch: 47, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.868 Vali Acc: 0.688 Test Loss: 0.868 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0554242134094238
Epoch: 48, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.868 Vali Acc: 0.684 Test Loss: 0.868 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1493160724639893
Epoch: 49, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.867 Vali Acc: 0.691 Test Loss: 0.867 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1563670635223389
Epoch: 50, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.866 Vali Acc: 0.697 Test Loss: 0.866 Test Acc: 0.697
Validation loss decreased (-0.693741 --> -0.696866).  Saving model ...
Epoch: 51 cost time: 1.1074659824371338
Epoch: 51, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.867 Vali Acc: 0.691 Test Loss: 0.867 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1439518928527832
Epoch: 52, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.865 Vali Acc: 0.691 Test Loss: 0.865 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1586134433746338
Epoch: 53, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2723779678344727
Epoch: 54, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.865 Vali Acc: 0.694 Test Loss: 0.865 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.5068714618682861
Epoch: 55, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.863 Vali Acc: 0.694 Test Loss: 0.863 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.1881005764007568
Epoch: 56, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.863 Vali Acc: 0.694 Test Loss: 0.863 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.1838047504425049
Epoch: 57, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.863 Vali Acc: 0.688 Test Loss: 0.863 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2659084796905518
Epoch: 58, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.862 Vali Acc: 0.691 Test Loss: 0.862 Test Acc: 0.691
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1666853427886963
Epoch: 59, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.864 Vali Acc: 0.697 Test Loss: 0.864 Test Acc: 0.697
Validation loss decreased (-0.696866 --> -0.696866).  Saving model ...
Epoch: 60 cost time: 1.242945909500122
Epoch: 60, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.865 Vali Acc: 0.694 Test Loss: 0.865 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2864866256713867
Epoch: 61, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.228318691253662
Epoch: 62, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.867 Vali Acc: 0.691 Test Loss: 0.867 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.2058148384094238
Epoch: 63, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.867 Vali Acc: 0.694 Test Loss: 0.867 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2728595733642578
Epoch: 64, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.866 Vali Acc: 0.697 Test Loss: 0.866 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.2136967182159424
Epoch: 65, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.696866 --> -0.699991).  Saving model ...
Epoch: 66 cost time: 1.0561473369598389
Epoch: 66, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.869 Vali Acc: 0.697 Test Loss: 0.869 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0142240524291992
Epoch: 67, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.870 Vali Acc: 0.694 Test Loss: 0.870 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0617575645446777
Epoch: 68, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.873 Vali Acc: 0.694 Test Loss: 0.873 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1610522270202637
Epoch: 69, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.874 Vali Acc: 0.697 Test Loss: 0.874 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1593017578125
Epoch: 70, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.874 Vali Acc: 0.700 Test Loss: 0.874 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.0838184356689453
Epoch: 71, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.874 Vali Acc: 0.703 Test Loss: 0.874 Test Acc: 0.703
Validation loss decreased (-0.699991 --> -0.703116).  Saving model ...
Epoch: 72 cost time: 1.0891358852386475
Epoch: 72, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.703 Test Loss: 0.875 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0239529609680176
Epoch: 73, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.876 Vali Acc: 0.706 Test Loss: 0.876 Test Acc: 0.706
Validation loss decreased (-0.703116 --> -0.706241).  Saving model ...
Epoch: 74 cost time: 1.0114037990570068
Epoch: 74, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.874 Vali Acc: 0.706 Test Loss: 0.874 Test Acc: 0.706
Validation loss decreased (-0.706241 --> -0.706241).  Saving model ...
Epoch: 75 cost time: 1.1132354736328125
Epoch: 75, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9824998378753662
Epoch: 76, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.877 Vali Acc: 0.706 Test Loss: 0.877 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.977454662322998
Epoch: 77, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.879 Vali Acc: 0.703 Test Loss: 0.879 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.126483678817749
Epoch: 78, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.879 Vali Acc: 0.703 Test Loss: 0.879 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.224646806716919
Epoch: 79, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.880 Vali Acc: 0.703 Test Loss: 0.880 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.2308464050292969
Epoch: 80, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.881 Vali Acc: 0.703 Test Loss: 0.881 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.0861098766326904
Epoch: 81, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.881 Vali Acc: 0.709 Test Loss: 0.881 Test Acc: 0.709
Validation loss decreased (-0.706241 --> -0.709366).  Saving model ...
Epoch: 82 cost time: 1.0740349292755127
Epoch: 82, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.883 Vali Acc: 0.706 Test Loss: 0.883 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.155869483947754
Epoch: 83, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.880 Vali Acc: 0.706 Test Loss: 0.880 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.1541697978973389
Epoch: 84, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.882 Vali Acc: 0.697 Test Loss: 0.882 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.2631175518035889
Epoch: 85, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.886 Vali Acc: 0.703 Test Loss: 0.886 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.1562755107879639
Epoch: 86, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.885 Vali Acc: 0.703 Test Loss: 0.885 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.170013427734375
Epoch: 87, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.886 Vali Acc: 0.709 Test Loss: 0.886 Test Acc: 0.709
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.237595558166504
Epoch: 88, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.887 Vali Acc: 0.709 Test Loss: 0.887 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.1151750087738037
Epoch: 89, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.888 Vali Acc: 0.709 Test Loss: 0.888 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.1206998825073242
Epoch: 90, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.889 Vali Acc: 0.706 Test Loss: 0.889 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.1382768154144287
Epoch: 91, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.706 Test Loss: 0.890 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w24_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.709375
model parameter : 175674
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9943735599517822
Epoch: 1, Steps: 8 | Train Loss: 2.216 Vali Loss: 2.213 Vali Acc: 0.113 Test Loss: 2.213 Test Acc: 0.113
Validation loss decreased (inf --> -0.112478).  Saving model ...
Epoch: 2 cost time: 0.9191024303436279
Epoch: 2, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.142 Vali Acc: 0.141 Test Loss: 2.142 Test Acc: 0.141
Validation loss decreased (-0.112478 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.9414501190185547
Epoch: 3, Steps: 8 | Train Loss: 2.040 Vali Loss: 2.044 Vali Acc: 0.178 Test Loss: 2.044 Test Acc: 0.178
Validation loss decreased (-0.140604 --> -0.178105).  Saving model ...
Epoch: 4 cost time: 0.9796240329742432
Epoch: 4, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.935 Vali Acc: 0.266 Test Loss: 1.935 Test Acc: 0.266
Validation loss decreased (-0.178105 --> -0.265606).  Saving model ...
Epoch: 5 cost time: 0.9450662136077881
Epoch: 5, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.820 Vali Acc: 0.372 Test Loss: 1.820 Test Acc: 0.372
Validation loss decreased (-0.265606 --> -0.371857).  Saving model ...
Epoch: 6 cost time: 0.9637181758880615
Epoch: 6, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.706 Vali Acc: 0.534 Test Loss: 1.706 Test Acc: 0.534
Validation loss decreased (-0.371857 --> -0.534358).  Saving model ...
Epoch: 7 cost time: 1.0087220668792725
Epoch: 7, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.595 Vali Acc: 0.609 Test Loss: 1.595 Test Acc: 0.609
Validation loss decreased (-0.534358 --> -0.609359).  Saving model ...
Epoch: 8 cost time: 0.9607727527618408
Epoch: 8, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.488 Vali Acc: 0.650 Test Loss: 1.488 Test Acc: 0.650
Validation loss decreased (-0.609359 --> -0.649985).  Saving model ...
Epoch: 9 cost time: 0.9879360198974609
Epoch: 9, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.387 Vali Acc: 0.688 Test Loss: 1.387 Test Acc: 0.688
Validation loss decreased (-0.649985 --> -0.687486).  Saving model ...
Epoch: 10 cost time: 0.9022302627563477
Epoch: 10, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.295 Vali Acc: 0.713 Test Loss: 1.295 Test Acc: 0.713
Validation loss decreased (-0.687486 --> -0.712487).  Saving model ...
Epoch: 11 cost time: 0.9871363639831543
Epoch: 11, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.216 Vali Acc: 0.725 Test Loss: 1.216 Test Acc: 0.725
Validation loss decreased (-0.712487 --> -0.724988).  Saving model ...
Epoch: 12 cost time: 0.9275703430175781
Epoch: 12, Steps: 8 | Train Loss: 0.890 Vali Loss: 1.146 Vali Acc: 0.734 Test Loss: 1.146 Test Acc: 0.734
Validation loss decreased (-0.724988 --> -0.734364).  Saving model ...
Epoch: 13 cost time: 1.108445644378662
Epoch: 13, Steps: 8 | Train Loss: 0.843 Vali Loss: 1.085 Vali Acc: 0.741 Test Loss: 1.085 Test Acc: 0.741
Validation loss decreased (-0.734364 --> -0.740614).  Saving model ...
Epoch: 14 cost time: 0.928274393081665
Epoch: 14, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.036 Vali Acc: 0.741 Test Loss: 1.036 Test Acc: 0.741
Validation loss decreased (-0.740614 --> -0.740615).  Saving model ...
Epoch: 15 cost time: 1.0500974655151367
Epoch: 15, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.995 Vali Acc: 0.741 Test Loss: 0.995 Test Acc: 0.741
Validation loss decreased (-0.740615 --> -0.740615).  Saving model ...
Epoch: 16 cost time: 1.0554299354553223
Epoch: 16, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
Validation loss decreased (-0.740615 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.913083553314209
Epoch: 17, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.927 Vali Acc: 0.762 Test Loss: 0.927 Test Acc: 0.762
Validation loss decreased (-0.749990 --> -0.762491).  Saving model ...
Epoch: 18 cost time: 1.0454401969909668
Epoch: 18, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.903 Vali Acc: 0.772 Test Loss: 0.903 Test Acc: 0.772
Validation loss decreased (-0.762491 --> -0.771866).  Saving model ...
Epoch: 19 cost time: 0.9657449722290039
Epoch: 19, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.771866 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 1.0951461791992188
Epoch: 20, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.0749802589416504
Epoch: 21, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.843 Vali Acc: 0.766 Test Loss: 0.843 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0494248867034912
Epoch: 22, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.830 Vali Acc: 0.772 Test Loss: 0.830 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.95878005027771
Epoch: 23, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.85361647605896
Epoch: 24, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 0.8354957103729248
Epoch: 25, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.791 Vali Acc: 0.781 Test Loss: 0.791 Test Acc: 0.781
Validation loss decreased (-0.774992 --> -0.781242).  Saving model ...
Epoch: 26 cost time: 1.078477144241333
Epoch: 26, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9051096439361572
Epoch: 27, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.774 Vali Acc: 0.778 Test Loss: 0.774 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9427480697631836
Epoch: 28, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.767 Vali Acc: 0.781 Test Loss: 0.767 Test Acc: 0.781
Validation loss decreased (-0.781242 --> -0.781242).  Saving model ...
Epoch: 29 cost time: 0.968242883682251
Epoch: 29, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.761 Vali Acc: 0.784 Test Loss: 0.761 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784367).  Saving model ...
Epoch: 30 cost time: 0.9518344402313232
Epoch: 30, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.755 Vali Acc: 0.784 Test Loss: 0.755 Test Acc: 0.784
Validation loss decreased (-0.784367 --> -0.784367).  Saving model ...
Epoch: 31 cost time: 0.8538362979888916
Epoch: 31, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.750 Vali Acc: 0.784 Test Loss: 0.750 Test Acc: 0.784
Validation loss decreased (-0.784367 --> -0.784368).  Saving model ...
Epoch: 32 cost time: 0.9844098091125488
Epoch: 32, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.745 Vali Acc: 0.787 Test Loss: 0.745 Test Acc: 0.787
Validation loss decreased (-0.784368 --> -0.787493).  Saving model ...
Epoch: 33 cost time: 0.9461817741394043
Epoch: 33, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.742 Vali Acc: 0.794 Test Loss: 0.742 Test Acc: 0.794
Validation loss decreased (-0.787493 --> -0.793743).  Saving model ...
Epoch: 34 cost time: 1.1296184062957764
Epoch: 34, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.739 Vali Acc: 0.787 Test Loss: 0.739 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0709192752838135
Epoch: 35, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.736 Vali Acc: 0.781 Test Loss: 0.736 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0956382751464844
Epoch: 36, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.733 Vali Acc: 0.781 Test Loss: 0.733 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0460567474365234
Epoch: 37, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.731 Vali Acc: 0.787 Test Loss: 0.731 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.87857985496521
Epoch: 38, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.730 Vali Acc: 0.784 Test Loss: 0.730 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9205245971679688
Epoch: 39, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.730 Vali Acc: 0.784 Test Loss: 0.730 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.089693307876587
Epoch: 40, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.730 Vali Acc: 0.787 Test Loss: 0.730 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0139093399047852
Epoch: 41, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.730 Vali Acc: 0.784 Test Loss: 0.730 Test Acc: 0.784
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0113532543182373
Epoch: 42, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.729 Vali Acc: 0.784 Test Loss: 0.729 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.096200704574585
Epoch: 43, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.728 Vali Acc: 0.784 Test Loss: 0.728 Test Acc: 0.784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.79375
model parameter : 173626
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0160889625549316
Epoch: 1, Steps: 8 | Train Loss: 2.214 Vali Loss: 2.147 Vali Acc: 0.109 Test Loss: 2.147 Test Acc: 0.109
Validation loss decreased (inf --> -0.109354).  Saving model ...
Epoch: 2 cost time: 0.7115771770477295
Epoch: 2, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.088 Vali Acc: 0.159 Test Loss: 2.088 Test Acc: 0.159
Validation loss decreased (-0.109354 --> -0.159354).  Saving model ...
Epoch: 3 cost time: 0.5792286396026611
Epoch: 3, Steps: 8 | Train Loss: 2.064 Vali Loss: 2.010 Vali Acc: 0.228 Test Loss: 2.010 Test Acc: 0.228
Validation loss decreased (-0.159354 --> -0.228105).  Saving model ...
Epoch: 4 cost time: 0.7022831439971924
Epoch: 4, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.915 Vali Acc: 0.331 Test Loss: 1.915 Test Acc: 0.331
Validation loss decreased (-0.228105 --> -0.331231).  Saving model ...
Epoch: 5 cost time: 0.7315464019775391
Epoch: 5, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.816 Vali Acc: 0.419 Test Loss: 1.816 Test Acc: 0.419
Validation loss decreased (-0.331231 --> -0.418732).  Saving model ...
Epoch: 6 cost time: 0.8059525489807129
Epoch: 6, Steps: 8 | Train Loss: 1.675 Vali Loss: 1.718 Vali Acc: 0.544 Test Loss: 1.718 Test Acc: 0.544
Validation loss decreased (-0.418732 --> -0.543733).  Saving model ...
Epoch: 7 cost time: 0.7596518993377686
Epoch: 7, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.618 Vali Acc: 0.603 Test Loss: 1.618 Test Acc: 0.603
Validation loss decreased (-0.543733 --> -0.603109).  Saving model ...
Epoch: 8 cost time: 0.7155649662017822
Epoch: 8, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.516 Vali Acc: 0.650 Test Loss: 1.516 Test Acc: 0.650
Validation loss decreased (-0.603109 --> -0.649985).  Saving model ...
Epoch: 9 cost time: 0.8375983238220215
Epoch: 9, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.419 Vali Acc: 0.672 Test Loss: 1.419 Test Acc: 0.672
Validation loss decreased (-0.649985 --> -0.671861).  Saving model ...
Epoch: 10 cost time: 0.7910799980163574
Epoch: 10, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.331 Vali Acc: 0.672 Test Loss: 1.331 Test Acc: 0.672
Validation loss decreased (-0.671861 --> -0.671862).  Saving model ...
Epoch: 11 cost time: 0.7590277194976807
Epoch: 11, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.246 Vali Acc: 0.688 Test Loss: 1.246 Test Acc: 0.688
Validation loss decreased (-0.671862 --> -0.687488).  Saving model ...
Epoch: 12 cost time: 0.9004406929016113
Epoch: 12, Steps: 8 | Train Loss: 0.917 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.687488 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 0.7098865509033203
Epoch: 13, Steps: 8 | Train Loss: 0.798 Vali Loss: 1.110 Vali Acc: 0.709 Test Loss: 1.110 Test Acc: 0.709
Validation loss decreased (-0.699988 --> -0.709364).  Saving model ...
Epoch: 14 cost time: 0.8204855918884277
Epoch: 14, Steps: 8 | Train Loss: 0.721 Vali Loss: 1.052 Vali Acc: 0.709 Test Loss: 1.052 Test Acc: 0.709
Validation loss decreased (-0.709364 --> -0.709364).  Saving model ...
Epoch: 15 cost time: 0.8181023597717285
Epoch: 15, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.006 Vali Acc: 0.713 Test Loss: 1.006 Test Acc: 0.713
Validation loss decreased (-0.709364 --> -0.712490).  Saving model ...
Epoch: 16 cost time: 0.9126403331756592
Epoch: 16, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.966 Vali Acc: 0.706 Test Loss: 0.966 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8732342720031738
Epoch: 17, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.928 Vali Acc: 0.728 Test Loss: 0.928 Test Acc: 0.728
Validation loss decreased (-0.712490 --> -0.728116).  Saving model ...
Epoch: 18 cost time: 0.8412876129150391
Epoch: 18, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8030734062194824
Epoch: 19, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.875 Vali Acc: 0.722 Test Loss: 0.875 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9439210891723633
Epoch: 20, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.856 Vali Acc: 0.716 Test Loss: 0.856 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8367183208465576
Epoch: 21, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.838 Vali Acc: 0.731 Test Loss: 0.838 Test Acc: 0.731
Validation loss decreased (-0.728116 --> -0.731242).  Saving model ...
Epoch: 22 cost time: 0.874906063079834
Epoch: 22, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.824 Vali Acc: 0.734 Test Loss: 0.824 Test Acc: 0.734
Validation loss decreased (-0.731242 --> -0.734367).  Saving model ...
Epoch: 23 cost time: 0.9256236553192139
Epoch: 23, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.810 Vali Acc: 0.747 Test Loss: 0.810 Test Acc: 0.747
Validation loss decreased (-0.734367 --> -0.746867).  Saving model ...
Epoch: 24 cost time: 0.823394775390625
Epoch: 24, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.746867 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.8661823272705078
Epoch: 25, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9289064407348633
Epoch: 26, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.779 Vali Acc: 0.747 Test Loss: 0.779 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8088393211364746
Epoch: 27, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 0.8767552375793457
Epoch: 28, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.767 Vali Acc: 0.747 Test Loss: 0.767 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8107028007507324
Epoch: 29, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.762 Vali Acc: 0.753 Test Loss: 0.762 Test Acc: 0.753
Validation loss decreased (-0.749992 --> -0.753117).  Saving model ...
Epoch: 30 cost time: 0.7712900638580322
Epoch: 30, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.758 Vali Acc: 0.759 Test Loss: 0.758 Test Acc: 0.759
Validation loss decreased (-0.753117 --> -0.759367).  Saving model ...
Epoch: 31 cost time: 0.9043426513671875
Epoch: 31, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.888918399810791
Epoch: 32, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.744 Vali Acc: 0.762 Test Loss: 0.744 Test Acc: 0.762
Validation loss decreased (-0.759367 --> -0.762493).  Saving model ...
Epoch: 33 cost time: 0.7411983013153076
Epoch: 33, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.741 Vali Acc: 0.766 Test Loss: 0.741 Test Acc: 0.766
Validation loss decreased (-0.762493 --> -0.765618).  Saving model ...
Epoch: 34 cost time: 0.7444295883178711
Epoch: 34, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.740 Vali Acc: 0.762 Test Loss: 0.740 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7286748886108398
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.740 Vali Acc: 0.759 Test Loss: 0.740 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7177371978759766
Epoch: 36, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.734 Vali Acc: 0.766 Test Loss: 0.734 Test Acc: 0.766
Validation loss decreased (-0.765618 --> -0.765618).  Saving model ...
Epoch: 37 cost time: 0.7445485591888428
Epoch: 37, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.730 Vali Acc: 0.769 Test Loss: 0.730 Test Acc: 0.769
Validation loss decreased (-0.765618 --> -0.768743).  Saving model ...
Epoch: 38 cost time: 0.7729289531707764
Epoch: 38, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.730 Vali Acc: 0.766 Test Loss: 0.730 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7174246311187744
Epoch: 39, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.728 Vali Acc: 0.778 Test Loss: 0.728 Test Acc: 0.778
Validation loss decreased (-0.768743 --> -0.778118).  Saving model ...
Epoch: 40 cost time: 0.6631913185119629
Epoch: 40, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7802343368530273
Epoch: 41, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7266585826873779
Epoch: 42, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.724 Vali Acc: 0.769 Test Loss: 0.724 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7108478546142578
Epoch: 43, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.725 Vali Acc: 0.772 Test Loss: 0.725 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8612077236175537
Epoch: 44, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7819395065307617
Epoch: 45, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.723 Vali Acc: 0.772 Test Loss: 0.723 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7277536392211914
Epoch: 46, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.724 Vali Acc: 0.769 Test Loss: 0.724 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.849846363067627
Epoch: 47, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8974864482879639
Epoch: 48, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8310401439666748
Epoch: 49, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.721 Vali Acc: 0.772 Test Loss: 0.721 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w10_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.778125
model parameter : 172090
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7704403400421143
Epoch: 1, Steps: 8 | Train Loss: 2.232 Vali Loss: 2.195 Vali Acc: 0.050 Test Loss: 2.195 Test Acc: 0.050
Validation loss decreased (inf --> -0.049978).  Saving model ...
Epoch: 2 cost time: 0.6842491626739502
Epoch: 2, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.123 Vali Acc: 0.106 Test Loss: 2.123 Test Acc: 0.106
Validation loss decreased (-0.049978 --> -0.106229).  Saving model ...
Epoch: 3 cost time: 0.6721901893615723
Epoch: 3, Steps: 8 | Train Loss: 2.039 Vali Loss: 2.024 Vali Acc: 0.209 Test Loss: 2.024 Test Acc: 0.209
Validation loss decreased (-0.106229 --> -0.209355).  Saving model ...
Epoch: 4 cost time: 0.6470673084259033
Epoch: 4, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.910 Vali Acc: 0.331 Test Loss: 1.910 Test Acc: 0.331
Validation loss decreased (-0.209355 --> -0.331231).  Saving model ...
Epoch: 5 cost time: 0.6328656673431396
Epoch: 5, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.784 Vali Acc: 0.469 Test Loss: 1.784 Test Acc: 0.469
Validation loss decreased (-0.331231 --> -0.468732).  Saving model ...
Epoch: 6 cost time: 0.6781935691833496
Epoch: 6, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.658 Vali Acc: 0.531 Test Loss: 1.658 Test Acc: 0.531
Validation loss decreased (-0.468732 --> -0.531233).  Saving model ...
Epoch: 7 cost time: 0.642531156539917
Epoch: 7, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.534 Vali Acc: 0.584 Test Loss: 1.534 Test Acc: 0.584
Validation loss decreased (-0.531233 --> -0.584360).  Saving model ...
Epoch: 8 cost time: 0.6281216144561768
Epoch: 8, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.420 Vali Acc: 0.647 Test Loss: 1.420 Test Acc: 0.647
Validation loss decreased (-0.584360 --> -0.646861).  Saving model ...
Epoch: 9 cost time: 0.8051915168762207
Epoch: 9, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.312 Vali Acc: 0.688 Test Loss: 1.312 Test Acc: 0.688
Validation loss decreased (-0.646861 --> -0.687487).  Saving model ...
Epoch: 10 cost time: 0.6707377433776855
Epoch: 10, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.217 Vali Acc: 0.709 Test Loss: 1.217 Test Acc: 0.709
Validation loss decreased (-0.687487 --> -0.709363).  Saving model ...
Epoch: 11 cost time: 0.8784699440002441
Epoch: 11, Steps: 8 | Train Loss: 0.962 Vali Loss: 1.140 Vali Acc: 0.738 Test Loss: 1.140 Test Acc: 0.738
Validation loss decreased (-0.709363 --> -0.737489).  Saving model ...
Epoch: 12 cost time: 0.6752302646636963
Epoch: 12, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.071 Vali Acc: 0.756 Test Loss: 1.071 Test Acc: 0.756
Validation loss decreased (-0.737489 --> -0.756239).  Saving model ...
Epoch: 13 cost time: 0.5971295833587646
Epoch: 13, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7222986221313477
Epoch: 14, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.969 Vali Acc: 0.759 Test Loss: 0.969 Test Acc: 0.759
Validation loss decreased (-0.756239 --> -0.759365).  Saving model ...
Epoch: 15 cost time: 0.6520256996154785
Epoch: 15, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.932 Vali Acc: 0.762 Test Loss: 0.932 Test Acc: 0.762
Validation loss decreased (-0.759365 --> -0.762491).  Saving model ...
Epoch: 16 cost time: 0.6347160339355469
Epoch: 16, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.762491 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.6507213115692139
Epoch: 17, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6506216526031494
Epoch: 18, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.849 Vali Acc: 0.772 Test Loss: 0.849 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6572563648223877
Epoch: 19, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.831 Vali Acc: 0.784 Test Loss: 0.831 Test Acc: 0.784
Validation loss decreased (-0.774991 --> -0.784367).  Saving model ...
Epoch: 20 cost time: 0.6170473098754883
Epoch: 20, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7427332401275635
Epoch: 21, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6702730655670166
Epoch: 22, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.789 Vali Acc: 0.778 Test Loss: 0.789 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.769404411315918
Epoch: 23, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7572977542877197
Epoch: 24, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7681894302368164
Epoch: 25, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.762 Vali Acc: 0.781 Test Loss: 0.762 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6944780349731445
Epoch: 26, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6434123516082764
Epoch: 27, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.752 Vali Acc: 0.769 Test Loss: 0.752 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.630784273147583
Epoch: 28, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.745 Vali Acc: 0.769 Test Loss: 0.745 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6721959114074707
Epoch: 29, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.741 Vali Acc: 0.762 Test Loss: 0.741 Test Acc: 0.762
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.784375
model parameter : 171322
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.795487880706787
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.118 Vali Acc: 0.106 Test Loss: 2.118 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 0.5446803569793701
Epoch: 2, Steps: 8 | Train Loss: 2.077 Vali Loss: 2.048 Vali Acc: 0.128 Test Loss: 2.048 Test Acc: 0.128
Validation loss decreased (-0.106229 --> -0.128105).  Saving model ...
Epoch: 3 cost time: 0.5874531269073486
Epoch: 3, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.950 Vali Acc: 0.194 Test Loss: 1.950 Test Acc: 0.194
Validation loss decreased (-0.128105 --> -0.193730).  Saving model ...
Epoch: 4 cost time: 0.5897195339202881
Epoch: 4, Steps: 8 | Train Loss: 1.826 Vali Loss: 1.834 Vali Acc: 0.369 Test Loss: 1.834 Test Acc: 0.369
Validation loss decreased (-0.193730 --> -0.368732).  Saving model ...
Epoch: 5 cost time: 0.6494388580322266
Epoch: 5, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.712 Vali Acc: 0.494 Test Loss: 1.712 Test Acc: 0.494
Validation loss decreased (-0.368732 --> -0.493733).  Saving model ...
Epoch: 6 cost time: 0.5964479446411133
Epoch: 6, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.587 Vali Acc: 0.569 Test Loss: 1.587 Test Acc: 0.569
Validation loss decreased (-0.493733 --> -0.568734).  Saving model ...
Epoch: 7 cost time: 0.5770168304443359
Epoch: 7, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.472 Vali Acc: 0.603 Test Loss: 1.472 Test Acc: 0.603
Validation loss decreased (-0.568734 --> -0.603110).  Saving model ...
Epoch: 8 cost time: 0.564223051071167
Epoch: 8, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.367 Vali Acc: 0.625 Test Loss: 1.367 Test Acc: 0.625
Validation loss decreased (-0.603110 --> -0.624986).  Saving model ...
Epoch: 9 cost time: 0.6312785148620605
Epoch: 9, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.273 Vali Acc: 0.634 Test Loss: 1.273 Test Acc: 0.634
Validation loss decreased (-0.624986 --> -0.634362).  Saving model ...
Epoch: 10 cost time: 0.5590965747833252
Epoch: 10, Steps: 8 | Train Loss: 0.961 Vali Loss: 1.189 Vali Acc: 0.669 Test Loss: 1.189 Test Acc: 0.669
Validation loss decreased (-0.634362 --> -0.668738).  Saving model ...
Epoch: 11 cost time: 0.6168761253356934
Epoch: 11, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.117 Vali Acc: 0.691 Test Loss: 1.117 Test Acc: 0.691
Validation loss decreased (-0.668738 --> -0.690614).  Saving model ...
Epoch: 12 cost time: 0.5923283100128174
Epoch: 12, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
Validation loss decreased (-0.690614 --> -0.721864).  Saving model ...
Epoch: 13 cost time: 0.5718157291412354
Epoch: 13, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.721864 --> -0.721865).  Saving model ...
Epoch: 14 cost time: 0.5741376876831055
Epoch: 14, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.949 Vali Acc: 0.731 Test Loss: 0.949 Test Acc: 0.731
Validation loss decreased (-0.721865 --> -0.731241).  Saving model ...
Epoch: 15 cost time: 0.5464248657226562
Epoch: 15, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.911 Vali Acc: 0.741 Test Loss: 0.911 Test Acc: 0.741
Validation loss decreased (-0.731241 --> -0.740616).  Saving model ...
Epoch: 16 cost time: 0.5218844413757324
Epoch: 16, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.879 Vali Acc: 0.738 Test Loss: 0.879 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5133142471313477
Epoch: 17, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.851 Vali Acc: 0.741 Test Loss: 0.851 Test Acc: 0.741
Validation loss decreased (-0.740616 --> -0.740616).  Saving model ...
Epoch: 18 cost time: 0.5245559215545654
Epoch: 18, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.829 Vali Acc: 0.741 Test Loss: 0.829 Test Acc: 0.741
Validation loss decreased (-0.740616 --> -0.740617).  Saving model ...
Epoch: 19 cost time: 0.6003193855285645
Epoch: 19, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.807 Vali Acc: 0.753 Test Loss: 0.807 Test Acc: 0.753
Validation loss decreased (-0.740617 --> -0.753117).  Saving model ...
Epoch: 20 cost time: 0.5761468410491943
Epoch: 20, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
Validation loss decreased (-0.753117 --> -0.756242).  Saving model ...
Epoch: 21 cost time: 0.5657639503479004
Epoch: 21, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.774 Vali Acc: 0.759 Test Loss: 0.774 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 22 cost time: 0.5098378658294678
Epoch: 22, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
Validation loss decreased (-0.759367 --> -0.771867).  Saving model ...
Epoch: 23 cost time: 0.5452032089233398
Epoch: 23, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771867).  Saving model ...
Epoch: 24 cost time: 0.5380063056945801
Epoch: 24, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771868).  Saving model ...
Epoch: 25 cost time: 0.5204949378967285
Epoch: 25, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.732 Vali Acc: 0.769 Test Loss: 0.732 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5203871726989746
Epoch: 26, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
Validation loss decreased (-0.771868 --> -0.778118).  Saving model ...
Epoch: 27 cost time: 0.576458215713501
Epoch: 27, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.717 Vali Acc: 0.784 Test Loss: 0.717 Test Acc: 0.784
Validation loss decreased (-0.778118 --> -0.784368).  Saving model ...
Epoch: 28 cost time: 0.6081244945526123
Epoch: 28, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.711 Vali Acc: 0.778 Test Loss: 0.711 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.578376054763794
Epoch: 29, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.706 Vali Acc: 0.784 Test Loss: 0.706 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 30 cost time: 0.5962786674499512
Epoch: 30, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.699 Vali Acc: 0.784 Test Loss: 0.699 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 31 cost time: 0.5657095909118652
Epoch: 31, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5480239391326904
Epoch: 32, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.690 Vali Acc: 0.784 Test Loss: 0.690 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 33 cost time: 0.5485727787017822
Epoch: 33, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.686 Vali Acc: 0.791 Test Loss: 0.686 Test Acc: 0.791
Validation loss decreased (-0.784368 --> -0.790618).  Saving model ...
Epoch: 34 cost time: 0.7029879093170166
Epoch: 34, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.684 Vali Acc: 0.791 Test Loss: 0.684 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 35 cost time: 0.739734411239624
Epoch: 35, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.679 Vali Acc: 0.791 Test Loss: 0.679 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 36 cost time: 0.6597936153411865
Epoch: 36, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.675 Vali Acc: 0.791 Test Loss: 0.675 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 37 cost time: 0.6259310245513916
Epoch: 37, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.672 Vali Acc: 0.791 Test Loss: 0.672 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 38 cost time: 0.5697357654571533
Epoch: 38, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.671 Vali Acc: 0.791 Test Loss: 0.671 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790618).  Saving model ...
Epoch: 39 cost time: 0.6163430213928223
Epoch: 39, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 40 cost time: 0.732280969619751
Epoch: 40, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 41 cost time: 0.6482768058776855
Epoch: 41, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 42 cost time: 0.7130062580108643
Epoch: 42, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.664 Vali Acc: 0.794 Test Loss: 0.664 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7303495407104492
Epoch: 43, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.659113883972168
Epoch: 44, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.659 Vali Acc: 0.797 Test Loss: 0.659 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6305322647094727
Epoch: 45, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 46 cost time: 0.6493909358978271
Epoch: 46, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806243).  Saving model ...
Epoch: 47 cost time: 0.6456677913665771
Epoch: 47, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 48 cost time: 0.6714878082275391
Epoch: 48, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6005139350891113
Epoch: 49, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6728801727294922
Epoch: 50, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6096301078796387
Epoch: 51, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6738507747650146
Epoch: 52, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7423946857452393
Epoch: 53, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6811161041259766
Epoch: 54, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6890084743499756
Epoch: 55, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6486420631408691
Epoch: 56, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6429274082183838
Epoch: 57, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.80625
model parameter : 170554
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5673651695251465
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.110 Vali Acc: 0.163 Test Loss: 2.110 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 0.44319868087768555
Epoch: 2, Steps: 8 | Train Loss: 2.037 Vali Loss: 2.026 Vali Acc: 0.206 Test Loss: 2.026 Test Acc: 0.206
Validation loss decreased (-0.162479 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.4234652519226074
Epoch: 3, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.911 Vali Acc: 0.284 Test Loss: 1.911 Test Acc: 0.284
Validation loss decreased (-0.206230 --> -0.284356).  Saving model ...
Epoch: 4 cost time: 0.4363219738006592
Epoch: 4, Steps: 8 | Train Loss: 1.710 Vali Loss: 1.785 Vali Acc: 0.394 Test Loss: 1.785 Test Acc: 0.394
Validation loss decreased (-0.284356 --> -0.393732).  Saving model ...
Epoch: 5 cost time: 0.5138914585113525
Epoch: 5, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.651 Vali Acc: 0.528 Test Loss: 1.651 Test Acc: 0.528
Validation loss decreased (-0.393732 --> -0.528108).  Saving model ...
Epoch: 6 cost time: 0.425173282623291
Epoch: 6, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.520 Vali Acc: 0.613 Test Loss: 1.520 Test Acc: 0.613
Validation loss decreased (-0.528108 --> -0.612485).  Saving model ...
Epoch: 7 cost time: 0.5942342281341553
Epoch: 7, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.398 Vali Acc: 0.637 Test Loss: 1.398 Test Acc: 0.637
Validation loss decreased (-0.612485 --> -0.637486).  Saving model ...
Epoch: 8 cost time: 0.4486682415008545
Epoch: 8, Steps: 8 | Train Loss: 1.034 Vali Loss: 1.285 Vali Acc: 0.700 Test Loss: 1.285 Test Acc: 0.700
Validation loss decreased (-0.637486 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 0.37582850456237793
Epoch: 9, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.190 Vali Acc: 0.719 Test Loss: 1.190 Test Acc: 0.719
Validation loss decreased (-0.699987 --> -0.718738).  Saving model ...
Epoch: 10 cost time: 0.4533529281616211
Epoch: 10, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.109 Vali Acc: 0.728 Test Loss: 1.109 Test Acc: 0.728
Validation loss decreased (-0.718738 --> -0.728114).  Saving model ...
Epoch: 11 cost time: 0.4360697269439697
Epoch: 11, Steps: 8 | Train Loss: 0.667 Vali Loss: 1.038 Vali Acc: 0.750 Test Loss: 1.038 Test Acc: 0.750
Validation loss decreased (-0.728114 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.4496188163757324
Epoch: 12, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.982 Vali Acc: 0.744 Test Loss: 0.982 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.44574737548828125
Epoch: 13, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.5630645751953125
Epoch: 14, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756241).  Saving model ...
Epoch: 15 cost time: 0.4404296875
Epoch: 15, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756241).  Saving model ...
Epoch: 16 cost time: 0.45058417320251465
Epoch: 16, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756242).  Saving model ...
Epoch: 17 cost time: 0.543769121170044
Epoch: 17, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.824 Vali Acc: 0.762 Test Loss: 0.824 Test Acc: 0.762
Validation loss decreased (-0.756242 --> -0.762492).  Saving model ...
Epoch: 18 cost time: 0.4803493022918701
Epoch: 18, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.807 Vali Acc: 0.762 Test Loss: 0.807 Test Acc: 0.762
Validation loss decreased (-0.762492 --> -0.762492).  Saving model ...
Epoch: 19 cost time: 0.532930850982666
Epoch: 19, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.791 Vali Acc: 0.772 Test Loss: 0.791 Test Acc: 0.772
Validation loss decreased (-0.762492 --> -0.771867).  Saving model ...
Epoch: 20 cost time: 0.5644989013671875
Epoch: 20, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771867).  Saving model ...
Epoch: 21 cost time: 0.5490047931671143
Epoch: 21, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.764 Vali Acc: 0.781 Test Loss: 0.764 Test Acc: 0.781
Validation loss decreased (-0.771867 --> -0.781242).  Saving model ...
Epoch: 22 cost time: 0.5559201240539551
Epoch: 22, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.754 Vali Acc: 0.784 Test Loss: 0.754 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784367).  Saving model ...
Epoch: 23 cost time: 0.4742279052734375
Epoch: 23, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.744 Vali Acc: 0.787 Test Loss: 0.744 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 24 cost time: 0.47983360290527344
Epoch: 24, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 25 cost time: 0.5314557552337646
Epoch: 25, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.725 Vali Acc: 0.794 Test Loss: 0.725 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5088169574737549
Epoch: 26, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5607106685638428
Epoch: 27, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.5379619598388672
Epoch: 28, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.711 Vali Acc: 0.797 Test Loss: 0.711 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6712102890014648
Epoch: 29, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803118).  Saving model ...
Epoch: 30 cost time: 0.5938141345977783
Epoch: 30, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5196812152862549
Epoch: 31, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.698 Vali Acc: 0.797 Test Loss: 0.698 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5579490661621094
Epoch: 32, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.694 Vali Acc: 0.797 Test Loss: 0.694 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5659379959106445
Epoch: 33, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5176393985748291
Epoch: 34, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5608322620391846
Epoch: 35, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5317277908325195
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6364922523498535
Epoch: 37, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5518894195556641
Epoch: 38, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.49933409690856934
Epoch: 39, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.679 Vali Acc: 0.797 Test Loss: 0.679 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.803125
model parameter : 169786
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1166903972625732
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.100 Vali Acc: 0.147 Test Loss: 2.100 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.54803466796875
Epoch: 2, Steps: 8 | Train Loss: 2.045 Vali Loss: 2.019 Vali Acc: 0.241 Test Loss: 2.019 Test Acc: 0.241
Validation loss decreased (-0.146854 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 1.8440320491790771
Epoch: 3, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.907 Vali Acc: 0.362 Test Loss: 1.907 Test Acc: 0.362
Validation loss decreased (-0.240605 --> -0.362481).  Saving model ...
Epoch: 4 cost time: 1.455723524093628
Epoch: 4, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.782 Vali Acc: 0.487 Test Loss: 1.782 Test Acc: 0.487
Validation loss decreased (-0.362481 --> -0.487482).  Saving model ...
Epoch: 5 cost time: 1.478165626525879
Epoch: 5, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.659 Vali Acc: 0.547 Test Loss: 1.659 Test Acc: 0.547
Validation loss decreased (-0.487482 --> -0.546858).  Saving model ...
Epoch: 6 cost time: 1.4115090370178223
Epoch: 6, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.547 Vali Acc: 0.600 Test Loss: 1.547 Test Acc: 0.600
Validation loss decreased (-0.546858 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 1.577244758605957
Epoch: 7, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.445 Vali Acc: 0.625 Test Loss: 1.445 Test Acc: 0.625
Validation loss decreased (-0.599985 --> -0.624986).  Saving model ...
Epoch: 8 cost time: 1.5828652381896973
Epoch: 8, Steps: 8 | Train Loss: 0.967 Vali Loss: 1.350 Vali Acc: 0.647 Test Loss: 1.350 Test Acc: 0.647
Validation loss decreased (-0.624986 --> -0.646862).  Saving model ...
Epoch: 9 cost time: 1.6048786640167236
Epoch: 9, Steps: 8 | Train Loss: 0.856 Vali Loss: 1.260 Vali Acc: 0.675 Test Loss: 1.260 Test Acc: 0.675
Validation loss decreased (-0.646862 --> -0.674987).  Saving model ...
Epoch: 10 cost time: 1.5271592140197754
Epoch: 10, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.192 Vali Acc: 0.691 Test Loss: 1.192 Test Acc: 0.691
Validation loss decreased (-0.674987 --> -0.690613).  Saving model ...
Epoch: 11 cost time: 1.658679723739624
Epoch: 11, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.128 Vali Acc: 0.697 Test Loss: 1.128 Test Acc: 0.697
Validation loss decreased (-0.690613 --> -0.696864).  Saving model ...
Epoch: 12 cost time: 1.550668478012085
Epoch: 12, Steps: 8 | Train Loss: 0.511 Vali Loss: 1.073 Vali Acc: 0.697 Test Loss: 1.073 Test Acc: 0.697
Validation loss decreased (-0.696864 --> -0.696864).  Saving model ...
Epoch: 13 cost time: 1.579960823059082
Epoch: 13, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.027 Vali Acc: 0.709 Test Loss: 1.027 Test Acc: 0.709
Validation loss decreased (-0.696864 --> -0.709365).  Saving model ...
Epoch: 14 cost time: 1.5566577911376953
Epoch: 14, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.985 Vali Acc: 0.703 Test Loss: 0.985 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.451814889907837
Epoch: 15, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.949 Vali Acc: 0.716 Test Loss: 0.949 Test Acc: 0.716
Validation loss decreased (-0.709365 --> -0.715616).  Saving model ...
Epoch: 16 cost time: 1.7625653743743896
Epoch: 16, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
Validation loss decreased (-0.715616 --> -0.721866).  Saving model ...
Epoch: 17 cost time: 1.507843017578125
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.900 Vali Acc: 0.722 Test Loss: 0.900 Test Acc: 0.722
Validation loss decreased (-0.721866 --> -0.721866).  Saving model ...
Epoch: 18 cost time: 1.4039254188537598
Epoch: 18, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.721866 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 1.470566749572754
Epoch: 19, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5819108486175537
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.844 Vali Acc: 0.738 Test Loss: 0.844 Test Acc: 0.738
Validation loss decreased (-0.724991 --> -0.737492).  Saving model ...
Epoch: 21 cost time: 1.463878870010376
Epoch: 21, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.830 Vali Acc: 0.744 Test Loss: 0.830 Test Acc: 0.744
Validation loss decreased (-0.737492 --> -0.743742).  Saving model ...
Epoch: 22 cost time: 1.4708373546600342
Epoch: 22, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3716073036193848
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.816 Vali Acc: 0.738 Test Loss: 0.816 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.428877353668213
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.808 Vali Acc: 0.747 Test Loss: 0.808 Test Acc: 0.747
Validation loss decreased (-0.743742 --> -0.746867).  Saving model ...
Epoch: 25 cost time: 1.3012232780456543
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.799 Vali Acc: 0.753 Test Loss: 0.799 Test Acc: 0.753
Validation loss decreased (-0.746867 --> -0.753117).  Saving model ...
Epoch: 26 cost time: 1.6790544986724854
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.794 Vali Acc: 0.753 Test Loss: 0.794 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 27 cost time: 1.4213955402374268
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.790 Vali Acc: 0.747 Test Loss: 0.790 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4866604804992676
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.785 Vali Acc: 0.747 Test Loss: 0.785 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3604001998901367
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.781 Vali Acc: 0.753 Test Loss: 0.781 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 30 cost time: 1.6025605201721191
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.779 Vali Acc: 0.753 Test Loss: 0.779 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 31 cost time: 1.5569286346435547
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.778 Vali Acc: 0.753 Test Loss: 0.778 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 32 cost time: 1.600440502166748
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5621213912963867
Epoch: 33, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6245129108428955
Epoch: 34, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.772 Vali Acc: 0.747 Test Loss: 0.772 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5334875583648682
Epoch: 35, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.772 Vali Acc: 0.753 Test Loss: 0.772 Test Acc: 0.753
Validation loss decreased (-0.753117 --> -0.753117).  Saving model ...
Epoch: 36 cost time: 1.5249238014221191
Epoch: 36, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.768 Vali Acc: 0.756 Test Loss: 0.768 Test Acc: 0.756
Validation loss decreased (-0.753117 --> -0.756242).  Saving model ...
Epoch: 37 cost time: 1.8163106441497803
Epoch: 37, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.753 Test Loss: 0.769 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4045884609222412
Epoch: 38, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.767 Vali Acc: 0.759 Test Loss: 0.767 Test Acc: 0.759
Validation loss decreased (-0.756242 --> -0.759367).  Saving model ...
Epoch: 39 cost time: 1.474435806274414
Epoch: 39, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.767 Vali Acc: 0.753 Test Loss: 0.767 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.561094045639038
Epoch: 40, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.750 Test Loss: 0.766 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.495922565460205
Epoch: 41, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.766 Vali Acc: 0.747 Test Loss: 0.766 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5198159217834473
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.753 Test Loss: 0.765 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7618343830108643
Epoch: 43, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6686744689941406
Epoch: 44, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.747 Test Loss: 0.764 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7178940773010254
Epoch: 45, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.631103754043579
Epoch: 46, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.49466872215271
Epoch: 47, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.764 Vali Acc: 0.759 Test Loss: 0.764 Test Acc: 0.759
Validation loss decreased (-0.759367 --> -0.759367).  Saving model ...
Epoch: 48 cost time: 1.4690227508544922
Epoch: 48, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.763 Vali Acc: 0.759 Test Loss: 0.763 Test Acc: 0.759
Validation loss decreased (-0.759367 --> -0.759367).  Saving model ...
Epoch: 49 cost time: 1.6810917854309082
Epoch: 49, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.759 Test Loss: 0.763 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.685596227645874
Epoch: 50, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.764 Vali Acc: 0.759 Test Loss: 0.764 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.614722490310669
Epoch: 51, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.765 Vali Acc: 0.759 Test Loss: 0.765 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.634126901626587
Epoch: 52, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.765 Vali Acc: 0.759 Test Loss: 0.765 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.586585521697998
Epoch: 53, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3408849239349365
Epoch: 54, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2907192707061768
Epoch: 55, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.747 Test Loss: 0.764 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.3898375034332275
Epoch: 56, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.766 Vali Acc: 0.747 Test Loss: 0.766 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.3075945377349854
Epoch: 57, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.747 Test Loss: 0.766 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.4204676151275635
Epoch: 58, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 179736
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5455567836761475
Epoch: 1, Steps: 8 | Train Loss: 2.226 Vali Loss: 2.200 Vali Acc: 0.075 Test Loss: 2.200 Test Acc: 0.075
Validation loss decreased (inf --> -0.074978).  Saving model ...
Epoch: 2 cost time: 1.3880372047424316
Epoch: 2, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.109 Vali Acc: 0.134 Test Loss: 2.109 Test Acc: 0.134
Validation loss decreased (-0.074978 --> -0.134354).  Saving model ...
Epoch: 3 cost time: 1.2902438640594482
Epoch: 3, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.985 Vali Acc: 0.225 Test Loss: 1.985 Test Acc: 0.225
Validation loss decreased (-0.134354 --> -0.224980).  Saving model ...
Epoch: 4 cost time: 1.1948442459106445
Epoch: 4, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.858 Vali Acc: 0.362 Test Loss: 1.858 Test Acc: 0.362
Validation loss decreased (-0.224980 --> -0.362481).  Saving model ...
Epoch: 5 cost time: 1.2163033485412598
Epoch: 5, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.723 Vali Acc: 0.487 Test Loss: 1.723 Test Acc: 0.487
Validation loss decreased (-0.362481 --> -0.487483).  Saving model ...
Epoch: 6 cost time: 1.4233739376068115
Epoch: 6, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.595 Vali Acc: 0.581 Test Loss: 1.595 Test Acc: 0.581
Validation loss decreased (-0.487483 --> -0.581234).  Saving model ...
Epoch: 7 cost time: 1.419435977935791
Epoch: 7, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.479 Vali Acc: 0.625 Test Loss: 1.479 Test Acc: 0.625
Validation loss decreased (-0.581234 --> -0.624985).  Saving model ...
Epoch: 8 cost time: 1.231644868850708
Epoch: 8, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.386 Vali Acc: 0.659 Test Loss: 1.386 Test Acc: 0.659
Validation loss decreased (-0.624985 --> -0.659361).  Saving model ...
Epoch: 9 cost time: 1.2790441513061523
Epoch: 9, Steps: 8 | Train Loss: 0.858 Vali Loss: 1.300 Vali Acc: 0.684 Test Loss: 1.300 Test Acc: 0.684
Validation loss decreased (-0.659361 --> -0.684362).  Saving model ...
Epoch: 10 cost time: 1.231713056564331
Epoch: 10, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.221 Vali Acc: 0.706 Test Loss: 1.221 Test Acc: 0.706
Validation loss decreased (-0.684362 --> -0.706238).  Saving model ...
Epoch: 11 cost time: 1.2622742652893066
Epoch: 11, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.155 Vali Acc: 0.706 Test Loss: 1.155 Test Acc: 0.706
Validation loss decreased (-0.706238 --> -0.706238).  Saving model ...
Epoch: 12 cost time: 1.2967798709869385
Epoch: 12, Steps: 8 | Train Loss: 0.506 Vali Loss: 1.093 Vali Acc: 0.722 Test Loss: 1.093 Test Acc: 0.722
Validation loss decreased (-0.706238 --> -0.721864).  Saving model ...
Epoch: 13 cost time: 1.1793978214263916
Epoch: 13, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.038 Vali Acc: 0.741 Test Loss: 1.038 Test Acc: 0.741
Validation loss decreased (-0.721864 --> -0.740615).  Saving model ...
Epoch: 14 cost time: 1.227921485900879
Epoch: 14, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
Validation loss decreased (-0.740615 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.1992652416229248
Epoch: 15, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.968 Vali Acc: 0.734 Test Loss: 0.968 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.289276361465454
Epoch: 16, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.945 Vali Acc: 0.738 Test Loss: 0.945 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3002033233642578
Epoch: 17, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.920 Vali Acc: 0.738 Test Loss: 0.920 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.269409418106079
Epoch: 18, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.901 Vali Acc: 0.750 Test Loss: 0.901 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 1.30116868019104
Epoch: 19, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.888 Vali Acc: 0.747 Test Loss: 0.888 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.292586088180542
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.872 Vali Acc: 0.747 Test Loss: 0.872 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5674431324005127
Epoch: 21, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.858 Vali Acc: 0.756 Test Loss: 0.858 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756241).  Saving model ...
Epoch: 22 cost time: 1.408294439315796
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2822635173797607
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.292250156402588
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756242).  Saving model ...
Epoch: 25 cost time: 1.4642066955566406
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.829 Vali Acc: 0.747 Test Loss: 0.829 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4435558319091797
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.825 Vali Acc: 0.747 Test Loss: 0.825 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3795909881591797
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.818 Vali Acc: 0.753 Test Loss: 0.818 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3622276782989502
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.814 Vali Acc: 0.753 Test Loss: 0.814 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4372594356536865
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3501248359680176
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.811 Vali Acc: 0.753 Test Loss: 0.811 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4484119415283203
Epoch: 31, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756242).  Saving model ...
Epoch: 32 cost time: 1.302062749862671
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.803 Vali Acc: 0.753 Test Loss: 0.803 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.104001522064209
Epoch: 33, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.19868803024292
Epoch: 34, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.800 Vali Acc: 0.747 Test Loss: 0.800 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1495065689086914
Epoch: 35, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.798 Vali Acc: 0.738 Test Loss: 0.798 Test Acc: 0.738
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9562139511108398
Epoch: 36, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.797 Vali Acc: 0.741 Test Loss: 0.797 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1530237197875977
Epoch: 37, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.797 Vali Acc: 0.738 Test Loss: 0.797 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2277092933654785
Epoch: 38, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.796 Vali Acc: 0.738 Test Loss: 0.796 Test Acc: 0.738
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.236462116241455
Epoch: 39, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.796 Vali Acc: 0.738 Test Loss: 0.796 Test Acc: 0.738
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1832587718963623
Epoch: 40, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.071481704711914
Epoch: 41, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.794 Vali Acc: 0.738 Test Loss: 0.794 Test Acc: 0.738
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w32_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75625
model parameter : 177688
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2968785762786865
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.106 Vali Acc: 0.116 Test Loss: 2.106 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 1.060420274734497
Epoch: 2, Steps: 8 | Train Loss: 2.034 Vali Loss: 2.017 Vali Acc: 0.163 Test Loss: 2.017 Test Acc: 0.163
Validation loss decreased (-0.115604 --> -0.162480).  Saving model ...
Epoch: 3 cost time: 1.1344377994537354
Epoch: 3, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.902 Vali Acc: 0.291 Test Loss: 1.902 Test Acc: 0.291
Validation loss decreased (-0.162480 --> -0.290606).  Saving model ...
Epoch: 4 cost time: 1.1132569313049316
Epoch: 4, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.773 Vali Acc: 0.459 Test Loss: 1.773 Test Acc: 0.459
Validation loss decreased (-0.290606 --> -0.459357).  Saving model ...
Epoch: 5 cost time: 1.076888084411621
Epoch: 5, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.647 Vali Acc: 0.572 Test Loss: 1.647 Test Acc: 0.572
Validation loss decreased (-0.459357 --> -0.571859).  Saving model ...
Epoch: 6 cost time: 1.2411580085754395
Epoch: 6, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.523 Vali Acc: 0.603 Test Loss: 1.523 Test Acc: 0.603
Validation loss decreased (-0.571859 --> -0.603110).  Saving model ...
Epoch: 7 cost time: 1.140207052230835
Epoch: 7, Steps: 8 | Train Loss: 1.080 Vali Loss: 1.405 Vali Acc: 0.653 Test Loss: 1.405 Test Acc: 0.653
Validation loss decreased (-0.603110 --> -0.653111).  Saving model ...
Epoch: 8 cost time: 1.0668106079101562
Epoch: 8, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.301 Vali Acc: 0.672 Test Loss: 1.301 Test Acc: 0.672
Validation loss decreased (-0.653111 --> -0.671862).  Saving model ...
Epoch: 9 cost time: 0.9389865398406982
Epoch: 9, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.216 Vali Acc: 0.672 Test Loss: 1.216 Test Acc: 0.672
Validation loss decreased (-0.671862 --> -0.671863).  Saving model ...
Epoch: 10 cost time: 1.0184624195098877
Epoch: 10, Steps: 8 | Train Loss: 0.661 Vali Loss: 1.140 Vali Acc: 0.688 Test Loss: 1.140 Test Acc: 0.688
Validation loss decreased (-0.671863 --> -0.687489).  Saving model ...
Epoch: 11 cost time: 0.978933572769165
Epoch: 11, Steps: 8 | Train Loss: 0.546 Vali Loss: 1.079 Vali Acc: 0.681 Test Loss: 1.079 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.946629524230957
Epoch: 12, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.023 Vali Acc: 0.709 Test Loss: 1.023 Test Acc: 0.709
Validation loss decreased (-0.687489 --> -0.709365).  Saving model ...
Epoch: 13 cost time: 1.140082597732544
Epoch: 13, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.709365 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.0665314197540283
Epoch: 14, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.946 Vali Acc: 0.728 Test Loss: 0.946 Test Acc: 0.728
Validation loss decreased (-0.724990 --> -0.728116).  Saving model ...
Epoch: 15 cost time: 1.151787519454956
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.915 Vali Acc: 0.744 Test Loss: 0.915 Test Acc: 0.744
Validation loss decreased (-0.728116 --> -0.743741).  Saving model ...
Epoch: 16 cost time: 1.1422476768493652
Epoch: 16, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.893 Vali Acc: 0.747 Test Loss: 0.893 Test Acc: 0.747
Validation loss decreased (-0.743741 --> -0.746866).  Saving model ...
Epoch: 17 cost time: 1.139733076095581
Epoch: 17, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.872 Vali Acc: 0.753 Test Loss: 0.872 Test Acc: 0.753
Validation loss decreased (-0.746866 --> -0.753116).  Saving model ...
Epoch: 18 cost time: 1.142972707748413
Epoch: 18, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.857 Vali Acc: 0.756 Test Loss: 0.857 Test Acc: 0.756
Validation loss decreased (-0.753116 --> -0.756241).  Saving model ...
Epoch: 19 cost time: 1.1406030654907227
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.842 Vali Acc: 0.753 Test Loss: 0.842 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.178173303604126
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.830 Vali Acc: 0.759 Test Loss: 0.830 Test Acc: 0.759
Validation loss decreased (-0.756241 --> -0.759367).  Saving model ...
Epoch: 21 cost time: 1.2887213230133057
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.223283052444458
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.812 Vali Acc: 0.759 Test Loss: 0.812 Test Acc: 0.759
Validation loss decreased (-0.759367 --> -0.759367).  Saving model ...
Epoch: 23 cost time: 1.0639464855194092
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.803 Vali Acc: 0.759 Test Loss: 0.803 Test Acc: 0.759
Validation loss decreased (-0.759367 --> -0.759367).  Saving model ...
Epoch: 24 cost time: 1.232316493988037
Epoch: 24, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0696825981140137
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.794 Vali Acc: 0.762 Test Loss: 0.794 Test Acc: 0.762
Validation loss decreased (-0.759367 --> -0.762492).  Saving model ...
Epoch: 26 cost time: 1.1702325344085693
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.790 Vali Acc: 0.759 Test Loss: 0.790 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.253537893295288
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.786 Vali Acc: 0.766 Test Loss: 0.786 Test Acc: 0.766
Validation loss decreased (-0.762492 --> -0.765617).  Saving model ...
Epoch: 28 cost time: 1.1568341255187988
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.781 Vali Acc: 0.762 Test Loss: 0.781 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0180885791778564
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.142329454421997
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.776 Vali Acc: 0.762 Test Loss: 0.776 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1212890148162842
Epoch: 31, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.773 Vali Acc: 0.769 Test Loss: 0.773 Test Acc: 0.769
Validation loss decreased (-0.765617 --> -0.768742).  Saving model ...
Epoch: 32 cost time: 0.95186448097229
Epoch: 32, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.772 Vali Acc: 0.769 Test Loss: 0.772 Test Acc: 0.769
Validation loss decreased (-0.768742 --> -0.768742).  Saving model ...
Epoch: 33 cost time: 1.0564136505126953
Epoch: 33, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.770 Vali Acc: 0.766 Test Loss: 0.770 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9089550971984863
Epoch: 34, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.770 Vali Acc: 0.759 Test Loss: 0.770 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0327706336975098
Epoch: 35, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.770 Vali Acc: 0.753 Test Loss: 0.770 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9361662864685059
Epoch: 36, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.753 Test Loss: 0.769 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.120983362197876
Epoch: 37, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.768 Vali Acc: 0.759 Test Loss: 0.768 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.039289951324463
Epoch: 38, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.768 Vali Acc: 0.762 Test Loss: 0.768 Test Acc: 0.762
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0525445938110352
Epoch: 39, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.767 Vali Acc: 0.762 Test Loss: 0.767 Test Acc: 0.762
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0168910026550293
Epoch: 40, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.767 Vali Acc: 0.759 Test Loss: 0.767 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.076836347579956
Epoch: 41, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.756 Test Loss: 0.765 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0853440761566162
Epoch: 42, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w24_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.76875
model parameter : 175640
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0936384201049805
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 2.076 Vali Acc: 0.122 Test Loss: 2.076 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.9134385585784912
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.998 Vali Acc: 0.188 Test Loss: 1.998 Test Acc: 0.188
Validation loss decreased (-0.121854 --> -0.187480).  Saving model ...
Epoch: 3 cost time: 0.9099586009979248
Epoch: 3, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.890 Vali Acc: 0.300 Test Loss: 1.890 Test Acc: 0.300
Validation loss decreased (-0.187480 --> -0.299981).  Saving model ...
Epoch: 4 cost time: 0.9097847938537598
Epoch: 4, Steps: 8 | Train Loss: 1.663 Vali Loss: 1.772 Vali Acc: 0.453 Test Loss: 1.772 Test Acc: 0.453
Validation loss decreased (-0.299981 --> -0.453107).  Saving model ...
Epoch: 5 cost time: 0.9297099113464355
Epoch: 5, Steps: 8 | Train Loss: 1.440 Vali Loss: 1.649 Vali Acc: 0.550 Test Loss: 1.649 Test Acc: 0.550
Validation loss decreased (-0.453107 --> -0.549984).  Saving model ...
Epoch: 6 cost time: 0.902836799621582
Epoch: 6, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.528 Vali Acc: 0.641 Test Loss: 1.528 Test Acc: 0.641
Validation loss decreased (-0.549984 --> -0.640610).  Saving model ...
Epoch: 7 cost time: 0.8143768310546875
Epoch: 7, Steps: 8 | Train Loss: 1.084 Vali Loss: 1.428 Vali Acc: 0.662 Test Loss: 1.428 Test Acc: 0.662
Validation loss decreased (-0.640610 --> -0.662486).  Saving model ...
Epoch: 8 cost time: 0.8164548873901367
Epoch: 8, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.340 Vali Acc: 0.688 Test Loss: 1.340 Test Acc: 0.688
Validation loss decreased (-0.662486 --> -0.687487).  Saving model ...
Epoch: 9 cost time: 0.8427464962005615
Epoch: 9, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.254 Vali Acc: 0.700 Test Loss: 1.254 Test Acc: 0.700
Validation loss decreased (-0.687487 --> -0.699987).  Saving model ...
Epoch: 10 cost time: 0.8533589839935303
Epoch: 10, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.175 Vali Acc: 0.716 Test Loss: 1.175 Test Acc: 0.716
Validation loss decreased (-0.699987 --> -0.715613).  Saving model ...
Epoch: 11 cost time: 0.9010231494903564
Epoch: 11, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.106 Vali Acc: 0.719 Test Loss: 1.106 Test Acc: 0.719
Validation loss decreased (-0.715613 --> -0.718739).  Saving model ...
Epoch: 12 cost time: 0.8773868083953857
Epoch: 12, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.051 Vali Acc: 0.734 Test Loss: 1.051 Test Acc: 0.734
Validation loss decreased (-0.718739 --> -0.734364).  Saving model ...
Epoch: 13 cost time: 0.8818881511688232
Epoch: 13, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
Validation loss decreased (-0.734364 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.9203639030456543
Epoch: 14, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.964 Vali Acc: 0.753 Test Loss: 0.964 Test Acc: 0.753
Validation loss decreased (-0.749990 --> -0.753115).  Saving model ...
Epoch: 15 cost time: 0.8296248912811279
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.939 Vali Acc: 0.756 Test Loss: 0.939 Test Acc: 0.756
Validation loss decreased (-0.753115 --> -0.756241).  Saving model ...
Epoch: 16 cost time: 0.8478398323059082
Epoch: 16, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.832829475402832
Epoch: 17, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.892 Vali Acc: 0.753 Test Loss: 0.892 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.990713357925415
Epoch: 18, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8465423583984375
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.864 Vali Acc: 0.747 Test Loss: 0.864 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9808773994445801
Epoch: 20, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.851 Vali Acc: 0.747 Test Loss: 0.851 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.074230432510376
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.842 Vali Acc: 0.753 Test Loss: 0.842 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0515918731689453
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0068843364715576
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.037688970565796
Epoch: 24, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.817 Vali Acc: 0.747 Test Loss: 0.817 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9169986248016357
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.813 Vali Acc: 0.747 Test Loss: 0.813 Test Acc: 0.747
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75625
model parameter : 173592
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1486294269561768
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.104 Vali Acc: 0.128 Test Loss: 2.104 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 0.7735702991485596
Epoch: 2, Steps: 8 | Train Loss: 2.014 Vali Loss: 2.018 Vali Acc: 0.216 Test Loss: 2.018 Test Acc: 0.216
Validation loss decreased (-0.128104 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 0.7723391056060791
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.900 Vali Acc: 0.341 Test Loss: 1.900 Test Acc: 0.341
Validation loss decreased (-0.215605 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 0.9452054500579834
Epoch: 4, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.777 Vali Acc: 0.434 Test Loss: 1.777 Test Acc: 0.434
Validation loss decreased (-0.340606 --> -0.434357).  Saving model ...
Epoch: 5 cost time: 0.7967829704284668
Epoch: 5, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.650 Vali Acc: 0.559 Test Loss: 1.650 Test Acc: 0.559
Validation loss decreased (-0.434357 --> -0.559358).  Saving model ...
Epoch: 6 cost time: 0.8044312000274658
Epoch: 6, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.532 Vali Acc: 0.625 Test Loss: 1.532 Test Acc: 0.625
Validation loss decreased (-0.559358 --> -0.624985).  Saving model ...
Epoch: 7 cost time: 0.7036287784576416
Epoch: 7, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.426 Vali Acc: 0.672 Test Loss: 1.426 Test Acc: 0.672
Validation loss decreased (-0.624985 --> -0.671861).  Saving model ...
Epoch: 8 cost time: 0.638993501663208
Epoch: 8, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.330 Vali Acc: 0.681 Test Loss: 1.330 Test Acc: 0.681
Validation loss decreased (-0.671861 --> -0.681237).  Saving model ...
Epoch: 9 cost time: 0.6686444282531738
Epoch: 9, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.243 Vali Acc: 0.709 Test Loss: 1.243 Test Acc: 0.709
Validation loss decreased (-0.681237 --> -0.709363).  Saving model ...
Epoch: 10 cost time: 0.6340827941894531
Epoch: 10, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.170 Vali Acc: 0.716 Test Loss: 1.170 Test Acc: 0.716
Validation loss decreased (-0.709363 --> -0.715613).  Saving model ...
Epoch: 11 cost time: 0.673001766204834
Epoch: 11, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.108 Vali Acc: 0.722 Test Loss: 1.108 Test Acc: 0.722
Validation loss decreased (-0.715613 --> -0.721864).  Saving model ...
Epoch: 12 cost time: 0.6946518421173096
Epoch: 12, Steps: 8 | Train Loss: 0.396 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
Validation loss decreased (-0.721864 --> -0.721864).  Saving model ...
Epoch: 13 cost time: 0.7486953735351562
Epoch: 13, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.012 Vali Acc: 0.722 Test Loss: 1.012 Test Acc: 0.722
Validation loss decreased (-0.721864 --> -0.721865).  Saving model ...
Epoch: 14 cost time: 0.6028056144714355
Epoch: 14, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.975 Vali Acc: 0.731 Test Loss: 0.975 Test Acc: 0.731
Validation loss decreased (-0.721865 --> -0.731240).  Saving model ...
Epoch: 15 cost time: 0.7181119918823242
Epoch: 15, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.945 Vali Acc: 0.734 Test Loss: 0.945 Test Acc: 0.734
Validation loss decreased (-0.731240 --> -0.734366).  Saving model ...
Epoch: 16 cost time: 0.6590299606323242
Epoch: 16, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.924 Vali Acc: 0.734 Test Loss: 0.924 Test Acc: 0.734
Validation loss decreased (-0.734366 --> -0.734366).  Saving model ...
Epoch: 17 cost time: 0.6718409061431885
Epoch: 17, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.907 Vali Acc: 0.734 Test Loss: 0.907 Test Acc: 0.734
Validation loss decreased (-0.734366 --> -0.734366).  Saving model ...
Epoch: 18 cost time: 0.680518627166748
Epoch: 18, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.892 Vali Acc: 0.734 Test Loss: 0.892 Test Acc: 0.734
Validation loss decreased (-0.734366 --> -0.734366).  Saving model ...
Epoch: 19 cost time: 0.6036360263824463
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.880 Vali Acc: 0.728 Test Loss: 0.880 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.686643123626709
Epoch: 20, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.869 Vali Acc: 0.731 Test Loss: 0.869 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6853117942810059
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.859 Vali Acc: 0.731 Test Loss: 0.859 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7258176803588867
Epoch: 22, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.854 Vali Acc: 0.741 Test Loss: 0.854 Test Acc: 0.741
Validation loss decreased (-0.734366 --> -0.740616).  Saving model ...
Epoch: 23 cost time: 0.6783950328826904
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.850 Vali Acc: 0.731 Test Loss: 0.850 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7670657634735107
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.844 Vali Acc: 0.734 Test Loss: 0.844 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7394797801971436
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.839 Vali Acc: 0.731 Test Loss: 0.839 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7488868236541748
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.836 Vali Acc: 0.734 Test Loss: 0.836 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7935917377471924
Epoch: 27, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
Validation loss decreased (-0.740616 --> -0.743742).  Saving model ...
Epoch: 28 cost time: 0.6805369853973389
Epoch: 28, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
Validation loss decreased (-0.743742 --> -0.743742).  Saving model ...
Epoch: 29 cost time: 0.757819414138794
Epoch: 29, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
Validation loss decreased (-0.743742 --> -0.743742).  Saving model ...
Epoch: 30 cost time: 0.5973014831542969
Epoch: 30, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.825 Vali Acc: 0.734 Test Loss: 0.825 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7441451549530029
Epoch: 31, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.824 Vali Acc: 0.738 Test Loss: 0.824 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.701956033706665
Epoch: 32, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.823 Vali Acc: 0.738 Test Loss: 0.823 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7151370048522949
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.821 Vali Acc: 0.731 Test Loss: 0.821 Test Acc: 0.731
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7005629539489746
Epoch: 34, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.818 Vali Acc: 0.731 Test Loss: 0.818 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8028252124786377
Epoch: 35, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.817 Vali Acc: 0.731 Test Loss: 0.817 Test Acc: 0.731
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7788307666778564
Epoch: 36, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.816 Vali Acc: 0.731 Test Loss: 0.816 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7078568935394287
Epoch: 37, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.814 Vali Acc: 0.734 Test Loss: 0.814 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7896728515625
Epoch: 38, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.812 Vali Acc: 0.731 Test Loss: 0.812 Test Acc: 0.731
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6885876655578613
Epoch: 39, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w10_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.74375
model parameter : 172056
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.761176347732544
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.073 Vali Acc: 0.166 Test Loss: 2.073 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.6466150283813477
Epoch: 2, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.985 Vali Acc: 0.284 Test Loss: 1.985 Test Acc: 0.284
Validation loss decreased (-0.165604 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 0.6243598461151123
Epoch: 3, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.874 Vali Acc: 0.397 Test Loss: 1.874 Test Acc: 0.397
Validation loss decreased (-0.284355 --> -0.396856).  Saving model ...
Epoch: 4 cost time: 0.6250851154327393
Epoch: 4, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.749 Vali Acc: 0.512 Test Loss: 1.749 Test Acc: 0.512
Validation loss decreased (-0.396856 --> -0.512483).  Saving model ...
Epoch: 5 cost time: 0.7372391223907471
Epoch: 5, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.625 Vali Acc: 0.581 Test Loss: 1.625 Test Acc: 0.581
Validation loss decreased (-0.512483 --> -0.581234).  Saving model ...
Epoch: 6 cost time: 0.6971163749694824
Epoch: 6, Steps: 8 | Train Loss: 1.203 Vali Loss: 1.512 Vali Acc: 0.631 Test Loss: 1.512 Test Acc: 0.631
Validation loss decreased (-0.581234 --> -0.631235).  Saving model ...
Epoch: 7 cost time: 0.6004691123962402
Epoch: 7, Steps: 8 | Train Loss: 1.019 Vali Loss: 1.408 Vali Acc: 0.644 Test Loss: 1.408 Test Acc: 0.644
Validation loss decreased (-0.631235 --> -0.643736).  Saving model ...
Epoch: 8 cost time: 0.6109828948974609
Epoch: 8, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.308 Vali Acc: 0.675 Test Loss: 1.308 Test Acc: 0.675
Validation loss decreased (-0.643736 --> -0.674987).  Saving model ...
Epoch: 9 cost time: 0.5916314125061035
Epoch: 9, Steps: 8 | Train Loss: 0.707 Vali Loss: 1.226 Vali Acc: 0.678 Test Loss: 1.226 Test Acc: 0.678
Validation loss decreased (-0.674987 --> -0.678113).  Saving model ...
Epoch: 10 cost time: 0.6352221965789795
Epoch: 10, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.152 Vali Acc: 0.691 Test Loss: 1.152 Test Acc: 0.691
Validation loss decreased (-0.678113 --> -0.690613).  Saving model ...
Epoch: 11 cost time: 0.6384830474853516
Epoch: 11, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
Validation loss decreased (-0.690613 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.6605415344238281
Epoch: 12, Steps: 8 | Train Loss: 0.379 Vali Loss: 1.032 Vali Acc: 0.709 Test Loss: 1.032 Test Acc: 0.709
Validation loss decreased (-0.699989 --> -0.709365).  Saving model ...
Epoch: 13 cost time: 0.6065733432769775
Epoch: 13, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.991 Vali Acc: 0.716 Test Loss: 0.991 Test Acc: 0.716
Validation loss decreased (-0.709365 --> -0.715615).  Saving model ...
Epoch: 14 cost time: 0.6721029281616211
Epoch: 14, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.958 Vali Acc: 0.722 Test Loss: 0.958 Test Acc: 0.722
Validation loss decreased (-0.715615 --> -0.721865).  Saving model ...
Epoch: 15 cost time: 0.6408474445343018
Epoch: 15, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
Validation loss decreased (-0.721865 --> -0.721866).  Saving model ...
Epoch: 16 cost time: 0.6106290817260742
Epoch: 16, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.919 Vali Acc: 0.722 Test Loss: 0.919 Test Acc: 0.722
Validation loss decreased (-0.721866 --> -0.721866).  Saving model ...
Epoch: 17 cost time: 0.6117160320281982
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.721866 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 0.6554296016693115
Epoch: 18, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.889 Vali Acc: 0.722 Test Loss: 0.889 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6957824230194092
Epoch: 19, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.876 Vali Acc: 0.719 Test Loss: 0.876 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6343491077423096
Epoch: 20, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.863 Vali Acc: 0.719 Test Loss: 0.863 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7471239566802979
Epoch: 21, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.857 Vali Acc: 0.719 Test Loss: 0.857 Test Acc: 0.719
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.649559736251831
Epoch: 22, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 23 cost time: 0.5988738536834717
Epoch: 23, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.844 Vali Acc: 0.719 Test Loss: 0.844 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6417253017425537
Epoch: 24, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.839 Vali Acc: 0.716 Test Loss: 0.839 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6310114860534668
Epoch: 25, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6819944381713867
Epoch: 26, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 27 cost time: 0.6650564670562744
Epoch: 27, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.826 Vali Acc: 0.725 Test Loss: 0.826 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 28 cost time: 0.6306641101837158
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.824 Vali Acc: 0.719 Test Loss: 0.824 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6743283271789551
Epoch: 29, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 30 cost time: 0.7453763484954834
Epoch: 30, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.819 Vali Acc: 0.725 Test Loss: 0.819 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 31 cost time: 0.6674315929412842
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.818 Vali Acc: 0.719 Test Loss: 0.818 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6282796859741211
Epoch: 32, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.816 Vali Acc: 0.716 Test Loss: 0.816 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.605597734451294
Epoch: 33, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.814 Vali Acc: 0.719 Test Loss: 0.814 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5580480098724365
Epoch: 34, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5341472625732422
Epoch: 35, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.811 Vali Acc: 0.725 Test Loss: 0.811 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 36 cost time: 0.6238117218017578
Epoch: 36, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 37 cost time: 0.6164746284484863
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 0.5615577697753906
Epoch: 38, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.806 Vali Acc: 0.719 Test Loss: 0.806 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5513417720794678
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.805 Vali Acc: 0.719 Test Loss: 0.805 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6813774108886719
Epoch: 40, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.805 Vali Acc: 0.719 Test Loss: 0.805 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5621364116668701
Epoch: 41, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.804 Vali Acc: 0.722 Test Loss: 0.804 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6016123294830322
Epoch: 42, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 43 cost time: 0.5028975009918213
Epoch: 43, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 44 cost time: 0.5055828094482422
Epoch: 44, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.800 Vali Acc: 0.725 Test Loss: 0.800 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 45 cost time: 0.48206424713134766
Epoch: 45, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.502089262008667
Epoch: 46, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.799 Vali Acc: 0.725 Test Loss: 0.799 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 47 cost time: 0.5797083377838135
Epoch: 47, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.799 Vali Acc: 0.722 Test Loss: 0.799 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6699881553649902
Epoch: 48, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.719 Test Loss: 0.799 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6663608551025391
Epoch: 49, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.798 Vali Acc: 0.719 Test Loss: 0.798 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6736154556274414
Epoch: 50, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6054747104644775
Epoch: 51, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 52 cost time: 0.6102347373962402
Epoch: 52, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.795 Vali Acc: 0.728 Test Loss: 0.795 Test Acc: 0.728
Validation loss decreased (-0.724992 --> -0.728117).  Saving model ...
Epoch: 53 cost time: 0.5918841361999512
Epoch: 53, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6204643249511719
Epoch: 54, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5874528884887695
Epoch: 55, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6638016700744629
Epoch: 56, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6843116283416748
Epoch: 57, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
Validation loss decreased (-0.728117 --> -0.728117).  Saving model ...
Epoch: 58 cost time: 0.5056650638580322
Epoch: 58, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.642080545425415
Epoch: 59, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6226310729980469
Epoch: 60, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6331386566162109
Epoch: 61, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.728117 --> -0.728117).  Saving model ...
Epoch: 62 cost time: 0.6853682994842529
Epoch: 62, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6801004409790039
Epoch: 63, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
Validation loss decreased (-0.728117 --> -0.731242).  Saving model ...
Epoch: 64 cost time: 0.6726388931274414
Epoch: 64, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
Validation loss decreased (-0.731242 --> -0.731242).  Saving model ...
Epoch: 65 cost time: 0.7009453773498535
Epoch: 65, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
Validation loss decreased (-0.731242 --> -0.731242).  Saving model ...
Epoch: 66 cost time: 0.7284107208251953
Epoch: 66, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7538385391235352
Epoch: 67, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6998608112335205
Epoch: 68, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.731 Test Loss: 0.794 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.673912525177002
Epoch: 69, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.731 Test Loss: 0.794 Test Acc: 0.731
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6854124069213867
Epoch: 70, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.801063060760498
Epoch: 71, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6162233352661133
Epoch: 72, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.731 Test Loss: 0.794 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.7102627754211426
Epoch: 73, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.7207987308502197
Epoch: 74, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.731 Test Loss: 0.793 Test Acc: 0.731
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.6756296157836914
Epoch: 75, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.73125
model parameter : 171288
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.918360948562622
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 2.167 Vali Acc: 0.109 Test Loss: 2.167 Test Acc: 0.109
Validation loss decreased (inf --> -0.109353).  Saving model ...
Epoch: 2 cost time: 0.5544047355651855
Epoch: 2, Steps: 8 | Train Loss: 2.075 Vali Loss: 2.064 Vali Acc: 0.181 Test Loss: 2.064 Test Acc: 0.181
Validation loss decreased (-0.109353 --> -0.181229).  Saving model ...
Epoch: 3 cost time: 0.5263855457305908
Epoch: 3, Steps: 8 | Train Loss: 1.851 Vali Loss: 1.926 Vali Acc: 0.341 Test Loss: 1.926 Test Acc: 0.341
Validation loss decreased (-0.181229 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 0.5502746105194092
Epoch: 4, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.779 Vali Acc: 0.459 Test Loss: 1.779 Test Acc: 0.459
Validation loss decreased (-0.340606 --> -0.459357).  Saving model ...
Epoch: 5 cost time: 0.5444636344909668
Epoch: 5, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.634 Vali Acc: 0.591 Test Loss: 1.634 Test Acc: 0.591
Validation loss decreased (-0.459357 --> -0.590609).  Saving model ...
Epoch: 6 cost time: 0.5487675666809082
Epoch: 6, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.509 Vali Acc: 0.637 Test Loss: 1.509 Test Acc: 0.637
Validation loss decreased (-0.590609 --> -0.637485).  Saving model ...
Epoch: 7 cost time: 0.5454983711242676
Epoch: 7, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.402 Vali Acc: 0.666 Test Loss: 1.402 Test Acc: 0.666
Validation loss decreased (-0.637485 --> -0.665611).  Saving model ...
Epoch: 8 cost time: 0.5353262424468994
Epoch: 8, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.305 Vali Acc: 0.678 Test Loss: 1.305 Test Acc: 0.678
Validation loss decreased (-0.665611 --> -0.678112).  Saving model ...
Epoch: 9 cost time: 0.617323637008667
Epoch: 9, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.228 Vali Acc: 0.672 Test Loss: 1.228 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5399510860443115
Epoch: 10, Steps: 8 | Train Loss: 0.557 Vali Loss: 1.150 Vali Acc: 0.684 Test Loss: 1.150 Test Acc: 0.684
Validation loss decreased (-0.678112 --> -0.684363).  Saving model ...
Epoch: 11 cost time: 0.59132981300354
Epoch: 11, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.087 Vali Acc: 0.691 Test Loss: 1.087 Test Acc: 0.691
Validation loss decreased (-0.684363 --> -0.690614).  Saving model ...
Epoch: 12 cost time: 0.599707841873169
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.044 Vali Acc: 0.694 Test Loss: 1.044 Test Acc: 0.694
Validation loss decreased (-0.690614 --> -0.693740).  Saving model ...
Epoch: 13 cost time: 0.5604522228240967
Epoch: 13, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.006 Vali Acc: 0.706 Test Loss: 1.006 Test Acc: 0.706
Validation loss decreased (-0.693740 --> -0.706240).  Saving model ...
Epoch: 14 cost time: 0.554128885269165
Epoch: 14, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.971 Vali Acc: 0.709 Test Loss: 0.971 Test Acc: 0.709
Validation loss decreased (-0.706240 --> -0.709365).  Saving model ...
Epoch: 15 cost time: 0.5580072402954102
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.944 Vali Acc: 0.716 Test Loss: 0.944 Test Acc: 0.716
Validation loss decreased (-0.709365 --> -0.715616).  Saving model ...
Epoch: 16 cost time: 0.5511000156402588
Epoch: 16, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.927 Vali Acc: 0.703 Test Loss: 0.927 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5478241443634033
Epoch: 17, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.915 Vali Acc: 0.709 Test Loss: 0.915 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.568683385848999
Epoch: 18, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.903 Vali Acc: 0.728 Test Loss: 0.903 Test Acc: 0.728
Validation loss decreased (-0.715616 --> -0.728116).  Saving model ...
Epoch: 19 cost time: 0.5512731075286865
Epoch: 19, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.891 Vali Acc: 0.731 Test Loss: 0.891 Test Acc: 0.731
Validation loss decreased (-0.728116 --> -0.731241).  Saving model ...
Epoch: 20 cost time: 0.5103874206542969
Epoch: 20, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.882 Vali Acc: 0.728 Test Loss: 0.882 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6364336013793945
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5425136089324951
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.870 Vali Acc: 0.728 Test Loss: 0.870 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6356940269470215
Epoch: 23, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.866 Vali Acc: 0.725 Test Loss: 0.866 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.668210506439209
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7044212818145752
Epoch: 25, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.854 Vali Acc: 0.731 Test Loss: 0.854 Test Acc: 0.731
Validation loss decreased (-0.731241 --> -0.731241).  Saving model ...
Epoch: 26 cost time: 0.4820098876953125
Epoch: 26, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.851 Vali Acc: 0.734 Test Loss: 0.851 Test Acc: 0.734
Validation loss decreased (-0.731241 --> -0.734366).  Saving model ...
Epoch: 27 cost time: 0.6041049957275391
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5542879104614258
Epoch: 28, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.849 Vali Acc: 0.731 Test Loss: 0.849 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5651946067810059
Epoch: 29, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.848 Vali Acc: 0.734 Test Loss: 0.848 Test Acc: 0.734
Validation loss decreased (-0.734366 --> -0.734367).  Saving model ...
Epoch: 30 cost time: 0.5139031410217285
Epoch: 30, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.846 Vali Acc: 0.734 Test Loss: 0.846 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 31 cost time: 0.5529704093933105
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 32 cost time: 0.6288609504699707
Epoch: 32, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.843 Vali Acc: 0.734 Test Loss: 0.843 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 33 cost time: 0.608665943145752
Epoch: 33, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.734 Test Loss: 0.841 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 34 cost time: 0.6274871826171875
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 35 cost time: 0.5522801876068115
Epoch: 35, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 36 cost time: 0.561408281326294
Epoch: 36, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5295312404632568
Epoch: 37, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.837 Vali Acc: 0.728 Test Loss: 0.837 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.619185209274292
Epoch: 38, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.836 Vali Acc: 0.731 Test Loss: 0.836 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5482285022735596
Epoch: 39, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.835 Vali Acc: 0.734 Test Loss: 0.835 Test Acc: 0.734
Validation loss decreased (-0.734367 --> -0.734367).  Saving model ...
Epoch: 40 cost time: 0.627997636795044
Epoch: 40, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6407632827758789
Epoch: 41, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.834 Vali Acc: 0.738 Test Loss: 0.834 Test Acc: 0.738
Validation loss decreased (-0.734367 --> -0.737492).  Saving model ...
Epoch: 42 cost time: 0.5957190990447998
Epoch: 42, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.833 Vali Acc: 0.734 Test Loss: 0.833 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7894065380096436
Epoch: 43, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.833 Vali Acc: 0.734 Test Loss: 0.833 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7139787673950195
Epoch: 44, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.833 Vali Acc: 0.731 Test Loss: 0.833 Test Acc: 0.731
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6603171825408936
Epoch: 45, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6211411952972412
Epoch: 46, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.832 Vali Acc: 0.728 Test Loss: 0.832 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6723544597625732
Epoch: 47, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6003074645996094
Epoch: 48, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.832 Vali Acc: 0.731 Test Loss: 0.832 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6393380165100098
Epoch: 49, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6031670570373535
Epoch: 50, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6218240261077881
Epoch: 51, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.834 Vali Acc: 0.728 Test Loss: 0.834 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7375
model parameter : 170520
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.089064836502075
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 2.022 Vali Acc: 0.212 Test Loss: 2.022 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.5776150226593018
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.906 Vali Acc: 0.294 Test Loss: 1.906 Test Acc: 0.294
Validation loss decreased (-0.212480 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 0.6845846176147461
Epoch: 3, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.767 Vali Acc: 0.400 Test Loss: 1.767 Test Acc: 0.400
Validation loss decreased (-0.293731 --> -0.399982).  Saving model ...
Epoch: 4 cost time: 0.5648307800292969
Epoch: 4, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.627 Vali Acc: 0.531 Test Loss: 1.627 Test Acc: 0.531
Validation loss decreased (-0.399982 --> -0.531234).  Saving model ...
Epoch: 5 cost time: 0.5968461036682129
Epoch: 5, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.500 Vali Acc: 0.628 Test Loss: 1.500 Test Acc: 0.628
Validation loss decreased (-0.531234 --> -0.628110).  Saving model ...
Epoch: 6 cost time: 0.5944578647613525
Epoch: 6, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
Validation loss decreased (-0.628110 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 0.5349826812744141
Epoch: 7, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.294 Vali Acc: 0.659 Test Loss: 1.294 Test Acc: 0.659
Validation loss decreased (-0.649986 --> -0.659362).  Saving model ...
Epoch: 8 cost time: 0.5236339569091797
Epoch: 8, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.217 Vali Acc: 0.672 Test Loss: 1.217 Test Acc: 0.672
Validation loss decreased (-0.659362 --> -0.671863).  Saving model ...
Epoch: 9 cost time: 0.5418896675109863
Epoch: 9, Steps: 8 | Train Loss: 0.652 Vali Loss: 1.150 Vali Acc: 0.678 Test Loss: 1.150 Test Acc: 0.678
Validation loss decreased (-0.671863 --> -0.678114).  Saving model ...
Epoch: 10 cost time: 0.6182191371917725
Epoch: 10, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.085 Vali Acc: 0.694 Test Loss: 1.085 Test Acc: 0.694
Validation loss decreased (-0.678114 --> -0.693739).  Saving model ...
Epoch: 11 cost time: 0.5944552421569824
Epoch: 11, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.032 Vali Acc: 0.694 Test Loss: 1.032 Test Acc: 0.694
Validation loss decreased (-0.693739 --> -0.693740).  Saving model ...
Epoch: 12 cost time: 0.5124399662017822
Epoch: 12, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.977 Vali Acc: 0.716 Test Loss: 0.977 Test Acc: 0.716
Validation loss decreased (-0.693740 --> -0.715615).  Saving model ...
Epoch: 13 cost time: 0.6049668788909912
Epoch: 13, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.948 Vali Acc: 0.706 Test Loss: 0.948 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6863141059875488
Epoch: 14, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.914 Vali Acc: 0.716 Test Loss: 0.914 Test Acc: 0.716
Validation loss decreased (-0.715615 --> -0.715616).  Saving model ...
Epoch: 15 cost time: 0.4675440788269043
Epoch: 15, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
Validation loss decreased (-0.715616 --> -0.721866).  Saving model ...
Epoch: 16 cost time: 0.5277864933013916
Epoch: 16, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.888 Vali Acc: 0.716 Test Loss: 0.888 Test Acc: 0.716
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.49394965171813965
Epoch: 17, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.878 Vali Acc: 0.728 Test Loss: 0.878 Test Acc: 0.728
Validation loss decreased (-0.721866 --> -0.728116).  Saving model ...
Epoch: 18 cost time: 0.49495363235473633
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.863 Vali Acc: 0.719 Test Loss: 0.863 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.518770694732666
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.851 Vali Acc: 0.725 Test Loss: 0.851 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5910947322845459
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5320303440093994
Epoch: 21, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.848 Vali Acc: 0.722 Test Loss: 0.848 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5098803043365479
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.843 Vali Acc: 0.731 Test Loss: 0.843 Test Acc: 0.731
Validation loss decreased (-0.728116 --> -0.731242).  Saving model ...
Epoch: 23 cost time: 0.5626301765441895
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.842 Vali Acc: 0.731 Test Loss: 0.842 Test Acc: 0.731
Validation loss decreased (-0.731242 --> -0.731242).  Saving model ...
Epoch: 24 cost time: 0.5972893238067627
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6784193515777588
Epoch: 25, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6048760414123535
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.841 Vali Acc: 0.722 Test Loss: 0.841 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5777313709259033
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.722 Test Loss: 0.841 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5988645553588867
Epoch: 28, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.716 Test Loss: 0.840 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5448713302612305
Epoch: 29, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.843 Vali Acc: 0.716 Test Loss: 0.843 Test Acc: 0.716
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5726909637451172
Epoch: 30, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.846 Vali Acc: 0.716 Test Loss: 0.846 Test Acc: 0.716
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6561567783355713
Epoch: 31, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.846 Vali Acc: 0.713 Test Loss: 0.846 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5433311462402344
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.847 Vali Acc: 0.709 Test Loss: 0.847 Test Acc: 0.709
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4577476978302002
Epoch: 33, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.849 Vali Acc: 0.709 Test Loss: 0.849 Test Acc: 0.709
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_MTSMixer_UEA_ftM_sl315_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.73125
model parameter : 169752
model size : 0.65MB
